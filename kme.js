/* KME by Juvty Worlds Ltd. */

//RIM
var rareDir = false;
//RIM

!function (a, b) {
    "object" == typeof module && "object" == typeof module.exports ? module.exports = a.document ? b(a, !0) : function (a) {
        if (!a.document)throw new Error("jQuery requires a window with a document");
        return b(a)
    } : b(a)
}("undefined" != typeof window ? window : this, function (a, b) {
    function c(a) {
        var b = !!a && "length" in a && a.length, c = fa.type(a);
        return "function" === c || fa.isWindow(a) ? !1 : "array" === c || 0 === b || "number" == typeof b && b > 0 && b - 1 in a
    }

    function d(a, b, c) {
        if (fa.isFunction(b))return fa.grep(a, function (a, d) {
            return !!b.call(a, d, a) !== c
        });
        if (b.nodeType)return fa.grep(a, function (a) {
            return a === b !== c
        });
        if ("string" == typeof b) {
            if (pa.test(b))return fa.filter(b, a, c);
            b = fa.filter(b, a)
        }
        return fa.grep(a, function (a) {
            return _.call(b, a) > -1 !== c
        })
    }

    function e(a, b) {
        for (; (a = a[b]) && 1 !== a.nodeType;);
        return a
    }

    function f(a) {
        var b = {};
        return fa.each(a.match(va) || [], function (a, c) {
            b[c] = !0
        }), b
    }

    function g() {
        X.removeEventListener("DOMContentLoaded", g), a.removeEventListener("load", g), fa.ready()
    }

    function h() {
        this.expando = fa.expando + h.uid++
    }

    function i(a, b, c) {
        var d;
        if (void 0 === c && 1 === a.nodeType)if (d = "data-" + b.replace(Ca, "-$&").toLowerCase(), c = a.getAttribute(d), "string" == typeof c) {
            try {
                c = "true" === c ? !0 : "false" === c ? !1 : "null" === c ? null : +c + "" === c ? +c : Ba.test(c) ? fa.parseJSON(c) : c
            } catch (e) {
            }
            Aa.set(a, b, c)
        } else c = void 0;
        return c
    }

    function j(a, b, c, d) {
        var e, f = 1, g = 20, h = d ? function () {
            return d.cur()
        } : function () {
            return fa.css(a, b, "")
        }, i = h(), j = c && c[3] || (fa.cssNumber[b] ? "" : "px"), k = (fa.cssNumber[b] || "px" !== j && +i) && Ea.exec(fa.css(a, b));
        if (k && k[3] !== j) {
            j = j || k[3], c = c || [], k = +i || 1;
            do f = f || ".5", k /= f, fa.style(a, b, k + j); while (f !== (f = h() / i) && 1 !== f && --g)
        }
        return c && (k = +k || +i || 0, e = c[1] ? k + (c[1] + 1) * c[2] : +c[2], d && (d.unit = j, d.start = k, d.end = e)), e
    }

    function k(a, b) {
        var c = "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName(b || "*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll(b || "*") : [];
        return void 0 === b || b && fa.nodeName(a, b) ? fa.merge([a], c) : c
    }

    function l(a, b) {
        for (var c = 0, d = a.length; d > c; c++)za.set(a[c], "globalEval", !b || za.get(b[c], "globalEval"))
    }

    function m(a, b, c, d, e) {
        for (var f, g, h, i, j, m, n = b.createDocumentFragment(), o = [], p = 0, q = a.length; q > p; p++)if (f = a[p], f || 0 === f)if ("object" === fa.type(f))fa.merge(o, f.nodeType ? [f] : f); else if (La.test(f)) {
            for (g = g || n.appendChild(b.createElement("div")), h = (Ia.exec(f) || ["", ""])[1].toLowerCase(), i = Ka[h] || Ka._default, g.innerHTML = i[1] + fa.htmlPrefilter(f) + i[2], m = i[0]; m--;)g = g.lastChild;
            fa.merge(o, g.childNodes), g = n.firstChild, g.textContent = ""
        } else o.push(b.createTextNode(f));
        for (n.textContent = "", p = 0; f = o[p++];)if (d && fa.inArray(f, d) > -1)e && e.push(f); else if (j = fa.contains(f.ownerDocument, f), g = k(n.appendChild(f), "script"), j && l(g), c)for (m = 0; f = g[m++];)Ja.test(f.type || "") && c.push(f);
        return n
    }

    function n() {
        return !0
    }

    function o() {
        return !1
    }

    function p() {
        try {
            return X.activeElement
        } catch (a) {
        }
    }

    function q(a, b, c, d, e, f) {
        var g, h;
        if ("object" == typeof b) {
            "string" != typeof c && (d = d || c, c = void 0);
            for (h in b)q(a, h, c, d, b[h], f);
            return a
        }
        if (null == d && null == e ? (e = c, d = c = void 0) : null == e && ("string" == typeof c ? (e = d, d = void 0) : (e = d, d = c, c = void 0)), e === !1)e = o; else if (!e)return a;
        return 1 === f && (g = e, e = function (a) {
            return fa().off(a), g.apply(this, arguments)
        }, e.guid = g.guid || (g.guid = fa.guid++)), a.each(function () {
            fa.event.add(this, b, e, d, c)
        })
    }

    function r(a, b) {
        return fa.nodeName(a, "table") && fa.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
    }

    function s(a) {
        return a.type = (null !== a.getAttribute("type")) + "/" + a.type, a
    }

    function t(a) {
        var b = Sa.exec(a.type);
        return b ? a.type = b[1] : a.removeAttribute("type"), a
    }

    function u(a, b) {
        var c, d, e, f, g, h, i, j;
        if (1 === b.nodeType) {
            if (za.hasData(a) && (f = za.access(a), g = za.set(b, f), j = f.events)) {
                delete g.handle, g.events = {};
                for (e in j)for (c = 0, d = j[e].length; d > c; c++)fa.event.add(b, e, j[e][c])
            }
            Aa.hasData(a) && (h = Aa.access(a), i = fa.extend({}, h), Aa.set(b, i))
        }
    }

    function v(a, b) {
        var c = b.nodeName.toLowerCase();
        "input" === c && Ha.test(a.type) ? b.checked = a.checked : ("input" === c || "textarea" === c) && (b.defaultValue = a.defaultValue)
    }

    function w(a, b, c, d) {
        b = Z.apply([], b);
        var e, f, g, h, i, j, l = 0, n = a.length, o = n - 1, p = b[0], q = fa.isFunction(p);
        if (q || n > 1 && "string" == typeof p && !da.checkClone && Ra.test(p))return a.each(function (e) {
            var f = a.eq(e);
            q && (b[0] = p.call(this, e, f.html())), w(f, b, c, d)
        });
        if (n && (e = m(b, a[0].ownerDocument, !1, a, d), f = e.firstChild, 1 === e.childNodes.length && (e = f), f || d)) {
            for (g = fa.map(k(e, "script"), s), h = g.length; n > l; l++)i = e, l !== o && (i = fa.clone(i, !0, !0), h && fa.merge(g, k(i, "script"))), c.call(a[l], i, l);
            if (h)for (j = g[g.length - 1].ownerDocument, fa.map(g, t), l = 0; h > l; l++)i = g[l], Ja.test(i.type || "") && !za.access(i, "globalEval") && fa.contains(j, i) && (i.src ? fa._evalUrl && fa._evalUrl(i.src) : fa.globalEval(i.textContent.replace(Ta, "")))
        }
        return a
    }

    function x(a, b, c) {
        for (var d, e = b ? fa.filter(b, a) : a, f = 0; null != (d = e[f]); f++)c || 1 !== d.nodeType || fa.cleanData(k(d)), d.parentNode && (c && fa.contains(d.ownerDocument, d) && l(k(d, "script")), d.parentNode.removeChild(d));
        return a
    }

    function y(a, b) {
        var c = fa(b.createElement(a)).appendTo(b.body), d = fa.css(c[0], "display");
        return c.detach(), d
    }

    function z(a) {
        var b = X, c = Va[a];
        return c || (c = y(a, b), "none" !== c && c || (Ua = (Ua || fa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement), b = Ua[0].contentDocument, b.write(), b.close(), c = y(a, b), Ua.detach()), Va[a] = c), c
    }

    function A(a, b, c) {
        var d, e, f, g, h = a.style;
        return c = c || Ya(a), g = c ? c.getPropertyValue(b) || c[b] : void 0, "" !== g && void 0 !== g || fa.contains(a.ownerDocument, a) || (g = fa.style(a, b)), c && !da.pixelMarginRight() && Xa.test(g) && Wa.test(b) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f), void 0 !== g ? g + "" : g
    }

    function B(a, b) {
        return {
            get: function () {
                return a() ? void delete this.get : (this.get = b).apply(this, arguments)
            }
        }
    }

    function C(a) {
        if (a in db)return a;
        for (var b = a[0].toUpperCase() + a.slice(1), c = cb.length; c--;)if (a = cb[c] + b, a in db)return a
    }

    function D(a, b, c) {
        var d = Ea.exec(b);
        return d ? Math.max(0, d[2] - (c || 0)) + (d[3] || "px") : b
    }

    function E(a, b, c, d, e) {
        for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2)"margin" === c && (g += fa.css(a, c + Fa[f], !0, e)), d ? ("content" === c && (g -= fa.css(a, "padding" + Fa[f], !0, e)), "margin" !== c && (g -= fa.css(a, "border" + Fa[f] + "Width", !0, e))) : (g += fa.css(a, "padding" + Fa[f], !0, e), "padding" !== c && (g += fa.css(a, "border" + Fa[f] + "Width", !0, e)));
        return g
    }

    function F(a, b, c) {
        var d = !0, e = "width" === b ? a.offsetWidth : a.offsetHeight, f = Ya(a), g = "border-box" === fa.css(a, "boxSizing", !1, f);
        if (0 >= e || null == e) {
            if (e = A(a, b, f), (0 > e || null == e) && (e = a.style[b]), Xa.test(e))return e;
            d = g && (da.boxSizingReliable() || e === a.style[b]), e = parseFloat(e) || 0
        }
        return e + E(a, b, c || (g ? "border" : "content"), d, f) + "px"
    }

    function G(a, b) {
        for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++)d = a[g], d.style && (f[g] = za.get(d, "olddisplay"), c = d.style.display, b ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && Ga(d) && (f[g] = za.access(d, "olddisplay", z(d.nodeName)))) : (e = Ga(d), "none" === c && e || za.set(d, "olddisplay", e ? c : fa.css(d, "display"))));
        for (g = 0; h > g; g++)d = a[g], d.style && (b && "none" !== d.style.display && "" !== d.style.display || (d.style.display = b ? f[g] || "" : "none"));
        return a
    }

    function H(a, b, c, d, e) {
        return new H.prototype.init(a, b, c, d, e)
    }

    function I() {
        return a.setTimeout(function () {
            eb = void 0
        }), eb = fa.now()
    }

    function J(a, b) {
        var c, d = 0, e = {height: a};
        for (b = b ? 1 : 0; 4 > d; d += 2 - b)c = Fa[d], e["margin" + c] = e["padding" + c] = a;
        return b && (e.opacity = e.width = a), e
    }

    function K(a, b, c) {
        for (var d, e = (N.tweeners[b] || []).concat(N.tweeners["*"]), f = 0, g = e.length; g > f; f++)if (d = e[f].call(c, b, a))return d
    }

    function L(a, b, c) {
        var d, e, f, g, h, i, j, k, l = this, m = {}, n = a.style, o = a.nodeType && Ga(a), p = za.get(a, "fxshow");
        c.queue || (h = fa._queueHooks(a, "fx"), null == h.unqueued && (h.unqueued = 0, i = h.empty.fire, h.empty.fire = function () {
            h.unqueued || i()
        }), h.unqueued++, l.always(function () {
            l.always(function () {
                h.unqueued--, fa.queue(a, "fx").length || h.empty.fire()
            })
        })), 1 === a.nodeType && ("height" in b || "width" in b) && (c.overflow = [n.overflow, n.overflowX, n.overflowY], j = fa.css(a, "display"), k = "none" === j ? za.get(a, "olddisplay") || z(a.nodeName) : j, "inline" === k && "none" === fa.css(a, "float") && (n.display = "inline-block")), c.overflow && (n.overflow = "hidden", l.always(function () {
            n.overflow = c.overflow[0], n.overflowX = c.overflow[1], n.overflowY = c.overflow[2]
        }));
        for (d in b)if (e = b[d], gb.exec(e)) {
            if (delete b[d], f = f || "toggle" === e, e === (o ? "hide" : "show")) {
                if ("show" !== e || !p || void 0 === p[d])continue;
                o = !0
            }
            m[d] = p && p[d] || fa.style(a, d)
        } else j = void 0;
        if (fa.isEmptyObject(m))"inline" === ("none" === j ? z(a.nodeName) : j) && (n.display = j); else {
            p ? "hidden" in p && (o = p.hidden) : p = za.access(a, "fxshow", {}), f && (p.hidden = !o), o ? fa(a).show() : l.done(function () {
                fa(a).hide()
            }), l.done(function () {
                var b;
                za.remove(a, "fxshow");
                for (b in m)fa.style(a, b, m[b])
            });
            for (d in m)g = K(o ? p[d] : 0, d, l), d in p || (p[d] = g.start, o && (g.end = g.start, g.start = "width" === d || "height" === d ? 1 : 0))
        }
    }

    function M(a, b) {
        var c, d, e, f, g;
        for (c in a)if (d = fa.camelCase(c), e = b[d], f = a[c], fa.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = fa.cssHooks[d], g && "expand" in g) {
            f = g.expand(f), delete a[d];
            for (c in f)c in a || (a[c] = f[c], b[c] = e)
        } else b[d] = e
    }

    function N(a, b, c) {
        var d, e, f = 0, g = N.prefilters.length, h = fa.Deferred().always(function () {
            delete i.elem
        }), i = function () {
            if (e)return !1;
            for (var b = eb || I(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++)j.tweens[g].run(f);
            return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1)
        }, j = h.promise({
            elem: a,
            props: fa.extend({}, b),
            opts: fa.extend(!0, {specialEasing: {}, easing: fa.easing._default}, c),
            originalProperties: b,
            originalOptions: c,
            startTime: eb || I(),
            duration: c.duration,
            tweens: [],
            createTween: function (b, c) {
                var d = fa.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
                return j.tweens.push(d), d
            },
            stop: function (b) {
                var c = 0, d = b ? j.tweens.length : 0;
                if (e)return this;
                for (e = !0; d > c; c++)j.tweens[c].run(1);
                return b ? (h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j, b])) : h.rejectWith(a, [j, b]), this
            }
        }), k = j.props;
        for (M(k, j.opts.specialEasing); g > f; f++)if (d = N.prefilters[f].call(j, a, k, j.opts))return fa.isFunction(d.stop) && (fa._queueHooks(j.elem, j.opts.queue).stop = fa.proxy(d.stop, d)), d;
        return fa.map(k, K, j), fa.isFunction(j.opts.start) && j.opts.start.call(a, j), fa.fx.timer(fa.extend(i, {
            elem: a,
            anim: j,
            queue: j.opts.queue
        })), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always)
    }

    function O(a) {
        return a.getAttribute && a.getAttribute("class") || ""
    }

    function P(a) {
        return function (b, c) {
            "string" != typeof b && (c = b, b = "*");
            var d, e = 0, f = b.toLowerCase().match(va) || [];
            if (fa.isFunction(c))for (; d = f[e++];)"+" === d[0] ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c)
        }
    }

    function Q(a, b, c, d) {
        function e(h) {
            var i;
            return f[h] = !0, fa.each(a[h] || [], function (a, h) {
                var j = h(b, c, d);
                return "string" != typeof j || g || f[j] ? g ? !(i = j) : void 0 : (b.dataTypes.unshift(j), e(j), !1)
            }), i
        }

        var f = {}, g = a === Ab;
        return e(b.dataTypes[0]) || !f["*"] && e("*")
    }

    function R(a, b) {
        var c, d, e = fa.ajaxSettings.flatOptions || {};
        for (c in b)void 0 !== b[c] && ((e[c] ? a : d || (d = {}))[c] = b[c]);
        return d && fa.extend(!0, a, d), a
    }

    function S(a, b, c) {
        for (var d, e, f, g, h = a.contents, i = a.dataTypes; "*" === i[0];)i.shift(), void 0 === d && (d = a.mimeType || b.getResponseHeader("Content-Type"));
        if (d)for (e in h)if (h[e] && h[e].test(d)) {
            i.unshift(e);
            break
        }
        if (i[0] in c)f = i[0]; else {
            for (e in c) {
                if (!i[0] || a.converters[e + " " + i[0]]) {
                    f = e;
                    break
                }
                g || (g = e)
            }
            f = f || g
        }
        return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0
    }

    function T(a, b, c, d) {
        var e, f, g, h, i, j = {}, k = a.dataTypes.slice();
        if (k[1])for (g in a.converters)j[g.toLowerCase()] = a.converters[g];
        for (f = k.shift(); f;)if (a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift())if ("*" === f)f = i; else if ("*" !== i && i !== f) {
            if (g = j[i + " " + f] || j["* " + f], !g)for (e in j)if (h = e.split(" "), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]])) {
                g === !0 ? g = j[e] : j[e] !== !0 && (f = h[0], k.unshift(h[1]));
                break
            }
            if (g !== !0)if (g && a["throws"])b = g(b); else try {
                b = g(b)
            } catch (l) {
                return {state: "parsererror", error: g ? l : "No conversion from " + i + " to " + f}
            }
        }
        return {state: "success", data: b}
    }

    function U(a, b, c, d) {
        var e;
        if (fa.isArray(b))fa.each(b, function (b, e) {
            c || Eb.test(a) ? d(a, e) : U(a + "[" + ("object" == typeof e && null != e ? b : "") + "]", e, c, d)
        }); else if (c || "object" !== fa.type(b))d(a, b); else for (e in b)U(a + "[" + e + "]", b[e], c, d)
    }

    function V(a) {
        return fa.isWindow(a) ? a : 9 === a.nodeType && a.defaultView
    }

    var W = [], X = a.document, Y = W.slice, Z = W.concat, $ = W.push, _ = W.indexOf, aa = {}, ba = aa.toString, ca = aa.hasOwnProperty, da = {}, ea = "2.2.4", fa = function (a, b) {
        return new fa.fn.init(a, b)
    }, ga = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ha = /^-ms-/, ia = /-([\da-z])/gi, ja = function (a, b) {
        return b.toUpperCase()
    };
    fa.fn = fa.prototype = {
        jquery: ea, constructor: fa, selector: "", length: 0, toArray: function () {
            return Y.call(this)
        }, get: function (a) {
            return null != a ? 0 > a ? this[a + this.length] : this[a] : Y.call(this)
        }, pushStack: function (a) {
            var b = fa.merge(this.constructor(), a);
            return b.prevObject = this, b.context = this.context, b
        }, each: function (a) {
            return fa.each(this, a)
        }, map: function (a) {
            return this.pushStack(fa.map(this, function (b, c) {
                return a.call(b, c, b)
            }))
        }, slice: function () {
            return this.pushStack(Y.apply(this, arguments))
        }, first: function () {
            return this.eq(0)
        }, last: function () {
            return this.eq(-1)
        }, eq: function (a) {
            var b = this.length, c = +a + (0 > a ? b : 0);
            return this.pushStack(c >= 0 && b > c ? [this[c]] : [])
        }, end: function () {
            return this.prevObject || this.constructor()
        }, push: $, sort: W.sort, splice: W.splice
    }, fa.extend = fa.fn.extend = function () {
        var a, b, c, d, e, f, g = arguments[0] || {}, h = 1, i = arguments.length, j = !1;
        for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || fa.isFunction(g) || (g = {}), h === i && (g = this, h--); i > h; h++)if (null != (a = arguments[h]))for (b in a)c = g[b], d = a[b], g !== d && (j && d && (fa.isPlainObject(d) || (e = fa.isArray(d))) ? (e ? (e = !1, f = c && fa.isArray(c) ? c : []) : f = c && fa.isPlainObject(c) ? c : {}, g[b] = fa.extend(j, f, d)) : void 0 !== d && (g[b] = d));
        return g
    }, fa.extend({
        expando: "jQuery" + (ea + Math.random()).replace(/\D/g, ""), isReady: !0, error: function (a) {
            throw new Error(a)
        }, noop: function () {
        }, isFunction: function (a) {
            return "function" === fa.type(a)
        }, isArray: Array.isArray, isWindow: function (a) {
            return null != a && a === a.window
        }, isNumeric: function (a) {
            var b = a && a.toString();
            return !fa.isArray(a) && b - parseFloat(b) + 1 >= 0
        }, isPlainObject: function (a) {
            var b;
            if ("object" !== fa.type(a) || a.nodeType || fa.isWindow(a))return !1;
            if (a.constructor && !ca.call(a, "constructor") && !ca.call(a.constructor.prototype || {}, "isPrototypeOf"))return !1;
            for (b in a);
            return void 0 === b || ca.call(a, b)
        }, isEmptyObject: function (a) {
            var b;
            for (b in a)return !1;
            return !0
        }, type: function (a) {
            return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? aa[ba.call(a)] || "object" : typeof a
        }, globalEval: function (a) {
            var b, c = eval;
            a = fa.trim(a), a && (1 === a.indexOf("use strict") ? (b = X.createElement("script"), b.text = a, X.head.appendChild(b).parentNode.removeChild(b)) : c(a))
        }, camelCase: function (a) {
            return a.replace(ha, "ms-").replace(ia, ja)
        }, nodeName: function (a, b) {
            return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase()
        }, each: function (a, b) {
            var d, e = 0;
            if (c(a))for (d = a.length; d > e && b.call(a[e], e, a[e]) !== !1; e++); else for (e in a)if (b.call(a[e], e, a[e]) === !1)break;
            return a
        }, trim: function (a) {
            return null == a ? "" : (a + "").replace(ga, "")
        }, makeArray: function (a, b) {
            var d = b || [];
            return null != a && (c(Object(a)) ? fa.merge(d, "string" == typeof a ? [a] : a) : $.call(d, a)), d
        }, inArray: function (a, b, c) {
            return null == b ? -1 : _.call(b, a, c)
        }, merge: function (a, b) {
            for (var c = +b.length, d = 0, e = a.length; c > d; d++)a[e++] = b[d];
            return a.length = e, a
        }, grep: function (a, b, c) {
            for (var d, e = [], f = 0, g = a.length, h = !c; g > f; f++)d = !b(a[f], f), d !== h && e.push(a[f]);
            return e
        }, map: function (a, b, d) {
            var e, f, g = 0, h = [];
            if (c(a))for (e = a.length; e > g; g++)f = b(a[g], g, d), null != f && h.push(f); else for (g in a)f = b(a[g], g, d), null != f && h.push(f);
            return Z.apply([], h)
        }, guid: 1, proxy: function (a, b) {
            var c, d, e;
            return "string" == typeof b && (c = a[b], b = a, a = c), fa.isFunction(a) ? (d = Y.call(arguments, 2), e = function () {
                return a.apply(b || this, d.concat(Y.call(arguments)))
            }, e.guid = a.guid = a.guid || fa.guid++, e) : void 0
        }, now: Date.now, support: da
    }), "function" == typeof Symbol && (fa.fn[Symbol.iterator] = W[Symbol.iterator]), fa.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (a, b) {
        aa["[object " + b + "]"] = b.toLowerCase()
    });
    var ka = function (a) {
        function b(a, b, c, d) {
            var e, f, g, h, i, j, l, n, o = b && b.ownerDocument, p = b ? b.nodeType : 9;
            if (c = c || [], "string" != typeof a || !a || 1 !== p && 9 !== p && 11 !== p)return c;
            if (!d && ((b ? b.ownerDocument || b : O) !== G && F(b), b = b || G, I)) {
                if (11 !== p && (j = ra.exec(a)))if (e = j[1]) {
                    if (9 === p) {
                        if (!(g = b.getElementById(e)))return c;
                        if (g.id === e)return c.push(g), c
                    } else if (o && (g = o.getElementById(e)) && M(b, g) && g.id === e)return c.push(g), c
                } else {
                    if (j[2])return $.apply(c, b.getElementsByTagName(a)), c;
                    if ((e = j[3]) && v.getElementsByClassName && b.getElementsByClassName)return $.apply(c, b.getElementsByClassName(e)), c
                }
                if (v.qsa && !T[a + " "] && (!J || !J.test(a))) {
                    if (1 !== p)o = b, n = a; else if ("object" !== b.nodeName.toLowerCase()) {
                        for ((h = b.getAttribute("id")) ? h = h.replace(ta, "\\$&") : b.setAttribute("id", h = N), l = z(a), f = l.length, i = ma.test(h) ? "#" + h : "[id='" + h + "']"; f--;)l[f] = i + " " + m(l[f]);
                        n = l.join(","), o = sa.test(a) && k(b.parentNode) || b
                    }
                    if (n)try {
                        return $.apply(c, o.querySelectorAll(n)), c
                    } catch (q) {
                    } finally {
                        h === N && b.removeAttribute("id")
                    }
                }
            }
            return B(a.replace(ha, "$1"), b, c, d)
        }

        function c() {
            function a(c, d) {
                return b.push(c + " ") > w.cacheLength && delete a[b.shift()], a[c + " "] = d
            }

            var b = [];
            return a
        }

        function d(a) {
            return a[N] = !0, a
        }

        function e(a) {
            var b = G.createElement("div");
            try {
                return !!a(b)
            } catch (c) {
                return !1
            } finally {
                b.parentNode && b.parentNode.removeChild(b), b = null
            }
        }

        function f(a, b) {
            for (var c = a.split("|"), d = c.length; d--;)w.attrHandle[c[d]] = b
        }

        function g(a, b) {
            var c = b && a, d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || V) - (~a.sourceIndex || V);
            if (d)return d;
            if (c)for (; c = c.nextSibling;)if (c === b)return -1;
            return a ? 1 : -1
        }

        function h(a) {
            return function (b) {
                var c = b.nodeName.toLowerCase();
                return "input" === c && b.type === a
            }
        }

        function i(a) {
            return function (b) {
                var c = b.nodeName.toLowerCase();
                return ("input" === c || "button" === c) && b.type === a
            }
        }

        function j(a) {
            return d(function (b) {
                return b = +b, d(function (c, d) {
                    for (var e, f = a([], c.length, b), g = f.length; g--;)c[e = f[g]] && (c[e] = !(d[e] = c[e]))
                })
            })
        }

        function k(a) {
            return a && "undefined" != typeof a.getElementsByTagName && a
        }

        function l() {
        }

        function m(a) {
            for (var b = 0, c = a.length, d = ""; c > b; b++)d += a[b].value;
            return d
        }

        function n(a, b, c) {
            var d = b.dir, e = c && "parentNode" === d, f = Q++;
            return b.first ? function (b, c, f) {
                for (; b = b[d];)if (1 === b.nodeType || e)return a(b, c, f)
            } : function (b, c, g) {
                var h, i, j, k = [P, f];
                if (g) {
                    for (; b = b[d];)if ((1 === b.nodeType || e) && a(b, c, g))return !0
                } else for (; b = b[d];)if (1 === b.nodeType || e) {
                    if (j = b[N] || (b[N] = {}), i = j[b.uniqueID] || (j[b.uniqueID] = {}), (h = i[d]) && h[0] === P && h[1] === f)return k[2] = h[2];
                    if (i[d] = k, k[2] = a(b, c, g))return !0
                }
            }
        }

        function o(a) {
            return a.length > 1 ? function (b, c, d) {
                for (var e = a.length; e--;)if (!a[e](b, c, d))return !1;
                return !0
            } : a[0]
        }

        function p(a, c, d) {
            for (var e = 0, f = c.length; f > e; e++)b(a, c[e], d);
            return d
        }

        function q(a, b, c, d, e) {
            for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++)(f = a[h]) && (!c || c(f, d, e)) && (g.push(f), j && b.push(h));
            return g
        }

        function r(a, b, c, e, f, g) {
            return e && !e[N] && (e = r(e)), f && !f[N] && (f = r(f, g)), d(function (d, g, h, i) {
                var j, k, l, m = [], n = [], o = g.length, r = d || p(b || "*", h.nodeType ? [h] : h, []), s = !a || !d && b ? r : q(r, m, a, h, i), t = c ? f || (d ? a : o || e) ? [] : g : s;
                if (c && c(s, t, h, i), e)for (j = q(t, n), e(j, [], h, i), k = j.length; k--;)(l = j[k]) && (t[n[k]] = !(s[n[k]] = l));
                if (d) {
                    if (f || a) {
                        if (f) {
                            for (j = [], k = t.length; k--;)(l = t[k]) && j.push(s[k] = l);
                            f(null, t = [], j, i)
                        }
                        for (k = t.length; k--;)(l = t[k]) && (j = f ? aa(d, l) : m[k]) > -1 && (d[j] = !(g[j] = l))
                    }
                } else t = q(t === g ? t.splice(o, t.length) : t), f ? f(null, g, t, i) : $.apply(g, t)
            })
        }

        function s(a) {
            for (var b, c, d, e = a.length, f = w.relative[a[0].type], g = f || w.relative[" "], h = f ? 1 : 0, i = n(function (a) {
                return a === b
            }, g, !0), j = n(function (a) {
                return aa(b, a) > -1
            }, g, !0), k = [function (a, c, d) {
                var e = !f && (d || c !== C) || ((b = c).nodeType ? i(a, c, d) : j(a, c, d));
                return b = null, e
            }]; e > h; h++)if (c = w.relative[a[h].type])k = [n(o(k), c)]; else {
                if (c = w.filter[a[h].type].apply(null, a[h].matches), c[N]) {
                    for (d = ++h; e > d && !w.relative[a[d].type]; d++);
                    return r(h > 1 && o(k), h > 1 && m(a.slice(0, h - 1).concat({value: " " === a[h - 2].type ? "*" : ""})).replace(ha, "$1"), c, d > h && s(a.slice(h, d)), e > d && s(a = a.slice(d)), e > d && m(a))
                }
                k.push(c)
            }
            return o(k)
        }

        function t(a, c) {
            var e = c.length > 0, f = a.length > 0, g = function (d, g, h, i, j) {
                var k, l, m, n = 0, o = "0", p = d && [], r = [], s = C, t = d || f && w.find.TAG("*", j), u = P += null == s ? 1 : Math.random() || .1, v = t.length;
                for (j && (C = g === G || g || j); o !== v && null != (k = t[o]); o++) {
                    if (f && k) {
                        for (l = 0, g || k.ownerDocument === G || (F(k), h = !I); m = a[l++];)if (m(k, g || G, h)) {
                            i.push(k);
                            break
                        }
                        j && (P = u)
                    }
                    e && ((k = !m && k) && n--, d && p.push(k))
                }
                if (n += o, e && o !== n) {
                    for (l = 0; m = c[l++];)m(p, r, g, h);
                    if (d) {
                        if (n > 0)for (; o--;)p[o] || r[o] || (r[o] = Y.call(i));
                        r = q(r)
                    }
                    $.apply(i, r), j && !d && r.length > 0 && n + c.length > 1 && b.uniqueSort(i)
                }
                return j && (P = u, C = s), p
            };
            return e ? d(g) : g
        }

        var u, v, w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L, M, N = "sizzle" + 1 * new Date, O = a.document, P = 0, Q = 0, R = c(), S = c(), T = c(), U = function (a, b) {
            return a === b && (E = !0), 0
        }, V = 1 << 31, W = {}.hasOwnProperty, X = [], Y = X.pop, Z = X.push, $ = X.push, _ = X.slice, aa = function (a, b) {
            for (var c = 0, d = a.length; d > c; c++)if (a[c] === b)return c;
            return -1
        }, ba = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", ca = "[\\x20\\t\\r\\n\\f]", da = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", ea = "\\[" + ca + "*(" + da + ")(?:" + ca + "*([*^$|!~]?=)" + ca + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + da + "))|)" + ca + "*\\]", fa = ":(" + da + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + ea + ")*)|.*)\\)|)", ga = new RegExp(ca + "+", "g"), ha = new RegExp("^" + ca + "+|((?:^|[^\\\\])(?:\\\\.)*)" + ca + "+$", "g"), ia = new RegExp("^" + ca + "*," + ca + "*"), ja = new RegExp("^" + ca + "*([>+~]|" + ca + ")" + ca + "*"), ka = new RegExp("=" + ca + "*([^\\]'\"]*?)" + ca + "*\\]", "g"), la = new RegExp(fa), ma = new RegExp("^" + da + "$"), na = {
            ID: new RegExp("^#(" + da + ")"),
            CLASS: new RegExp("^\\.(" + da + ")"),
            TAG: new RegExp("^(" + da + "|[*])"),
            ATTR: new RegExp("^" + ea),
            PSEUDO: new RegExp("^" + fa),
            CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + ca + "*(even|odd|(([+-]|)(\\d*)n|)" + ca + "*(?:([+-]|)" + ca + "*(\\d+)|))" + ca + "*\\)|)", "i"),
            bool: new RegExp("^(?:" + ba + ")$", "i"),
            needsContext: new RegExp("^" + ca + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + ca + "*((?:-\\d)?\\d*)" + ca + "*\\)|)(?=[^-]|$)", "i")
        }, oa = /^(?:input|select|textarea|button)$/i, pa = /^h\d$/i, qa = /^[^{]+\{\s*\[native \w/, ra = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, sa = /[+~]/, ta = /'|\\/g, ua = new RegExp("\\\\([\\da-f]{1,6}" + ca + "?|(" + ca + ")|.)", "ig"), va = function (a, b, c) {
            var d = "0x" + b - 65536;
            return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320)
        }, wa = function () {
            F()
        };
        try {
            $.apply(X = _.call(O.childNodes), O.childNodes), X[O.childNodes.length].nodeType
        } catch (xa) {
            $ = {
                apply: X.length ? function (a, b) {
                    Z.apply(a, _.call(b))
                } : function (a, b) {
                    for (var c = a.length, d = 0; a[c++] = b[d++];);
                    a.length = c - 1
                }
            }
        }
        v = b.support = {}, y = b.isXML = function (a) {
            var b = a && (a.ownerDocument || a).documentElement;
            return b ? "HTML" !== b.nodeName : !1
        }, F = b.setDocument = function (a) {
            var b, c, d = a ? a.ownerDocument || a : O;
            return d !== G && 9 === d.nodeType && d.documentElement ? (G = d, H = G.documentElement, I = !y(G), (c = G.defaultView) && c.top !== c && (c.addEventListener ? c.addEventListener("unload", wa, !1) : c.attachEvent && c.attachEvent("onunload", wa)), v.attributes = e(function (a) {
                return a.className = "i", !a.getAttribute("className")
            }), v.getElementsByTagName = e(function (a) {
                return a.appendChild(G.createComment("")), !a.getElementsByTagName("*").length
            }), v.getElementsByClassName = qa.test(G.getElementsByClassName), v.getById = e(function (a) {
                return H.appendChild(a).id = N, !G.getElementsByName || !G.getElementsByName(N).length
            }), v.getById ? (w.find.ID = function (a, b) {
                if ("undefined" != typeof b.getElementById && I) {
                    var c = b.getElementById(a);
                    return c ? [c] : []
                }
            }, w.filter.ID = function (a) {
                var b = a.replace(ua, va);
                return function (a) {
                    return a.getAttribute("id") === b
                }
            }) : (delete w.find.ID, w.filter.ID = function (a) {
                var b = a.replace(ua, va);
                return function (a) {
                    var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id");
                    return c && c.value === b
                }
            }), w.find.TAG = v.getElementsByTagName ? function (a, b) {
                return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : v.qsa ? b.querySelectorAll(a) : void 0
            } : function (a, b) {
                var c, d = [], e = 0, f = b.getElementsByTagName(a);
                if ("*" === a) {
                    for (; c = f[e++];)1 === c.nodeType && d.push(c);
                    return d
                }
                return f
            }, w.find.CLASS = v.getElementsByClassName && function (a, b) {
                    return "undefined" != typeof b.getElementsByClassName && I ? b.getElementsByClassName(a) : void 0
                }, K = [], J = [], (v.qsa = qa.test(G.querySelectorAll)) && (e(function (a) {
                H.appendChild(a).innerHTML = "<a id='" + N + "'></a><select id='" + N + "-\r\\' msallowcapture=''><option selected=''></option></select>", a.querySelectorAll("[msallowcapture^='']").length && J.push("[*^$]=" + ca + "*(?:''|\"\")"), a.querySelectorAll("[selected]").length || J.push("\\[" + ca + "*(?:value|" + ba + ")"), a.querySelectorAll("[id~=" + N + "-]").length || J.push("~="), a.querySelectorAll(":checked").length || J.push(":checked"), a.querySelectorAll("a#" + N + "+*").length || J.push(".#.+[+~]")
            }), e(function (a) {
                var b = G.createElement("input");
                b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && J.push("name" + ca + "*[*^$|!~]?="), a.querySelectorAll(":enabled").length || J.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), J.push(",.*:")
            })), (v.matchesSelector = qa.test(L = H.matches || H.webkitMatchesSelector || H.mozMatchesSelector || H.oMatchesSelector || H.msMatchesSelector)) && e(function (a) {
                v.disconnectedMatch = L.call(a, "div"), L.call(a, "[s!='']:x"), K.push("!=", fa)
            }), J = J.length && new RegExp(J.join("|")), K = K.length && new RegExp(K.join("|")), b = qa.test(H.compareDocumentPosition), M = b || qa.test(H.contains) ? function (a, b) {
                var c = 9 === a.nodeType ? a.documentElement : a, d = b && b.parentNode;
                return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)))
            } : function (a, b) {
                if (b)for (; b = b.parentNode;)if (b === a)return !0;
                return !1
            }, U = b ? function (a, b) {
                if (a === b)return E = !0, 0;
                var c = !a.compareDocumentPosition - !b.compareDocumentPosition;
                return c ? c : (c = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1, 1 & c || !v.sortDetached && b.compareDocumentPosition(a) === c ? a === G || a.ownerDocument === O && M(O, a) ? -1 : b === G || b.ownerDocument === O && M(O, b) ? 1 : D ? aa(D, a) - aa(D, b) : 0 : 4 & c ? -1 : 1)
            } : function (a, b) {
                if (a === b)return E = !0, 0;
                var c, d = 0, e = a.parentNode, f = b.parentNode, h = [a], i = [b];
                if (!e || !f)return a === G ? -1 : b === G ? 1 : e ? -1 : f ? 1 : D ? aa(D, a) - aa(D, b) : 0;
                if (e === f)return g(a, b);
                for (c = a; c = c.parentNode;)h.unshift(c);
                for (c = b; c = c.parentNode;)i.unshift(c);
                for (; h[d] === i[d];)d++;
                return d ? g(h[d], i[d]) : h[d] === O ? -1 : i[d] === O ? 1 : 0
            }, G) : G
        }, b.matches = function (a, c) {
            return b(a, null, null, c)
        }, b.matchesSelector = function (a, c) {
            if ((a.ownerDocument || a) !== G && F(a), c = c.replace(ka, "='$1']"), v.matchesSelector && I && !T[c + " "] && (!K || !K.test(c)) && (!J || !J.test(c)))try {
                var d = L.call(a, c);
                if (d || v.disconnectedMatch || a.document && 11 !== a.document.nodeType)return d
            } catch (e) {
            }
            return b(c, G, null, [a]).length > 0
        }, b.contains = function (a, b) {
            return (a.ownerDocument || a) !== G && F(a), M(a, b)
        }, b.attr = function (a, b) {
            (a.ownerDocument || a) !== G && F(a);
            var c = w.attrHandle[b.toLowerCase()], d = c && W.call(w.attrHandle, b.toLowerCase()) ? c(a, b, !I) : void 0;
            return void 0 !== d ? d : v.attributes || !I ? a.getAttribute(b) : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
        }, b.error = function (a) {
            throw new Error("Syntax error, unrecognized expression: " + a)
        }, b.uniqueSort = function (a) {
            var b, c = [], d = 0, e = 0;
            if (E = !v.detectDuplicates, D = !v.sortStable && a.slice(0), a.sort(U), E) {
                for (; b = a[e++];)b === a[e] && (d = c.push(e));
                for (; d--;)a.splice(c[d], 1)
            }
            return D = null, a
        }, x = b.getText = function (a) {
            var b, c = "", d = 0, e = a.nodeType;
            if (e) {
                if (1 === e || 9 === e || 11 === e) {
                    if ("string" == typeof a.textContent)return a.textContent;
                    for (a = a.firstChild; a; a = a.nextSibling)c += x(a)
                } else if (3 === e || 4 === e)return a.nodeValue
            } else for (; b = a[d++];)c += x(b);
            return c
        }, w = b.selectors = {
            cacheLength: 50,
            createPseudo: d,
            match: na,
            attrHandle: {},
            find: {},
            relative: {
                ">": {dir: "parentNode", first: !0},
                " ": {dir: "parentNode"},
                "+": {dir: "previousSibling", first: !0},
                "~": {dir: "previousSibling"}
            },
            preFilter: {
                ATTR: function (a) {
                    return a[1] = a[1].replace(ua, va), a[3] = (a[3] || a[4] || a[5] || "").replace(ua, va), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4)
                }, CHILD: function (a) {
                    return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || b.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && b.error(a[0]), a
                }, PSEUDO: function (a) {
                    var b, c = !a[6] && a[2];
                    return na.CHILD.test(a[0]) ? null : (a[3] ? a[2] = a[4] || a[5] || "" : c && la.test(c) && (b = z(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), a[2] = c.slice(0, b)), a.slice(0, 3))
                }
            },
            filter: {
                TAG: function (a) {
                    var b = a.replace(ua, va).toLowerCase();
                    return "*" === a ? function () {
                        return !0
                    } : function (a) {
                        return a.nodeName && a.nodeName.toLowerCase() === b
                    }
                }, CLASS: function (a) {
                    var b = R[a + " "];
                    return b || (b = new RegExp("(^|" + ca + ")" + a + "(" + ca + "|$)")) && R(a, function (a) {
                            return b.test("string" == typeof a.className && a.className || "undefined" != typeof a.getAttribute && a.getAttribute("class") || "")
                        })
                }, ATTR: function (a, c, d) {
                    return function (e) {
                        var f = b.attr(e, a);
                        return null == f ? "!=" === c : c ? (f += "", "=" === c ? f === d : "!=" === c ? f !== d : "^=" === c ? d && 0 === f.indexOf(d) : "*=" === c ? d && f.indexOf(d) > -1 : "$=" === c ? d && f.slice(-d.length) === d : "~=" === c ? (" " + f.replace(ga, " ") + " ").indexOf(d) > -1 : "|=" === c ? f === d || f.slice(0, d.length + 1) === d + "-" : !1) : !0
                    }
                }, CHILD: function (a, b, c, d, e) {
                    var f = "nth" !== a.slice(0, 3), g = "last" !== a.slice(-4), h = "of-type" === b;
                    return 1 === d && 0 === e ? function (a) {
                        return !!a.parentNode
                    } : function (b, c, i) {
                        var j, k, l, m, n, o, p = f !== g ? "nextSibling" : "previousSibling", q = b.parentNode, r = h && b.nodeName.toLowerCase(), s = !i && !h, t = !1;
                        if (q) {
                            if (f) {
                                for (; p;) {
                                    for (m = b; m = m[p];)if (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType)return !1;
                                    o = p = "only" === a && !o && "nextSibling"
                                }
                                return !0
                            }
                            if (o = [g ? q.firstChild : q.lastChild], g && s) {
                                for (m = q, l = m[N] || (m[N] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === P && j[1], t = n && j[2], m = n && q.childNodes[n]; m = ++n && m && m[p] || (t = n = 0) || o.pop();)if (1 === m.nodeType && ++t && m === b) {
                                    k[a] = [P, n, t];
                                    break
                                }
                            } else if (s && (m = b, l = m[N] || (m[N] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === P && j[1], t = n), t === !1)for (; (m = ++n && m && m[p] || (t = n = 0) || o.pop()) && ((h ? m.nodeName.toLowerCase() !== r : 1 !== m.nodeType) || !++t || (s && (l = m[N] || (m[N] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), k[a] = [P, t]), m !== b)););
                            return t -= e, t === d || t % d === 0 && t / d >= 0
                        }
                    }
                }, PSEUDO: function (a, c) {
                    var e, f = w.pseudos[a] || w.setFilters[a.toLowerCase()] || b.error("unsupported pseudo: " + a);
                    return f[N] ? f(c) : f.length > 1 ? (e = [a, a, "", c], w.setFilters.hasOwnProperty(a.toLowerCase()) ? d(function (a, b) {
                        for (var d, e = f(a, c), g = e.length; g--;)d = aa(a, e[g]), a[d] = !(b[d] = e[g])
                    }) : function (a) {
                        return f(a, 0, e)
                    }) : f
                }
            },
            pseudos: {
                not: d(function (a) {
                    var b = [], c = [], e = A(a.replace(ha, "$1"));
                    return e[N] ? d(function (a, b, c, d) {
                        for (var f, g = e(a, null, d, []), h = a.length; h--;)(f = g[h]) && (a[h] = !(b[h] = f))
                    }) : function (a, d, f) {
                        return b[0] = a, e(b, null, f, c), b[0] = null, !c.pop()
                    }
                }), has: d(function (a) {
                    return function (c) {
                        return b(a, c).length > 0
                    }
                }), contains: d(function (a) {
                    return a = a.replace(ua, va), function (b) {
                        return (b.textContent || b.innerText || x(b)).indexOf(a) > -1
                    }
                }), lang: d(function (a) {
                    return ma.test(a || "") || b.error("unsupported lang: " + a), a = a.replace(ua, va).toLowerCase(), function (b) {
                        var c;
                        do if (c = I ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang"))return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-"); while ((b = b.parentNode) && 1 === b.nodeType);
                        return !1
                    }
                }), target: function (b) {
                    var c = a.location && a.location.hash;
                    return c && c.slice(1) === b.id
                }, root: function (a) {
                    return a === H
                }, focus: function (a) {
                    return a === G.activeElement && (!G.hasFocus || G.hasFocus()) && !!(a.type || a.href || ~a.tabIndex)
                }, enabled: function (a) {
                    return a.disabled === !1
                }, disabled: function (a) {
                    return a.disabled === !0
                }, checked: function (a) {
                    var b = a.nodeName.toLowerCase();
                    return "input" === b && !!a.checked || "option" === b && !!a.selected
                }, selected: function (a) {
                    return a.parentNode && a.parentNode.selectedIndex, a.selected === !0
                }, empty: function (a) {
                    for (a = a.firstChild; a; a = a.nextSibling)if (a.nodeType < 6)return !1;
                    return !0
                }, parent: function (a) {
                    return !w.pseudos.empty(a)
                }, header: function (a) {
                    return pa.test(a.nodeName)
                }, input: function (a) {
                    return oa.test(a.nodeName)
                }, button: function (a) {
                    var b = a.nodeName.toLowerCase();
                    return "input" === b && "button" === a.type || "button" === b
                }, text: function (a) {
                    var b;
                    return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase())
                }, first: j(function () {
                    return [0]
                }), last: j(function (a, b) {
                    return [b - 1]
                }), eq: j(function (a, b, c) {
                    return [0 > c ? c + b : c]
                }), even: j(function (a, b) {
                    for (var c = 0; b > c; c += 2)a.push(c);
                    return a
                }), odd: j(function (a, b) {
                    for (var c = 1; b > c; c += 2)a.push(c);
                    return a
                }), lt: j(function (a, b, c) {
                    for (var d = 0 > c ? c + b : c; --d >= 0;)a.push(d);
                    return a
                }), gt: j(function (a, b, c) {
                    for (var d = 0 > c ? c + b : c; ++d < b;)a.push(d);
                    return a
                })
            }
        }, w.pseudos.nth = w.pseudos.eq;
        for (u in{radio: !0, checkbox: !0, file: !0, password: !0, image: !0})w.pseudos[u] = h(u);
        for (u in{submit: !0, reset: !0})w.pseudos[u] = i(u);
        return l.prototype = w.filters = w.pseudos, w.setFilters = new l, z = b.tokenize = function (a, c) {
            var d, e, f, g, h, i, j, k = S[a + " "];
            if (k)return c ? 0 : k.slice(0);
            for (h = a, i = [], j = w.preFilter; h;) {
                (!d || (e = ia.exec(h))) && (e && (h = h.slice(e[0].length) || h), i.push(f = [])), d = !1, (e = ja.exec(h)) && (d = e.shift(), f.push({
                    value: d,
                    type: e[0].replace(ha, " ")
                }), h = h.slice(d.length));
                for (g in w.filter)!(e = na[g].exec(h)) || j[g] && !(e = j[g](e)) || (d = e.shift(), f.push({
                    value: d,
                    type: g,
                    matches: e
                }), h = h.slice(d.length));
                if (!d)break
            }
            return c ? h.length : h ? b.error(a) : S(a, i).slice(0)
        }, A = b.compile = function (a, b) {
            var c, d = [], e = [], f = T[a + " "];
            if (!f) {
                for (b || (b = z(a)), c = b.length; c--;)f = s(b[c]), f[N] ? d.push(f) : e.push(f);
                f = T(a, t(e, d)), f.selector = a
            }
            return f
        }, B = b.select = function (a, b, c, d) {
            var e, f, g, h, i, j = "function" == typeof a && a, l = !d && z(a = j.selector || a);
            if (c = c || [], 1 === l.length) {
                if (f = l[0] = l[0].slice(0), f.length > 2 && "ID" === (g = f[0]).type && v.getById && 9 === b.nodeType && I && w.relative[f[1].type]) {
                    if (b = (w.find.ID(g.matches[0].replace(ua, va), b) || [])[0], !b)return c;
                    j && (b = b.parentNode), a = a.slice(f.shift().value.length)
                }
                for (e = na.needsContext.test(a) ? 0 : f.length; e-- && (g = f[e], !w.relative[h = g.type]);)if ((i = w.find[h]) && (d = i(g.matches[0].replace(ua, va), sa.test(f[0].type) && k(b.parentNode) || b))) {
                    if (f.splice(e, 1), a = d.length && m(f), !a)return $.apply(c, d), c;
                    break
                }
            }
            return (j || A(a, l))(d, b, !I, c, !b || sa.test(a) && k(b.parentNode) || b), c
        }, v.sortStable = N.split("").sort(U).join("") === N, v.detectDuplicates = !!E, F(), v.sortDetached = e(function (a) {
            return 1 & a.compareDocumentPosition(G.createElement("div"))
        }), e(function (a) {
            return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href")
        }) || f("type|href|height|width", function (a, b, c) {
            return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2)
        }), v.attributes && e(function (a) {
            return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value")
        }) || f("value", function (a, b, c) {
            return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue
        }), e(function (a) {
            return null == a.getAttribute("disabled")
        }) || f(ba, function (a, b, c) {
            var d;
            return c ? void 0 : a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null
        }), b
    }(a);
    fa.find = ka, fa.expr = ka.selectors, fa.expr[":"] = fa.expr.pseudos, fa.uniqueSort = fa.unique = ka.uniqueSort, fa.text = ka.getText, fa.isXMLDoc = ka.isXML, fa.contains = ka.contains;
    var la = function (a, b, c) {
        for (var d = [], e = void 0 !== c; (a = a[b]) && 9 !== a.nodeType;)if (1 === a.nodeType) {
            if (e && fa(a).is(c))break;
            d.push(a)
        }
        return d
    }, ma = function (a, b) {
        for (var c = []; a; a = a.nextSibling)1 === a.nodeType && a !== b && c.push(a);
        return c
    }, na = fa.expr.match.needsContext, oa = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/, pa = /^.[^:#\[\.,]*$/;
    fa.filter = function (a, b, c) {
        var d = b[0];
        return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? fa.find.matchesSelector(d, a) ? [d] : [] : fa.find.matches(a, fa.grep(b, function (a) {
            return 1 === a.nodeType
        }))
    }, fa.fn.extend({
        find: function (a) {
            var b, c = this.length, d = [], e = this;
            if ("string" != typeof a)return this.pushStack(fa(a).filter(function () {
                for (b = 0; c > b; b++)if (fa.contains(e[b], this))return !0
            }));
            for (b = 0; c > b; b++)fa.find(a, e[b], d);
            return d = this.pushStack(c > 1 ? fa.unique(d) : d), d.selector = this.selector ? this.selector + " " + a : a, d
        }, filter: function (a) {
            return this.pushStack(d(this, a || [], !1))
        }, not: function (a) {
            return this.pushStack(d(this, a || [], !0))
        }, is: function (a) {
            return !!d(this, "string" == typeof a && na.test(a) ? fa(a) : a || [], !1).length
        }
    });
    var qa, ra = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/, sa = fa.fn.init = function (a, b, c) {
        var d, e;
        if (!a)return this;
        if (c = c || qa, "string" == typeof a) {
            if (d = "<" === a[0] && ">" === a[a.length - 1] && a.length >= 3 ? [null, a, null] : ra.exec(a), !d || !d[1] && b)return !b || b.jquery ? (b || c).find(a) : this.constructor(b).find(a);
            if (d[1]) {
                if (b = b instanceof fa ? b[0] : b, fa.merge(this, fa.parseHTML(d[1], b && b.nodeType ? b.ownerDocument || b : X, !0)), oa.test(d[1]) && fa.isPlainObject(b))for (d in b)fa.isFunction(this[d]) ? this[d](b[d]) : this.attr(d, b[d]);
                return this
            }
            return e = X.getElementById(d[2]), e && e.parentNode && (this.length = 1, this[0] = e), this.context = X, this.selector = a, this
        }
        return a.nodeType ? (this.context = this[0] = a, this.length = 1, this) : fa.isFunction(a) ? void 0 !== c.ready ? c.ready(a) : a(fa) : (void 0 !== a.selector && (this.selector = a.selector, this.context = a.context), fa.makeArray(a, this))
    };
    sa.prototype = fa.fn, qa = fa(X);
    var ta = /^(?:parents|prev(?:Until|All))/, ua = {children: !0, contents: !0, next: !0, prev: !0};
    fa.fn.extend({
        has: function (a) {
            var b = fa(a, this), c = b.length;
            return this.filter(function () {
                for (var a = 0; c > a; a++)if (fa.contains(this, b[a]))return !0
            })
        }, closest: function (a, b) {
            for (var c, d = 0, e = this.length, f = [], g = na.test(a) || "string" != typeof a ? fa(a, b || this.context) : 0; e > d; d++)for (c = this[d]; c && c !== b; c = c.parentNode)if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && fa.find.matchesSelector(c, a))) {
                f.push(c);
                break
            }
            return this.pushStack(f.length > 1 ? fa.uniqueSort(f) : f)
        }, index: function (a) {
            return a ? "string" == typeof a ? _.call(fa(a), this[0]) : _.call(this, a.jquery ? a[0] : a) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
        }, add: function (a, b) {
            return this.pushStack(fa.uniqueSort(fa.merge(this.get(), fa(a, b))))
        }, addBack: function (a) {
            return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
        }
    }), fa.each({
        parent: function (a) {
            var b = a.parentNode;
            return b && 11 !== b.nodeType ? b : null
        }, parents: function (a) {
            return la(a, "parentNode")
        }, parentsUntil: function (a, b, c) {
            return la(a, "parentNode", c)
        }, next: function (a) {
            return e(a, "nextSibling")
        }, prev: function (a) {
            return e(a, "previousSibling")
        }, nextAll: function (a) {
            return la(a, "nextSibling")
        }, prevAll: function (a) {
            return la(a, "previousSibling")
        }, nextUntil: function (a, b, c) {
            return la(a, "nextSibling", c)
        }, prevUntil: function (a, b, c) {
            return la(a, "previousSibling", c)
        }, siblings: function (a) {
            return ma((a.parentNode || {}).firstChild, a)
        }, children: function (a) {
            return ma(a.firstChild)
        }, contents: function (a) {
            return a.contentDocument || fa.merge([], a.childNodes)
        }
    }, function (a, b) {
        fa.fn[a] = function (c, d) {
            var e = fa.map(this, b, c);
            return "Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = fa.filter(d, e)), this.length > 1 && (ua[a] || fa.uniqueSort(e), ta.test(a) && e.reverse()), this.pushStack(e)
        }
    });
    var va = /\S+/g;
    fa.Callbacks = function (a) {
        a = "string" == typeof a ? f(a) : fa.extend({}, a);
        var b, c, d, e, g = [], h = [], i = -1, j = function () {
            for (e = a.once, d = b = !0; h.length; i = -1)for (c = h.shift(); ++i < g.length;)g[i].apply(c[0], c[1]) === !1 && a.stopOnFalse && (i = g.length, c = !1);
            a.memory || (c = !1), b = !1, e && (g = c ? [] : "")
        }, k = {
            add: function () {
                return g && (c && !b && (i = g.length - 1, h.push(c)), function d(b) {
                    fa.each(b, function (b, c) {
                        fa.isFunction(c) ? a.unique && k.has(c) || g.push(c) : c && c.length && "string" !== fa.type(c) && d(c)
                    })
                }(arguments), c && !b && j()), this
            }, remove: function () {
                return fa.each(arguments, function (a, b) {
                    for (var c; (c = fa.inArray(b, g, c)) > -1;)g.splice(c, 1), i >= c && i--
                }), this
            }, has: function (a) {
                return a ? fa.inArray(a, g) > -1 : g.length > 0
            }, empty: function () {
                return g && (g = []), this
            }, disable: function () {
                return e = h = [], g = c = "", this
            }, disabled: function () {
                return !g
            }, lock: function () {
                return e = h = [], c || (g = c = ""), this
            }, locked: function () {
                return !!e
            }, fireWith: function (a, c) {
                return e || (c = c || [], c = [a, c.slice ? c.slice() : c], h.push(c), b || j()), this
            }, fire: function () {
                return k.fireWith(this, arguments), this
            }, fired: function () {
                return !!d
            }
        };
        return k
    }, fa.extend({
        Deferred: function (a) {
            var b = [["resolve", "done", fa.Callbacks("once memory"), "resolved"], ["reject", "fail", fa.Callbacks("once memory"), "rejected"], ["notify", "progress", fa.Callbacks("memory")]], c = "pending", d = {
                state: function () {
                    return c
                }, always: function () {
                    return e.done(arguments).fail(arguments), this
                }, then: function () {
                    var a = arguments;
                    return fa.Deferred(function (c) {
                        fa.each(b, function (b, f) {
                            var g = fa.isFunction(a[b]) && a[b];
                            e[f[1]](function () {
                                var a = g && g.apply(this, arguments);
                                a && fa.isFunction(a.promise) ? a.promise().progress(c.notify).done(c.resolve).fail(c.reject) : c[f[0] + "With"](this === d ? c.promise() : this, g ? [a] : arguments)
                            })
                        }), a = null
                    }).promise()
                }, promise: function (a) {
                    return null != a ? fa.extend(a, d) : d
                }
            }, e = {};
            return d.pipe = d.then, fa.each(b, function (a, f) {
                var g = f[2], h = f[3];
                d[f[1]] = g.add, h && g.add(function () {
                    c = h
                }, b[1 ^ a][2].disable, b[2][2].lock), e[f[0]] = function () {
                    return e[f[0] + "With"](this === e ? d : this, arguments), this
                }, e[f[0] + "With"] = g.fireWith
            }), d.promise(e), a && a.call(e, e), e
        }, when: function (a) {
            var b, c, d, e = 0, f = Y.call(arguments), g = f.length, h = 1 !== g || a && fa.isFunction(a.promise) ? g : 0, i = 1 === h ? a : fa.Deferred(), j = function (a, c, d) {
                return function (e) {
                    c[a] = this, d[a] = arguments.length > 1 ? Y.call(arguments) : e, d === b ? i.notifyWith(c, d) : --h || i.resolveWith(c, d)
                }
            };
            if (g > 1)for (b = new Array(g), c = new Array(g), d = new Array(g); g > e; e++)f[e] && fa.isFunction(f[e].promise) ? f[e].promise().progress(j(e, c, b)).done(j(e, d, f)).fail(i.reject) : --h;
            return h || i.resolveWith(d, f), i.promise()
        }
    });
    var wa;
    fa.fn.ready = function (a) {
        return fa.ready.promise().done(a), this
    }, fa.extend({
        isReady: !1, readyWait: 1, holdReady: function (a) {
            a ? fa.readyWait++ : fa.ready(!0)
        }, ready: function (a) {
            (a === !0 ? --fa.readyWait : fa.isReady) || (fa.isReady = !0, a !== !0 && --fa.readyWait > 0 || (wa.resolveWith(X, [fa]), fa.fn.triggerHandler && (fa(X).triggerHandler("ready"), fa(X).off("ready"))))
        }
    }), fa.ready.promise = function (b) {
        return wa || (wa = fa.Deferred(), "complete" === X.readyState || "loading" !== X.readyState && !X.documentElement.doScroll ? a.setTimeout(fa.ready) : (X.addEventListener("DOMContentLoaded", g), a.addEventListener("load", g))), wa.promise(b)
    }, fa.ready.promise();
    var xa = function (a, b, c, d, e, f, g) {
        var h = 0, i = a.length, j = null == c;
        if ("object" === fa.type(c)) {
            e = !0;
            for (h in c)xa(a, b, h, c[h], !0, f, g)
        } else if (void 0 !== d && (e = !0, fa.isFunction(d) || (g = !0), j && (g ? (b.call(a, d), b = null) : (j = b, b = function (a, b, c) {
                return j.call(fa(a), c)
            })), b))for (; i > h; h++)b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
        return e ? a : j ? b.call(a) : i ? b(a[0], c) : f
    }, ya = function (a) {
        return 1 === a.nodeType || 9 === a.nodeType || !+a.nodeType
    };
    h.uid = 1, h.prototype = {
        register: function (a, b) {
            var c = b || {};
            return a.nodeType ? a[this.expando] = c : Object.defineProperty(a, this.expando, {
                value: c,
                writable: !0,
                configurable: !0
            }), a[this.expando]
        }, cache: function (a) {
            if (!ya(a))return {};
            var b = a[this.expando];
            return b || (b = {}, ya(a) && (a.nodeType ? a[this.expando] = b : Object.defineProperty(a, this.expando, {
                value: b,
                configurable: !0
            }))), b
        }, set: function (a, b, c) {
            var d, e = this.cache(a);
            if ("string" == typeof b)e[b] = c; else for (d in b)e[d] = b[d];
            return e
        }, get: function (a, b) {
            return void 0 === b ? this.cache(a) : a[this.expando] && a[this.expando][b]
        }, access: function (a, b, c) {
            var d;
            return void 0 === b || b && "string" == typeof b && void 0 === c ? (d = this.get(a, b), void 0 !== d ? d : this.get(a, fa.camelCase(b))) : (this.set(a, b, c), void 0 !== c ? c : b)
        }, remove: function (a, b) {
            var c, d, e, f = a[this.expando];
            if (void 0 !== f) {
                if (void 0 === b)this.register(a); else {
                    fa.isArray(b) ? d = b.concat(b.map(fa.camelCase)) : (e = fa.camelCase(b), b in f ? d = [b, e] : (d = e, d = d in f ? [d] : d.match(va) || [])), c = d.length;
                    for (; c--;)delete f[d[c]]
                }
                (void 0 === b || fa.isEmptyObject(f)) && (a.nodeType ? a[this.expando] = void 0 : delete a[this.expando])
            }
        }, hasData: function (a) {
            var b = a[this.expando];
            return void 0 !== b && !fa.isEmptyObject(b)
        }
    };
    var za = new h, Aa = new h, Ba = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, Ca = /[A-Z]/g;
    fa.extend({
        hasData: function (a) {
            return Aa.hasData(a) || za.hasData(a)
        }, data: function (a, b, c) {
            return Aa.access(a, b, c)
        }, removeData: function (a, b) {
            Aa.remove(a, b)
        }, _data: function (a, b, c) {
            return za.access(a, b, c)
        }, _removeData: function (a, b) {
            za.remove(a, b)
        }
    }), fa.fn.extend({
        data: function (a, b) {
            var c, d, e, f = this[0], g = f && f.attributes;
            if (void 0 === a) {
                if (this.length && (e = Aa.get(f), 1 === f.nodeType && !za.get(f, "hasDataAttrs"))) {
                    for (c = g.length; c--;)g[c] && (d = g[c].name, 0 === d.indexOf("data-") && (d = fa.camelCase(d.slice(5)), i(f, d, e[d])));
                    za.set(f, "hasDataAttrs", !0)
                }
                return e
            }
            return "object" == typeof a ? this.each(function () {
                Aa.set(this, a)
            }) : xa(this, function (b) {
                var c, d;
                if (f && void 0 === b) {
                    if (c = Aa.get(f, a) || Aa.get(f, a.replace(Ca, "-$&").toLowerCase()), void 0 !== c)return c;
                    if (d = fa.camelCase(a), c = Aa.get(f, d), void 0 !== c)return c;
                    if (c = i(f, d, void 0), void 0 !== c)return c
                } else d = fa.camelCase(a), this.each(function () {
                    var c = Aa.get(this, d);
                    Aa.set(this, d, b), a.indexOf("-") > -1 && void 0 !== c && Aa.set(this, a, b)
                })
            }, null, b, arguments.length > 1, null, !0)
        }, removeData: function (a) {
            return this.each(function () {
                Aa.remove(this, a)
            })
        }
    }), fa.extend({
        queue: function (a, b, c) {
            var d;
            return a ? (b = (b || "fx") + "queue", d = za.get(a, b), c && (!d || fa.isArray(c) ? d = za.access(a, b, fa.makeArray(c)) : d.push(c)), d || []) : void 0
        }, dequeue: function (a, b) {
            b = b || "fx";
            var c = fa.queue(a, b), d = c.length, e = c.shift(), f = fa._queueHooks(a, b), g = function () {
                fa.dequeue(a, b)
            };
            "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire()
        }, _queueHooks: function (a, b) {
            var c = b + "queueHooks";
            return za.get(a, c) || za.access(a, c, {
                    empty: fa.Callbacks("once memory").add(function () {
                        za.remove(a, [b + "queue", c])
                    })
                })
        }
    }), fa.fn.extend({
        queue: function (a, b) {
            var c = 2;
            return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? fa.queue(this[0], a) : void 0 === b ? this : this.each(function () {
                var c = fa.queue(this, a, b);
                fa._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && fa.dequeue(this, a)
            })
        }, dequeue: function (a) {
            return this.each(function () {
                fa.dequeue(this, a)
            })
        }, clearQueue: function (a) {
            return this.queue(a || "fx", [])
        }, promise: function (a, b) {
            var c, d = 1, e = fa.Deferred(), f = this, g = this.length, h = function () {
                --d || e.resolveWith(f, [f])
            };
            for ("string" != typeof a && (b = a, a = void 0), a = a || "fx"; g--;)c = za.get(f[g], a + "queueHooks"), c && c.empty && (d++, c.empty.add(h));
            return h(), e.promise(b)
        }
    });
    var Da = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, Ea = new RegExp("^(?:([+-])=|)(" + Da + ")([a-z%]*)$", "i"), Fa = ["Top", "Right", "Bottom", "Left"], Ga = function (a, b) {
        return a = b || a, "none" === fa.css(a, "display") || !fa.contains(a.ownerDocument, a)
    }, Ha = /^(?:checkbox|radio)$/i, Ia = /<([\w:-]+)/, Ja = /^$|\/(?:java|ecma)script/i, Ka = {
        option: [1, "<select multiple='multiple'>", "</select>"],
        thead: [1, "<table>", "</table>"],
        col: [2, "<table><colgroup>", "</colgroup></table>"],
        tr: [2, "<table><tbody>", "</tbody></table>"],
        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
        _default: [0, "", ""]
    };
    Ka.optgroup = Ka.option, Ka.tbody = Ka.tfoot = Ka.colgroup = Ka.caption = Ka.thead, Ka.th = Ka.td;
    var La = /<|&#?\w+;/;
    !function () {
        var a = X.createDocumentFragment(), b = a.appendChild(X.createElement("div")), c = X.createElement("input");
        c.setAttribute("type", "radio"), c.setAttribute("checked", "checked"), c.setAttribute("name", "t"), b.appendChild(c), da.checkClone = b.cloneNode(!0).cloneNode(!0).lastChild.checked, b.innerHTML = "<textarea>x</textarea>", da.noCloneChecked = !!b.cloneNode(!0).lastChild.defaultValue
    }();
    var Ma = /^key/, Na = /^(?:mouse|pointer|contextmenu|drag|drop)|click/, Oa = /^([^.]*)(?:\.(.+)|)/;
    fa.event = {
        global: {},
        add: function (a, b, c, d, e) {
            var f, g, h, i, j, k, l, m, n, o, p, q = za.get(a);
            if (q)for (c.handler && (f = c, c = f.handler, e = f.selector), c.guid || (c.guid = fa.guid++), (i = q.events) || (i = q.events = {}), (g = q.handle) || (g = q.handle = function (b) {
                return "undefined" != typeof fa && fa.event.triggered !== b.type ? fa.event.dispatch.apply(a, arguments) : void 0
            }), b = (b || "").match(va) || [""], j = b.length; j--;)h = Oa.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n && (l = fa.event.special[n] || {}, n = (e ? l.delegateType : l.bindType) || n, l = fa.event.special[n] || {}, k = fa.extend({
                type: n,
                origType: p,
                data: d,
                handler: c,
                guid: c.guid,
                selector: e,
                needsContext: e && fa.expr.match.needsContext.test(e),
                namespace: o.join(".")
            }, f), (m = i[n]) || (m = i[n] = [], m.delegateCount = 0, l.setup && l.setup.call(a, d, o, g) !== !1 || a.addEventListener && a.addEventListener(n, g)), l.add && (l.add.call(a, k), k.handler.guid || (k.handler.guid = c.guid)), e ? m.splice(m.delegateCount++, 0, k) : m.push(k), fa.event.global[n] = !0)
        },
        remove: function (a, b, c, d, e) {
            var f, g, h, i, j, k, l, m, n, o, p, q = za.hasData(a) && za.get(a);
            if (q && (i = q.events)) {
                for (b = (b || "").match(va) || [""], j = b.length; j--;)if (h = Oa.exec(b[j]) || [], n = p = h[1], o = (h[2] || "").split(".").sort(), n) {
                    for (l = fa.event.special[n] || {}, n = (d ? l.delegateType : l.bindType) || n, m = i[n] || [], h = h[2] && new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)"), g = f = m.length; f--;)k = m[f], !e && p !== k.origType || c && c.guid !== k.guid || h && !h.test(k.namespace) || d && d !== k.selector && ("**" !== d || !k.selector) || (m.splice(f, 1), k.selector && m.delegateCount--, l.remove && l.remove.call(a, k));
                    g && !m.length && (l.teardown && l.teardown.call(a, o, q.handle) !== !1 || fa.removeEvent(a, n, q.handle), delete i[n])
                } else for (n in i)fa.event.remove(a, n + b[j], c, d, !0);
                fa.isEmptyObject(i) && za.remove(a, "handle events")
            }
        },
        dispatch: function (a) {
            a = fa.event.fix(a);
            var b, c, d, e, f, g = [], h = Y.call(arguments), i = (za.get(this, "events") || {})[a.type] || [], j = fa.event.special[a.type] || {};
            if (h[0] = a, a.delegateTarget = this, !j.preDispatch || j.preDispatch.call(this, a) !== !1) {
                for (g = fa.event.handlers.call(this, a, i), b = 0; (e = g[b++]) && !a.isPropagationStopped();)for (a.currentTarget = e.elem, c = 0; (f = e.handlers[c++]) && !a.isImmediatePropagationStopped();)(!a.rnamespace || a.rnamespace.test(f.namespace)) && (a.handleObj = f, a.data = f.data, d = ((fa.event.special[f.origType] || {}).handle || f.handler).apply(e.elem, h), void 0 !== d && (a.result = d) === !1 && (a.preventDefault(), a.stopPropagation()));
                return j.postDispatch && j.postDispatch.call(this, a), a.result
            }
        },
        handlers: function (a, b) {
            var c, d, e, f, g = [], h = b.delegateCount, i = a.target;
            if (h && i.nodeType && ("click" !== a.type || isNaN(a.button) || a.button < 1))for (; i !== this; i = i.parentNode || this)if (1 === i.nodeType && (i.disabled !== !0 || "click" !== a.type)) {
                for (d = [], c = 0; h > c; c++)f = b[c], e = f.selector + " ", void 0 === d[e] && (d[e] = f.needsContext ? fa(e, this).index(i) > -1 : fa.find(e, this, null, [i]).length), d[e] && d.push(f);
                d.length && g.push({elem: i, handlers: d})
            }
            return h < b.length && g.push({elem: this, handlers: b.slice(h)}), g
        },
        props: "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "), filter: function (a, b) {
                return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function (a, b) {
                var c, d, e, f = b.button;
                return null == a.pageX && null != b.clientX && (c = a.target.ownerDocument || X, d = c.documentElement, e = c.body, a.pageX = b.clientX + (d && d.scrollLeft || e && e.scrollLeft || 0) - (d && d.clientLeft || e && e.clientLeft || 0), a.pageY = b.clientY + (d && d.scrollTop || e && e.scrollTop || 0) - (d && d.clientTop || e && e.clientTop || 0)), a.which || void 0 === f || (a.which = 1 & f ? 1 : 2 & f ? 3 : 4 & f ? 2 : 0), a
            }
        },
        fix: function (a) {
            if (a[fa.expando])return a;
            var b, c, d, e = a.type, f = a, g = this.fixHooks[e];
            for (g || (this.fixHooks[e] = g = Na.test(e) ? this.mouseHooks : Ma.test(e) ? this.keyHooks : {}), d = g.props ? this.props.concat(g.props) : this.props, a = new fa.Event(f), b = d.length; b--;)c = d[b], a[c] = f[c];
            return a.target || (a.target = X), 3 === a.target.nodeType && (a.target = a.target.parentNode), g.filter ? g.filter(a, f) : a
        },
        special: {
            load: {noBubble: !0}, focus: {
                trigger: function () {
                    return this !== p() && this.focus ? (this.focus(), !1) : void 0
                }, delegateType: "focusin"
            }, blur: {
                trigger: function () {
                    return this === p() && this.blur ? (this.blur(), !1) : void 0
                }, delegateType: "focusout"
            }, click: {
                trigger: function () {
                    return "checkbox" === this.type && this.click && fa.nodeName(this, "input") ? (this.click(), !1) : void 0
                }, _default: function (a) {
                    return fa.nodeName(a.target, "a")
                }
            }, beforeunload: {
                postDispatch: function (a) {
                    void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result)
                }
            }
        }
    }, fa.removeEvent = function (a, b, c) {
        a.removeEventListener && a.removeEventListener(b, c)
    }, fa.Event = function (a, b) {
        return this instanceof fa.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && a.returnValue === !1 ? n : o) : this.type = a, b && fa.extend(this, b), this.timeStamp = a && a.timeStamp || fa.now(), void(this[fa.expando] = !0)) : new fa.Event(a, b)
    }, fa.Event.prototype = {
        constructor: fa.Event,
        isDefaultPrevented: o,
        isPropagationStopped: o,
        isImmediatePropagationStopped: o,
        isSimulated: !1,
        preventDefault: function () {
            var a = this.originalEvent;
            this.isDefaultPrevented = n, a && !this.isSimulated && a.preventDefault()
        },
        stopPropagation: function () {
            var a = this.originalEvent;
            this.isPropagationStopped = n, a && !this.isSimulated && a.stopPropagation()
        },
        stopImmediatePropagation: function () {
            var a = this.originalEvent;
            this.isImmediatePropagationStopped = n, a && !this.isSimulated && a.stopImmediatePropagation(), this.stopPropagation()
        }
    }, fa.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function (a, b) {
        fa.event.special[a] = {
            delegateType: b, bindType: b, handle: function (a) {
                var c, d = this, e = a.relatedTarget, f = a.handleObj;
                return (!e || e !== d && !fa.contains(d, e)) && (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c
            }
        }
    }), fa.fn.extend({
        on: function (a, b, c, d) {
            return q(this, a, b, c, d)
        }, one: function (a, b, c, d) {
            return q(this, a, b, c, d, 1)
        }, off: function (a, b, c) {
            var d, e;
            if (a && a.preventDefault && a.handleObj)return d = a.handleObj, fa(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
            if ("object" == typeof a) {
                for (e in a)this.off(e, b, a[e]);
                return this
            }
            return (b === !1 || "function" == typeof b) && (c = b, b = void 0), c === !1 && (c = o), this.each(function () {
                fa.event.remove(this, a, c, b)
            })
        }
    });
    var Pa = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi, Qa = /<script|<style|<link/i, Ra = /checked\s*(?:[^=]|=\s*.checked.)/i, Sa = /^true\/(.*)/, Ta = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;
    fa.extend({
        htmlPrefilter: function (a) {
            return a.replace(Pa, "<$1></$2>")
        }, clone: function (a, b, c) {
            var d, e, f, g, h = a.cloneNode(!0), i = fa.contains(a.ownerDocument, a);
            if (!(da.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || fa.isXMLDoc(a)))for (g = k(h), f = k(a), d = 0, e = f.length; e > d; d++)v(f[d], g[d]);
            if (b)if (c)for (f = f || k(a), g = g || k(h), d = 0, e = f.length; e > d; d++)u(f[d], g[d]); else u(a, h);
            return g = k(h, "script"), g.length > 0 && l(g, !i && k(a, "script")), h
        }, cleanData: function (a) {
            for (var b, c, d, e = fa.event.special, f = 0; void 0 !== (c = a[f]); f++)if (ya(c)) {
                if (b = c[za.expando]) {
                    if (b.events)for (d in b.events)e[d] ? fa.event.remove(c, d) : fa.removeEvent(c, d, b.handle);
                    c[za.expando] = void 0
                }
                c[Aa.expando] && (c[Aa.expando] = void 0)
            }
        }
    }), fa.fn.extend({
        domManip: w, detach: function (a) {
            return x(this, a, !0)
        }, remove: function (a) {
            return x(this, a)
        }, text: function (a) {
            return xa(this, function (a) {
                return void 0 === a ? fa.text(this) : this.empty().each(function () {
                    (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) && (this.textContent = a)
                })
            }, null, a, arguments.length)
        }, append: function () {
            return w(this, arguments, function (a) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var b = r(this, a);
                    b.appendChild(a)
                }
            })
        }, prepend: function () {
            return w(this, arguments, function (a) {
                if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                    var b = r(this, a);
                    b.insertBefore(a, b.firstChild)
                }
            })
        }, before: function () {
            return w(this, arguments, function (a) {
                this.parentNode && this.parentNode.insertBefore(a, this)
            })
        }, after: function () {
            return w(this, arguments, function (a) {
                this.parentNode && this.parentNode.insertBefore(a, this.nextSibling)
            })
        }, empty: function () {
            for (var a, b = 0; null != (a = this[b]); b++)1 === a.nodeType && (fa.cleanData(k(a, !1)), a.textContent = "");
            return this
        }, clone: function (a, b) {
            return a = null == a ? !1 : a, b = null == b ? a : b, this.map(function () {
                return fa.clone(this, a, b)
            })
        }, html: function (a) {
            return xa(this, function (a) {
                var b = this[0] || {}, c = 0, d = this.length;
                if (void 0 === a && 1 === b.nodeType)return b.innerHTML;
                if ("string" == typeof a && !Qa.test(a) && !Ka[(Ia.exec(a) || ["", ""])[1].toLowerCase()]) {
                    a = fa.htmlPrefilter(a);
                    try {
                        for (; d > c; c++)b = this[c] || {}, 1 === b.nodeType && (fa.cleanData(k(b, !1)), b.innerHTML = a);
                        b = 0
                    } catch (e) {
                    }
                }
                b && this.empty().append(a)
            }, null, a, arguments.length)
        }, replaceWith: function () {
            var a = [];
            return w(this, arguments, function (b) {
                var c = this.parentNode;
                fa.inArray(this, a) < 0 && (fa.cleanData(k(this)), c && c.replaceChild(b, this))
            }, a)
        }
    }), fa.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function (a, b) {
        fa.fn[a] = function (a) {
            for (var c, d = [], e = fa(a), f = e.length - 1, g = 0; f >= g; g++)c = g === f ? this : this.clone(!0), fa(e[g])[b](c), $.apply(d, c.get());
            return this.pushStack(d)
        }
    });
    var Ua, Va = {
        HTML: "block",
        BODY: "block"
    }, Wa = /^margin/, Xa = new RegExp("^(" + Da + ")(?!px)[a-z%]+$", "i"), Ya = function (b) {
        var c = b.ownerDocument.defaultView;
        return c && c.opener || (c = a), c.getComputedStyle(b)
    }, Za = function (a, b, c, d) {
        var e, f, g = {};
        for (f in b)g[f] = a.style[f], a.style[f] = b[f];
        e = c.apply(a, d || []);
        for (f in b)a.style[f] = g[f];
        return e
    }, $a = X.documentElement;
    !function () {
        function b() {
            h.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%", h.innerHTML = "", $a.appendChild(g);
            var b = a.getComputedStyle(h);
            c = "1%" !== b.top, f = "2px" === b.marginLeft, d = "4px" === b.width, h.style.marginRight = "50%", e = "4px" === b.marginRight, $a.removeChild(g)
        }

        var c, d, e, f, g = X.createElement("div"), h = X.createElement("div");
        h.style && (h.style.backgroundClip = "content-box", h.cloneNode(!0).style.backgroundClip = "", da.clearCloneStyle = "content-box" === h.style.backgroundClip, g.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute", g.appendChild(h), fa.extend(da, {
            pixelPosition: function () {
                return b(), c
            }, boxSizingReliable: function () {
                return null == d && b(), d
            }, pixelMarginRight: function () {
                return null == d && b(), e
            }, reliableMarginLeft: function () {
                return null == d && b(), f
            }, reliableMarginRight: function () {
                var b, c = h.appendChild(X.createElement("div"));
                return c.style.cssText = h.style.cssText = "-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0", c.style.marginRight = c.style.width = "0", h.style.width = "1px", $a.appendChild(g), b = !parseFloat(a.getComputedStyle(c).marginRight), $a.removeChild(g), h.removeChild(c), b
            }
        }))
    }();
    var _a = /^(none|table(?!-c[ea]).+)/, ab = {
        position: "absolute",
        visibility: "hidden",
        display: "block"
    }, bb = {
        letterSpacing: "0",
        fontWeight: "400"
    }, cb = ["Webkit", "O", "Moz", "ms"], db = X.createElement("div").style;
    fa.extend({
        cssHooks: {
            opacity: {
                get: function (a, b) {
                    if (b) {
                        var c = A(a, "opacity");
                        return "" === c ? "1" : c
                    }
                }
            }
        },
        cssNumber: {
            animationIterationCount: !0,
            columnCount: !0,
            fillOpacity: !0,
            flexGrow: !0,
            flexShrink: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: {"float": "cssFloat"},
        style: function (a, b, c, d) {
            if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                var e, f, g, h = fa.camelCase(b), i = a.style;
                return b = fa.cssProps[h] || (fa.cssProps[h] = C(h) || h), g = fa.cssHooks[b] || fa.cssHooks[h], void 0 === c ? g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b] : (f = typeof c, "string" === f && (e = Ea.exec(c)) && e[1] && (c = j(a, b, e), f = "number"), null != c && c === c && ("number" === f && (c += e && e[3] || (fa.cssNumber[h] ? "" : "px")), da.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"), g && "set" in g && void 0 === (c = g.set(a, c, d)) || (i[b] = c)), void 0)
            }
        },
        css: function (a, b, c, d) {
            var e, f, g, h = fa.camelCase(b);
            return b = fa.cssProps[h] || (fa.cssProps[h] = C(h) || h), g = fa.cssHooks[b] || fa.cssHooks[h], g && "get" in g && (e = g.get(a, !0, c)), void 0 === e && (e = A(a, b, d)), "normal" === e && b in bb && (e = bb[b]), "" === c || c ? (f = parseFloat(e), c === !0 || isFinite(f) ? f || 0 : e) : e
        }
    }), fa.each(["height", "width"], function (a, b) {
        fa.cssHooks[b] = {
            get: function (a, c, d) {
                return c ? _a.test(fa.css(a, "display")) && 0 === a.offsetWidth ? Za(a, ab, function () {
                    return F(a, b, d)
                }) : F(a, b, d) : void 0
            }, set: function (a, c, d) {
                var e, f = d && Ya(a), g = d && E(a, b, d, "border-box" === fa.css(a, "boxSizing", !1, f), f);
                return g && (e = Ea.exec(c)) && "px" !== (e[3] || "px") && (a.style[b] = c, c = fa.css(a, b)), D(a, c, g)
            }
        }
    }), fa.cssHooks.marginLeft = B(da.reliableMarginLeft, function (a, b) {
        return b ? (parseFloat(A(a, "marginLeft")) || a.getBoundingClientRect().left - Za(a, {marginLeft: 0}, function () {
            return a.getBoundingClientRect().left
        })) + "px" : void 0
    }), fa.cssHooks.marginRight = B(da.reliableMarginRight, function (a, b) {
        return b ? Za(a, {display: "inline-block"}, A, [a, "marginRight"]) : void 0
    }), fa.each({margin: "", padding: "", border: "Width"}, function (a, b) {
        fa.cssHooks[a + b] = {
            expand: function (c) {
                for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++)e[a + Fa[d] + b] = f[d] || f[d - 2] || f[0];
                return e
            }
        }, Wa.test(a) || (fa.cssHooks[a + b].set = D)
    }), fa.fn.extend({
        css: function (a, b) {
            return xa(this, function (a, b, c) {
                var d, e, f = {}, g = 0;
                if (fa.isArray(b)) {
                    for (d = Ya(a), e = b.length; e > g; g++)f[b[g]] = fa.css(a, b[g], !1, d);
                    return f
                }
                return void 0 !== c ? fa.style(a, b, c) : fa.css(a, b)
            }, a, b, arguments.length > 1)
        }, show: function () {
            return G(this, !0)
        }, hide: function () {
            return G(this)
        }, toggle: function (a) {
            return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function () {
                Ga(this) ? fa(this).show() : fa(this).hide()
            })
        }
    }), fa.Tween = H, H.prototype = {
        constructor: H, init: function (a, b, c, d, e, f) {
            this.elem = a, this.prop = c, this.easing = e || fa.easing._default, this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (fa.cssNumber[c] ? "" : "px")
        }, cur: function () {
            var a = H.propHooks[this.prop];
            return a && a.get ? a.get(this) : H.propHooks._default.get(this)
        }, run: function (a) {
            var b, c = H.propHooks[this.prop];
            return this.options.duration ? this.pos = b = fa.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : H.propHooks._default.set(this), this
        }
    }, H.prototype.init.prototype = H.prototype, H.propHooks = {
        _default: {
            get: function (a) {
                var b;
                return 1 !== a.elem.nodeType || null != a.elem[a.prop] && null == a.elem.style[a.prop] ? a.elem[a.prop] : (b = fa.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0)
            }, set: function (a) {
                fa.fx.step[a.prop] ? fa.fx.step[a.prop](a) : 1 !== a.elem.nodeType || null == a.elem.style[fa.cssProps[a.prop]] && !fa.cssHooks[a.prop] ? a.elem[a.prop] = a.now : fa.style(a.elem, a.prop, a.now + a.unit)
            }
        }
    }, H.propHooks.scrollTop = H.propHooks.scrollLeft = {
        set: function (a) {
            a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now)
        }
    }, fa.easing = {
        linear: function (a) {
            return a
        }, swing: function (a) {
            return .5 - Math.cos(a * Math.PI) / 2
        }, _default: "swing"
    }, fa.fx = H.prototype.init, fa.fx.step = {};
    var eb, fb, gb = /^(?:toggle|show|hide)$/, hb = /queueHooks$/;
    fa.Animation = fa.extend(N, {
        tweeners: {
            "*": [function (a, b) {
                var c = this.createTween(a, b);
                return j(c.elem, a, Ea.exec(b), c), c
            }]
        }, tweener: function (a, b) {
            fa.isFunction(a) ? (b = a, a = ["*"]) : a = a.match(va);
            for (var c, d = 0, e = a.length; e > d; d++)c = a[d], N.tweeners[c] = N.tweeners[c] || [], N.tweeners[c].unshift(b)
        }, prefilters: [L], prefilter: function (a, b) {
            b ? N.prefilters.unshift(a) : N.prefilters.push(a)
        }
    }), fa.speed = function (a, b, c) {
        var d = a && "object" == typeof a ? fa.extend({}, a) : {
            complete: c || !c && b || fa.isFunction(a) && a,
            duration: a,
            easing: c && b || b && !fa.isFunction(b) && b
        };
        return d.duration = fa.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in fa.fx.speeds ? fa.fx.speeds[d.duration] : fa.fx.speeds._default, (null == d.queue || d.queue === !0) && (d.queue = "fx"), d.old = d.complete, d.complete = function () {
            fa.isFunction(d.old) && d.old.call(this), d.queue && fa.dequeue(this, d.queue)
        }, d
    }, fa.fn.extend({
        fadeTo: function (a, b, c, d) {
            return this.filter(Ga).css("opacity", 0).show().end().animate({opacity: b}, a, c, d)
        }, animate: function (a, b, c, d) {
            var e = fa.isEmptyObject(a), f = fa.speed(b, c, d), g = function () {
                var b = N(this, fa.extend({}, a), f);
                (e || za.get(this, "finish")) && b.stop(!0)
            };
            return g.finish = g, e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g)
        }, stop: function (a, b, c) {
            var d = function (a) {
                var b = a.stop;
                delete a.stop, b(c)
            };
            return "string" != typeof a && (c = b, b = a, a = void 0), b && a !== !1 && this.queue(a || "fx", []), this.each(function () {
                var b = !0, e = null != a && a + "queueHooks", f = fa.timers, g = za.get(this);
                if (e)g[e] && g[e].stop && d(g[e]); else for (e in g)g[e] && g[e].stop && hb.test(e) && d(g[e]);
                for (e = f.length; e--;)f[e].elem !== this || null != a && f[e].queue !== a || (f[e].anim.stop(c), b = !1, f.splice(e, 1));
                (b || !c) && fa.dequeue(this, a)
            })
        }, finish: function (a) {
            return a !== !1 && (a = a || "fx"), this.each(function () {
                var b, c = za.get(this), d = c[a + "queue"], e = c[a + "queueHooks"], f = fa.timers, g = d ? d.length : 0;
                for (c.finish = !0, fa.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;)f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
                for (b = 0; g > b; b++)d[b] && d[b].finish && d[b].finish.call(this);
                delete c.finish
            })
        }
    }), fa.each(["toggle", "show", "hide"], function (a, b) {
        var c = fa.fn[b];
        fa.fn[b] = function (a, d, e) {
            return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(J(b, !0), a, d, e)
        }
    }), fa.each({
        slideDown: J("show"),
        slideUp: J("hide"),
        slideToggle: J("toggle"),
        fadeIn: {opacity: "show"},
        fadeOut: {opacity: "hide"},
        fadeToggle: {opacity: "toggle"}
    }, function (a, b) {
        fa.fn[a] = function (a, c, d) {
            return this.animate(b, a, c, d)
        }
    }), fa.timers = [], fa.fx.tick = function () {
        var a, b = 0, c = fa.timers;
        for (eb = fa.now(); b < c.length; b++)a = c[b],
        a() || c[b] !== a || c.splice(b--, 1);
        c.length || fa.fx.stop(), eb = void 0
    }, fa.fx.timer = function (a) {
        fa.timers.push(a), a() ? fa.fx.start() : fa.timers.pop()
    }, fa.fx.interval = 13, fa.fx.start = function () {
        fb || (fb = a.setInterval(fa.fx.tick, fa.fx.interval))
    }, fa.fx.stop = function () {
        a.clearInterval(fb), fb = null
    }, fa.fx.speeds = {slow: 600, fast: 200, _default: 400}, fa.fn.delay = function (b, c) {
        return b = fa.fx ? fa.fx.speeds[b] || b : b, c = c || "fx", this.queue(c, function (c, d) {
            var e = a.setTimeout(c, b);
            d.stop = function () {
                a.clearTimeout(e)
            }
        })
    }, function () {
        var a = X.createElement("input"), b = X.createElement("select"), c = b.appendChild(X.createElement("option"));
        a.type = "checkbox", da.checkOn = "" !== a.value, da.optSelected = c.selected, b.disabled = !0, da.optDisabled = !c.disabled, a = X.createElement("input"), a.value = "t", a.type = "radio", da.radioValue = "t" === a.value
    }();
    var ib, jb = fa.expr.attrHandle;
    fa.fn.extend({
        attr: function (a, b) {
            return xa(this, fa.attr, a, b, arguments.length > 1)
        }, removeAttr: function (a) {
            return this.each(function () {
                fa.removeAttr(this, a)
            })
        }
    }), fa.extend({
        attr: function (a, b, c) {
            var d, e, f = a.nodeType;
            if (3 !== f && 8 !== f && 2 !== f)return "undefined" == typeof a.getAttribute ? fa.prop(a, b, c) : (1 === f && fa.isXMLDoc(a) || (b = b.toLowerCase(), e = fa.attrHooks[b] || (fa.expr.match.bool.test(b) ? ib : void 0)), void 0 !== c ? null === c ? void fa.removeAttr(a, b) : e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : (a.setAttribute(b, c + ""), c) : e && "get" in e && null !== (d = e.get(a, b)) ? d : (d = fa.find.attr(a, b), null == d ? void 0 : d))
        }, attrHooks: {
            type: {
                set: function (a, b) {
                    if (!da.radioValue && "radio" === b && fa.nodeName(a, "input")) {
                        var c = a.value;
                        return a.setAttribute("type", b), c && (a.value = c), b
                    }
                }
            }
        }, removeAttr: function (a, b) {
            var c, d, e = 0, f = b && b.match(va);
            if (f && 1 === a.nodeType)for (; c = f[e++];)d = fa.propFix[c] || c, fa.expr.match.bool.test(c) && (a[d] = !1), a.removeAttribute(c)
        }
    }), ib = {
        set: function (a, b, c) {
            return b === !1 ? fa.removeAttr(a, c) : a.setAttribute(c, c), c
        }
    }, fa.each(fa.expr.match.bool.source.match(/\w+/g), function (a, b) {
        var c = jb[b] || fa.find.attr;
        jb[b] = function (a, b, d) {
            var e, f;
            return d || (f = jb[b], jb[b] = e, e = null != c(a, b, d) ? b.toLowerCase() : null, jb[b] = f), e
        }
    });
    var kb = /^(?:input|select|textarea|button)$/i, lb = /^(?:a|area)$/i;
    fa.fn.extend({
        prop: function (a, b) {
            return xa(this, fa.prop, a, b, arguments.length > 1)
        }, removeProp: function (a) {
            return this.each(function () {
                delete this[fa.propFix[a] || a]
            })
        }
    }), fa.extend({
        prop: function (a, b, c) {
            var d, e, f = a.nodeType;
            if (3 !== f && 8 !== f && 2 !== f)return 1 === f && fa.isXMLDoc(a) || (b = fa.propFix[b] || b, e = fa.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
        }, propHooks: {
            tabIndex: {
                get: function (a) {
                    var b = fa.find.attr(a, "tabindex");
                    return b ? parseInt(b, 10) : kb.test(a.nodeName) || lb.test(a.nodeName) && a.href ? 0 : -1
                }
            }
        }, propFix: {"for": "htmlFor", "class": "className"}
    }), da.optSelected || (fa.propHooks.selected = {
        get: function (a) {
            var b = a.parentNode;
            return b && b.parentNode && b.parentNode.selectedIndex, null
        }, set: function (a) {
            var b = a.parentNode;
            b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex)
        }
    }), fa.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () {
        fa.propFix[this.toLowerCase()] = this
    });
    var mb = /[\t\r\n\f]/g;
    fa.fn.extend({
        addClass: function (a) {
            var b, c, d, e, f, g, h, i = 0;
            if (fa.isFunction(a))return this.each(function (b) {
                fa(this).addClass(a.call(this, b, O(this)))
            });
            if ("string" == typeof a && a)for (b = a.match(va) || []; c = this[i++];)if (e = O(c), d = 1 === c.nodeType && (" " + e + " ").replace(mb, " ")) {
                for (g = 0; f = b[g++];)d.indexOf(" " + f + " ") < 0 && (d += f + " ");
                h = fa.trim(d), e !== h && c.setAttribute("class", h)
            }
            return this
        }, removeClass: function (a) {
            var b, c, d, e, f, g, h, i = 0;
            if (fa.isFunction(a))return this.each(function (b) {
                fa(this).removeClass(a.call(this, b, O(this)))
            });
            if (!arguments.length)return this.attr("class", "");
            if ("string" == typeof a && a)for (b = a.match(va) || []; c = this[i++];)if (e = O(c), d = 1 === c.nodeType && (" " + e + " ").replace(mb, " ")) {
                for (g = 0; f = b[g++];)for (; d.indexOf(" " + f + " ") > -1;)d = d.replace(" " + f + " ", " ");
                h = fa.trim(d), e !== h && c.setAttribute("class", h)
            }
            return this
        }, toggleClass: function (a, b) {
            var c = typeof a;
            return "boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : fa.isFunction(a) ? this.each(function (c) {
                fa(this).toggleClass(a.call(this, c, O(this), b), b)
            }) : this.each(function () {
                var b, d, e, f;
                if ("string" === c)for (d = 0, e = fa(this), f = a.match(va) || []; b = f[d++];)e.hasClass(b) ? e.removeClass(b) : e.addClass(b); else(void 0 === a || "boolean" === c) && (b = O(this), b && za.set(this, "__className__", b), this.setAttribute && this.setAttribute("class", b || a === !1 ? "" : za.get(this, "__className__") || ""))
            })
        }, hasClass: function (a) {
            var b, c, d = 0;
            for (b = " " + a + " "; c = this[d++];)if (1 === c.nodeType && (" " + O(c) + " ").replace(mb, " ").indexOf(b) > -1)return !0;
            return !1
        }
    });
    var nb = /\r/g, ob = /[\x20\t\r\n\f]+/g;
    fa.fn.extend({
        val: function (a) {
            var b, c, d, e = this[0];
            {
                if (arguments.length)return d = fa.isFunction(a), this.each(function (c) {
                    var e;
                    1 === this.nodeType && (e = d ? a.call(this, c, fa(this).val()) : a, null == e ? e = "" : "number" == typeof e ? e += "" : fa.isArray(e) && (e = fa.map(e, function (a) {
                        return null == a ? "" : a + ""
                    })), b = fa.valHooks[this.type] || fa.valHooks[this.nodeName.toLowerCase()], b && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e))
                });
                if (e)return b = fa.valHooks[e.type] || fa.valHooks[e.nodeName.toLowerCase()], b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : (c = e.value, "string" == typeof c ? c.replace(nb, "") : null == c ? "" : c)
            }
        }
    }), fa.extend({
        valHooks: {
            option: {
                get: function (a) {
                    var b = fa.find.attr(a, "value");
                    return null != b ? b : fa.trim(fa.text(a)).replace(ob, " ")
                }
            }, select: {
                get: function (a) {
                    for (var b, c, d = a.options, e = a.selectedIndex, f = "select-one" === a.type || 0 > e, g = f ? null : [], h = f ? e + 1 : d.length, i = 0 > e ? h : f ? e : 0; h > i; i++)if (c = d[i], (c.selected || i === e) && (da.optDisabled ? !c.disabled : null === c.getAttribute("disabled")) && (!c.parentNode.disabled || !fa.nodeName(c.parentNode, "optgroup"))) {
                        if (b = fa(c).val(), f)return b;
                        g.push(b)
                    }
                    return g
                }, set: function (a, b) {
                    for (var c, d, e = a.options, f = fa.makeArray(b), g = e.length; g--;)d = e[g], (d.selected = fa.inArray(fa.valHooks.option.get(d), f) > -1) && (c = !0);
                    return c || (a.selectedIndex = -1), f
                }
            }
        }
    }), fa.each(["radio", "checkbox"], function () {
        fa.valHooks[this] = {
            set: function (a, b) {
                return fa.isArray(b) ? a.checked = fa.inArray(fa(a).val(), b) > -1 : void 0
            }
        }, da.checkOn || (fa.valHooks[this].get = function (a) {
            return null === a.getAttribute("value") ? "on" : a.value
        })
    });
    var pb = /^(?:focusinfocus|focusoutblur)$/;
    fa.extend(fa.event, {
        trigger: function (b, c, d, e) {
            var f, g, h, i, j, k, l, m = [d || X], n = ca.call(b, "type") ? b.type : b, o = ca.call(b, "namespace") ? b.namespace.split(".") : [];
            if (g = h = d = d || X, 3 !== d.nodeType && 8 !== d.nodeType && !pb.test(n + fa.event.triggered) && (n.indexOf(".") > -1 && (o = n.split("."), n = o.shift(), o.sort()), j = n.indexOf(":") < 0 && "on" + n, b = b[fa.expando] ? b : new fa.Event(n, "object" == typeof b && b), b.isTrigger = e ? 2 : 3, b.namespace = o.join("."), b.rnamespace = b.namespace ? new RegExp("(^|\\.)" + o.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = void 0, b.target || (b.target = d), c = null == c ? [b] : fa.makeArray(c, [b]), l = fa.event.special[n] || {}, e || !l.trigger || l.trigger.apply(d, c) !== !1)) {
                if (!e && !l.noBubble && !fa.isWindow(d)) {
                    for (i = l.delegateType || n, pb.test(i + n) || (g = g.parentNode); g; g = g.parentNode)m.push(g), h = g;
                    h === (d.ownerDocument || X) && m.push(h.defaultView || h.parentWindow || a)
                }
                for (f = 0; (g = m[f++]) && !b.isPropagationStopped();)b.type = f > 1 ? i : l.bindType || n, k = (za.get(g, "events") || {})[b.type] && za.get(g, "handle"), k && k.apply(g, c), k = j && g[j], k && k.apply && ya(g) && (b.result = k.apply(g, c), b.result === !1 && b.preventDefault());
                return b.type = n, e || b.isDefaultPrevented() || l._default && l._default.apply(m.pop(), c) !== !1 || !ya(d) || j && fa.isFunction(d[n]) && !fa.isWindow(d) && (h = d[j], h && (d[j] = null), fa.event.triggered = n, d[n](), fa.event.triggered = void 0, h && (d[j] = h)), b.result
            }
        }, simulate: function (a, b, c) {
            var d = fa.extend(new fa.Event, c, {type: a, isSimulated: !0});
            fa.event.trigger(d, null, b)
        }
    }), fa.fn.extend({
        trigger: function (a, b) {
            return this.each(function () {
                fa.event.trigger(a, b, this)
            })
        }, triggerHandler: function (a, b) {
            var c = this[0];
            return c ? fa.event.trigger(a, b, c, !0) : void 0
        }
    }), fa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (a, b) {
        fa.fn[b] = function (a, c) {
            return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
        }
    }), fa.fn.extend({
        hover: function (a, b) {
            return this.mouseenter(a).mouseleave(b || a)
        }
    }), da.focusin = "onfocusin" in a, da.focusin || fa.each({focus: "focusin", blur: "focusout"}, function (a, b) {
        var c = function (a) {
            fa.event.simulate(b, a.target, fa.event.fix(a))
        };
        fa.event.special[b] = {
            setup: function () {
                var d = this.ownerDocument || this, e = za.access(d, b);
                e || d.addEventListener(a, c, !0), za.access(d, b, (e || 0) + 1)
            }, teardown: function () {
                var d = this.ownerDocument || this, e = za.access(d, b) - 1;
                e ? za.access(d, b, e) : (d.removeEventListener(a, c, !0), za.remove(d, b))
            }
        }
    });
    var qb = a.location, rb = fa.now(), sb = /\?/;
    fa.parseJSON = function (a) {
        return JSON.parse(a + "")
    }, fa.parseXML = function (b) {
        var c;
        if (!b || "string" != typeof b)return null;
        try {
            c = (new a.DOMParser).parseFromString(b, "text/xml")
        } catch (d) {
            c = void 0
        }
        return (!c || c.getElementsByTagName("parsererror").length) && fa.error("Invalid XML: " + b), c
    };
    var tb = /#.*$/, ub = /([?&])_=[^&]*/, vb = /^(.*?):[ \t]*([^\r\n]*)$/gm, wb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/, xb = /^(?:GET|HEAD)$/, yb = /^\/\//, zb = {}, Ab = {}, Bb = "*/".concat("*"), Cb = X.createElement("a");
    Cb.href = qb.href, fa.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: qb.href,
            type: "GET",
            isLocal: wb.test(qb.protocol),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": Bb,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/},
            responseFields: {xml: "responseXML", text: "responseText", json: "responseJSON"},
            converters: {"* text": String, "text html": !0, "text json": fa.parseJSON, "text xml": fa.parseXML},
            flatOptions: {url: !0, context: !0}
        },
        ajaxSetup: function (a, b) {
            return b ? R(R(a, fa.ajaxSettings), b) : R(fa.ajaxSettings, a)
        },
        ajaxPrefilter: P(zb),
        ajaxTransport: P(Ab),
        ajax: function (b, c) {
            function d(b, c, d, h) {
                var j, l, s, t, v, x = c;
                2 !== u && (u = 2, i && a.clearTimeout(i), e = void 0, g = h || "", w.readyState = b > 0 ? 4 : 0, j = b >= 200 && 300 > b || 304 === b, d && (t = S(m, w, d)), t = T(m, t, w, j), j ? (m.ifModified && (v = w.getResponseHeader("Last-Modified"), v && (fa.lastModified[f] = v), v = w.getResponseHeader("etag"), v && (fa.etag[f] = v)), 204 === b || "HEAD" === m.type ? x = "nocontent" : 304 === b ? x = "notmodified" : (x = t.state, l = t.data, s = t.error, j = !s)) : (s = x, (b || !x) && (x = "error", 0 > b && (b = 0))), w.status = b, w.statusText = (c || x) + "", j ? p.resolveWith(n, [l, x, w]) : p.rejectWith(n, [w, x, s]), w.statusCode(r), r = void 0, k && o.trigger(j ? "ajaxSuccess" : "ajaxError", [w, m, j ? l : s]), q.fireWith(n, [w, x]), k && (o.trigger("ajaxComplete", [w, m]), --fa.active || fa.event.trigger("ajaxStop")))
            }

            "object" == typeof b && (c = b, b = void 0), c = c || {};
            var e, f, g, h, i, j, k, l, m = fa.ajaxSetup({}, c), n = m.context || m, o = m.context && (n.nodeType || n.jquery) ? fa(n) : fa.event, p = fa.Deferred(), q = fa.Callbacks("once memory"), r = m.statusCode || {}, s = {}, t = {}, u = 0, v = "canceled", w = {
                readyState: 0,
                getResponseHeader: function (a) {
                    var b;
                    if (2 === u) {
                        if (!h)for (h = {}; b = vb.exec(g);)h[b[1].toLowerCase()] = b[2];
                        b = h[a.toLowerCase()]
                    }
                    return null == b ? null : b
                },
                getAllResponseHeaders: function () {
                    return 2 === u ? g : null
                },
                setRequestHeader: function (a, b) {
                    var c = a.toLowerCase();
                    return u || (a = t[c] = t[c] || a, s[a] = b), this
                },
                overrideMimeType: function (a) {
                    return u || (m.mimeType = a), this
                },
                statusCode: function (a) {
                    var b;
                    if (a)if (2 > u)for (b in a)r[b] = [r[b], a[b]]; else w.always(a[w.status]);
                    return this
                },
                abort: function (a) {
                    var b = a || v;
                    return e && e.abort(b), d(0, b), this
                }
            };
            if (p.promise(w).complete = q.add, w.success = w.done, w.error = w.fail, m.url = ((b || m.url || qb.href) + "").replace(tb, "").replace(yb, qb.protocol + "//"), m.type = c.method || c.type || m.method || m.type, m.dataTypes = fa.trim(m.dataType || "*").toLowerCase().match(va) || [""], null == m.crossDomain) {
                j = X.createElement("a");
                try {
                    j.href = m.url, j.href = j.href, m.crossDomain = Cb.protocol + "//" + Cb.host != j.protocol + "//" + j.host
                } catch (x) {
                    m.crossDomain = !0
                }
            }
            if (m.data && m.processData && "string" != typeof m.data && (m.data = fa.param(m.data, m.traditional)), Q(zb, m, c, w), 2 === u)return w;
            k = fa.event && m.global, k && 0 === fa.active++ && fa.event.trigger("ajaxStart"), m.type = m.type.toUpperCase(), m.hasContent = !xb.test(m.type), f = m.url, m.hasContent || (m.data && (f = m.url += (sb.test(f) ? "&" : "?") + m.data, delete m.data), m.cache === !1 && (m.url = ub.test(f) ? f.replace(ub, "$1_=" + rb++) : f + (sb.test(f) ? "&" : "?") + "_=" + rb++)), m.ifModified && (fa.lastModified[f] && w.setRequestHeader("If-Modified-Since", fa.lastModified[f]), fa.etag[f] && w.setRequestHeader("If-None-Match", fa.etag[f])), (m.data && m.hasContent && m.contentType !== !1 || c.contentType) && w.setRequestHeader("Content-Type", m.contentType), w.setRequestHeader("Accept", m.dataTypes[0] && m.accepts[m.dataTypes[0]] ? m.accepts[m.dataTypes[0]] + ("*" !== m.dataTypes[0] ? ", " + Bb + "; q=0.01" : "") : m.accepts["*"]);
            for (l in m.headers)w.setRequestHeader(l, m.headers[l]);
            if (m.beforeSend && (m.beforeSend.call(n, w, m) === !1 || 2 === u))return w.abort();
            v = "abort";
            for (l in{success: 1, error: 1, complete: 1})w[l](m[l]);
            if (e = Q(Ab, m, c, w)) {
                if (w.readyState = 1, k && o.trigger("ajaxSend", [w, m]), 2 === u)return w;
                m.async && m.timeout > 0 && (i = a.setTimeout(function () {
                    w.abort("timeout")
                }, m.timeout));
                try {
                    u = 1, e.send(s, d)
                } catch (x) {
                    if (!(2 > u))throw x;
                    d(-1, x)
                }
            } else d(-1, "No Transport");
            return w
        },
        getJSON: function (a, b, c) {
            return fa.get(a, b, c, "json")
        },
        getScript: function (a, b) {
            return fa.get(a, void 0, b, "script")
        }
    }), fa.each(["get", "post"], function (a, b) {
        fa[b] = function (a, c, d, e) {
            return fa.isFunction(c) && (e = e || d, d = c, c = void 0), fa.ajax(fa.extend({
                url: a,
                type: b,
                dataType: e,
                data: c,
                success: d
            }, fa.isPlainObject(a) && a))
        }
    }), fa._evalUrl = function (a) {
        return fa.ajax({url: a, type: "GET", dataType: "script", async: !1, global: !1, "throws": !0})
    }, fa.fn.extend({
        wrapAll: function (a) {
            var b;
            return fa.isFunction(a) ? this.each(function (b) {
                fa(this).wrapAll(a.call(this, b))
            }) : (this[0] && (b = fa(a, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && b.insertBefore(this[0]), b.map(function () {
                for (var a = this; a.firstElementChild;)a = a.firstElementChild;
                return a
            }).append(this)), this)
        }, wrapInner: function (a) {
            return fa.isFunction(a) ? this.each(function (b) {
                fa(this).wrapInner(a.call(this, b))
            }) : this.each(function () {
                var b = fa(this), c = b.contents();
                c.length ? c.wrapAll(a) : b.append(a)
            })
        }, wrap: function (a) {
            var b = fa.isFunction(a);
            return this.each(function (c) {
                fa(this).wrapAll(b ? a.call(this, c) : a)
            })
        }, unwrap: function () {
            return this.parent().each(function () {
                fa.nodeName(this, "body") || fa(this).replaceWith(this.childNodes)
            }).end()
        }
    }), fa.expr.filters.hidden = function (a) {
        return !fa.expr.filters.visible(a)
    }, fa.expr.filters.visible = function (a) {
        return a.offsetWidth > 0 || a.offsetHeight > 0 || a.getClientRects().length > 0
    };
    var Db = /%20/g, Eb = /\[\]$/, Fb = /\r?\n/g, Gb = /^(?:submit|button|image|reset|file)$/i, Hb = /^(?:input|select|textarea|keygen)/i;
    fa.param = function (a, b) {
        var c, d = [], e = function (a, b) {
            b = fa.isFunction(b) ? b() : null == b ? "" : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
        };
        if (void 0 === b && (b = fa.ajaxSettings && fa.ajaxSettings.traditional), fa.isArray(a) || a.jquery && !fa.isPlainObject(a))fa.each(a, function () {
            e(this.name, this.value)
        }); else for (c in a)U(c, a[c], b, e);
        return d.join("&").replace(Db, "+")
    }, fa.fn.extend({
        serialize: function () {
            return fa.param(this.serializeArray())
        }, serializeArray: function () {
            return this.map(function () {
                var a = fa.prop(this, "elements");
                return a ? fa.makeArray(a) : this
            }).filter(function () {
                var a = this.type;
                return this.name && !fa(this).is(":disabled") && Hb.test(this.nodeName) && !Gb.test(a) && (this.checked || !Ha.test(a))
            }).map(function (a, b) {
                var c = fa(this).val();
                return null == c ? null : fa.isArray(c) ? fa.map(c, function (a) {
                    return {name: b.name, value: a.replace(Fb, "\r\n")}
                }) : {name: b.name, value: c.replace(Fb, "\r\n")}
            }).get()
        }
    }), fa.ajaxSettings.xhr = function () {
        try {
            return new a.XMLHttpRequest
        } catch (b) {
        }
    };
    var Ib = {0: 200, 1223: 204}, Jb = fa.ajaxSettings.xhr();
    da.cors = !!Jb && "withCredentials" in Jb, da.ajax = Jb = !!Jb, fa.ajaxTransport(function (b) {
        var c, d;
        return da.cors || Jb && !b.crossDomain ? {
            send: function (e, f) {
                var g, h = b.xhr();
                if (h.open(b.type, b.url, b.async, b.username, b.password), b.xhrFields)for (g in b.xhrFields)h[g] = b.xhrFields[g];
                b.mimeType && h.overrideMimeType && h.overrideMimeType(b.mimeType), b.crossDomain || e["X-Requested-With"] || (e["X-Requested-With"] = "XMLHttpRequest");
                for (g in e)h.setRequestHeader(g, e[g]);
                c = function (a) {
                    return function () {
                        c && (c = d = h.onload = h.onerror = h.onabort = h.onreadystatechange = null, "abort" === a ? h.abort() : "error" === a ? "number" != typeof h.status ? f(0, "error") : f(h.status, h.statusText) : f(Ib[h.status] || h.status, h.statusText, "text" !== (h.responseType || "text") || "string" != typeof h.responseText ? {binary: h.response} : {text: h.responseText}, h.getAllResponseHeaders()))
                    }
                }, h.onload = c(), d = h.onerror = c("error"), void 0 !== h.onabort ? h.onabort = d : h.onreadystatechange = function () {
                    4 === h.readyState && a.setTimeout(function () {
                        c && d()
                    })
                }, c = c("abort");
                try {
                    h.send(b.hasContent && b.data || null)
                } catch (i) {
                    if (c)throw i
                }
            }, abort: function () {
                c && c()
            }
        } : void 0
    }), fa.ajaxSetup({
        accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
        contents: {script: /\b(?:java|ecma)script\b/},
        converters: {
            "text script": function (a) {
                return fa.globalEval(a), a
            }
        }
    }), fa.ajaxPrefilter("script", function (a) {
        void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET")
    }), fa.ajaxTransport("script", function (a) {
        if (a.crossDomain) {
            var b, c;
            return {
                send: function (d, e) {
                    b = fa("<script>").prop({charset: a.scriptCharset, src: a.url}).on("load error", c = function (a) {
                        b.remove(), c = null, a && e("error" === a.type ? 404 : 200, a.type)
                    }), X.head.appendChild(b[0])
                }, abort: function () {
                    c && c()
                }
            }
        }
    });
    var Kb = [], Lb = /(=)\?(?=&|$)|\?\?/;
    fa.ajaxSetup({
        jsonp: "callback", jsonpCallback: function () {
            var a = Kb.pop() || fa.expando + "_" + rb++;
            return this[a] = !0, a
        }
    }), fa.ajaxPrefilter("json jsonp", function (b, c, d) {
        var e, f, g, h = b.jsonp !== !1 && (Lb.test(b.url) ? "url" : "string" == typeof b.data && 0 === (b.contentType || "").indexOf("application/x-www-form-urlencoded") && Lb.test(b.data) && "data");
        return h || "jsonp" === b.dataTypes[0] ? (e = b.jsonpCallback = fa.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, h ? b[h] = b[h].replace(Lb, "$1" + e) : b.jsonp !== !1 && (b.url += (sb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), b.converters["script json"] = function () {
            return g || fa.error(e + " was not called"), g[0]
        }, b.dataTypes[0] = "json", f = a[e], a[e] = function () {
            g = arguments
        }, d.always(function () {
            void 0 === f ? fa(a).removeProp(e) : a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, Kb.push(e)), g && fa.isFunction(f) && f(g[0]), g = f = void 0
        }), "script") : void 0
    }), fa.parseHTML = function (a, b, c) {
        if (!a || "string" != typeof a)return null;
        "boolean" == typeof b && (c = b, b = !1), b = b || X;
        var d = oa.exec(a), e = !c && [];
        return d ? [b.createElement(d[1])] : (d = m([a], b, e), e && e.length && fa(e).remove(), fa.merge([], d.childNodes))
    };
    var Mb = fa.fn.load;
    fa.fn.load = function (a, b, c) {
        if ("string" != typeof a && Mb)return Mb.apply(this, arguments);
        var d, e, f, g = this, h = a.indexOf(" ");
        return h > -1 && (d = fa.trim(a.slice(h)), a = a.slice(0, h)), fa.isFunction(b) ? (c = b, b = void 0) : b && "object" == typeof b && (e = "POST"), g.length > 0 && fa.ajax({
            url: a,
            type: e || "GET",
            dataType: "html",
            data: b
        }).done(function (a) {
            f = arguments, g.html(d ? fa("<div>").append(fa.parseHTML(a)).find(d) : a)
        }).always(c && function (a, b) {
                g.each(function () {
                    c.apply(this, f || [a.responseText, b, a])
                })
            }), this
    }, fa.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (a, b) {
        fa.fn[b] = function (a) {
            return this.on(b, a)
        }
    }), fa.expr.filters.animated = function (a) {
        return fa.grep(fa.timers, function (b) {
            return a === b.elem
        }).length
    }, fa.offset = {
        setOffset: function (a, b, c) {
            var d, e, f, g, h, i, j, k = fa.css(a, "position"), l = fa(a), m = {};
            "static" === k && (a.style.position = "relative"), h = l.offset(), f = fa.css(a, "top"), i = fa.css(a, "left"), j = ("absolute" === k || "fixed" === k) && (f + i).indexOf("auto") > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), fa.isFunction(b) && (b = b.call(a, c, fa.extend({}, h))), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using" in b ? b.using.call(a, m) : l.css(m)
        }
    }, fa.fn.extend({
        offset: function (a) {
            if (arguments.length)return void 0 === a ? this : this.each(function (b) {
                fa.offset.setOffset(this, a, b)
            });
            var b, c, d = this[0], e = {top: 0, left: 0}, f = d && d.ownerDocument;
            if (f)return b = f.documentElement, fa.contains(b, d) ? (e = d.getBoundingClientRect(), c = V(f), {
                top: e.top + c.pageYOffset - b.clientTop,
                left: e.left + c.pageXOffset - b.clientLeft
            }) : e
        }, position: function () {
            if (this[0]) {
                var a, b, c = this[0], d = {top: 0, left: 0};
                return "fixed" === fa.css(c, "position") ? b = c.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), fa.nodeName(a[0], "html") || (d = a.offset()), d.top += fa.css(a[0], "borderTopWidth", !0), d.left += fa.css(a[0], "borderLeftWidth", !0)), {
                    top: b.top - d.top - fa.css(c, "marginTop", !0),
                    left: b.left - d.left - fa.css(c, "marginLeft", !0)
                }
            }
        }, offsetParent: function () {
            return this.map(function () {
                for (var a = this.offsetParent; a && "static" === fa.css(a, "position");)a = a.offsetParent;
                return a || $a
            })
        }
    }), fa.each({scrollLeft: "pageXOffset", scrollTop: "pageYOffset"}, function (a, b) {
        var c = "pageYOffset" === b;
        fa.fn[a] = function (d) {
            return xa(this, function (a, d, e) {
                var f = V(a);
                return void 0 === e ? f ? f[b] : a[d] : void(f ? f.scrollTo(c ? f.pageXOffset : e, c ? e : f.pageYOffset) : a[d] = e)
            }, a, d, arguments.length)
        }
    }), fa.each(["top", "left"], function (a, b) {
        fa.cssHooks[b] = B(da.pixelPosition, function (a, c) {
            return c ? (c = A(a, b), Xa.test(c) ? fa(a).position()[b] + "px" : c) : void 0
        })
    }), fa.each({Height: "height", Width: "width"}, function (a, b) {
        fa.each({padding: "inner" + a, content: b, "": "outer" + a}, function (c, d) {
            fa.fn[d] = function (d, e) {
                var f = arguments.length && (c || "boolean" != typeof d), g = c || (d === !0 || e === !0 ? "margin" : "border");
                return xa(this, function (b, c, d) {
                    var e;
                    return fa.isWindow(b) ? b.document.documentElement["client" + a] : 9 === b.nodeType ? (e = b.documentElement, Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a])) : void 0 === d ? fa.css(b, c, g) : fa.style(b, c, d, g)
                }, b, f ? d : void 0, f, null)
            }
        })
    }), fa.fn.extend({
        bind: function (a, b, c) {
            return this.on(a, null, b, c)
        }, unbind: function (a, b) {
            return this.off(a, null, b)
        }, delegate: function (a, b, c, d) {
            return this.on(b, a, c, d)
        }, undelegate: function (a, b, c) {
            return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c)
        }, size: function () {
            return this.length
        }
    }), fa.fn.andSelf = fa.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function () {
        return fa
    });
    var Nb = a.jQuery, Ob = a.$;
    return fa.noConflict = function (b) {
        return a.$ === fa && (a.$ = Ob), b && a.jQuery === fa && (a.jQuery = Nb), fa
    }, b || (a.jQuery = a.$ = fa), fa
}), define("text", ["module"], function (a) {
    "use strict";
    var b, c, d = ["Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0"], e = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im, f = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im, g = "undefined" != typeof location && location.href, h = g && location.protocol && location.protocol.replace(/\:/, ""), i = g && location.hostname, j = g && (location.port || void 0), k = [], l = a.config && a.config() || {};
    return b = {
        version: "2.0.5", strip: function (a) {
            if (a) {
                a = a.replace(e, "");
                var b = a.match(f);
                b && (a = b[1])
            } else a = "";
            return a
        }, jsEscape: function (a) {
            return a.replace(/(['\\])/g, "\\$1").replace(/[\f]/g, "\\f").replace(/[\b]/g, "\\b").replace(/[\n]/g, "\\n").replace(/[\t]/g, "\\t").replace(/[\r]/g, "\\r").replace(/[\u2028]/g, "\\u2028").replace(/[\u2029]/g, "\\u2029")
        }, createXhr: l.createXhr || function () {
            var a, b, c;
            if ("undefined" != typeof XMLHttpRequest)return new XMLHttpRequest;
            if ("undefined" != typeof ActiveXObject)for (b = 0; 3 > b; b += 1) {
                c = d[b];
                try {
                    a = new ActiveXObject(c)
                } catch (e) {
                }
                if (a) {
                    d = [c];
                    break
                }
            }
            return a
        }, parseName: function (a) {
            var b, c, d, e = !1, f = a.indexOf("."), g = 0 === a.indexOf("./") || 0 === a.indexOf("../");
            return -1 !== f && (!g || f > 1) ? (b = a.substring(0, f), c = a.substring(f + 1, a.length)) : b = a, d = c || b, f = d.indexOf("!"), -1 !== f && (e = "strip" === d.substring(f + 1), d = d.substring(0, f), c ? c = d : b = d), {
                moduleName: b,
                ext: c,
                strip: e
            }
        }, xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/, useXhr: function (a, c, d, e) {
            var f, g, h, i = b.xdRegExp.exec(a);
            return i ? (f = i[2], g = i[3], g = g.split(":"), h = g[1], g = g[0], !(f && f !== c || g && g.toLowerCase() !== d.toLowerCase() || (h || g) && h !== e)) : !0
        }, finishLoad: function (a, c, d, e) {
            d = c ? b.strip(d) : d, l.isBuild && (k[a] = d), e(d)
        }, load: function (a, c, d, e) {
            if (e.isBuild && !e.inlineText)return void d();
            l.isBuild = e.isBuild;
            var f = b.parseName(a), k = f.moduleName + (f.ext ? "." + f.ext : ""), m = c.toUrl(k), n = l.useXhr || b.useXhr;
            !g || n(m, h, i, j) ? b.get(m, function (c) {
                b.finishLoad(a, f.strip, c, d)
            }, function (a) {
                d.error && d.error(a)
            }) : c([k], function (a) {
                b.finishLoad(f.moduleName + "." + f.ext, f.strip, a, d)
            })
        }, write: function (a, c, d, e) {
            if (k.hasOwnProperty(c)) {
                var f = b.jsEscape(k[c]);
                d.asModule(a + "!" + c, "define(function () { return '" + f + "';});\n")
            }
        }, writeFile: function (a, c, d, e, f) {
            var g = b.parseName(c), h = g.ext ? "." + g.ext : "", i = g.moduleName + h, j = d.toUrl(g.moduleName + h) + ".js";
            b.load(i, d, function (c) {
                var d = function (a) {
                    return e(j, a)
                };
                d.asModule = function (a, b) {
                    return e.asModule(a, j, b)
                }, b.write(a, i, d, f)
            }, f)
        }
    }, ("node" === l.env || !l.env && "undefined" != typeof process && process.versions && process.versions.node) && require && require.nodeRequire ? (c = require.nodeRequire("fs"), b.get = function (a, b) {
        var d = c.readFileSync(a, "utf8");
        0 === d.indexOf("\ufeff") && (d = d.substring(1)), b(d)
    }) : "xhr" === l.env || !l.env && b.createXhr() ? b.get = function (a, c, d, e) {
        var f, g = b.createXhr();
        if (g.open("GET", a, !0), e)for (f in e)e.hasOwnProperty(f) && g.setRequestHeader(f.toLowerCase(), e[f]);
        l.onXhr && l.onXhr(g, a), g.onreadystatechange = function (b) {
            var e, f;
            4 === g.readyState && (e = g.status, e > 399 && 600 > e ? (f = new Error(a + " HTTP status: " + e), f.xhr = g, d(f)) : c(g.responseText))
        }, g.send(null)
    } : ("rhino" === l.env || !l.env && "undefined" != typeof Packages && "undefined" != typeof java) && (b.get = function (a, b) {
        var c, d, e = "utf-8", f = new java.io.File(a), g = java.lang.System.getProperty("line.separator"), h = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f), e)), i = "";
        try {
            for (c = new java.lang.StringBuffer, d = h.readLine(), d && d.length() && 65279 === d.charAt(0) && (d = d.substring(1)), c.append(d); null !== (d = h.readLine());)c.append(g), c.append(d);
            i = String(c.toString())
        } finally {
            h.close()
        }
        b(i)
    }), b
}), define("json", ["text"], function (text) {
    function cacheBust(a) {
        return a = a.replace(CACHE_BUST_FLAG, ""), a += a.indexOf("?") < 0 ? "?" : "&", a + CACHE_BUST_QUERY_PARAM + "=" + Math.round(2147483647 * Math.random())
    }

    var CACHE_BUST_QUERY_PARAM = "bust", CACHE_BUST_FLAG = "!bust", jsonParse = "undefined" != typeof JSON && "function" == typeof JSON.parse ? JSON.parse : function (val) {
        return eval("(" + val + ")")
    }, buildMap = {};
    return {
        load: function (a, b, c, d) {
            d.isBuild && (d.inlineJSON === !1 || -1 !== a.indexOf(CACHE_BUST_QUERY_PARAM + "=")) || 0 === b.toUrl(a).indexOf("empty:") ? c(null) : text.get(b.toUrl(a), function (b) {
                var e;
                if (d.isBuild)buildMap[a] = b, c(b); else {
                    try {
                        e = jsonParse(b)
                    } catch (f) {
                        c.error(f)
                    }
                    c(e)
                }
            }, c.error, {accept: "application/json"})
        }, normalize: function (a, b) {
            return -1 !== a.indexOf(CACHE_BUST_FLAG) && (a = cacheBust(a)), b(a)
        }, write: function (a, b, c) {
            if (b in buildMap) {
                var d = buildMap[b];
                c('define("' + a + "!" + b + '", function(){ return ' + d + ";});\n")
            }
        }
    }
}), define("json!KME/../../package.json", function () {
    return {
        name: "KMEClient",
        version: "8.11.71",
        release: "",
        description: "",
        author: "Juvty Worlds",
        homepage: "http://juvty.com",
        repository: {type: "git", url: "git@gitlab.m-w-o.ru:shellka/kme.git"},
        scripts: {test: "NODE_ENV=test grunt jshint"},
        keywords: ["HTML5", "game", "canvas", "2d", "WebGL", "web audio", "physics", "tweens", "javascript", "typescript"],
        devDependencies: {
            grunt: "~0.4.1",
            "grunt-contrib-clean": "~0.5.0",
            "grunt-contrib-compress": "^0.12.0",
            "grunt-contrib-concat": "~0.3.0",
            "grunt-contrib-connect": "~0.7.0",
            "grunt-contrib-copy": "~0.5.0",
            "grunt-contrib-jshint": "^0.9.2",
            "grunt-exec": "^0.4.6",
            "grunt-contrib-requirejs": "^0.4.4",
            "grunt-contrib-uglify": "~0.3.3",
            "grunt-contrib-watch": "^0.6.1",
            "grunt-sass": "^1.1.0",
            "grunt-text-replace": "~0.3.11",
            "grunt-webp": "0.0.4",
            "load-grunt-config": "~0.8.0-beta.1",
            lodash: "~2.2.1"
        }
    }
}), function (a, b) {
    if ("object" == typeof exports) {
        var c = require("jquery");
        module.exports = b(c)
    } else"function" == typeof define && define.amd && define("i18next", ["jquery"], b)
}(this, function (a) {
    function b(a, b) {
        if (!b || "function" == typeof b)return a;
        for (var c in b)a[c] = b[c];
        return a
    }

    function c(a, b) {
        for (var d in b)d in a ? c(a[d], b[d]) : a[d] = b[d];
        return a
    }

    function d(a, b, c) {
        var d, e = 0, f = a.length, g = void 0 === f || "[object Array]" !== Object.prototype.toString.apply(a) || "function" == typeof a;
        if (c)if (g) {
            for (d in a)if (b.apply(a[d], c) === !1)break
        } else for (; f > e && b.apply(a[e++], c) !== !1;); else if (g) {
            for (d in a)if (b.call(a[d], d, a[d]) === !1)break
        } else for (; f > e && b.call(a[e], e, a[e++]) !== !1;);
        return a
    }

    function e(a) {
        return "string" == typeof a ? a.replace(/[&<>"'\/]/g, function (a) {
            return L[a]
        }) : a
    }

    function f(a) {
        var b = function (a) {
            if (window.XMLHttpRequest)return a(null, new XMLHttpRequest);
            if (window.ActiveXObject)try {
                return a(null, new ActiveXObject("Msxml2.XMLHTTP"))
            } catch (b) {
                return a(null, new ActiveXObject("Microsoft.XMLHTTP"))
            }
            return a(new Error)
        }, c = function (a) {
            if ("string" == typeof a)return a;
            var b = [];
            for (var c in a)a.hasOwnProperty(c) && b.push(encodeURIComponent(c) + "=" + encodeURIComponent(a[c]));
            return b.join("&")
        }, d = function (a) {
            a = a.replace(/\r\n/g, "\n");
            for (var b = "", c = 0; c < a.length; c++) {
                var d = a.charCodeAt(c);
                128 > d ? b += String.fromCharCode(d) : d > 127 && 2048 > d ? (b += String.fromCharCode(d >> 6 | 192), b += String.fromCharCode(63 & d | 128)) : (b += String.fromCharCode(d >> 12 | 224), b += String.fromCharCode(d >> 6 & 63 | 128), b += String.fromCharCode(63 & d | 128))
            }
            return b
        }, e = function (a) {
            var b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
            a = d(a);
            var c, e, f, g, h, i, j, k = "", l = 0;
            do c = a.charCodeAt(l++), e = a.charCodeAt(l++), f = a.charCodeAt(l++), g = c >> 2, h = (3 & c) << 4 | e >> 4, i = (15 & e) << 2 | f >> 6, j = 63 & f, isNaN(e) ? i = j = 64 : isNaN(f) && (j = 64), k += b.charAt(g) + b.charAt(h) + b.charAt(i) + b.charAt(j), c = e = f = "", g = h = i = j = ""; while (l < a.length);
            return k
        }, f = function () {
            for (var a = arguments[0], b = 1; b < arguments.length; b++) {
                var c = arguments[b];
                for (var d in c)c.hasOwnProperty(d) && (a[d] = c[d])
            }
            return a
        }, g = function (a, d, e, h) {
            "function" == typeof e && (h = e, e = {}), e.cache = e.cache || !1, e.data = e.data || {}, e.headers = e.headers || {}, e.jsonp = e.jsonp || !1, e.async = void 0 === e.async ? !0 : e.async;
            var i, j = f({
                accept: "*/*",
                "content-type": "application/x-www-form-urlencoded;charset=UTF-8"
            }, g.headers, e.headers);
            if (i = "application/json" === j["content-type"] ? JSON.stringify(e.data) : c(e.data), "GET" === a) {
                var k = [];
                if (i && (k.push(i), i = null), e.cache || k.push("_=" + (new Date).getTime()), e.jsonp && (k.push("callback=" + e.jsonp), k.push("jsonp=" + e.jsonp)), k = k.join("&"), k.length > 1 && (d += d.indexOf("?") > -1 ? "&" + k : "?" + k), e.jsonp) {
                    var l = document.getElementsByTagName("head")[0], m = document.createElement("script");
                    return m.type = "text/javascript", m.src = d, void l.appendChild(m)
                }
            }
            b(function (b, c) {
                if (b)return h(b);
                c.open(a, d, e.async);
                for (var f in j)j.hasOwnProperty(f) && c.setRequestHeader(f, j[f]);
                c.onreadystatechange = function () {
                    if (4 === c.readyState) {
                        var a = c.responseText || "";
                        if (!h)return;
                        h(c.status, {
                            text: function () {
                                return a
                            }, json: function () {
                                return JSON.parse(a)
                            }
                        })
                    }
                }, c.send(i)
            })
        }, h = {
            authBasic: function (a, b) {
                g.headers.Authorization = "Basic " + e(a + ":" + b)
            }, connect: function (a, b, c) {
                return g("CONNECT", a, b, c)
            }, del: function (a, b, c) {
                return g("DELETE", a, b, c)
            }, get: function (a, b, c) {
                return g("GET", a, b, c)
            }, head: function (a, b, c) {
                return g("HEAD", a, b, c)
            }, headers: function (a) {
                g.headers = a || {}
            }, isAllowed: function (a, b, c) {
                this.options(a, function (a, d) {
                    c(-1 !== d.text().indexOf(b))
                })
            }, options: function (a, b, c) {
                return g("OPTIONS", a, b, c)
            }, patch: function (a, b, c) {
                return g("PATCH", a, b, c)
            }, post: function (a, b, c) {
                return g("POST", a, b, c)
            }, put: function (a, b, c) {
                return g("PUT", a, b, c)
            }, trace: function (a, b, c) {
                return g("TRACE", a, b, c)
            }
        }, i = a.type ? a.type.toLowerCase() : "get";
        h[i](a.url, a, function (b, c) {
            200 === b || 0 === b && c.text() ? a.success(c.json(), b, null) : a.error(c.text(), b, null)
        })
    }

    function g(b, c) {
        "function" == typeof b && (c = b, b = {}), b = b || {}, O.extend(K, b), delete K.fixLng, "string" == typeof K.ns && (K.ns = {
            namespaces: [K.ns],
            defaultNs: K.ns
        }), "string" == typeof K.fallbackNS && (K.fallbackNS = [K.fallbackNS]), ("string" == typeof K.fallbackLng || "boolean" == typeof K.fallbackLng) && (K.fallbackLng = [K.fallbackLng]), K.interpolationPrefixEscaped = O.regexEscape(K.interpolationPrefix), K.interpolationSuffixEscaped = O.regexEscape(K.interpolationSuffix), K.lng || (K.lng = O.detectLanguage()), I = O.toLanguages(K.lng), E = I[0], O.log("currentLng set to: " + E), K.useCookie && O.cookie.read(K.cookieName) !== E && O.cookie.create(K.cookieName, E, K.cookieExpirationTime, K.cookieDomain), K.detectLngFromLocalStorage && "undefined" != typeof document && window.localstorage && window.localStorage.setItem("i18next_lng", E);
        var d = y;
        b.fixLng && (d = function (a, b) {
            return b = b || {}, b.lng = b.lng || d.lng, y(a, b)
        }, d.lng = E), P.setCurrentLng(E), a && K.setJqueryExt && r();
        var e;
        if (a && a.Deferred && (e = a.Deferred()),
                !K.resStore) {
            var f = O.toLanguages(K.lng);
            "string" == typeof K.preload && (K.preload = [K.preload]);
            for (var g = 0, h = K.preload.length; h > g; g++)for (var i = O.toLanguages(K.preload[g]), j = 0, k = i.length; k > j; j++)f.indexOf(i[j]) < 0 && f.push(i[j]);
            return F.sync.load(f, K, function (a, b) {
                G = b, J = !0, c && c(d), e && e.resolve(d)
            }), e ? e.promise() : void 0
        }
        return G = K.resStore, J = !0, c && c(d), e && e.resolve(d), e ? e.promise() : void 0
    }

    function h(a, b) {
        "string" == typeof a && (a = [a]);
        for (var c = 0, d = a.length; d > c; c++)K.preload.indexOf(a[c]) < 0 && K.preload.push(a[c]);
        return g(b)
    }

    function i(a, b, c, d) {
        "string" != typeof b ? (c = b, b = K.ns.defaultNs) : K.ns.namespaces.indexOf(b) < 0 && K.ns.namespaces.push(b), G[a] = G[a] || {}, G[a][b] = G[a][b] || {}, d ? O.deepExtend(G[a][b], c) : O.extend(G[a][b], c)
    }

    function j(a, b) {
        "string" != typeof b && (b = K.ns.defaultNs), G[a] = G[a] || {}, G[a][b] = {}
    }

    function k(a, b, c, d) {
        "string" != typeof b ? (resource = b, b = K.ns.defaultNs) : K.ns.namespaces.indexOf(b) < 0 && K.ns.namespaces.push(b), G[a] = G[a] || {}, G[a][b] = G[a][b] || {};
        for (var e = c.split(K.keyseparator), f = 0, g = G[K.lng][b]; e[f];)f == e.length - 1 ? g[e[f]] = d : (null == g[e[f]] && (g[e[f]] = {}), g = g[e[f]]), f++
    }

    function l(a, b, c) {
        "string" != typeof b ? (resource = b, b = K.ns.defaultNs) : K.ns.namespaces.indexOf(b) < 0 && K.ns.namespaces.push(b);
        for (var d in c)"string" == typeof c[d] && k(a, b, d, c[d])
    }

    function m(a) {
        K.ns.defaultNs = a
    }

    function n(a, b) {
        o([a], b)
    }

    function o(a, b) {
        var c = {
            dynamicLoad: K.dynamicLoad,
            resGetPath: K.resGetPath,
            getAsync: K.getAsync,
            customLoad: K.customLoad,
            ns: {namespaces: a, defaultNs: ""}
        }, d = O.toLanguages(K.lng);
        "string" == typeof K.preload && (K.preload = [K.preload]);
        for (var e = 0, f = K.preload.length; f > e; e++)for (var g = O.toLanguages(K.preload[e]), h = 0, i = g.length; i > h; h++)d.indexOf(g[h]) < 0 && d.push(g[h]);
        for (var j = [], k = 0, l = d.length; l > k; k++) {
            var m = !1, n = G[d[k]];
            if (n)for (var o = 0, p = a.length; p > o; o++)n[a[o]] || (m = !0); else m = !0;
            m && j.push(d[k])
        }
        j.length ? F.sync._fetch(j, c, function (c, d) {
            var e = a.length * j.length;
            O.each(a, function (a, c) {
                K.ns.namespaces.indexOf(c) < 0 && K.ns.namespaces.push(c), O.each(j, function (a, f) {
                    G[f] = G[f] || {}, G[f][c] = d[f][c], e--, 0 === e && b && (K.useLocalStorage && F.sync._storeLocal(G), b())
                })
            })
        }) : b && b()
    }

    function p(a, b, c) {
        return "function" == typeof b ? (c = b, b = {}) : b || (b = {}), b.lng = a, g(b, c)
    }

    function q() {
        return E
    }

    function r() {
        function b(b, c, d) {
            if (0 !== c.length) {
                var e = "text";
                if (0 === c.indexOf("[")) {
                    var f = c.split("]");
                    c = f[1], e = f[0].substr(1, f[0].length - 1)
                }
                c.indexOf(";") === c.length - 1 && (c = c.substr(0, c.length - 2));
                var g;
                if ("html" === e)g = K.defaultValueFromContent ? a.extend({defaultValue: b.html()}, d) : d, b.html(a.t(c, g)); else if ("text" === e)g = K.defaultValueFromContent ? a.extend({defaultValue: b.text()}, d) : d, b.text(a.t(c, g)); else if ("prepend" === e)g = K.defaultValueFromContent ? a.extend({defaultValue: b.html()}, d) : d, b.prepend(a.t(c, g)); else if ("append" === e)g = K.defaultValueFromContent ? a.extend({defaultValue: b.html()}, d) : d, b.append(a.t(c, g)); else if (0 === e.indexOf("data-")) {
                    var h = e.substr("data-".length);
                    g = K.defaultValueFromContent ? a.extend({defaultValue: b.data(h)}, d) : d;
                    var i = a.t(c, g);
                    b.data(h, i), b.attr(e, i)
                } else g = K.defaultValueFromContent ? a.extend({defaultValue: b.attr(e)}, d) : d, b.attr(e, a.t(c, g))
            }
        }

        function c(c, d) {
            var e = c.attr(K.selectorAttr);
            if (e || "undefined" == typeof e || e === !1 || (e = c.text() || c.val()), e) {
                var f = c, g = c.data("i18n-target");
                if (g && (f = c.find(g) || c), d || K.useDataAttrOptions !== !0 || (d = c.data("i18n-options")), d = d || {}, e.indexOf(";") >= 0) {
                    var h = e.split(";");
                    a.each(h, function (a, c) {
                        "" !== c && b(f, c, d)
                    })
                } else b(f, e, d);
                K.useDataAttrOptions === !0 && c.data("i18n-options", d)
            }
        }

        a.t = a.t || y, a.fn.i18n = function (b) {
            return this.each(function () {
                c(a(this), b);
                var d = a(this).find("[" + K.selectorAttr + "]");
                d.each(function () {
                    c(a(this), b)
                })
            })
        }
    }

    function s(a, b, c, d) {
        if (!a)return a;
        if (d = d || b, a.indexOf(d.interpolationPrefix || K.interpolationPrefix) < 0)return a;
        var e = d.interpolationPrefix ? O.regexEscape(d.interpolationPrefix) : K.interpolationPrefixEscaped, f = d.interpolationSuffix ? O.regexEscape(d.interpolationSuffix) : K.interpolationSuffixEscaped, g = "HTML" + f, h = b.replace && "object" == typeof b.replace ? b.replace : b;
        return O.each(h, function (b, h) {
            var i = c ? c + K.keyseparator + b : b;
            "object" == typeof h && null !== h ? a = s(a, h, i, d) : d.escapeInterpolation || K.escapeInterpolation ? (a = a.replace(new RegExp([e, i, g].join(""), "g"), O.regexReplacementEscape(h)), a = a.replace(new RegExp([e, i, f].join(""), "g"), O.regexReplacementEscape(O.escape(h)))) : a = a.replace(new RegExp([e, i, f].join(""), "g"), O.regexReplacementEscape(h))
        }), a
    }

    function t(a, b) {
        var c = ",", d = "{", e = "}", f = O.extend({}, b);
        for (delete f.postProcess; -1 != a.indexOf(K.reusePrefix) && (H++, !(H > K.maxRecursion));) {
            var g = a.lastIndexOf(K.reusePrefix), h = a.indexOf(K.reuseSuffix, g) + K.reuseSuffix.length, i = a.substring(g, h), j = i.replace(K.reusePrefix, "").replace(K.reuseSuffix, "");
            if (g >= h)return O.error("there is an missing closing in following translation value", a), "";
            if (-1 != j.indexOf(c)) {
                var k = j.indexOf(c);
                if (-1 != j.indexOf(d, k) && -1 != j.indexOf(e, k)) {
                    var l = j.indexOf(d, k), m = j.indexOf(e, l) + e.length;
                    try {
                        f = O.extend(f, JSON.parse(j.substring(l, m))), j = j.substring(0, k)
                    } catch (n) {
                    }
                }
            }
            var o = B(j, f);
            a = a.replace(i, O.regexReplacementEscape(o))
        }
        return a
    }

    function u(a) {
        return a.context && ("string" == typeof a.context || "number" == typeof a.context)
    }

    function v(a, b) {
        return void 0 !== a.count && "string" != typeof a.count && P.needsPlural(b, a.count)
    }

    function w(a) {
        return void 0 !== a.indefinite_article && "string" != typeof a.indefinite_article && a.indefinite_article
    }

    function x(a, b) {
        b = b || {};
        var c = z(a, b), d = C(a, b);
        return void 0 !== d || d === c
    }

    function y(a, b) {
        return b = b || {}, J ? (H = 0, B.apply(null, arguments)) : (O.log("i18next not finished initialization. you might have called t function before loading resources finished."), b.defaultValue || "")
    }

    function z(a, b) {
        return void 0 !== b.defaultValue ? b.defaultValue : a
    }

    function A() {
        for (var a = [], b = 1; b < arguments.length; b++)a.push(arguments[b]);
        return {postProcess: "sprintf", sprintf: a}
    }

    function B(a, b) {
        if (b && "object" != typeof b ? "sprintf" === K.shortcutFunction ? b = A.apply(null, arguments) : "defaultValue" === K.shortcutFunction && (b = {defaultValue: b}) : b = b || {}, void 0 === a || null === a || "" === a)return "";
        "string" == typeof a && (a = [a]);
        var c = a[0];
        if (a.length > 1)for (var d = 0; d < a.length && (c = a[d], !x(c, b)); d++);
        var e, f = z(c, b), g = C(c, b), h = b.lng ? O.toLanguages(b.lng, b.fallbackLng) : I, i = b.ns || K.ns.defaultNs;
        c.indexOf(K.nsseparator) > -1 && (e = c.split(K.nsseparator), i = e[0], c = e[1]), -1 === a[0].indexOf("$") && void 0 === g && K.sendMissing && "function" == typeof K.missingKeyHandler && (b.lng ? K.missingKeyHandler(h[0], i, c, f, h) : K.missingKeyHandler(K.lng, i, c, f, h));
        var j = b.postProcess || K.postProcess;
        void 0 !== g && j && Q[j] && (g = Q[j](g, c, b));
        var k = f;
        if (f.indexOf(K.nsseparator) > -1 && (e = f.split(K.nsseparator), k = e[1]), k === c && K.parseMissingKey && (f = K.parseMissingKey(f)), void 0 === g && (f = s(f, b), f = t(f, b), j && Q[j])) {
            var l = z(c, b);
            g = Q[j](l, c, b)
        }
        return void 0 !== g ? g : f
    }

    function C(a, b) {
        b = b || {};
        var c, d, e = z(a, b), f = I;
        if (!G)return e;
        if ("cimode" === f[0].toLowerCase())return e;
        if (b.lng && (f = O.toLanguages(b.lng, b.fallbackLng), !G[f[0]])) {
            var g = K.getAsync;
            K.getAsync = !1, F.sync.load(f, K, function (a, b) {
                O.extend(G, b), K.getAsync = g
            })
        }
        var h = b.ns || K.ns.defaultNs;
        if (a.indexOf(K.nsseparator) > -1) {
            var i = a.split(K.nsseparator);
            h = i[0], a = i[1]
        }
        if (u(b)) {
            c = O.extend({}, b), delete c.context, c.defaultValue = K.contextNotFound;
            var j = h + K.nsseparator + a + "_" + b.context;
            if (d = y(j, c), d != K.contextNotFound)return s(d, {context: b.context})
        }
        if (v(b, f[0])) {
            c = O.extend({}, b), delete c.count, c.defaultValue = K.pluralNotFound;
            var k = h + K.nsseparator + a + K.pluralSuffix, l = P.get(f[0], b.count);
            if (l >= 0 ? k = k + "_" + l : 1 === l && (k = h + K.nsseparator + a), d = y(k, c), d != K.pluralNotFound)return s(d, {
                count: b.count,
                interpolationPrefix: b.interpolationPrefix,
                interpolationSuffix: b.interpolationSuffix
            })
        }
        if (w(b)) {
            var m = O.extend({}, b);
            delete m.indefinite_article, m.defaultValue = K.indefiniteNotFound;
            var n = h + K.nsseparator + a + (b.count && !v(b, f[0]) || !b.count ? K.indefiniteSuffix : "");
            if (d = y(n, m), d != K.indefiniteNotFound)return d
        }
        for (var o, p = a.split(K.keyseparator), q = 0, r = f.length; r > q && void 0 === o; q++) {
            for (var x = f[q], A = 0, D = G[x] && G[x][h]; p[A];)D = D && D[p[A]], A++;
            if (void 0 !== D) {
                var E = Object.prototype.toString.apply(D);
                if ("string" == typeof D)D = s(D, b), D = t(D, b); else if ("[object Array]" !== E || K.returnObjectTrees || b.returnObjectTrees) {
                    if (null === D && K.fallbackOnNull === !0)D = void 0; else if (null !== D)if (K.returnObjectTrees || b.returnObjectTrees) {
                        if ("[object Number]" !== E && "[object Function]" !== E && "[object RegExp]" !== E) {
                            var H = "[object Array]" === E ? [] : {};
                            O.each(D, function (c) {
                                H[c] = B(h + K.nsseparator + a + K.keyseparator + c, b)
                            }), D = H
                        }
                    } else K.objectTreeKeyHandler && "function" == typeof K.objectTreeKeyHandler ? D = K.objectTreeKeyHandler(a, D, x, h, b) : (D = "key '" + h + ":" + a + " (" + x + ")' returned an object instead of string.", O.log(D))
                } else D = D.join("\n"), D = s(D, b), D = t(D, b);
                "string" == typeof D && "" === D.trim() && K.fallbackOnEmpty === !0 && (D = void 0), o = D
            }
        }
        if (void 0 === o && !b.isFallbackLookup && (K.fallbackToDefaultNS === !0 || K.fallbackNS && K.fallbackNS.length > 0)) {
            if (b.isFallbackLookup = !0, K.fallbackNS.length) {
                for (var J = 0, L = K.fallbackNS.length; L > J; J++)if (o = C(K.fallbackNS[J] + K.nsseparator + a, b)) {
                    var M = o.indexOf(K.nsseparator) > -1 ? o.split(K.nsseparator)[1] : o, N = e.indexOf(K.nsseparator) > -1 ? e.split(K.nsseparator)[1] : e;
                    if (M !== N)break
                }
            } else o = C(a, b);
            b.isFallbackLookup = !1
        }
        return o
    }

    function D() {
        var a, b = [];
        if ("undefined" != typeof window && (!function () {
                for (var a = window.location.search.substring(1), c = a.split("&"), d = 0; d < c.length; d++) {
                    var e = c[d].indexOf("=");
                    if (e > 0) {
                        var f = c[d].substring(0, e), g = c[d].substring(e + 1);
                        b[f] = g
                    }
                }
            }(), b[K.detectLngQS] && (a = b[K.detectLngQS])), !a && "undefined" != typeof document && K.useCookie) {
            var c = O.cookie.read(K.cookieName);
            c && (a = c)
        }
        return !a && "undefined" != typeof document && window.localstorage && K.detectLngFromLocalStorage && (a = window.localStorage.getItem("i18next_lng")), a || "undefined" == typeof navigator || (a = navigator.language ? navigator.language : navigator.userLanguage), a || (a = K.fallbackLng[0]), a
    }

    Array.prototype.indexOf || (Array.prototype.indexOf = function (a) {
        "use strict";
        if (null == this)throw new TypeError;
        var b = Object(this), c = b.length >>> 0;
        if (0 === c)return -1;
        var d = 0;
        if (arguments.length > 0 && (d = Number(arguments[1]), d != d ? d = 0 : 0 != d && d != 1 / 0 && d != -(1 / 0) && (d = (d > 0 || -1) * Math.floor(Math.abs(d)))), d >= c)return -1;
        for (var e = d >= 0 ? d : Math.max(c - Math.abs(d), 0); c > e; e++)if (e in b && b[e] === a)return e;
        return -1
    }), Array.prototype.lastIndexOf || (Array.prototype.lastIndexOf = function (a) {
        "use strict";
        if (null == this)throw new TypeError;
        var b = Object(this), c = b.length >>> 0;
        if (0 === c)return -1;
        var d = c;
        arguments.length > 1 && (d = Number(arguments[1]), d != d ? d = 0 : 0 != d && d != 1 / 0 && d != -(1 / 0) && (d = (d > 0 || -1) * Math.floor(Math.abs(d))));
        for (var e = d >= 0 ? Math.min(d, c - 1) : c - Math.abs(d); e >= 0; e--)if (e in b && b[e] === a)return e;
        return -1
    }), "function" != typeof String.prototype.trim && (String.prototype.trim = function () {
        return this.replace(/^\s+|\s+$/g, "")
    });
    var E, F = {}, G = {}, H = 0, I = [], J = !1;
    sync = {
        load: function (a, b, c) {
            b.useLocalStorage ? sync._loadLocal(a, b, function (d, e) {
                for (var f = [], g = 0, h = a.length; h > g; g++)e[a[g]] || f.push(a[g]);
                f.length > 0 ? sync._fetch(f, b, function (a, b) {
                    O.extend(e, b), sync._storeLocal(b), c(null, e)
                }) : c(null, e)
            }) : sync._fetch(a, b, function (a, b) {
                c(null, b)
            })
        }, _loadLocal: function (a, b, c) {
            var d = {}, e = (new Date).getTime();
            if (window.localStorage) {
                var f = a.length;
                O.each(a, function (a, g) {
                    var h = window.localStorage.getItem("res_" + g);
                    h && (h = JSON.parse(h), h.i18nStamp && h.i18nStamp + b.localStorageExpirationTime > e && (d[g] = h)), f--, 0 === f && c(null, d)
                })
            }
        }, _storeLocal: function (a) {
            if (window.localStorage)for (var b in a)a[b].i18nStamp = (new Date).getTime(), window.localStorage.setItem("res_" + b, JSON.stringify(a[b]))
        }, _fetch: function (a, b, c) {
            var d = b.ns, e = {};
            if (b.dynamicLoad) {
                var f = function (a, b) {
                    c(null, b)
                };
                if ("function" == typeof b.customLoad)b.customLoad(a, d.namespaces, b, f); else {
                    var g = s(b.resGetPath, {lng: a.join("+"), ns: d.namespaces.join("+")});
                    O.ajax({
                        url: g, success: function (a, b, c) {
                            O.log("loaded: " + g), f(null, a)
                        }, error: function (a, b, c) {
                            O.log("failed loading: " + g), f("failed loading resource.json error: " + c)
                        }, dataType: "json", async: b.getAsync
                    })
                }
            } else {
                var h, i = d.namespaces.length * a.length;
                O.each(d.namespaces, function (d, f) {
                    O.each(a, function (a, d) {
                        var g = function (a, b) {
                            a && (h = h || [], h.push(a)), e[d] = e[d] || {}, e[d][f] = b, i--, 0 === i && c(h, e)
                        };
                        "function" == typeof b.customLoad ? b.customLoad(d, f, b, g) : sync._fetchOne(d, f, b, g)
                    })
                })
            }
        }, _fetchOne: function (a, b, c, d) {
            var e = s(c.resGetPath, {lng: a, ns: b});
            O.ajax({
                url: e, success: function (a, b, c) {
                    O.log("loaded: " + e), d(null, a)
                }, error: function (a, b, c) {
                    if (b && 200 == b || a && a.status && 200 == a.status)O.error("There is a typo in: " + e); else if (b && 404 == b || a && a.status && 404 == a.status)O.log("Does not exist: " + e); else {
                        var f = b ? b : a && a.status ? a.status : null;
                        O.log(f + " when loading " + e)
                    }
                    d(c, {})
                }, dataType: "json", async: c.getAsync
            })
        }, postMissing: function (a, b, c, d, e) {
            var f = {};
            f[c] = d;
            var g = [];
            if ("fallback" === K.sendMissingTo && K.fallbackLng[0] !== !1)for (var h = 0; h < K.fallbackLng.length; h++)g.push({
                lng: K.fallbackLng[h],
                url: s(K.resPostPath, {lng: K.fallbackLng[h], ns: b})
            }); else if ("current" === K.sendMissingTo || "fallback" === K.sendMissingTo && K.fallbackLng[0] === !1)g.push({
                lng: a,
                url: s(K.resPostPath, {lng: a, ns: b})
            }); else if ("all" === K.sendMissingTo)for (var h = 0, i = e.length; i > h; h++)g.push({
                lng: e[h],
                url: s(K.resPostPath, {lng: e[h], ns: b})
            });
            for (var j = 0, k = g.length; k > j; j++) {
                var l = g[j];
                O.ajax({
                    url: l.url, type: K.sendType, data: f, success: function (a, e, f) {
                        O.log("posted missing key '" + c + "' to: " + l.url);
                        for (var g = c.split("."), h = 0, i = G[l.lng][b]; g[h];)i = h === g.length - 1 ? i[g[h]] = d : i[g[h]] = i[g[h]] || {}, h++
                    }, error: function (a, b, d) {
                        O.log("failed posting missing key '" + c + "' to: " + l.url)
                    }, dataType: "json", async: K.postAsync
                })
            }
        }
    };
    var K = {
        lng: void 0,
        load: "all",
        preload: [],
        lowerCaseLng: !1,
        returnObjectTrees: !1,
        fallbackLng: ["dev"],
        fallbackNS: [],
        detectLngQS: "setLng",
        detectLngFromLocalStorage: !1,
        ns: "translation",
        fallbackOnNull: !0,
        fallbackOnEmpty: !1,
        fallbackToDefaultNS: !1,
        nsseparator: ":",
        keyseparator: ".",
        selectorAttr: "data-i18n",
        debug: !1,
        resGetPath: "locales/__lng__/__ns__.json",
        resPostPath: "locales/add/__lng__/__ns__",
        getAsync: !0,
        postAsync: !0,
        resStore: void 0,
        useLocalStorage: !1,
        localStorageExpirationTime: 6048e5,
        dynamicLoad: !1,
        sendMissing: !1,
        sendMissingTo: "fallback",
        sendType: "POST",
        interpolationPrefix: "__",
        interpolationSuffix: "__",
        reusePrefix: "$t(",
        reuseSuffix: ")",
        pluralSuffix: "_plural",
        pluralNotFound: ["plural_not_found", Math.random()].join(""),
        contextNotFound: ["context_not_found", Math.random()].join(""),
        escapeInterpolation: !1,
        indefiniteSuffix: "_indefinite",
        indefiniteNotFound: ["indefinite_not_found", Math.random()].join(""),
        setJqueryExt: !0,
        defaultValueFromContent: !0,
        useDataAttrOptions: !1,
        cookieExpirationTime: void 0,
        useCookie: !0,
        cookieName: "i18next",
        cookieDomain: void 0,
        objectTreeKeyHandler: void 0,
        postProcess: void 0,
        parseMissingKey: void 0,
        missingKeyHandler: sync.postMissing,
        shortcutFunction: "sprintf"
    }, L = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;",
        "/": "&#x2F;"
    }, M = {
        create: function (a, b, c, d) {
            var e;
            if (c) {
                var f = new Date;
                f.setTime(f.getTime() + 60 * c * 1e3), e = "; expires=" + f.toGMTString()
            } else e = "";
            d = d ? "domain=" + d + ";" : "", document.cookie = a + "=" + b + e + ";" + d + "path=/"
        }, read: function (a) {
            for (var b = a + "=", c = document.cookie.split(";"), d = 0; d < c.length; d++) {
                for (var e = c[d]; " " == e.charAt(0);)e = e.substring(1, e.length);
                if (0 === e.indexOf(b))return e.substring(b.length, e.length)
            }
            return null
        }, remove: function (a) {
            this.create(a, "", -1)
        }
    }, N = {
        create: function (a, b, c, d) {
        }, read: function (a) {
            return null
        }, remove: function (a) {
        }
    }, O = {
        extend: a ? a.extend : b,
        deepExtend: c,
        each: a ? a.each : d,
        ajax: a ? a.ajax : "undefined" != typeof document ? f : function () {
        },
        cookie: "undefined" != typeof document ? M : N,
        detectLanguage: D,
        escape: e,
        log: function (a) {
            K.debug && "undefined" != typeof console && console.log(a)
        },
        error: function (a) {
            "undefined" != typeof console && console.error(a)
        },
        getCountyIndexOfLng: function (a) {
            var b = 0;
            return ("nb-NO" === a || "nn-NO" === a) && (b = 1), b
        },
        toLanguages: function (a) {
            var b = this.log, c = [], d = K.lngWhitelist || !1, e = function (a) {
                !d || d.indexOf(a) > -1 ? c.push(a) : b("rejecting non-whitelisted language: " + a)
            };
            if ("string" == typeof a && a.indexOf("-") > -1) {
                var f = a.split("-");
                a = K.lowerCaseLng ? f[0].toLowerCase() + "-" + f[1].toLowerCase() : f[0].toLowerCase() + "-" + f[1].toUpperCase(), "unspecific" !== K.load && e(a), "current" !== K.load && e(f[this.getCountyIndexOfLng(a)])
            } else e(a);
            for (var g = 0; g < K.fallbackLng.length; g++)-1 === c.indexOf(K.fallbackLng[g]) && K.fallbackLng[g] && c.push(K.fallbackLng[g]);
            return c
        },
        regexEscape: function (a) {
            return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&")
        },
        regexReplacementEscape: function (a) {
            return "string" == typeof a ? a.replace(/\$/g, "$$$$") : a
        }
    };
    O.applyReplacement = s;
    var P = {
        rules: {
            ach: {
                name: "Acholi", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, af: {
                name: "Afrikaans", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ak: {
                name: "Akan", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, am: {
                name: "Amharic", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, an: {
                name: "Aragonese", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ar: {
                name: "Arabic", numbers: [0, 1, 2, 3, 11, 100], plurals: function (a) {
                    return Number(0 === a ? 0 : 1 == a ? 1 : 2 == a ? 2 : a % 100 >= 3 && 10 >= a % 100 ? 3 : a % 100 >= 11 ? 4 : 5)
                }
            }, arn: {
                name: "Mapudungun", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, ast: {
                name: "Asturian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ay: {
                name: "Aymar", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, az: {
                name: "Azerbaijani", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, be: {
                name: "Belarusian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, bg: {
                name: "Bulgarian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, bn: {
                name: "Bengali", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, bo: {
                name: "Tibetan", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, br: {
                name: "Breton", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, bs: {
                name: "Bosnian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, ca: {
                name: "Catalan", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, cgg: {
                name: "Chiga", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, cs: {
                name: "Czech", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(1 == a ? 0 : a >= 2 && 4 >= a ? 1 : 2)
                }
            }, csb: {
                name: "Kashubian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(1 == a ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, cy: {
                name: "Welsh", numbers: [1, 2, 3, 8], plurals: function (a) {
                    return Number(1 == a ? 0 : 2 == a ? 1 : 8 != a && 11 != a ? 2 : 3)
                }
            }, da: {
                name: "Danish", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, de: {
                name: "German", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, dz: {
                name: "Dzongkha", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, el: {
                name: "Greek", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, en: {
                name: "English", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, eo: {
                name: "Esperanto", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, es: {
                name: "Spanish", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, es_ar: {
                name: "Argentinean Spanish", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, et: {
                name: "Estonian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, eu: {
                name: "Basque", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, fa: {
                name: "Persian", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, fi: {
                name: "Finnish", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, fil: {
                name: "Filipino", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, fo: {
                name: "Faroese", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, fr: {
                name: "French", numbers: [1, 2], plurals: function (a) {
                    return Number(a >= 2)
                }
            }, fur: {
                name: "Friulian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, fy: {
                name: "Frisian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ga: {
                name: "Irish", numbers: [1, 2, 3, 7, 11], plurals: function (a) {
                    return Number(1 == a ? 0 : 2 == a ? 1 : 7 > a ? 2 : 11 > a ? 3 : 4)
                }
            }, gd: {
                name: "Scottish Gaelic", numbers: [1, 2, 3, 20], plurals: function (a) {
                    return Number(1 == a || 11 == a ? 0 : 2 == a || 12 == a ? 1 : a > 2 && 20 > a ? 2 : 3)
                }
            }, gl: {
                name: "Galician", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, gu: {
                name: "Gujarati", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, gun: {
                name: "Gun", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, ha: {
                name: "Hausa", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, he: {
                name: "Hebrew", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, hi: {
                name: "Hindi", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, hr: {
                name: "Croatian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, hu: {
                name: "Hungarian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, hy: {
                name: "Armenian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ia: {
                name: "Interlingua", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, id: {
                name: "Indonesian", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, is: {
                name: "Icelandic", numbers: [1, 2], plurals: function (a) {
                    return Number(a % 10 != 1 || a % 100 == 11)
                }
            }, it: {
                name: "Italian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ja: {
                name: "Japanese", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, jbo: {
                name: "Lojban", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, jv: {
                name: "Javanese", numbers: [0, 1], plurals: function (a) {
                    return Number(0 !== a)
                }
            }, ka: {
                name: "Georgian", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, kk: {
                name: "Kazakh", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, km: {
                name: "Khmer", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, kn: {
                name: "Kannada", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ko: {
                name: "Korean", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, ku: {
                name: "Kurdish", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, kw: {
                name: "Cornish", numbers: [1, 2, 3, 4], plurals: function (a) {
                    return Number(1 == a ? 0 : 2 == a ? 1 : 3 == a ? 2 : 3)
                }
            }, ky: {
                name: "Kyrgyz", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, lb: {
                name: "Letzeburgesch", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ln: {
                name: "Lingala", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, lo: {
                name: "Lao", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, lt: {
                name: "Lithuanian", numbers: [1, 2, 10], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, lv: {
                name: "Latvian", numbers: [1, 2, 0], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : 0 !== a ? 1 : 2)
                }
            }, mai: {
                name: "Maithili", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, mfe: {
                name: "Mauritian Creole", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, mg: {
                name: "Malagasy", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, mi: {
                name: "Maori", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, mk: {
                name: "Macedonian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 == a || a % 10 == 1 ? 0 : 1)
                }
            }, ml: {
                name: "Malayalam", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, mn: {
                name: "Mongolian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, mnk: {
                name: "Mandinka", numbers: [0, 1, 2], plurals: function (a) {
                    return Number(1 == a ? 1 : 2)
                }
            }, mr: {
                name: "Marathi", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ms: {
                name: "Malay", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, mt: {
                name: "Maltese", numbers: [1, 2, 11, 20], plurals: function (a) {
                    return Number(1 == a ? 0 : 0 === a || a % 100 > 1 && 11 > a % 100 ? 1 : a % 100 > 10 && 20 > a % 100 ? 2 : 3)
                }
            }, nah: {
                name: "Nahuatl", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, nap: {
                name: "Neapolitan", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, nb: {
                name: "Norwegian Bokmal", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ne: {
                name: "Nepali", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, nl: {
                name: "Dutch", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, nn: {
                name: "Norwegian Nynorsk", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, no: {
                name: "Norwegian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, nso: {
                name: "Northern Sotho", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, oc: {
                name: "Occitan", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, or: {
                name: "Oriya", numbers: [2, 1], plurals: function (a) {
                    return Number(1 != a)
                }
            }, pa: {
                name: "Punjabi", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, pap: {
                name: "Papiamento", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, pl: {
                name: "Polish", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(1 == a ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, pms: {
                name: "Piemontese", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ps: {
                name: "Pashto", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, pt: {
                name: "Portuguese", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, pt_br: {
                name: "Brazilian Portuguese", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, rm: {
                name: "Romansh", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ro: {
                name: "Romanian", numbers: [1, 2, 20], plurals: function (a) {
                    return Number(1 == a ? 0 : 0 === a || a % 100 > 0 && 20 > a % 100 ? 1 : 2)
                }
            }, ru: {
                name: "Russian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, sah: {
                name: "Yakut", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, sco: {
                name: "Scots", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, se: {
                name: "Northern Sami", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, si: {
                name: "Sinhala", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, sk: {
                name: "Slovak", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(1 == a ? 0 : a >= 2 && 4 >= a ? 1 : 2)
                }
            }, sl: {
                name: "Slovenian", numbers: [5, 1, 2, 3], plurals: function (a) {
                    return Number(a % 100 == 1 ? 1 : a % 100 == 2 ? 2 : a % 100 == 3 || a % 100 == 4 ? 3 : 0)
                }
            }, so: {
                name: "Somali", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, son: {
                name: "Songhay", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, sq: {
                name: "Albanian", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, sr: {
                name: "Serbian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, su: {
                name: "Sundanese", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, sv: {
                name: "Swedish", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, sw: {
                name: "Swahili", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, ta: {
                name: "Tamil", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, te: {
                name: "Telugu", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, tg: {
                name: "Tajik", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, th: {
                name: "Thai", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, ti: {
                name: "Tigrinya", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, tk: {
                name: "Turkmen", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, tr: {
                name: "Turkish", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, tt: {
                name: "Tatar", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, ug: {
                name: "Uyghur", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, uk: {
                name: "Ukrainian", numbers: [1, 2, 5], plurals: function (a) {
                    return Number(a % 10 == 1 && a % 100 != 11 ? 0 : a % 10 >= 2 && 4 >= a % 10 && (10 > a % 100 || a % 100 >= 20) ? 1 : 2)
                }
            }, ur: {
                name: "Urdu", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, uz: {
                name: "Uzbek", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, vi: {
                name: "Vietnamese", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, wa: {
                name: "Walloon", numbers: [1, 2], plurals: function (a) {
                    return Number(a > 1)
                }
            }, wo: {
                name: "Wolof", numbers: [1], plurals: function (a) {
                    return 0
                }
            }, yo: {
                name: "Yoruba", numbers: [1, 2], plurals: function (a) {
                    return Number(1 != a)
                }
            }, zh: {
                name: "Chinese", numbers: [1], plurals: function (a) {
                    return 0
                }
            }
        }, addRule: function (a, b) {
            P.rules[a] = b
        }, setCurrentLng: function (a) {
            if (!P.currentRule || P.currentRule.lng !== a) {
                var b = a.split("-");
                P.currentRule = {lng: a, rule: P.rules[b[0]]}
            }
        }, needsPlural: function (a, b) {
            var c, d = a.split("-");
            return c = P.currentRule && P.currentRule.lng === a ? P.currentRule.rule : P.rules[d[O.getCountyIndexOfLng(a)]], c && c.numbers.length <= 1 ? !1 : 1 !== this.get(a, b)
        }, get: function (a, b) {
            function c(b, c) {
                var d;
                if (d = P.currentRule && P.currentRule.lng === a ? P.currentRule.rule : P.rules[b]) {
                    var e;
                    e = d.noAbs ? d.plurals(c) : d.plurals(Math.abs(c));
                    var f = d.numbers[e];
                    return 2 === d.numbers.length && 1 === d.numbers[0] && (2 === f ? f = -1 : 1 === f && (f = 1)), f
                }
                return 1 === c ? "1" : "-1"
            }

            var d = a.split("-");
            return c(d[O.getCountyIndexOfLng(a)], b)
        }
    }, Q = {}, R = function (a, b) {
        Q[a] = b
    }, S = function () {
        function a(a) {
            return Object.prototype.toString.call(a).slice(8, -1).toLowerCase()
        }

        function b(a, b) {
            for (var c = []; b > 0; c[--b] = a);
            return c.join("")
        }

        var c = function () {
            return c.cache.hasOwnProperty(arguments[0]) || (c.cache[arguments[0]] = c.parse(arguments[0])), c.format.call(null, c.cache[arguments[0]], arguments)
        };
        return c.format = function (c, d) {
            var e, f, g, h, i, j, k, l = 1, m = c.length, n = "", o = [];
            for (f = 0; m > f; f++)if (n = a(c[f]), "string" === n)o.push(c[f]); else if ("array" === n) {
                if (h = c[f], h[2])for (e = d[l], g = 0; g < h[2].length; g++) {
                    if (!e.hasOwnProperty(h[2][g]))throw S('[sprintf] property "%s" does not exist', h[2][g]);
                    e = e[h[2][g]]
                } else e = h[1] ? d[h[1]] : d[l++];
                if (/[^s]/.test(h[8]) && "number" != a(e))throw S("[sprintf] expecting number but found %s", a(e));
                switch (h[8]) {
                    case"b":
                        e = e.toString(2);
                        break;
                    case"c":
                        e = String.fromCharCode(e);
                        break;
                    case"d":
                        e = parseInt(e, 10);
                        break;
                    case"e":
                        e = h[7] ? e.toExponential(h[7]) : e.toExponential();
                        break;
                    case"f":
                        e = h[7] ? parseFloat(e).toFixed(h[7]) : parseFloat(e);
                        break;
                    case"o":
                        e = e.toString(8);
                        break;
                    case"s":
                        e = (e = String(e)) && h[7] ? e.substring(0, h[7]) : e;
                        break;
                    case"u":
                        e = Math.abs(e);
                        break;
                    case"x":
                        e = e.toString(16);
                        break;
                    case"X":
                        e = e.toString(16).toUpperCase()
                }
                e = /[def]/.test(h[8]) && h[3] && e >= 0 ? "+" + e : e, j = h[4] ? "0" == h[4] ? "0" : h[4].charAt(1) : " ", k = h[6] - String(e).length, i = h[6] ? b(j, k) : "", o.push(h[5] ? e + i : i + e)
            }
            return o.join("")
        }, c.cache = {}, c.parse = function (a) {
            for (var b = a, c = [], d = [], e = 0; b;) {
                if (null !== (c = /^[^\x25]+/.exec(b)))d.push(c[0]); else if (null !== (c = /^\x25{2}/.exec(b)))d.push("%"); else {
                    if (null === (c = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw"[sprintf] huh?";
                    if (c[2]) {
                        e |= 1;
                        var f = [], g = c[2], h = [];
                        if (null === (h = /^([a-z_][a-z_\d]*)/i.exec(g)))throw"[sprintf] huh?";
                        for (f.push(h[1]); "" !== (g = g.substring(h[0].length));)if (null !== (h = /^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]); else {
                            if (null === (h = /^\[(\d+)\]/.exec(g)))throw"[sprintf] huh?";
                            f.push(h[1])
                        }
                        c[2] = f
                    } else e |= 2;
                    if (3 === e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";
                    d.push(c)
                }
                b = b.substring(c[0].length)
            }
            return d
        }, c
    }(), T = function (a, b) {
        return b.unshift(a), S.apply(null, b)
    };
    return R("sprintf", function (a, b, c) {
        return c.sprintf ? "[object Array]" === Object.prototype.toString.apply(c.sprintf) ? T(a, c.sprintf) : "object" == typeof c.sprintf ? S(a, c.sprintf) : a : a
    }), F.init = g, F.setLng = p, F.preload = h, F.addResourceBundle = i, F.addResource = k, F.addResources = l, F.removeResourceBundle = j, F.loadNamespace = n, F.loadNamespaces = o, F.setDefaultNamespace = m, F.t = y, F.translate = y, F.exists = x, F.detectLanguage = O.detectLanguage, F.pluralExtensions = P, F.sync = sync, F.functions = O, F.lng = q, F.addPostProcessor = R, F.options = K, a.i18n = F, a.t = F.t, F
}), function (a) {
    "use strict";
    "function" == typeof define && define.amd ? define("jstree", ["jquery"], a) : a("object" == typeof exports ? require("jquery") : jQuery)
}(function (a, b) {
    "use strict";
    if (!a.jstree) {
        var c, d, e = 0, f = !1, g = !1, h = !1, i = [], j = a("script:last").attr("src"), k = document, l = k.createElement("LI");
        l.setAttribute("role", "treeitem"), c = k.createElement("I"), c.className = "jstree-icon jstree-ocl", l.appendChild(c), c = k.createElement("A"), c.className = "jstree-anchor", c.setAttribute("href", "#"), d = k.createElement("I"), d.className = "jstree-icon jstree-themeicon", c.appendChild(d), l.appendChild(c), c = d = null, a.jstree = {
            version: "3.0.4",
            defaults: {plugins: []},
            plugins: {},
            path: j && -1 !== j.indexOf("/") ? j.replace(/\/[^\/]+$/, "") : "",
            idregex: /[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%]/g
        }, a.jstree.create = function (b, c) {
            var d = new a.jstree.core(++e), f = c;
            return c = a.extend(!0, {}, a.jstree.defaults, c), f && f.plugins && (c.plugins = f.plugins), a.each(c.plugins, function (a, b) {
                "core" !== a && (d = d.plugin(b, c[b]))
            }), d.init(b, c), d
        }, a.jstree.destroy = function () {
            a(".jstree:jstree").jstree("destroy"), a(document).off(".jstree")
        }, a.jstree.core = function (a) {
            this._id = a, this._cnt = 0, this._wrk = null, this._data = {
                core: {
                    themes: {name: !1, dots: !1, icons: !1},
                    selected: [],
                    last_error: {},
                    working: !1,
                    worker_queue: [],
                    focused: null
                }
            }
        }, a.jstree.reference = function (b) {
            var c = null, d = null;
            if (b && b.id && (b = b.id), !d || !d.length)try {
                d = a(b)
            } catch (e) {
            }
            if (!d || !d.length)try {
                d = a("#" + b.replace(a.jstree.idregex, "\\$&"))
            } catch (e) {
            }
            return d && d.length && (d = d.closest(".jstree")).length && (d = d.data("jstree")) ? c = d : a(".jstree").each(function () {
                var d = a(this).data("jstree");
                return d && d._model.data[b] ? (c = d, !1) : void 0
            }), c
        }, a.fn.jstree = function (c) {
            var d = "string" == typeof c, e = Array.prototype.slice.call(arguments, 1), f = null;
            return this.each(function () {
                var g = a.jstree.reference(this), h = d && g ? g[c] : null;
                return f = d && h ? h.apply(g, e) : null, g || d || c !== b && !a.isPlainObject(c) || a(this).data("jstree", new a.jstree.create(this, c)), (g && !d || c === !0) && (f = g || !1), null !== f && f !== b ? !1 : void 0;
            }), null !== f && f !== b ? f : this
        }, a.expr[":"].jstree = a.expr.createPseudo(function (c) {
            return function (c) {
                return a(c).hasClass("jstree") && a(c).data("jstree") !== b
            }
        }), a.jstree.defaults.core = {
            data: !1,
            strings: !1,
            check_callback: !1,
            error: a.noop,
            animation: 200,
            multiple: !0,
            themes: {name: !1, url: !1, dir: !1, dots: !0, icons: !0, stripes: !1, variant: !1, responsive: !1},
            expand_selected_onload: !0,
            worker: !0,
            force_text: !1
        }, a.jstree.core.prototype = {
            plugin: function (b, c) {
                var d = a.jstree.plugins[b];
                return d ? (this._data[b] = {}, d.prototype = this, new d(c, this)) : this
            }, init: function (b, c) {
                this._model = {
                    data: {
                        "#": {
                            id: "#",
                            parent: null,
                            parents: [],
                            children: [],
                            children_d: [],
                            state: {loaded: !1}
                        }
                    },
                    changed: [],
                    force_full_redraw: !1,
                    redraw_timeout: !1,
                    default_state: {loaded: !0, opened: !1, selected: !1, disabled: !1}
                }, this.element = a(b).addClass("jstree jstree-" + this._id), this.settings = c, this.element.bind("destroyed", a.proxy(this.teardown, this)), this._data.core.ready = !1, this._data.core.loaded = !1, this._data.core.rtl = "rtl" === this.element.css("direction"), this.element[this._data.core.rtl ? "addClass" : "removeClass"]("jstree-rtl"), this.element.attr("role", "tree"), this.bind(), this.trigger("init"), this._data.core.original_container_html = this.element.find(" > ul > li").clone(!0), this._data.core.original_container_html.find("li").addBack().contents().filter(function () {
                    return 3 === this.nodeType && (!this.nodeValue || /^\s+$/.test(this.nodeValue))
                }).remove(), this.element.html("<ul class='jstree-container-ul jstree-children'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>" + this.get_string("Loading ...") + "</a></li></ul>"), this._data.core.li_height = this.get_container_ul().children("li").first().height() || 24, this.trigger("loading"), this.load_node("#")
            }, destroy: function (a) {
                if (this._wrk)try {
                    window.URL.revokeObjectURL(this._wrk), this._wrk = null
                } catch (b) {
                }
                a || this.element.empty(), this.element.unbind("destroyed", this.teardown), this.teardown()
            }, teardown: function () {
                this.unbind(), this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class", function () {
                    return this.className.replace(/jstree[^ ]*|$/gi, "")
                }), this.element = null
            }, bind: function () {
                this.element.on("dblclick.jstree", function () {
                    if (document.selection && document.selection.empty)document.selection.empty(); else if (window.getSelection) {
                        var a = window.getSelection();
                        try {
                            a.removeAllRanges(), a.collapse()
                        } catch (b) {
                        }
                    }
                }).on("click.jstree", ".jstree-ocl", a.proxy(function (a) {
                    this.toggle_node(a.target)
                }, this)).on("click.jstree", ".jstree-anchor", a.proxy(function (b) {
                    b.preventDefault(), b.currentTarget !== document.activeElement && a(b.currentTarget).focus(), this.activate_node(b.currentTarget, b)
                }, this)).on("keydown.jstree", ".jstree-anchor", a.proxy(function (b) {
                    if ("INPUT" === b.target.tagName)return !0;
                    var c = null;
                    switch (b.which) {
                        case 13:
                        case 32:
                            b.type = "click", a(b.currentTarget).trigger(b);
                            break;
                        case 37:
                            b.preventDefault(), this.is_open(b.currentTarget) ? this.closeNode(b.currentTarget) : (c = this.get_prev_dom(b.currentTarget), c && c.length && c.children(".jstree-anchor").focus());
                            break;
                        case 38:
                            b.preventDefault(), c = this.get_prev_dom(b.currentTarget), c && c.length && c.children(".jstree-anchor").focus();
                            break;
                        case 39:
                            b.preventDefault(), this.is_closed(b.currentTarget) ? this.openNode(b.currentTarget, function (a) {
                                this.get_node(a, !0).children(".jstree-anchor").focus()
                            }) : (c = this.get_next_dom(b.currentTarget), c && c.length && c.children(".jstree-anchor").focus());
                            break;
                        case 40:
                            b.preventDefault(), c = this.get_next_dom(b.currentTarget), c && c.length && c.children(".jstree-anchor").focus();
                            break;
                        case 46:
                            b.preventDefault(), c = this.get_node(b.currentTarget), c && c.id && "#" !== c.id && (c = this.is_selected(c) ? this.get_selected() : c);
                            break;
                        case 113:
                            b.preventDefault(), c = this.get_node(b.currentTarget)
                    }
                }, this)).on("load_node.jstree", a.proxy(function (b, c) {
                    if (c.status && ("#" !== c.node.id || this._data.core.loaded || (this._data.core.loaded = !0, this.trigger("loaded")), !this._data.core.ready && !this.get_container_ul().find(".jstree-loading").length)) {
                        if (this._data.core.ready = !0, this._data.core.selected.length) {
                            if (this.settings.core.expand_selected_onload) {
                                var d, e, f = [];
                                for (d = 0, e = this._data.core.selected.length; e > d; d++)f = f.concat(this._model.data[this._data.core.selected[d]].parents);
                                for (f = a.vakata.array_unique(f), d = 0, e = f.length; e > d; d++)this.openNode(f[d], !1, 0)
                            }
                            this.trigger("changed", {action: "ready", selected: this._data.core.selected})
                        }
                        setTimeout(a.proxy(function () {
                            this.trigger("ready")
                        }, this), 0)
                    }
                }, this)).on("init.jstree", a.proxy(function () {
                    var a = this.settings.core.themes;
                    this._data.core.themes.dots = a.dots, this._data.core.themes.stripes = a.stripes, this._data.core.themes.icons = a.icons, this.set_theme(a.name || "default", a.url), this.set_theme_variant(a.variant)
                }, this)).on("loading.jstree", a.proxy(function () {
                    this[this._data.core.themes.dots ? "show_dots" : "hide_dots"](), this[this._data.core.themes.icons ? "show_icons" : "hide_icons"](), this[this._data.core.themes.stripes ? "show_stripes" : "hide_stripes"]()
                }, this)).on("blur.jstree", ".jstree-anchor", a.proxy(function (b) {
                    this._data.core.focused = null, a(b.currentTarget).filter(".jstree-hovered").mouseleave()
                }, this)).on("focus.jstree", ".jstree-anchor", a.proxy(function (b) {
                    var c = this.get_node(b.currentTarget);
                    c && c.id && (this._data.core.focused = c.id), this.element.find(".jstree-hovered").not(b.currentTarget).mouseleave(), a(b.currentTarget).mouseenter()
                }, this)).on("mouseenter.jstree", ".jstree-anchor", a.proxy(function (a) {
                    this.hover_node(a.currentTarget)
                }, this)).on("mouseleave.jstree", ".jstree-anchor", a.proxy(function (a) {
                    this.dehover_node(a.currentTarget)
                }, this))
            }, unbind: function () {
                this.element.off(".jstree"), a(document).off(".jstree-" + this._id)
            }, trigger: function (a, b) {
                b || (b = {}), b.instance = this, this.element.triggerHandler(a.replace(".jstree", "") + ".jstree", b)
            }, get_container: function () {
                return this.element
            }, get_container_ul: function () {
                return this.element.children(".jstree-children").first()
            }, get_string: function (b) {
                var c = this.settings.core.strings;
                return a.isFunction(c) ? c.call(this, b) : c && c[b] ? c[b] : b
            }, _firstChild: function (a) {
                for (a = a ? a.firstChild : null; null !== a && 1 !== a.nodeType;)a = a.nextSibling;
                return a
            }, _nextSibling: function (a) {
                for (a = a ? a.nextSibling : null; null !== a && 1 !== a.nodeType;)a = a.nextSibling;
                return a
            }, _previousSibling: function (a) {
                for (a = a ? a.previousSibling : null; null !== a && 1 !== a.nodeType;)a = a.previousSibling;
                return a
            }, get_node: function (b, c) {
                b && b.id && (b = b.id);
                var d;
                try {
                    if (this._model.data[b])b = this._model.data[b]; else if (((d = a(b, this.element)).length || (d = a("#" + b.replace(a.jstree.idregex, "\\$&"), this.element)).length) && this._model.data[d.closest(".jstree-node").attr("id")])b = this._model.data[d.closest(".jstree-node").attr("id")]; else {
                        if (!(d = a(b, this.element)).length || !d.hasClass("jstree"))return !1;
                        b = this._model.data["#"]
                    }
                    return c && (b = "#" === b.id ? this.element : a("#" + b.id.replace(a.jstree.idregex, "\\$&"), this.element)), b
                } catch (e) {
                    return !1
                }
            }, get_path: function (a, b, c) {
                if (a = a.parents ? a : this.get_node(a), !a || "#" === a.id || !a.parents)return !1;
                var d, e, f = [];
                for (f.push(c ? a.id : a.text), d = 0, e = a.parents.length; e > d; d++)f.push(c ? a.parents[d] : this.get_text(a.parents[d]));
                return f = f.reverse().slice(1), b ? f.join(b) : f
            }, get_next_dom: function (b, c) {
                var d;
                if (b = this.get_node(b, !0), b[0] === this.element[0]) {
                    for (d = this._firstChild(this.get_container_ul()[0]); d && 0 === d.offsetHeight;)d = this._nextSibling(d);
                    return d ? a(d) : !1
                }
                if (!b || !b.length)return !1;
                if (c) {
                    d = b[0];
                    do d = this._nextSibling(d); while (d && 0 === d.offsetHeight);
                    return d ? a(d) : !1
                }
                if (b.hasClass("jstree-open")) {
                    for (d = this._firstChild(b.children(".jstree-children")[0]); d && 0 === d.offsetHeight;)d = this._nextSibling(d);
                    if (null !== d)return a(d)
                }
                d = b[0];
                do d = this._nextSibling(d); while (d && 0 === d.offsetHeight);
                return null !== d ? a(d) : b.parentsUntil(".jstree", ".jstree-node").next(".jstree-node:visible").first()
            }, get_prev_dom: function (b, c) {
                var d;
                if (b = this.get_node(b, !0), b[0] === this.element[0]) {
                    for (d = this.get_container_ul()[0].lastChild; d && 0 === d.offsetHeight;)d = this._previousSibling(d);
                    return d ? a(d) : !1
                }
                if (!b || !b.length)return !1;
                if (c) {
                    d = b[0];
                    do d = this._previousSibling(d); while (d && 0 === d.offsetHeight);
                    return d ? a(d) : !1
                }
                d = b[0];
                do d = this._previousSibling(d); while (d && 0 === d.offsetHeight);
                if (null !== d) {
                    for (b = a(d); b.hasClass("jstree-open");)b = b.children(".jstree-children").first().children(".jstree-node:visible:last");
                    return b
                }
                return d = b[0].parentNode.parentNode, d && d.className && -1 !== d.className.indexOf("jstree-node") ? a(d) : !1
            }, get_parent: function (a) {
                return a = this.get_node(a), a && "#" !== a.id ? a.parent : !1
            }, get_children_dom: function (a) {
                return a = this.get_node(a, !0), a[0] === this.element[0] ? this.get_container_ul().children(".jstree-node") : a && a.length ? a.children(".jstree-children").children(".jstree-node") : !1
            }, is_parent: function (a) {
                return a = this.get_node(a), a && (a.state.loaded === !1 || a.children.length > 0)
            }, is_loaded: function (a) {
                return a = this.get_node(a), a && a.state.loaded
            }, is_loading: function (a) {
                return a = this.get_node(a), a && a.state && a.state.loading
            }, is_open: function (a) {
                return a = this.get_node(a), a && a.state.opened
            }, is_closed: function (a) {
                return a = this.get_node(a), a && this.is_parent(a) && !a.state.opened
            }, is_leaf: function (a) {
                return !this.is_parent(a)
            }, load_node: function (b, c) {
                var d, e, f, g, h;
                if (a.isArray(b))return this._load_nodes(b.slice(), c), !0;
                if (b = this.get_node(b), !b)return c && c.call(this, b, !1), !1;
                if (b.state.loaded) {
                    for (b.state.loaded = !1, d = 0, e = b.children_d.length; e > d; d++) {
                        for (f = 0, g = b.parents.length; g > f; f++)this._model.data[b.parents[f]].children_d = a.vakata.array_remove_item(this._model.data[b.parents[f]].children_d, b.children_d[d]);
                        this._model.data[b.children_d[d]].state.selected && (h = !0, this._data.core.selected = a.vakata.array_remove_item(this._data.core.selected, b.children_d[d])), delete this._model.data[b.children_d[d]]
                    }
                    b.children = [], b.children_d = [], h && this.trigger("changed", {
                        action: "load_node",
                        node: b,
                        selected: this._data.core.selected
                    })
                }
                return b.state.loading = !0, this.get_node(b, !0).addClass("jstree-loading"), this._load_node(b, a.proxy(function (a) {
                    b = this._model.data[b.id], b.state.loading = !1, b.state.loaded = a;
                    var d = this.get_node(b, !0);
                    b.state.loaded && !b.children.length && d && d.length && !d.hasClass("jstree-leaf") && d.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"), d.removeClass("jstree-loading"), this.trigger("load_node", {
                        node: b,
                        status: a
                    }), c && c.call(this, b, a)
                }, this)), !0
            }, _load_nodes: function (a, b, c) {
                var d, e, f = !0, g = function () {
                    this._load_nodes(a, b, !0)
                }, h = this._model.data;
                for (d = 0, e = a.length; e > d; d++)!h[a[d]] || h[a[d]].state.loaded && c || (this.is_loading(a[d]) || this.load_node(a[d], g), f = !1);
                f && b && !b.done && (b.call(this, a), b.done = !0)
            }, _load_node: function (b, c) {
                var d, e = this.settings.core.data;
                return e ? a.isFunction(e) ? e.call(this, b, a.proxy(function (d) {
                    d === !1 && c.call(this, !1), this["string" == typeof d ? "_append_html_data" : "_append_json_data"](b, "string" == typeof d ? a(d) : d, function (a) {
                        c.call(this, a)
                    })
                }, this)) : "object" == typeof e ? e.url ? (e = a.extend(!0, {}, e), a.isFunction(e.url) && (e.url = e.url.call(this, b)), a.isFunction(e.data) && (e.data = e.data.call(this, b)), a.ajax(e).done(a.proxy(function (d, e, f) {
                    var g = f.getResponseHeader("Content-Type");
                    return -1 !== g.indexOf("json") || "object" == typeof d ? this._append_json_data(b, d, function (a) {
                        c.call(this, a)
                    }) : -1 !== g.indexOf("html") || "string" == typeof d ? this._append_html_data(b, a(d), function (a) {
                        c.call(this, a)
                    }) : (this._data.core.last_error = {
                        error: "ajax",
                        plugin: "core",
                        id: "core_04",
                        reason: "Could not load node",
                        data: JSON.stringify({id: b.id, xhr: f})
                    }, this.settings.core.error.call(this, this._data.core.last_error), c.call(this, !1))
                }, this)).fail(a.proxy(function (a) {
                    c.call(this, !1), this._data.core.last_error = {
                        error: "ajax",
                        plugin: "core",
                        id: "core_04",
                        reason: "Could not load node",
                        data: JSON.stringify({id: b.id, xhr: a})
                    }, this.settings.core.error.call(this, this._data.core.last_error)
                }, this))) : (d = a.isArray(e) || a.isPlainObject(e) ? JSON.parse(JSON.stringify(e)) : e, "#" === b.id ? this._append_json_data(b, d, function (a) {
                    c.call(this, a)
                }) : (this._data.core.last_error = {
                    error: "nodata",
                    plugin: "core",
                    id: "core_05",
                    reason: "Could not load node",
                    data: JSON.stringify({id: b.id})
                }, this.settings.core.error.call(this, this._data.core.last_error), c.call(this, !1))) : "string" == typeof e ? "#" === b.id ? this._append_html_data(b, a(e), function (a) {
                    c.call(this, a)
                }) : (this._data.core.last_error = {
                    error: "nodata",
                    plugin: "core",
                    id: "core_06",
                    reason: "Could not load node",
                    data: JSON.stringify({id: b.id})
                }, this.settings.core.error.call(this, this._data.core.last_error), c.call(this, !1)) : c.call(this, !1) : "#" === b.id ? this._append_html_data(b, this._data.core.original_container_html.clone(!0), function (a) {
                    c.call(this, a)
                }) : c.call(this, !1)
            }, _node_changed: function (a) {
                a = this.get_node(a), a && this._model.changed.push(a.id)
            }, _append_html_data: function (b, c, d) {
                b = this.get_node(b), b.children = [], b.children_d = [];
                var e, f, g, h = c.is("ul") ? c.children() : c, i = b.id, j = [], k = [], l = this._model.data, m = l[i], n = this._data.core.selected.length;
                for (h.each(a.proxy(function (b, c) {
                    e = this._parse_model_from_html(a(c), i, m.parents.concat()), e && (j.push(e), k.push(e), l[e].children_d.length && (k = k.concat(l[e].children_d)))
                }, this)), m.children = j, m.children_d = k, f = 0, g = m.parents.length; g > f; f++)l[m.parents[f]].children_d = l[m.parents[f]].children_d.concat(k);
                this.trigger("model", {
                    nodes: k,
                    parent: i
                }), "#" !== i ? (this._node_changed(i), this.redraw()) : (this.get_container_ul().children(".jstree-initial-node").remove(), this.redraw(!0)), this._data.core.selected.length !== n && this.trigger("changed", {
                    action: "model",
                    selected: this._data.core.selected
                }), d.call(this, !0)
            }, _append_json_data: function (b, c, d, e) {
                b = this.get_node(b), b.children = [], b.children_d = [], c.d && (c = c.d, "string" == typeof c && (c = JSON.parse(c))), a.isArray(c) || (c = [c]);
                var f = null, g = {
                    df: this._model.default_state,
                    dat: c,
                    par: b.id,
                    m: this._model.data,
                    t_id: this._id,
                    t_cnt: this._cnt,
                    sel: this._data.core.selected
                }, h = function (a, b) {
                    a.data && (a = a.data);
                    var c, d, e, f, g = a.dat, h = a.par, i = [], j = [], k = [], l = a.df, m = a.t_id, n = a.t_cnt, o = a.m, p = o[h], q = a.sel, r = function (a, c, d) {
                        d = d ? d.concat() : [], c && d.unshift(c);
                        var e, f, g, h, i = a.id.toString(), j = {
                            id: i,
                            text: a.text || "",
                            icon: a.icon !== b ? a.icon : !0,
                            parent: c,
                            parents: d,
                            children: a.children || [],
                            children_d: a.children_d || [],
                            data: a.data,
                            state: {},
                            li_attr: {id: !1},
                            a_attr: {href: "#"},
                            original: !1
                        };
                        for (e in l)l.hasOwnProperty(e) && (j.state[e] = l[e]);
                        if (a && a.data && a.data.jstree && a.data.jstree.icon && (j.icon = a.data.jstree.icon), a && a.data && (j.data = a.data, a.data.jstree))for (e in a.data.jstree)a.data.jstree.hasOwnProperty(e) && (j.state[e] = a.data.jstree[e]);
                        if (a && "object" == typeof a.state)for (e in a.state)a.state.hasOwnProperty(e) && (j.state[e] = a.state[e]);
                        if (a && "object" == typeof a.li_attr)for (e in a.li_attr)a.li_attr.hasOwnProperty(e) && (j.li_attr[e] = a.li_attr[e]);
                        if (j.li_attr.id || (j.li_attr.id = i), a && "object" == typeof a.a_attr)for (e in a.a_attr)a.a_attr.hasOwnProperty(e) && (j.a_attr[e] = a.a_attr[e]);
                        for (a && a.children && a.children === !0 && (j.state.loaded = !1, j.children = [], j.children_d = []), o[j.id] = j, e = 0, f = j.children.length; f > e; e++)g = r(o[j.children[e]], j.id, d), h = o[g], j.children_d.push(g), h.children_d.length && (j.children_d = j.children_d.concat(h.children_d));
                        return delete a.data, delete a.children, o[j.id].original = a, j.state.selected && k.push(j.id), j.id
                    }, s = function (a, c, d) {
                        d = d ? d.concat() : [], c && d.unshift(c);
                        var e, f, g, h, i, j = !1;
                        do j = "j" + m + "_" + ++n; while (o[j]);
                        i = {
                            id: !1,
                            text: "string" == typeof a ? a : "",
                            icon: "object" == typeof a && a.icon !== b ? a.icon : !0,
                            parent: c,
                            parents: d,
                            children: [],
                            children_d: [],
                            data: null,
                            state: {},
                            li_attr: {id: !1},
                            a_attr: {href: "#"},
                            original: !1
                        };
                        for (e in l)l.hasOwnProperty(e) && (i.state[e] = l[e]);
                        if (a && a.id && (i.id = a.id.toString()), a && a.text && (i.text = a.text), a && a.data && a.data.jstree && a.data.jstree.icon && (i.icon = a.data.jstree.icon), a && a.data && (i.data = a.data, a.data.jstree))for (e in a.data.jstree)a.data.jstree.hasOwnProperty(e) && (i.state[e] = a.data.jstree[e]);
                        if (a && "object" == typeof a.state)for (e in a.state)a.state.hasOwnProperty(e) && (i.state[e] = a.state[e]);
                        if (a && "object" == typeof a.li_attr)for (e in a.li_attr)a.li_attr.hasOwnProperty(e) && (i.li_attr[e] = a.li_attr[e]);
                        if (i.li_attr.id && !i.id && (i.id = i.li_attr.id.toString()), i.id || (i.id = j), i.li_attr.id || (i.li_attr.id = i.id), a && "object" == typeof a.a_attr)for (e in a.a_attr)a.a_attr.hasOwnProperty(e) && (i.a_attr[e] = a.a_attr[e]);
                        if (a && a.children && a.children.length) {
                            for (e = 0, f = a.children.length; f > e; e++)g = s(a.children[e], i.id, d), h = o[g], i.children.push(g), h.children_d.length && (i.children_d = i.children_d.concat(h.children_d));
                            i.children_d = i.children_d.concat(i.children)
                        }
                        return a && a.children && a.children === !0 && (i.state.loaded = !1, i.children = [], i.children_d = []), delete a.data, delete a.children, i.original = a, o[i.id] = i, i.state.selected && k.push(i.id), i.id
                    };
                    if (g.length && g[0].id !== b && g[0].parent !== b) {
                        for (d = 0, e = g.length; e > d; d++)g[d].children || (g[d].children = []), o[g[d].id.toString()] = g[d];
                        for (d = 0, e = g.length; e > d; d++)o[g[d].parent.toString()].children.push(g[d].id.toString()), p.children_d.push(g[d].id.toString());
                        for (d = 0, e = p.children.length; e > d; d++)c = r(o[p.children[d]], h, p.parents.concat()), j.push(c), o[c].children_d.length && (j = j.concat(o[c].children_d));
                        for (d = 0, e = p.parents.length; e > d; d++)o[p.parents[d]].children_d = o[p.parents[d]].children_d.concat(j);
                        f = {cnt: n, mod: o, sel: q, par: h, dpc: j, add: k}
                    } else {
                        for (d = 0, e = g.length; e > d; d++)c = s(g[d], h, p.parents.concat()), c && (i.push(c), j.push(c), o[c].children_d.length && (j = j.concat(o[c].children_d)));
                        for (p.children = i, p.children_d = j, d = 0, e = p.parents.length; e > d; d++)o[p.parents[d]].children_d = o[p.parents[d]].children_d.concat(j);
                        f = {cnt: n, mod: o, sel: q, par: h, dpc: j, add: k}
                    }
                    return f
                }, i = function (b, c) {
                    if (this._cnt = b.cnt, this._model.data = b.mod, c) {
                        var e, f, g = b.add, h = b.sel, i = this._data.core.selected.slice(), j = this._model.data;
                        if (h.length !== i.length || a.vakata.array_unique(h.concat(i)).length !== h.length) {
                            for (e = 0, f = h.length; f > e; e++)-1 === a.inArray(h[e], g) && -1 === a.inArray(h[e], i) && (j[h[e]].state.selected = !1);
                            for (e = 0, f = i.length; f > e; e++)-1 === a.inArray(i[e], h) && (j[i[e]].state.selected = !0)
                        }
                    }
                    b.add.length && (this._data.core.selected = this._data.core.selected.concat(b.add)), this.trigger("model", {
                        nodes: b.dpc,
                        parent: b.par
                    }), "#" !== b.par ? (this._node_changed(b.par), this.redraw()) : this.redraw(!0), b.add.length && this.trigger("changed", {
                        action: "model",
                        selected: this._data.core.selected
                    }), d.call(this, !0)
                };
                if (this.settings.core.worker && window.Blob && window.URL && window.Worker)try {
                    null === this._wrk && (this._wrk = window.URL.createObjectURL(new window.Blob(["self.onmessage = " + h.toString().replace(/return ([^;}]+)[\s;}]+$/, "postMessage($1);}")], {type: "text/javascript"}))), !this._data.core.working || e ? (this._data.core.working = !0, f = new window.Worker(this._wrk), f.onmessage = a.proxy(function (a) {
                        i.call(this, a.data, !0);
                        try {
                            f.terminate(), f = null
                        } catch (b) {
                        }
                        this._data.core.worker_queue.length ? this._append_json_data.apply(this, this._data.core.worker_queue.shift()) : this._data.core.working = !1
                    }, this), g.par ? f.postMessage(g) : this._data.core.worker_queue.length ? this._append_json_data.apply(this, this._data.core.worker_queue.shift()) : this._data.core.working = !1) : this._data.core.worker_queue.push([b, c, d, !0])
                } catch (j) {
                    i.call(this, h(g), !1), this._data.core.worker_queue.length ? this._append_json_data.apply(this, this._data.core.worker_queue.shift()) : this._data.core.working = !1
                } else i.call(this, h(g), !1)
            }, _parse_model_from_html: function (b, c, d) {
                d = d ? [].concat(d) : [], c && d.unshift(c);
                var e, f, g, h, i, j = this._model.data, k = {
                    id: !1,
                    text: !1,
                    icon: !0,
                    parent: c,
                    parents: d,
                    children: [],
                    children_d: [],
                    data: null,
                    state: {},
                    li_attr: {id: !1},
                    a_attr: {href: "#"},
                    original: !1
                };
                for (g in this._model.default_state)this._model.default_state.hasOwnProperty(g) && (k.state[g] = this._model.default_state[g]);
                if (h = a.vakata.attributes(b, !0), a.each(h, function (b, c) {
                        return c = a.trim(c), c.length ? (k.li_attr[b] = c, void("id" === b && (k.id = c.toString()))) : !0
                    }), h = b.children("a").first(), h.length && (h = a.vakata.attributes(h, !0), a.each(h, function (b, c) {
                        c = a.trim(c), c.length && (k.a_attr[b] = c)
                    })), h = b.children("a").first().length ? b.children("a").first().clone() : b.clone(), h.children("ins, i, ul").remove(), h = h.html(), h = a("<div />").html(h), k.text = this.settings.core.force_text ? h.text() : h.html(), h = b.data(), k.data = h ? a.extend(!0, {}, h) : null, k.state.opened = b.hasClass("jstree-open"), k.state.selected = b.children("a").hasClass("jstree-clicked"), k.state.disabled = b.children("a").hasClass("jstree-disabled"), k.data && k.data.jstree)for (g in k.data.jstree)k.data.jstree.hasOwnProperty(g) && (k.state[g] = k.data.jstree[g]);
                h = b.children("a").children(".jstree-themeicon"), h.length && (k.icon = h.hasClass("jstree-themeicon-hidden") ? !1 : h.attr("rel")), k.state.icon && (k.icon = k.state.icon), h = b.children("ul").children("li");
                do i = "j" + this._id + "_" + ++this._cnt; while (j[i]);
                return k.id = k.li_attr.id ? k.li_attr.id.toString() : i, h.length ? (h.each(a.proxy(function (b, c) {
                    e = this._parse_model_from_html(a(c), k.id, d), f = this._model.data[e], k.children.push(e), f.children_d.length && (k.children_d = k.children_d.concat(f.children_d))
                }, this)), k.children_d = k.children_d.concat(k.children)) : b.hasClass("jstree-closed") && (k.state.loaded = !1), k.li_attr["class"] && (k.li_attr["class"] = k.li_attr["class"].replace("jstree-closed", "").replace("jstree-open", "")), k.a_attr["class"] && (k.a_attr["class"] = k.a_attr["class"].replace("jstree-clicked", "").replace("jstree-disabled", "")), j[k.id] = k, k.state.selected && this._data.core.selected.push(k.id), k.id
            }, _parse_model_from_flat_json: function (a, c, d) {
                d = d ? d.concat() : [], c && d.unshift(c);
                var e, f, g, h, i = a.id.toString(), j = this._model.data, k = this._model.default_state, l = {
                    id: i,
                    text: a.text || "",
                    icon: a.icon !== b ? a.icon : !0,
                    parent: c,
                    parents: d,
                    children: a.children || [],
                    children_d: a.children_d || [],
                    data: a.data,
                    state: {},
                    li_attr: {id: !1},
                    a_attr: {href: "#"},
                    original: !1
                };
                for (e in k)k.hasOwnProperty(e) && (l.state[e] = k[e]);
                if (a && a.data && a.data.jstree && a.data.jstree.icon && (l.icon = a.data.jstree.icon), a && a.data && (l.data = a.data, a.data.jstree))for (e in a.data.jstree)a.data.jstree.hasOwnProperty(e) && (l.state[e] = a.data.jstree[e]);
                if (a && "object" == typeof a.state)for (e in a.state)a.state.hasOwnProperty(e) && (l.state[e] = a.state[e]);
                if (a && "object" == typeof a.li_attr)for (e in a.li_attr)a.li_attr.hasOwnProperty(e) && (l.li_attr[e] = a.li_attr[e]);
                if (l.li_attr.id || (l.li_attr.id = i), a && "object" == typeof a.a_attr)for (e in a.a_attr)a.a_attr.hasOwnProperty(e) && (l.a_attr[e] = a.a_attr[e]);
                for (a && a.children && a.children === !0 && (l.state.loaded = !1, l.children = [], l.children_d = []), j[l.id] = l, e = 0, f = l.children.length; f > e; e++)g = this._parse_model_from_flat_json(j[l.children[e]], l.id, d), h = j[g], l.children_d.push(g), h.children_d.length && (l.children_d = l.children_d.concat(h.children_d));
                return delete a.data, delete a.children, j[l.id].original = a, l.state.selected && this._data.core.selected.push(l.id), l.id
            }, _parse_model_from_json: function (a, c, d) {
                d = d ? d.concat() : [], c && d.unshift(c);
                var e, f, g, h, i, j = !1, k = this._model.data, l = this._model.default_state;
                do j = "j" + this._id + "_" + ++this._cnt; while (k[j]);
                i = {
                    id: !1,
                    text: "string" == typeof a ? a : "",
                    icon: "object" == typeof a && a.icon !== b ? a.icon : !0,
                    parent: c,
                    parents: d,
                    children: [],
                    children_d: [],
                    data: null,
                    state: {},
                    li_attr: {id: !1},
                    a_attr: {href: "#"},
                    original: !1
                };
                for (e in l)l.hasOwnProperty(e) && (i.state[e] = l[e]);
                if (a && a.id && (i.id = a.id.toString()), a && a.text && (i.text = a.text), a && a.data && a.data.jstree && a.data.jstree.icon && (i.icon = a.data.jstree.icon), a && a.data && (i.data = a.data, a.data.jstree))for (e in a.data.jstree)a.data.jstree.hasOwnProperty(e) && (i.state[e] = a.data.jstree[e]);
                if (a && "object" == typeof a.state)for (e in a.state)a.state.hasOwnProperty(e) && (i.state[e] = a.state[e]);
                if (a && "object" == typeof a.li_attr)for (e in a.li_attr)a.li_attr.hasOwnProperty(e) && (i.li_attr[e] = a.li_attr[e]);
                if (i.li_attr.id && !i.id && (i.id = i.li_attr.id.toString()), i.id || (i.id = j), i.li_attr.id || (i.li_attr.id = i.id), a && "object" == typeof a.a_attr)for (e in a.a_attr)a.a_attr.hasOwnProperty(e) && (i.a_attr[e] = a.a_attr[e]);
                if (a && a.children && a.children.length) {
                    for (e = 0, f = a.children.length; f > e; e++)g = this._parse_model_from_json(a.children[e], i.id, d), h = k[g], i.children.push(g), h.children_d.length && (i.children_d = i.children_d.concat(h.children_d));
                    i.children_d = i.children_d.concat(i.children)
                }
                return a && a.children && a.children === !0 && (i.state.loaded = !1, i.children = [], i.children_d = []), delete a.data, delete a.children, i.original = a, k[i.id] = i, i.state.selected && this._data.core.selected.push(i.id), i.id
            }, _redraw: function () {
                var a, b, c, d = this._model.force_full_redraw ? this._model.data["#"].children.concat([]) : this._model.changed.concat([]), e = document.createElement("UL"), f = this._data.core.focused;
                for (b = 0, c = d.length; c > b; b++)a = this.redraw_node(d[b], !0, this._model.force_full_redraw), a && this._model.force_full_redraw && e.appendChild(a);
                this._model.force_full_redraw && (e.className = this.get_container_ul()[0].className, this.element.empty().append(e)), null !== f && (a = this.get_node(f, !0), a && a.length && a.children(".jstree-anchor")[0] !== document.activeElement ? a.children(".jstree-anchor").focus() : this._data.core.focused = null), this._model.force_full_redraw = !1, this._model.changed = [], this.trigger("redraw", {nodes: d})
            }, redraw: function (a) {
                window.console.log("*"), a && (this._model.force_full_redraw = !0), this._redraw()
            }, redraw_node: function (b, c, d, e) {
                var f = this.get_node(b), g = !1, h = !1, i = !1, j = !1, k = !1, m = !1, n = "", o = document, p = this._model.data, q = !1, r = !1, s = null;
                if (!f)return !1;
                if ("#" === f.id)return this.redraw(!0);
                if (c = c || 0 === f.children.length, b = document.querySelector ? this.element[0].querySelector("#" + (-1 !== "0123456789".indexOf(f.id[0]) ? "\\3" + f.id[0] + " " + f.id.substr(1).replace(a.jstree.idregex, "\\$&") : f.id.replace(a.jstree.idregex, "\\$&"))) : document.getElementById(f.id))b = a(b), d || (g = b.parent().parent()[0], g === this.element[0] && (g = null), h = b.index()), c || !f.children.length || b.children(".jstree-children").length || (c = !0), c || (i = b.children(".jstree-children")[0]), r = b.attr("aria-selected"), q = b.children(".jstree-anchor")[0] === document.activeElement, b.remove(); else if (c = !0, !d) {
                    if (g = "#" !== f.parent ? a("#" + f.parent.replace(a.jstree.idregex, "\\$&"), this.element)[0] : null, !(null === g || g && p[f.parent].state.opened))return !1;
                    h = a.inArray(f.id, null === g ? p["#"].children : p[f.parent].children)
                }
                b = l.cloneNode(!0), n = "jstree-node ";
                for (j in f.li_attr)if (f.li_attr.hasOwnProperty(j)) {
                    if ("id" === j)continue;
                    "class" !== j ? b.setAttribute(j, f.li_attr[j]) : n += f.li_attr[j]
                }
                r && "false" !== r && b.setAttribute("aria-selected", !0), f.state.loaded && !f.children.length ? n += " jstree-leaf" : (n += f.state.opened && f.state.loaded ? " jstree-open" : " jstree-closed", b.setAttribute("aria-expanded", f.state.opened && f.state.loaded)), null !== f.parent && p[f.parent].children[p[f.parent].children.length - 1] === f.id && (n += " jstree-last"), b.id = f.id, b.className = n, n = (f.state.selected ? " jstree-clicked" : "") + (f.state.disabled ? " jstree-disabled" : "");
                for (k in f.a_attr)if (f.a_attr.hasOwnProperty(k)) {
                    if ("href" === k && "#" === f.a_attr[k])continue;
                    "class" !== k ? b.childNodes[1].setAttribute(k, f.a_attr[k]) : n += " " + f.a_attr[k]
                }
                if (n.length && (b.childNodes[1].className = "jstree-anchor " + n), (f.icon && f.icon !== !0 || f.icon === !1) && (f.icon === !1 ? b.childNodes[1].childNodes[0].className += " jstree-themeicon-hidden" : -1 === f.icon.indexOf("/") && -1 === f.icon.indexOf(".") ? b.childNodes[1].childNodes[0].className += " " + f.icon + " jstree-themeicon-custom" : (b.childNodes[1].childNodes[0].style.backgroundImage = "url(" + f.icon + ")", b.childNodes[1].childNodes[0].style.backgroundPosition = "center center", b.childNodes[1].childNodes[0].style.backgroundSize = "auto", b.childNodes[1].childNodes[0].className += " jstree-themeicon-custom")), this.settings.core.force_text ? b.childNodes[1].appendChild(o.createTextNode(f.text)) : b.childNodes[1].innerHTML += f.text, c && f.children.length && (f.state.opened || e) && f.state.loaded) {
                    for (m = o.createElement("UL"), m.setAttribute("role", "group"), m.className = "jstree-children", j = 0, k = f.children.length; k > j; j++)m.appendChild(this.redraw_node(f.children[j], c, !0));
                    b.appendChild(m)
                }
                if (i && b.appendChild(i), !d) {
                    for (g || (g = this.element[0]), j = 0, k = g.childNodes.length; k > j; j++)if (g.childNodes[j] && g.childNodes[j].className && -1 !== g.childNodes[j].className.indexOf("jstree-children")) {
                        s = g.childNodes[j];
                        break
                    }
                    s || (s = o.createElement("UL"), s.setAttribute("role", "group"), s.className = "jstree-children", g.appendChild(s)), g = s, h < g.childNodes.length ? g.insertBefore(b, g.childNodes[h]) : g.appendChild(b), q && b.childNodes[1].focus()
                }
                return f.state.opened && !f.state.loaded && (f.state.opened = !1, setTimeout(a.proxy(function () {
                    this.openNode(f.id, !1, 0)
                }, this), 0)), b
            }, openNode: function (c, d, e) {
                var f, g, h, i;
                if (a.isArray(c)) {
                    for (c = c.slice(), f = 0, g = c.length; g > f; f++)this.openNode(c[f], d, e);
                    return !0
                }
                if (c = this.get_node(c), !c || "#" === c.id)return !1;
                if (e = e === b ? this.settings.core.animation : e, !this.is_closed(c))return d && d.call(this, c, !1), !1;
                if (this.is_loaded(c))h = this.get_node(c, !0), i = this, h.length && (c.children.length && !this._firstChild(h.children(".jstree-children")[0]) && (this.redraw_node(c, !0, !1, !0), h = this.get_node(c, !0)), e ? (this.trigger("before_open", {node: c}), h.children(".jstree-children").css("display", "none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded", !0).children(".jstree-children").stop(!0, !0).slideDown(e, function () {
                    this.style.display = "", i.trigger("after_open", {node: c})
                })) : (this.trigger("before_open", {node: c}), h[0].className = h[0].className.replace("jstree-closed", "jstree-open"), h[0].setAttribute("aria-expanded", !0))), c.state.opened = !0, d && d.call(this, c, !0), h.length || this.trigger("before_open", {node: c}), this.trigger("openNode", {node: c}), e && h.length || this.trigger("after_open", {node: c}); else {
                    if (this.is_loading(c))return setTimeout(a.proxy(function () {
                        this.openNode(c, d, e)
                    }, this), 500);
                    this.load_node(c, function (a, b) {
                        return b ? this.openNode(a, d, e) : d ? d.call(this, a, !1) : !1
                    })
                }
            }, _open_to: function (b) {
                if (b = this.get_node(b), !b || "#" === b.id)return !1;
                var c, d, e = b.parents;
                for (c = 0, d = e.length; d > c; c += 1)"#" !== c && this.openNode(e[c], !1, 0);
                return a("#" + b.id.replace(a.jstree.idregex, "\\$&"), this.element)
            }, closeNode: function (c, d) {
                var e, f, g, h;
                if (a.isArray(c)) {
                    for (c = c.slice(), e = 0, f = c.length; f > e; e++)this.closeNode(c[e], d);
                    return !0
                }
                return c = this.get_node(c), c && "#" !== c.id ? this.is_closed(c) ? !1 : (d = d === b ? this.settings.core.animation : d, g = this, h = this.get_node(c, !0), h.length && (d ? h.children(".jstree-children").attr("style", "display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded", !1).children(".jstree-children").stop(!0, !0).slideUp(d, function () {
                    this.style.display = "", h.children(".jstree-children").remove(), g.trigger("after_close", {node: c})
                }) : (h[0].className = h[0].className.replace("jstree-open", "jstree-closed"), h.attr("aria-expanded", !1).children(".jstree-children").remove())), c.state.opened = !1, this.trigger("closeNode", {node: c}), void(d && h.length || this.trigger("after_close", {node: c}))) : !1
            }, toggle_node: function (b) {
                var c, d;
                if (a.isArray(b)) {
                    for (b = b.slice(), c = 0, d = b.length; d > c; c++)this.toggle_node(b[c]);
                    return !0
                }
                return this.is_closed(b) ? this.openNode(b) : this.is_open(b) ? this.closeNode(b) : void 0
            }, open_all: function (a, b, c) {
                if (a || (a = "#"), a = this.get_node(a), !a)return !1;
                var d, e, f, g = "#" === a.id ? this.get_container_ul() : this.get_node(a, !0);
                if (!g.length) {
                    for (d = 0, e = a.children_d.length; e > d; d++)this.is_closed(this._model.data[a.children_d[d]]) && (this._model.data[a.children_d[d]].state.opened = !0);
                    return this.trigger("open_all", {node: a})
                }
                c = c || g, f = this, g = this.is_closed(a) ? g.find(".jstree-closed").addBack() : g.find(".jstree-closed"), g.each(function () {
                    f.openNode(this, function (a, d) {
                        d && this.is_parent(a) && this.open_all(a, b, c)
                    }, b || 0)
                }), 0 === c.find(".jstree-closed").length && this.trigger("open_all", {node: this.get_node(c)})
            }, close_all: function (b, c) {
                if (b || (b = "#"), b = this.get_node(b), !b)return !1;
                var d, e, f = "#" === b.id ? this.get_container_ul() : this.get_node(b, !0), g = this;
                if (!f.length) {
                    for (d = 0, e = b.children_d.length; e > d; d++)this._model.data[b.children_d[d]].state.opened = !1;
                    return this.trigger("close_all", {node: b})
                }
                f = this.is_open(b) ? f.find(".jstree-open").addBack() : f.find(".jstree-open"), a(f.get().reverse()).each(function () {
                    g.closeNode(this, c || 0)
                }), this.trigger("close_all", {node: b})
            }, is_disabled: function (a) {
                return a = this.get_node(a), a && a.state && a.state.disabled
            }, enable_node: function (b) {
                var c, d;
                if (a.isArray(b)) {
                    for (b = b.slice(), c = 0, d = b.length; d > c; c++)this.enable_node(b[c]);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (b.state.disabled = !1, this.get_node(b, !0).children(".jstree-anchor").removeClass("jstree-disabled"), void this.trigger("enable_node", {node: b})) : !1
            }, disable_node: function (b) {
                var c, d;
                if (a.isArray(b)) {
                    for (b = b.slice(), c = 0, d = b.length; d > c; c++)this.disable_node(b[c]);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (b.state.disabled = !0, this.get_node(b, !0).children(".jstree-anchor").addClass("jstree-disabled"), void this.trigger("disable_node", {node: b})) : !1
            }, activate_node: function (a, c) {
                if (this.is_disabled(a))return !1;
                if (this._data.core.last_clicked = this._data.core.last_clicked && this._data.core.last_clicked.id !== b ? this.get_node(this._data.core.last_clicked.id) : null, this._data.core.last_clicked && !this._data.core.last_clicked.state.selected && (this._data.core.last_clicked = null), !this._data.core.last_clicked && this._data.core.selected.length && (this._data.core.last_clicked = this.get_node(this._data.core.selected[this._data.core.selected.length - 1])), this.settings.core.multiple && (c.metaKey || c.ctrlKey || c.shiftKey) && (!c.shiftKey || this._data.core.last_clicked && this.get_parent(a) && this.get_parent(a) === this._data.core.last_clicked.parent))if (c.shiftKey) {
                    var d, e, f = this.get_node(a).id, g = this._data.core.last_clicked.id, h = this.get_node(this._data.core.last_clicked.parent).children, i = !1;
                    for (d = 0, e = h.length; e > d; d += 1)h[d] === f && (i = !i), h[d] === g && (i = !i), i || h[d] === f || h[d] === g ? this.select_node(h[d], !0, !1, c) : this.deselect_node(h[d], !0, c);
                    this.trigger("changed", {
                        action: "select_node",
                        node: this.get_node(a),
                        selected: this._data.core.selected,
                        event: c
                    })
                } else this.is_selected(a) ? this.deselect_node(a, !1, c) : this.select_node(a, !1, !1, c); else!this.settings.core.multiple && (c.metaKey || c.ctrlKey || c.shiftKey) && this.is_selected(a) ? this.deselect_node(a, !1, c) : (this.deselect_all(!0), this.select_node(a, !1, !1, c), this._data.core.last_clicked = this.get_node(a));
                this.trigger("activate_node", {node: this.get_node(a)})
            }, hover_node: function (a) {
                if (a = this.get_node(a, !0), !a || !a.length || a.children(".jstree-hovered").length)return !1;
                var b = this.element.find(".jstree-hovered"), c = this.element;
                b && b.length && this.dehover_node(b), a.children(".jstree-anchor").addClass("jstree-hovered"), this.trigger("hover_node", {node: this.get_node(a)}), setTimeout(function () {
                    c.attr("aria-activedescendant", a[0].id), a.attr("aria-selected", !0)
                }, 0)
            }, dehover_node: function (a) {
                return a = this.get_node(a, !0), a && a.length && a.children(".jstree-hovered").length ? (a.attr("aria-selected", !1).children(".jstree-anchor").removeClass("jstree-hovered"), void this.trigger("dehover_node", {node: this.get_node(a)})) : !1
            }, select_node: function (b, c, d, e) {
                var f, g, h;
                if (a.isArray(b)) {
                    for (b = b.slice(), g = 0, h = b.length; h > g; g++)this.select_node(b[g], c, d, e);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (f = this.get_node(b, !0), void(b.state.selected || (b.state.selected = !0, this._data.core.selected.push(b.id), d || (f = this._open_to(b)), f && f.length && f.children(".jstree-anchor").addClass("jstree-clicked"), this.trigger("select_node", {
                    node: b,
                    selected: this._data.core.selected,
                    event: e
                }), c || this.trigger("changed", {
                    action: "select_node",
                    node: b,
                    selected: this._data.core.selected,
                    event: e
                })))) : !1
            }, deselect_node: function (b, c, d) {
                var e, f, g;
                if (a.isArray(b)) {
                    for (b = b.slice(), e = 0, f = b.length; f > e; e++)this.deselect_node(b[e], c, d);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (g = this.get_node(b, !0), void(b.state.selected && (b.state.selected = !1, this._data.core.selected = a.vakata.array_remove_item(this._data.core.selected, b.id), g.length && g.children(".jstree-anchor").removeClass("jstree-clicked"), this.trigger("deselect_node", {
                    node: b,
                    selected: this._data.core.selected,
                    event: d
                }), c || this.trigger("changed", {
                    action: "deselect_node",
                    node: b,
                    selected: this._data.core.selected,
                    event: d
                })))) : !1
            }, select_all: function (a) {
                var b, c, d = this._data.core.selected.concat([]);
                for (this._data.core.selected = this._model.data["#"].children_d.concat(), b = 0, c = this._data.core.selected.length; c > b; b++)this._model.data[this._data.core.selected[b]] && (this._model.data[this._data.core.selected[b]].state.selected = !0);
                this.redraw(!0), this.trigger("select_all", {selected: this._data.core.selected}), a || this.trigger("changed", {
                    action: "select_all",
                    selected: this._data.core.selected,
                    old_selection: d
                })
            }, deselect_all: function (a) {
                var b, c, d = this._data.core.selected.concat([]);
                for (b = 0, c = this._data.core.selected.length; c > b; b++)this._model.data[this._data.core.selected[b]] && (this._model.data[this._data.core.selected[b]].state.selected = !1);
                this._data.core.selected = [], this.element.find(".jstree-clicked").removeClass("jstree-clicked"), this.trigger("deselect_all", {
                    selected: this._data.core.selected,
                    node: d
                }), a || this.trigger("changed", {
                    action: "deselect_all",
                    selected: this._data.core.selected,
                    old_selection: d
                })
            }, is_selected: function (a) {
                return a = this.get_node(a), a && "#" !== a.id ? a.state.selected : !1
            }, get_selected: function (b) {
                return b ? a.map(this._data.core.selected, a.proxy(function (a) {
                    return this.get_node(a)
                }, this)) : this._data.core.selected.slice()
            }, get_top_selected: function (b) {
                var c, d, e, f, g = this.get_selected(!0), h = {};
                for (c = 0, d = g.length; d > c; c++)h[g[c].id] = g[c];
                for (c = 0, d = g.length; d > c; c++)for (e = 0, f = g[c].children_d.length; f > e; e++)h[g[c].children_d[e]] && delete h[g[c].children_d[e]];
                g = [];
                for (c in h)h.hasOwnProperty(c) && g.push(c);
                return b ? a.map(g, a.proxy(function (a) {
                    return this.get_node(a)
                }, this)) : g
            }, get_bottom_selected: function (b) {
                var c, d, e = this.get_selected(!0), f = [];
                for (c = 0, d = e.length; d > c; c++)e[c].children.length || f.push(e[c].id);
                return b ? a.map(f, a.proxy(function (a) {
                    return this.get_node(a)
                }, this)) : f
            }, get_state: function () {
                var a, b = {
                    core: {
                        open: [],
                        scroll: {left: this.element.scrollLeft(), top: this.element.scrollTop()},
                        selected: []
                    }
                };
                for (a in this._model.data)this._model.data.hasOwnProperty(a) && "#" !== a && (this._model.data[a].state.opened && b.core.open.push(a), this._model.data[a].state.selected && b.core.selected.push(a));
                return b
            }, set_state: function (c, d) {
                if (c) {
                    if (c.core) {
                        var e, f, g, h;
                        if (c.core.open)return a.isArray(c.core.open) ? (e = !0, f = !1, g = this, a.each(c.core.open.concat([]), function (b, h) {
                            f = g.get_node(h), f && (g.is_loaded(h) ? (g.is_closed(h) && g.openNode(h, !1, 0), c && c.core && c.core.open && a.vakata.array_remove_item(c.core.open, h)) : (g.is_loading(h) || g.openNode(h, a.proxy(function (b, e) {
                                !e && c && c.core && c.core.open && a.vakata.array_remove_item(c.core.open, b.id), this.set_state(c, d)
                            }, g), 0), e = !1))
                        }), e && (delete c.core.open, this.set_state(c, d)), !1) : (delete c.core.open, this.set_state(c, d), !1);
                        if (c.core.scroll)return c.core.scroll && c.core.scroll.left !== b && this.element.scrollLeft(c.core.scroll.left), c.core.scroll && c.core.scroll.top !== b && this.element.scrollTop(c.core.scroll.top), delete c.core.scroll, this.set_state(c, d), !1;
                        if (c.core.selected)return h = this, this.deselect_all(), a.each(c.core.selected, function (a, b) {
                            h.select_node(b)
                        }), delete c.core.selected, this.set_state(c, d), !1;
                        if (a.isEmptyObject(c.core))return delete c.core, this.set_state(c, d), !1
                    }
                    return a.isEmptyObject(c) ? (c = null, d && d.call(this), this.trigger("set_state"), !1) : !0
                }
                return !1
            }, refresh: function (b, c) {
                this._data.core.state = c === !0 ? {} : this.get_state(), c && a.isFunction(c) && (this._data.core.state = c.call(this, this._data.core.state)), this._cnt = 0, this._model.data = {
                    "#": {
                        id: "#",
                        parent: null,
                        parents: [],
                        children: [],
                        children_d: [],
                        state: {loaded: !1}
                    }
                };
                var d = this.get_container_ul()[0].className;
                b || this.element.html("<ul class='" + d + "'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>" + this.get_string("Loading ...") + "</a></li></ul>"), this.load_node("#", function (b, c) {
                    c && (this.get_container_ul()[0].className = d, this.set_state(a.extend(!0, {}, this._data.core.state), function () {
                        this.trigger("refresh")
                    })), this._data.core.state = null
                })
            }, refresh_node: function (b) {
                if (b = this.get_node(b), !b || "#" === b.id)return !1;
                var c = [], d = [];
                this._data.core.selected.concat([]);
                d.push(b.id), b.state.opened === !0 && c.push(b.id), this.get_node(b, !0).find(".jstree-open").each(function () {
                    c.push(this.id)
                }), this._load_nodes(d, a.proxy(function (a) {
                    this.openNode(c, !1, 0), this.select_node(this._data.core.selected), this.trigger("refresh_node", {
                        node: b,
                        nodes: a
                    })
                }, this))
            }, set_id: function (b, c) {
                if (b = this.get_node(b), !b || "#" === b.id)return !1;
                var d, e, f = this._model.data;
                for (c = c.toString(), f[b.parent].children[a.inArray(b.id, f[b.parent].children)] = c, d = 0, e = b.parents.length; e > d; d++)f[b.parents[d]].children_d[a.inArray(b.id, f[b.parents[d]].children_d)] = c;
                for (d = 0, e = b.children.length; e > d; d++)f[b.children[d]].parent = c;
                for (d = 0, e = b.children_d.length; e > d; d++)f[b.children_d[d]].parents[a.inArray(b.id, f[b.children_d[d]].parents)] = c;
                return d = a.inArray(b.id, this._data.core.selected), -1 !== d && (this._data.core.selected[d] = c), d = this.get_node(b.id, !0), d && d.attr("id", c), delete f[b.id], b.id = c, f[c] = b, !0
            }, get_text: function (a) {
                return a = this.get_node(a), a && "#" !== a.id ? a.text : !1
            }, set_text: function (b, c) {
                var d, e;
                if (a.isArray(b)) {
                    for (b = b.slice(), d = 0, e = b.length; e > d; d++)this.set_text(b[d], c);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (b.text = c, this.get_node(b, !0).length && this.redraw_node(b.id), this.trigger("set_text", {
                    obj: b,
                    text: c
                }), !0) : !1
            }, get_json: function (b, c, d) {
                if (b = this.get_node(b || "#"), !b)return !1;
                c && c.flat && !d && (d = []);
                var e, f, g = {
                    id: b.id,
                    text: b.text,
                    icon: this.get_icon(b),
                    li_attr: a.extend(!0, {}, b.li_attr),
                    a_attr: a.extend(!0, {}, b.a_attr),
                    state: {},
                    data: c && c.no_data ? !1 : a.extend(!0, {}, b.data)
                };
                if (c && c.flat ? g.parent = b.parent : g.children = [], !c || !c.no_state)for (e in b.state)b.state.hasOwnProperty(e) && (g.state[e] = b.state[e]);
                if (c && c.no_id && (delete g.id, g.li_attr && g.li_attr.id && delete g.li_attr.id), c && c.flat && "#" !== b.id && d.push(g), !c || !c.no_children)for (e = 0, f = b.children.length; f > e; e++)c && c.flat ? this.get_json(b.children[e], c, d) : g.children.push(this.get_json(b.children[e], c));
                return c && c.flat ? d : "#" === b.id ? g.children : g
            }, create_node: function (c, d, e, f, g) {
                if (null === c && (c = "#"), c = this.get_node(c), !c)return !1;
                if (e = e === b ? "last" : e, !e.toString().match(/^(before|after)$/) && !g && !this.is_loaded(c))return this.load_node(c, function () {
                    this.create_node(c, d, e, f, !0)
                });
                d || (d = {text: this.get_string("New node")}), d.text === b && (d.text = this.get_string("New node"));
                var h, i, j, k;
                switch ("#" === c.id && ("before" === e && (e = "first"), "after" === e && (e = "last")), e) {
                    case"before":
                        h = this.get_node(c.parent), e = a.inArray(c.id, h.children), c = h;
                        break;
                    case"after":
                        h = this.get_node(c.parent), e = a.inArray(c.id, h.children) + 1, c = h;
                        break;
                    case"inside":
                    case"first":
                        e = 0;
                        break;
                    case"last":
                        e = c.children.length;
                        break;
                    default:
                        e || (e = 0)
                }
                if (e > c.children.length && (e = c.children.length), d.id || (d.id = !0), !this.check("create_node", d, c, e))return this.settings.core.error.call(this, this._data.core.last_error), !1;
                if (d.id === !0 && delete d.id, d = this._parse_model_from_json(d, c.id, c.parents.concat()), !d)return !1;
                for (h = this.get_node(d), i = [], i.push(d), i = i.concat(h.children_d), this.trigger("model", {
                    nodes: i,
                    parent: c.id
                }), c.children_d = c.children_d.concat(i), j = 0, k = c.parents.length; k > j; j++)this._model.data[c.parents[j]].children_d = this._model.data[c.parents[j]].children_d.concat(i);
                for (d = h, h = [], j = 0, k = c.children.length; k > j; j++)h[j >= e ? j + 1 : j] = c.children[j];
                return h[e] = d.id, c.children = h, this.redraw_node(c, !0), f && f.call(this, this.get_node(d)), this.trigger("create_node", {
                    node: this.get_node(d),
                    parent: c.id,
                    position: e
                }), d.id
            }, rename_node: function (b, c) {
                var d, e, f;
                if (a.isArray(b)) {
                    for (b = b.slice(), d = 0, e = b.length; e > d; d++)this.rename_node(b[d], c);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (f = b.text, this.check("rename_node", b, this.get_parent(b), c) ? (this.set_text(b, c), this.trigger("rename_node", {
                    node: b,
                    text: c,
                    old: f
                }), !0) : (this.settings.core.error.call(this, this._data.core.last_error), !1)) : !1
            }, delete_node: function (b) {
                var c, d, e, f, g, h, i, j, k, l;
                if (a.isArray(b)) {
                    for (b = b.slice(), c = 0, d = b.length; d > c; c++)this.delete_node(b[c]);
                    return !0
                }
                if (b = this.get_node(b), !b || "#" === b.id)return !1;
                if (e = this.get_node(b.parent), f = a.inArray(b.id, e.children), l = !1, !this.check("delete_node", b, e, f))return this.settings.core.error.call(this, this._data.core.last_error), !1;
                for (-1 !== f && (e.children = a.vakata.array_remove(e.children, f)), g = b.children_d.concat([]), g.push(b.id), j = 0, k = g.length; k > j; j++) {
                    for (h = 0, i = b.parents.length; i > h; h++)f = a.inArray(g[j], this._model.data[b.parents[h]].children_d), -1 !== f && (this._model.data[b.parents[h]].children_d = a.vakata.array_remove(this._model.data[b.parents[h]].children_d, f));
                    this._model.data[g[j]].state.selected && (l = !0, f = a.inArray(g[j], this._data.core.selected), -1 !== f && (this._data.core.selected = a.vakata.array_remove(this._data.core.selected, f)))
                }
                for (this.trigger("delete_node", {
                    node: b,
                    parent: e.id
                }), l && this.trigger("changed", {
                    action: "delete_node",
                    node: b,
                    selected: this._data.core.selected,
                    parent: e.id
                }), j = 0, k = g.length; k > j; j++)delete this._model.data[g[j]];
                return this.redraw_node(e, !0), !0
            }, check: function (b, c, d, e, f) {
                c = c && c.id ? c : this.get_node(c), d = d && d.id ? d : this.get_node(d);
                var g = b.match(/^move_node|copy_node|create_node$/i) ? d : c, h = this.settings.core.check_callback;
                return "move_node" !== b && "copy_node" !== b || f && f.is_multi || c.id !== d.id && a.inArray(c.id, d.children) !== e && -1 === a.inArray(d.id, c.children_d) ? (g && g.data && (g = g.data), g && g.functions && (g.functions[b] === !1 || g.functions[b] === !0) ? (g.functions[b] === !1 && (this._data.core.last_error = {
                    error: "check",
                    plugin: "core",
                    id: "core_02",
                    reason: "Node data prevents function: " + b,
                    data: JSON.stringify({chk: b, pos: e, obj: c && c.id ? c.id : !1, par: d && d.id ? d.id : !1})
                }), g.functions[b]) : h === !1 || a.isFunction(h) && h.call(this, b, c, d, e, f) === !1 || h && h[b] === !1 ? (this._data.core.last_error = {
                    error: "check",
                    plugin: "core",
                    id: "core_03",
                    reason: "User config for core.check_callback prevents function: " + b,
                    data: JSON.stringify({chk: b, pos: e, obj: c && c.id ? c.id : !1, par: d && d.id ? d.id : !1})
                }, !1) : !0) : (this._data.core.last_error = {
                    error: "check",
                    plugin: "core",
                    id: "core_01",
                    reason: "Moving parent inside child",
                    data: JSON.stringify({chk: b, pos: e, obj: c && c.id ? c.id : !1, par: d && d.id ? d.id : !1})
                }, !1)
            }, last_error: function () {
                return this._data.core.last_error
            }, move_node: function (c, d, e, f, g, h) {
                var i, j, k, l, m, n, o, p, q, r, s, t, u, v;
                if (d = this.get_node(d), e = e === b ? 0 : e, !d)return !1;
                if (!e.toString().match(/^(before|after)$/) && !g && !this.is_loaded(d))return this.load_node(d, function () {
                    this.move_node(c, d, e, f, !0)
                });
                if (a.isArray(c)) {
                    for (c = c.slice(), i = 0, j = c.length; j > i; i++)this.move_node(c[i], d, e, f, g, !0) && (d = c[i], e = "after");
                    return this.redraw(), !0
                }
                if (c = c && c.id ? c : this.get_node(c), !c || "#" === c.id)return !1;
                if (k = (c.parent || "#").toString(), m = e.toString().match(/^(before|after)$/) && "#" !== d.id ? this.get_node(d.parent) : d, n = c.instance ? c.instance : this._model.data[c.id] ? this : a.jstree.reference(c.id), o = !n || !n._id || this._id !== n._id, l = n && n._id && k && n._model.data[k] && n._model.data[k].children ? a.inArray(c.id, n._model.data[k].children) : -1, o)return this.copy_node(c, d, e, f, g) ? (n && n.delete_node(c), !0) : !1;
                switch ("#" === d.id && ("before" === e && (e = "first"), "after" === e && (e = "last")), e) {
                    case"before":
                        e = a.inArray(d.id, m.children);
                        break;
                    case"after":
                        e = a.inArray(d.id, m.children) + 1;
                        break;
                    case"inside":
                    case"first":
                        e = 0;
                        break;
                    case"last":
                        e = m.children.length;
                        break;
                    default:
                        e || (e = 0)
                }
                if (e > m.children.length && (e = m.children.length), !this.check("move_node", c, m, e, {
                        core: !0,
                        is_multi: n && n._id && n._id !== this._id,
                        is_foreign: !n || !n._id
                    }))return this.settings.core.error.call(this, this._data.core.last_error), !1;
                if (c.parent === m.id) {
                    for (p = m.children.concat(), q = a.inArray(c.id, p), -1 !== q && (p = a.vakata.array_remove(p, q), e > q && e--), q = [], r = 0, s = p.length; s > r; r++)q[r >= e ? r + 1 : r] = p[r];
                    q[e] = c.id, m.children = q, this._node_changed(m.id), this.redraw("#" === m.id)
                } else {
                    for (q = c.children_d.concat(), q.push(c.id), r = 0, s = c.parents.length; s > r; r++) {
                        for (p = [], v = n._model.data[c.parents[r]].children_d, t = 0, u = v.length; u > t; t++)-1 === a.inArray(v[t], q) && p.push(v[t]);
                        n._model.data[c.parents[r]].children_d = p
                    }
                    for (n._model.data[k].children = a.vakata.array_remove_item(n._model.data[k].children, c.id), r = 0, s = m.parents.length; s > r; r++)this._model.data[m.parents[r]].children_d = this._model.data[m.parents[r]].children_d.concat(q);
                    for (p = [], r = 0, s = m.children.length; s > r; r++)p[r >= e ? r + 1 : r] = m.children[r];
                    for (p[e] = c.id, m.children = p, m.children_d.push(c.id), m.children_d = m.children_d.concat(c.children_d), c.parent = m.id, q = m.parents.concat(), q.unshift(m.id), v = c.parents.length, c.parents = q, q = q.concat(), r = 0, s = c.children_d.length; s > r; r++)this._model.data[c.children_d[r]].parents = this._model.data[c.children_d[r]].parents.slice(0, -1 * v), Array.prototype.push.apply(this._model.data[c.children_d[r]].parents, q);
                    ("#" === k || "#" === m.id) && (this._model.force_full_redraw = !0), this._model.force_full_redraw || (this._node_changed(k), this._node_changed(m.id)), h || this.redraw()
                }
                return f && f.call(this, c, m, e), this.trigger("move_node", {
                    node: c,
                    parent: m.id,
                    position: e,
                    old_parent: k,
                    old_position: l,
                    is_multi: n && n._id && n._id !== this._id,
                    is_foreign: !n || !n._id,
                    old_instance: n,
                    new_instance: this
                }), !0
            }, copy_node: function (c, d, e, f, g, h) {
                var i, j, k, l, m, n, o, p, q, r, s;
                if (d = this.get_node(d), e = e === b ? 0 : e, !d)return !1;
                if (!e.toString().match(/^(before|after)$/) && !g && !this.is_loaded(d))return this.load_node(d, function () {
                    this.copy_node(c, d, e, f, !0)
                });
                if (a.isArray(c)) {
                    for (c = c.slice(), i = 0, j = c.length; j > i; i++)l = this.copy_node(c[i], d, e, f, g, !0), l && (d = l, e = "after");
                    return this.redraw(), !0
                }
                if (c = c && c.id ? c : this.get_node(c), !c || "#" === c.id)return !1;
                switch (p = (c.parent || "#").toString(), q = e.toString().match(/^(before|after)$/) && "#" !== d.id ? this.get_node(d.parent) : d, r = c.instance ? c.instance : this._model.data[c.id] ? this : a.jstree.reference(c.id), s = !r || !r._id || this._id !== r._id, "#" === d.id && ("before" === e && (e = "first"), "after" === e && (e = "last")), e) {
                    case"before":
                        e = a.inArray(d.id, q.children);
                        break;
                    case"after":
                        e = a.inArray(d.id, q.children) + 1;
                        break;
                    case"inside":
                    case"first":
                        e = 0;
                        break;
                    case"last":
                        e = q.children.length;
                        break;
                    default:
                        e || (e = 0)
                }
                if (e > q.children.length && (e = q.children.length), !this.check("copy_node", c, q, e, {
                        core: !0,
                        is_multi: r && r._id && r._id !== this._id,
                        is_foreign: !r || !r._id
                    }))return this.settings.core.error.call(this, this._data.core.last_error), !1;
                if (o = r ? r.get_json(c, {no_id: !0, no_data: !0, no_state: !0}) : c, !o)return !1;
                if (o.id === !0 && delete o.id, o = this._parse_model_from_json(o, q.id, q.parents.concat()), !o)return !1;
                for (l = this.get_node(o), c && c.state && c.state.loaded === !1 && (l.state.loaded = !1), k = [], k.push(o), k = k.concat(l.children_d), this.trigger("model", {
                    nodes: k,
                    parent: q.id
                }), m = 0, n = q.parents.length; n > m; m++)this._model.data[q.parents[m]].children_d = this._model.data[q.parents[m]].children_d.concat(k);
                for (k = [], m = 0, n = q.children.length; n > m; m++)k[m >= e ? m + 1 : m] = q.children[m];
                return k[e] = l.id, q.children = k, q.children_d.push(l.id), q.children_d = q.children_d.concat(l.children_d), "#" === q.id && (this._model.force_full_redraw = !0), this._model.force_full_redraw || this._node_changed(q.id), h || this.redraw("#" === q.id), f && f.call(this, l, q, e), this.trigger("copy_node", {
                    node: l,
                    original: c,
                    parent: q.id,
                    position: e,
                    old_parent: p,
                    old_position: r && r._id && p && r._model.data[p] && r._model.data[p].children ? a.inArray(c.id, r._model.data[p].children) : -1,
                    is_multi: r && r._id && r._id !== this._id,
                    is_foreign: !r || !r._id,
                    old_instance: r,
                    new_instance: this
                }), l.id
            }, cut: function (b) {
                if (b || (b = this._data.core.selected.concat()), a.isArray(b) || (b = [b]), !b.length)return !1;
                var c, d, e, i = [];
                for (d = 0, e = b.length; e > d; d++)c = this.get_node(b[d]), c && c.id && "#" !== c.id && i.push(c);
                return i.length ? (f = i, h = this, g = "move_node", void this.trigger("cut", {node: b})) : !1
            }, copy: function (b) {
                if (b || (b = this._data.core.selected.concat()), a.isArray(b) || (b = [b]), !b.length)return !1;
                var c, d, e, i = [];
                for (d = 0, e = b.length; e > d; d++)c = this.get_node(b[d]), c && c.id && "#" !== c.id && i.push(c);
                return i.length ? (f = i, h = this, g = "copy_node", void this.trigger("copy", {node: b})) : !1
            }, get_buffer: function () {
                return {mode: g, node: f, inst: h}
            }, can_paste: function () {
                return g !== !1 && f !== !1
            }, paste: function (a, b) {
                return a = this.get_node(a), a && g && g.match(/^(copy_node|move_node)$/) && f ? (this[g](f, a, b) && this.trigger("paste", {
                    parent: a.id,
                    node: f,
                    mode: g
                }), f = !1, g = !1, void(h = !1)) : !1
            }, clear_buffer: function () {
                f = !1, g = !1, h = !1, this.trigger("clear_buffer")
            }, edit: function (b, c) {
                if (b = this.get_node(b), !b)return !1;
                if (this.settings.core.check_callback === !1)return this._data.core.last_error = {
                    error: "check",
                    plugin: "core",
                    id: "core_07",
                    reason: "Could not edit node because of check_callback"
                }, this.settings.core.error.call(this, this._data.core.last_error), !1;
                c = "string" == typeof c ? c : b.text, this.set_text(b, ""), b = this._open_to(b);
                var d = this._data.core.rtl, e = this.element.width(), f = b.children(".jstree-anchor"), g = a("<span>"), h = c, i = a("<div />", {
                    css: {
                        position: "absolute",
                        top: "-200px",
                        left: d ? "0px" : "-1000px",
                        visibility: "hidden"
                    }
                }).appendTo("body"), j = a("<input />", {
                    value: h,
                    "class": "jstree-rename-input",
                    css: {
                        padding: "0",
                        border: "1px solid silver",
                        "box-sizing": "border-box",
                        display: "inline-block",
                        height: this._data.core.li_height + "px",
                        lineHeight: this._data.core.li_height + "px",
                        width: "150px"
                    },
                    blur: a.proxy(function () {
                        var c = g.children(".jstree-rename-input"), d = c.val();
                        "" === d && (d = h), i.remove(), g.replaceWith(f), g.remove(), this.set_text(b, h), this.rename_node(b, a("<div></div>").text(d)[this.settings.core.force_text ? "text" : "html"]()) === !1 && this.set_text(b, h)
                    }, this),
                    keydown: function (a) {
                        var b = a.which;
                        27 === b && (this.value = h), (27 === b || 13 === b || 37 === b || 38 === b || 39 === b || 40 === b || 32 === b) && a.stopImmediatePropagation(), (27 === b || 13 === b) && (a.preventDefault(), this.blur())
                    },
                    click: function (a) {
                        a.stopImmediatePropagation()
                    },
                    mousedown: function (a) {
                        a.stopImmediatePropagation()
                    },
                    keyup: function (a) {
                        j.width(Math.min(i.text("pW" + this.value).width(), e))
                    },
                    keypress: function (a) {
                        return 13 === a.which ? !1 : void 0
                    }
                }), k = {
                    fontFamily: f.css("fontFamily") || "",
                    fontSize: f.css("fontSize") || "",
                    fontWeight: f.css("fontWeight") || "",
                    fontStyle: f.css("fontStyle") || "",
                    fontStretch: f.css("fontStretch") || "",
                    fontVariant: f.css("fontVariant") || "",
                    letterSpacing: f.css("letterSpacing") || "",
                    wordSpacing: f.css("wordSpacing") || ""
                };
                g.attr("class", f.attr("class")).append(f.contents().clone()).append(j), f.replaceWith(g), i.css(k), j.css(k).width(Math.min(i.text("pW" + j[0].value).width(), e))[0].select()
            }, set_theme: function (b, c) {
                if (!b)return !1;
                if (c === !0) {
                    var d = this.settings.core.themes.dir;
                    d || (d = a.jstree.path + "/themes"), c = d + "/" + b + "/style.css"
                }
                c && -1 === a.inArray(c, i) && (a("head").append('<link rel="stylesheet" href="' + c + '" type="text/css" />'), i.push(c)), this._data.core.themes.name && this.element.removeClass("jstree-" + this._data.core.themes.name), this._data.core.themes.name = b, this.element.addClass("jstree-" + b), this.element[this.settings.core.themes.responsive ? "addClass" : "removeClass"]("jstree-" + b + "-responsive"), this.trigger("set_theme", {theme: b})
            }, get_theme: function () {
                return this._data.core.themes.name
            }, set_theme_variant: function (a) {
                this._data.core.themes.variant && this.element.removeClass("jstree-" + this._data.core.themes.name + "-" + this._data.core.themes.variant), this._data.core.themes.variant = a, a && this.element.addClass("jstree-" + this._data.core.themes.name + "-" + this._data.core.themes.variant)
            }, get_theme_variant: function () {
                return this._data.core.themes.variant
            }, show_stripes: function () {
                this._data.core.themes.stripes = !0, this.get_container_ul().addClass("jstree-striped")
            }, hide_stripes: function () {
                this._data.core.themes.stripes = !1, this.get_container_ul().removeClass("jstree-striped")
            }, toggle_stripes: function () {
                this._data.core.themes.stripes ? this.hide_stripes() : this.show_stripes()
            }, show_dots: function () {
                this._data.core.themes.dots = !0, this.get_container_ul().removeClass("jstree-no-dots")
            }, hide_dots: function () {
                this._data.core.themes.dots = !1, this.get_container_ul().addClass("jstree-no-dots")
            }, toggle_dots: function () {
                this._data.core.themes.dots ? this.hide_dots() : this.show_dots()
            }, show_icons: function () {
                this._data.core.themes.icons = !0, this.get_container_ul().removeClass("jstree-no-icons")
            }, hide_icons: function () {
                this._data.core.themes.icons = !1, this.get_container_ul().addClass("jstree-no-icons")
            }, toggle_icons: function () {
                this._data.core.themes.icons ? this.hide_icons() : this.show_icons()
            }, set_icon: function (b, c) {
                var d, e, f, g;
                if (a.isArray(b)) {
                    for (b = b.slice(), d = 0, e = b.length; e > d; d++)this.set_icon(b[d], c);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (g = b.icon, b.icon = c, f = this.get_node(b, !0).children(".jstree-anchor").children(".jstree-themeicon"), c === !1 ? this.hide_icon(b) : c === !0 ? f.removeClass("jstree-themeicon-custom " + g).css("background", "").removeAttr("rel") : -1 === c.indexOf("/") && -1 === c.indexOf(".") ? (f.removeClass(g).css("background", ""), f.addClass(c + " jstree-themeicon-custom").attr("rel", c)) : (f.removeClass(g).css("background", ""), f.addClass("jstree-themeicon-custom").css("background", "url('" + c + "') center center no-repeat").attr("rel", c)), !0) : !1
            }, get_icon: function (a) {
                return a = this.get_node(a), a && "#" !== a.id ? a.icon : !1
            }, hide_icon: function (b) {
                var c, d;
                if (a.isArray(b)) {
                    for (b = b.slice(), c = 0, d = b.length; d > c; c++)this.hide_icon(b[c]);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b ? (b.icon = !1, this.get_node(b, !0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"), !0) : !1
            }, show_icon: function (b) {
                var c, d, e;
                if (a.isArray(b)) {
                    for (b = b.slice(), c = 0, d = b.length; d > c; c++)this.show_icon(b[c]);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b ? (e = this.get_node(b, !0), b.icon = e.length ? e.children(".jstree-anchor").children(".jstree-themeicon").attr("rel") : !0, b.icon || (b.icon = !0), e.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"), !0) : !1
            }
        }, a.vakata = {}, a.vakata.attributes = function (b, c) {
            b = a(b)[0];
            var d = c ? {} : [];
            return b && b.attributes && a.each(b.attributes, function (b, e) {
                -1 === a.inArray(e.name.toLowerCase(), ["style", "contenteditable", "hasfocus", "tabindex"]) && null !== e.value && "" !== a.trim(e.value) && (c ? d[e.name] = e.value : d.push(e.name))
            }), d
        }, a.vakata.array_unique = function (a) {
            var b, c, d, e = [];
            for (b = 0, d = a.length; d > b; b++) {
                for (c = 0; b >= c && a[b] !== a[c]; c++);
                c === b && e.push(a[b])
            }
            return e
        }, a.vakata.array_remove = function (a, b, c) {
            var d = a.slice((c || b) + 1 || a.length);
            return a.length = 0 > b ? a.length + b : b, a.push.apply(a, d), a
        }, a.vakata.array_remove_item = function (b, c) {
            var d = a.inArray(c, b);
            return -1 !== d ? a.vakata.array_remove(b, d) : b
        };
        var m = document.createElement("I");
        m.className = "jstree-icon jstree-checkbox", a.jstree.defaults.checkbox = {
            visible: !0,
            three_state: !0,
            whole_node: !0,
            keep_selected_style: !0,
            cascade: "",
            tie_selection: !0
        }, a.jstree.plugins.checkbox = function (b, c) {
            this.bind = function () {
                c.bind.call(this), this._data.checkbox.uto = !1, this._data.checkbox.selected = [], this.settings.checkbox.three_state && (this.settings.checkbox.cascade = "up+down+undetermined"), this.element.on("init.jstree", a.proxy(function () {
                    this._data.checkbox.visible = this.settings.checkbox.visible, this.settings.checkbox.keep_selected_style || this.element.addClass("jstree-checkbox-no-clicked"), this.settings.checkbox.tie_selection && this.element.addClass("jstree-checkbox-selection")
                }, this)).on("loading.jstree", a.proxy(function () {
                    this[this._data.checkbox.visible ? "show_checkboxes" : "hide_checkboxes"]()
                }, this)), -1 !== this.settings.checkbox.cascade.indexOf("undetermined") && this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree openNode.jstree", a.proxy(function () {
                    this._data.checkbox.uto && clearTimeout(this._data.checkbox.uto), this._data.checkbox.uto = setTimeout(a.proxy(this._undetermined, this), 50)
                }, this)), this.settings.checkbox.tie_selection || this.element.on("model.jstree", a.proxy(function (a, b) {
                    var c, d, e = this._model.data, f = (e[b.parent], b.nodes);
                    for (c = 0, d = f.length; d > c; c++)e[f[c]].state.checked = e[f[c]].original && e[f[c]].original.state && e[f[c]].original.state.checked, e[f[c]].state.checked && this._data.checkbox.selected.push(f[c])
                }, this)), (-1 !== this.settings.checkbox.cascade.indexOf("up") || -1 !== this.settings.checkbox.cascade.indexOf("down")) && this.element.on("model.jstree", a.proxy(function (b, c) {
                    var d, e, f, g, h, i, j = this._model.data, k = j[c.parent], l = c.nodes, m = [], n = this.settings.checkbox.cascade, o = this.settings.checkbox.tie_selection;
                    if (-1 !== n.indexOf("down"))if (k.state[o ? "selected" : "checked"]) {
                        for (e = 0, f = l.length; f > e; e++)j[l[e]].state[o ? "selected" : "checked"] = !0;
                        this._data[o ? "core" : "checkbox"].selected = this._data[o ? "core" : "checkbox"].selected.concat(l)
                    } else for (e = 0, f = l.length; f > e; e++)if (j[l[e]].state[o ? "selected" : "checked"]) {
                        for (g = 0, h = j[l[e]].children_d.length; h > g; g++)j[j[l[e]].children_d[g]].state[o ? "selected" : "checked"] = !0;
                        this._data[o ? "core" : "checkbox"].selected = this._data[o ? "core" : "checkbox"].selected.concat(j[l[e]].children_d)
                    }
                    if (-1 !== n.indexOf("up")) {
                        for (e = 0, f = k.children_d.length; f > e; e++)j[k.children_d[e]].children.length || m.push(j[k.children_d[e]].parent);
                        for (m = a.vakata.array_unique(m), g = 0, h = m.length; h > g; g++)for (k = j[m[g]]; k && "#" !== k.id;) {
                            for (d = 0, e = 0, f = k.children.length; f > e; e++)d += j[k.children[e]].state[o ? "selected" : "checked"];
                            if (d !== f)break;
                            k.state[o ? "selected" : "checked"] = !0, this._data[o ? "core" : "checkbox"].selected.push(k.id), i = this.get_node(k, !0), i && i.length && i.children(".jstree-anchor").addClass(o ? "jstree-clicked" : "jstree-checked"), k = this.get_node(k.parent)
                        }
                    }
                    this._data[o ? "core" : "checkbox"].selected = a.vakata.array_unique(this._data[o ? "core" : "checkbox"].selected)
                }, this)).on(this.settings.checkbox.tie_selection ? "select_node.jstree" : "check_node.jstree", a.proxy(function (b, c) {
                    var d, e, f, g, h = c.node, i = this._model.data, j = this.get_node(h.parent), k = this.get_node(h, !0), l = this.settings.checkbox.cascade, m = this.settings.checkbox.tie_selection;
                    if (-1 !== l.indexOf("down"))for (this._data[m ? "core" : "checkbox"].selected = a.vakata.array_unique(this._data[m ? "core" : "checkbox"].selected.concat(h.children_d)), d = 0, e = h.children_d.length; e > d; d++)g = i[h.children_d[d]], g.state[m ? "selected" : "checked"] = !0, g && g.original && g.original.state && g.original.state.undetermined && (g.original.state.undetermined = !1);
                    if (-1 !== l.indexOf("up"))for (; j && "#" !== j.id;) {
                        for (f = 0, d = 0, e = j.children.length; e > d; d++)f += i[j.children[d]].state[m ? "selected" : "checked"];
                        if (f !== e)break;
                        j.state[m ? "selected" : "checked"] = !0, this._data[m ? "core" : "checkbox"].selected.push(j.id), g = this.get_node(j, !0), g && g.length && g.children(".jstree-anchor").addClass(m ? "jstree-clicked" : "jstree-checked"), j = this.get_node(j.parent)
                    }
                    -1 !== l.indexOf("down") && k.length && k.find(".jstree-anchor").addClass(m ? "jstree-clicked" : "jstree-checked")
                }, this)).on(this.settings.checkbox.tie_selection ? "deselect_all.jstree" : "uncheck_all.jstree", a.proxy(function (a, b) {
                    var c, d, e, f = this.get_node("#"), g = this._model.data;
                    for (c = 0, d = f.children_d.length; d > c; c++)e = g[f.children_d[c]], e && e.original && e.original.state && e.original.state.undetermined && (e.original.state.undetermined = !1)
                }, this)).on(this.settings.checkbox.tie_selection ? "deselect_node.jstree" : "uncheck_node.jstree", a.proxy(function (b, c) {
                    var d, e, f, g = c.node, h = this.get_node(g, !0), i = this.settings.checkbox.cascade, j = this.settings.checkbox.tie_selection;
                    if (g && g.original && g.original.state && g.original.state.undetermined && (g.original.state.undetermined = !1), -1 !== i.indexOf("down"))for (d = 0, e = g.children_d.length; e > d; d++)f = this._model.data[g.children_d[d]], f.state[j ? "selected" : "checked"] = !1, f && f.original && f.original.state && f.original.state.undetermined && (f.original.state.undetermined = !1);
                    if (-1 !== i.indexOf("up"))for (d = 0, e = g.parents.length; e > d; d++)f = this._model.data[g.parents[d]], f.state[j ? "selected" : "checked"] = !1, f && f.original && f.original.state && f.original.state.undetermined && (f.original.state.undetermined = !1), f = this.get_node(g.parents[d], !0), f && f.length && f.children(".jstree-anchor").removeClass(j ? "jstree-clicked" : "jstree-checked");
                    for (f = [], d = 0, e = this._data[j ? "core" : "checkbox"].selected.length; e > d; d++)-1 !== i.indexOf("down") && -1 !== a.inArray(this._data[j ? "core" : "checkbox"].selected[d], g.children_d) || -1 !== i.indexOf("up") && -1 !== a.inArray(this._data[j ? "core" : "checkbox"].selected[d], g.parents) || f.push(this._data[j ? "core" : "checkbox"].selected[d]);
                    this._data[j ? "core" : "checkbox"].selected = a.vakata.array_unique(f), -1 !== i.indexOf("down") && h.length && h.find(".jstree-anchor").removeClass(j ? "jstree-clicked" : "jstree-checked")
                }, this)), -1 !== this.settings.checkbox.cascade.indexOf("up") && this.element.on("delete_node.jstree", a.proxy(function (a, b) {
                    for (var c, d, e, f, g = this.get_node(b.parent), h = this._model.data, i = this.settings.checkbox.tie_selection; g && "#" !== g.id;) {
                        for (e = 0, c = 0, d = g.children.length; d > c; c++)e += h[g.children[c]].state[i ? "selected" : "checked"];
                        if (e !== d)break;
                        g.state[i ? "selected" : "checked"] = !0, this._data[i ? "core" : "checkbox"].selected.push(g.id), f = this.get_node(g, !0), f && f.length && f.children(".jstree-anchor").addClass(i ? "jstree-clicked" : "jstree-checked"), g = this.get_node(g.parent)
                    }
                }, this)).on("move_node.jstree", a.proxy(function (b, c) {
                    var d, e, f, g, h, i = c.is_multi, j = c.old_parent, k = this.get_node(c.parent), l = this._model.data, m = this.settings.checkbox.tie_selection;
                    if (!i)for (d = this.get_node(j); d && "#" !== d.id;) {
                        for (e = 0, f = 0, g = d.children.length; g > f; f++)e += l[d.children[f]].state[m ? "selected" : "checked"];
                        if (e !== g)break;
                        d.state[m ? "selected" : "checked"] = !0, this._data[m ? "core" : "checkbox"].selected.push(d.id), h = this.get_node(d, !0), h && h.length && h.children(".jstree-anchor").addClass(m ? "jstree-clicked" : "jstree-checked"), d = this.get_node(d.parent)
                    }
                    for (d = k; d && "#" !== d.id;) {
                        for (e = 0, f = 0, g = d.children.length; g > f; f++)e += l[d.children[f]].state[m ? "selected" : "checked"];
                        if (e === g)d.state[m ? "selected" : "checked"] || (d.state[m ? "selected" : "checked"] = !0, this._data[m ? "core" : "checkbox"].selected.push(d.id), h = this.get_node(d, !0), h && h.length && h.children(".jstree-anchor").addClass(m ? "jstree-clicked" : "jstree-checked")); else {
                            if (!d.state[m ? "selected" : "checked"])break;
                            d.state[m ? "selected" : "checked"] = !1, this._data[m ? "core" : "checkbox"].selected = a.vakata.array_remove_item(this._data[m ? "core" : "checkbox"].selected, d.id), h = this.get_node(d, !0), h && h.length && h.children(".jstree-anchor").removeClass(m ? "jstree-clicked" : "jstree-checked")
                        }
                        d = this.get_node(d.parent)
                    }
                }, this))
            }, this._undetermined = function () {
                var b, c, d = this._model.data, e = this.settings.checkbox.tie_selection, f = this._data[e ? "core" : "checkbox"].selected, g = [], h = this;
                for (b = 0, c = f.length; c > b; b++)d[f[b]] && d[f[b]].parents && (g = g.concat(d[f[b]].parents));
                for (this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function () {
                    var a, e = h.get_node(this);
                    if (e.state.loaded)for (b = 0, c = e.children_d.length; c > b; b++)a = d[e.children_d[b]], !a.state.loaded && a.original && a.original.state && a.original.state.undetermined && a.original.state.undetermined === !0 && (g.push(a.id), g = g.concat(a.parents)); else e.original && e.original.state && e.original.state.undetermined && e.original.state.undetermined === !0 && (g.push(e.id), g = g.concat(e.parents))
                }), g = a.vakata.array_unique(g), g = a.vakata.array_remove_item(g, "#"), this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"), b = 0, c = g.length; c > b; b++)d[g[b]].state[e ? "selected" : "checked"] || (f = this.get_node(g[b], !0), f && f.length && f.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))
            }, this.redraw_node = function (b, d, e, f) {
                if (b = c.redraw_node.apply(this, arguments)) {
                    var g, h, i = null;
                    for (g = 0, h = b.childNodes.length; h > g; g++)if (b.childNodes[g] && b.childNodes[g].className && -1 !== b.childNodes[g].className.indexOf("jstree-anchor")) {
                        i = b.childNodes[g];
                        break
                    }
                    i && (!this.settings.checkbox.tie_selection && this._model.data[b.id].state.checked && (i.className += " jstree-checked"), i.insertBefore(m.cloneNode(!1), i.childNodes[0]))
                }
                return e || -1 === this.settings.checkbox.cascade.indexOf("undetermined") || (this._data.checkbox.uto && clearTimeout(this._data.checkbox.uto), this._data.checkbox.uto = setTimeout(a.proxy(this._undetermined, this), 50)), b
            }, this.show_checkboxes = function () {
                this._data.core.themes.checkboxes = !0, this.get_container_ul().removeClass("jstree-no-checkboxes")
            }, this.hide_checkboxes = function () {
                this._data.core.themes.checkboxes = !1, this.get_container_ul().addClass("jstree-no-checkboxes")
            }, this.toggle_checkboxes = function () {
                this._data.core.themes.checkboxes ? this.hide_checkboxes() : this.show_checkboxes()
            }, this.is_undetermined = function (b) {
                b = this.get_node(b);
                var c, d, e = this.settings.checkbox.cascade, f = this.settings.checkbox.tie_selection, g = this._data[f ? "core" : "checkbox"].selected, h = this._model.data;
                if (!b || b.state[f ? "selected" : "checked"] === !0 || -1 === e.indexOf("undetermined") || -1 === e.indexOf("down") && -1 === e.indexOf("up"))return !1;
                if (!b.state.loaded && b.original.state.undetermined === !0)return !0;
                for (c = 0, d = b.children_d.length; d > c; c++)if (-1 !== a.inArray(b.children_d[c], g) || !h[b.children_d[c]].state.loaded && h[b.children_d[c]].original.state.undetermined)return !0;
                return !1
            }, this.activate_node = function (b, d) {
                return this.settings.checkbox.tie_selection && (this.settings.checkbox.whole_node || a(d.target).hasClass("jstree-checkbox")) && (d.ctrlKey = !0), this.settings.checkbox.tie_selection || !this.settings.checkbox.whole_node && !a(d.target).hasClass("jstree-checkbox") ? c.activate_node.call(this, b, d) : (this.is_checked(b) ? this.uncheck_node(b, d) : this.check_node(b, d), void this.trigger("activate_node", {node: this.get_node(b)}))
            }, this.check_node = function (b, c) {
                if (this.settings.checkbox.tie_selection)return this.select_node(b, !1, !0, c);
                var d, e, f;
                if (a.isArray(b)) {
                    for (b = b.slice(), e = 0, f = b.length; f > e; e++)this.check_node(b[e], c);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (d = this.get_node(b, !0), void(b.state.checked || (b.state.checked = !0, this._data.checkbox.selected.push(b.id), d && d.length && d.children(".jstree-anchor").addClass("jstree-checked"), this.trigger("check_node", {
                    node: b,
                    selected: this._data.checkbox.selected,
                    event: c
                })))) : !1
            }, this.uncheck_node = function (b, c) {
                if (this.settings.checkbox.tie_selection)return this.deselect_node(b, !1, c);
                var d, e, f;
                if (a.isArray(b)) {
                    for (b = b.slice(), d = 0, e = b.length; e > d; d++)this.uncheck_node(b[d], c);
                    return !0
                }
                return b = this.get_node(b), b && "#" !== b.id ? (f = this.get_node(b, !0), void(b.state.checked && (b.state.checked = !1, this._data.checkbox.selected = a.vakata.array_remove_item(this._data.checkbox.selected, b.id), f.length && f.children(".jstree-anchor").removeClass("jstree-checked"), this.trigger("uncheck_node", {
                    node: b,
                    selected: this._data.checkbox.selected,
                    event: c
                })))) : !1
            }, this.check_all = function () {
                if (this.settings.checkbox.tie_selection)return this.select_all();
                var a, b;
                this._data.checkbox.selected.concat([]);
                for (this._data.checkbox.selected = this._model.data["#"].children_d.concat(), a = 0, b = this._data.checkbox.selected.length; b > a; a++)this._model.data[this._data.checkbox.selected[a]] && (this._model.data[this._data.checkbox.selected[a]].state.checked = !0);
                this.redraw(!0), this.trigger("check_all", {selected: this._data.checkbox.selected})
            }, this.uncheck_all = function () {
                if (this.settings.checkbox.tie_selection)return this.deselect_all();
                var a, b, c = this._data.checkbox.selected.concat([]);
                for (a = 0, b = this._data.checkbox.selected.length; b > a; a++)this._model.data[this._data.checkbox.selected[a]] && (this._model.data[this._data.checkbox.selected[a]].state.checked = !1);
                this._data.checkbox.selected = [], this.element.find(".jstree-checked").removeClass("jstree-checked"), this.trigger("uncheck_all", {
                    selected: this._data.checkbox.selected,
                    node: c
                })
            }, this.is_checked = function (a) {
                return this.settings.checkbox.tie_selection ? this.is_selected(a) : (a = this.get_node(a), a && "#" !== a.id ? a.state.checked : !1)
            }, this.get_checked = function (b) {
                return this.settings.checkbox.tie_selection ? this.get_selected(b) : b ? a.map(this._data.checkbox.selected, a.proxy(function (a) {
                    return this.get_node(a)
                }, this)) : this._data.checkbox.selected
            }, this.get_top_checked = function (b) {
                if (this.settings.checkbox.tie_selection)return this.get_top_selected(b);
                var c, d, e, f, g = this.get_checked(!0), h = {};
                for (c = 0, d = g.length; d > c; c++)h[g[c].id] = g[c];
                for (c = 0, d = g.length; d > c; c++)for (e = 0, f = g[c].children_d.length; f > e; e++)h[g[c].children_d[e]] && delete h[g[c].children_d[e]];
                g = [];
                for (c in h)h.hasOwnProperty(c) && g.push(c);
                return b ? a.map(g, a.proxy(function (a) {
                    return this.get_node(a)
                }, this)) : g
            }, this.get_bottom_checked = function (b) {
                if (this.settings.checkbox.tie_selection)return this.get_bottom_selected(b);
                var c, d, e = this.get_checked(!0), f = [];
                for (c = 0, d = e.length; d > c; c++)e[c].children.length || f.push(e[c].id);
                return b ? a.map(f, a.proxy(function (a) {
                    return this.get_node(a)
                }, this)) : f
            }
        }, a.jstree.defaults.contextmenu = {
            select_node: !0, show_at_node: !0, items: function (b, c) {
                return {
                    create: {
                        separator_before: !1,
                        separator_after: !0,
                        _disabled: !1,
                        label: "Create",
                        action: function (b) {
                            var c = a.jstree.reference(b.reference), d = c.get_node(b.reference);
                            c.create_node(d, {}, "last", function (a) {
                                setTimeout(function () {
                                    c.edit(a)
                                }, 0)
                            })
                        }
                    },
                    rename: {
                        separator_before: !1,
                        separator_after: !1,
                        _disabled: !1,
                        label: "Rename",
                        action: function (b) {
                            var c = a.jstree.reference(b.reference), d = c.get_node(b.reference);
                            c.edit(d)
                        }
                    },
                    remove: {
                        separator_before: !1,
                        icon: !1,
                        separator_after: !1,
                        _disabled: !1,
                        label: "Delete",
                        action: function (b) {
                            var c = a.jstree.reference(b.reference), d = c.get_node(b.reference);
                            c.is_selected(d) ? c.delete_node(c.get_selected()) : c.delete_node(d)
                        }
                    },
                    ccp: {
                        separator_before: !0,
                        icon: !1,
                        separator_after: !1,
                        label: "Edit",
                        action: !1,
                        submenu: {
                            cut: {
                                separator_before: !1, separator_after: !1, label: "Cut", action: function (b) {
                                    var c = a.jstree.reference(b.reference), d = c.get_node(b.reference);
                                    c.is_selected(d) ? c.cut(c.get_selected()) : c.cut(d)
                                }
                            }, copy: {
                                separator_before: !1,
                                icon: !1,
                                separator_after: !1,
                                label: "Copy",
                                action: function (b) {
                                    var c = a.jstree.reference(b.reference), d = c.get_node(b.reference);
                                    c.is_selected(d) ? c.copy(c.get_selected()) : c.copy(d)
                                }
                            }, paste: {
                                separator_before: !1, icon: !1, _disabled: function (b) {
                                    return !a.jstree.reference(b.reference).can_paste()
                                }, separator_after: !1, label: "Paste", action: function (b) {
                                    var c = a.jstree.reference(b.reference), d = c.get_node(b.reference);
                                    c.paste(d)
                                }
                            }
                        }
                    }
                }
            }
        }, a.jstree.plugins.contextmenu = function (c, d) {
            this.bind = function () {
                d.bind.call(this);
                var b = 0;
                this.element.on("contextmenu.jstree", ".jstree-anchor", a.proxy(function (a) {
                    a.preventDefault(), b = a.ctrlKey ? a.timeStamp : 0, this.is_loading(a.currentTarget) || this.show_contextmenu(a.currentTarget, a.pageX, a.pageY, a)
                }, this)).on("click.jstree", ".jstree-anchor", a.proxy(function (c) {
                    this._data.contextmenu.visible && (!b || c.timeStamp - b > 250) && a.vakata.context.hide()
                }, this)), a(document).on("context_hide.vakata.jstree", a.proxy(function () {
                    this._data.contextmenu.visible = !1
                }, this))
            }, this.teardown = function () {
                this._data.contextmenu.visible && a.vakata.context.hide(), d.teardown.call(this)
            }, this.show_contextmenu = function (c, d, e, f) {
                if (c = this.get_node(c), !c || "#" === c.id)return !1;
                var g = this.settings.contextmenu, h = this.get_node(c, !0), i = h.children(".jstree-anchor"), j = !1, k = !1;
                (g.show_at_node || d === b || e === b) && (j = i.offset(), d = j.left, e = j.top + this._data.core.li_height), this.settings.contextmenu.select_node && !this.is_selected(c) && this.activate_node(c, f), k = g.items, a.isFunction(k) && (k = k.call(this, c, a.proxy(function (a) {
                    this._show_contextmenu(c, d, e, a)
                }, this))), a.isPlainObject(k) && this._show_contextmenu(c, d, e, k)
            }, this._show_contextmenu = function (b, c, d, e) {
                var f = this.get_node(b, !0), g = f.children(".jstree-anchor");
                a(document).one("context_show.vakata.jstree", a.proxy(function (b, c) {
                    var d = "jstree-contextmenu jstree-" + this.get_theme() + "-contextmenu";
                    a(c.element).addClass(d)
                }, this)), this._data.contextmenu.visible = !0, a.vakata.context.show(g, {
                    x: c,
                    y: d
                }, e), this.trigger("show_contextmenu", {node: b, x: c, y: d})
            }
        }, function (a) {
            var b = !1, c = {
                element: !1,
                reference: !1,
                position_x: 0,
                position_y: 0,
                items: [],
                html: "",
                is_visible: !1
            };
            a.vakata.context = {
                settings: {hide_onmouseleave: 0, icons: !0}, _trigger: function (b) {
                    a(document).triggerHandler("context_" + b + ".vakata", {
                        reference: c.reference,
                        element: c.element,
                        position: {x: c.position_x, y: c.position_y}
                    })
                }, _execute: function (b) {
                    return b = c.items[b], b && (!b._disabled || a.isFunction(b._disabled) && !b._disabled({
                        item: b,
                        reference: c.reference,
                        element: c.element
                    })) && b.action ? b.action.call(null, {
                        item: b,
                        reference: c.reference,
                        element: c.element,
                        position: {x: c.position_x, y: c.position_y}
                    }) : !1
                }, _parse: function (b, d) {
                    if (!b)return !1;
                    d || (c.html = "", c.items = []);
                    var e, f = "", g = !1;
                    return d && (f += "<ul>"), a.each(b, function (b, d) {
                        return d ? (c.items.push(d), !g && d.separator_before && (f += "<li class='vakata-context-separator'><a href='#' " + (a.vakata.context.settings.icons ? "" : 'style="margin-left:0px;"') + ">&#160;</a></li>"), g = !1, f += "<li class='" + (d._class || "") + (d._disabled === !0 || a.isFunction(d._disabled) && d._disabled({
                                item: d,
                                reference: c.reference,
                                element: c.element
                            }) ? " vakata-contextmenu-disabled " : "") + "' " + (d.shortcut ? " data-shortcut='" + d.shortcut + "' " : "") + ">", f += "<a href='#' rel='" + (c.items.length - 1) + "'>", a.vakata.context.settings.icons && (f += "<i ", d.icon && (f += -1 !== d.icon.indexOf("/") || -1 !== d.icon.indexOf(".") ? " style='background:url(\"" + d.icon + "\") center center no-repeat' " : " class='" + d.icon + "' "), f += "></i><span class='vakata-contextmenu-sep'>&#160;</span>"), f += (a.isFunction(d.label) ? d.label({
                                item: b,
                                reference: c.reference,
                                element: c.element
                            }) : d.label) + (d.shortcut ? ' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-' + d.shortcut + '">' + (d.shortcut_label || "") + "</span>" : "") + "</a>", d.submenu && (e = a.vakata.context._parse(d.submenu, !0), e && (f += e)), f += "</li>", void(d.separator_after && (f += "<li class='vakata-context-separator'><a href='#' " + (a.vakata.context.settings.icons ? "" : 'style="margin-left:0px;"') + ">&#160;</a></li>", g = !0))) : !0
                    }), f = f.replace(/<li class\='vakata-context-separator'\><\/li\>$/, ""), d && (f += "</ul>"), d || (c.html = f, a.vakata.context._trigger("parse")), f.length > 10 ? f : !1
                }, _show_submenu: function (c) {
                    if (c = a(c), c.length && c.children("ul").length) {
                        var d = c.children("ul"), e = c.offset().left + c.outerWidth(), f = c.offset().top, g = d.width(), h = d.height(), i = a(window).width() + a(window).scrollLeft(), j = a(window).height() + a(window).scrollTop();
                        b ? c[e - (g + 10 + c.outerWidth()) < 0 ? "addClass" : "removeClass"]("vakata-context-left") : c[e + g + 10 > i ? "addClass" : "removeClass"]("vakata-context-right"), f + h + 10 > j && d.css("bottom", "-1px"), d.show()
                    }
                }, show: function (d, e, f) {
                    var g, h, i, j, k, l, m, n, o = !0;
                    switch (c.element && c.element.length && c.element.width(""), o) {
                        case!e && !d:
                            return !1;
                        case!!e && !!d:
                            c.reference = d, c.position_x = e.x, c.position_y = e.y;
                            break;
                        case!e && !!d:
                            c.reference = d, g = d.offset(), c.position_x = g.left + d.outerHeight(), c.position_y = g.top;
                            break;
                        case!!e && !d:
                            c.position_x = e.x, c.position_y = e.y
                    }
                    d && !f && a(d).data("vakata_contextmenu") && (f = a(d).data("vakata_contextmenu")), a.vakata.context._parse(f) && c.element.html(c.html), c.items.length && (c.element.appendTo("body"), h = c.element, i = c.position_x, j = c.position_y, k = h.width(), l = h.height(), m = a(window).width() + a(window).scrollLeft(), n = a(window).height() + a(window).scrollTop(), b && (i -= h.outerWidth(), i < a(window).scrollLeft() + 20 && (i = a(window).scrollLeft() + 20)), i + k + 20 > m && (i = m - (k + 20)), j + l + 20 > n && (j = n - (l + 20)), c.element.css({
                        left: i,
                        top: j
                    }).show().find("a").first().focus().parent().addClass("vakata-context-hover"), c.is_visible = !0, a.vakata.context._trigger("show"))
                }, hide: function () {
                    c.is_visible && (c.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(), c.is_visible = !1, a.vakata.context._trigger("hide"))
                }
            }, a(function () {
                b = "rtl" === a("body").css("direction");
                var d = !1;
                c.element = a("<ul class='vakata-context'></ul>"), c.element.on("mouseenter", "li", function (b) {
                    b.stopImmediatePropagation(), a.contains(this, b.relatedTarget) || (d && clearTimeout(d), c.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(), a(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context", "li").addBack().addClass("vakata-context-hover"), a.vakata.context._show_submenu(this))
                }).on("mouseleave", "li", function (b) {
                    a.contains(this, b.relatedTarget) || a(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")
                }).on("mouseleave", function (b) {
                    a(this).find(".vakata-context-hover").removeClass("vakata-context-hover"), a.vakata.context.settings.hide_onmouseleave && (d = setTimeout(function (b) {
                        return function () {
                            a.vakata.context.hide()
                        }
                    }(this), a.vakata.context.settings.hide_onmouseleave))
                }).on("click", "a", function (b) {
                    b.preventDefault(), a(this).blur().parent().hasClass("vakata-context-disabled") || a.vakata.context._execute(a(this).attr("rel")) === !1 || a.vakata.context.hide()
                }).on("keydown", "a", function (b) {
                    var d = null;
                    switch (b.which) {
                        case 13:
                        case 32:
                            b.type = "mouseup", b.preventDefault(), a(b.currentTarget).trigger(b);
                            break;
                        case 37:
                            c.is_visible && (c.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(), b.stopImmediatePropagation(), b.preventDefault());
                            break;
                        case 38:
                            c.is_visible && (d = c.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(), d.length || (d = c.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()), d.addClass("vakata-context-hover").children("a").focus(), b.stopImmediatePropagation(), b.preventDefault());
                            break;
                        case 39:
                            c.is_visible && (c.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(), b.stopImmediatePropagation(), b.preventDefault());
                            break;
                        case 40:
                            c.is_visible && (d = c.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(), d.length || (d = c.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()), d.addClass("vakata-context-hover").children("a").focus(), b.stopImmediatePropagation(), b.preventDefault());
                            break;
                        case 27:
                            a.vakata.context.hide(), b.preventDefault()
                    }
                }).on("keydown", function (a) {
                    a.preventDefault();
                    var b = c.element.find(".vakata-contextmenu-shortcut-" + a.which).parent();
                    b.parent().not(".vakata-context-disabled") && b.click()
                }), a(document).on("mousedown.vakata.jstree", function (b) {
                    c.is_visible && !a.contains(c.element[0], b.target) && a.vakata.context.hide()
                }).on("context_show.vakata.jstree", function (a, d) {
                    c.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"), b && c.element.addClass("vakata-context-rtl").css("direction", "rtl"), c.element.find("ul").hide().end()
                })
            })
        }(a), a.jstree.defaults.dnd = {
            copy: !0,
            open_timeout: 500,
            is_draggable: !0,
            check_while_dragging: !0,
            always_copy: !1,
            inside_pos: 0
        }, a.jstree.plugins.dnd = function (b, c) {
            this.bind = function () {
                c.bind.call(this), this.element.on("mousedown.jstree touchstart.jstree", ".jstree-anchor", a.proxy(function (b) {
                    var c = this.get_node(b.target), d = this.is_selected(c) ? this.get_selected().length : 1;
                    return c && c.id && "#" !== c.id && (1 === b.which || "touchstart" === b.type) && (this.settings.dnd.is_draggable === !0 || a.isFunction(this.settings.dnd.is_draggable) && this.settings.dnd.is_draggable.call(this, d > 1 ? this.get_selected(!0) : [c])) ? (this.element.trigger("mousedown.jstree"), a.vakata.dnd.start(b, {
                        jstree: !0,
                        origin: this,
                        obj: this.get_node(c, !0),
                        nodes: d > 1 ? this.get_selected() : [c.id]
                    }, '<div id="jstree-dnd" class="jstree-' + this.get_theme() + " jstree-" + this.get_theme() + "-" + this.get_theme_variant() + " " + (this.settings.core.themes.responsive ? " jstree-dnd-responsive" : "") + '"><i class="jstree-icon jstree-er"></i>' + (d > 1 ? d + " " + this.get_string("nodes") : this.get_text(b.currentTarget, !0)) + '<ins class="jstree-copy" style="display:none;">+</ins></div>')) : void 0
                }, this))
            }
        }, a(function () {
            var b = !1, c = !1, d = !1, e = a('<div id="jstree-marker">&#160;</div>').hide();
            a(document).on("dnd_start.vakata.jstree", function (a, c) {
                b = !1, c && c.data && c.data.jstree && e.appendTo("body")
            }).on("dnd_move.vakata.jstree", function (f, g) {
                if (d && clearTimeout(d), g && g.data && g.data.jstree && (!g.event.target.id || "jstree-marker" !== g.event.target.id)) {
                    var h, i, j, k, l, m, n, o, p, q, r, s, t, u, v = a.jstree.reference(g.event.target), w = !1, x = !1, y = !1;
                    if (v && v._data && v._data.dnd)if (e.attr("class", "jstree-" + v.get_theme() + (v.settings.core.themes.responsive ? " jstree-dnd-responsive" : "")), g.helper.children().attr("class", "jstree-" + v.get_theme() + " jstree-" + v.get_theme() + "-" + v.get_theme_variant() + " " + (v.settings.core.themes.responsive ? " jstree-dnd-responsive" : "")).find(".jstree-copy").first()[g.data.origin && (g.data.origin.settings.dnd.always_copy || g.data.origin.settings.dnd.copy && (g.event.metaKey || g.event.ctrlKey)) ? "show" : "hide"](), g.event.target !== v.element[0] && g.event.target !== v.get_container_ul()[0] || 0 !== v.get_container_ul().children().length) {
                        if (w = a(g.event.target).closest(".jstree-anchor"), w && w.length && w.parent().is(".jstree-closed, .jstree-open, .jstree-leaf") && (x = w.offset(), y = g.event.pageY - x.top, j = w.height(), m = j / 3 > y ? ["b", "i", "a"] : y > j - j / 3 ? ["a", "i", "b"] : y > j / 2 ? ["i", "a", "b"] : ["i", "b", "a"], a.each(m, function (f, y) {
                                switch (y) {
                                    case"b":
                                        h = x.left - 6, i = x.top, k = v.get_parent(w), l = w.parent().index();
                                        break;
                                    case"i":
                                        t = v.settings.dnd.inside_pos, u = v.get_node(w.parent()), h = x.left - 2, i = x.top + j / 2 + 1, k = u.id, l = "first" === t ? 0 : "last" === t ? u.children.length : Math.min(t, u.children.length);
                                        break;
                                    case"a":
                                        h = x.left - 6, i = x.top + j, k = v.get_parent(w), l = w.parent().index() + 1
                                }
                                for (n = !0, o = 0, p = g.data.nodes.length; p > o; o++)if (q = g.data.origin && (g.data.origin.settings.dnd.always_copy || g.data.origin.settings.dnd.copy && (g.event.metaKey || g.event.ctrlKey)) ? "copy_node" : "move_node", r = l, "move_node" === q && "a" === y && g.data.origin && g.data.origin === v && k === v.get_parent(g.data.nodes[o]) && (s = v.get_node(k), r > a.inArray(g.data.nodes[o], s.children) && (r -= 1)), n = n && (v && v.settings && v.settings.dnd && v.settings.dnd.check_while_dragging === !1 || v.check(q, g.data.origin && g.data.origin !== v ? g.data.origin.get_node(g.data.nodes[o]) : g.data.nodes[o], k, r, {
                                            dnd: !0,
                                            ref: v.get_node(w.parent()),
                                            pos: y,
                                            is_multi: g.data.origin && g.data.origin !== v,
                                            is_foreign: !g.data.origin
                                        })), !n) {
                                    v && v.last_error && (c = v.last_error());
                                    break
                                }
                                return "i" === y && w.parent().is(".jstree-closed") && v.settings.dnd.open_timeout && (d = setTimeout(function (a, b) {
                                    return function () {
                                        a.openNode(b)
                                    }
                                }(v, w), v.settings.dnd.open_timeout)), n ? (b = {
                                    ins: v,
                                    par: k,
                                    pos: "i" !== y || "last" !== t || 0 !== l || v.is_loaded(u) ? l : "last"
                                }, e.css({
                                    left: h + "px",
                                    top: i + "px"
                                }).show(), g.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"), c = {}, m = !0, !1) : void 0
                            }), m === !0))return
                    } else {
                        for (n = !0, o = 0, p = g.data.nodes.length; p > o && (n = n && v.check(g.data.origin && (g.data.origin.settings.dnd.always_copy || g.data.origin.settings.dnd.copy && (g.event.metaKey || g.event.ctrlKey)) ? "copy_node" : "move_node", g.data.origin && g.data.origin !== v ? g.data.origin.get_node(g.data.nodes[o]) : g.data.nodes[o], "#", "last", {
                                dnd: !0,
                                ref: v.get_node("#"),
                                pos: "i",
                                is_multi: g.data.origin && g.data.origin !== v,
                                is_foreign: !g.data.origin
                            }), n); o++);
                        if (n)return b = {
                            ins: v,
                            par: "#",
                            pos: "last"
                        }, e.hide(), void g.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok")
                    }
                    b = !1, g.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"), e.hide()
                }
            }).on("dnd_scroll.vakata.jstree", function (a, c) {
                c && c.data && c.data.jstree && (e.hide(), b = !1, c.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))
            }).on("dnd_stop.vakata.jstree", function (f, g) {
                if (d && clearTimeout(d), g && g.data && g.data.jstree) {
                    e.hide().detach();
                    var h, i, j = [];
                    if (b) {
                        for (h = 0, i = g.data.nodes.length; i > h; h++)j[h] = g.data.origin ? g.data.origin.get_node(g.data.nodes[h]) : g.data.nodes[h], g.data.origin && (j[h].instance = g.data.origin);
                        for (b.ins[g.data.origin && (g.data.origin.settings.dnd.always_copy || g.data.origin.settings.dnd.copy && (g.event.metaKey || g.event.ctrlKey)) ? "copy_node" : "move_node"](j, b.par, b.pos), h = 0, i = j.length; i > h; h++)j[h].instance && (j[h].instance = null)
                    } else h = a(g.event.target).closest(".jstree"), h.length && c && c.error && "check" === c.error && (h = h.jstree(!0), h && h.settings.core.error.call(this, c))
                }
            }).on("keyup.jstree keydown.jstree", function (b, c) {
                c = a.vakata.dnd._get(), c && c.data && c.data.jstree && c.helper.find(".jstree-copy").first()[c.data.origin && (c.data.origin.settings.dnd.always_copy || c.data.origin.settings.dnd.copy && (b.metaKey || b.ctrlKey)) ? "show" : "hide"]()
            })
        }), function (a) {
            var b = {
                element: !1,
                target: !1,
                is_down: !1,
                is_drag: !1,
                helper: !1,
                helper_w: 0,
                data: !1,
                init_x: 0,
                init_y: 0,
                scroll_l: 0,
                scroll_t: 0,
                scroll_e: !1,
                scroll_i: !1,
                is_touch: !1
            };
            a.vakata.dnd = {
                settings: {
                    scroll_speed: 10,
                    scroll_proximity: 20,
                    helper_left: 5,
                    helper_top: 10,
                    threshold: 5,
                    threshold_touch: 50
                }, _trigger: function (b, c) {
                    var d = a.vakata.dnd._get();
                    d.event = c, a(document).triggerHandler("dnd_" + b + ".vakata", d)
                }, _get: function () {
                    return {data: b.data, element: b.element, helper: b.helper}
                }, _clean: function () {
                    b.helper && b.helper.remove(), b.scroll_i && (clearInterval(b.scroll_i), b.scroll_i = !1), b = {
                        element: !1,
                        target: !1,
                        is_down: !1,
                        is_drag: !1,
                        helper: !1,
                        helper_w: 0,
                        data: !1,
                        init_x: 0,
                        init_y: 0,
                        scroll_l: 0,
                        scroll_t: 0,
                        scroll_e: !1,
                        scroll_i: !1,
                        is_touch: !1
                    }, a(document).off("mousemove.vakata.jstree touchmove.vakata.jstree", a.vakata.dnd.drag), a(document).off("mouseup.vakata.jstree touchend.vakata.jstree", a.vakata.dnd.stop)
                }, _scroll: function (c) {
                    if (!b.scroll_e || !b.scroll_l && !b.scroll_t)return b.scroll_i && (clearInterval(b.scroll_i), b.scroll_i = !1), !1;
                    if (!b.scroll_i)return b.scroll_i = setInterval(a.vakata.dnd._scroll, 100), !1;
                    if (c === !0)return !1;
                    var d = b.scroll_e.scrollTop(), e = b.scroll_e.scrollLeft();
                    b.scroll_e.scrollTop(d + b.scroll_t * a.vakata.dnd.settings.scroll_speed), b.scroll_e.scrollLeft(e + b.scroll_l * a.vakata.dnd.settings.scroll_speed), (d !== b.scroll_e.scrollTop() || e !== b.scroll_e.scrollLeft()) && a.vakata.dnd._trigger("scroll", b.scroll_e)
                }, start: function (c, d, e) {
                    "touchstart" === c.type && c.originalEvent && c.originalEvent.changedTouches && c.originalEvent.changedTouches[0] && (c.pageX = c.originalEvent.changedTouches[0].pageX, c.pageY = c.originalEvent.changedTouches[0].pageY, c.target = document.elementFromPoint(c.originalEvent.changedTouches[0].pageX - window.pageXOffset, c.originalEvent.changedTouches[0].pageY - window.pageYOffset)), b.is_drag && a.vakata.dnd.stop({});
                    try {
                        c.currentTarget.unselectable = "on", c.currentTarget.onselectstart = function () {
                            return !1
                        }, c.currentTarget.style && (c.currentTarget.style.MozUserSelect = "none")
                    } catch (f) {
                    }
                    return b.init_x = c.pageX, b.init_y = c.pageY, b.data = d, b.is_down = !0, b.element = c.currentTarget, b.target = c.target, b.is_touch = "touchstart" === c.type, e !== !1 && (b.helper = a("<div id='vakata-dnd'></div>").html(e).css({
                        display: "block",
                        margin: "0",
                        padding: "0",
                        position: "absolute",
                        top: "-2000px",
                        lineHeight: "16px",
                        zIndex: "10000"
                    })), a(document).on("mousemove.vakata.jstree touchmove.vakata.jstree", a.vakata.dnd.drag), a(document).on("mouseup.vakata.jstree touchend.vakata.jstree", a.vakata.dnd.stop), !1
                }, drag: function (c) {
                    if ("touchmove" === c.type && c.originalEvent && c.originalEvent.changedTouches && c.originalEvent.changedTouches[0] && (c.pageX = c.originalEvent.changedTouches[0].pageX, c.pageY = c.originalEvent.changedTouches[0].pageY, c.target = document.elementFromPoint(c.originalEvent.changedTouches[0].pageX - window.pageXOffset, c.originalEvent.changedTouches[0].pageY - window.pageYOffset)), b.is_down) {
                        if (!b.is_drag) {
                            if (!(Math.abs(c.pageX - b.init_x) > (b.is_touch ? a.vakata.dnd.settings.threshold_touch : a.vakata.dnd.settings.threshold) || Math.abs(c.pageY - b.init_y) > (b.is_touch ? a.vakata.dnd.settings.threshold_touch : a.vakata.dnd.settings.threshold)))return;
                            b.helper && (b.helper.appendTo("body"), b.helper_w = b.helper.outerWidth()), b.is_drag = !0, a.vakata.dnd._trigger("start", c)
                        }
                        var d = !1, e = !1, f = !1, g = !1, h = !1, i = !1, j = !1, k = !1, l = !1, m = !1;
                        return b.scroll_t = 0, b.scroll_l = 0, b.scroll_e = !1, a(a(c.target).parentsUntil("body").addBack().get().reverse()).filter(function () {
                            return /^auto|scroll$/.test(a(this).css("overflow")) && (this.scrollHeight > this.offsetHeight || this.scrollWidth > this.offsetWidth)
                        }).each(function () {
                            var d = a(this), e = d.offset();
                            return this.scrollHeight > this.offsetHeight && (e.top + d.height() - c.pageY < a.vakata.dnd.settings.scroll_proximity && (b.scroll_t = 1), c.pageY - e.top < a.vakata.dnd.settings.scroll_proximity && (b.scroll_t = -1)), this.scrollWidth > this.offsetWidth && (e.left + d.width() - c.pageX < a.vakata.dnd.settings.scroll_proximity && (b.scroll_l = 1), c.pageX - e.left < a.vakata.dnd.settings.scroll_proximity && (b.scroll_l = -1)), b.scroll_t || b.scroll_l ? (b.scroll_e = a(this), !1) : void 0
                        }), b.scroll_e || (d = a(document), e = a(window), f = d.height(), g = e.height(), h = d.width(), i = e.width(), j = d.scrollTop(), k = d.scrollLeft(), f > g && c.pageY - j < a.vakata.dnd.settings.scroll_proximity && (b.scroll_t = -1), f > g && g - (c.pageY - j) < a.vakata.dnd.settings.scroll_proximity && (b.scroll_t = 1), h > i && c.pageX - k < a.vakata.dnd.settings.scroll_proximity && (b.scroll_l = -1), h > i && i - (c.pageX - k) < a.vakata.dnd.settings.scroll_proximity && (b.scroll_l = 1), (b.scroll_t || b.scroll_l) && (b.scroll_e = d)), b.scroll_e && a.vakata.dnd._scroll(!0), b.helper && (l = parseInt(c.pageY + a.vakata.dnd.settings.helper_top, 10), m = parseInt(c.pageX + a.vakata.dnd.settings.helper_left, 10), f && l + 25 > f && (l = f - 50), h && m + b.helper_w > h && (m = h - (b.helper_w + 2)), b.helper.css({
                            left: m + "px",
                            top: l + "px"
                        })), a.vakata.dnd._trigger("move", c), !1
                    }
                }, stop: function (c) {
                    if ("touchend" === c.type && c.originalEvent && c.originalEvent.changedTouches && c.originalEvent.changedTouches[0] && (c.pageX = c.originalEvent.changedTouches[0].pageX, c.pageY = c.originalEvent.changedTouches[0].pageY, c.target = document.elementFromPoint(c.originalEvent.changedTouches[0].pageX - window.pageXOffset, c.originalEvent.changedTouches[0].pageY - window.pageYOffset)), b.is_drag)a.vakata.dnd._trigger("stop", c); else if ("touchend" === c.type && c.target === b.target) {
                        var d = setTimeout(function () {
                            a(c.target).click()
                        }, 100);
                        a(c.target).one("click", function () {
                            d && clearTimeout(d)
                        })
                    }
                    return a.vakata.dnd._clean(), !1
                }
            }
        }(a), a.jstree.defaults.search = {
            ajax: !1,
            fuzzy: !1,
            case_sensitive: !1,
            show_only_matches: !1,
            close_opened_onclear: !0,
            search_leaves_only: !1,
            search_callback: !1
        }, a.jstree.plugins.search = function (c, d) {
            this.bind = function () {
                d.bind.call(this), this._data.search.str = "", this._data.search.dom = a(), this._data.search.res = [], this._data.search.opn = [], this._data.search.som = !1, this.element.on("before_open.jstree", a.proxy(function (b, c) {
                    var d, e, f = this._data.search.res, g = [], h = a();
                    if (f && f.length && (this._data.search.dom = a(this.element[0].querySelectorAll("#" + a.map(f, function (b) {
                                return -1 !== "0123456789".indexOf(b[0]) ? "\\3" + b[0] + " " + b.substr(1).replace(a.jstree.idregex, "\\$&") : b.replace(a.jstree.idregex, "\\$&")
                            }).join(", #"))), this._data.search.dom.children(".jstree-anchor").addClass("jstree-search"), this._data.search.som && this._data.search.res.length)) {
                        for (d = 0, e = f.length; e > d; d++)g = g.concat(this.get_node(f[d]).parents);
                        g = a.vakata.array_remove_item(a.vakata.array_unique(g), "#"), h = g.length ? a(this.element[0].querySelectorAll("#" + a.map(g, function (b) {
                                return -1 !== "0123456789".indexOf(b[0]) ? "\\3" + b[0] + " " + b.substr(1).replace(a.jstree.idregex, "\\$&") : b.replace(a.jstree.idregex, "\\$&")
                            }).join(", #"))) : a(), this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function () {
                            return this.nextSibling
                        }).removeClass("jstree-last"), h = h.add(this._data.search.dom), h.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function () {
                            a(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")
                        })
                    }
                }, this)).on("search.jstree", a.proxy(function (b, c) {
                    this._data.search.som && c.nodes.length && (this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function () {
                        return this.nextSibling
                    }).removeClass("jstree-last"), c.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function () {
                        a(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")
                    }))
                }, this)).on("clear_search.jstree", a.proxy(function (a, b) {
                    this._data.search.som && b.nodes.length && this.element.find(".jstree-node").css("display", "").filter(".jstree-last").filter(function () {
                        return this.nextSibling
                    }).removeClass("jstree-last")
                }, this))
            }, this.search = function (c, d, e) {
                if (c === !1 || "" === a.trim(c.toString()))return this.clear_search();
                c = c.toString();
                var f = this.settings.search, g = f.ajax ? f.ajax : !1, h = null, i = [], j = [];
                return this._data.search.res.length && this.clear_search(), e === b && (e = f.show_only_matches), d || g === !1 ? (this._data.search.str = c, this._data.search.dom = a(), this._data.search.res = [], this._data.search.opn = [], this._data.search.som = e, h = new a.vakata.search(c, !0, {
                    caseSensitive: f.case_sensitive,
                    fuzzy: f.fuzzy
                }), a.each(this._model.data, function (a, b) {
                    b.text && (f.search_callback && f.search_callback.call(this, c, b) || !f.search_callback && h.search(b.text).isMatch) && (!f.search_leaves_only || b.state.loaded && 0 === b.children.length) && (i.push(a), j = j.concat(b.parents))
                }), i.length && (j = a.vakata.array_unique(j), this._search_open(j), this._data.search.dom = a(this.element[0].querySelectorAll("#" + a.map(i, function (b) {
                        return -1 !== "0123456789".indexOf(b[0]) ? "\\3" + b[0] + " " + b.substr(1).replace(a.jstree.idregex, "\\$&") : b.replace(a.jstree.idregex, "\\$&")
                    }).join(", #"))), this._data.search.res = i, this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")), void this.trigger("search", {
                    nodes: this._data.search.dom,
                    str: c,
                    res: this._data.search.res,
                    show_only_matches: e
                })) : a.isFunction(g) ? g.call(this, c, a.proxy(function (b) {
                    b && b.d && (b = b.d), this._load_nodes(a.isArray(b) ? a.vakata.array_unique(b) : [], function () {
                        this.search(c, !0, e)
                    }, !0)
                }, this)) : (g = a.extend({}, g), g.data || (g.data = {}), g.data.str = c, a.ajax(g).fail(a.proxy(function () {
                    this._data.core.last_error = {
                        error: "ajax",
                        plugin: "search",
                        id: "search_01",
                        reason: "Could not load search parents",
                        data: JSON.stringify(g)
                    }, this.settings.core.error.call(this, this._data.core.last_error)
                }, this)).done(a.proxy(function (b) {
                    b && b.d && (b = b.d), this._load_nodes(a.isArray(b) ? a.vakata.array_unique(b) : [], function () {
                        this.search(c, !0, e)
                    }, !0);
                }, this)))
            }, this.clear_search = function () {
                this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"), this.settings.search.close_opened_onclear && this.closeNode(this._data.search.opn, 0), this.trigger("clear_search", {
                    nodes: this._data.search.dom,
                    str: this._data.search.str,
                    res: this._data.search.res
                }), this._data.search.str = "", this._data.search.res = [], this._data.search.opn = [], this._data.search.dom = a()
            }, this._search_open = function (b) {
                var c = this;
                a.each(b.concat([]), function (d, e) {
                    if ("#" === e)return !0;
                    try {
                        e = a("#" + e.replace(a.jstree.idregex, "\\$&"), c.element)
                    } catch (f) {
                    }
                    e && e.length && c.is_closed(e) && (c._data.search.opn.push(e[0].id), c.openNode(e, function () {
                        c._search_open(b)
                    }, 0))
                })
            }
        }, function (a) {
            a.vakata.search = function (a, b, c) {
                c = c || {}, c.fuzzy !== !1 && (c.fuzzy = !0), a = c.caseSensitive ? a : a.toLowerCase();
                var d, e, f, g, h = c.location || 0, i = c.distance || 100, j = c.threshold || .6, k = a.length;
                return k > 32 && (c.fuzzy = !1), c.fuzzy && (d = 1 << k - 1, e = function () {
                    var b = {}, c = 0;
                    for (c = 0; k > c; c++)b[a.charAt(c)] = 0;
                    for (c = 0; k > c; c++)b[a.charAt(c)] |= 1 << k - c - 1;
                    return b
                }(), f = function (a, b) {
                    var c = a / k, d = Math.abs(h - b);
                    return i ? c + d / i : d ? 1 : c
                }), g = function (b) {
                    if (b = c.caseSensitive ? b : b.toLowerCase(), a === b || -1 !== b.indexOf(a))return {
                        isMatch: !0,
                        score: 0
                    };
                    if (!c.fuzzy)return {isMatch: !1, score: 1};
                    var g, i, l, m, n, o, p, q, r, s = b.length, t = j, u = b.indexOf(a, h), v = k + s, w = 1, x = [];
                    for (-1 !== u && (t = Math.min(f(0, u), t), u = b.lastIndexOf(a, h + k), -1 !== u && (t = Math.min(f(0, u), t))), u = -1, g = 0; k > g; g++) {
                        for (l = 0, m = v; m > l;)f(g, h + m) <= t ? l = m : v = m, m = Math.floor((v - l) / 2 + l);
                        for (v = m, o = Math.max(1, h - m + 1), p = Math.min(h + m, s) + k, q = new Array(p + 2), q[p + 1] = (1 << g) - 1, i = p; i >= o; i--)if (r = e[b.charAt(i - 1)], 0 === g ? q[i] = (q[i + 1] << 1 | 1) & r : q[i] = (q[i + 1] << 1 | 1) & r | ((n[i + 1] | n[i]) << 1 | 1) | n[i + 1], q[i] & d && (w = f(g, i - 1), t >= w)) {
                            if (t = w, u = i - 1, x.push(u), !(u > h))break;
                            o = Math.max(1, 2 * h - u)
                        }
                        if (f(g + 1, h) > t)break;
                        n = q
                    }
                    return {isMatch: u >= 0, score: w}
                }, b === !0 ? {search: g} : g(b)
            }
        }(a), a.jstree.defaults.sort = function (a, b) {
            return this.get_text(a) > this.get_text(b) ? 1 : -1
        }, a.jstree.plugins.sort = function (b, c) {
            this.bind = function () {
                c.bind.call(this), this.element.on("model.jstree", a.proxy(function (a, b) {
                    this.sort(b.parent, !0)
                }, this)).on("rename_node.jstree create_node.jstree", a.proxy(function (a, b) {
                    this.sort(b.parent || b.node.parent, !1), this.redraw_node(b.parent || b.node.parent, !0)
                }, this)).on("move_node.jstree copy_node.jstree", a.proxy(function (a, b) {
                    this.sort(b.parent, !1), this.redraw_node(b.parent, !0)
                }, this))
            }, this.sort = function (b, c) {
                var d, e;
                if (b = this.get_node(b), b && b.children && b.children.length && (b.children.sort(a.proxy(this.settings.sort, this)), c))for (d = 0, e = b.children_d.length; e > d; d++)this.sort(b.children_d[d], !1)
            }
        };
        var n = !1;
        a.jstree.defaults.state = {
            key: "jstree",
            events: "changed.jstree openNode.jstree closeNode.jstree",
            ttl: !1,
            filter: !1
        }, a.jstree.plugins.state = function (b, c) {
            this.bind = function () {
                c.bind.call(this);
                var b = a.proxy(function () {
                    this.element.on(this.settings.state.events, a.proxy(function () {
                        n && clearTimeout(n), n = setTimeout(a.proxy(function () {
                            this.save_state()
                        }, this), 100)
                    }, this))
                }, this);
                this.element.on("ready.jstree", a.proxy(function (a, c) {
                    this.element.one("restore_state.jstree", b), this.restore_state() || b()
                }, this))
            }, this.save_state = function () {
                var b = {state: this.get_state(), ttl: this.settings.state.ttl, sec: +new Date};
                a.vakata.storage.set(this.settings.state.key, JSON.stringify(b))
            }, this.restore_state = function () {
                var b = a.vakata.storage.get(this.settings.state.key);
                if (b)try {
                    b = JSON.parse(b)
                } catch (c) {
                    return !1
                }
                return b && b.ttl && b.sec && +new Date - b.sec > b.ttl ? !1 : (b && b.state && (b = b.state), b && a.isFunction(this.settings.state.filter) && (b = this.settings.state.filter.call(this, b)), b ? (this.element.one("set_state.jstree", function (c, d) {
                    d.instance.trigger("restore_state", {state: a.extend(!0, {}, b)})
                }), this.set_state(b), !0) : !1)
            }, this.clear_state = function () {
                return a.vakata.storage.del(this.settings.state.key)
            }
        }, function (a, b) {
            a.vakata.storage = {
                set: function (a, b) {
                    return window.localStorage.setItem(a, b)
                }, get: function (a) {
                    return window.localStorage.getItem(a)
                }, del: function (a) {
                    return window.localStorage.removeItem(a)
                }
            }
        }(a), a.jstree.defaults.types = {"#": {}, "default": {}}, a.jstree.plugins.types = function (c, d) {
            this.init = function (a, c) {
                var e, f;
                if (c && c.types && c.types["default"])for (e in c.types)if ("default" !== e && "#" !== e && c.types.hasOwnProperty(e))for (f in c.types["default"])c.types["default"].hasOwnProperty(f) && c.types[e][f] === b && (c.types[e][f] = c.types["default"][f]);
                d.init.call(this, a, c), this._model.data["#"].type = "#"
            }, this.refresh = function (a, b) {
                d.refresh.call(this, a, b), this._model.data["#"].type = "#"
            }, this.bind = function () {
                this.element.on("model.jstree", a.proxy(function (a, c) {
                    var d, e, f = this._model.data, g = c.nodes, h = this.settings.types, i = "default";
                    for (d = 0, e = g.length; e > d; d++)i = "default", f[g[d]].original && f[g[d]].original.type && h[f[g[d]].original.type] && (i = f[g[d]].original.type), f[g[d]].data && f[g[d]].data.jstree && f[g[d]].data.jstree.type && h[f[g[d]].data.jstree.type] && (i = f[g[d]].data.jstree.type), f[g[d]].type = i, f[g[d]].icon === !0 && h[i].icon !== b && (f[g[d]].icon = h[i].icon);
                    f["#"].type = "#"
                }, this)), d.bind.call(this)
            }, this.get_json = function (b, c, e) {
                var f, g, h = this._model.data, i = c ? a.extend(!0, {}, c, {no_id: !1}) : {}, j = d.get_json.call(this, b, i, e);
                if (j === !1)return !1;
                if (a.isArray(j))for (f = 0, g = j.length; g > f; f++)j[f].type = j[f].id && h[j[f].id] && h[j[f].id].type ? h[j[f].id].type : "default", c && c.no_id && (delete j[f].id, j[f].li_attr && j[f].li_attr.id && delete j[f].li_attr.id); else j.type = j.id && h[j.id] && h[j.id].type ? h[j.id].type : "default", c && c.no_id && (j = this._delete_ids(j));
                return j
            }, this._delete_ids = function (b) {
                if (a.isArray(b)) {
                    for (var c = 0, d = b.length; d > c; c++)b[c] = this._delete_ids(b[c]);
                    return b
                }
                return delete b.id, b.li_attr && b.li_attr.id && delete b.li_attr.id, b.children && a.isArray(b.children) && (b.children = this._delete_ids(b.children)), b
            }, this.check = function (c, e, f, g, h) {
                if (d.check.call(this, c, e, f, g, h) === !1)return !1;
                e = e && e.id ? e : this.get_node(e), f = f && f.id ? f : this.get_node(f);
                var i, j, k, l, m = e && e.id ? a.jstree.reference(e.id) : null;
                switch (m = m && m._model && m._model.data ? m._model.data : null, c) {
                    case"create_node":
                    case"move_node":
                    case"copy_node":
                        if ("move_node" !== c || -1 === a.inArray(e.id, f.children)) {
                            if (i = this.get_rules(f), i.max_children !== b && -1 !== i.max_children && i.max_children === f.children.length)return this._data.core.last_error = {
                                error: "check",
                                plugin: "types",
                                id: "types_01",
                                reason: "max_children prevents function: " + c,
                                data: JSON.stringify({
                                    chk: c,
                                    pos: g,
                                    obj: e && e.id ? e.id : !1,
                                    par: f && f.id ? f.id : !1
                                })
                            }, !1;
                            if (i.valid_children !== b && -1 !== i.valid_children && -1 === a.inArray(e.type || "default", i.valid_children))return this._data.core.last_error = {
                                error: "check",
                                plugin: "types",
                                id: "types_02",
                                reason: "valid_children prevents function: " + c,
                                data: JSON.stringify({
                                    chk: c,
                                    pos: g,
                                    obj: e && e.id ? e.id : !1,
                                    par: f && f.id ? f.id : !1
                                })
                            }, !1;
                            if (m && e.children_d && e.parents) {
                                for (j = 0, k = 0, l = e.children_d.length; l > k; k++)j = Math.max(j, m[e.children_d[k]].parents.length);
                                j = j - e.parents.length + 1
                            }
                            (0 >= j || j === b) && (j = 1);
                            do {
                                if (i.max_depth !== b && -1 !== i.max_depth && i.max_depth < j)return this._data.core.last_error = {
                                    error: "check",
                                    plugin: "types",
                                    id: "types_03",
                                    reason: "max_depth prevents function: " + c,
                                    data: JSON.stringify({
                                        chk: c,
                                        pos: g,
                                        obj: e && e.id ? e.id : !1,
                                        par: f && f.id ? f.id : !1
                                    })
                                }, !1;
                                f = this.get_node(f.parent), i = this.get_rules(f), j++
                            } while (f)
                        }
                }
                return !0
            }, this.get_rules = function (a) {
                if (a = this.get_node(a), !a)return !1;
                var c = this.get_type(a, !0);
                return c.max_depth === b && (c.max_depth = -1), c.max_children === b && (c.max_children = -1), c.valid_children === b && (c.valid_children = -1), c
            }, this.get_type = function (b, c) {
                return b = this.get_node(b), b ? c ? a.extend({type: b.type}, this.settings.types[b.type]) : b.type : !1
            }, this.set_type = function (c, d) {
                var e, f, g, h, i;
                if (a.isArray(c)) {
                    for (c = c.slice(), f = 0, g = c.length; g > f; f++)this.set_type(c[f], d);
                    return !0
                }
                return e = this.settings.types, c = this.get_node(c), e[d] && c ? (h = c.type, i = this.get_icon(c), c.type = d, (i === !0 || e[h] && e[h].icon && i === e[h].icon) && this.set_icon(c, e[d].icon !== b ? e[d].icon : !0), !0) : !1
            }
        }, a.jstree.defaults.unique = {
            case_sensitive: !1, duplicate: function (a, b) {
                return a + " (" + b + ")"
            }
        }, a.jstree.plugins.unique = function (c, d) {
            this.check = function (b, c, e, f, g) {
                if (d.check.call(this, b, c, e, f, g) === !1)return !1;
                if (c = c && c.id ? c : this.get_node(c), e = e && e.id ? e : this.get_node(e), !e || !e.children)return !0;
                var h, i, j = "rename_node" === b ? f : c.text, k = [], l = this.settings.unique.case_sensitive, m = this._model.data;
                for (h = 0, i = e.children.length; i > h; h++)k.push(l ? m[e.children[h]].text : m[e.children[h]].text.toLowerCase());
                switch (l || (j = j.toLowerCase()), b) {
                    case"delete_node":
                        return !0;
                    case"rename_node":
                        return h = -1 === a.inArray(j, k) || c.text && c.text[l ? "toString" : "toLowerCase"]() === j, h || (this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_01",
                            reason: "Child with name " + j + " already exists. Preventing: " + b,
                            data: JSON.stringify({
                                chk: b,
                                pos: f,
                                obj: c && c.id ? c.id : !1,
                                par: e && e.id ? e.id : !1
                            })
                        }), h;
                    case"create_node":
                        return h = -1 === a.inArray(j, k), h || (this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_04",
                            reason: "Child with name " + j + " already exists. Preventing: " + b,
                            data: JSON.stringify({
                                chk: b,
                                pos: f,
                                obj: c && c.id ? c.id : !1,
                                par: e && e.id ? e.id : !1
                            })
                        }), h;
                    case"copy_node":
                        return h = -1 === a.inArray(j, k), h || (this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_02",
                            reason: "Child with name " + j + " already exists. Preventing: " + b,
                            data: JSON.stringify({
                                chk: b,
                                pos: f,
                                obj: c && c.id ? c.id : !1,
                                par: e && e.id ? e.id : !1
                            })
                        }), h;
                    case"move_node":
                        return h = c.parent === e.id || -1 === a.inArray(j, k), h || (this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_03",
                            reason: "Child with name " + j + " already exists. Preventing: " + b,
                            data: JSON.stringify({
                                chk: b,
                                pos: f,
                                obj: c && c.id ? c.id : !1,
                                par: e && e.id ? e.id : !1
                            })
                        }), h
                }
                return !0
            }, this.create_node = function (c, e, f, g, h) {
                if (!e || e.text === b) {
                    if (null === c && (c = "#"), c = this.get_node(c), !c)return d.create_node.call(this, c, e, f, g, h);
                    if (f = f === b ? "last" : f, !f.toString().match(/^(before|after)$/) && !h && !this.is_loaded(c))return d.create_node.call(this, c, e, f, g, h);
                    e || (e = {});
                    var i, j, k, l, m, n = this._model.data, o = this.settings.unique.case_sensitive, p = this.settings.unique.duplicate;
                    for (j = i = this.get_string("New node"), k = [], l = 0, m = c.children.length; m > l; l++)k.push(o ? n[c.children[l]].text : n[c.children[l]].text.toLowerCase());
                    for (l = 1; -1 !== a.inArray(o ? j : j.toLowerCase(), k);)j = p.call(this, i, ++l).toString();
                    e.text = j
                }
                return d.create_node.call(this, c, e, f, g, h)
            }
        };
        var o = document.createElement("DIV");
        o.setAttribute("unselectable", "on"), o.setAttribute("aria-hidden", !0), o.className = "jstree-wholerow", o.innerHTML = "&#160;", a.jstree.plugins.wholerow = function (b, c) {
            this.bind = function () {
                c.bind.call(this), this.element.on("ready.jstree set_state.jstree", a.proxy(function () {
                    this.hide_dots()
                }, this)).on("init.jstree loading.jstree ready.jstree", a.proxy(function () {
                    this.get_container_ul().addClass("jstree-wholerow-ul")
                }, this)).on("deselect_all.jstree", a.proxy(function (a, b) {
                    this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")
                }, this)).on("changed.jstree", a.proxy(function (a, b) {
                    this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");
                    var c, d, e = !1;
                    for (c = 0, d = b.selected.length; d > c; c++)e = this.get_node(b.selected[c], !0), e && e.length && e.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")
                }, this)).on("openNode.jstree", a.proxy(function (a, b) {
                    this.get_node(b.node, !0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")
                }, this)).on("hover_node.jstree dehover_node.jstree", a.proxy(function (a, b) {
                    "hover_node" === a.type && this.is_disabled(b.node) || this.get_node(b.node, !0).children(".jstree-wholerow")["hover_node" === a.type ? "addClass" : "removeClass"]("jstree-wholerow-hovered")
                }, this)).on("contextmenu.jstree", ".jstree-wholerow", a.proxy(function (b) {
                    b.preventDefault();
                    var c = a.Event("contextmenu", {
                        metaKey: b.metaKey,
                        ctrlKey: b.ctrlKey,
                        altKey: b.altKey,
                        shiftKey: b.shiftKey,
                        pageX: b.pageX,
                        pageY: b.pageY
                    });
                    a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c)
                }, this)).on("click.jstree", ".jstree-wholerow", function (b) {
                    b.stopImmediatePropagation();
                    var c = a.Event("click", {
                        metaKey: b.metaKey,
                        ctrlKey: b.ctrlKey,
                        altKey: b.altKey,
                        shiftKey: b.shiftKey
                    });
                    a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()
                }).on("click.jstree", ".jstree-leaf > .jstree-ocl", a.proxy(function (b) {
                    b.stopImmediatePropagation();
                    var c = a.Event("click", {
                        metaKey: b.metaKey,
                        ctrlKey: b.ctrlKey,
                        altKey: b.altKey,
                        shiftKey: b.shiftKey
                    });
                    a(b.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()
                }, this)).on("mouseover.jstree", ".jstree-wholerow, .jstree-icon", a.proxy(function (a) {
                    return a.stopImmediatePropagation(), this.is_disabled(a.currentTarget) || this.hover_node(a.currentTarget), !1
                }, this)).on("mouseleave.jstree", ".jstree-node", a.proxy(function (a) {
                    this.dehover_node(a.currentTarget)
                }, this))
            }, this.teardown = function () {
                this.settings.wholerow && this.element.find(".jstree-wholerow").remove(), c.teardown.call(this)
            }, this.redraw_node = function (b, d, e, f) {
                if (b = c.redraw_node.apply(this, arguments)) {
                    var g = o.cloneNode(!0);
                    -1 !== a.inArray(b.id, this._data.core.selected) && (g.className += " jstree-wholerow-clicked"), b.insertBefore(g, b.childNodes[0])
                }
                return b
            }
        }, function (a) {
            if (document.registerElement) {
                var b = Object.create(HTMLElement.prototype);
                b.createdCallback = function () {
                    var b, c = {core: {}, plugins: []};
                    for (b in a.jstree.plugins)a.jstree.plugins.hasOwnProperty(b) && this.attributes[b] && (c.plugins.push(b), this.getAttribute(b) && JSON.parse(this.getAttribute(b)) && (c[b] = JSON.parse(this.getAttribute(b))));
                    for (b in a.jstree.defaults.core)a.jstree.defaults.core.hasOwnProperty(b) && this.attributes[b] && (c.core[b] = JSON.parse(this.getAttribute(b)) || this.getAttribute(b));
                    jQuery(this).jstree(c)
                };
                try {
                    document.registerElement("vakata-jstree", {prototype: b})
                } catch (c) {
                }
            }
        }(jQuery)
    }
}), function () {
    var a = this, b = b || {};
    return b.game = null, b.WEBGL_RENDERER = 0, b.CANVAS_RENDERER = 1, b.VERSION = "v2.2.9", b._UID = 0, "undefined" != typeof Float32Array ? (b.Float32Array = Float32Array, b.Uint16Array = Uint16Array, b.Uint32Array = Uint32Array, b.ArrayBuffer = ArrayBuffer) : (b.Float32Array = Array, b.Uint16Array = Array), b.PI_2 = 2 * Math.PI, b.RAD_TO_DEG = 180 / Math.PI, b.DEG_TO_RAD = Math.PI / 180, b.RETINA_PREFIX = "@2x", b.DisplayObject = function () {
        this.position = new b.Point(0, 0), this.scale = new b.Point(1, 1), this.pivot = new b.Point(0, 0), this.rotation = 0, this.alpha = 1, this.visible = !0, this.hitArea = null, this.renderable = !1, this.parent = null, this.stage = null, this.worldAlpha = 1, this.worldTransform = new b.Matrix, this.worldPosition = new b.Point(0, 0), this.worldScale = new b.Point(1, 1), this.worldRotation = 0, this.filterArea = null, this._sr = 0, this._cr = 1, this._bounds = new b.Rectangle(0, 0, 1, 1), this._currentBounds = null, this._mask = null, this._cacheAsBitmap = !1, this._cacheIsDirty = !1
    }, b.DisplayObject.prototype.constructor = b.DisplayObject, b.DisplayObject.prototype = {
        destroy: function () {
            if (this.children) {
                for (var a = this.children.length; a--;)this.children[a].destroy();
                this.children = []
            }
            this.hitArea = null, this.parent = null, this.stage = null, this.worldTransform = null, this.filterArea = null, this.renderable = !1, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite()
        }, updateTransform: function (a) {
            if (!a && !this.parent && !this.game)return this;
            var c = this.parent;
            a ? c = a : this.parent || (c = this.game.world);
            var d, e, f, g, h, i, j = c.worldTransform, k = this.worldTransform;
            return this.rotation % b.PI_2 ? (this.rotation !== this.rotationCache && (this.rotationCache = this.rotation, this._sr = Math.sin(this.rotation), this._cr = Math.cos(this.rotation)), d = this._cr * this.scale.x, e = this._sr * this.scale.x, f = -this._sr * this.scale.y, g = this._cr * this.scale.y, h = this.position.x, i = this.position.y, (this.pivot.x || this.pivot.y) && (h -= this.pivot.x * d + this.pivot.y * f, i -= this.pivot.x * e + this.pivot.y * g), k.a = d * j.a + e * j.c, k.b = d * j.b + e * j.d, k.c = f * j.a + g * j.c, k.d = f * j.b + g * j.d, k.tx = h * j.a + i * j.c + j.tx, k.ty = h * j.b + i * j.d + j.ty) : (d = this.scale.x, g = this.scale.y, h = this.position.x - this.pivot.x * d, i = this.position.y - this.pivot.y * g, k.a = d * j.a, k.b = d * j.b, k.c = g * j.c, k.d = g * j.d, k.tx = h * j.a + i * j.c + j.tx, k.ty = h * j.b + i * j.d + j.ty), this.worldAlpha = this.alpha * c.worldAlpha, this.worldPosition.set(k.tx, k.ty), this.worldScale.set(this.scale.x * Math.sqrt(k.a * k.a + k.c * k.c), this.scale.y * Math.sqrt(k.b * k.b + k.d * k.d)), this.worldRotation = Math.atan2(-k.c, k.d), this._currentBounds = null, this.transformCallback && this.transformCallback.call(this.transformCallbackContext, k, j), this
        }, setStageReference: function (a) {
            return this.stage = a, this
        }, preUpdate: function () {
        }, generateTexture: function (a, c, d) {
            var e = this.getLocalBounds(), f = new b.RenderTexture(0 | e.width, 0 | e.height, d, c, a);
            return b.DisplayObject._tempMatrix.tx = -e.x, b.DisplayObject._tempMatrix.ty = -e.y, f.render(this, b.DisplayObject._tempMatrix), f
        }, updateCache: function () {
            return this._generateCachedSprite(), this
        }, toGlobal: function (a) {
            return this.updateTransform(), this.worldTransform.apply(a)
        }, toLocal: function (a, b) {
            return b && (a = b.toGlobal(a)), this.updateTransform(), this.worldTransform.applyInverse(a)
        }, _renderCachedSprite: function (a) {
            this._cachedSprite.worldAlpha = this.worldAlpha, a.gl ? b.Sprite.prototype._renderWebGL.call(this._cachedSprite, a) : b.Sprite.prototype._renderCanvas.call(this._cachedSprite, a)
        }, _generateCachedSprite: function () {
            this._cacheAsBitmap = !1;
            var a = this.getLocalBounds();
            if (a.width = Math.max(1, Math.ceil(a.width)), a.height = Math.max(1, Math.ceil(a.height)), this.updateTransform(), this._cachedSprite)this._cachedSprite.texture.resize(a.width, a.height); else {
                var c = new b.RenderTexture(a.width, a.height);
                this._cachedSprite = new b.Sprite(c), this._cachedSprite.worldTransform = this.worldTransform
            }
            var d = this._filters;
            this._filters = null, this._cachedSprite.filters = d, b.DisplayObject._tempMatrix.tx = -a.x, b.DisplayObject._tempMatrix.ty = -a.y, this._cachedSprite.texture.render(this, b.DisplayObject._tempMatrix, !0), this._cachedSprite.anchor.x = -(a.x / a.width), this._cachedSprite.anchor.y = -(a.y / a.height), this._filters = d, this._cacheAsBitmap = !0
        }, _destroyCachedSprite: function () {
            this._cachedSprite && (this._cachedSprite.texture.destroy(!0), this._cachedSprite = null)
        }
    }, b.DisplayObject.prototype.displayObjectUpdateTransform = b.DisplayObject.prototype.updateTransform, Object.defineProperties(b.DisplayObject.prototype, {
        x: {
            get: function () {
                return this.position.x
            }, set: function (a) {
                this.position.x = a
            }
        }, y: {
            get: function () {
                return this.position.y
            }, set: function (a) {
                this.position.y = a
            }
        }, worldVisible: {
            get: function () {
                if (this.visible) {
                    var a = this.parent;
                    do {
                        if (!a.visible)return !1;
                        a = a.parent
                    } while (a);
                    return !0
                }
                return !1
            }
        }, mask: {
            get: function () {
                return this._mask
            }, set: function (a) {
                this._mask && (this._mask.isMask = !1), this._mask = a, a && (this._mask.isMask = !0)
            }
        }, filters: {
            get: function () {
                return this._filters
            }, set: function (a) {
                if (Array.isArray(a)) {
                    for (var c = [], d = 0; d < a.length; d++)for (var e = a[d].passes, f = 0; f < e.length; f++)c.push(e[f]);
                    this._filterBlock = {target: this, filterPasses: c}
                }
                this._filters = a, this.blendMode && this.blendMode === b.blendModes.MULTIPLY && (this.blendMode = b.blendModes.NORMAL)
            }
        }, cacheAsBitmap: {
            get: function () {
                return this._cacheAsBitmap
            }, set: function (a) {
                this._cacheAsBitmap !== a && (a ? this._generateCachedSprite() : this._destroyCachedSprite(), this._cacheAsBitmap = a)
            }
        }
    }), b.DisplayObjectContainer = function () {
        b.DisplayObject.call(this), this.children = [], this.ignoreChildInput = !1
    }, b.DisplayObjectContainer.prototype = Object.create(b.DisplayObject.prototype), b.DisplayObjectContainer.prototype.constructor = b.DisplayObjectContainer, Object.defineProperty(b.DisplayObjectContainer.prototype, "width", {
        get: function () {
            return this.scale.x * this.getLocalBounds().width
        }, set: function (a) {
            var b = this.getLocalBounds().width;
            0 !== b ? this.scale.x = a / b : this.scale.x = 1, this._width = a
        }
    }), Object.defineProperty(b.DisplayObjectContainer.prototype, "height", {
        get: function () {
            return this.scale.y * this.getLocalBounds().height
        }, set: function (a) {
            var b = this.getLocalBounds().height;
            0 !== b ? this.scale.y = a / b : this.scale.y = 1, this._height = a
        }
    }), b.DisplayObjectContainer.prototype.addChild = function (a) {
        return this.addChildAt(a, this.children.length)
    }, b.DisplayObjectContainer.prototype.addChildAt = function (a, b) {
        if (b >= 0 && b <= this.children.length)return a.parent && a.parent.removeChild(a), a.parent = this, this.children.splice(b, 0, a), this.stage && a.setStageReference(this.stage), a;
        throw new Error(a + "addChildAt: The index " + b + " supplied is out of bounds " + this.children.length)
    }, b.DisplayObjectContainer.prototype.swapChildren = function (a, b) {
        if (a !== b) {
            var c = this.getChildIndex(a), d = this.getChildIndex(b);
            if (0 > c || 0 > d)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");
            this.children[c] = b, this.children[d] = a
        }
    }, b.DisplayObjectContainer.prototype.getChildIndex = function (a) {
        var b = this.children.indexOf(a);
        if (-1 === b)throw new Error("The supplied DisplayObject must be a child of the caller");
        return b
    }, b.DisplayObjectContainer.prototype.setChildIndex = function (a, b) {
        if (0 > b || b >= this.children.length)throw new Error("The supplied index is out of bounds");
        var c = this.getChildIndex(a);
        this.children.splice(c, 1), this.children.splice(b, 0, a)
    }, b.DisplayObjectContainer.prototype.getChildAt = function (a) {
        if (0 > a || a >= this.children.length)throw new Error("getChildAt: Supplied index " + a + " does not exist in the child list, or the supplied DisplayObject must be a child of the caller");
        return this.children[a]
    }, b.DisplayObjectContainer.prototype.removeChild = function (a) {
        var b = this.children.indexOf(a);
        if (-1 !== b)return this.removeChildAt(b)
    }, b.DisplayObjectContainer.prototype.removeChildAt = function (a) {
        var b = this.getChildAt(a);
        return this.stage && b.removeStageReference(), b.parent = void 0, this.children.splice(a, 1), b
    }, b.DisplayObjectContainer.prototype.removeChildren = function (a, b) {
        var c = a || 0, d = "number" == typeof b ? b : this.children.length, e = d - c;
        if (e > 0 && d >= e) {
            for (var f = this.children.splice(c, e), g = 0; g < f.length; g++) {
                var h = f[g];
                this.stage && h.removeStageReference(), h.parent = void 0
            }
            return f
        }
        if (0 === e && 0 === this.children.length)return [];
        throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")
    }, b.DisplayObjectContainer.prototype.updateTransform = function () {
        if (this.visible && (this.displayObjectUpdateTransform(), !this._cacheAsBitmap))for (var a = 0; a < this.children.length; a++)this.children[a].updateTransform()
    }, b.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform = b.DisplayObjectContainer.prototype.updateTransform, b.DisplayObjectContainer.prototype.getBounds = function () {
        if (0 === this.children.length)return b.EmptyRectangle;
        this.updateTransform();
        for (var a, c, d, e = 1 / 0, f = 1 / 0, g = -(1 / 0), h = -(1 / 0), i = !1, j = 0; j < this.children.length; j++) {
            var k = this.children[j];
            k.visible && (i = !0, a = this.children[j].getBounds(), e = e < a.x ? e : a.x, f = f < a.y ? f : a.y, c = a.width + a.x, d = a.height + a.y, g = g > c ? g : c, h = h > d ? h : d)
        }
        if (!i)return b.EmptyRectangle;
        var l = this._bounds;
        return l.x = e, l.y = f, l.width = g - e, l.height = h - f, l
    }, b.DisplayObjectContainer.prototype.getLocalBounds = function () {
        var a = this.worldTransform;
        this.worldTransform = b.identityMatrix;
        for (var c = 0; c < this.children.length; c++)this.children[c].updateTransform();
        var d = this.getBounds();
        for (this.worldTransform = a, c = 0; c < this.children.length; c++)this.children[c].updateTransform();
        return d
    }, b.DisplayObjectContainer.prototype.setStageReference = function (a) {
        this.stage = a;
        for (var b = 0; b < this.children.length; b++)this.children[b].setStageReference(a)
    }, b.DisplayObjectContainer.prototype.removeStageReference = function () {
        for (var a = 0; a < this.children.length; a++)this.children[a].removeStageReference();
        this.stage = null
    }, b.DisplayObjectContainer.prototype._renderWebGL = function (a) {
        if (this.visible && !(this.alpha <= 0)) {
            if (this._cacheAsBitmap)return void this._renderCachedSprite(a);
            var b;
            if (this._mask || this._filters) {
                for (this._filters && (a.spriteBatch.flush(), a.filterManager.pushFilter(this._filterBlock)), this._mask && (a.spriteBatch.stop(), a.maskManager.pushMask(this.mask, a), a.spriteBatch.start()), b = 0; b < this.children.length; b++)this.children[b]._renderWebGL(a);
                a.spriteBatch.stop(), this._mask && a.maskManager.popMask(this._mask, a), this._filters && a.filterManager.popFilter(), a.spriteBatch.start()
            } else for (b = 0; b < this.children.length; b++)this.children[b]._renderWebGL(a)
        }
    }, b.DisplayObjectContainer.prototype._renderCanvas = function (a) {
        if (this.visible !== !1 && 0 !== this.alpha) {
            if (this._cacheAsBitmap)return void this._renderCachedSprite(a);
            this._mask && a.maskManager.pushMask(this._mask, a);
            for (var b = 0; b < this.children.length; b++)this.children[b]._renderCanvas(a);
            this._mask && a.maskManager.popMask(a)
        }
    }, b.Sprite = function (a) {
        b.DisplayObjectContainer.call(this), this.anchor = new b.Point, this.texture = a || b.Texture.emptyTexture, this._width = 0, this._height = 0, this.tint = 16777215, this.cachedTint = -1, this.tintedTexture = null, this.blendMode = b.blendModes.NORMAL, this.shader = null, this.exists = !0, this.texture.baseTexture.hasLoaded && this.onTextureUpdate(), this.renderable = !0
    }, b.Sprite.prototype = Object.create(b.DisplayObjectContainer.prototype), b.Sprite.prototype.constructor = b.Sprite, Object.defineProperty(b.Sprite.prototype, "width", {
        get: function () {
            return this.scale.x * this.texture.frame.width
        }, set: function (a) {
            this.scale.x = a / this.texture.frame.width, this._width = a
        }
    }), Object.defineProperty(b.Sprite.prototype, "height", {
        get: function () {
            return this.scale.y * this.texture.frame.height
        }, set: function (a) {
            this.scale.y = a / this.texture.frame.height, this._height = a
        }
    }), b.Sprite.prototype.setTexture = function (a, b) {
        void 0 !== b && this.texture.baseTexture.destroy(), this.texture.baseTexture.skipRender = !1, this.texture = a, this.texture.valid = !0, this.cachedTint = -1
    }, b.Sprite.prototype.onTextureUpdate = function () {
        this._width && (this.scale.x = this._width / this.texture.frame.width), this._height && (this.scale.y = this._height / this.texture.frame.height)
    }, b.Sprite.prototype.getBounds = function (a) {
        var b = this.texture.frame.width, c = this.texture.frame.height, d = b * (1 - this.anchor.x), e = b * -this.anchor.x, f = c * (1 - this.anchor.y), g = c * -this.anchor.y, h = a || this.worldTransform, i = h.a, j = h.b, k = h.c, l = h.d, m = h.tx, n = h.ty, o = -(1 / 0), p = -(1 / 0), q = 1 / 0, r = 1 / 0;
        if (0 === j && 0 === k) {
            if (0 > i) {
                i *= -1;
                var s = d;
                d = -e, e = -s
            }
            if (0 > l) {
                l *= -1;
                var s = f;
                f = -g, g = -s
            }
            q = i * e + m, o = i * d + m, r = l * g + n, p = l * f + n
        } else {
            var t = i * e + k * g + m, u = l * g + j * e + n, v = i * d + k * g + m, w = l * g + j * d + n, x = i * d + k * f + m, y = l * f + j * d + n, z = i * e + k * f + m, A = l * f + j * e + n;
            q = q > t ? t : q, q = q > v ? v : q, q = q > x ? x : q, q = q > z ? z : q, r = r > u ? u : r, r = r > w ? w : r, r = r > y ? y : r, r = r > A ? A : r, o = t > o ? t : o, o = v > o ? v : o, o = x > o ? x : o, o = z > o ? z : o, p = u > p ? u : p, p = w > p ? w : p, p = y > p ? y : p, p = A > p ? A : p
        }
        var B = this._bounds;
        return B.x = q, B.width = o - q, B.y = r, B.height = p - r, this._currentBounds = B, B
    }, b.Sprite.prototype._renderWebGL = function (a, b) {
        if (this.visible && !(this.alpha <= 0) && this.renderable) {
            var c = this.worldTransform;
            if (b && (c = b), this._mask || this._filters) {
                var d = a.spriteBatch;
                this._filters && (d.flush(), a.filterManager.pushFilter(this._filterBlock)), this._mask && (d.stop(), a.maskManager.pushMask(this.mask, a), d.start()), d.render(this);
                for (var e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(a);
                d.stop(), this._mask && a.maskManager.popMask(this._mask, a), this._filters && a.filterManager.popFilter(), d.start()
            } else {
                a.spriteBatch.render(this);
                for (var e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(a, c)
            }
        }
    }, b.Sprite.prototype._renderCanvas = function (a, c) {
        if (!(!this.visible || 0 === this.alpha || !this.renderable || this.texture.crop.width <= 0 || this.texture.crop.height <= 0)) {
            var d = this.worldTransform;
            if (c && (d = c), this.blendMode !== a.currentBlendMode && (a.currentBlendMode = this.blendMode, a.context.globalCompositeOperation = b.blendModesCanvas[a.currentBlendMode]), this._mask && a.maskManager.pushMask(this._mask, a), this.texture.valid) {
                var e = this.texture.baseTexture.resolution / a.resolution;
                a.context.globalAlpha = this.worldAlpha, a.smoothProperty && a.scaleMode !== this.texture.baseTexture.scaleMode && (a.scaleMode = this.texture.baseTexture.scaleMode, a.context[a.smoothProperty] = a.scaleMode === b.scaleModes.LINEAR);
                var f = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width, g = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height, h = d.tx * a.resolution + a.shakeX, i = d.ty * a.resolution + a.shakeY;
                a.roundPixels ? (a.context.setTransform(d.a, d.b, d.c, d.d, 0 | h, 0 | i), f |= 0, g |= 0) : a.context.setTransform(d.a, d.b, d.c, d.d, h, i);
                var j = this.texture.crop.width, k = this.texture.crop.height;
                if (f /= e, g /= e, 16777215 !== this.tint)(this.texture.requiresReTint || this.cachedTint !== this.tint) && (this.tintedTexture = b.CanvasTinter.getTintedTexture(this, this.tint), this.cachedTint = this.tint, this.texture.requiresReTint = !1), a.context.drawImage(this.tintedTexture, 0, 0, j, k, f, g, j / e, k / e); else {
                    var l = this.texture.crop.x, m = this.texture.crop.y;
                    a.context.drawImage(this.texture.baseTexture.source, l, m, j, k, f, g, j / e, k / e)
                }
            }
            for (var n = 0; n < this.children.length; n++)this.children[n]._renderCanvas(a);
            this._mask && a.maskManager.popMask(a)
        }
    }, b.SpriteBatch = function (a) {
        b.DisplayObjectContainer.call(this), this.textureThing = a, this.ready = !1
    }, b.SpriteBatch.prototype = Object.create(b.DisplayObjectContainer.prototype), b.SpriteBatch.prototype.constructor = b.SpriteBatch, b.SpriteBatch.prototype.initWebGL = function (a) {
        this.fastSpriteBatch = new b.WebGLFastSpriteBatch(a), this.ready = !0
    }, b.SpriteBatch.prototype.updateTransform = function () {
        this.displayObjectUpdateTransform()
    }, b.SpriteBatch.prototype._renderWebGL = function (a) {
        !this.visible || this.alpha <= 0 || !this.children.length || (this.ready || this.initWebGL(a.gl), this.fastSpriteBatch.gl !== a.gl && this.fastSpriteBatch.setContext(a.gl), a.spriteBatch.stop(), a.shaderManager.setShader(a.shaderManager.fastShader), this.fastSpriteBatch.begin(this, a), this.fastSpriteBatch.render(this), a.spriteBatch.start())
    }, b.SpriteBatch.prototype._renderCanvas = function (a) {
        if (this.visible && !(this.alpha <= 0) && this.children.length) {
            var b = a.context;
            b.globalAlpha = this.worldAlpha, this.displayObjectUpdateTransform();
            for (var c = this.worldTransform, d = !0, e = 0; e < this.children.length; e++) {
                var f = this.children[e];
                if (f.visible) {
                    var g = f.texture, h = g.frame;
                    if (b.globalAlpha = this.worldAlpha * f.alpha, f.rotation % (2 * Math.PI) === 0)d && (b.setTransform(c.a, c.b, c.c, c.d, c.tx, c.ty), d = !1), b.drawImage(g.baseTexture.source, h.x, h.y, h.width, h.height, f.anchor.x * (-h.width * f.scale.x) + f.position.x + .5 + a.shakeX | 0, f.anchor.y * (-h.height * f.scale.y) + f.position.y + .5 + a.shakeY | 0, h.width * f.scale.x, h.height * f.scale.y); else {
                        d || (d = !0), f.displayObjectUpdateTransform();
                        var i = f.worldTransform, j = i.tx * a.resolution + a.shakeX, k = i.ty * a.resolution + a.shakeY;
                        a.roundPixels ? b.setTransform(i.a, i.b, i.c, i.d, 0 | j, 0 | k) : b.setTransform(i.a, i.b, i.c, i.d, j, k), b.drawImage(g.baseTexture.source, h.x, h.y, h.width, h.height, f.anchor.x * -h.width + .5 | 0, f.anchor.y * -h.height + .5 | 0, h.width, h.height)
                    }
                }
            }
        }
    }, b.hex2rgb = function (a) {
        return [(a >> 16 & 255) / 255, (a >> 8 & 255) / 255, (255 & a) / 255]
    }, b.rgb2hex = function (a) {
        return (255 * a[0] << 16) + (255 * a[1] << 8) + 255 * a[2]
    }, b.canUseNewCanvasBlendModes = function () {
        if (void 0 === document)return !1;
        var a = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/", c = "AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==", d = new Image;
        d.src = a + "AP804Oa6" + c;
        var e = new Image;
        e.src = a + "/wCKxvRF" + c;
        var f = b.CanvasPool.create(this, 6, 1), g = f.getContext("2d");
        if (g.globalCompositeOperation = "multiply", g.drawImage(d, 0, 0), g.drawImage(e, 2, 0), !g.getImageData(2, 0, 1, 1))return !1;
        var h = g.getImageData(2, 0, 1, 1).data;
        return b.CanvasPool.remove(this), 255 === h[0] && 0 === h[1] && 0 === h[2]
    }, b.getNextPowerOfTwo = function (a) {
        if (a > 0 && 0 === (a & a - 1))return a;
        for (var b = 1; a > b;)b <<= 1;
        return b
    }, b.isPowerOfTwo = function (a, b) {
        return a > 0 && 0 === (a & a - 1) && b > 0 && 0 === (b & b - 1)
    }, b.CanvasPool = {
        create: function (a, c, d) {
            var e, f = b.CanvasPool.getFirst();
            if (-1 === f) {
                var g = {parent: a, canvas: document.createElement("canvas")};
                b.CanvasPool.pool.push(g), e = g.canvas
            } else b.CanvasPool.pool[f].parent = a, e = b.CanvasPool.pool[f].canvas;
            return void 0 !== c && (e.width = c, e.height = d), e
        }, getFirst: function () {
            for (var a = b.CanvasPool.pool, c = 0; c < a.length; c++)if (!a[c].parent)return c;
            return -1
        }, remove: function (a) {
            for (var c = b.CanvasPool.pool, d = 0; d < c.length; d++)c[d].parent === a && (c[d].parent = null, c[d].canvas.width = 1, c[d].canvas.height = 1)
        }, removeByCanvas: function (a) {
            for (var c = b.CanvasPool.pool, d = 0; d < c.length; d++)c[d].canvas === a && (c[d].parent = null, c[d].canvas.width = 1, c[d].canvas.height = 1)
        }, getTotal: function () {
            for (var a = b.CanvasPool.pool, c = 0, d = 0; d < a.length; d++)a[d].parent && c++;
            return c
        }, getFree: function () {
            for (var a = b.CanvasPool.pool, c = 0, d = 0; d < a.length; d++)a[d].parent || c++;
            return c
        }
    }, b.CanvasPool.pool = [], b.initDefaultShaders = function () {
    }, b.CompileVertexShader = function (a, c) {
        return b._CompileShader(a, c, a.VERTEX_SHADER)
    }, b.CompileFragmentShader = function (a, c) {
        return b._CompileShader(a, c, a.FRAGMENT_SHADER);
    }, b._CompileShader = function (a, b, c) {
        var d = b;
        Array.isArray(b) && (d = b.join("\n"));
        var e = a.createShader(c);
        return a.shaderSource(e, d), a.compileShader(e), a.getShaderParameter(e, a.COMPILE_STATUS) ? e : (window.console.log(a.getShaderInfoLog(e)), null)
    }, b.compileProgram = function (a, c, d) {
        var e = b.CompileFragmentShader(a, d), f = b.CompileVertexShader(a, c), g = a.createProgram();
        return a.attachShader(g, f), a.attachShader(g, e), a.linkProgram(g), a.getProgramParameter(g, a.LINK_STATUS) || (window.console.log(a.getProgramInfoLog(g)), window.console.log("Could not initialise shaders")), g
    }, b.PixiShader = function (a) {
        this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"], this.textureCount = 0, this.firstRun = !0, this.dirty = !0, this.attributes = [], this.init()
    }, b.PixiShader.prototype.constructor = b.PixiShader, b.PixiShader.prototype.init = function () {
        var a = this.gl, c = b.compileProgram(a, this.vertexSrc || b.PixiShader.defaultVertexSrc, this.fragmentSrc);
        a.useProgram(c), this.uSampler = a.getUniformLocation(c, "uSampler"), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.dimensions = a.getUniformLocation(c, "dimensions"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.aTextureCoord = a.getAttribLocation(c, "aTextureCoord"), this.colorAttribute = a.getAttribLocation(c, "aColor"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute];
        for (var d in this.uniforms)this.uniforms[d].uniformLocation = a.getUniformLocation(c, d);
        this.initUniforms(), this.program = c
    }, b.PixiShader.prototype.initUniforms = function () {
        this.textureCount = 1;
        var a, b = this.gl;
        for (var c in this.uniforms) {
            a = this.uniforms[c];
            var d = a.type;
            "sampler2D" === d ? (a._init = !1, null !== a.value && this.initSampler2D(a)) : "mat2" === d || "mat3" === d || "mat4" === d ? (a.glMatrix = !0, a.glValueLength = 1, "mat2" === d ? a.glFunc = b.uniformMatrix2fv : "mat3" === d ? a.glFunc = b.uniformMatrix3fv : "mat4" === d && (a.glFunc = b.uniformMatrix4fv)) : (a.glFunc = b["uniform" + d], "2f" === d || "2i" === d ? a.glValueLength = 2 : "3f" === d || "3i" === d ? a.glValueLength = 3 : "4f" === d || "4i" === d ? a.glValueLength = 4 : a.glValueLength = 1)
        }
    }, b.PixiShader.prototype.initSampler2D = function (a) {
        if (a.value && a.value.baseTexture && a.value.baseTexture.hasLoaded) {
            var b = this.gl;
            if (b.activeTexture(b["TEXTURE" + this.textureCount]), b.bindTexture(b.TEXTURE_2D, a.value.baseTexture._glTextures[b.id]), a.textureData) {
                var c = a.textureData, d = c.magFilter ? c.magFilter : b.LINEAR, e = c.minFilter ? c.minFilter : b.LINEAR, f = c.wrapS ? c.wrapS : b.CLAMP_TO_EDGE, g = c.wrapT ? c.wrapT : b.CLAMP_TO_EDGE, h = c.luminance ? b.LUMINANCE : b.RGBA;
                if (c.repeat && (f = b.REPEAT, g = b.REPEAT), b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL, !!c.flipY), c.width) {
                    var i = c.width ? c.width : 512, j = c.height ? c.height : 2, k = c.border ? c.border : 0;
                    b.texImage2D(b.TEXTURE_2D, 0, h, i, j, k, h, b.UNSIGNED_BYTE, null)
                } else b.texImage2D(b.TEXTURE_2D, 0, h, b.RGBA, b.UNSIGNED_BYTE, a.value.baseTexture.source);
                b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MAG_FILTER, d), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MIN_FILTER, e), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_S, f), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_T, g)
            }
            b.uniform1i(a.uniformLocation, this.textureCount), a._init = !0, this.textureCount++
        }
    }, b.PixiShader.prototype.syncUniforms = function () {
        this.textureCount = 1;
        var a, c = this.gl;
        for (var d in this.uniforms)a = this.uniforms[d], 1 === a.glValueLength ? a.glMatrix === !0 ? a.glFunc.call(c, a.uniformLocation, a.transpose, a.value) : a.glFunc.call(c, a.uniformLocation, a.value) : 2 === a.glValueLength ? a.glFunc.call(c, a.uniformLocation, a.value.x, a.value.y) : 3 === a.glValueLength ? a.glFunc.call(c, a.uniformLocation, a.value.x, a.value.y, a.value.z) : 4 === a.glValueLength ? a.glFunc.call(c, a.uniformLocation, a.value.x, a.value.y, a.value.z, a.value.w) : "sampler2D" === a.type && (a._init ? (c.activeTexture(c["TEXTURE" + this.textureCount]), a.value.baseTexture._dirty[c.id] ? b.instances[c.id].updateTexture(a.value.baseTexture) : c.bindTexture(c.TEXTURE_2D, a.value.baseTexture._glTextures[c.id]), c.uniform1i(a.uniformLocation, this.textureCount), this.textureCount++) : this.initSampler2D(a))
    }, b.PixiShader.prototype.destroy = function () {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
    }, b.PixiShader.defaultVertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec4 aColor;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = vec4(aColor.rgb * aColor.a, aColor.a);", "}"], b.PixiFastShader = function (a) {
        this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = aColor;", "}"], this.textureCount = 0, this.init()
    }, b.PixiFastShader.prototype.constructor = b.PixiFastShader, b.PixiFastShader.prototype.init = function () {
        var a = this.gl, c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
        a.useProgram(c), this.uSampler = a.getUniformLocation(c, "uSampler"), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.dimensions = a.getUniformLocation(c, "dimensions"), this.uMatrix = a.getUniformLocation(c, "uMatrix"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.aPositionCoord = a.getAttribLocation(c, "aPositionCoord"), this.aScale = a.getAttribLocation(c, "aScale"), this.aRotation = a.getAttribLocation(c, "aRotation"), this.aTextureCoord = a.getAttribLocation(c, "aTextureCoord"), this.colorAttribute = a.getAttribLocation(c, "aColor"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute], this.program = c
    }, b.PixiFastShader.prototype.destroy = function () {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
    }, b.StripShader = function (a) {
        this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec2 vTextureCoord;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "}"], this.init()
    }, b.StripShader.prototype.constructor = b.StripShader, b.StripShader.prototype.init = function () {
        var a = this.gl, c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
        a.useProgram(c), this.uSampler = a.getUniformLocation(c, "uSampler"), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.colorAttribute = a.getAttribLocation(c, "aColor"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.aTextureCoord = a.getAttribLocation(c, "aTextureCoord"), this.attributes = [this.aVertexPosition, this.aTextureCoord], this.translationMatrix = a.getUniformLocation(c, "translationMatrix"), this.alpha = a.getUniformLocation(c, "alpha"), this.program = c
    }, b.StripShader.prototype.destroy = function () {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null
    }, b.PrimitiveShader = function (a) {
        this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform float flipY;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}"], this.init()
    }, b.PrimitiveShader.prototype.constructor = b.PrimitiveShader, b.PrimitiveShader.prototype.init = function () {
        var a = this.gl, c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
        a.useProgram(c), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.tintColor = a.getUniformLocation(c, "tint"), this.flipY = a.getUniformLocation(c, "flipY"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.colorAttribute = a.getAttribLocation(c, "aColor"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = a.getUniformLocation(c, "translationMatrix"), this.alpha = a.getUniformLocation(c, "alpha"), this.program = c
    }, b.PrimitiveShader.prototype.destroy = function () {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
    }, b.ComplexPrimitiveShader = function (a) {
        this._UID = b._UID++, this.gl = a, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "uniform float flipY;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}"], this.init()
    }, b.ComplexPrimitiveShader.prototype.constructor = b.ComplexPrimitiveShader, b.ComplexPrimitiveShader.prototype.init = function () {
        var a = this.gl, c = b.compileProgram(a, this.vertexSrc, this.fragmentSrc);
        a.useProgram(c), this.projectionVector = a.getUniformLocation(c, "projectionVector"), this.offsetVector = a.getUniformLocation(c, "offsetVector"), this.tintColor = a.getUniformLocation(c, "tint"), this.color = a.getUniformLocation(c, "color"), this.flipY = a.getUniformLocation(c, "flipY"), this.aVertexPosition = a.getAttribLocation(c, "aVertexPosition"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = a.getUniformLocation(c, "translationMatrix"), this.alpha = a.getUniformLocation(c, "alpha"), this.program = c
    }, b.ComplexPrimitiveShader.prototype.destroy = function () {
        this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null
    }, b.glContexts = [], b.instances = [], b.WebGLRenderer = function (a) {
        this.game = a, b.defaultRenderer || (b.defaultRenderer = this), this.type = b.WEBGL_RENDERER, this.resolution = a.resolution, this.transparent = a.transparent, this.autoResize = !1, this.preserveDrawingBuffer = a.preserveDrawingBuffer, this.clearBeforeRender = a.clearBeforeRender, this.width = a.width, this.height = a.height, this.view = a.canvas, this._contextOptions = {
            alpha: this.transparent,
            antialias: a.antialias,
            premultipliedAlpha: this.transparent && "notMultiplied" !== this.transparent,
            stencil: !0,
            preserveDrawingBuffer: this.preserveDrawingBuffer
        }, this.projection = new b.Point, this.offset = new b.Point, this.shaderManager = new b.WebGLShaderManager, this.spriteBatch = new b.WebGLSpriteBatch, this.maskManager = new b.WebGLMaskManager, this.filterManager = new b.WebGLFilterManager, this.stencilManager = new b.WebGLStencilManager, this.blendModeManager = new b.WebGLBlendModeManager, this.renderSession = {}, this.renderSession.game = this.game, this.renderSession.gl = this.gl, this.renderSession.drawCount = 0, this.renderSession.shaderManager = this.shaderManager, this.renderSession.maskManager = this.maskManager, this.renderSession.filterManager = this.filterManager, this.renderSession.blendModeManager = this.blendModeManager, this.renderSession.spriteBatch = this.spriteBatch, this.renderSession.stencilManager = this.stencilManager, this.renderSession.renderer = this, this.renderSession.resolution = this.resolution, this.initContext(), this.mapBlendModes()
    }, b.WebGLRenderer.prototype.constructor = b.WebGLRenderer, b.WebGLRenderer.prototype.initContext = function () {
        var a = this.view.getContext("webgl", this._contextOptions) || this.view.getContext("experimental-webgl", this._contextOptions);
        if (this.gl = a, !a)throw new Error("This browser does not support webGL. Try using the canvas renderer");
        this.glContextId = a.id = b.WebGLRenderer.glContextId++, b.glContexts[this.glContextId] = a, b.instances[this.glContextId] = this, a.disable(a.DEPTH_TEST), a.disable(a.CULL_FACE), a.enable(a.BLEND), this.shaderManager.setContext(a), this.spriteBatch.setContext(a), this.maskManager.setContext(a), this.filterManager.setContext(a), this.blendModeManager.setContext(a), this.stencilManager.setContext(a), this.renderSession.gl = this.gl, this.resize(this.width, this.height)
    }, b.WebGLRenderer.prototype.render = function (a) {
        if (!this.contextLost) {
            var b = this.gl;
            b.viewport(0, 0, this.width, this.height), b.bindFramebuffer(b.FRAMEBUFFER, null), this.game.clearBeforeRender && (b.clearColor(a._bgColor.r, a._bgColor.g, a._bgColor.b, a._bgColor.a), b.clear(b.COLOR_BUFFER_BIT)), this.offset.x = this.game.camera._shake.x, this.offset.y = this.game.camera._shake.y, this.renderDisplayObject(a, this.projection)
        }
    }, b.WebGLRenderer.prototype.renderDisplayObject = function (a, c, d, e) {
        this.renderSession.blendModeManager.setBlendMode(b.blendModes.NORMAL), this.renderSession.drawCount = 0, this.renderSession.flipY = d ? -1 : 1, this.renderSession.projection = c, this.renderSession.offset = this.offset, this.spriteBatch.begin(this.renderSession), this.filterManager.begin(this.renderSession, d), a._renderWebGL(this.renderSession, e), this.spriteBatch.end()
    }, b.WebGLRenderer.prototype.resize = function (a, b) {
        this.width = a * this.resolution, this.height = b * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.gl.viewport(0, 0, this.width, this.height), this.projection.x = this.width / 2 / this.resolution, this.projection.y = -this.height / 2 / this.resolution
    }, b.WebGLRenderer.prototype.updateTexture = function (a) {
        if (!a.hasLoaded)return !1;
        var c = this.gl;
        return a._glTextures[c.id] || (a._glTextures[c.id] = c.createTexture()), c.bindTexture(c.TEXTURE_2D, a._glTextures[c.id]), c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL, a.premultipliedAlpha), c.texImage2D(c.TEXTURE_2D, 0, c.RGBA, c.RGBA, c.UNSIGNED_BYTE, a.source), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MAG_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR : c.NEAREST), a.mipmap && b.isPowerOfTwo(a.width, a.height) ? (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MIN_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR_MIPMAP_LINEAR : c.NEAREST_MIPMAP_NEAREST), c.generateMipmap(c.TEXTURE_2D)) : c.texParameteri(c.TEXTURE_2D, c.TEXTURE_MIN_FILTER, a.scaleMode === b.scaleModes.LINEAR ? c.LINEAR : c.NEAREST), a._powerOf2 ? (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.REPEAT), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.REPEAT)) : (c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_S, c.CLAMP_TO_EDGE), c.texParameteri(c.TEXTURE_2D, c.TEXTURE_WRAP_T, c.CLAMP_TO_EDGE)), a._dirty[c.id] = !1, !0
    }, b.WebGLRenderer.prototype.destroy = function () {
        b.glContexts[this.glContextId] = null, this.projection = null, this.offset = null, this.shaderManager.destroy(), this.spriteBatch.destroy(), this.maskManager.destroy(), this.filterManager.destroy(), this.shaderManager = null, this.spriteBatch = null, this.maskManager = null, this.filterManager = null, this.gl = null, this.renderSession = null, b.CanvasPool.remove(this), b.instances[this.glContextId] = null, b.WebGLRenderer.glContextId--
    }, b.WebGLRenderer.prototype.mapBlendModes = function () {
        var a = this.gl;
        if (!b.blendModesWebGL) {
            var c = [], d = b.blendModes;
            c[d.NORMAL] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.ADD] = [a.SRC_ALPHA, a.DST_ALPHA], c[d.MULTIPLY] = [a.DST_COLOR, a.ONE_MINUS_SRC_ALPHA], c[d.SCREEN] = [a.SRC_ALPHA, a.ONE], c[d.OVERLAY] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.DARKEN] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.LIGHTEN] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.COLOR_DODGE] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.COLOR_BURN] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.HARD_LIGHT] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.SOFT_LIGHT] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.DIFFERENCE] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.EXCLUSION] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.HUE] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.SATURATION] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.COLOR] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], c[d.LUMINOSITY] = [a.ONE, a.ONE_MINUS_SRC_ALPHA], b.blendModesWebGL = c
        }
    },b.WebGLRenderer.glContextId = 0,b.WebGLBlendModeManager = function () {
        this.currentBlendMode = 99999
    },b.WebGLBlendModeManager.prototype.constructor = b.WebGLBlendModeManager,b.WebGLBlendModeManager.prototype.setContext = function (a) {
        this.gl = a
    },b.WebGLBlendModeManager.prototype.setBlendMode = function (a) {
        if (this.currentBlendMode === a)return !1;
        this.currentBlendMode = a;
        var c = b.blendModesWebGL[this.currentBlendMode];
        return c && this.gl.blendFunc(c[0], c[1]), !0
    },b.WebGLBlendModeManager.prototype.destroy = function () {
        this.gl = null
    },b.WebGLMaskManager = function () {
    },b.WebGLMaskManager.prototype.constructor = b.WebGLMaskManager,b.WebGLMaskManager.prototype.setContext = function (a) {
        this.gl = a
    },b.WebGLMaskManager.prototype.pushMask = function (a, c) {
        var d = c.gl;
        a.dirty && b.WebGLGraphics.updateGraphics(a, d), void 0 !== a._webGL[d.id] && void 0 !== a._webGL[d.id].data && 0 !== a._webGL[d.id].data.length && c.stencilManager.pushStencil(a, a._webGL[d.id].data[0], c)
    },b.WebGLMaskManager.prototype.popMask = function (a, b) {
        var c = this.gl;
        void 0 !== a._webGL[c.id] && void 0 !== a._webGL[c.id].data && 0 !== a._webGL[c.id].data.length && b.stencilManager.popStencil(a, a._webGL[c.id].data[0], b)
    },b.WebGLMaskManager.prototype.destroy = function () {
        this.gl = null
    },b.WebGLStencilManager = function () {
        this.stencilStack = [], this.reverse = !0, this.count = 0
    },b.WebGLStencilManager.prototype.setContext = function (a) {
        this.gl = a
    },b.WebGLStencilManager.prototype.pushStencil = function (a, b, c) {
        var d = this.gl;
        this.bindGraphics(a, b, c), 0 === this.stencilStack.length && (d.enable(d.STENCIL_TEST), d.clear(d.STENCIL_BUFFER_BIT), this.reverse = !0, this.count = 0), this.stencilStack.push(b);
        var e = this.count;
        d.colorMask(!1, !1, !1, !1), d.stencilFunc(d.ALWAYS, 0, 255), d.stencilOp(d.KEEP, d.KEEP, d.INVERT), 1 === b.mode ? (d.drawElements(d.TRIANGLE_FAN, b.indices.length - 4, d.UNSIGNED_SHORT, 0), this.reverse ? (d.stencilFunc(d.EQUAL, 255 - e, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)) : (d.stencilFunc(d.EQUAL, e, 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)), d.drawElements(d.TRIANGLE_FAN, 4, d.UNSIGNED_SHORT, 2 * (b.indices.length - 4)), this.reverse ? d.stencilFunc(d.EQUAL, 255 - (e + 1), 255) : d.stencilFunc(d.EQUAL, e + 1, 255), this.reverse = !this.reverse) : (this.reverse ? (d.stencilFunc(d.EQUAL, e, 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)) : (d.stencilFunc(d.EQUAL, 255 - e, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)), d.drawElements(d.TRIANGLE_STRIP, b.indices.length, d.UNSIGNED_SHORT, 0), this.reverse ? d.stencilFunc(d.EQUAL, e + 1, 255) : d.stencilFunc(d.EQUAL, 255 - (e + 1), 255)), d.colorMask(!0, !0, !0, !0), d.stencilOp(d.KEEP, d.KEEP, d.KEEP), this.count++
    },b.WebGLStencilManager.prototype.bindGraphics = function (a, c, d) {
        this._currentGraphics = a;
        var e, f = this.gl, g = d.projection, h = d.offset;
        1 === c.mode ? (e = d.shaderManager.complexPrimitiveShader, d.shaderManager.setShader(e), f.uniform1f(e.flipY, d.flipY), f.uniformMatrix3fv(e.translationMatrix, !1, a.worldTransform.toArray(!0)), f.uniform2f(e.projectionVector, g.x, -g.y), f.uniform2f(e.offsetVector, -h.x, -h.y), f.uniform3fv(e.tintColor, b.hex2rgb(a.tint)), f.uniform3fv(e.color, c.color), f.uniform1f(e.alpha, a.worldAlpha * c.alpha), f.bindBuffer(f.ARRAY_BUFFER, c.buffer), f.vertexAttribPointer(e.aVertexPosition, 2, f.FLOAT, !1, 8, 0), f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, c.indexBuffer)) : (e = d.shaderManager.primitiveShader, d.shaderManager.setShader(e), f.uniformMatrix3fv(e.translationMatrix, !1, a.worldTransform.toArray(!0)), f.uniform1f(e.flipY, d.flipY), f.uniform2f(e.projectionVector, g.x, -g.y), f.uniform2f(e.offsetVector, -h.x, -h.y), f.uniform3fv(e.tintColor, b.hex2rgb(a.tint)), f.uniform1f(e.alpha, a.worldAlpha), f.bindBuffer(f.ARRAY_BUFFER, c.buffer), f.vertexAttribPointer(e.aVertexPosition, 2, f.FLOAT, !1, 24, 0), f.vertexAttribPointer(e.colorAttribute, 4, f.FLOAT, !1, 24, 8), f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, c.indexBuffer))
    },b.WebGLStencilManager.prototype.popStencil = function (a, b, c) {
        var d = this.gl;
        if (this.stencilStack.pop(), this.count--, 0 === this.stencilStack.length)d.disable(d.STENCIL_TEST); else {
            var e = this.count;
            this.bindGraphics(a, b, c), d.colorMask(!1, !1, !1, !1), 1 === b.mode ? (this.reverse = !this.reverse, this.reverse ? (d.stencilFunc(d.EQUAL, 255 - (e + 1), 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)) : (d.stencilFunc(d.EQUAL, e + 1, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)), d.drawElements(d.TRIANGLE_FAN, 4, d.UNSIGNED_SHORT, 2 * (b.indices.length - 4)), d.stencilFunc(d.ALWAYS, 0, 255), d.stencilOp(d.KEEP, d.KEEP, d.INVERT), d.drawElements(d.TRIANGLE_FAN, b.indices.length - 4, d.UNSIGNED_SHORT, 0), this.reverse ? d.stencilFunc(d.EQUAL, e, 255) : d.stencilFunc(d.EQUAL, 255 - e, 255)) : (this.reverse ? (d.stencilFunc(d.EQUAL, e + 1, 255), d.stencilOp(d.KEEP, d.KEEP, d.DECR)) : (d.stencilFunc(d.EQUAL, 255 - (e + 1), 255), d.stencilOp(d.KEEP, d.KEEP, d.INCR)), d.drawElements(d.TRIANGLE_STRIP, b.indices.length, d.UNSIGNED_SHORT, 0), this.reverse ? d.stencilFunc(d.EQUAL, e, 255) : d.stencilFunc(d.EQUAL, 255 - e, 255)), d.colorMask(!0, !0, !0, !0), d.stencilOp(d.KEEP, d.KEEP, d.KEEP)
        }
    },b.WebGLStencilManager.prototype.destroy = function () {
        this.stencilStack = null, this.gl = null
    },b.WebGLShaderManager = function () {
        this.maxAttibs = 10, this.attribState = [], this.tempAttribState = [];
        for (var a = 0; a < this.maxAttibs; a++)this.attribState[a] = !1;
        this.stack = []
    },b.WebGLShaderManager.prototype.constructor = b.WebGLShaderManager,b.WebGLShaderManager.prototype.setContext = function (a) {
        this.gl = a, this.primitiveShader = new b.PrimitiveShader(a), this.complexPrimitiveShader = new b.ComplexPrimitiveShader(a), this.defaultShader = new b.PixiShader(a), this.fastShader = new b.PixiFastShader(a), this.stripShader = new b.StripShader(a), this.setShader(this.defaultShader)
    },b.WebGLShaderManager.prototype.setAttribs = function (a) {
        var b;
        for (b = 0; b < this.tempAttribState.length; b++)this.tempAttribState[b] = !1;
        for (b = 0; b < a.length; b++) {
            var c = a[b];
            this.tempAttribState[c] = !0
        }
        var d = this.gl;
        for (b = 0; b < this.attribState.length; b++)this.attribState[b] !== this.tempAttribState[b] && (this.attribState[b] = this.tempAttribState[b], this.tempAttribState[b] ? d.enableVertexAttribArray(b) : d.disableVertexAttribArray(b))
    },b.WebGLShaderManager.prototype.setShader = function (a) {
        return this._currentId === a._UID ? !1 : (this._currentId = a._UID, this.currentShader = a, this.gl.useProgram(a.program), this.setAttribs(a.attributes), !0)
    },b.WebGLShaderManager.prototype.destroy = function () {
        this.attribState = null, this.tempAttribState = null, this.primitiveShader.destroy(), this.complexPrimitiveShader.destroy(), this.defaultShader.destroy(), this.fastShader.destroy(), this.stripShader.destroy(), this.gl = null
    },b.WebGLSpriteBatch = function () {
        this.vertSize = 5, this.size = 2e3;
        var a = 4 * this.size * 4 * this.vertSize, c = 6 * this.size;
        this.vertices = new b.ArrayBuffer(a), this.positions = new b.Float32Array(this.vertices), this.colors = new b.Uint32Array(this.vertices), this.indices = new b.Uint16Array(c), this.lastIndexCount = 0;
        for (var d = 0, e = 0; c > d; d += 6, e += 4)this.indices[d + 0] = e + 0, this.indices[d + 1] = e + 1, this.indices[d + 2] = e + 2, this.indices[d + 3] = e + 0, this.indices[d + 4] = e + 2, this.indices[d + 5] = e + 3;
        this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.dirty = !0, this.textures = [], this.blendModes = [], this.shaders = [], this.sprites = [], this.defaultShader = new b.AbstractFilter(["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"])
    },b.WebGLSpriteBatch.prototype.setContext = function (a) {
        this.gl = a, this.vertexBuffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, this.indices, a.STATIC_DRAW), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this.vertices, a.DYNAMIC_DRAW), this.currentBlendMode = 99999;
        var c = new b.PixiShader(a);
        c.fragmentSrc = this.defaultShader.fragmentSrc, c.uniforms = {}, c.init(), this.defaultShader.shaders[a.id] = c
    },b.WebGLSpriteBatch.prototype.begin = function (a) {
        this.renderSession = a, this.shader = this.renderSession.shaderManager.defaultShader, this.start()
    },b.WebGLSpriteBatch.prototype.end = function () {
        this.flush()
    },b.WebGLSpriteBatch.prototype.render = function (a, b) {
        var c = a.texture, d = a.worldTransform;
        b && (d = b), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = c.baseTexture);
        var e = c._uvs;
        if (e) {
            var f, g, h, i, j = a.anchor.x, k = a.anchor.y;
            if (c.trim) {
                var l = c.trim;
                g = l.x - j * l.width, f = g + c.crop.width, i = l.y - k * l.height, h = i + c.crop.height
            } else f = c.frame.width * (1 - j), g = c.frame.width * -j, h = c.frame.height * (1 - k), i = c.frame.height * -k;
            var m = 4 * this.currentBatchSize * this.vertSize, n = c.baseTexture.resolution, o = d.a / n, p = d.b / n, q = d.c / n, r = d.d / n, s = d.tx, t = d.ty, u = this.colors, v = this.positions;
            this.renderSession.roundPixels ? (v[m] = o * g + q * i + s | 0, v[m + 1] = r * i + p * g + t | 0, v[m + 5] = o * f + q * i + s | 0, v[m + 6] = r * i + p * f + t | 0, v[m + 10] = o * f + q * h + s | 0, v[m + 11] = r * h + p * f + t | 0, v[m + 15] = o * g + q * h + s | 0, v[m + 16] = r * h + p * g + t | 0) : (v[m] = o * g + q * i + s, v[m + 1] = r * i + p * g + t, v[m + 5] = o * f + q * i + s, v[m + 6] = r * i + p * f + t, v[m + 10] = o * f + q * h + s, v[m + 11] = r * h + p * f + t, v[m + 15] = o * g + q * h + s, v[m + 16] = r * h + p * g + t), v[m + 2] = e.x0, v[m + 3] = e.y0, v[m + 7] = e.x1, v[m + 8] = e.y1, v[m + 12] = e.x2, v[m + 13] = e.y2, v[m + 17] = e.x3, v[m + 18] = e.y3;
            var w = a.tint;
            u[m + 4] = u[m + 9] = u[m + 14] = u[m + 19] = (w >> 16) + (65280 & w) + ((255 & w) << 16) + (255 * a.worldAlpha << 24), this.sprites[this.currentBatchSize++] = a
        }
    },b.WebGLSpriteBatch.prototype.renderTilingSprite = function (a) {
        var c = a.tilingTexture;
        this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = c.baseTexture), a._uvs || (a._uvs = new b.TextureUvs);
        var d = a._uvs, e = c.baseTexture.width, f = c.baseTexture.height;
        a.tilePosition.x %= e * a.tileScaleOffset.x, a.tilePosition.y %= f * a.tileScaleOffset.y;
        var g = a.tilePosition.x / (e * a.tileScaleOffset.x), h = a.tilePosition.y / (f * a.tileScaleOffset.y), i = a.width / e / (a.tileScale.x * a.tileScaleOffset.x), j = a.height / f / (a.tileScale.y * a.tileScaleOffset.y);
        d.x0 = 0 - g, d.y0 = 0 - h, d.x1 = 1 * i - g, d.y1 = 0 - h, d.x2 = 1 * i - g, d.y2 = 1 * j - h, d.x3 = 0 - g, d.y3 = 1 * j - h;
        var k = a.tint, l = (k >> 16) + (65280 & k) + ((255 & k) << 16) + (255 * a.worldAlpha << 24), m = this.positions, n = this.colors, o = a.width, p = a.height, q = a.anchor.x, r = a.anchor.y, s = o * (1 - q), t = o * -q, u = p * (1 - r), v = p * -r, w = 4 * this.currentBatchSize * this.vertSize, x = c.baseTexture.resolution, y = a.worldTransform, z = y.a / x, A = y.b / x, B = y.c / x, C = y.d / x, D = y.tx, E = y.ty;
        m[w++] = z * t + B * v + D, m[w++] = C * v + A * t + E, m[w++] = d.x0, m[w++] = d.y0, n[w++] = l, m[w++] = z * s + B * v + D, m[w++] = C * v + A * s + E, m[w++] = d.x1, m[w++] = d.y1, n[w++] = l, m[w++] = z * s + B * u + D, m[w++] = C * u + A * s + E, m[w++] = d.x2, m[w++] = d.y2, n[w++] = l, m[w++] = z * t + B * u + D, m[w++] = C * u + A * t + E, m[w++] = d.x3, m[w++] = d.y3, n[w++] = l, this.sprites[this.currentBatchSize++] = a
    },b.WebGLSpriteBatch.prototype.flush = function () {
        if (0 !== this.currentBatchSize) {
            var a, c = this.gl;
            if (this.dirty) {
                this.dirty = !1, c.activeTexture(c.TEXTURE0), c.bindBuffer(c.ARRAY_BUFFER, this.vertexBuffer), c.bindBuffer(c.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a = this.defaultShader.shaders[c.id];
                var d = 4 * this.vertSize;
                c.vertexAttribPointer(a.aVertexPosition, 2, c.FLOAT, !1, d, 0), c.vertexAttribPointer(a.aTextureCoord, 2, c.FLOAT, !1, d, 8), c.vertexAttribPointer(a.colorAttribute, 4, c.UNSIGNED_BYTE, !0, d, 16)
            }
            if (this.currentBatchSize > .5 * this.size)c.bufferSubData(c.ARRAY_BUFFER, 0, this.vertices); else {
                var e = this.positions.subarray(0, 4 * this.currentBatchSize * this.vertSize);
                c.bufferSubData(c.ARRAY_BUFFER, 0, e)
            }
            for (var f, g, h, i, j = 0, k = 0, l = null, m = this.renderSession.blendModeManager.currentBlendMode, n = null, o = !1, p = !1, q = 0, r = this.currentBatchSize; r > q; q++) {
                i = this.sprites[q], f = i.tilingTexture ? i.tilingTexture.baseTexture : i.texture.baseTexture, g = i.blendMode, h = i.shader || this.defaultShader, o = m !== g, p = n !== h;
                var s = f.skipRender;
                if (s && i.children.length > 0 && (s = !1), (l !== f && !s || o || p) && (this.renderBatch(l, j, k), k = q, j = 0, l = f, o && (m = g, this.renderSession.blendModeManager.setBlendMode(m)), p)) {
                    n = h, a = n.shaders[c.id], a || (a = new b.PixiShader(c), a.fragmentSrc = n.fragmentSrc, a.uniforms = n.uniforms, a.init(), n.shaders[c.id] = a), this.renderSession.shaderManager.setShader(a), a.dirty && a.syncUniforms();
                    var t = this.renderSession.projection;
                    c.uniform2f(a.projectionVector, t.x, t.y);
                    var u = this.renderSession.offset;
                    c.uniform2f(a.offsetVector, u.x, u.y)
                }
                j++
            }
            this.renderBatch(l, j, k), this.currentBatchSize = 0
        }
    },b.WebGLSpriteBatch.prototype.renderBatch = function (a, b, c) {
        if (0 !== b) {
            var d = this.gl;
            if (a._dirty[d.id]) {
                if (!this.renderSession.renderer.updateTexture(a))return
            } else d.bindTexture(d.TEXTURE_2D, a._glTextures[d.id]);
            d.drawElements(d.TRIANGLES, 6 * b, d.UNSIGNED_SHORT, 6 * c * 2), this.renderSession.drawCount++
        }
    },b.WebGLSpriteBatch.prototype.stop = function () {
        this.flush(), this.dirty = !0
    },b.WebGLSpriteBatch.prototype.start = function () {
        this.dirty = !0
    },b.WebGLSpriteBatch.prototype.destroy = function () {
        this.vertices = null, this.indices = null, this.gl.deleteBuffer(this.vertexBuffer), this.gl.deleteBuffer(this.indexBuffer), this.currentBaseTexture = null, this.gl = null
    },b.WebGLFastSpriteBatch = function (a) {
        this.vertSize = 10, this.maxSize = 6e3, this.size = this.maxSize;
        var c = 4 * this.size * this.vertSize, d = 6 * this.maxSize;
        this.vertices = new b.Float32Array(c), this.indices = new b.Uint16Array(d), this.vertexBuffer = null, this.indexBuffer = null, this.lastIndexCount = 0;
        for (var e = 0, f = 0; d > e; e += 6, f += 4)this.indices[e + 0] = f + 0, this.indices[e + 1] = f + 1, this.indices[e + 2] = f + 2, this.indices[e + 3] = f + 0, this.indices[e + 4] = f + 2, this.indices[e + 5] = f + 3;
        this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.currentBlendMode = 0, this.renderSession = null, this.shader = null, this.matrix = null, this.setContext(a)
    },b.WebGLFastSpriteBatch.prototype.constructor = b.WebGLFastSpriteBatch,b.WebGLFastSpriteBatch.prototype.setContext = function (a) {
        this.gl = a, this.vertexBuffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, this.indices, a.STATIC_DRAW), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this.vertices, a.DYNAMIC_DRAW)
    },b.WebGLFastSpriteBatch.prototype.begin = function (a, b) {
        this.renderSession = b, this.shader = this.renderSession.shaderManager.fastShader, this.matrix = a.worldTransform.toArray(!0), this.start()
    },b.WebGLFastSpriteBatch.prototype.end = function () {
        this.flush()
    },b.WebGLFastSpriteBatch.prototype.render = function (a) {
        var b = a.children, c = b[0];
        if (c.texture._uvs) {
            this.currentBaseTexture = c.texture.baseTexture, c.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(), this.renderSession.blendModeManager.setBlendMode(c.blendMode));
            for (var d = 0, e = b.length; e > d; d++)this.renderSprite(b[d]);
            this.flush()
        }
    },b.WebGLFastSpriteBatch.prototype.renderSprite = function (a) {
        if (a.visible && (a.texture.baseTexture === this.currentBaseTexture || a.texture.baseTexture.skipRender || (this.flush(), this.currentBaseTexture = a.texture.baseTexture, a.texture._uvs))) {
            var b, c, d, e, f, g, h, i, j = this.vertices;
            if (b = a.texture._uvs, c = a.texture.frame.width, d = a.texture.frame.height,
                    a.texture.trim) {
                var k = a.texture.trim;
                f = k.x - a.anchor.x * k.width, e = f + a.texture.crop.width, h = k.y - a.anchor.y * k.height, g = h + a.texture.crop.height
            } else e = a.texture.frame.width * (1 - a.anchor.x), f = a.texture.frame.width * -a.anchor.x, g = a.texture.frame.height * (1 - a.anchor.y), h = a.texture.frame.height * -a.anchor.y;
            i = 4 * this.currentBatchSize * this.vertSize, j[i++] = f, j[i++] = h, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x0, j[i++] = b.y1, j[i++] = a.alpha, j[i++] = e, j[i++] = h, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x1, j[i++] = b.y1, j[i++] = a.alpha, j[i++] = e, j[i++] = g, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x2, j[i++] = b.y2, j[i++] = a.alpha, j[i++] = f, j[i++] = g, j[i++] = a.position.x, j[i++] = a.position.y, j[i++] = a.scale.x, j[i++] = a.scale.y, j[i++] = a.rotation, j[i++] = b.x3, j[i++] = b.y3, j[i++] = a.alpha, this.currentBatchSize++, this.currentBatchSize >= this.size && this.flush()
        }
    },b.WebGLFastSpriteBatch.prototype.flush = function () {
        if (0 !== this.currentBatchSize) {
            var a = this.gl;
            if (this.currentBaseTexture._glTextures[a.id] || this.renderSession.renderer.updateTexture(this.currentBaseTexture, a), a.bindTexture(a.TEXTURE_2D, this.currentBaseTexture._glTextures[a.id]), this.currentBatchSize > .5 * this.size)a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertices); else {
                var b = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize);
                a.bufferSubData(a.ARRAY_BUFFER, 0, b)
            }
            a.drawElements(a.TRIANGLES, 6 * this.currentBatchSize, a.UNSIGNED_SHORT, 0), this.currentBatchSize = 0, this.renderSession.drawCount++
        }
    },b.WebGLFastSpriteBatch.prototype.stop = function () {
        this.flush()
    },b.WebGLFastSpriteBatch.prototype.start = function () {
        var a = this.gl;
        a.activeTexture(a.TEXTURE0), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
        var b = this.renderSession.projection;
        a.uniform2f(this.shader.projectionVector, b.x, b.y), a.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix);
        var c = 4 * this.vertSize;
        a.vertexAttribPointer(this.shader.aVertexPosition, 2, a.FLOAT, !1, c, 0), a.vertexAttribPointer(this.shader.aPositionCoord, 2, a.FLOAT, !1, c, 8), a.vertexAttribPointer(this.shader.aScale, 2, a.FLOAT, !1, c, 16), a.vertexAttribPointer(this.shader.aRotation, 1, a.FLOAT, !1, c, 24), a.vertexAttribPointer(this.shader.aTextureCoord, 2, a.FLOAT, !1, c, 28), a.vertexAttribPointer(this.shader.colorAttribute, 1, a.FLOAT, !1, c, 36)
    },b.WebGLFilterManager = function () {
        this.filterStack = [], this.offsetX = 0, this.offsetY = 0
    },b.WebGLFilterManager.prototype.constructor = b.WebGLFilterManager,b.WebGLFilterManager.prototype.setContext = function (a) {
        this.gl = a, this.texturePool = [], this.initShaderBuffers()
    },b.WebGLFilterManager.prototype.begin = function (a, b) {
        this.renderSession = a, this.defaultShader = a.shaderManager.defaultShader;
        var c = this.renderSession.projection;
        this.width = 2 * c.x, this.height = 2 * -c.y, this.buffer = b
    },b.WebGLFilterManager.prototype.pushFilter = function (a) {
        var c = this.gl, d = this.renderSession.projection, e = this.renderSession.offset;
        a._filterArea = a.target.filterArea || a.target.getBounds(), a._previous_stencil_mgr = this.renderSession.stencilManager, this.renderSession.stencilManager = new b.WebGLStencilManager, this.renderSession.stencilManager.setContext(c), c.disable(c.STENCIL_TEST), this.filterStack.push(a);
        var f = a.filterPasses[0];
        this.offsetX += a._filterArea.x, this.offsetY += a._filterArea.y;
        var g = this.texturePool.pop();
        g ? g.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution) : g = new b.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), c.bindTexture(c.TEXTURE_2D, g.texture);
        var h = a._filterArea, i = f.padding;
        h.x -= i, h.y -= i, h.width += 2 * i, h.height += 2 * i, h.x < 0 && (h.x = 0), h.width > this.width && (h.width = this.width), h.y < 0 && (h.y = 0), h.height > this.height && (h.height = this.height), c.bindFramebuffer(c.FRAMEBUFFER, g.frameBuffer), c.viewport(0, 0, h.width * this.renderSession.resolution, h.height * this.renderSession.resolution), d.x = h.width / 2, d.y = -h.height / 2, e.x = -h.x, e.y = -h.y, c.colorMask(!0, !0, !0, !0), c.clearColor(0, 0, 0, 0), c.clear(c.COLOR_BUFFER_BIT), a._glFilterTexture = g
    },b.WebGLFilterManager.prototype.popFilter = function () {
        var a = this.gl, c = this.filterStack.pop(), d = c._filterArea, e = c._glFilterTexture, f = this.renderSession.projection, g = this.renderSession.offset;
        if (c.filterPasses.length > 1) {
            a.viewport(0, 0, d.width * this.renderSession.resolution, d.height * this.renderSession.resolution), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = 0, this.vertexArray[1] = d.height, this.vertexArray[2] = d.width, this.vertexArray[3] = d.height, this.vertexArray[4] = 0, this.vertexArray[5] = 0, this.vertexArray[6] = d.width, this.vertexArray[7] = 0, a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertexArray), a.bindBuffer(a.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = d.width / this.width, this.uvArray[5] = d.height / this.height, this.uvArray[6] = d.width / this.width, this.uvArray[7] = d.height / this.height, a.bufferSubData(a.ARRAY_BUFFER, 0, this.uvArray);
            var h = e, i = this.texturePool.pop();
            i || (i = new b.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution)), i.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), a.bindFramebuffer(a.FRAMEBUFFER, i.frameBuffer), a.clear(a.COLOR_BUFFER_BIT), a.disable(a.BLEND);
            for (var j = 0; j < c.filterPasses.length - 1; j++) {
                var k = c.filterPasses[j];
                a.bindFramebuffer(a.FRAMEBUFFER, i.frameBuffer), a.activeTexture(a.TEXTURE0), a.bindTexture(a.TEXTURE_2D, h.texture), this.applyFilterPass(k, d, d.width, d.height);
                var l = h;
                h = i, i = l
            }
            a.enable(a.BLEND), e = h, this.texturePool.push(i)
        }
        var m = c.filterPasses[c.filterPasses.length - 1];
        this.offsetX -= d.x, this.offsetY -= d.y;
        var n = this.width, o = this.height, p = 0, q = 0, r = this.buffer;
        if (0 === this.filterStack.length)a.colorMask(!0, !0, !0, !0); else {
            var s = this.filterStack[this.filterStack.length - 1];
            d = s._filterArea, n = d.width, o = d.height, p = d.x, q = d.y, r = s._glFilterTexture.frameBuffer
        }
        f.x = n / 2, f.y = -o / 2, g.x = p, g.y = q, d = c._filterArea;
        var t = d.x - p, u = d.y - q;
        a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = t, this.vertexArray[1] = u + d.height, this.vertexArray[2] = t + d.width, this.vertexArray[3] = u + d.height, this.vertexArray[4] = t, this.vertexArray[5] = u, this.vertexArray[6] = t + d.width, this.vertexArray[7] = u, a.bufferSubData(a.ARRAY_BUFFER, 0, this.vertexArray), a.bindBuffer(a.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = d.width / this.width, this.uvArray[5] = d.height / this.height, this.uvArray[6] = d.width / this.width, this.uvArray[7] = d.height / this.height, a.bufferSubData(a.ARRAY_BUFFER, 0, this.uvArray), a.viewport(0, 0, n * this.renderSession.resolution, o * this.renderSession.resolution), a.bindFramebuffer(a.FRAMEBUFFER, r), a.activeTexture(a.TEXTURE0), a.bindTexture(a.TEXTURE_2D, e.texture), this.renderSession.stencilManager && this.renderSession.stencilManager.destroy(), this.renderSession.stencilManager = c._previous_stencil_mgr, c._previous_stencil_mgr = null, this.renderSession.stencilManager.count > 0 ? a.enable(a.STENCIL_TEST) : a.disable(a.STENCIL_TEST), this.applyFilterPass(m, d, n, o), this.texturePool.push(e), c._glFilterTexture = null
    },b.WebGLFilterManager.prototype.applyFilterPass = function (a, c, d, e) {
        var f = this.gl, g = a.shaders[f.id];
        g || (g = new b.PixiShader(f), g.fragmentSrc = a.fragmentSrc, g.uniforms = a.uniforms, g.init(), a.shaders[f.id] = g), this.renderSession.shaderManager.setShader(g), f.uniform2f(g.projectionVector, d / 2, -e / 2), f.uniform2f(g.offsetVector, 0, 0), a.uniforms.dimensions && (a.uniforms.dimensions.value[0] = this.width, a.uniforms.dimensions.value[1] = this.height, a.uniforms.dimensions.value[2] = this.vertexArray[0], a.uniforms.dimensions.value[3] = this.vertexArray[5]), g.syncUniforms(), f.bindBuffer(f.ARRAY_BUFFER, this.vertexBuffer), f.vertexAttribPointer(g.aVertexPosition, 2, f.FLOAT, !1, 0, 0), f.bindBuffer(f.ARRAY_BUFFER, this.uvBuffer), f.vertexAttribPointer(g.aTextureCoord, 2, f.FLOAT, !1, 0, 0), f.bindBuffer(f.ARRAY_BUFFER, this.colorBuffer), f.vertexAttribPointer(g.colorAttribute, 2, f.FLOAT, !1, 0, 0), f.bindBuffer(f.ELEMENT_ARRAY_BUFFER, this.indexBuffer), f.drawElements(f.TRIANGLES, 6, f.UNSIGNED_SHORT, 0), this.renderSession.drawCount++
    },b.WebGLFilterManager.prototype.initShaderBuffers = function () {
        var a = this.gl;
        this.vertexBuffer = a.createBuffer(), this.uvBuffer = a.createBuffer(), this.colorBuffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), this.vertexArray = new b.Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), a.bindBuffer(a.ARRAY_BUFFER, this.vertexBuffer), a.bufferData(a.ARRAY_BUFFER, this.vertexArray, a.STATIC_DRAW), this.uvArray = new b.Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), a.bindBuffer(a.ARRAY_BUFFER, this.uvBuffer), a.bufferData(a.ARRAY_BUFFER, this.uvArray, a.STATIC_DRAW), this.colorArray = new b.Float32Array([1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215]), a.bindBuffer(a.ARRAY_BUFFER, this.colorBuffer), a.bufferData(a.ARRAY_BUFFER, this.colorArray, a.STATIC_DRAW), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 1, 3, 2]), a.STATIC_DRAW)
    },b.WebGLFilterManager.prototype.destroy = function () {
        var a = this.gl;
        this.filterStack = null, this.offsetX = 0, this.offsetY = 0;
        for (var b = 0; b < this.texturePool.length; b++)this.texturePool[b].destroy();
        this.texturePool = null, a.deleteBuffer(this.vertexBuffer), a.deleteBuffer(this.uvBuffer), a.deleteBuffer(this.colorBuffer), a.deleteBuffer(this.indexBuffer)
    },b.FilterTexture = function (a, c, d, e) {
        this.gl = a, this.frameBuffer = a.createFramebuffer(), this.texture = a.createTexture(), e = e || b.scaleModes.DEFAULT, a.bindTexture(a.TEXTURE_2D, this.texture), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, e === b.scaleModes.LINEAR ? a.LINEAR : a.NEAREST), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, e === b.scaleModes.LINEAR ? a.LINEAR : a.NEAREST), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_S, a.CLAMP_TO_EDGE), a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_T, a.CLAMP_TO_EDGE), a.bindFramebuffer(a.FRAMEBUFFER, this.frameBuffer), a.bindFramebuffer(a.FRAMEBUFFER, this.frameBuffer), a.framebufferTexture2D(a.FRAMEBUFFER, a.COLOR_ATTACHMENT0, a.TEXTURE_2D, this.texture, 0), this.renderBuffer = a.createRenderbuffer(), a.bindRenderbuffer(a.RENDERBUFFER, this.renderBuffer), a.framebufferRenderbuffer(a.FRAMEBUFFER, a.DEPTH_STENCIL_ATTACHMENT, a.RENDERBUFFER, this.renderBuffer), this.resize(c, d)
    },b.FilterTexture.prototype.constructor = b.FilterTexture,b.FilterTexture.prototype.clear = function () {
        var a = this.gl;
        a.clearColor(0, 0, 0, 0), a.clear(a.COLOR_BUFFER_BIT)
    },b.FilterTexture.prototype.resize = function (a, b) {
        if (this.width !== a || this.height !== b) {
            this.width = a, this.height = b;
            var c = this.gl;
            c.bindTexture(c.TEXTURE_2D, this.texture), c.texImage2D(c.TEXTURE_2D, 0, c.RGBA, a, b, 0, c.RGBA, c.UNSIGNED_BYTE, null), c.bindRenderbuffer(c.RENDERBUFFER, this.renderBuffer), c.renderbufferStorage(c.RENDERBUFFER, c.DEPTH_STENCIL, a, b)
        }
    },b.FilterTexture.prototype.destroy = function () {
        var a = this.gl;
        a.deleteFramebuffer(this.frameBuffer), a.deleteTexture(this.texture), this.frameBuffer = null, this.texture = null
    },b.CanvasBuffer = function (a, c) {
        this.width = a, this.height = c, this.canvas = b.CanvasPool.create(this, this.width, this.height), this.context = this.canvas.getContext("2d"), this.canvas.width = a, this.canvas.height = c
    },b.CanvasBuffer.prototype.constructor = b.CanvasBuffer,b.CanvasBuffer.prototype.clear = function () {
        this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.clearRect(0, 0, this.width, this.height)
    },b.CanvasBuffer.prototype.resize = function (a, b) {
        this.width = this.canvas.width = a, this.height = this.canvas.height = b
    },b.CanvasBuffer.prototype.destroy = function () {
        b.CanvasPool.remove(this)
    },b.CanvasMaskManager = function () {
    },b.CanvasMaskManager.prototype.constructor = b.CanvasMaskManager,b.CanvasMaskManager.prototype.pushMask = function (a, c) {
        var d = c.context;
        d.save();
        var e = a.alpha, f = a.worldTransform, g = c.resolution;
        d.setTransform(f.a * g, f.b * g, f.c * g, f.d * g, f.tx * g, f.ty * g), b.CanvasGraphics.renderGraphicsMask(a, d), d.clip(), a.worldAlpha = e
    },b.CanvasMaskManager.prototype.popMask = function (a) {
        a.context.restore()
    },b.CanvasTinter = function () {
    },b.CanvasTinter.getTintedTexture = function (a, c) {
        var d = a.tintedTexture || b.CanvasPool.create(this);
        return b.CanvasTinter.tintMethod(a.texture, c, d), d
    },b.CanvasTinter.tintWithMultiply = function (a, b, c) {
        var d = c.getContext("2d"), e = a.crop;
        (c.width !== e.width || c.height !== e.height) && (c.width = e.width, c.height = e.height), d.clearRect(0, 0, e.width, e.height), d.fillStyle = "#" + ("00000" + (0 | b).toString(16)).substr(-6), d.fillRect(0, 0, e.width, e.height), d.globalCompositeOperation = "multiply", d.drawImage(a.baseTexture.source, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height), d.globalCompositeOperation = "destination-atop", d.drawImage(a.baseTexture.source, e.x, e.y, e.width, e.height, 0, 0, e.width, e.height)
    },b.CanvasTinter.tintWithPerPixel = function (a, c, d) {
        var e = d.getContext("2d"), f = a.crop;
        d.width = f.width, d.height = f.height, e.globalCompositeOperation = "copy", e.drawImage(a.baseTexture.source, f.x, f.y, f.width, f.height, 0, 0, f.width, f.height);
        for (var g = b.hex2rgb(c), h = g[0], i = g[1], j = g[2], k = e.getImageData(0, 0, f.width, f.height), l = k.data, m = 0; m < l.length; m += 4)if (l[m + 0] *= h, l[m + 1] *= i, l[m + 2] *= j, !b.CanvasTinter.canHandleAlpha) {
            var n = l[m + 3];
            l[m + 0] /= 255 / n, l[m + 1] /= 255 / n, l[m + 2] /= 255 / n
        }
        e.putImageData(k, 0, 0)
    },b.CanvasTinter.checkInverseAlpha = function () {
        var a = new b.CanvasBuffer(2, 1);
        a.context.fillStyle = "rgba(10, 20, 30, 0.5)", a.context.fillRect(0, 0, 1, 1);
        var c = a.context.getImageData(0, 0, 1, 1);
        if (null === c)return !1;
        a.context.putImageData(c, 1, 0);
        var d = a.context.getImageData(1, 0, 1, 1);
        return d.data[0] === c.data[0] && d.data[1] === c.data[1] && d.data[2] === c.data[2] && d.data[3] === c.data[3]
    },b.CanvasTinter.canHandleAlpha = b.CanvasTinter.checkInverseAlpha(),b.CanvasTinter.canUseMultiply = b.canUseNewCanvasBlendModes(),b.CanvasTinter.tintMethod = b.CanvasTinter.canUseMultiply ? b.CanvasTinter.tintWithMultiply : b.CanvasTinter.tintWithPerPixel,b.CanvasRenderer = function (a) {
        this.game = a, b.defaultRenderer || (b.defaultRenderer = this), this.type = b.CANVAS_RENDERER, this.resolution = a.resolution, this.clearBeforeRender = a.clearBeforeRender, this.transparent = a.transparent, this.autoResize = !1, this.width = a.width * this.resolution, this.height = a.height * this.resolution, this.view = a.canvas, this.context = this.view.getContext("2d", {alpha: this.transparent}), this.refresh = !0, this.count = 0, this.maskManager = new b.CanvasMaskManager, this.renderSession = {
            context: this.context,
            maskManager: this.maskManager,
            scaleMode: null,
            smoothProperty: Phaser.Canvas.getSmoothingPrefix(this.context),
            roundPixels: !1
        }, this.mapBlendModes(), this.resize(this.width, this.height)
    },b.CanvasRenderer.prototype.constructor = b.CanvasRenderer,b.CanvasRenderer.prototype.render = function (a) {
        this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.globalAlpha = 1, this.renderSession.currentBlendMode = 0, this.renderSession.shakeX = this.game.camera._shake.x, this.renderSession.shakeY = this.game.camera._shake.y, this.context.globalCompositeOperation = "source-over", navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black", this.context.clear()), this.clearBeforeRender && (this.transparent ? this.context.clearRect(0, 0, this.width, this.height) : (this.context.fillStyle = a._bgColor.rgba, this.context.fillRect(0, 0, this.width, this.height))), this.renderDisplayObject(a)
    },b.CanvasRenderer.prototype.destroy = function (a) {
        void 0 === a && (a = !0), a && this.view.parent && this.view.parent.removeChild(this.view), this.view = null, this.context = null, this.maskManager = null, this.renderSession = null
    },b.CanvasRenderer.prototype.resize = function (a, c) {
        this.width = a * this.resolution, this.height = c * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.renderSession.smoothProperty && (this.context[this.renderSession.smoothProperty] = this.renderSession.scaleMode === b.scaleModes.LINEAR)
    },b.CanvasRenderer.prototype.renderDisplayObject = function (a, b, c) {
        this.renderSession.context = b || this.context, this.renderSession.resolution = this.resolution, a._renderCanvas(this.renderSession, c)
    },b.CanvasRenderer.prototype.mapBlendModes = function () {
        if (!b.blendModesCanvas) {
            var a = [], c = b.blendModes, d = b.canUseNewCanvasBlendModes();
            a[c.NORMAL] = "source-over", a[c.ADD] = "lighter", a[c.MULTIPLY] = d ? "multiply" : "source-over", a[c.SCREEN] = d ? "screen" : "source-over", a[c.OVERLAY] = d ? "overlay" : "source-over", a[c.DARKEN] = d ? "darken" : "source-over", a[c.LIGHTEN] = d ? "lighten" : "source-over", a[c.COLOR_DODGE] = d ? "color-dodge" : "source-over", a[c.COLOR_BURN] = d ? "color-burn" : "source-over", a[c.HARD_LIGHT] = d ? "hard-light" : "source-over", a[c.SOFT_LIGHT] = d ? "soft-light" : "source-over", a[c.DIFFERENCE] = d ? "difference" : "source-over", a[c.EXCLUSION] = d ? "exclusion" : "source-over", a[c.HUE] = d ? "hue" : "source-over", a[c.SATURATION] = d ? "saturation" : "source-over", a[c.COLOR] = d ? "color" : "source-over", a[c.LUMINOSITY] = d ? "luminosity" : "source-over", b.blendModesCanvas = a
        }
    },b.BaseTexture = function (a, c) {
        this.resolution = 1, this.width = 100, this.height = 100, this.scaleMode = c || b.scaleModes.DEFAULT, this.hasLoaded = !1, this.source = a, this.premultipliedAlpha = !0, this._glTextures = [], this.mipmap = !1, this._dirty = [!0, !0, !0, !0], a && ((this.source.complete || this.source.getContext) && this.source.width && this.source.height && (this.hasLoaded = !0, this.width = this.source.naturalWidth || this.source.width, this.height = this.source.naturalHeight || this.source.height, this.dirty()), this.skipRender = !1, this._powerOf2 = !1)
    },b.BaseTexture.prototype.constructor = b.BaseTexture,b.BaseTexture.prototype.forceLoaded = function (a, b) {
        this.hasLoaded = !0, this.width = a, this.height = b, this.dirty()
    },b.BaseTexture.prototype.destroy = function () {
        this.source && b.CanvasPool.removeByCanvas(this.source), this.source = null, this.unloadFromGPU()
    },b.BaseTexture.prototype.updateSourceImage = function (a) {
        console.warn("PIXI.BaseTexture.updateSourceImage is deprecated. Use Phaser.Sprite.loadTexture instead.")
    },b.BaseTexture.prototype.dirty = function () {
        for (var a = 0; a < this._glTextures.length; a++)this._dirty[a] = !0
    },b.BaseTexture.prototype.unloadFromGPU = function () {
        this.dirty();
        for (var a = this._glTextures.length - 1; a >= 0; a--) {
            var c = this._glTextures[a], d = b.glContexts[a];
            d && c && d.deleteTexture(c)
        }
        this._glTextures.length = 0, this.dirty()
    },b.BaseTexture.fromCanvas = function (a, c) {
        return 0 === a.width && (a.width = 1), 0 === a.height && (a.height = 1), new b.BaseTexture(a, c)
    },b.TextureSilentFail = !1,b.Texture = function (a, c, d, e) {
        this.noFrame = !1, c || (this.noFrame = !0, c = new b.Rectangle(0, 0, 1, 1)), a instanceof b.Texture && (a = a.baseTexture), this.baseTexture = a, this.frame = c, this.trim = e, this.valid = !1, this.isTiling = !1, this.requiresUpdate = !1, this.requiresReTint = !1, this._uvs = null, this.width = 0, this.height = 0, this.crop = d || new b.Rectangle(0, 0, 1, 1), a.hasLoaded && (this.noFrame && (c = new b.Rectangle(0, 0, a.width, a.height)), this.setFrame(c))
    },b.Texture.prototype.constructor = b.Texture,b.Texture.prototype.onBaseTextureLoaded = function () {
        var a = this.baseTexture;
        this.noFrame && (this.frame = new b.Rectangle(0, 0, a.width, a.height)), this.setFrame(this.frame)
    },b.Texture.prototype.destroy = function (a) {
        a && this.baseTexture.destroy(), this.valid = !1
    },b.Texture.prototype.setFrame = function (a) {
        if (this.noFrame = !1, this.frame = a, this.width = a.width, this.height = a.height, this.crop.x = a.x, this.crop.y = a.y, this.crop.width = a.width, this.crop.height = a.height, !this.trim && (a.x + a.width > this.baseTexture.width || a.y + a.height > this.baseTexture.height)) {
            if (!b.TextureSilentFail)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this);
            return void(this.valid = !1)
        }
        this.valid = a && a.width && a.height && this.baseTexture.source && this.baseTexture.hasLoaded, this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, this.frame.height = this.trim.height), this.valid && this._updateUvs()
    },b.Texture.prototype._updateUvs = function () {
        this._uvs || (this._uvs = new b.TextureUvs);
        var a = this.crop, c = this.baseTexture.width, d = this.baseTexture.height;
        this._uvs.x0 = a.x / c, this._uvs.y0 = a.y / d, this._uvs.x1 = (a.x + a.width) / c, this._uvs.y1 = a.y / d, this._uvs.x2 = (a.x + a.width) / c, this._uvs.y2 = (a.y + a.height) / d, this._uvs.x3 = a.x / c, this._uvs.y3 = (a.y + a.height) / d
    },b.Texture.fromCanvas = function (a, c) {
        var d = b.BaseTexture.fromCanvas(a, c);
        return new b.Texture(d)
    },b.TextureUvs = function () {
        this.x0 = 0, this.y0 = 0, this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.x3 = 0, this.y3 = 0
    },b.RenderTexture = function (a, c, d, e, f) {
        if (this.width = a || 100, this.height = c || 100, this.resolution = f || 1, this.frame = new b.Rectangle(0, 0, this.width * this.resolution, this.height * this.resolution), this.crop = new b.Rectangle(0, 0, this.width * this.resolution, this.height * this.resolution), this.baseTexture = new b.BaseTexture, this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution, this.baseTexture._glTextures = [], this.baseTexture.resolution = this.resolution, this.baseTexture.scaleMode = e || b.scaleModes.DEFAULT, this.baseTexture.hasLoaded = !0, b.Texture.call(this, this.baseTexture, new b.Rectangle(0, 0, this.width * this.resolution, this.height * this.resolution)), this.renderer = d || b.defaultRenderer, this.renderer.type === b.WEBGL_RENDERER) {
            var g = this.renderer.gl;
            this.baseTexture._dirty[g.id] = !1, this.textureBuffer = new b.FilterTexture(g, this.width, this.height, this.baseTexture.scaleMode), this.baseTexture._glTextures[g.id] = this.textureBuffer.texture, this.render = this.renderWebGL, this.projection = new b.Point(.5 * this.width, .5 * -this.height)
        } else this.render = this.renderCanvas, this.textureBuffer = new b.CanvasBuffer(this.width * this.resolution, this.height * this.resolution), this.baseTexture.source = this.textureBuffer.canvas;
        this.valid = !0, this.tempMatrix = new Phaser.Matrix, this._updateUvs()
    },b.RenderTexture.prototype = Object.create(b.Texture.prototype),b.RenderTexture.prototype.constructor = b.RenderTexture,b.RenderTexture.prototype.resize = function (a, c, d) {
        (a !== this.width || c !== this.height) && (this.valid = a > 0 && c > 0, this.width = a, this.height = c, this.frame.width = this.crop.width = a * this.resolution, this.frame.height = this.crop.height = c * this.resolution, d && (this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution), this.renderer.type === b.WEBGL_RENDERER && (this.projection.x = this.width / 2, this.projection.y = -this.height / 2), this.valid && this.textureBuffer.resize(this.width, this.height))
    },b.RenderTexture.prototype.clear = function () {
        this.valid && (this.renderer.type === b.WEBGL_RENDERER && this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER, this.textureBuffer.frameBuffer), this.textureBuffer.clear())
    },b.RenderTexture.prototype.renderWebGL = function (a, b, c) {
        if (this.valid && 0 !== a.alpha) {
            var d = a.worldTransform;
            d.identity(), d.translate(0, 2 * this.projection.y), b && d.append(b), d.scale(1, -1);
            for (var e = 0; e < a.children.length; e++)a.children[e].updateTransform();
            var f = this.renderer.gl;
            f.viewport(0, 0, this.width * this.resolution, this.height * this.resolution), f.bindFramebuffer(f.FRAMEBUFFER, this.textureBuffer.frameBuffer), c && this.textureBuffer.clear(), this.renderer.spriteBatch.dirty = !0, this.renderer.renderDisplayObject(a, this.projection, this.textureBuffer.frameBuffer, b), this.renderer.spriteBatch.dirty = !0
        }
    },b.RenderTexture.prototype.renderCanvas = function (a, b, c) {
        if (this.valid && 0 !== a.alpha) {
            var d = a.worldTransform;
            d.identity(), b && d.append(b);
            for (var e = 0; e < a.children.length; e++)a.children[e].updateTransform();
            c && this.textureBuffer.clear();
            var f = this.renderer.resolution;
            this.renderer.resolution = this.resolution, this.renderer.renderDisplayObject(a, this.textureBuffer.context, b), this.renderer.resolution = f
        }
    },b.RenderTexture.prototype.getImage = function () {
        var a = new Image;
        return a.src = this.getBase64(), a
    },b.RenderTexture.prototype.getBase64 = function () {
        return this.getCanvas().toDataURL()
    },b.RenderTexture.prototype.getCanvas = function () {
        if (this.renderer.type === b.WEBGL_RENDERER) {
            var a = this.renderer.gl, c = this.textureBuffer.width, d = this.textureBuffer.height, e = new Uint8Array(4 * c * d);
            a.bindFramebuffer(a.FRAMEBUFFER, this.textureBuffer.frameBuffer), a.readPixels(0, 0, c, d, a.RGBA, a.UNSIGNED_BYTE, e), a.bindFramebuffer(a.FRAMEBUFFER, null);
            var f = new b.CanvasBuffer(c, d), g = f.context.getImageData(0, 0, c, d);
            return g.data.set(e), f.context.putImageData(g, 0, 0), f.canvas
        }
        return this.textureBuffer.canvas
    },b.AbstractFilter = function (a, b) {
        this.passes = [this], this.shaders = [], this.dirty = !0, this.padding = 0, this.uniforms = b || {}, this.fragmentSrc = a || []
    },b.AbstractFilter.prototype.constructor = b.AbstractFilter,b.AbstractFilter.prototype.syncUniforms = function () {
        for (var a = 0, b = this.shaders.length; b > a; a++)this.shaders[a].dirty = !0
    },b.TilingSprite = function (a, c, d) {
        b.Sprite.call(this, a), this._width = c || 128, this._height = d || 128, this.tileScale = new b.Point(1, 1), this.tileScaleOffset = new b.Point(1, 1), this.tilePosition = new b.Point, this.renderable = !0, this.tint = 16777215, this.textureDebug = !1, this.blendMode = b.blendModes.NORMAL, this.canvasBuffer = null, this.tilingTexture = null, this.tilePattern = null, this.refreshTexture = !0, this.frameWidth = 0, this.frameHeight = 0
    },b.TilingSprite.prototype = Object.create(b.Sprite.prototype),b.TilingSprite.prototype.constructor = b.TilingSprite,b.TilingSprite.prototype.setTexture = function (a) {
        this.texture !== a && (this.texture = a, this.refreshTexture = !0, this.cachedTint = 16777215)
    },b.TilingSprite.prototype._renderWebGL = function (a) {
        if (this.visible && this.renderable && 0 !== this.alpha) {
            if (this._mask && (a.spriteBatch.stop(), a.maskManager.pushMask(this.mask, a), a.spriteBatch.start()), this._filters && (a.spriteBatch.flush(), a.filterManager.pushFilter(this._filterBlock)), this.refreshTexture) {
                if (this.generateTilingTexture(!0, a), !this.tilingTexture)return;
                this.tilingTexture.needsUpdate && (a.renderer.updateTexture(this.tilingTexture.baseTexture), this.tilingTexture.needsUpdate = !1)
            }
            a.spriteBatch.renderTilingSprite(this);
            for (var b = 0; b < this.children.length; b++)this.children[b]._renderWebGL(a);
            a.spriteBatch.stop(), this._filters && a.filterManager.popFilter(), this._mask && a.maskManager.popMask(this._mask, a), a.spriteBatch.start()
        }
    },b.TilingSprite.prototype._renderCanvas = function (a) {
        if (this.visible && this.renderable && 0 !== this.alpha) {
            var c = a.context;
            this._mask && a.maskManager.pushMask(this._mask, a), c.globalAlpha = this.worldAlpha;
            var d = this.worldTransform, e = a.resolution, f = d.tx * e + a.shakeX, g = d.ty * e + a.shakeY;
            if (c.setTransform(d.a * e, d.b * e, d.c * e, d.d * e, f, g), this.refreshTexture) {
                if (this.generateTilingTexture(!1, a), !this.tilingTexture)return;
                this.tilePattern = c.createPattern(this.tilingTexture.baseTexture.source, "repeat")
            }
            var h = a.currentBlendMode;
            this.blendMode !== a.currentBlendMode && (a.currentBlendMode = this.blendMode, c.globalCompositeOperation = b.blendModesCanvas[a.currentBlendMode]);
            var i = this.tilePosition, j = this.tileScale;
            i.x %= this.tilingTexture.baseTexture.width, i.y %= this.tilingTexture.baseTexture.height, c.scale(j.x, j.y), c.translate(i.x + this.anchor.x * -this._width, i.y + this.anchor.y * -this._height), c.fillStyle = this.tilePattern;
            var f = -i.x, g = -i.y, k = this._width / j.x, l = this._height / j.y;
            a.roundPixels && (f |= 0, g |= 0, k |= 0, l |= 0), c.fillRect(f, g, k, l), c.scale(1 / j.x, 1 / j.y), c.translate(-i.x + this.anchor.x * this._width, -i.y + this.anchor.y * this._height), this._mask && a.maskManager.popMask(a);
            for (var m = 0; m < this.children.length; m++)this.children[m]._renderCanvas(a);
            h !== this.blendMode && (a.currentBlendMode = h, c.globalCompositeOperation = b.blendModesCanvas[h])
        }
    },b.TilingSprite.prototype.onTextureUpdate = function () {
    },b.TilingSprite.prototype.generateTilingTexture = function (a, c) {
        if (this.texture.baseTexture.hasLoaded) {
            var d = this.texture, e = d.frame, f = this._frame.sourceSizeW || this._frame.width, g = this._frame.sourceSizeH || this._frame.height, h = 0, i = 0;
            this._frame.trimmed && (h = this._frame.spriteSourceSizeX, i = this._frame.spriteSourceSizeY), a && (f = b.getNextPowerOfTwo(f), g = b.getNextPowerOfTwo(g)), this.canvasBuffer ? (this.canvasBuffer.resize(f, g), this.tilingTexture.baseTexture.width = f, this.tilingTexture.baseTexture.height = g, this.tilingTexture.needsUpdate = !0) : (this.canvasBuffer = new b.CanvasBuffer(f, g), this.tilingTexture = b.Texture.fromCanvas(this.canvasBuffer.canvas), this.tilingTexture.isTiling = !0, this.tilingTexture.needsUpdate = !0), this.textureDebug && (this.canvasBuffer.context.strokeStyle = "#00ff00", this.canvasBuffer.context.strokeRect(0, 0, f, g));
            var j = d.crop.width, k = d.crop.height;
            (j !== f || k !== g) && (j = f, k = g), this.canvasBuffer.context.drawImage(d.baseTexture.source, d.crop.x, d.crop.y, d.crop.width, d.crop.height, h, i, j, k), this.tileScaleOffset.x = e.width / f, this.tileScaleOffset.y = e.height / g, this.refreshTexture = !1, this.tilingTexture.baseTexture._powerOf2 = !0
        }
    },b.TilingSprite.prototype.getBounds = function () {
        var a = this._width, b = this._height, c = a * (1 - this.anchor.x), d = a * -this.anchor.x, e = b * (1 - this.anchor.y), f = b * -this.anchor.y, g = this.worldTransform, h = g.a, i = g.b, j = g.c, k = g.d, l = g.tx, m = g.ty, n = h * d + j * f + l, o = k * f + i * d + m, p = h * c + j * f + l, q = k * f + i * c + m, r = h * c + j * e + l, s = k * e + i * c + m, t = h * d + j * e + l, u = k * e + i * d + m, v = -(1 / 0), w = -(1 / 0), x = 1 / 0, y = 1 / 0;
        x = x > n ? n : x, x = x > p ? p : x, x = x > r ? r : x, x = x > t ? t : x, y = y > o ? o : y, y = y > q ? q : y, y = y > s ? s : y, y = y > u ? u : y, v = n > v ? n : v, v = p > v ? p : v, v = r > v ? r : v, v = t > v ? t : v, w = o > w ? o : w, w = q > w ? q : w, w = s > w ? s : w, w = u > w ? u : w;
        var z = this._bounds;
        return z.x = x, z.width = v - x, z.y = y, z.height = w - y, this._currentBounds = z, z
    },b.TilingSprite.prototype.destroy = function () {
        b.Sprite.prototype.destroy.call(this), this.canvasBuffer && (this.canvasBuffer.destroy(), this.canvasBuffer = null), this.tileScale = null, this.tileScaleOffset = null, this.tilePosition = null, this.tilingTexture && (this.tilingTexture.destroy(!0), this.tilingTexture = null)
    },Object.defineProperty(b.TilingSprite.prototype, "width", {
        get: function () {
            return this._width
        }, set: function (a) {
            this._width = a
        }
    }),Object.defineProperty(b.TilingSprite.prototype, "height", {
        get: function () {
            return this._height
        }, set: function (a) {
            this._height = a
        }
    }),"undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = b), exports.PIXI = b) : "undefined" != typeof define && define.amd ? define("PIXI", function () {
        return a.PIXI = b
    }()) : a.PIXI = b,b
}.call(this), function () {
    function a(a, b) {
        this._scaleFactor = a, this._deltaMode = b, this.originalEvent = null
    }

    var b = this, c = c || {
            VERSION: "2.6.0",
            GAMES: [],
            AUTO: 0,
            CANVAS: 1,
            WEBGL: 2,
            HEADLESS: 3,
            NONE: 0,
            LEFT: 1,
            RIGHT: 2,
            UP: 3,
            DOWN: 4,
            SPRITE: 0,
            BUTTON: 1,
            IMAGE: 2,
            GRAPHICS: 3,
            TEXT: 4,
            TILESPRITE: 5,
            BITMAPTEXT: 6,
            GROUP: 7,
            RENDERTEXTURE: 8,
            TILEMAP: 9,
            TILEMAPLAYER: 10,
            EMITTER: 11,
            POLYGON: 12,
            BITMAPDATA: 13,
            CANVAS_FILTER: 14,
            WEBGL_FILTER: 15,
            ELLIPSE: 16,
            SPRITEBATCH: 17,
            RETROFONT: 18,
            POINTER: 19,
            ROPE: 20,
            CIRCLE: 21,
            RECTANGLE: 22,
            LINE: 23,
            MATRIX: 24,
            POINT: 25,
            ROUNDEDRECTANGLE: 26,
            CREATURE: 27,
            VIDEO: 28,
            PENDING_ATLAS: -1,
            HORIZONTAL: 0,
            VERTICAL: 1,
            LANDSCAPE: 0,
            PORTRAIT: 1,
            ANGLE_UP: 270,
            ANGLE_DOWN: 90,
            ANGLE_LEFT: 180,
            ANGLE_RIGHT: 0,
            ANGLE_NORTH_EAST: 315,
            ANGLE_NORTH_WEST: 225,
            ANGLE_SOUTH_EAST: 45,
            ANGLE_SOUTH_WEST: 135,
            TOP_LEFT: 0,
            TOP_CENTER: 1,
            TOP_RIGHT: 2,
            LEFT_TOP: 3,
            LEFT_CENTER: 4,
            LEFT_BOTTOM: 5,
            CENTER: 6,
            RIGHT_TOP: 7,
            RIGHT_CENTER: 8,
            RIGHT_BOTTOM: 9,
            BOTTOM_LEFT: 10,
            BOTTOM_CENTER: 11,
            BOTTOM_RIGHT: 12,
            blendModes: {
                NORMAL: 0,
                ADD: 1,
                MULTIPLY: 2,
                SCREEN: 3,
                OVERLAY: 4,
                DARKEN: 5,
                LIGHTEN: 6,
                COLOR_DODGE: 7,
                COLOR_BURN: 8,
                HARD_LIGHT: 9,
                SOFT_LIGHT: 10,
                DIFFERENCE: 11,
                EXCLUSION: 12,
                HUE: 13,
                SATURATION: 14,
                COLOR: 15,
                LUMINOSITY: 16
            },
            scaleModes: {DEFAULT: 0, LINEAR: 0, NEAREST: 1},
            PIXI: PIXI || {}
        };
    if (Math.trunc || (Math.trunc = function (a) {
            return 0 > a ? Math.ceil(a) : Math.floor(a)
        }), Function.prototype.bind || (Function.prototype.bind = function () {
            var a = Array.prototype.slice;
            return function (b) {
                function c() {
                    var f = e.concat(a.call(arguments));
                    d.apply(this instanceof c ? this : b, f)
                }

                var d = this, e = a.call(arguments, 1);
                if ("function" != typeof d)throw new TypeError;
                return c.prototype = function f(a) {
                    return a && (f.prototype = a), this instanceof f ? void 0 : new f
                }(d.prototype), c
            }
        }()), Array.isArray || (Array.isArray = function (a) {
            return "[object Array]" == Object.prototype.toString.call(a)
        }), Array.prototype.forEach || (Array.prototype.forEach = function (a) {
            "use strict";
            if (void 0 === this || null === this)throw new TypeError;
            var b = Object(this), c = b.length >>> 0;
            if ("function" != typeof a)throw new TypeError;
            for (var d = arguments.length >= 2 ? arguments[1] : void 0, e = 0; c > e; e++)e in b && a.call(d, b[e], e, b)
        }), "function" != typeof window.Uint32Array && "object" != typeof window.Uint32Array) {
        var d = function (a) {
            var b = new Array;
            window[a] = function (a) {
                if ("number" == typeof a) {
                    Array.call(this, a), this.length = a;
                    for (var b = 0; b < this.length; b++)this[b] = 0
                } else {
                    Array.call(this, a.length), this.length = a.length;
                    for (var b = 0; b < this.length; b++)this[b] = a[b]
                }
            }, window[a].prototype = b, window[a].constructor = window[a]
        };
        d("Uint32Array"), d("Int16Array")
    }
    window.console || (window.console = {}, window.console.log = window.console.assert = function () {
    }, window.console.warn = window.console.assert = function () {
    }), c.Utils = {
        reverseString: function (a) {
            return a.split("").reverse().join("")
        }, getProperty: function (a, b) {
            for (var c = b.split("."), d = c.pop(), e = c.length, f = 1, g = c[0]; e > f && (a = a[g]);)g = c[f], f++;
            return a ? a[d] : null
        }, setProperty: function (a, b, c) {
            for (var d = b.split("."), e = d.pop(), f = d.length, g = 1, h = d[0]; f > g && (a = a[h]);)h = d[g], g++;
            return a && (a[e] = c), a
        }, chanceRoll: function (a) {
            return void 0 === a && (a = 50), a > 0 && 100 * Math.random() <= a
        }, randomChoice: function (a, b) {
            return Math.random() < .5 ? a : b
        }, parseDimension: function (a, b) {
            var c = 0, d = 0;
            return "string" == typeof a ? "%" === a.substr(-1) ? (c = parseInt(a, 10) / 100, d = 0 === b ? window.innerWidth * c : window.innerHeight * c) : d = parseInt(a, 10) : d = a, d
        }, pad: function (a, b, c, d) {
            if (void 0 === b)var b = 0;
            if (void 0 === c)var c = " ";
            if (void 0 === d)var d = 3;
            a = a.toString();
            var e = 0;
            if (b + 1 >= a.length)switch (d) {
                case 1:
                    a = new Array(b + 1 - a.length).join(c) + a;
                    break;
                case 3:
                    var f = Math.ceil((e = b - a.length) / 2), g = e - f;
                    a = new Array(g + 1).join(c) + a + new Array(f + 1).join(c);
                    break;
                default:
                    a += new Array(b + 1 - a.length).join(c)
            }
            return a
        }, isPlainObject: function (a) {
            if ("object" != typeof a || a.nodeType || a === a.window)return !1;
            try {
                if (a.constructor && !{}.hasOwnProperty.call(a.constructor.prototype, "isPrototypeOf"))return !1
            } catch (b) {
                return !1
            }
            return !0
        }, extend: function () {
            var a, b, d, e, f, g, h = arguments[0] || {}, i = 1, j = arguments.length, k = !1;
            for ("boolean" == typeof h && (k = h, h = arguments[1] || {}, i = 2), j === i && (h = this, --i); j > i; i++)if (null != (a = arguments[i]))for (b in a)d = h[b], e = a[b], h !== e && (k && e && (c.Utils.isPlainObject(e) || (f = Array.isArray(e))) ? (f ? (f = !1, g = d && Array.isArray(d) ? d : []) : g = d && c.Utils.isPlainObject(d) ? d : {}, h[b] = c.Utils.extend(k, g, e)) : void 0 !== e && (h[b] = e));
            return h
        }, mixinPrototype: function (a, b, c) {
            void 0 === c && (c = !1);
            for (var d = Object.keys(b), e = 0; e < d.length; e++) {
                var f = d[e], g = b[f];
                !c && f in a || (!g || "function" != typeof g.get && "function" != typeof g.set ? a[f] = g : "function" == typeof g.clone ? a[f] = g.clone() : Object.defineProperty(a, f, g))
            }
        }, mixin: function (a, b) {
            if (!a || "object" != typeof a)return b;
            for (var d in a) {
                var e = a[d];
                if (!e.childNodes && !e.cloneNode) {
                    var f = typeof a[d];
                    a[d] && "object" === f ? typeof b[d] === f ? b[d] = c.Utils.mixin(a[d], b[d]) : b[d] = c.Utils.mixin(a[d], new e.constructor) : b[d] = a[d]
                }
            }
            return b
        }
    }, c.Circle = function (a, b, d) {
        a = a || 0, b = b || 0, d = d || 0, this.x = a, this.y = b, this._diameter = d, this._radius = 0, d > 0 && (this._radius = .5 * d), this.type = c.CIRCLE
    }, c.Circle.prototype = {
        circumference: function () {
            return 2 * (Math.PI * this._radius)
        }, random: function (a) {
            void 0 === a && (a = new c.Point);
            var b = 2 * Math.PI * Math.random(), d = Math.random() + Math.random(), e = d > 1 ? 2 - d : d, f = e * Math.cos(b), g = e * Math.sin(b);
            return a.x = this.x + f * this.radius, a.y = this.y + g * this.radius, a
        }, getBounds: function () {
            return new c.Rectangle(this.x - this.radius, this.y - this.radius, this.diameter, this.diameter)
        }, setTo: function (a, b, c) {
            return this.x = a, this.y = b, this._diameter = c, this._radius = .5 * c, this
        }, copyFrom: function (a) {
            return this.setTo(a.x, a.y, a.diameter)
        }, copyTo: function (a) {
            return a.x = this.x, a.y = this.y, a.diameter = this._diameter, a
        }, distance: function (a, b) {
            var d = c.Math.distance(this.x, this.y, a.x, a.y);
            return b ? Math.round(d) : d
        }, clone: function (a) {
            return void 0 === a || null === a ? a = new c.Circle(this.x, this.y, this.diameter) : a.setTo(this.x, this.y, this.diameter), a
        }, contains: function (a, b) {
            return c.Circle.contains(this, a, b)
        }, circumferencePoint: function (a, b, d) {
            return c.Circle.circumferencePoint(this, a, b, d)
        }, offset: function (a, b) {
            return this.x += a, this.y += b, this
        }, offsetPoint: function (a) {
            return this.offset(a.x, a.y)
        }, toString: function () {
            return "[{Phaser.Circle (x=" + this.x + " y=" + this.y + " diameter=" + this.diameter + " radius=" + this.radius + ")}]"
        }
    }, c.Circle.prototype.constructor = c.Circle, Object.defineProperty(c.Circle.prototype, "diameter", {
        get: function () {
            return this._diameter
        }, set: function (a) {
            a > 0 && (this._diameter = a, this._radius = .5 * a)
        }
    }), Object.defineProperty(c.Circle.prototype, "radius", {
        get: function () {
            return this._radius
        }, set: function (a) {
            a > 0 && (this._radius = a, this._diameter = 2 * a)
        }
    }), Object.defineProperty(c.Circle.prototype, "left", {
        get: function () {
            return this.x - this._radius
        }, set: function (a) {
            a > this.x ? (this._radius = 0, this._diameter = 0) : this.radius = this.x - a
        }
    }), Object.defineProperty(c.Circle.prototype, "right", {
        get: function () {
            return this.x + this._radius
        }, set: function (a) {
            a < this.x ? (this._radius = 0, this._diameter = 0) : this.radius = a - this.x
        }
    }), Object.defineProperty(c.Circle.prototype, "top", {
        get: function () {
            return this.y - this._radius
        }, set: function (a) {
            a > this.y ? (this._radius = 0, this._diameter = 0) : this.radius = this.y - a
        }
    }), Object.defineProperty(c.Circle.prototype, "bottom", {
        get: function () {
            return this.y + this._radius
        }, set: function (a) {
            a < this.y ? (this._radius = 0, this._diameter = 0) : this.radius = a - this.y
        }
    }), Object.defineProperty(c.Circle.prototype, "area", {
        get: function () {
            return this._radius > 0 ? Math.PI * this._radius * this._radius : 0
        }
    }), Object.defineProperty(c.Circle.prototype, "empty", {
        get: function () {
            return 0 === this._diameter
        }, set: function (a) {
            a === !0 && this.setTo(0, 0, 0)
        }
    }), c.Circle.contains = function (a, b, c) {
        if (a.radius > 0 && b >= a.left && b <= a.right && c >= a.top && c <= a.bottom) {
            var d = (a.x - b) * (a.x - b), e = (a.y - c) * (a.y - c);
            return d + e <= a.radius * a.radius
        }
        return !1
    }, c.Circle.equals = function (a, b) {
        return a.x == b.x && a.y == b.y && a.diameter == b.diameter
    }, c.Circle.intersects = function (a, b) {
        return c.Math.distance(a.x, a.y, b.x, b.y) <= a.radius + b.radius
    }, c.Circle.circumferencePoint = function (a, b, d, e) {
        return void 0 === d && (d = !1), void 0 === e && (e = new c.Point), d === !0 && (b = c.Math.degToRad(b)), e.x = a.x + a.radius * Math.cos(b), e.y = a.y + a.radius * Math.sin(b), e
    }, c.Circle.intersectsRectangle = function (a, b) {
        var c = Math.abs(a.x - b.x - b.halfWidth), d = b.halfWidth + a.radius;
        if (c > d)return !1;
        var e = Math.abs(a.y - b.y - b.halfHeight), f = b.halfHeight + a.radius;
        if (e > f)return !1;
        if (c <= b.halfWidth || e <= b.halfHeight)return !0;
        var g = c - b.halfWidth, h = e - b.halfHeight, i = g * g, j = h * h, k = a.radius * a.radius;
        return k >= i + j
    }, PIXI.Circle = c.Circle, c.Ellipse = function (a, b, d, e) {
        a = a || 0, b = b || 0, d = d || 0, e = e || 0, this.x = a, this.y = b, this.width = d, this.height = e, this.type = c.ELLIPSE
    }, c.Ellipse.prototype = {
        setTo: function (a, b, c, d) {
            return this.x = a, this.y = b, this.width = c, this.height = d, this
        }, getBounds: function () {
            return new c.Rectangle(this.x - this.width, this.y - this.height, this.width, this.height)
        }, copyFrom: function (a) {
            return this.setTo(a.x, a.y, a.width, a.height)
        }, copyTo: function (a) {
            return a.x = this.x, a.y = this.y, a.width = this.width, a.height = this.height, a
        }, clone: function (a) {
            return void 0 === a || null === a ? a = new c.Ellipse(this.x, this.y, this.width, this.height) : a.setTo(this.x, this.y, this.width, this.height), a
        }, contains: function (a, b) {
            return c.Ellipse.contains(this, a, b)
        }, random: function (a) {
            void 0 === a && (a = new c.Point);
            var b = Math.random() * Math.PI * 2, d = Math.random();
            return a.x = Math.sqrt(d) * Math.cos(b), a.y = Math.sqrt(d) * Math.sin(b), a.x = this.x + a.x * this.width / 2, a.y = this.y + a.y * this.height / 2, a
        }, toString: function () {
            return "[{Phaser.Ellipse (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + ")}]"
        }
    }, c.Ellipse.prototype.constructor = c.Ellipse, Object.defineProperty(c.Ellipse.prototype, "left", {
        get: function () {
            return this.x
        }, set: function (a) {
            this.x = a
        }
    }), Object.defineProperty(c.Ellipse.prototype, "right", {
        get: function () {
            return this.x + this.width
        }, set: function (a) {
            a < this.x ? this.width = 0 : this.width = a - this.x
        }
    }), Object.defineProperty(c.Ellipse.prototype, "top", {
        get: function () {
            return this.y
        }, set: function (a) {
            this.y = a
        }
    }), Object.defineProperty(c.Ellipse.prototype, "bottom", {
        get: function () {
            return this.y + this.height
        }, set: function (a) {
            a < this.y ? this.height = 0 : this.height = a - this.y
        }
    }), Object.defineProperty(c.Ellipse.prototype, "empty", {
        get: function () {
            return 0 === this.width || 0 === this.height
        }, set: function (a) {
            a === !0 && this.setTo(0, 0, 0, 0)
        }
    }), c.Ellipse.contains = function (a, b, c) {
        if (a.width <= 0 || a.height <= 0)return !1;
        var d = (b - a.x) / a.width - .5, e = (c - a.y) / a.height - .5;
        return d *= d, e *= e, .25 > d + e
    }, PIXI.Ellipse = c.Ellipse, c.Line = function (a, b, d, e) {
        a = a || 0, b = b || 0, d = d || 0, e = e || 0, this.start = new c.Point(a, b), this.end = new c.Point(d, e), this.type = c.LINE
    }, c.Line.prototype = {
        setTo: function (a, b, c, d) {
            return this.start.setTo(a, b), this.end.setTo(c, d), this
        }, fromSprite: function (a, b, c) {
            return void 0 === c && (c = !1), c ? this.setTo(a.center.x, a.center.y, b.center.x, b.center.y) : this.setTo(a.x, a.y, b.x, b.y)
        }, fromAngle: function (a, b, c, d) {
            return this.start.setTo(a, b), this.end.setTo(a + Math.cos(c) * d, b + Math.sin(c) * d), this
        }, rotate: function (a, b) {
            var c = (this.start.x + this.end.x) / 2, d = (this.start.y + this.end.y) / 2;
            return this.start.rotate(c, d, a, b), this.end.rotate(c, d, a, b), this
        }, rotateAround: function (a, b, c, d) {
            return this.start.rotate(a, b, c, d), this.end.rotate(a, b, c, d), this
        }, intersects: function (a, b, d) {
            return c.Line.intersectsPoints(this.start, this.end, a.start, a.end, b, d)
        }, reflect: function (a) {
            return c.Line.reflect(this, a)
        }, midPoint: function (a) {
            return void 0 === a && (a = new c.Point), a.x = (this.start.x + this.end.x) / 2, a.y = (this.start.y + this.end.y) / 2, a
        }, centerOn: function (a, b) {
            var c = (this.start.x + this.end.x) / 2, d = (this.start.y + this.end.y) / 2, e = a - c, f = b - d;
            this.start.add(e, f), this.end.add(e, f)
        }, pointOnLine: function (a, b) {
            return (a - this.start.x) * (this.end.y - this.start.y) === (this.end.x - this.start.x) * (b - this.start.y)
        }, pointOnSegment: function (a, b) {
            var c = Math.min(this.start.x, this.end.x), d = Math.max(this.start.x, this.end.x), e = Math.min(this.start.y, this.end.y), f = Math.max(this.start.y, this.end.y);
            return this.pointOnLine(a, b) && a >= c && d >= a && b >= e && f >= b
        }, random: function (a) {
            void 0 === a && (a = new c.Point);
            var b = Math.random();
            return a.x = this.start.x + b * (this.end.x - this.start.x), a.y = this.start.y + b * (this.end.y - this.start.y), a
        }, coordinatesOnLine: function (a, b) {
            void 0 === a && (a = 1), void 0 === b && (b = []);
            var c = Math.round(this.start.x), d = Math.round(this.start.y), e = Math.round(this.end.x), f = Math.round(this.end.y), g = Math.abs(e - c), h = Math.abs(f - d), i = e > c ? 1 : -1, j = f > d ? 1 : -1, k = g - h;
            b.push([c, d]);
            for (var l = 1; c != e || d != f;) {
                var m = k << 1;
                m > -h && (k -= h, c += i), g > m && (k += g, d += j), l % a === 0 && b.push([c, d]), l++
            }
            return b
        }, clone: function (a) {
            return void 0 === a || null === a ? a = new c.Line(this.start.x, this.start.y, this.end.x, this.end.y) : a.setTo(this.start.x, this.start.y, this.end.x, this.end.y), a
        }
    }, Object.defineProperty(c.Line.prototype, "length", {
        get: function () {
            return Math.sqrt((this.end.x - this.start.x) * (this.end.x - this.start.x) + (this.end.y - this.start.y) * (this.end.y - this.start.y))
        }
    }), Object.defineProperty(c.Line.prototype, "angle", {
        get: function () {
            return Math.atan2(this.end.y - this.start.y, this.end.x - this.start.x)
        }
    }), Object.defineProperty(c.Line.prototype, "slope", {
        get: function () {
            return (this.end.y - this.start.y) / (this.end.x - this.start.x)
        }
    }), Object.defineProperty(c.Line.prototype, "perpSlope", {
        get: function () {
            return -((this.end.x - this.start.x) / (this.end.y - this.start.y))
        }
    }), Object.defineProperty(c.Line.prototype, "x", {
        get: function () {
            return Math.min(this.start.x, this.end.x)
        }
    }), Object.defineProperty(c.Line.prototype, "y", {
        get: function () {
            return Math.min(this.start.y, this.end.y)
        }
    }), Object.defineProperty(c.Line.prototype, "left", {
        get: function () {
            return Math.min(this.start.x, this.end.x)
        }
    }), Object.defineProperty(c.Line.prototype, "right", {
        get: function () {
            return Math.max(this.start.x, this.end.x)
        }
    }), Object.defineProperty(c.Line.prototype, "top", {
        get: function () {
            return Math.min(this.start.y, this.end.y)
        }
    }), Object.defineProperty(c.Line.prototype, "bottom", {
        get: function () {
            return Math.max(this.start.y, this.end.y)
        }
    }), Object.defineProperty(c.Line.prototype, "width", {
        get: function () {
            return Math.abs(this.start.x - this.end.x)
        }
    }), Object.defineProperty(c.Line.prototype, "height", {
        get: function () {
            return Math.abs(this.start.y - this.end.y)
        }
    }), Object.defineProperty(c.Line.prototype, "normalX", {
        get: function () {
            return Math.cos(this.angle - 1.5707963267948966)
        }
    }), Object.defineProperty(c.Line.prototype, "normalY", {
        get: function () {
            return Math.sin(this.angle - 1.5707963267948966)
        }
    }), Object.defineProperty(c.Line.prototype, "normalAngle", {
        get: function () {
            return c.Math.wrap(this.angle - 1.5707963267948966, -Math.PI, Math.PI)
        }
    }), c.Line.intersectsPoints = function (a, b, d, e, f, g) {
        void 0 === f && (f = !0), void 0 === g && (g = new c.Point);
        var h = b.y - a.y, i = e.y - d.y, j = a.x - b.x, k = d.x - e.x, l = b.x * a.y - a.x * b.y, m = e.x * d.y - d.x * e.y, n = h * k - i * j;
        if (0 === n)return null;
        if (g.x = (j * m - k * l) / n, g.y = (i * l - h * m) / n, f) {
            var o = (e.y - d.y) * (b.x - a.x) - (e.x - d.x) * (b.y - a.y), p = ((e.x - d.x) * (a.y - d.y) - (e.y - d.y) * (a.x - d.x)) / o, q = ((b.x - a.x) * (a.y - d.y) - (b.y - a.y) * (a.x - d.x)) / o;
            return p >= 0 && 1 >= p && q >= 0 && 1 >= q ? g : null
        }
        return g
    }, c.Line.intersects = function (a, b, d, e) {
        return c.Line.intersectsPoints(a.start, a.end, b.start, b.end, d, e)
    }, c.Line.intersectsRectangle = function (a, b) {
        if (!c.Rectangle.intersects(a, b))return !1;
        var d = a.start.x, e = a.start.y, f = a.end.x, g = a.end.y, h = b.x, i = b.y, j = b.right, k = b.bottom, l = 0;
        if (d >= h && j >= d && e >= i && k >= e || f >= h && j >= f && g >= i && k >= g)return !0;
        if (h > d && f >= h) {
            if (l = e + (g - e) * (h - d) / (f - d), l > i && k >= l)return !0
        } else if (d > j && j >= f && (l = e + (g - e) * (j - d) / (f - d), l >= i && k >= l))return !0;
        if (i > e && g >= i) {
            if (l = d + (f - d) * (i - e) / (g - e), l >= h && j >= l)return !0
        } else if (e > k && k >= g && (l = d + (f - d) * (k - e) / (g - e), l >= h && j >= l))return !0;
        return !1
    }, c.Line.reflect = function (a, b) {
        return 2 * b.normalAngle - 3.141592653589793 - a.angle
    }, c.Matrix = function (a, b, d, e, f, g) {
        (void 0 === a || null === a) && (a = 1), (void 0 === b || null === b) && (b = 0), (void 0 === d || null === d) && (d = 0), (void 0 === e || null === e) && (e = 1), (void 0 === f || null === f) && (f = 0), (void 0 === g || null === g) && (g = 0), this.a = a, this.b = b, this.c = d, this.d = e, this.tx = f, this.ty = g, this.type = c.MATRIX
    }, c.Matrix.prototype = {
        fromArray: function (a) {
            return this.setTo(a[0], a[1], a[3], a[4], a[2], a[5])
        }, setTo: function (a, b, c, d, e, f) {
            return this.a = a, this.b = b, this.c = c, this.d = d, this.tx = e, this.ty = f, this
        }, clone: function (a) {
            return void 0 === a || null === a ? a = new c.Matrix(this.a, this.b, this.c, this.d, this.tx, this.ty) : (a.a = this.a, a.b = this.b, a.c = this.c, a.d = this.d, a.tx = this.tx, a.ty = this.ty), a
        }, copyTo: function (a) {
            return a.copyFrom(this), a
        }, copyFrom: function (a) {
            return this.a = a.a, this.b = a.b, this.c = a.c, this.d = a.d, this.tx = a.tx, this.ty = a.ty, this
        }, toArray: function (a, b) {
            return void 0 === b && (b = new PIXI.Float32Array(9)), a ? (b[0] = this.a, b[1] = this.b, b[2] = 0, b[3] = this.c, b[4] = this.d, b[5] = 0, b[6] = this.tx, b[7] = this.ty, b[8] = 1) : (b[0] = this.a, b[1] = this.c, b[2] = this.tx, b[3] = this.b, b[4] = this.d, b[5] = this.ty, b[6] = 0, b[7] = 0, b[8] = 1), b
        }, apply: function (a, b) {
            return void 0 === b && (b = new c.Point), b.x = this.a * a.x + this.c * a.y + this.tx, b.y = this.b * a.x + this.d * a.y + this.ty, b
        }, applyInverse: function (a, b) {
            void 0 === b && (b = new c.Point);
            var d = 1 / (this.a * this.d + this.c * -this.b), e = a.x, f = a.y;
            return b.x = this.d * d * e + -this.c * d * f + (this.ty * this.c - this.tx * this.d) * d, b.y = this.a * d * f + -this.b * d * e + (-this.ty * this.a + this.tx * this.b) * d, b
        }, translate: function (a, b) {
            return this.tx += a, this.ty += b, this
        }, scale: function (a, b) {
            return this.a *= a, this.d *= b, this.c *= a, this.b *= b, this.tx *= a, this.ty *= b, this
        }, rotate: function (a) {
            var b = Math.cos(a), c = Math.sin(a), d = this.a, e = this.c, f = this.tx;
            return this.a = d * b - this.b * c, this.b = d * c + this.b * b, this.c = e * b - this.d * c, this.d = e * c + this.d * b, this.tx = f * b - this.ty * c, this.ty = f * c + this.ty * b, this
        }, append: function (a) {
            var b = this.a, c = this.b, d = this.c, e = this.d;
            return this.a = a.a * b + a.b * d, this.b = a.a * c + a.b * e, this.c = a.c * b + a.d * d, this.d = a.c * c + a.d * e, this.tx = a.tx * b + a.ty * d + this.tx, this.ty = a.tx * c + a.ty * e + this.ty, this
        }, identity: function () {
            return this.setTo(1, 0, 0, 1, 0, 0)
        }
    }, c.identityMatrix = new c.Matrix, PIXI.Matrix = c.Matrix, PIXI.identityMatrix = c.identityMatrix, c.Point = function (a, b) {
        a = a || 0, b = b || 0, this.x = a, this.y = b, this.type = c.POINT
    }, c.Point.prototype = {
        copyFrom: function (a) {
            return this.setTo(a.x, a.y)
        }, invert: function () {
            return this.setTo(this.y, this.x)
        }, setTo: function (a, b) {
            return this.x = a || 0, this.y = b || (0 !== b ? this.x : 0), this
        }, set: function (a, b) {
            return this.x = a || 0, this.y = b || (0 !== b ? this.x : 0), this
        }, add: function (a, b) {
            return this.x += a, this.y += b, this
        }, subtract: function (a, b) {
            return this.x -= a, this.y -= b, this
        }, multiply: function (a, b) {
            return this.x *= a, this.y *= b, this
        }, divide: function (a, b) {
            return this.x /= a, this.y /= b, this
        }, clampX: function (a, b) {
            return this.x = c.Math.clamp(this.x, a, b), this
        }, clampY: function (a, b) {
            return this.y = c.Math.clamp(this.y, a, b), this
        }, clamp: function (a, b) {
            return this.x = c.Math.clamp(this.x, a, b), this.y = c.Math.clamp(this.y, a, b), this
        }, clone: function (a) {
            return void 0 === a || null === a ? a = new c.Point(this.x, this.y) : a.setTo(this.x, this.y), a
        }, copyTo: function (a) {
            return a.x = this.x, a.y = this.y, a
        }, distance: function (a, b) {
            return c.Point.distance(this, a, b)
        }, equals: function (a) {
            return a.x === this.x && a.y === this.y
        }, angle: function (a, b) {
            return void 0 === b && (b = !1), b ? c.Math.radToDeg(Math.atan2(a.y - this.y, a.x - this.x)) : Math.atan2(a.y - this.y, a.x - this.x)
        }, rotate: function (a, b, d, e, f) {
            return c.Point.rotate(this, a, b, d, e, f)
        }, getMagnitude: function () {
            return Math.sqrt(this.x * this.x + this.y * this.y)
        }, getMagnitudeSq: function () {
            return this.x * this.x + this.y * this.y
        }, setMagnitude: function (a) {
            return this.normalize().multiply(a, a)
        }, normalize: function () {
            if (!this.isZero()) {
                var a = this.getMagnitude();
                this.x /= a, this.y /= a
            }
            return this
        }, isZero: function () {
            return 0 === this.x && 0 === this.y
        }, dot: function (a) {
            return this.x * a.x + this.y * a.y
        }, cross: function (a) {
            return this.x * a.y - this.y * a.x
        }, perp: function () {
            return this.setTo(-this.y, this.x)
        }, rperp: function () {
            return this.setTo(this.y, -this.x)
        }, normalRightHand: function () {
            return this.setTo(-1 * this.y, this.x)
        }, floor: function () {
            return this.setTo(Math.floor(this.x), Math.floor(this.y))
        }, ceil: function () {
            return this.setTo(Math.ceil(this.x), Math.ceil(this.y))
        }, toString: function () {
            return "[{Point (x=" + this.x + " y=" + this.y + ")}]"
        }
    }, c.Point.prototype.constructor = c.Point, c.Point.add = function (a, b, d) {
        return void 0 === d && (d = new c.Point), d.x = a.x + b.x, d.y = a.y + b.y, d
    }, c.Point.subtract = function (a, b, d) {
        return void 0 === d && (d = new c.Point), d.x = a.x - b.x, d.y = a.y - b.y, d
    }, c.Point.multiply = function (a, b, d) {
        return void 0 === d && (d = new c.Point), d.x = a.x * b.x, d.y = a.y * b.y, d
    }, c.Point.divide = function (a, b, d) {
        return void 0 === d && (d = new c.Point), d.x = a.x / b.x, d.y = a.y / b.y, d
    }, c.Point.equals = function (a, b) {
        return a.x === b.x && a.y === b.y
    }, c.Point.angle = function (a, b) {
        return Math.atan2(a.y - b.y, a.x - b.x)
    }, c.Point.negative = function (a, b) {
        return void 0 === b && (b = new c.Point), b.setTo(-a.x, -a.y)
    }, c.Point.multiplyAdd = function (a, b, d, e) {
        return void 0 === e && (e = new c.Point), e.setTo(a.x + b.x * d, a.y + b.y * d)
    }, c.Point.interpolate = function (a, b, d, e) {
        return void 0 === e && (e = new c.Point), e.setTo(a.x + (b.x - a.x) * d, a.y + (b.y - a.y) * d)
    }, c.Point.perp = function (a, b) {
        return void 0 === b && (b = new c.Point), b.setTo(-a.y, a.x)
    }, c.Point.rperp = function (a, b) {
        return void 0 === b && (b = new c.Point), b.setTo(a.y, -a.x)
    }, c.Point.distance = function (a, b, d) {
        var e = c.Math.distance(a.x, a.y, b.x, b.y);
        return d ? Math.round(e) : e
    }, c.Point.project = function (a, b, d) {
        void 0 === d && (d = new c.Point);
        var e = a.dot(b) / b.getMagnitudeSq();
        return 0 !== e && d.setTo(e * b.x, e * b.y), d
    }, c.Point.projectUnit = function (a, b, d) {
        void 0 === d && (d = new c.Point);
        var e = a.dot(b);
        return 0 !== e && d.setTo(e * b.x, e * b.y), d
    }, c.Point.normalRightHand = function (a, b) {
        return void 0 === b && (b = new c.Point), b.setTo(-1 * a.y, a.x)
    }, c.Point.normalize = function (a, b) {
        void 0 === b && (b = new c.Point);
        var d = a.getMagnitude();
        return 0 !== d && b.setTo(a.x / d, a.y / d), b
    }, c.Point.rotate = function (a, b, d, e, f, g) {
        if (f && (e = c.Math.degToRad(e)), void 0 === g) {
            a.subtract(b, d);
            var h = Math.sin(e), i = Math.cos(e), j = i * a.x - h * a.y, k = h * a.x + i * a.y;
            a.x = j + b, a.y = k + d
        } else {
            var l = e + Math.atan2(a.y - d, a.x - b);
            a.x = b + g * Math.cos(l), a.y = d + g * Math.sin(l)
        }
        return a
    }, c.Point.centroid = function (a, b) {
        if (void 0 === b && (b = new c.Point), "[object Array]" !== Object.prototype.toString.call(a))throw new Error("Phaser.Point. Parameter 'points' must be an array");
        var d = a.length;
        if (1 > d)throw new Error("Phaser.Point. Parameter 'points' array must not be empty");
        if (1 === d)return b.copyFrom(a[0]), b;
        for (var e = 0; d > e; e++)c.Point.add(b, a[e], b);
        return b.divide(d, d), b
    }, c.Point.parse = function (a, b, d) {
        b = b || "x", d = d || "y";
        var e = new c.Point;
        return a[b] && (e.x = parseInt(a[b], 10)), a[d] && (e.y = parseInt(a[d], 10)), e
    }, PIXI.Point = c.Point, c.Polygon = function () {
        this.area = 0, this._points = [], arguments.length > 0 && this.setTo.apply(this, arguments), this.closed = !0, this.flattened = !1, this.type = c.POLYGON
    }, c.Polygon.prototype = {
        toNumberArray: function (a) {
            void 0 === a && (a = []);
            for (var b = 0; b < this._points.length; b++)"number" == typeof this._points[b] ? (a.push(this._points[b]), a.push(this._points[b + 1]), b++) : (a.push(this._points[b].x), a.push(this._points[b].y));
            return a
        }, flatten: function () {
            return this._points = this.toNumberArray(), this.flattened = !0, this
        }, clone: function (a) {
            var b = this._points.slice();
            return void 0 === a || null === a ? a = new c.Polygon(b) : a.setTo(b), a
        }, contains: function (a, b) {
            var c = !1;
            if (this.flattened)for (var d = -2, e = this._points.length - 2; (d += 2) < this._points.length; e = d) {
                var f = this._points[d], g = this._points[d + 1], h = this._points[e], i = this._points[e + 1];
                (b >= g && i > b || b >= i && g > b) && (h - f) * (b - g) / (i - g) + f > a && (c = !c)
            } else for (var d = -1, e = this._points.length - 1; ++d < this._points.length; e = d) {
                var f = this._points[d].x, g = this._points[d].y, h = this._points[e].x, i = this._points[e].y;
                (b >= g && i > b || b >= i && g > b) && (h - f) * (b - g) / (i - g) + f > a && (c = !c)
            }
            return c
        }, setTo: function (a) {
            if (this.area = 0, this._points = [], arguments.length > 0) {
                Array.isArray(a) || (a = Array.prototype.slice.call(arguments));
                for (var b = Number.MAX_VALUE, c = 0, d = a.length; d > c; c++) {
                    if ("number" == typeof a[c]) {
                        var e = new PIXI.Point(a[c], a[c + 1]);
                        c++
                    } else if (Array.isArray(a[c]))var e = new PIXI.Point(a[c][0], a[c][1]); else var e = new PIXI.Point(a[c].x, a[c].y);
                    this._points.push(e), e.y < b && (b = e.y)
                }
                this.calculateArea(b)
            }
            return this
        }, calculateArea: function (a) {
            for (var b, c, d, e, f = 0, g = this._points.length; g > f; f++)b = this._points[f], c = f === g - 1 ? this._points[0] : this._points[f + 1], d = (b.y - a + (c.y - a)) / 2, e = b.x - c.x, this.area += d * e;
            return this.area
        }
    }, c.Polygon.prototype.constructor = c.Polygon, Object.defineProperty(c.Polygon.prototype, "points", {
        get: function () {
            return this._points
        }, set: function (a) {
            null != a ? this.setTo(a) : this.setTo()
        }
    }), PIXI.Polygon = c.Polygon, c.Rectangle = function (a, b, d, e) {
        a = a || 0, b = b || 0, d = d || 0, e = e || 0, this.x = a, this.y = b, this.width = d, this.height = e, this.type = c.RECTANGLE
    }, c.Rectangle.prototype = {
        offset: function (a, b) {
            return this.x += a, this.y += b, this
        }, offsetPoint: function (a) {
            return this.offset(a.x, a.y)
        }, setTo: function (a, b, c, d) {
            return this.x = a, this.y = b, this.width = c, this.height = d, this
        }, scale: function (a, b) {
            return void 0 === b && (b = a), this.width *= a, this.height *= b, this
        }, centerOn: function (a, b) {
            return this.centerX = a, this.centerY = b, this
        }, floor: function () {
            this.x = Math.floor(this.x), this.y = Math.floor(this.y)
        }, floorAll: function () {
            this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.width = Math.floor(this.width), this.height = Math.floor(this.height)
        }, ceil: function () {
            this.x = Math.ceil(this.x), this.y = Math.ceil(this.y)
        }, ceilAll: function () {
            this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.width = Math.ceil(this.width), this.height = Math.ceil(this.height)
        }, copyFrom: function (a) {
            return this.setTo(a.x, a.y, a.width, a.height)
        }, copyTo: function (a) {
            return a.x = this.x, a.y = this.y, a.width = this.width, a.height = this.height, a
        }, inflate: function (a, b) {
            return c.Rectangle.inflate(this, a, b)
        }, size: function (a) {
            return c.Rectangle.size(this, a)
        }, resize: function (a, b) {
            return this.width = a, this.height = b, this
        }, clone: function (a) {
            return c.Rectangle.clone(this, a)
        }, contains: function (a, b) {
            return c.Rectangle.contains(this, a, b)
        }, containsRect: function (a) {
            return c.Rectangle.containsRect(a, this)
        }, equals: function (a) {
            return c.Rectangle.equals(this, a)
        }, intersection: function (a, b) {
            return c.Rectangle.intersection(this, a, b)
        }, intersects: function (a) {
            return c.Rectangle.intersects(this, a)
        }, intersectsRaw: function (a, b, d, e, f) {
            return c.Rectangle.intersectsRaw(this, a, b, d, e, f)
        }, union: function (a, b) {
            return c.Rectangle.union(this, a, b)
        }, random: function (a) {
            return void 0 === a && (a = new c.Point), a.x = this.randomX, a.y = this.randomY, a
        }, getPoint: function (a, b) {
            switch (void 0 === b && (b = new c.Point), a) {
                default:
                case c.TOP_LEFT:
                    return b.set(this.x, this.y);
                case c.TOP_CENTER:
                    return b.set(this.centerX, this.y);
                case c.TOP_RIGHT:
                    return b.set(this.right, this.y);
                case c.LEFT_CENTER:
                    return b.set(this.x, this.centerY);
                case c.CENTER:
                    return b.set(this.centerX, this.centerY);
                case c.RIGHT_CENTER:
                    return b.set(this.right, this.centerY);
                case c.BOTTOM_LEFT:
                    return b.set(this.x, this.bottom);
                case c.BOTTOM_CENTER:
                    return b.set(this.centerX, this.bottom);
                case c.BOTTOM_RIGHT:
                    return b.set(this.right, this.bottom)
            }
        }, toString: function () {
            return "[{Rectangle (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + " empty=" + this.empty + ")}]"
        }
    }, Object.defineProperty(c.Rectangle.prototype, "halfWidth", {
        get: function () {
            return Math.round(this.width / 2)
        }
    }), Object.defineProperty(c.Rectangle.prototype, "halfHeight", {
        get: function () {
            return Math.round(this.height / 2)
        }
    }), Object.defineProperty(c.Rectangle.prototype, "bottom", {
        get: function () {
            return this.y + this.height
        }, set: function (a) {
            a <= this.y ? this.height = 0 : this.height = a - this.y
        }
    }), Object.defineProperty(c.Rectangle.prototype, "bottomLeft", {
        get: function () {
            return new c.Point(this.x, this.bottom)
        }, set: function (a) {
            this.x = a.x, this.bottom = a.y
        }
    }), Object.defineProperty(c.Rectangle.prototype, "bottomRight", {
        get: function () {
            return new c.Point(this.right, this.bottom)
        }, set: function (a) {
            this.right = a.x, this.bottom = a.y
        }
    }), Object.defineProperty(c.Rectangle.prototype, "left", {
        get: function () {
            return this.x
        }, set: function (a) {
            a >= this.right ? this.width = 0 : this.width = this.right - a, this.x = a
        }
    }), Object.defineProperty(c.Rectangle.prototype, "right", {
        get: function () {
            return this.x + this.width
        }, set: function (a) {
            a <= this.x ? this.width = 0 : this.width = a - this.x
        }
    }), Object.defineProperty(c.Rectangle.prototype, "volume", {
        get: function () {
            return this.width * this.height
        }
    }), Object.defineProperty(c.Rectangle.prototype, "perimeter", {
        get: function () {
            return 2 * this.width + 2 * this.height
        }
    }), Object.defineProperty(c.Rectangle.prototype, "centerX", {
        get: function () {
            return this.x + this.halfWidth
        }, set: function (a) {
            this.x = a - this.halfWidth
        }
    }), Object.defineProperty(c.Rectangle.prototype, "centerY", {
        get: function () {
            return this.y + this.halfHeight
        }, set: function (a) {
            this.y = a - this.halfHeight
        }
    }), Object.defineProperty(c.Rectangle.prototype, "randomX", {
        get: function () {
            return this.x + Math.random() * this.width
        }
    }), Object.defineProperty(c.Rectangle.prototype, "randomY", {
        get: function () {
            return this.y + Math.random() * this.height
        }
    }), Object.defineProperty(c.Rectangle.prototype, "top", {
        get: function () {
            return this.y
        }, set: function (a) {
            a >= this.bottom ? (this.height = 0, this.y = a) : this.height = this.bottom - a
        }
    }), Object.defineProperty(c.Rectangle.prototype, "topLeft", {
        get: function () {
            return new c.Point(this.x, this.y)
        }, set: function (a) {
            this.x = a.x, this.y = a.y
        }
    }), Object.defineProperty(c.Rectangle.prototype, "topRight", {
        get: function () {
            return new c.Point(this.x + this.width, this.y)
        }, set: function (a) {
            this.right = a.x, this.y = a.y
        }
    }),Object.defineProperty(c.Rectangle.prototype, "empty", {
        get: function () {
            return !this.width || !this.height
        }, set: function (a) {
            a === !0 && this.setTo(0, 0, 0, 0)
        }
    }),c.Rectangle.prototype.constructor = c.Rectangle,c.Rectangle.inflate = function (a, b, c) {
        return a.x -= b, a.width += 2 * b, a.y -= c, a.height += 2 * c, a
    },c.Rectangle.inflatePoint = function (a, b) {
        return c.Rectangle.inflate(a, b.x, b.y)
    },c.Rectangle.size = function (a, b) {
        return void 0 === b || null === b ? b = new c.Point(a.width, a.height) : b.setTo(a.width, a.height), b
    },c.Rectangle.clone = function (a, b) {
        return void 0 === b || null === b ? b = new c.Rectangle(a.x, a.y, a.width, a.height) : b.setTo(a.x, a.y, a.width, a.height), b
    },c.Rectangle.contains = function (a, b, c) {
        return a.width <= 0 || a.height <= 0 ? !1 : b >= a.x && b < a.right && c >= a.y && c < a.bottom
    },c.Rectangle.containsRaw = function (a, b, c, d, e, f) {
        return e >= a && a + c > e && f >= b && b + d > f
    },c.Rectangle.containsPoint = function (a, b) {
        return c.Rectangle.contains(a, b.x, b.y)
    },c.Rectangle.containsRect = function (a, b) {
        return a.volume > b.volume ? !1 : a.x >= b.x && a.y >= b.y && a.right < b.right && a.bottom < b.bottom
    },c.Rectangle.equals = function (a, b) {
        return a.x == b.x && a.y == b.y && a.width == b.width && a.height == b.height
    },c.Rectangle.sameDimensions = function (a, b) {
        return a.width === b.width && a.height === b.height
    },c.Rectangle.intersection = function (a, b, d) {
        return void 0 === d && (d = new c.Rectangle), c.Rectangle.intersects(a, b) && (d.x = Math.max(a.x, b.x), d.y = Math.max(a.y, b.y), d.width = Math.min(a.right, b.right) - d.x, d.height = Math.min(a.bottom, b.bottom) - d.y), d
    },c.Rectangle.intersects = function (a, b) {
        return a.width <= 0 || a.height <= 0 || b.width <= 0 || b.height <= 0 ? !1 : !(a.right < b.x || a.bottom < b.y || a.x > b.right || a.y > b.bottom)
    },c.Rectangle.intersectsRaw = function (a, b, c, d, e, f) {
        return void 0 === f && (f = 0), !(b > a.right + f || c < a.left - f || d > a.bottom + f || e < a.top - f)
    },c.Rectangle.union = function (a, b, d) {
        return void 0 === d && (d = new c.Rectangle), d.setTo(Math.min(a.x, b.x), Math.min(a.y, b.y), Math.max(a.right, b.right) - Math.min(a.left, b.left), Math.max(a.bottom, b.bottom) - Math.min(a.top, b.top))
    },c.Rectangle.aabb = function (a, b) {
        void 0 === b && (b = new c.Rectangle);
        var d = Number.NEGATIVE_INFINITY, e = Number.POSITIVE_INFINITY, f = Number.NEGATIVE_INFINITY, g = Number.POSITIVE_INFINITY;
        return a.forEach(function (a) {
            a.x > d && (d = a.x), a.x < e && (e = a.x), a.y > f && (f = a.y), a.y < g && (g = a.y)
        }), b.setTo(e, g, d - e, f - g), b
    },PIXI.Rectangle = c.Rectangle,PIXI.EmptyRectangle = new c.Rectangle(0, 0, 0, 0),c.RoundedRectangle = function (a, b, d, e, f) {
        void 0 === a && (a = 0), void 0 === b && (b = 0), void 0 === d && (d = 0), void 0 === e && (e = 0), void 0 === f && (f = 20), this.x = a, this.y = b, this.width = d, this.height = e, this.radius = f || 20, this.type = c.ROUNDEDRECTANGLE
    },c.RoundedRectangle.prototype = {
        clone: function () {
            return new c.RoundedRectangle(this.x, this.y, this.width, this.height, this.radius)
        }, contains: function (a, b) {
            if (this.width <= 0 || this.height <= 0)return !1;
            var c = this.x;
            if (a >= c && a <= c + this.width) {
                var d = this.y;
                if (b >= d && b <= d + this.height)return !0
            }
            return !1
        }
    },c.RoundedRectangle.prototype.constructor = c.RoundedRectangle,PIXI.RoundedRectangle = c.RoundedRectangle,c.Camera = function (a, b, d, e, f, g) {
        this.game = a, this.world = a.world, this.id = 0, this.view = new c.Rectangle(d, e, f, g), this.bounds = new c.Rectangle(d, e, f, g), this.deadzone = null, this.visible = !0, this.roundPx = !0, this.atLimit = {
            x: !1,
            y: !1
        }, this.target = null, this.displayObject = null, this.scale = null, this.totalInView = 0, this.lerp = new c.Point(1, 1), this.onShakeComplete = new c.Signal, this.onFlashComplete = new c.Signal, this.onFadeComplete = new c.Signal, this.fx = null, this._targetPosition = new c.Point, this._edge = 0, this._position = new c.Point, this._shake = {
            intensity: 0,
            duration: 0,
            horizontal: !1,
            vertical: !1,
            shakeBounds: !0,
            x: 0,
            y: 0
        }, this._fxDuration = 0, this._fxType = 0
    },c.Camera.FOLLOW_LOCKON = 0,c.Camera.FOLLOW_PLATFORMER = 1,c.Camera.FOLLOW_TOPDOWN = 2,c.Camera.FOLLOW_TOPDOWN_TIGHT = 3,c.Camera.SHAKE_BOTH = 4,c.Camera.SHAKE_HORIZONTAL = 5,c.Camera.SHAKE_VERTICAL = 6,c.Camera.ENABLE_FX = !0,c.Camera.prototype = {
        boot: function () {
            this.displayObject = this.game.world, this.scale = this.game.world.scale, this.game.camera = this, c.Graphics && c.Camera.ENABLE_FX && (this.fx = new c.Graphics(this.game), this.game.stage.addChild(this.fx))
        }, preUpdate: function () {
            this.totalInView = 0
        }, follow: function (a, b, d, e) {
            void 0 === b && (b = c.Camera.FOLLOW_LOCKON), void 0 === d && (d = 1), void 0 === e && (e = 1), this.target = a, this.lerp.set(d, e);
            var f;
            switch (b) {
                case c.Camera.FOLLOW_PLATFORMER:
                    var g = this.width / 8, h = this.height / 3;
                    this.deadzone = new c.Rectangle((this.width - g) / 2, (this.height - h) / 2 - .25 * h, g, h);
                    break;
                case c.Camera.FOLLOW_TOPDOWN:
                    f = Math.max(this.width, this.height) / 4, this.deadzone = new c.Rectangle((this.width - f) / 2, (this.height - f) / 2, f, f);
                    break;
                case c.Camera.FOLLOW_TOPDOWN_TIGHT:
                    f = Math.max(this.width, this.height) / 8, this.deadzone = new c.Rectangle((this.width - f) / 2, (this.height - f) / 2, f, f);
                    break;
                case c.Camera.FOLLOW_LOCKON:
                    this.deadzone = null;
                    break;
                default:
                    this.deadzone = null
            }
        }, unfollow: function () {
            this.target = null
        }, focusOn: function (a) {
            this.setPosition(Math.round(a.x - this.view.halfWidth), Math.round(a.y - this.view.halfHeight))
        }, focusOnXY: function (a, b) {
            this.setPosition(Math.round(a - this.view.halfWidth), Math.round(b - this.view.halfHeight))
        }, shake: function (a, b, d, e, f) {
            return void 0 === a && (a = .05), void 0 === b && (b = 500), void 0 === d && (d = !0), void 0 === e && (e = c.Camera.SHAKE_BOTH), void 0 === f && (f = !0), !d && this._shake.duration > 0 ? !1 : (this._shake.intensity = a, this._shake.duration = b, this._shake.shakeBounds = f, this._shake.x = 0, this._shake.y = 0, this._shake.horizontal = e === c.Camera.SHAKE_BOTH || e === c.Camera.SHAKE_HORIZONTAL, this._shake.vertical = e === c.Camera.SHAKE_BOTH || e === c.Camera.SHAKE_VERTICAL, !0)
        }, flash: function (a, b, c) {
            return void 0 === a && (a = 16777215), void 0 === b && (b = 500), void 0 === c && (c = !1), !this.fx || !c && this._fxDuration > 0 ? !1 : (this.fx.clear(), this.fx.beginFill(a), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), this.fx.alpha = 1, this._fxDuration = b, this._fxType = 0, !0)
        }, fade: function (a, b, c) {
            return void 0 === a && (a = 0), void 0 === b && (b = 500), void 0 === c && (c = !1), !this.fx || !c && this._fxDuration > 0 ? !1 : (this.fx.clear(), this.fx.beginFill(a), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), this.fx.alpha = 0, this._fxDuration = b, this._fxType = 1, !0)
        }, update: function () {
            this._fxDuration > 0 && this.updateFX(), this._shake.duration > 0 && this.updateShake(), this.bounds && this.checkBounds(), this.roundPx && (this.view.floor(), this._shake.x = Math.floor(this._shake.x), this._shake.y = Math.floor(this._shake.y)), this.displayObject.position.x = -this.view.x,
                this.displayObject.position.y = -this.view.y
        }, updateFX: function () {
            0 === this._fxType ? (this.fx.alpha -= this.game.time.elapsedMS / this._fxDuration, this.fx.alpha <= 0 && (this._fxDuration = 0, this.fx.alpha = 0, this.onFlashComplete.dispatch())) : (this.fx.alpha += this.game.time.elapsedMS / this._fxDuration, this.fx.alpha >= 1 && (this._fxDuration = 0, this.fx.alpha = 1, this.onFadeComplete.dispatch()))
        }, updateShake: function () {
            this._shake.duration -= this.game.time.elapsedMS, this._shake.duration <= 0 ? (this.onShakeComplete.dispatch(), this._shake.x = 0, this._shake.y = 0) : (this._shake.horizontal && (this._shake.x = this.game.rnd.frac() * this._shake.intensity * this.view.width * 2 - this._shake.intensity * this.view.width), this._shake.vertical && (this._shake.y = this.game.rnd.frac() * this._shake.intensity * this.view.height * 2 - this._shake.intensity * this.view.height))
        }, updateTarget: function () {
            this._targetPosition.x = this.view.x + this.target.worldPosition.x, this._targetPosition.y = this.view.y + this.target.worldPosition.y, this.deadzone ? (this._edge = this._targetPosition.x - this.view.x, this._edge < this.deadzone.left ? this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.left, this.lerp.x) : this._edge > this.deadzone.right && (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.right, this.lerp.x)), this._edge = this._targetPosition.y - this.view.y, this._edge < this.deadzone.top ? this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.top, this.lerp.y) : this._edge > this.deadzone.bottom && (this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.bottom, this.lerp.y))) : (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.view.halfWidth, this.lerp.x), this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.view.halfHeight, this.lerp.y)), this.bounds && this.checkBounds(), this.roundPx && this.view.floor(), this.displayObject.position.x = -this.view.x, this.displayObject.position.y = -this.view.y
        }, setBoundsToWorld: function () {
            this.bounds && this.bounds.copyFrom(this.game.world.bounds)
        }, checkBounds: function () {
            this.atLimit.x = !1, this.atLimit.y = !1;
            var a = this.view.x + this._shake.x, b = this.view.right + this._shake.x, c = this.view.y + this._shake.y, d = this.view.bottom + this._shake.y;
            a <= this.bounds.x * this.scale.x && (this.atLimit.x = !0, this.view.x = this.bounds.x * this.scale.x, this._shake.shakeBounds || (this._shake.x = 0)), b >= this.bounds.right * this.scale.x && (this.atLimit.x = !0, this.view.x = this.bounds.right * this.scale.x - this.width, this._shake.shakeBounds || (this._shake.x = 0)), c <= this.bounds.top * this.scale.y && (this.atLimit.y = !0, this.view.y = this.bounds.top * this.scale.y, this._shake.shakeBounds || (this._shake.y = 0)), d >= this.bounds.bottom * this.scale.y && (this.atLimit.y = !0, this.view.y = this.bounds.bottom * this.scale.y - this.height, this._shake.shakeBounds || (this._shake.y = 0))
        }, setPosition: function (a, b) {
            this.view.x = a, this.view.y = b, this.bounds && this.checkBounds()
        }, setSize: function (a, b) {
            this.view.width = a, this.view.height = b
        }, reset: function () {
            this.target = null, this.view.x = 0, this.view.y = 0, this._shake.duration = 0, this.resetFX()
        }, resetFX: function () {
            this.fx.clear(), this.fx.alpha = 0, this._fxDuration = 0
        }
    },c.Camera.prototype.constructor = c.Camera,Object.defineProperty(c.Camera.prototype, "x", {
        get: function () {
            return this.view.x
        }, set: function (a) {
            this.view.x = a, this.bounds && this.checkBounds()
        }
    }),Object.defineProperty(c.Camera.prototype, "y", {
        get: function () {
            return this.view.y
        }, set: function (a) {
            this.view.y = a, this.bounds && this.checkBounds()
        }
    }),Object.defineProperty(c.Camera.prototype, "position", {
        get: function () {
            return this._position.set(this.view.x, this.view.y), this._position
        }, set: function (a) {
            "undefined" != typeof a.x && (this.view.x = a.x), "undefined" != typeof a.y && (this.view.y = a.y), this.bounds && this.checkBounds()
        }
    }),Object.defineProperty(c.Camera.prototype, "width", {
        get: function () {
            return this.view.width
        }, set: function (a) {
            this.view.width = a
        }
    }),Object.defineProperty(c.Camera.prototype, "height", {
        get: function () {
            return this.view.height
        }, set: function (a) {
            this.view.height = a
        }
    }),Object.defineProperty(c.Camera.prototype, "shakeIntensity", {
        get: function () {
            return this._shake.intensity
        }, set: function (a) {
            this._shake.intensity = a
        }
    }),c.State = function () {
        this.game = null, this.key = "", this.add = null, this.make = null, this.camera = null, this.cache = null, this.input = null, this.load = null, this.math = null, this.sound = null, this.scale = null, this.stage = null, this.state = null, this.time = null, this.tweens = null, this.world = null, this.particles = null, this.physics = null, this.rnd = null
    },c.State.prototype = {
        init: function () {
        }, preload: function () {
        }, loadUpdate: function () {
        }, loadRender: function () {
        }, create: function () {
        }, update: function () {
        }, preRender: function () {
        }, render: function () {
        }, resize: function () {
        }, paused: function () {
        }, resumed: function () {
        }, pauseUpdate: function () {
        }, shutdown: function () {
        }
    },c.State.prototype.constructor = c.State,c.StateManager = function (a, b) {
        this.game = a, this.states = {}, this._pendingState = null, "undefined" != typeof b && null !== b && (this._pendingState = b), this._clearWorld = !1, this._clearCache = !1, this._created = !1, this._args = [], this.current = "", this.onStateChange = new c.Signal, this.onInitCallback = null, this.onPreloadCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, this.onPreRenderCallback = null, this.onLoadUpdateCallback = null, this.onLoadRenderCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.onShutDownCallback = null
    },c.StateManager.prototype = {
        boot: function () {
            this.game.onPause.add(this.pause, this), this.game.onResume.add(this.resume, this), null !== this._pendingState && "string" != typeof this._pendingState && this.add("default", this._pendingState, !0)
        }, add: function (a, b, d) {
            void 0 === d && (d = !1);
            var e;
            return b instanceof c.State ? e = b : "object" == typeof b ? (e = b, e.game = this.game) : "function" == typeof b && (e = new b(this.game)), this.states[a] = e, d && (this.game.isBooted ? this.start(a) : this._pendingState = a), e
        }, remove: function (a) {
            this.current === a && (this.callbackContext = null, this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onPreRenderCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null), delete this.states[a]
        }, start: function (a, b, c) {
            void 0 === b && (b = !0), void 0 === c && (c = !1), this.checkState(a) && (this._pendingState = a, this._clearWorld = b, this._clearCache = c, arguments.length > 3 && (this._args = Array.prototype.splice.call(arguments, 3)))
        }, restart: function (a, b) {
            void 0 === a && (a = !0), void 0 === b && (b = !1), this._pendingState = this.current, this._clearWorld = a, this._clearCache = b, arguments.length > 2 && (this._args = Array.prototype.slice.call(arguments, 2))
        }, dummy: function () {
        }, preUpdate: function () {
            if (this._pendingState && this.game.isBooted) {
                var a = this.current;
                if (this.clearCurrentState(), this.setCurrentState(this._pendingState), this.onStateChange.dispatch(this.current, a), this.current !== this._pendingState)return;
                this._pendingState = null, this.onPreloadCallback ? (this.game.load.reset(!0), this.onPreloadCallback.call(this.callbackContext, this.game), 0 === this.game.load.totalQueuedFiles() && 0 === this.game.load.totalQueuedPacks() ? this.loadComplete() : this.game.load.start()) : this.loadComplete()
            }
        }, clearCurrentState: function () {
            this.current && (this.onShutDownCallback && this.onShutDownCallback.call(this.callbackContext, this.game), this.game.tweens.removeAll(), this.game.camera.reset(), this.game.input.reset(!0), this.game.physics.clear(), this.game.time.removeAll(), this.game.scale.reset(this._clearWorld), this.game.debug && this.game.debug.reset(), this._clearWorld && (this.game.world.shutdown(), this._clearCache && this.game.cache.destroy()))
        }, checkState: function (a) {
            return this.states[a] ? this.states[a].preload || this.states[a].create || this.states[a].update || this.states[a].render ? !0 : (console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render"), !1) : (console.warn("Phaser.StateManager - No state found with the key: " + a), !1)
        }, link: function (a) {
            this.states[a].game = this.game, this.states[a].add = this.game.add, this.states[a].make = this.game.make, this.states[a].camera = this.game.camera, this.states[a].cache = this.game.cache, this.states[a].input = this.game.input, this.states[a].load = this.game.load, this.states[a].math = this.game.math, this.states[a].sound = this.game.sound, this.states[a].scale = this.game.scale, this.states[a].state = this, this.states[a].stage = this.game.stage, this.states[a].time = this.game.time, this.states[a].tweens = this.game.tweens, this.states[a].world = this.game.world, this.states[a].particles = this.game.particles, this.states[a].rnd = this.game.rnd, this.states[a].physics = this.game.physics, this.states[a].key = a
        }, unlink: function (a) {
            this.states[a] && (this.states[a].game = null, this.states[a].add = null, this.states[a].make = null, this.states[a].camera = null, this.states[a].cache = null, this.states[a].input = null, this.states[a].load = null, this.states[a].math = null, this.states[a].sound = null, this.states[a].scale = null, this.states[a].state = null, this.states[a].stage = null, this.states[a].time = null, this.states[a].tweens = null, this.states[a].world = null, this.states[a].particles = null, this.states[a].rnd = null, this.states[a].physics = null)
        }, setCurrentState: function (a) {
            this.callbackContext = this.states[a], this.link(a), this.onInitCallback = this.states[a].init || this.dummy, this.onPreloadCallback = this.states[a].preload || null, this.onLoadRenderCallback = this.states[a].loadRender || null, this.onLoadUpdateCallback = this.states[a].loadUpdate || null, this.onCreateCallback = this.states[a].create || null, this.onUpdateCallback = this.states[a].update || null, this.onPreRenderCallback = this.states[a].preRender || null, this.onRenderCallback = this.states[a].render || null, this.onResizeCallback = this.states[a].resize || null, this.onPausedCallback = this.states[a].paused || null, this.onResumedCallback = this.states[a].resumed || null, this.onPauseUpdateCallback = this.states[a].pauseUpdate || null, this.onShutDownCallback = this.states[a].shutdown || this.dummy, "" !== this.current && this.game.physics.reset(), this.current = a, this._created = !1, this.onInitCallback.apply(this.callbackContext, this._args), a === this._pendingState && (this._args = []), this.game._kickstart = !0
        }, getCurrentState: function () {
            return this.states[this.current]
        }, loadComplete: function () {
            this._created === !1 && this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game), this._created === !1 && this.onCreateCallback ? (this._created = !0, this.onCreateCallback.call(this.callbackContext, this.game)) : this._created = !0
        }, pause: function () {
            this._created && this.onPausedCallback && this.onPausedCallback.call(this.callbackContext, this.game)
        }, resume: function () {
            this._created && this.onResumedCallback && this.onResumedCallback.call(this.callbackContext, this.game)
        }, update: function () {
            this._created ? this.onUpdateCallback && this.onUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game)
        }, pauseUpdate: function () {
            this._created ? this.onPauseUpdateCallback && this.onPauseUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game)
        }, preRender: function (a) {
            this._created && this.onPreRenderCallback && this.onPreRenderCallback.call(this.callbackContext, this.game, a)
        }, resize: function (a, b) {
            this.onResizeCallback && this.onResizeCallback.call(this.callbackContext, a, b)
        }, render: function () {
            this._created ? this.onRenderCallback && (this.game.renderType === c.CANVAS ? (this.game.context.save(), this.game.context.setTransform(1, 0, 0, 1, 0, 0), this.onRenderCallback.call(this.callbackContext, this.game), this.game.context.restore()) : this.onRenderCallback.call(this.callbackContext, this.game)) : this.onLoadRenderCallback && this.onLoadRenderCallback.call(this.callbackContext, this.game)
        }, destroy: function () {
            this._clearWorld = !0, this._clearCache = !0, this.clearCurrentState(), this.callbackContext = null, this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onRenderCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.game = null, this.states = {}, this._pendingState = null, this.current = ""
        }
    },c.StateManager.prototype.constructor = c.StateManager,Object.defineProperty(c.StateManager.prototype, "created", {
        get: function () {
            return this._created
        }
    }),c.Signal = function () {
    },c.Signal.prototype = {
        _bindings: null,
        _prevParams: null,
        memorize: !1,
        _shouldPropagate: !0,
        active: !0,
        _boundDispatch: !1,
        validateListener: function (a, b) {
            if ("function" != typeof a)throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}", b))
        },
        _registerListener: function (a, b, d, e, f) {
            var g, h = this._indexOfListener(a, d);
            if (-1 !== h) {
                if (g = this._bindings[h], g.isOnce() !== b)throw new Error("You cannot add" + (b ? "" : "Once") + "() then add" + (b ? "Once" : "") + "() the same listener without removing the relationship first.")
            } else g = new c.SignalBinding(this, a, b, d, e, f), this._addBinding(g);
            return this.memorize && this._prevParams && g.execute(this._prevParams), g
        },
        _addBinding: function (a) {
            this._bindings || (this._bindings = []);
            var b = this._bindings.length;
            do b--; while (this._bindings[b] && a._priority <= this._bindings[b]._priority);
            this._bindings.splice(b + 1, 0, a)
        },
        _indexOfListener: function (a, b) {
            if (!this._bindings)return -1;
            void 0 === b && (b = null);
            for (var c, d = this._bindings.length; d--;)if (c = this._bindings[d], c._listener === a && c.context === b)return d;
            return -1
        },
        has: function (a, b) {
            return -1 !== this._indexOfListener(a, b)
        },
        add: function (a, b, c) {
            this.validateListener(a, "add");
            var d = [];
            if (arguments.length > 3)for (var e = 3; e < arguments.length; e++)d.push(arguments[e]);
            return this._registerListener(a, !1, b, c, d)
        },
        addOnce: function (a, b, c) {
            this.validateListener(a, "addOnce");
            var d = [];
            if (arguments.length > 3)for (var e = 3; e < arguments.length; e++)d.push(arguments[e]);
            return this._registerListener(a, !0, b, c, d)
        },
        remove: function (a, b) {
            this.validateListener(a, "remove");
            var c = this._indexOfListener(a, b);
            return -1 !== c && (this._bindings[c]._destroy(), this._bindings.splice(c, 1)), a
        },
        removeAll: function (a) {
            if (void 0 === a && (a = null), this._bindings) {
                for (var b = this._bindings.length; b--;)a ? this._bindings[b].context === a && (this._bindings[b]._destroy(), this._bindings.splice(b, 1)) : this._bindings[b]._destroy();
                a || (this._bindings.length = 0)
            }
        },
        getNumListeners: function () {
            return this._bindings ? this._bindings.length : 0
        },
        halt: function () {
            this._shouldPropagate = !1
        },
        dispatch: function () {
            if (this.active && this._bindings) {
                var a, b = Array.prototype.slice.call(arguments), c = this._bindings.length;
                if (this.memorize && (this._prevParams = b), c) {
                    a = this._bindings.slice(), this._shouldPropagate = !0;
                    do c--; while (a[c] && this._shouldPropagate && a[c].execute(b) !== !1)
                }
            }
        },
        forget: function () {
            this._prevParams && (this._prevParams = null)
        },
        dispose: function () {
            this.removeAll(), this._bindings = null, this._prevParams && (this._prevParams = null)
        },
        toString: function () {
            return "[Phaser.Signal active:" + this.active + " numListeners:" + this.getNumListeners() + "]"
        }
    },Object.defineProperty(c.Signal.prototype, "boundDispatch", {
        get: function () {
            var a = this;
            return this._boundDispatch || (this._boundDispatch = function () {
                    return a.dispatch.apply(a, arguments)
                })
        }
    }),c.Signal.prototype.constructor = c.Signal,c.SignalBinding = function (a, b, c, d, e, f) {
        this._listener = b, c && (this._isOnce = !0), null != d && (this.context = d), this._signal = a, e && (this._priority = e), f && f.length && (this._args = f)
    },c.SignalBinding.prototype = {
        context: null,
        _isOnce: !1,
        _priority: 0,
        _args: null,
        callCount: 0,
        active: !0,
        params: null,
        execute: function (a) {
            var b, c;
            return this.active && this._listener && (c = this.params ? this.params.concat(a) : a, this._args && (c = c.concat(this._args)), b = this._listener.apply(this.context, c), this.callCount++, this._isOnce && this.detach()), b
        },
        detach: function () {
            return this.isBound() ? this._signal.remove(this._listener, this.context) : null
        },
        isBound: function () {
            return !!this._signal && !!this._listener
        },
        isOnce: function () {
            return this._isOnce
        },
        getListener: function () {
            return this._listener
        },
        getSignal: function () {
            return this._signal
        },
        _destroy: function () {
            delete this._signal, delete this._listener, delete this.context
        },
        toString: function () {
            return "[Phaser.SignalBinding isOnce:" + this._isOnce + ", isBound:" + this.isBound() + ", active:" + this.active + "]"
        }
    },c.SignalBinding.prototype.constructor = c.SignalBinding,c.Filter = function (a, b, d) {
        this.game = a, this.type = c.WEBGL_FILTER, this.passes = [this], this.shaders = [], this.dirty = !0, this.padding = 0, this.prevPoint = new c.Point;
        var e = new Date;
        if (this.uniforms = {
                resolution: {type: "2f", value: {x: 256, y: 256}},
                time: {type: "1f", value: 0},
                mouse: {type: "2f", value: {x: 0, y: 0}},
                date: {
                    type: "4fv",
                    value: [e.getFullYear(), e.getMonth(), e.getDate(), 60 * e.getHours() * 60 + 60 * e.getMinutes() + e.getSeconds()]
                },
                sampleRate: {type: "1f", value: 44100},
                iChannel0: {type: "sampler2D", value: null, textureData: {repeat: !0}},
                iChannel1: {type: "sampler2D", value: null, textureData: {repeat: !0}},
                iChannel2: {type: "sampler2D", value: null, textureData: {repeat: !0}},
                iChannel3: {type: "sampler2D", value: null, textureData: {repeat: !0}}
            }, b)for (var f in b)this.uniforms[f] = b[f];
        this.fragmentSrc = d || ""
    },c.Filter.prototype = {
        init: function () {
        }, setResolution: function (a, b) {
            this.uniforms.resolution.value.x = a, this.uniforms.resolution.value.y = b
        }, update: function (a) {
            if ("undefined" != typeof a) {
                var b = a.x / this.game.width, c = 1 - a.y / this.game.height;
                (b !== this.prevPoint.x || c !== this.prevPoint.y) && (this.uniforms.mouse.value.x = b.toFixed(2), this.uniforms.mouse.value.y = c.toFixed(2), this.prevPoint.set(b, c))
            }
            this.uniforms.time.value = this.game.time.totalElapsedSeconds()
        }, addToWorld: function (a, b, c, d, e, f) {
            void 0 === e && (e = 0), void 0 === f && (f = 0), void 0 !== c && null !== c ? this.width = c : c = this.width, void 0 !== d && null !== d ? this.height = d : d = this.height;
            var g = this.game.add.image(a, b, "__default");
            return g.width = c, g.height = d, g.anchor.set(e, f), g.filters = [this], g
        }, destroy: function () {
            this.game = null
        }
    },c.Filter.prototype.constructor = c.Filter,Object.defineProperty(c.Filter.prototype, "width", {
        get: function () {
            return this.uniforms.resolution.value.x
        }, set: function (a) {
            this.uniforms.resolution.value.x = a
        }
    }),Object.defineProperty(c.Filter.prototype, "height", {
        get: function () {
            return this.uniforms.resolution.value.y
        }, set: function (a) {
            this.uniforms.resolution.value.y = a
        }
    }),c.Plugin = function (a, b) {
        void 0 === b && (b = null), this.game = a, this.parent = b, this.active = !1, this.visible = !1, this.hasPreUpdate = !1, this.hasUpdate = !1, this.hasPostUpdate = !1, this.hasRender = !1, this.hasPostRender = !1
    },c.Plugin.prototype = {
        preUpdate: function () {
        }, update: function () {
        }, render: function () {
        }, postRender: function () {
        }, destroy: function () {
            this.game = null, this.parent = null, this.active = !1, this.visible = !1
        }
    },c.Plugin.prototype.constructor = c.Plugin,c.PluginManager = function (a) {
        this.game = a, this.plugins = [], this._len = 0, this._i = 0
    },c.PluginManager.prototype = {
        add: function (a) {
            var b = Array.prototype.slice.call(arguments, 1), c = !1;
            return "function" == typeof a ? a = new a(this.game, this) : (a.game = this.game, a.parent = this), "function" == typeof a.preUpdate && (a.hasPreUpdate = !0, c = !0), "function" == typeof a.update && (a.hasUpdate = !0, c = !0), "function" == typeof a.postUpdate && (a.hasPostUpdate = !0, c = !0), "function" == typeof a.render && (a.hasRender = !0, c = !0), "function" == typeof a.postRender && (a.hasPostRender = !0, c = !0), c ? ((a.hasPreUpdate || a.hasUpdate || a.hasPostUpdate) && (a.active = !0), (a.hasRender || a.hasPostRender) && (a.visible = !0), this._len = this.plugins.push(a), "function" == typeof a.init && a.init.apply(a, b), a) : null
        }, remove: function (a, b) {
            for (void 0 === b && (b = !0), this._i = this._len; this._i--;)if (this.plugins[this._i] === a)return b && a.destroy(), this.plugins.splice(this._i, 1), void this._len--
        }, removeAll: function () {
            for (this._i = this._len; this._i--;)this.plugins[this._i].destroy();
            this.plugins.length = 0, this._len = 0
        }, preUpdate: function () {
            for (this._i = this._len; this._i--;)this.plugins[this._i].active && this.plugins[this._i].hasPreUpdate && this.plugins[this._i].preUpdate()
        }, update: function () {
            for (this._i = this._len; this._i--;)this.plugins[this._i].active && this.plugins[this._i].hasUpdate && this.plugins[this._i].update()
        }, postUpdate: function () {
            for (this._i = this._len; this._i--;)this.plugins[this._i].active && this.plugins[this._i].hasPostUpdate && this.plugins[this._i].postUpdate()
        }, render: function () {
            for (this._i = this._len; this._i--;)this.plugins[this._i].visible && this.plugins[this._i].hasRender && this.plugins[this._i].render()
        }, postRender: function () {
            for (this._i = this._len; this._i--;)this.plugins[this._i].visible && this.plugins[this._i].hasPostRender && this.plugins[this._i].postRender()
        }, destroy: function () {
            this.removeAll(), this.game = null
        }
    },c.PluginManager.prototype.constructor = c.PluginManager,c.Stage = function (a) {
        this.game = a, PIXI.DisplayObjectContainer.call(this), this.name = "_stage_root", this.disableVisibilityChange = !1, this.exists = !0, this.worldTransform = new PIXI.Matrix, this.stage = this, this.currentRenderOrderID = 0, this._hiddenVar = "hidden", this._onChange = null, this._bgColor = {
            r: 0,
            g: 0,
            b: 0,
            a: 0,
            color: 0,
            rgba: "#000000"
        }, this.game.transparent || (this._bgColor.a = 1), a.config && this.parseConfig(a.config)
    },c.Stage.prototype = Object.create(PIXI.DisplayObjectContainer.prototype),c.Stage.prototype.constructor = c.Stage,c.Stage.prototype.parseConfig = function (a) {
        a.disableVisibilityChange && (this.disableVisibilityChange = a.disableVisibilityChange), a.backgroundColor && this.setBackgroundColor(a.backgroundColor)
    },c.Stage.prototype.boot = function () {
        c.DOM.getOffset(this.game.canvas, this.offset), c.Canvas.setUserSelect(this.game.canvas, "none"), c.Canvas.setTouchAction(this.game.canvas, "none"), this.checkVisibility()
    },c.Stage.prototype.preUpdate = function () {
        this.currentRenderOrderID = 0;
        for (var a = 0; a < this.children.length; a++)this.children[a].preUpdate()
    },c.Stage.prototype.update = function () {
        for (var a = this.children.length; a--;)this.children[a].update()
    },c.Stage.prototype.postUpdate = function () {
        this.game.camera.update(), this.game.camera.target && (this.game.camera.target.postUpdate(), this.updateTransform(), this.game.camera.updateTarget());
        for (var a = 0; a < this.children.length; a++)this.children[a].postUpdate();
        this.updateTransform()
    },c.Stage.prototype.updateTransform = function () {
        this.worldAlpha = 1;
        for (var a = 0; a < this.children.length; a++)this.children[a].updateTransform()
    },c.Stage.prototype.checkVisibility = function () {
        void 0 !== document.webkitHidden ? this._hiddenVar = "webkitvisibilitychange" : void 0 !== document.mozHidden ? this._hiddenVar = "mozvisibilitychange" : void 0 !== document.msHidden ? this._hiddenVar = "msvisibilitychange" : void 0 !== document.hidden ? this._hiddenVar = "visibilitychange" : this._hiddenVar = null;
        var a = this;
        this._onChange = function (b) {
            return a.visibilityChange(b)
        }, this._hiddenVar && document.addEventListener(this._hiddenVar, this._onChange, !1), window.onblur = this._onChange, window.onfocus = this._onChange, window.onpagehide = this._onChange, window.onpageshow = this._onChange, this.game.device.cocoonJSApp && (CocoonJS.App.onSuspended.addEventListener(function () {
            c.Stage.prototype.visibilityChange.call(a, {type: "pause"})
        }), CocoonJS.App.onActivated.addEventListener(function () {
            c.Stage.prototype.visibilityChange.call(a, {type: "resume"})
        }))
    },c.Stage.prototype.visibilityChange = function (a) {
        return "pagehide" === a.type || "blur" === a.type || "pageshow" === a.type || "focus" === a.type ? void("pagehide" === a.type || "blur" === a.type ? this.game.focusLoss(a) : ("pageshow" === a.type || "focus" === a.type) && this.game.focusGain(a)) : void(this.disableVisibilityChange || (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden || "pause" === a.type ? this.game.gamePaused(a) : this.game.gameResumed(a)))
    },c.Stage.prototype.setBackgroundColor = function (a) {
        this.game.transparent || (c.Color.valueToColor(a, this._bgColor), c.Color.updateColor(this._bgColor), this._bgColor.r /= 255, this._bgColor.g /= 255, this._bgColor.b /= 255, this._bgColor.a = 1)
    },c.Stage.prototype.destroy = function () {
        this._hiddenVar && document.removeEventListener(this._hiddenVar, this._onChange, !1), window.onpagehide = null, window.onpageshow = null, window.onblur = null, window.onfocus = null
    },Object.defineProperty(c.Stage.prototype, "backgroundColor", {
        get: function () {
            return this._bgColor.color
        }, set: function (a) {
            this.setBackgroundColor(a)
        }
    }),Object.defineProperty(c.Stage.prototype, "smoothed", {
        get: function () {
            return PIXI.scaleModes.DEFAULT === PIXI.scaleModes.LINEAR
        }, set: function (a) {
            a ? PIXI.scaleModes.DEFAULT = PIXI.scaleModes.LINEAR : PIXI.scaleModes.DEFAULT = PIXI.scaleModes.NEAREST
        }
    }),c.Group = function (a, b, d, e, f, g) {
        void 0 === e && (e = !1), void 0 === f && (f = !1), void 0 === g && (g = c.Physics.ARCADE), this.game = a, void 0 === b && (b = a.world), this.name = d || "group", this.z = 0, PIXI.DisplayObjectContainer.call(this), e ? (this.game.stage.addChild(this), this.z = this.game.stage.children.length) : b && (b.addChild(this), this.z = b.children.length), this.type = c.GROUP, this.physicsType = c.GROUP, this.alive = !0, this.exists = !0, this.ignoreDestroy = !1, this.pendingDestroy = !1, this.classType = c.Sprite, this.cursor = null, this.inputEnableChildren = !1, this.onChildInputDown = new c.Signal, this.onChildInputUp = new c.Signal, this.onChildInputOver = new c.Signal, this.onChildInputOut = new c.Signal, this.enableBody = f, this.enableBodyDebug = !1, this.physicsBodyType = g, this.physicsSortDirection = null, this.onDestroy = new c.Signal, this.cursorIndex = 0, this.fixedToCamera = !1, this.cameraOffset = new c.Point, this.hash = [], this._sortProperty = "z"
    },c.Group.prototype = Object.create(PIXI.DisplayObjectContainer.prototype),c.Group.prototype.constructor = c.Group,c.Group.RETURN_NONE = 0,c.Group.RETURN_TOTAL = 1,c.Group.RETURN_CHILD = 2,c.Group.SORT_ASCENDING = -1,c.Group.SORT_DESCENDING = 1,c.Group.prototype.add = function (a, b, c) {
        return void 0 === b && (b = !1), a.parent === this ? a : (a.body && a.parent && a.parent.hash && a.parent.removeFromHash(a), void 0 === c ? (a.z = this.children.length, this.addChild(a)) : (this.addChildAt(a, c), this.updateZ()), this.enableBody && a.hasOwnProperty("body") && null === a.body ? this.game.physics.enable(a, this.physicsBodyType) : a.body && this.addToHash(a), this.inputEnableChildren && !a.inputEnabled && (a.inputEnabled = !0), !b && a.events && a.events.onAddedToGroup$dispatch(a, this), null === this.cursor && (this.cursor = a), a)
    },c.Group.prototype.addAt = function (a, b, c) {
        this.add(a, c, b)
    },c.Group.prototype.addToHash = function (a) {
        if (a.parent === this) {
            var b = this.hash.indexOf(a);
            if (-1 === b)return this.hash.push(a), !0
        }
        return !1
    },c.Group.prototype.removeFromHash = function (a) {
        if (a) {
            var b = this.hash.indexOf(a);
            if (-1 !== b)return this.hash.splice(b, 1), !0
        }
        return !1
    },c.Group.prototype.addMultiple = function (a, b) {
        if (a instanceof c.Group)a.moveAll(this, b); else if (Array.isArray(a))for (var d = 0; d < a.length; d++)this.add(a[d], b);
        return a
    },c.Group.prototype.getAt = function (a) {
        return 0 > a || a >= this.children.length ? -1 : this.getChildAt(a)
    },c.Group.prototype.create = function (a, b, c, d, e, f) {
        void 0 === e && (e = !0);
        var g = new this.classType(this.game, a, b, c, d);
        return g.exists = e, g.visible = e, g.alive = e, this.add(g, !1, f)
    },c.Group.prototype.createMultiple = function (a, b, c, d) {
        void 0 === c && (c = 0), void 0 === d && (d = !1), Array.isArray(b) || (b = [b]), Array.isArray(c) || (c = [c]);
        var e = this, f = [];
        return b.forEach(function (b) {
            c.forEach(function (c) {
                for (var g = 0; a > g; g++)f.push(e.create(0, 0, b, c, d))
            })
        }), f
    },c.Group.prototype.updateZ = function () {
        for (var a = this.children.length; a--;)this.children[a].z = a
    },c.Group.prototype.align = function (a, b, d, e, f, g) {
        if (void 0 === f && (f = c.TOP_LEFT), void 0 === g && (g = 0), !(0 === this.children.length || g > this.children.length || -1 === a && -1 === b))for (var h = new c.Rectangle(0, 0, d, e), i = a * d, j = b * e, k = g; k < this.children.length; k++) {
            var l = this.children[k];
            if (l.alignIn)if (l.alignIn(h, f), -1 === a)h.y += e, h.y === j && (h.x += d, h.y = 0); else if (-1 === b)h.x += d, h.x === i && (h.x = 0, h.y += e); else if (h.x += d, h.x === i && (h.x = 0, h.y += e, h.y === j))return
        }
    },c.Group.prototype.resetCursor = function (a) {
        return void 0 === a && (a = 0), a > this.children.length - 1 && (a = 0), this.cursor ? (this.cursorIndex = a, this.cursor = this.children[this.cursorIndex], this.cursor) : void 0
    },c.Group.prototype.next = function () {
        return this.cursor ? (this.cursorIndex >= this.children.length - 1 ? this.cursorIndex = 0 : this.cursorIndex++, this.cursor = this.children[this.cursorIndex], this.cursor) : void 0
    },c.Group.prototype.previous = function () {
        return this.cursor ? (0 === this.cursorIndex ? this.cursorIndex = this.children.length - 1 : this.cursorIndex--, this.cursor = this.children[this.cursorIndex], this.cursor) : void 0
    },c.Group.prototype.swap = function (a, b) {
        this.swapChildren(a, b), this.updateZ()
    },c.Group.prototype.bringToTop = function (a) {
        return a.parent === this && this.getIndex(a) < this.children.length && (this.remove(a, !1, !0), this.add(a, !0)), a
    },c.Group.prototype.sendToBack = function (a) {
        return a.parent === this && this.getIndex(a) > 0 && (this.remove(a, !1, !0), this.addAt(a, 0, !0)), a
    },c.Group.prototype.moveUp = function (a) {
        if (a.parent === this && this.getIndex(a) < this.children.length - 1) {
            var b = this.getIndex(a), c = this.getAt(b + 1);
            c && this.swap(a, c)
        }
        return a
    },c.Group.prototype.moveDown = function (a) {
        if (a.parent === this && this.getIndex(a) > 0) {
            var b = this.getIndex(a), c = this.getAt(b - 1);
            c && this.swap(a, c)
        }
        return a
    },c.Group.prototype.xy = function (a, b, c) {
        return 0 > a || a > this.children.length ? -1 : (this.getChildAt(a).x = b, void(this.getChildAt(a).y = c))
    },c.Group.prototype.reverse = function () {
        this.children.reverse(), this.updateZ()
    },c.Group.prototype.getIndex = function (a) {
        return this.children.indexOf(a)
    },c.Group.prototype.getByName = function (a) {
        for (var b = 0; b < this.children.length; b++)if (this.children[b].name === a)return this.children[b];
        return null
    },c.Group.prototype.replace = function (a, b) {
        var d = this.getIndex(a);
        return -1 !== d ? (b.parent && (b.parent instanceof c.Group ? b.parent.remove(b) : b.parent.removeChild(b)), this.remove(a), this.addAt(b, d), a) : void 0
    },c.Group.prototype.hasProperty = function (a, b) {
        var c = b.length;
        return 1 === c && b[0] in a ? !0 : 2 === c && b[0] in a && b[1] in a[b[0]] ? !0 : 3 === c && b[0] in a && b[1] in a[b[0]] && b[2] in a[b[0]][b[1]] ? !0 : 4 === c && b[0] in a && b[1] in a[b[0]] && b[2] in a[b[0]][b[1]] && b[3] in a[b[0]][b[1]][b[2]] ? !0 : !1
    },c.Group.prototype.setProperty = function (a, b, c, d, e) {
        if (void 0 === e && (e = !1), d = d || 0, !this.hasProperty(a, b) && (!e || d > 0))return !1;
        var f = b.length;
        return 1 === f ? 0 === d ? a[b[0]] = c : 1 == d ? a[b[0]] += c : 2 == d ? a[b[0]] -= c : 3 == d ? a[b[0]] *= c : 4 == d && (a[b[0]] /= c) : 2 === f ? 0 === d ? a[b[0]][b[1]] = c : 1 == d ? a[b[0]][b[1]] += c : 2 == d ? a[b[0]][b[1]] -= c : 3 == d ? a[b[0]][b[1]] *= c : 4 == d && (a[b[0]][b[1]] /= c) : 3 === f ? 0 === d ? a[b[0]][b[1]][b[2]] = c : 1 == d ? a[b[0]][b[1]][b[2]] += c : 2 == d ? a[b[0]][b[1]][b[2]] -= c : 3 == d ? a[b[0]][b[1]][b[2]] *= c : 4 == d && (a[b[0]][b[1]][b[2]] /= c) : 4 === f && (0 === d ? a[b[0]][b[1]][b[2]][b[3]] = c : 1 == d ? a[b[0]][b[1]][b[2]][b[3]] += c : 2 == d ? a[b[0]][b[1]][b[2]][b[3]] -= c : 3 == d ? a[b[0]][b[1]][b[2]][b[3]] *= c : 4 == d && (a[b[0]][b[1]][b[2]][b[3]] /= c)), !0
    },c.Group.prototype.checkProperty = function (a, b, d, e) {
        return void 0 === e && (e = !1), !c.Utils.getProperty(a, b) && e ? !1 : c.Utils.getProperty(a, b) !== d ? !1 : !0
    },c.Group.prototype.set = function (a, b, c, d, e, f, g) {
        return void 0 === g && (g = !1), b = b.split("."), void 0 === d && (d = !1), void 0 === e && (e = !1), (d === !1 || d && a.alive) && (e === !1 || e && a.visible) ? this.setProperty(a, b, c, f, g) : void 0
    },c.Group.prototype.setAll = function (a, b, c, d, e, f) {
        void 0 === c && (c = !1), void 0 === d && (d = !1), void 0 === f && (f = !1), a = a.split("."), e = e || 0;
        for (var g = 0; g < this.children.length; g++)(!c || c && this.children[g].alive) && (!d || d && this.children[g].visible) && this.setProperty(this.children[g], a, b, e, f)
    },c.Group.prototype.setAllChildren = function (a, b, d, e, f, g) {
        void 0 === d && (d = !1), void 0 === e && (e = !1), void 0 === g && (g = !1), f = f || 0;
        for (var h = 0; h < this.children.length; h++)(!d || d && this.children[h].alive) && (!e || e && this.children[h].visible) && (this.children[h] instanceof c.Group ? this.children[h].setAllChildren(a, b, d, e, f, g) : this.setProperty(this.children[h], a.split("."), b, f, g))
    },c.Group.prototype.checkAll = function (a, b, c, d, e) {
        void 0 === c && (c = !1), void 0 === d && (d = !1), void 0 === e && (e = !1);
        for (var f = 0; f < this.children.length; f++)if ((!c || c && this.children[f].alive) && (!d || d && this.children[f].visible) && !this.checkProperty(this.children[f], a, b, e))return !1;
        return !0
    },c.Group.prototype.addAll = function (a, b, c, d) {
        this.setAll(a, b, c, d, 1)
    },c.Group.prototype.subAll = function (a, b, c, d) {
        this.setAll(a, b, c, d, 2)
    },c.Group.prototype.multiplyAll = function (a, b, c, d) {
        this.setAll(a, b, c, d, 3)
    },c.Group.prototype.divideAll = function (a, b, c, d) {
        this.setAll(a, b, c, d, 4)
    },c.Group.prototype.callAllExists = function (a, b) {
        var c;
        if (arguments.length > 2) {
            c = [];
            for (var d = 2; d < arguments.length; d++)c.push(arguments[d])
        }
        for (var d = 0; d < this.children.length; d++)this.children[d].exists === b && this.children[d][a] && this.children[d][a].apply(this.children[d], c);
    },c.Group.prototype.callbackFromArray = function (a, b, c) {
        if (1 == c) {
            if (a[b[0]])return a[b[0]]
        } else if (2 == c) {
            if (a[b[0]][b[1]])return a[b[0]][b[1]]
        } else if (3 == c) {
            if (a[b[0]][b[1]][b[2]])return a[b[0]][b[1]][b[2]]
        } else if (4 == c) {
            if (a[b[0]][b[1]][b[2]][b[3]])return a[b[0]][b[1]][b[2]][b[3]]
        } else if (a[b])return a[b];
        return !1
    },c.Group.prototype.callAll = function (a, b) {
        if (void 0 !== a) {
            a = a.split(".");
            var c = a.length;
            if (void 0 === b || null === b || "" === b)b = null; else if ("string" == typeof b) {
                b = b.split(".");
                var d = b.length
            }
            var e;
            if (arguments.length > 2) {
                e = [];
                for (var f = 2; f < arguments.length; f++)e.push(arguments[f])
            }
            for (var g = null, h = null, f = 0; f < this.children.length; f++)g = this.callbackFromArray(this.children[f], a, c), b && g ? (h = this.callbackFromArray(this.children[f], b, d), g && g.apply(h, e)) : g && g.apply(this.children[f], e)
        }
    },c.Group.prototype.preUpdate = function () {
        if (this.pendingDestroy)return this.destroy(), !1;
        if (!this.exists || !this.parent.exists)return this.renderOrderID = -1, !1;
        for (var a = 0; a < this.children.length; a++)this.children[a].preUpdate();
        return !0
    },c.Group.prototype.update = function () {
        for (var a = this.children.length; a--;)this.children[a].update()
    },c.Group.prototype.postUpdate = function () {
        this.fixedToCamera && (this.x = this.game.camera.view.x + this.cameraOffset.x, this.y = this.game.camera.view.y + this.cameraOffset.y);
        for (var a = 0; a < this.children.length; a++)this.children[a].postUpdate()
    },c.Group.prototype.filter = function (a, b) {
        for (var d = -1, e = this.children.length, f = []; ++d < e;) {
            var g = this.children[d];
            (!b || b && g.exists) && a(g, d, this.children) && f.push(g)
        }
        return new c.ArraySet(f)
    },c.Group.prototype.forEach = function (a, b, c) {
        if (void 0 === c && (c = !1), arguments.length <= 3)for (var d = 0; d < this.children.length; d++)(!c || c && this.children[d].exists) && a.call(b, this.children[d]); else {
            for (var e = [null], d = 3; d < arguments.length; d++)e.push(arguments[d]);
            for (var d = 0; d < this.children.length; d++)(!c || c && this.children[d].exists) && (e[0] = this.children[d], a.apply(b, e))
        }
    },c.Group.prototype.forEachExists = function (a, b) {
        var d;
        if (arguments.length > 2) {
            d = [null];
            for (var e = 2; e < arguments.length; e++)d.push(arguments[e])
        }
        this.iterate("exists", !0, c.Group.RETURN_TOTAL, a, b, d)
    },c.Group.prototype.forEachAlive = function (a, b) {
        var d;
        if (arguments.length > 2) {
            d = [null];
            for (var e = 2; e < arguments.length; e++)d.push(arguments[e])
        }
        this.iterate("alive", !0, c.Group.RETURN_TOTAL, a, b, d)
    },c.Group.prototype.forEachDead = function (a, b) {
        var d;
        if (arguments.length > 2) {
            d = [null];
            for (var e = 2; e < arguments.length; e++)d.push(arguments[e])
        }
        this.iterate("alive", !1, c.Group.RETURN_TOTAL, a, b, d)
    },c.Group.prototype.sort = function (a, b) {
        this.children.length < 2 || (void 0 === a && (a = "z"), void 0 === b && (b = c.Group.SORT_ASCENDING), this._sortProperty = a, b === c.Group.SORT_ASCENDING ? this.children.sort(this.ascendingSortHandler.bind(this)) : this.children.sort(this.descendingSortHandler.bind(this)), this.updateZ())
    },c.Group.prototype.customSort = function (a, b) {
        this.children.length < 2 || (this.children.sort(a.bind(b)), this.updateZ())
    },c.Group.prototype.ascendingSortHandler = function (a, b) {
        return a[this._sortProperty] < b[this._sortProperty] ? -1 : a[this._sortProperty] > b[this._sortProperty] ? 1 : a.z < b.z ? -1 : 1
    },c.Group.prototype.descendingSortHandler = function (a, b) {
        return a[this._sortProperty] < b[this._sortProperty] ? 1 : a[this._sortProperty] > b[this._sortProperty] ? -1 : 0
    },c.Group.prototype.iterate = function (a, b, d, e, f, g) {
        if (d === c.Group.RETURN_TOTAL && 0 === this.children.length)return 0;
        for (var h = 0, i = 0; i < this.children.length; i++)if (this.children[i][a] === b && (h++, e && (g ? (g[0] = this.children[i], e.apply(f, g)) : e.call(f, this.children[i])), d === c.Group.RETURN_CHILD))return this.children[i];
        return d === c.Group.RETURN_TOTAL ? h : null
    },c.Group.prototype.getFirstExists = function (a, b, d, e, f, g) {
        void 0 === b && (b = !1), "boolean" != typeof a && (a = !0);
        var h = this.iterate("exists", a, c.Group.RETURN_CHILD);
        return null === h && b ? this.create(d, e, f, g) : this.resetChild(h, d, e, f, g)
    },c.Group.prototype.getFirstAlive = function (a, b, d, e, f) {
        void 0 === a && (a = !1);
        var g = this.iterate("alive", !0, c.Group.RETURN_CHILD);
        return null === g && a ? this.create(b, d, e, f) : this.resetChild(g, b, d, e, f)
    },c.Group.prototype.getFirstDead = function (a, b, d, e, f) {
        void 0 === a && (a = !1);
        var g = this.iterate("alive", !1, c.Group.RETURN_CHILD);
        return null === g && a ? this.create(b, d, e, f) : this.resetChild(g, b, d, e, f)
    },c.Group.prototype.resetChild = function (a, b, c, d, e) {
        return null === a ? null : (void 0 === b && (b = null), void 0 === c && (c = null), null !== b && null !== c && a.reset(b, c), void 0 !== d && a.loadTexture(d, e), a)
    },c.Group.prototype.getTop = function () {
        return this.children.length > 0 ? this.children[this.children.length - 1] : void 0
    },c.Group.prototype.getBottom = function () {
        return this.children.length > 0 ? this.children[0] : void 0
    },c.Group.prototype.getClosestTo = function (a, b, d) {
        for (var e = Number.MAX_VALUE, f = 0, g = null, h = 0; h < this.children.length; h++) {
            var i = this.children[h];
            i.exists && (f = Math.abs(c.Point.distance(a, i)), e > f && (!b || b.call(d, i, f)) && (e = f, g = i))
        }
        return g
    },c.Group.prototype.getFurthestFrom = function (a, b, d) {
        for (var e = 0, f = 0, g = null, h = 0; h < this.children.length; h++) {
            var i = this.children[h];
            i.exists && (f = Math.abs(c.Point.distance(a, i)), f > e && (!b || b.call(d, i, f)) && (e = f, g = i))
        }
        return g
    },c.Group.prototype.countLiving = function () {
        return this.iterate("alive", !0, c.Group.RETURN_TOTAL)
    },c.Group.prototype.countDead = function () {
        return this.iterate("alive", !1, c.Group.RETURN_TOTAL)
    },c.Group.prototype.getRandom = function (a, b) {
        return 0 === this.children.length ? null : (a = a || 0, b = b || this.children.length, c.ArrayUtils.getRandomItem(this.children, a, b))
    },c.Group.prototype.remove = function (a, b, c) {
        if (void 0 === b && (b = !1), void 0 === c && (c = !1), 0 === this.children.length || -1 === this.children.indexOf(a))return !1;
        c || !a.events || a.destroyPhase || a.events.onRemovedFromGroup$dispatch(a, this);
        var d = this.removeChild(a);
        return this.removeFromHash(a), this.updateZ(), this.cursor === a && this.next(), b && d && d.destroy(!0), !0
    },c.Group.prototype.moveAll = function (a, b) {
        if (void 0 === b && (b = !1), this.children.length > 0 && a instanceof c.Group) {
            do a.add(this.children[0], b); while (this.children.length > 0);
            this.hash = [], this.cursor = null
        }
        return a
    },c.Group.prototype.removeAll = function (a, b, c) {
        if (void 0 === a && (a = !1), void 0 === b && (b = !1), void 0 === c && (c = !1), 0 !== this.children.length) {
            do {
                !b && this.children[0].events && this.children[0].events.onRemovedFromGroup$dispatch(this.children[0], this);
                var d = this.removeChild(this.children[0]);
                this.removeFromHash(d), a && d && d.destroy(!0, c)
            } while (this.children.length > 0);
            this.hash = [], this.cursor = null
        }
    },c.Group.prototype.removeBetween = function (a, b, c, d) {
        if (void 0 === b && (b = this.children.length - 1), void 0 === c && (c = !1), void 0 === d && (d = !1), 0 !== this.children.length) {
            if (a > b || 0 > a || b > this.children.length)return !1;
            for (var e = b; e >= a;) {
                !d && this.children[e].events && this.children[e].events.onRemovedFromGroup$dispatch(this.children[e], this);
                var f = this.removeChild(this.children[e]);
                this.removeFromHash(f), c && f && f.destroy(!0), this.cursor === this.children[e] && (this.cursor = null), e--
            }
            this.updateZ()
        }
    },c.Group.prototype.destroy = function (a, b) {
        null === this.game || this.ignoreDestroy || (void 0 === a && (a = !0), void 0 === b && (b = !1), this.onDestroy.dispatch(this, a, b), this.removeAll(a), this.cursor = null, this.filters = null, this.pendingDestroy = !1, b || (this.parent && this.parent.removeChild(this), this.game = null, this.exists = !1))
    },Object.defineProperty(c.Group.prototype, "total", {
        get: function () {
            return this.iterate("exists", !0, c.Group.RETURN_TOTAL)
        }
    }),Object.defineProperty(c.Group.prototype, "length", {
        get: function () {
            return this.children.length
        }
    }),Object.defineProperty(c.Group.prototype, "angle", {
        get: function () {
            return c.Math.radToDeg(this.rotation)
        }, set: function (a) {
            this.rotation = c.Math.degToRad(a)
        }
    }),Object.defineProperty(c.Group.prototype, "centerX", {
        get: function () {
            return this.getBounds().centerX
        }, set: function (a) {
            var b = this.getBounds(), c = this.x - b.x;
            this.x = a + c - b.halfWidth
        }
    }),Object.defineProperty(c.Group.prototype, "centerY", {
        get: function () {
            return this.getBounds().centerY
        }, set: function (a) {
            var b = this.getBounds(), c = this.y - b.y;
            this.y = a + c - b.halfHeight
        }
    }),Object.defineProperty(c.Group.prototype, "left", {
        get: function () {
            return this.getBounds().left
        }, set: function (a) {
            var b = this.getBounds(), c = this.x - b.x;
            this.x = a + c
        }
    }),Object.defineProperty(c.Group.prototype, "right", {
        get: function () {
            return this.getBounds().right
        }, set: function (a) {
            var b = this.getBounds(), c = this.x - b.x;
            this.x = a + c - b.width
        }
    }),Object.defineProperty(c.Group.prototype, "top", {
        get: function () {
            return this.getBounds().top
        }, set: function (a) {
            var b = this.getBounds(), c = this.y - b.y;
            this.y = a + c
        }
    }),Object.defineProperty(c.Group.prototype, "bottom", {
        get: function () {
            return this.getBounds().bottom
        }, set: function (a) {
            var b = this.getBounds(), c = this.y - b.y;
            this.y = a + c - b.height
        }
    }),c.World = function (a) {
        c.Group.call(this, a, null, "__world", !1), this.bounds = new c.Rectangle(0, 0, a.width, a.height), this.camera = null, this._definedSize = !1, this._width = a.width, this._height = a.height, this.game.state.onStateChange.add(this.stateChange, this)
    },c.World.prototype = Object.create(c.Group.prototype),c.World.prototype.constructor = c.World,c.World.prototype.boot = function () {
        this.camera = new c.Camera(this.game, 0, 0, 0, this.game.width, this.game.height), this.game.stage.addChild(this), this.camera.boot()
    },c.World.prototype.stateChange = function () {
        this.x = 0, this.y = 0, this.camera.reset()
    },c.World.prototype.setBounds = function (a, b, c, d) {
        this._definedSize = !0, this._width = c, this._height = d, this.bounds.setTo(a, b, c, d), this.x = a, this.y = b, this.camera.bounds && this.camera.bounds.setTo(a, b, Math.max(c, this.game.width), Math.max(d, this.game.height)), this.game.physics.setBoundsToWorld()
    },c.World.prototype.resize = function (a, b) {
        this._definedSize && (a < this._width && (a = this._width), b < this._height && (b = this._height)), this.bounds.width = a, this.bounds.height = b, this.game.camera.setBoundsToWorld(), this.game.physics.setBoundsToWorld()
    },c.World.prototype.shutdown = function () {
        this.destroy(!0, !0)
    },c.World.prototype.wrap = function (a, b, c, d, e) {
        void 0 === b && (b = 0), void 0 === c && (c = !1), void 0 === d && (d = !0), void 0 === e && (e = !0), c ? (a.getBounds(), d && (a.x + a._currentBounds.width < this.bounds.x ? a.x = this.bounds.right : a.x > this.bounds.right && (a.x = this.bounds.left)), e && (a.y + a._currentBounds.height < this.bounds.top ? a.y = this.bounds.bottom : a.y > this.bounds.bottom && (a.y = this.bounds.top))) : (d && a.x + b < this.bounds.x ? a.x = this.bounds.right + b : d && a.x - b > this.bounds.right && (a.x = this.bounds.left - b), e && a.y + b < this.bounds.top ? a.y = this.bounds.bottom + b : e && a.y - b > this.bounds.bottom && (a.y = this.bounds.top - b))
    },Object.defineProperty(c.World.prototype, "width", {
        get: function () {
            return this.bounds.width
        }, set: function (a) {
            a < this.game.width && (a = this.game.width), this.bounds.width = a, this._width = a, this._definedSize = !0
        }
    }),Object.defineProperty(c.World.prototype, "height", {
        get: function () {
            return this.bounds.height
        }, set: function (a) {
            a < this.game.height && (a = this.game.height), this.bounds.height = a, this._height = a, this._definedSize = !0
        }
    }),Object.defineProperty(c.World.prototype, "centerX", {
        get: function () {
            return this.bounds.halfWidth + this.bounds.x
        }
    }),Object.defineProperty(c.World.prototype, "centerY", {
        get: function () {
            return this.bounds.halfHeight + this.bounds.y
        }
    }),Object.defineProperty(c.World.prototype, "randomX", {
        get: function () {
            return this.bounds.x < 0 ? this.game.rnd.between(this.bounds.x, this.bounds.width - Math.abs(this.bounds.x)) : this.game.rnd.between(this.bounds.x, this.bounds.width)
        }
    }),Object.defineProperty(c.World.prototype, "randomY", {
        get: function () {
            return this.bounds.y < 0 ? this.game.rnd.between(this.bounds.y, this.bounds.height - Math.abs(this.bounds.y)) : this.game.rnd.between(this.bounds.y, this.bounds.height)
        }
    }),c.Game = function (a, b, d, e, f, g, h, i) {
        return this.id = c.GAMES.push(this) - 1, this.config = null, this.physicsConfig = i, this.parent = "", this.width = 800, this.height = 600, this.resolution = 1, this._width = 800, this._height = 600, this.transparent = !1, this.antialias = !0, this.preserveDrawingBuffer = !1, this.clearBeforeRender = !0, this.renderer = null, this.renderType = c.AUTO, this.state = null, this.isBooted = !1, this.isRunning = !1, this.raf = null, this.add = null, this.make = null, this.cache = null, this.input = null, this.load = null, this.math = null, this.net = null, this.scale = null, this.sound = null, this.stage = null, this.time = null, this.tweens = null, this.world = null, this.physics = null, this.plugins = null, this.rnd = null, this.device = c.Device, this.camera = null, this.canvas = null, this.context = null, this.debug = null, this.particles = null, this.create = null, this.lockRender = !1, this.stepping = !1, this.pendingStep = !1, this.stepCount = 0, this.onPause = null, this.onResume = null, this.onBlur = null, this.onFocus = null, this._paused = !1, this._codePaused = !1, this.currentUpdateID = 0, this.updatesThisFrame = 1, this._deltaTime = 0, this._lastCount = 0, this._spiraling = 0, this._kickstart = !0, this.fpsProblemNotifier = new c.Signal, this.forceSingleUpdate = !0, this._nextFpsNotification = 0, 1 === arguments.length && "object" == typeof arguments[0] ? this.parseConfig(arguments[0]) : (this.config = {enableDebug: !0}, "undefined" != typeof a && (this._width = a), "undefined" != typeof b && (this._height = b), "undefined" != typeof d && (this.renderType = d), "undefined" != typeof e && (this.parent = e), "undefined" != typeof g && (this.transparent = g), "undefined" != typeof h && (this.antialias = h), this.rnd = new c.RandomDataGenerator([(Date.now() * Math.random()).toString()]), this.state = new c.StateManager(this, f)), this.device.whenReady(this.boot, this), this
    },c.Game.prototype = {
        parseConfig: function (a) {
            this.config = a, void 0 === a.enableDebug && (this.config.enableDebug = !0), a.width && (this._width = a.width), a.height && (this._height = a.height), a.renderer && (this.renderType = a.renderer), a.parent && (this.parent = a.parent), void 0 !== a.transparent && (this.transparent = a.transparent), void 0 !== a.antialias && (this.antialias = a.antialias), a.resolution && (this.resolution = a.resolution), void 0 !== a.preserveDrawingBuffer && (this.preserveDrawingBuffer = a.preserveDrawingBuffer), a.physicsConfig && (this.physicsConfig = a.physicsConfig);
            var b = [(Date.now() * Math.random()).toString()];
            a.seed && (b = a.seed), this.rnd = new c.RandomDataGenerator(b);
            var d = null;
            a.state && (d = a.state), this.state = new c.StateManager(this, d)
        }, boot: function () {
            this.isBooted || (this.onPause = new c.Signal, this.onResume = new c.Signal, this.onBlur = new c.Signal, this.onFocus = new c.Signal, this.isBooted = !0, PIXI.game = this, this.math = c.Math, this.scale = new c.ScaleManager(this, this._width, this._height), this.stage = new c.Stage(this), this.setUpRenderer(), this.world = new c.World(this), this.add = new c.GameObjectFactory(this), this.make = new c.GameObjectCreator(this), this.cache = new c.Cache(this), this.load = new c.Loader(this), this.time = new c.Time(this), this.tweens = new c.TweenManager(this), this.input = new c.Input(this), this.sound = new c.SoundManager(this), this.physics = new c.Physics(this, this.physicsConfig), this.particles = new c.Particles(this), this.create = new c.Create(this), this.plugins = new c.PluginManager(this), this.net = new c.Net(this), this.time.boot(), this.stage.boot(), this.world.boot(), this.scale.boot(), this.input.boot(), this.sound.boot(), this.state.boot(), this.config.enableDebug ? (this.debug = new c.Utils.Debug(this), this.debug.boot()) : this.debug = {
                preUpdate: function () {
                }, update: function () {
                }, reset: function () {
                }
            }, this.showDebugHeader(), this.isRunning = !0, this.config && this.config.forceSetTimeOut ? this.raf = new c.RequestAnimationFrame(this, this.config.forceSetTimeOut) : this.raf = new c.RequestAnimationFrame(this, !1), this._kickstart = !0, window.focus && (!window.PhaserGlobal || window.PhaserGlobal && !window.PhaserGlobal.stopFocus) && window.focus(), this.raf.start())
        }, showDebugHeader: function () {
            if (!window.PhaserGlobal || !window.PhaserGlobal.hideBanner) {
                var a = c.VERSION, b = "Canvas", d = "HTML Audio", e = 1;
                if (this.renderType === c.WEBGL ? (b = "WebGL", e++) : this.renderType == c.HEADLESS && (b = "Headless"), this.device.webAudio && (d = "WebAudio", e++), this.device.chrome) {
                    for (var f = ["%c %c %c Phaser v" + a + " | Pixi.js | " + b + " | " + d + "  %c %c %c http://phaser.io %c%c%c", "background: #fb8cb3", "background: #d44a52", "color: #ffffff; background: #871905;", "background: #d44a52", "background: #fb8cb3", "background: #ffffff"], g = 0; 3 > g; g++)e > g ? f.push("color: #ff2424; background: #fff") : f.push("color: #959595; background: #fff");
                    console.log.apply(console, f)
                } else window.console && console.log("Phaser v" + a + " | Pixi.js " + PIXI.VERSION + " | " + b + " | " + d + " | http://phaser.io")
            }
        }, setUpRenderer: function () {
            if (this.config.canvas ? this.canvas = this.config.canvas : this.canvas = c.Canvas.create(this, this.width, this.height, this.config.canvasID, !0), this.config.canvasStyle ? this.canvas.style = this.config.canvasStyle : this.canvas.style["-webkit-full-screen"] = "width: 100%; height: 100%", this.renderType === c.HEADLESS || this.renderType === c.CANVAS || this.renderType === c.AUTO && !this.device.webGL) {
                if (!this.device.canvas)throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");
                this.renderType = c.CANVAS, this.renderer = new PIXI.CanvasRenderer(this), this.context = this.renderer.context
            } else this.renderType = c.WEBGL, this.renderer = new PIXI.WebGLRenderer(this), this.context = null, this.canvas.addEventListener("webglcontextlost", this.contextLost.bind(this), !1), this.canvas.addEventListener("webglcontextrestored", this.contextRestored.bind(this), !1);
            this.device.cocoonJS && (this.canvas.screencanvas = this.renderType === c.CANVAS ? !0 : !1), this.renderType !== c.HEADLESS && (this.stage.smoothed = this.antialias, c.Canvas.addToDOM(this.canvas, this.parent, !1), c.Canvas.setTouchAction(this.canvas))
        }, contextLost: function (a) {
            a.preventDefault(), this.renderer.contextLost = !0
        }, contextRestored: function () {
            this.renderer.initContext(), this.cache.clearGLTextures(), this.renderer.contextLost = !1
        }, update: function (a) {
            if (this.time.update(a), this._kickstart)return this.updateLogic(this.time.desiredFpsMult), this.updateRender(this.time.slowMotion * this.time.desiredFps), void(this._kickstart = !1);
            if (this._spiraling > 1 && !this.forceSingleUpdate)this.time.time > this._nextFpsNotification && (this._nextFpsNotification = this.time.time + 1e4, this.fpsProblemNotifier.dispatch()), this._deltaTime = 0, this._spiraling = 0, this.updateRender(this.time.slowMotion * this.time.desiredFps); else {
                var b = 1e3 * this.time.slowMotion / this.time.desiredFps;
                this._deltaTime += Math.max(Math.min(3 * b, this.time.elapsed), 0);
                var c = 0;
                for (this.updatesThisFrame = Math.floor(this._deltaTime / b), this.forceSingleUpdate && (this.updatesThisFrame = Math.min(1, this.updatesThisFrame)); this._deltaTime >= b && (this._deltaTime -= b, this.currentUpdateID = c, this.updateLogic(this.time.desiredFpsMult), c++, !this.forceSingleUpdate || 1 !== c);)this.time.refresh();
                c > this._lastCount ? this._spiraling++ : c < this._lastCount && (this._spiraling = 0), this._lastCount = c, this.updateRender(this._deltaTime / b)
            }
        }, updateLogic: function (a) {
            this._paused || this.pendingStep ? (this.scale.pauseUpdate(), this.state.pauseUpdate(), this.debug.preUpdate()) : (this.stepping && (this.pendingStep = !0), this.scale.preUpdate(), this.debug.preUpdate(), this.camera.preUpdate(), this.physics.preUpdate(), this.state.preUpdate(a), this.plugins.preUpdate(a), this.stage.preUpdate(), this.state.update(), this.stage.update(), this.tweens.update(), this.sound.update(), this.input.update(), this.physics.update(), this.particles.update(), this.plugins.update(), this.stage.postUpdate(), this.plugins.postUpdate()), this.stage.updateTransform()
        }, updateRender: function (a) {
            this.lockRender || (this.state.preRender(a), this.renderType !== c.HEADLESS && (this.renderer.render(this.stage), this.plugins.render(a), this.state.render(a)), this.plugins.postRender(a))
        }, enableStep: function () {
            this.stepping = !0, this.pendingStep = !1, this.stepCount = 0
        }, disableStep: function () {
            this.stepping = !1, this.pendingStep = !1
        }, step: function () {
            this.pendingStep = !1, this.stepCount++
        }, destroy: function () {
            this.raf.stop(), this.state.destroy(), this.sound.destroy(), this.scale.destroy(), this.stage.destroy(), this.input.destroy(), this.physics.destroy(), this.plugins.destroy(), this.state = null, this.sound = null, this.scale = null, this.stage = null, this.input = null, this.physics = null, this.plugins = null, this.cache = null, this.load = null, this.time = null, this.world = null, this.isBooted = !1, this.renderer.destroy(!1), c.Canvas.removeFromDOM(this.canvas), PIXI.defaultRenderer = null, c.GAMES[this.id] = null
        }, gamePaused: function (a) {
            this._paused || (this._paused = !0, this.time.gamePaused(), this.sound.muteOnPause && this.sound.setMute(), this.onPause.dispatch(a), this.device.cordova && this.device.iOS && (this.lockRender = !0))
        }, gameResumed: function (a) {
            this._paused && !this._codePaused && (this._paused = !1, this.time.gameResumed(), this.input.reset(), this.sound.muteOnPause && this.sound.unsetMute(), this.onResume.dispatch(a), this.device.cordova && this.device.iOS && (this.lockRender = !1))
        }, focusLoss: function (a) {
            this.onBlur.dispatch(a), this.stage.disableVisibilityChange || this.gamePaused(a)
        }, focusGain: function (a) {
            this.onFocus.dispatch(a), this.stage.disableVisibilityChange || this.gameResumed(a)
        }
    },c.Game.prototype.constructor = c.Game,Object.defineProperty(c.Game.prototype, "paused", {
        get: function () {
            return this._paused
        }, set: function (a) {
            a === !0 ? (this._paused === !1 && (this._paused = !0, this.sound.setMute(), this.time.gamePaused(), this.onPause.dispatch(this)), this._codePaused = !0) : (this._paused && (this._paused = !1, this.input.reset(), this.sound.unsetMute(), this.time.gameResumed(), this.onResume.dispatch(this)), this._codePaused = !1)
        }
    }),c.Input = function (a) {
        this.game = a, this.hitCanvas = null, this.hitContext = null, this.moveCallbacks = [], this.customCandidateHandler = null, this.customCandidateHandlerContext = null, this.pollRate = 0, this.enabled = !0, this.multiInputOverride = c.Input.MOUSE_TOUCH_COMBINE, this.position = null, this.speed = null, this.circle = null, this.scale = null, this.maxPointers = -1, this.tapRate = 200, this.doubleTapRate = 300, this.holdRate = 2e3, this.justPressedRate = 200, this.justReleasedRate = 200, this.recordPointerHistory = !1, this.recordRate = 100, this.recordLimit = 100, this.pointer1 = null, this.pointer2 = null, this.pointer3 = null, this.pointer4 = null, this.pointer5 = null, this.pointer6 = null, this.pointer7 = null, this.pointer8 = null, this.pointer9 = null, this.pointer10 = null, this.pointers = [], this.activePointer = null, this.mousePointer = null, this.mouse = null, this.keyboard = null, this.touch = null, this.mspointer = null, this.gamepad = null, this.resetLocked = !1, this.onDown = null, this.onUp = null, this.onTap = null, this.onHold = null, this.minPriorityID = 0, this.interactiveItems = new c.ArraySet, this._localPoint = new c.Point, this._pollCounter = 0, this._oldPosition = null, this._x = 0, this._y = 0
    },c.Input.MOUSE_OVERRIDES_TOUCH = 0,c.Input.TOUCH_OVERRIDES_MOUSE = 1,c.Input.MOUSE_TOUCH_COMBINE = 2,c.Input.MAX_POINTERS = 10,c.Input.prototype = {
        boot: function () {
            this.mousePointer = new c.Pointer(this.game, 0, c.PointerMode.CURSOR), this.addPointer(), this.addPointer(), this.mouse = new c.Mouse(this.game), this.touch = new c.Touch(this.game), this.mspointer = new c.MSPointer(this.game), c.Keyboard && (this.keyboard = new c.Keyboard(this.game)), c.Gamepad && (this.gamepad = new c.Gamepad(this.game)), this.onDown = new c.Signal, this.onUp = new c.Signal, this.onTap = new c.Signal, this.onHold = new c.Signal, this.scale = new c.Point(1, 1), this.speed = new c.Point, this.position = new c.Point, this._oldPosition = new c.Point, this.circle = new c.Circle(0, 0, 44), this.activePointer = this.mousePointer, this.hitCanvas = PIXI.CanvasPool.create(this, 1, 1), this.hitContext = this.hitCanvas.getContext("2d"), this.mouse.start(), this.touch.start(), this.mspointer.start(), this.mousePointer.active = !0, this.keyboard && this.keyboard.start();
            var a = this;
            this._onClickTrampoline = function (b) {
                a.onClickTrampoline(b)
            }, this.game.canvas.addEventListener("click", this._onClickTrampoline, !1)
        }, destroy: function () {
            this.mouse.stop(), this.touch.stop(), this.mspointer.stop(), this.keyboard && this.keyboard.stop(), this.gamepad && this.gamepad.stop(), this.moveCallbacks = [], PIXI.CanvasPool.remove(this), this.game.canvas.removeEventListener("click", this._onClickTrampoline)
        }, setInteractiveCandidateHandler: function (a, b) {
            this.customCandidateHandler = a, this.customCandidateHandlerContext = b
        }, addMoveCallback: function (a, b) {
            this.moveCallbacks.push({callback: a, context: b})
        }, deleteMoveCallback: function (a, b) {
            for (var c = this.moveCallbacks.length; c--;)if (this.moveCallbacks[c].callback === a && this.moveCallbacks[c].context === b)return void this.moveCallbacks.splice(c, 1)
        }, addPointer: function () {
            if (this.pointers.length >= c.Input.MAX_POINTERS)return console.warn("Phaser.Input.addPointer: Maximum limit of " + c.Input.MAX_POINTERS + " pointers reached."), null;
            var a = this.pointers.length + 1, b = new c.Pointer(this.game, a, c.PointerMode.TOUCH);
            return this.pointers.push(b), this["pointer" + a] = b, b
        }, update: function () {
            if (this.keyboard && this.keyboard.update(), this.pollRate > 0 && this._pollCounter < this.pollRate)return void this._pollCounter++;
            this.speed.x = this.position.x - this._oldPosition.x, this.speed.y = this.position.y - this._oldPosition.y, this._oldPosition.copyFrom(this.position), this.mousePointer.update(), this.gamepad && this.gamepad.active && this.gamepad.update();
            for (var a = 0; a < this.pointers.length; a++)this.pointers[a].update();
            this._pollCounter = 0
        }, reset: function (a) {
            if (this.game.isBooted && !this.resetLocked) {
                void 0 === a && (a = !1), this.mousePointer.reset(), this.keyboard && this.keyboard.reset(a), this.gamepad && this.gamepad.reset();
                for (var b = 0; b < this.pointers.length; b++)this.pointers[b].reset();
                "none" !== this.game.canvas.style.cursor && (this.game.canvas.style.cursor = "inherit"), a && (this.onDown.dispose(), this.onUp.dispose(), this.onTap.dispose(), this.onHold.dispose(), this.onDown = new c.Signal, this.onUp = new c.Signal, this.onTap = new c.Signal, this.onHold = new c.Signal, this.moveCallbacks = []), this._pollCounter = 0
            }
        }, resetSpeed: function (a, b) {
            this._oldPosition.setTo(a, b), this.speed.setTo(0, 0)
        }, startPointer: function (a) {
            if (this.maxPointers >= 0 && this.countActivePointers(this.maxPointers) >= this.maxPointers)return null;
            if (!this.pointer1.active)return this.pointer1.start(a);
            if (!this.pointer2.active)return this.pointer2.start(a);
            for (var b = 2; b < this.pointers.length; b++) {
                var c = this.pointers[b];
                if (!c.active)return c.start(a)
            }
            return null
        }, updatePointer: function (a) {
            if (this.pointer1.active && this.pointer1.identifier === a.identifier)return this.pointer1.move(a);
            if (this.pointer2.active && this.pointer2.identifier === a.identifier)return this.pointer2.move(a);
            for (var b = 2; b < this.pointers.length; b++) {
                var c = this.pointers[b];
                if (c.active && c.identifier === a.identifier)return c.move(a)
            }
            return null
        }, stopPointer: function (a) {
            if (this.pointer1.active && this.pointer1.identifier === a.identifier)return this.pointer1.stop(a);
            if (this.pointer2.active && this.pointer2.identifier === a.identifier)return this.pointer2.stop(a);
            for (var b = 2; b < this.pointers.length; b++) {
                var c = this.pointers[b];
                if (c.active && c.identifier === a.identifier)return c.stop(a)
            }
            return null
        }, countActivePointers: function (a) {
            void 0 === a && (a = this.pointers.length);
            for (var b = a, c = 0; c < this.pointers.length && b > 0; c++) {
                var d = this.pointers[c];
                d.active && b--
            }
            return a - b
        }, getPointer: function (a) {
            void 0 === a && (a = !1);
            for (var b = 0; b < this.pointers.length; b++) {
                var c = this.pointers[b];
                if (c.active === a)return c
            }
            return null
        }, getPointerFromIdentifier: function (a) {
            for (var b = 0; b < this.pointers.length; b++) {
                var c = this.pointers[b];
                if (c.identifier === a)return c
            }
            return null
        }, getPointerFromId: function (a) {
            for (var b = 0; b < this.pointers.length; b++) {
                var c = this.pointers[b];
                if (c.pointerId === a)return c
            }
            return null
        }, getLocalPosition: function (a, b, d) {
            void 0 === d && (d = new c.Point);
            var e = a.worldTransform, f = 1 / (e.a * e.d + e.c * -e.b);
            return d.setTo(e.d * f * b.x + -e.c * f * b.y + (e.ty * e.c - e.tx * e.d) * f, e.a * f * b.y + -e.b * f * b.x + (-e.ty * e.a + e.tx * e.b) * f)
        }, hitTest: function (a, b, d) {
            if (!a.worldVisible)return !1;
            if (this.getLocalPosition(a, b, this._localPoint), d.copyFrom(this._localPoint), a.hitArea && a.hitArea.contains)return a.hitArea.contains(this._localPoint.x, this._localPoint.y);
            if (a instanceof c.TileSprite) {
                var e = a.width, f = a.height, g = -e * a.anchor.x;
                if (this._localPoint.x >= g && this._localPoint.x < g + e) {
                    var h = -f * a.anchor.y;
                    if (this._localPoint.y >= h && this._localPoint.y < h + f)return !0
                }
            } else if (a instanceof PIXI.Sprite) {
                var e = a.texture.frame.width, f = a.texture.frame.height, g = -e * a.anchor.x;
                if (this._localPoint.x >= g && this._localPoint.x < g + e) {
                    var h = -f * a.anchor.y;
                    if (this._localPoint.y >= h && this._localPoint.y < h + f)return !0
                }
            } else if (a instanceof c.Graphics)for (var i = 0; i < a.graphicsData.length; i++) {
                var j = a.graphicsData[i];
                if (j.fill && j.shape && j.shape.contains(this._localPoint.x, this._localPoint.y))return !0
            }
            for (var i = 0; i < a.children.length; i++)if (this.hitTest(a.children[i], b, d))return !0;
            return !1
        }, onClickTrampoline: function () {
            this.activePointer.processClickTrampolines()
        }
    },c.Input.prototype.constructor = c.Input,Object.defineProperty(c.Input.prototype, "x", {
        get: function () {
            return this._x
        }, set: function (a) {
            this._x = Math.floor(a)
        }
    }),Object.defineProperty(c.Input.prototype, "y", {
        get: function () {
            return this._y
        }, set: function (a) {
            this._y = Math.floor(a)
        }
    }),Object.defineProperty(c.Input.prototype, "pollLocked", {
        get: function () {
            return this.pollRate > 0 && this._pollCounter < this.pollRate
        }
    }),Object.defineProperty(c.Input.prototype, "totalInactivePointers", {
        get: function () {
            return this.pointers.length - this.countActivePointers()
        }
    }),Object.defineProperty(c.Input.prototype, "totalActivePointers", {
        get: function () {
            return this.countActivePointers()
        }
    }),Object.defineProperty(c.Input.prototype, "worldX", {
        get: function () {
            return this.game.camera.view.x + this.x
        }
    }),Object.defineProperty(c.Input.prototype, "worldY", {
        get: function () {
            return this.game.camera.view.y + this.y
        }
    }),c.Mouse = function (a) {
        this.game = a, this.input = a.input, this.callbackContext = this.game, this.mouseDownCallback = null, this.mouseUpCallback = null, this.mouseOutCallback = null, this.mouseOverCallback = null, this.mouseWheelCallback = null, this.capture = !1, this.button = -1, this.wheelDelta = 0, this.enabled = !0, this.locked = !1, this.stopOnGameOut = !1, this.pointerLock = new c.Signal, this.event = null, this._onMouseDown = null, this._onMouseMove = null, this._onMouseUp = null, this._onMouseOut = null, this._onMouseOver = null, this._onMouseWheel = null, this._wheelEvent = null
    },c.Mouse.NO_BUTTON = -1,c.Mouse.LEFT_BUTTON = 0,c.Mouse.MIDDLE_BUTTON = 1,c.Mouse.RIGHT_BUTTON = 2,c.Mouse.BACK_BUTTON = 3,c.Mouse.FORWARD_BUTTON = 4,c.Mouse.WHEEL_UP = 1,c.Mouse.WHEEL_DOWN = -1,c.Mouse.prototype = {
        start: function () {
            if ((!this.game.device.android || this.game.device.chrome !== !1) && null === this._onMouseDown) {
                var b = this;
                this._onMouseDown = function (a) {
                    return b.onMouseDown(a)
                }, this._onMouseMove = function (a) {
                    return b.onMouseMove(a)
                }, this._onMouseUp = function (a) {
                    return b.onMouseUp(a)
                }, this._onMouseUpGlobal = function (a) {
                    return b.onMouseUpGlobal(a)
                }, this._onMouseOutGlobal = function (a) {
                    return b.onMouseOutGlobal(a)
                }, this._onMouseOut = function (a) {
                    return b.onMouseOut(a)
                }, this._onMouseOver = function (a) {
                    return b.onMouseOver(a)
                }, this._onMouseWheel = function (a) {
                    return b.onMouseWheel(a)
                };
                var c = this.game.canvas;
                c.addEventListener("mousedown", this._onMouseDown, !0), c.addEventListener("mousemove", this._onMouseMove, !0), c.addEventListener("mouseup", this._onMouseUp, !0), this.game.device.cocoonJS || (window.addEventListener("mouseup", this._onMouseUpGlobal, !0), window.addEventListener("mouseout", this._onMouseOutGlobal, !0), c.addEventListener("mouseover", this._onMouseOver, !0), c.addEventListener("mouseout", this._onMouseOut, !0));
                var d = this.game.device.wheelEvent;
                d && (c.addEventListener(d, this._onMouseWheel, !0), "mousewheel" === d ? this._wheelEvent = new a(-1 / 40, 1) : "DOMMouseScroll" === d && (this._wheelEvent = new a(1, 1)))
            }
        }, onMouseDown: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.mouseDownCallback && this.mouseDownCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && (a.identifier = 0, this.input.mousePointer.start(a))
        }, onMouseMove: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.mouseMoveCallback && this.mouseMoveCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && (a.identifier = 0, this.input.mousePointer.move(a))
        }, onMouseUp: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && (a.identifier = 0, this.input.mousePointer.stop(a))
        }, onMouseUpGlobal: function (a) {
            this.input.mousePointer.withinGame || (this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, a), a.identifier = 0, this.input.mousePointer.stop(a))
        }, onMouseOutGlobal: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.input.mousePointer.withinGame = !1, this.input.enabled && this.enabled && (this.input.mousePointer.stop(a), this.input.mousePointer.leftButton.stop(a), this.input.mousePointer.rightButton.stop(a))
        }, onMouseOut: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.input.mousePointer.withinGame = !1, this.mouseOutCallback && this.mouseOutCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && this.stopOnGameOut && (a.identifier = 0,
                this.input.mousePointer.stop(a))
        }, onMouseOver: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.input.mousePointer.withinGame = !0, this.mouseOverCallback && this.mouseOverCallback.call(this.callbackContext, a)
        }, onMouseWheel: function (a) {
            this._wheelEvent && (a = this._wheelEvent.bindEvent(a)), this.event = a, this.capture && a.preventDefault(), this.wheelDelta = c.Math.clamp(-a.deltaY, -1, 1), this.mouseWheelCallback && this.mouseWheelCallback.call(this.callbackContext, a)
        }, requestPointerLock: function () {
            if (this.game.device.pointerLock) {
                var a = this.game.canvas;
                a.requestPointerLock = a.requestPointerLock || a.mozRequestPointerLock || a.webkitRequestPointerLock, a.requestPointerLock();
                var b = this;
                this._pointerLockChange = function (a) {
                    return b.pointerLockChange(a)
                }, document.addEventListener("pointerlockchange", this._pointerLockChange, !0), document.addEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.addEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
            }
        }, pointerLockChange: function (a) {
            var b = this.game.canvas;
            document.pointerLockElement === b || document.mozPointerLockElement === b || document.webkitPointerLockElement === b ? (this.locked = !0, this.pointerLock.dispatch(!0, a)) : (this.locked = !1, this.pointerLock.dispatch(!1, a))
        }, releasePointerLock: function () {
            document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock, document.exitPointerLock(), document.removeEventListener("pointerlockchange", this._pointerLockChange, !0), document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
        }, stop: function () {
            var a = this.game.canvas;
            a.removeEventListener("mousedown", this._onMouseDown, !0), a.removeEventListener("mousemove", this._onMouseMove, !0), a.removeEventListener("mouseup", this._onMouseUp, !0), a.removeEventListener("mouseover", this._onMouseOver, !0), a.removeEventListener("mouseout", this._onMouseOut, !0);
            var b = this.game.device.wheelEvent;
            b && a.removeEventListener(b, this._onMouseWheel, !0), window.removeEventListener("mouseup", this._onMouseUpGlobal, !0), window.removeEventListener("mouseout", this._onMouseOutGlobal, !0), document.removeEventListener("pointerlockchange", this._pointerLockChange, !0), document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
        }
    },c.Mouse.prototype.constructor = c.Mouse,a.prototype = {},a.prototype.constructor = a,a.prototype.bindEvent = function (b) {
        if (!a._stubsGenerated && b) {
            var c = function (a) {
                return function () {
                    var b = this.originalEvent[a];
                    return "function" != typeof b ? b : b.bind(this.originalEvent)
                }
            };
            for (var d in b)d in a.prototype || Object.defineProperty(a.prototype, d, {get: c(d)});
            a._stubsGenerated = !0
        }
        return this.originalEvent = b, this
    },Object.defineProperties(a.prototype, {
        type: {value: "wheel"}, deltaMode: {
            get: function () {
                return this._deltaMode
            }
        }, deltaY: {
            get: function () {
                return this._scaleFactor * (this.originalEvent.wheelDelta || this.originalEvent.detail) || 0
            }
        }, deltaX: {
            get: function () {
                return this._scaleFactor * this.originalEvent.wheelDeltaX || 0
            }
        }, deltaZ: {value: 0}
    }),c.MSPointer = function (a) {
        this.game = a, this.input = a.input, this.callbackContext = this.game, this.pointerDownCallback = null, this.pointerMoveCallback = null, this.pointerUpCallback = null, this.capture = !0, this.button = -1, this.event = null, this.enabled = !0, this._onMSPointerDown = null, this._onMSPointerMove = null, this._onMSPointerUp = null, this._onMSPointerUpGlobal = null, this._onMSPointerOut = null, this._onMSPointerOver = null
    },c.MSPointer.prototype = {
        start: function () {
            if (null === this._onMSPointerDown) {
                var a = this;
                if (this.game.device.mspointer) {
                    this._onMSPointerDown = function (b) {
                        return a.onPointerDown(b)
                    }, this._onMSPointerMove = function (b) {
                        return a.onPointerMove(b)
                    }, this._onMSPointerUp = function (b) {
                        return a.onPointerUp(b)
                    }, this._onMSPointerUpGlobal = function (b) {
                        return a.onPointerUpGlobal(b)
                    }, this._onMSPointerOut = function (b) {
                        return a.onPointerOut(b)
                    }, this._onMSPointerOver = function (b) {
                        return a.onPointerOver(b)
                    };
                    var b = this.game.canvas;
                    b.addEventListener("MSPointerDown", this._onMSPointerDown, !1), b.addEventListener("MSPointerMove", this._onMSPointerMove, !1), b.addEventListener("MSPointerUp", this._onMSPointerUp, !1), b.addEventListener("pointerdown", this._onMSPointerDown, !1), b.addEventListener("pointermove", this._onMSPointerMove, !1), b.addEventListener("pointerup", this._onMSPointerUp, !1), b.style["-ms-content-zooming"] = "none", b.style["-ms-touch-action"] = "none", this.game.device.cocoonJS || (window.addEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), b.addEventListener("MSPointerOver", this._onMSPointerOver, !0), b.addEventListener("MSPointerOut", this._onMSPointerOut, !0), window.addEventListener("pointerup", this._onMSPointerUpGlobal, !0), b.addEventListener("pointerover", this._onMSPointerOver, !0), b.addEventListener("pointerout", this._onMSPointerOut, !0))
                }
            }
        }, onPointerDown: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.pointerDownCallback && this.pointerDownCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && (a.identifier = a.pointerId, "mouse" === a.pointerType || 4 === a.pointerType ? this.input.mousePointer.start(a) : this.input.startPointer(a))
        }, onPointerMove: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.pointerMoveCallback && this.pointerMoveCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && (a.identifier = a.pointerId, "mouse" === a.pointerType || 4 === a.pointerType ? this.input.mousePointer.move(a) : this.input.updatePointer(a))
        }, onPointerUp: function (a) {
            this.event = a, this.capture && a.preventDefault(), this.pointerUpCallback && this.pointerUpCallback.call(this.callbackContext, a), this.input.enabled && this.enabled && (a.identifier = a.pointerId, "mouse" === a.pointerType || 4 === a.pointerType ? this.input.mousePointer.stop(a) : this.input.stopPointer(a))
        }, onPointerUpGlobal: function (a) {
            if ("mouse" !== a.pointerType && 4 !== a.pointerType || this.input.mousePointer.withinGame) {
                var b = this.input.getPointerFromIdentifier(a.identifier);
                b && b.withinGame && this.onPointerUp(a)
            } else this.onPointerUp(a)
        }, onPointerOut: function (a) {
            if (this.event = a, this.capture && a.preventDefault(), "mouse" === a.pointerType || 4 === a.pointerType)this.input.mousePointer.withinGame = !1; else {
                var b = this.input.getPointerFromIdentifier(a.identifier);
                b && (b.withinGame = !1)
            }
            this.input.mouse.mouseOutCallback && this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext, a), this.input.enabled && this.enabled && this.input.mouse.stopOnGameOut && (a.identifier = 0, b ? b.stop(a) : this.input.mousePointer.stop(a))
        }, onPointerOver: function (a) {
            if (this.event = a, this.capture && a.preventDefault(), "mouse" === a.pointerType || 4 === a.pointerType)this.input.mousePointer.withinGame = !0; else {
                var b = this.input.getPointerFromIdentifier(a.identifier);
                b && (b.withinGame = !0)
            }
            this.input.mouse.mouseOverCallback && this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext, a)
        }, stop: function () {
            var a = this.game.canvas;
            a.removeEventListener("MSPointerDown", this._onMSPointerDown, !1), a.removeEventListener("MSPointerMove", this._onMSPointerMove, !1), a.removeEventListener("MSPointerUp", this._onMSPointerUp, !1), a.removeEventListener("pointerdown", this._onMSPointerDown, !1), a.removeEventListener("pointermove", this._onMSPointerMove, !1), a.removeEventListener("pointerup", this._onMSPointerUp, !1), window.removeEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), a.removeEventListener("MSPointerOver", this._onMSPointerOver, !0), a.removeEventListener("MSPointerOut", this._onMSPointerOut, !0), window.removeEventListener("pointerup", this._onMSPointerUpGlobal, !0), a.removeEventListener("pointerover", this._onMSPointerOver, !0), a.removeEventListener("pointerout", this._onMSPointerOut, !0)
        }
    },c.MSPointer.prototype.constructor = c.MSPointer,c.DeviceButton = function (a, b) {
        this.parent = a, this.game = a.game, this.event = null, this.isDown = !1, this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1, this.value = 0, this.buttonCode = b, this.onDown = new c.Signal, this.onUp = new c.Signal, this.onFloat = new c.Signal
    },c.DeviceButton.prototype = {
        start: function (a, b) {
            this.isDown || (this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, this.repeats = 0, this.event = a, this.value = b, a && (this.altKey = a.altKey, this.shiftKey = a.shiftKey, this.ctrlKey = a.ctrlKey), this.onDown.dispatch(this, b))
        }, stop: function (a, b) {
            this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.event = a, this.value = b, a && (this.altKey = a.altKey, this.shiftKey = a.shiftKey, this.ctrlKey = a.ctrlKey), this.onUp.dispatch(this, b))
        }, padFloat: function (a) {
            this.value = a, this.onFloat.dispatch(this, a)
        }, justPressed: function (a) {
            return a = a || 250, this.isDown && this.timeDown + a > this.game.time.time
        }, justReleased: function (a) {
            return a = a || 250, this.isUp && this.timeUp + a > this.game.time.time
        }, reset: function () {
            this.isDown = !1, this.isUp = !0, this.timeDown = this.game.time.time, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1
        }, destroy: function () {
            this.onDown.dispose(), this.onUp.dispose(), this.onFloat.dispose(), this.parent = null, this.game = null
        }
    },c.DeviceButton.prototype.constructor = c.DeviceButton,Object.defineProperty(c.DeviceButton.prototype, "duration", {
        get: function () {
            return this.isUp ? -1 : this.game.time.time - this.timeDown
        }
    }),c.Pointer = function (a, b, d) {
        this.game = a, this.id = b, this.type = c.POINTER, this.exists = !0, this.identifier = 0, this.pointerId = null, this.pointerMode = d || c.PointerMode.CURSOR | c.PointerMode.CONTACT, this.target = null, this.button = null, this.leftButton = new c.DeviceButton(this, c.Pointer.LEFT_BUTTON), this.middleButton = new c.DeviceButton(this, c.Pointer.MIDDLE_BUTTON), this.rightButton = new c.DeviceButton(this, c.Pointer.RIGHT_BUTTON), this.backButton = new c.DeviceButton(this, c.Pointer.BACK_BUTTON), this.forwardButton = new c.DeviceButton(this, c.Pointer.FORWARD_BUTTON), this.eraserButton = new c.DeviceButton(this, c.Pointer.ERASER_BUTTON), this._holdSent = !1, this._history = [], this._nextDrop = 0, this._stateReset = !1, this.withinGame = !1, this.clientX = -1, this.clientY = -1, this.pageX = -1, this.pageY = -1, this.screenX = -1, this.screenY = -1, this.rawMovementX = 0, this.rawMovementY = 0, this.movementX = 0, this.movementY = 0, this.x = -1, this.y = -1, this.isMouse = 0 === b, this.isDown = !1, this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.previousTapTime = 0, this.totalTouches = 0, this.msSinceLastClick = Number.MAX_VALUE, this.targetObject = null, this.interactiveCandidates = [], this.active = !1, this.dirty = !1, this.position = new c.Point, this.positionDown = new c.Point, this.positionUp = new c.Point, this.circle = new c.Circle(0, 0, 44), this._clickTrampolines = null, this._trampolineTargetObject = null
    },c.Pointer.NO_BUTTON = 0,c.Pointer.LEFT_BUTTON = 1,c.Pointer.RIGHT_BUTTON = 2,c.Pointer.MIDDLE_BUTTON = 4,c.Pointer.BACK_BUTTON = 8,c.Pointer.FORWARD_BUTTON = 16,c.Pointer.ERASER_BUTTON = 32,c.Pointer.prototype = {
        resetButtons: function () {
            this.isDown = !1, this.isUp = !0, this.isMouse && (this.leftButton.reset(), this.middleButton.reset(), this.rightButton.reset(), this.backButton.reset(), this.forwardButton.reset(), this.eraserButton.reset())
        }, processButtonsDown: function (a, b) {
            c.Pointer.LEFT_BUTTON & a && this.leftButton.start(b), c.Pointer.RIGHT_BUTTON & a && this.rightButton.start(b), c.Pointer.MIDDLE_BUTTON & a && this.middleButton.start(b), c.Pointer.BACK_BUTTON & a && this.backButton.start(b), c.Pointer.FORWARD_BUTTON & a && this.forwardButton.start(b), c.Pointer.ERASER_BUTTON & a && this.eraserButton.start(b)
        }, processButtonsUp: function (a, b) {
            a === c.Mouse.LEFT_BUTTON && this.leftButton.stop(b), a === c.Mouse.RIGHT_BUTTON && this.rightButton.stop(b), a === c.Mouse.MIDDLE_BUTTON && this.middleButton.stop(b), a === c.Mouse.BACK_BUTTON && this.backButton.stop(b), a === c.Mouse.FORWARD_BUTTON && this.forwardButton.stop(b), 5 === a && this.eraserButton.stop(b)
        }, updateButtons: function (a) {
            this.button = a.button;
            var b = "down" === a.type.toLowerCase().substr(-4);
            void 0 !== a.buttons ? b ? this.processButtonsDown(a.buttons, a) : this.processButtonsUp(a.button, a) : b ? this.leftButton.start(a) : (this.leftButton.stop(a), this.rightButton.stop(a)), 1 === a.buttons && a.ctrlKey && this.leftButton.isDown && (this.leftButton.stop(a), this.rightButton.start(a)), this.isUp = !0, this.isDown = !1, (this.leftButton.isDown || this.rightButton.isDown || this.middleButton.isDown || this.backButton.isDown || this.forwardButton.isDown || this.eraserButton.isDown) && (this.isUp = !1, this.isDown = !0)
        }, start: function (a) {
            var b = this.game.input;
            return a.pointerId && (this.pointerId = a.pointerId), this.identifier = a.identifier, this.target = a.target, this.isMouse ? this.updateButtons(a) : (this.isDown = !0, this.isUp = !1), this.active = !0, this.withinGame = !0, this.dirty = !1, this._history = [], this._clickTrampolines = null, this._trampolineTargetObject = null, this.msSinceLastClick = this.game.time.time - this.timeDown, this.timeDown = this.game.time.time, this._holdSent = !1, this.move(a, !0), this.positionDown.setTo(this.x, this.y), (b.multiInputOverride === c.Input.MOUSE_OVERRIDES_TOUCH || b.multiInputOverride === c.Input.MOUSE_TOUCH_COMBINE || b.multiInputOverride === c.Input.TOUCH_OVERRIDES_MOUSE && 0 === b.totalActivePointers) && (b.x = this.x, b.y = this.y, b.position.setTo(this.x, this.y), b.onDown.dispatch(this, a), b.resetSpeed(this.x, this.y)), this._stateReset = !1, this.totalTouches++, null !== this.targetObject && this.targetObject._touchedHandler(this), this
        }, update: function () {
            var a = this.game.input;
            this.active && (this.dirty && (a.interactiveItems.total > 0 && this.processInteractiveObjects(!1), this.dirty = !1), this._holdSent === !1 && this.duration >= a.holdRate && ((a.multiInputOverride === c.Input.MOUSE_OVERRIDES_TOUCH || a.multiInputOverride === c.Input.MOUSE_TOUCH_COMBINE || a.multiInputOverride === c.Input.TOUCH_OVERRIDES_MOUSE && 0 === a.totalActivePointers) && a.onHold.dispatch(this), this._holdSent = !0), a.recordPointerHistory && this.game.time.time >= this._nextDrop && (this._nextDrop = this.game.time.time + a.recordRate, this._history.push({
                x: this.position.x,
                y: this.position.y
            }), this._history.length > a.recordLimit && this._history.shift()))
        }, move: function (a, b) {
            var d = this.game.input;
            if (!d.pollLocked) {
                if (void 0 === b && (b = !1), void 0 !== a.button && (this.button = a.button), b && this.isMouse && this.updateButtons(a), this.clientX = a.clientX, this.clientY = a.clientY, this.pageX = a.pageX, this.pageY = a.pageY, this.screenX = a.screenX, this.screenY = a.screenY, this.isMouse && d.mouse.locked && !b && (this.rawMovementX = a.movementX || a.mozMovementX || a.webkitMovementX || 0, this.rawMovementY = a.movementY || a.mozMovementY || a.webkitMovementY || 0, this.movementX += this.rawMovementX, this.movementY += this.rawMovementY), this.x = (this.pageX - this.game.scale.offset.x) * d.scale.x, this.y = (this.pageY - this.game.scale.offset.y) * d.scale.y, this.position.setTo(this.x, this.y), this.circle.x = this.x, this.circle.y = this.y, (d.multiInputOverride === c.Input.MOUSE_OVERRIDES_TOUCH || d.multiInputOverride === c.Input.MOUSE_TOUCH_COMBINE || d.multiInputOverride === c.Input.TOUCH_OVERRIDES_MOUSE && 0 === d.totalActivePointers) && (d.activePointer = this, d.x = this.x, d.y = this.y, d.position.setTo(d.x, d.y), d.circle.x = d.x, d.circle.y = d.y), this.withinGame = this.game.scale.bounds.contains(this.pageX, this.pageY), this.game.paused)return this;
                for (var e = d.moveCallbacks.length; e--;)d.moveCallbacks[e].callback.call(d.moveCallbacks[e].context, this, this.x, this.y, b);
                return null !== this.targetObject && this.targetObject.isDragged === !0 ? this.targetObject.update(this) === !1 && (this.targetObject = null) : d.interactiveItems.total > 0 && this.processInteractiveObjects(b), this
            }
        }, processInteractiveObjects: function (a) {
            var b = 0, c = -1, d = null, e = this.game.input.interactiveItems.first;
            for (this.interactiveCandidates = []; e;)e.checked = !1, e.validForInput(c, b, !1) && (e.checked = !0, (a && e.checkPointerDown(this, !0) || !a && e.checkPointerOver(this, !0)) && (b = e.sprite.renderOrderID, c = e.priorityID, d = e, this.interactiveCandidates.push(e))), e = this.game.input.interactiveItems.next;
            for (e = this.game.input.interactiveItems.first; e;)!e.checked && e.validForInput(c, b, !0) && (a && e.checkPointerDown(this, !1) || !a && e.checkPointerOver(this, !1)) && (b = e.sprite.renderOrderID, c = e.priorityID, d = e, this.interactiveCandidates.push(e)), e = this.game.input.interactiveItems.next;
            return this.game.input.customCandidateHandler && (d = this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext, this, this.interactiveCandidates, d)), this.swapTarget(d, !1), null !== this.targetObject
        }, swapTarget: function (a, b) {
            void 0 === b && (b = !1), null === a ? this.targetObject && (this.targetObject._pointerOutHandler(this, b), this.targetObject = null) : null === this.targetObject ? (this.targetObject = a, a._pointerOverHandler(this, b)) : this.targetObject === a ? a.update(this) === !1 && (this.targetObject = null) : (this.targetObject._pointerOutHandler(this, b), this.targetObject = a, this.targetObject._pointerOverHandler(this, b))
        }, leave: function (a) {
            this.withinGame = !1, this.move(a, !1)
        }, stop: function (a) {
            var b = this.game.input;
            return this._stateReset && this.withinGame ? void a.preventDefault() : (this.timeUp = this.game.time.time, (b.multiInputOverride === c.Input.MOUSE_OVERRIDES_TOUCH || b.multiInputOverride === c.Input.MOUSE_TOUCH_COMBINE || b.multiInputOverride === c.Input.TOUCH_OVERRIDES_MOUSE && 0 === b.totalActivePointers) && (b.onUp.dispatch(this, a), this.duration >= 0 && this.duration <= b.tapRate && (this.timeUp - this.previousTapTime < b.doubleTapRate ? b.onTap.dispatch(this, !0) : b.onTap.dispatch(this, !1), this.previousTapTime = this.timeUp)), this.isMouse ? this.updateButtons(a) : (this.isDown = !1, this.isUp = !0), this.id > 0 && (this.active = !1), this.withinGame = this.game.scale.bounds.contains(a.pageX, a.pageY), this.pointerId = null, this.identifier = null, this.positionUp.setTo(this.x, this.y), this.isMouse === !1 && b.currentPointers--, b.interactiveItems.callAll("_releasedHandler", this), this._clickTrampolines && (this._trampolineTargetObject = this.targetObject), this.targetObject = null, this)
        }, justPressed: function (a) {
            return a = a || this.game.input.justPressedRate, this.isDown === !0 && this.timeDown + a > this.game.time.time
        }, justReleased: function (a) {
            return a = a || this.game.input.justReleasedRate, this.isUp && this.timeUp + a > this.game.time.time
        }, addClickTrampoline: function (a, b, c, d) {
            if (this.isDown) {
                for (var e = this._clickTrampolines = this._clickTrampolines || [], f = 0; f < e.length; f++)if (e[f].name === a) {
                    e.splice(f, 1);
                    break
                }
                e.push({name: a, targetObject: this.targetObject, callback: b, callbackContext: c, callbackArgs: d})
            }
        }, processClickTrampolines: function () {
            var a = this._clickTrampolines;
            if (a) {
                for (var b = 0; b < a.length; b++) {
                    var c = a[b];
                    c.targetObject === this._trampolineTargetObject && c.callback.apply(c.callbackContext, c.callbackArgs)
                }
                this._clickTrampolines = null, this._trampolineTargetObject = null
            }
        }, reset: function () {
            this.isMouse === !1 && (this.active = !1), this.pointerId = null, this.identifier = null, this.dirty = !1, this.totalTouches = 0, this._holdSent = !1, this._history.length = 0, this._stateReset = !0, this.resetButtons(), this.targetObject && this.targetObject._releasedHandler(this), this.targetObject = null
        }, resetMovement: function () {
            this.movementX = 0, this.movementY = 0
        }
    },c.Pointer.prototype.constructor = c.Pointer,Object.defineProperty(c.Pointer.prototype, "duration", {
        get: function () {
            return this.isUp ? -1 : this.game.time.time - this.timeDown
        }
    }),Object.defineProperty(c.Pointer.prototype, "worldX", {
        get: function () {
            return this.game.world.camera.x + this.x
        }
    }),Object.defineProperty(c.Pointer.prototype, "worldY", {
        get: function () {
            return this.game.world.camera.y + this.y
        }
    }),c.PointerMode = {CURSOR: 1, CONTACT: 2},c.Touch = function (a) {
        this.game = a, this.enabled = !0, this.touchLockCallbacks = [], this.callbackContext = this.game, this.touchStartCallback = null, this.touchMoveCallback = null, this.touchEndCallback = null, this.touchEnterCallback = null, this.touchLeaveCallback = null, this.touchCancelCallback = null, this.preventDefault = !0, this.event = null, this._onTouchStart = null, this._onTouchMove = null, this._onTouchEnd = null, this._onTouchEnter = null, this._onTouchLeave = null, this._onTouchCancel = null, this._onTouchMove = null
    },c.Touch.prototype = {
        start: function () {
            if (null === this._onTouchStart) {
                var a = this;
                this.game.device.touch && (this._onTouchStart = function (b) {
                    return a.onTouchStart(b)
                }, this._onTouchMove = function (b) {
                    return a.onTouchMove(b)
                }, this._onTouchEnd = function (b) {
                    return a.onTouchEnd(b)
                }, this._onTouchEnter = function (b) {
                    return a.onTouchEnter(b)
                }, this._onTouchLeave = function (b) {
                    return a.onTouchLeave(b)
                }, this._onTouchCancel = function (b) {
                    return a.onTouchCancel(b)
                }, this.game.canvas.addEventListener("touchstart", this._onTouchStart, !1), this.game.canvas.addEventListener("touchmove", this._onTouchMove, !1), this.game.canvas.addEventListener("touchend", this._onTouchEnd, !1), this.game.canvas.addEventListener("touchcancel", this._onTouchCancel, !1), this.game.device.cocoonJS || (this.game.canvas.addEventListener("touchenter", this._onTouchEnter, !1), this.game.canvas.addEventListener("touchleave", this._onTouchLeave, !1)))
            }
        }, consumeDocumentTouches: function () {
            this._documentTouchMove = function (a) {
                a.preventDefault()
            }, document.addEventListener("touchmove", this._documentTouchMove, !1)
        }, addTouchLockCallback: function (a, b, c) {
            void 0 === c && (c = !1), this.touchLockCallbacks.push({callback: a, context: b, onEnd: c})
        }, removeTouchLockCallback: function (a, b) {
            for (var c = this.touchLockCallbacks.length; c--;)if (this.touchLockCallbacks[c].callback === a && this.touchLockCallbacks[c].context === b)return this.touchLockCallbacks.splice(c, 1), !0;
            return !1
        }, onTouchStart: function (a) {
            for (var b = this.touchLockCallbacks.length; b--;) {
                var c = this.touchLockCallbacks[b];
                !c.onEnd && c.callback.call(c.context, this, a) && this.touchLockCallbacks.splice(b, 1)
            }
            if (this.event = a, this.game.input.enabled && this.enabled) {
                this.touchStartCallback && this.touchStartCallback.call(this.callbackContext, a), this.preventDefault && a.preventDefault();
                for (var b = 0; b < a.changedTouches.length; b++)this.game.input.startPointer(a.changedTouches[b])
            }
        }, onTouchCancel: function (a) {
            if (this.event = a, this.touchCancelCallback && this.touchCancelCallback.call(this.callbackContext, a), this.game.input.enabled && this.enabled) {
                this.preventDefault && a.preventDefault();
                for (var b = 0; b < a.changedTouches.length; b++)this.game.input.stopPointer(a.changedTouches[b])
            }
        }, onTouchEnter: function (a) {
            this.event = a, this.touchEnterCallback && this.touchEnterCallback.call(this.callbackContext, a), this.game.input.enabled && this.enabled && this.preventDefault && a.preventDefault()
        }, onTouchLeave: function (a) {
            this.event = a, this.touchLeaveCallback && this.touchLeaveCallback.call(this.callbackContext, a), this.preventDefault && a.preventDefault()
        }, onTouchMove: function (a) {
            this.event = a, this.touchMoveCallback && this.touchMoveCallback.call(this.callbackContext, a), this.preventDefault && a.preventDefault();
            for (var b = 0; b < a.changedTouches.length; b++)this.game.input.updatePointer(a.changedTouches[b])
        }, onTouchEnd: function (a) {
            for (var b = this.touchLockCallbacks.length; b--;) {
                var c = this.touchLockCallbacks[b];
                c.onEnd && c.callback.call(c.context, this, a) && this.touchLockCallbacks.splice(b, 1)
            }
            this.event = a, this.touchEndCallback && this.touchEndCallback.call(this.callbackContext, a), this.preventDefault && a.preventDefault();
            for (var b = 0; b < a.changedTouches.length; b++)this.game.input.stopPointer(a.changedTouches[b])
        }, stop: function () {
            this.game.device.touch && (this.game.canvas.removeEventListener("touchstart", this._onTouchStart), this.game.canvas.removeEventListener("touchmove", this._onTouchMove), this.game.canvas.removeEventListener("touchend", this._onTouchEnd), this.game.canvas.removeEventListener("touchenter", this._onTouchEnter), this.game.canvas.removeEventListener("touchleave", this._onTouchLeave), this.game.canvas.removeEventListener("touchcancel", this._onTouchCancel))
        }
    },c.Touch.prototype.constructor = c.Touch,c.InputHandler = function (a) {
        this.sprite = a, this.game = a.game, this.enabled = !1, this.checked = !1, this.priorityID = 0, this.useHandCursor = !1, this._setHandCursor = !1, this.isDragged = !1, this.allowHorizontalDrag = !0, this.allowVerticalDrag = !0, this.bringToTop = !1, this.snapOffset = null, this.snapOnDrag = !1, this.snapOnRelease = !1, this.snapX = 0, this.snapY = 0, this.snapOffsetX = 0, this.snapOffsetY = 0, this.pixelPerfectOver = !1, this.pixelPerfectClick = !1, this.pixelPerfectAlpha = 255, this.draggable = !1, this.boundsRect = null, this.boundsSprite = null, this.scaleLayer = !1, this.dragOffset = new c.Point, this.dragFromCenter = !1, this.dragStopBlocksInputUp = !1, this.dragStartPoint = new c.Point, this.dragDistanceThreshold = 0, this.dragTimeThreshold = 0, this.downPoint = new c.Point, this.snapPoint = new c.Point, this._dragPoint = new c.Point, this._dragPhase = !1, this._pendingDrag = !1, this._dragTimePass = !1, this._dragDistancePass = !1, this._wasEnabled = !1, this._tempPoint = new c.Point, this._pointerData = [], this._pointerData.push({
            id: 0,
            x: 0,
            y: 0,
            camX: 0,
            camY: 0,
            isDown: !1,
            isUp: !1,
            isOver: !1,
            isOut: !1,
            timeOver: 0,
            timeOut: 0,
            timeDown: 0,
            timeUp: 0,
            downDuration: 0,
            isDragged: !1
        })
    },c.InputHandler.prototype = {
        start: function (a, b) {
            if (a = a || 0, void 0 === b && (b = !1), this.enabled === !1) {
                this.game.input.interactiveItems.add(this), this.useHandCursor = b, this.priorityID = a;
                for (var d = 0; 10 > d; d++)this._pointerData[d] = {
                    id: d,
                    x: 0,
                    y: 0,
                    isDown: !1,
                    isUp: !1,
                    isOver: !1,
                    isOut: !1,
                    timeOver: 0,
                    timeOut: 0,
                    timeDown: 0,
                    timeUp: 0,
                    downDuration: 0,
                    isDragged: !1
                };
                this.snapOffset = new c.Point, this.enabled = !0, this._wasEnabled = !0
            }
            return this.sprite.events.onAddedToGroup.add(this.addedToGroup, this), this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup, this), this.flagged = !1, this.sprite
        }, addedToGroup: function () {
            this._dragPhase || this._wasEnabled && !this.enabled && this.start()
        }, removedFromGroup: function () {
            this._dragPhase || (this.enabled ? (this._wasEnabled = !0, this.stop()) : this._wasEnabled = !1)
        }, reset: function () {
            this.enabled = !1, this.flagged = !1;
            for (var a = 0; 10 > a; a++)this._pointerData[a] = {
                id: a,
                x: 0,
                y: 0,
                isDown: !1,
                isUp: !1,
                isOver: !1,
                isOut: !1,
                timeOver: 0,
                timeOut: 0,
                timeDown: 0,
                timeUp: 0,
                downDuration: 0,
                isDragged: !1
            }
        }, stop: function () {
            this.enabled !== !1 && (this.enabled = !1, this.game.input.interactiveItems.remove(this))
        }, destroy: function () {
            this.sprite && (this._setHandCursor && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), this.enabled = !1, this.game.input.interactiveItems.remove(this), this._pointerData.length = 0, this.boundsRect = null, this.boundsSprite = null, this.sprite = null)
        }, validForInput: function (a, b, c) {
            return void 0 === c && (c = !0), !this.enabled || 0 === this.sprite.scale.x || 0 === this.sprite.scale.y || this.priorityID < this.game.input.minPriorityID || this.sprite.parent && this.sprite.parent.ignoreChildInput ? !1 : (c || !this.pixelPerfectClick && !this.pixelPerfectOver) && (this.priorityID > a || this.priorityID === a && this.sprite.renderOrderID > b) ? !0 : !1
        }, isPixelPerfect: function () {
            return this.pixelPerfectClick || this.pixelPerfectOver
        }, pointerX: function (a) {
            return a = a || 0, this._pointerData[a].x
        }, pointerY: function (a) {
            return a = a || 0, this._pointerData[a].y
        }, pointerDown: function (a) {
            return a = a || 0, this._pointerData[a].isDown
        }, pointerUp: function (a) {
            return a = a || 0, this._pointerData[a].isUp
        }, pointerTimeDown: function (a) {
            return a = a || 0, this._pointerData[a].timeDown
        }, pointerTimeUp: function (a) {
            return a = a || 0, this._pointerData[a].timeUp
        }, pointerOver: function (a) {
            if (!this.enabled)return !1;
            if (void 0 === a) {
                for (var b = 0; 10 > b; b++)if (this._pointerData[b].isOver)return !0;
                return !1
            }
            return this._pointerData[a].isOver
        }, pointerOut: function (a) {
            if (!this.enabled)return !1;
            if (void 0 !== a)return this._pointerData[a].isOut;
            for (var b = 0; 10 > b; b++)if (this._pointerData[b].isOut)return !0
        }, pointerTimeOver: function (a) {
            return a = a || 0, this._pointerData[a].timeOver
        }, pointerTimeOut: function (a) {
            return a = a || 0, this._pointerData[a].timeOut
        }, pointerDragged: function (a) {
            return a = a || 0, this._pointerData[a].isDragged
        }, checkPointerDown: function (a, b) {
            return a.isDown && this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y && this.game.input.hitTest(this.sprite, a, this._tempPoint) ? (void 0 === b && (b = !1), !b && this.pixelPerfectClick ? this.checkPixel(this._tempPoint.x, this._tempPoint.y) : !0) : !1
        }, checkPointerOver: function (a, b) {
            return this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y && this.game.input.hitTest(this.sprite, a, this._tempPoint) ? (void 0 === b && (b = !1), !b && this.pixelPerfectOver ? this.checkPixel(this._tempPoint.x, this._tempPoint.y) : !0) : !1
        }, checkPixel: function (a, b, c) {
            if (this.sprite.texture.baseTexture.source) {
                if (null === a && null === b) {
                    this.game.input.getLocalPosition(this.sprite, c, this._tempPoint);
                    var a = this._tempPoint.x, b = this._tempPoint.y
                }
                if (0 !== this.sprite.anchor.x && (a -= -this.sprite.texture.frame.width * this.sprite.anchor.x), 0 !== this.sprite.anchor.y && (b -= -this.sprite.texture.frame.height * this.sprite.anchor.y), a += this.sprite.texture.frame.x, b += this.sprite.texture.frame.y, this.sprite.texture.trim && (a -= this.sprite.texture.trim.x, b -= this.sprite.texture.trim.y, a < this.sprite.texture.crop.x || a > this.sprite.texture.crop.right || b < this.sprite.texture.crop.y || b > this.sprite.texture.crop.bottom))return this._dx = a, this._dy = b, !1;
                this._dx = a, this._dy = b, this.game.input.hitContext.clearRect(0, 0, 1, 1), this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source, a, b, 1, 1, 0, 0, 1, 1);
                var d = this.game.input.hitContext.getImageData(0, 0, 1, 1);
                if (d.data[3] >= this.pixelPerfectAlpha)return !0
            }
            return !1
        }, update: function (a) {
            return null !== this.sprite && void 0 !== this.sprite.parent ? this.enabled && this.sprite.visible && this.sprite.parent.visible ? this._pendingDrag ? (this._dragDistancePass || (this._dragDistancePass = c.Math.distance(a.x, a.y, this.downPoint.x, this.downPoint.y) >= this.dragDistanceThreshold), this._dragDistancePass && this._dragTimePass && this.startDrag(a), !0) : this.draggable && this._draggedPointerID === a.id ? this.updateDrag(a, !1) : this._pointerData[a.id].isOver ? this.checkPointerOver(a) ? (this._pointerData[a.id].x = a.x - this.sprite.x, this._pointerData[a.id].y = a.y - this.sprite.y, !0) : (this._pointerOutHandler(a), !1) : void 0 : (this._pointerOutHandler(a), !1) : void 0
        }, _pointerOverHandler: function (a, b) {
            if (null !== this.sprite) {
                var d = this._pointerData[a.id];
                if (d.isOver === !1 || a.dirty) {
                    var e = d.isOver === !1;
                    d.isOver = !0, d.isOut = !1, d.timeOver = this.game.time.time, d.x = a.x - this.sprite.x, d.y = a.y - this.sprite.y, this.useHandCursor && d.isDragged === !1 && (this.game.canvas.style.cursor = "pointer", this._setHandCursor = !0), !b && e && this.sprite && this.sprite.events && this.sprite.events.onInputOver$dispatch(this.sprite, a), this.sprite.parent && this.sprite.parent.type === c.GROUP && this.sprite.parent.onChildInputOver.dispatch(this.sprite, a)
                }
            }
        }, _pointerOutHandler: function (a, b) {
            if (null !== this.sprite) {
                var d = this._pointerData[a.id];
                d.isOver = !1, d.isOut = !0, d.timeOut = this.game.time.time, this.useHandCursor && d.isDragged === !1 && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), !b && this.sprite && this.sprite.events && (this.sprite.events.onInputOut$dispatch(this.sprite, a), this.sprite && this.sprite.parent && this.sprite.parent.type === c.GROUP && this.sprite.parent.onChildInputOut.dispatch(this.sprite, a))
            }
        }, _touchedHandler: function (a) {
            if (null !== this.sprite) {
                var b = this._pointerData[a.id];
                if (!b.isDown && b.isOver) {
                    if (this.pixelPerfectClick && !this.checkPixel(null, null, a))return;
                    if (b.isDown = !0, b.isUp = !1, b.timeDown = this.game.time.time, this.downPoint.set(a.x, a.y), a.dirty = !0, this.sprite && this.sprite.events && (this.sprite.events.onInputDown$dispatch(this.sprite, a), this.sprite && this.sprite.parent && this.sprite.parent.type === c.GROUP && this.sprite.parent.onChildInputDown.dispatch(this.sprite, a), null === this.sprite))return;
                    this.draggable && this.isDragged === !1 && (0 === this.dragTimeThreshold && 0 === this.dragDistanceThreshold ? this.startDrag(a) : (this._pendingDrag = !0, this._dragDistancePass = 0 === this.dragDistanceThreshold, this.dragTimeThreshold > 0 ? (this._dragTimePass = !1, this.game.time.events.add(this.dragTimeThreshold, this.dragTimeElapsed, this, a)) : this._dragTimePass = !0)), this.bringToTop && this.sprite.bringToTop()
                }
            }
        }, dragTimeElapsed: function (a) {
            this._dragTimePass = !0, this._pendingDrag && this.sprite && this._dragDistancePass && this.startDrag(a)
        }, _releasedHandler: function (a) {
            if (null !== this.sprite) {
                var b = this._pointerData[a.id];
                if (b.isDown && a.isUp) {
                    b.isDown = !1, b.isUp = !0, b.timeUp = this.game.time.time, b.downDuration = b.timeUp - b.timeDown;
                    var d = this.checkPointerOver(a);
                    this.sprite && this.sprite.events && (this.dragStopBlocksInputUp && (!this.dragStopBlocksInputUp || this.draggable && this.isDragged && this._draggedPointerID === a.id) || this.sprite.events.onInputUp$dispatch(this.sprite, a, d), this.sprite && this.sprite.parent && this.sprite.parent.type === c.GROUP && this.sprite.parent.onChildInputUp.dispatch(this.sprite, a, d), d && (d = this.checkPointerOver(a))), b.isOver = d, !d && this.useHandCursor && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), a.dirty = !0,
                        this._pendingDrag = !1, this.draggable && this.isDragged && this._draggedPointerID === a.id && this.stopDrag(a)
                }
            }
        }, updateDrag: function (a, b) {
            if (void 0 === b && (b = !1), a.isUp)return this.stopDrag(a), !1;
            var c = this.globalToLocalX(a.x) + this._dragPoint.x + this.dragOffset.x, d = this.globalToLocalY(a.y) + this._dragPoint.y + this.dragOffset.y;
            if (this.sprite.fixedToCamera)this.allowHorizontalDrag && (this.sprite.cameraOffset.x = c), this.allowVerticalDrag && (this.sprite.cameraOffset.y = d), this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), this.snapOnDrag && (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, this.snapPoint.set(this.sprite.cameraOffset.x, this.sprite.cameraOffset.y)); else {
                var e = this.game.camera.x - this._pointerData[a.id].camX, f = this.game.camera.y - this._pointerData[a.id].camY;
                this.allowHorizontalDrag && (this.sprite.x = c + e), this.allowVerticalDrag && (this.sprite.y = d + f), this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), this.snapOnDrag && (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, this.snapPoint.set(this.sprite.x, this.sprite.y))
            }
            return this.sprite.events.onDragUpdate.dispatch(this.sprite, a, c, d, this.snapPoint, b), !0
        }, justOver: function (a, b) {
            return a = a || 0, b = b || 500, this._pointerData[a].isOver && this.overDuration(a) < b
        }, justOut: function (a, b) {
            return a = a || 0, b = b || 500, this._pointerData[a].isOut && this.game.time.time - this._pointerData[a].timeOut < b
        }, justPressed: function (a, b) {
            return a = a || 0, b = b || 500, this._pointerData[a].isDown && this.downDuration(a) < b
        }, justReleased: function (a, b) {
            return a = a || 0, b = b || 500, this._pointerData[a].isUp && this.game.time.time - this._pointerData[a].timeUp < b
        }, overDuration: function (a) {
            return a = a || 0, this._pointerData[a].isOver ? this.game.time.time - this._pointerData[a].timeOver : -1
        }, downDuration: function (a) {
            return a = a || 0, this._pointerData[a].isDown ? this.game.time.time - this._pointerData[a].timeDown : -1
        }, enableDrag: function (a, b, d, e, f, g) {
            void 0 === a && (a = !1), void 0 === b && (b = !1), void 0 === d && (d = !1), void 0 === e && (e = 255), void 0 === f && (f = null), void 0 === g && (g = null), this._dragPoint = new c.Point, this.draggable = !0, this.bringToTop = b, this.dragOffset = new c.Point, this.dragFromCenter = a, this.pixelPerfectClick = d, this.pixelPerfectAlpha = e, f && (this.boundsRect = f), g && (this.boundsSprite = g)
        }, disableDrag: function () {
            if (this._pointerData)for (var a = 0; 10 > a; a++)this._pointerData[a].isDragged = !1;
            this.draggable = !1, this.isDragged = !1, this._draggedPointerID = -1, this._pendingDrag = !1
        }, startDrag: function (a) {
            var b = this.sprite.x, c = this.sprite.y;
            if (this.isDragged = !0, this._draggedPointerID = a.id, this._pointerData[a.id].camX = this.game.camera.x, this._pointerData[a.id].camY = this.game.camera.y, this._pointerData[a.id].isDragged = !0, this.sprite.fixedToCamera) {
                if (this.dragFromCenter) {
                    var d = this.sprite.getBounds();
                    this.sprite.cameraOffset.x = this.globalToLocalX(a.x) + (this.sprite.cameraOffset.x - d.centerX), this.sprite.cameraOffset.y = this.globalToLocalY(a.y) + (this.sprite.cameraOffset.y - d.centerY)
                }
                this._dragPoint.setTo(this.sprite.cameraOffset.x - a.x, this.sprite.cameraOffset.y - a.y)
            } else {
                if (this.dragFromCenter) {
                    var d = this.sprite.getBounds();
                    this.sprite.x = this.globalToLocalX(a.x) + (this.sprite.x - d.centerX), this.sprite.y = this.globalToLocalY(a.y) + (this.sprite.y - d.centerY)
                }
                this._dragPoint.setTo(this.sprite.x - this.globalToLocalX(a.x), this.sprite.y - this.globalToLocalY(a.y))
            }
            this.updateDrag(a, !0), this.bringToTop && (this._dragPhase = !0, this.sprite.bringToTop()), this.dragStartPoint.set(b, c), this.sprite.events.onDragStart$dispatch(this.sprite, a, b, c), this._pendingDrag = !1
        }, globalToLocalX: function (a) {
            return this.scaleLayer && (a -= this.game.scale.grid.boundsFluid.x, a *= this.game.scale.grid.scaleFluidInversed.x), a
        }, globalToLocalY: function (a) {
            return this.scaleLayer && (a -= this.game.scale.grid.boundsFluid.y, a *= this.game.scale.grid.scaleFluidInversed.y), a
        }, stopDrag: function (a) {
            this.isDragged = !1, this._draggedPointerID = -1, this._pointerData[a.id].isDragged = !1, this._dragPhase = !1, this._pendingDrag = !1, this.snapOnRelease && (this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY) : (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY)), this.sprite.events.onDragStop$dispatch(this.sprite, a), this.checkPointerOver(a) === !1 && this._pointerOutHandler(a)
        }, setDragLock: function (a, b) {
            void 0 === a && (a = !0), void 0 === b && (b = !0), this.allowHorizontalDrag = a, this.allowVerticalDrag = b
        }, enableSnap: function (a, b, c, d, e, f) {
            void 0 === c && (c = !0), void 0 === d && (d = !1), void 0 === e && (e = 0), void 0 === f && (f = 0), this.snapX = a, this.snapY = b, this.snapOffsetX = e, this.snapOffsetY = f, this.snapOnDrag = c, this.snapOnRelease = d
        }, disableSnap: function () {
            this.snapOnDrag = !1, this.snapOnRelease = !1
        }, checkBoundsRect: function () {
            this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsRect.left ? this.sprite.cameraOffset.x = this.boundsRect.left : this.sprite.cameraOffset.x + this.sprite.width > this.boundsRect.right && (this.sprite.cameraOffset.x = this.boundsRect.right - this.sprite.width), this.sprite.cameraOffset.y < this.boundsRect.top ? this.sprite.cameraOffset.y = this.boundsRect.top : this.sprite.cameraOffset.y + this.sprite.height > this.boundsRect.bottom && (this.sprite.cameraOffset.y = this.boundsRect.bottom - this.sprite.height)) : (this.sprite.left < this.boundsRect.left ? this.sprite.x = this.boundsRect.x + this.sprite.offsetX : this.sprite.right > this.boundsRect.right && (this.sprite.x = this.boundsRect.right - (this.sprite.width - this.sprite.offsetX)), this.sprite.top < this.boundsRect.top ? this.sprite.y = this.boundsRect.top + this.sprite.offsetY : this.sprite.bottom > this.boundsRect.bottom && (this.sprite.y = this.boundsRect.bottom - (this.sprite.height - this.sprite.offsetY)))
        }, checkBoundsSprite: function () {
            this.sprite.fixedToCamera && this.boundsSprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsSprite.cameraOffset.x ? this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x : this.sprite.cameraOffset.x + this.sprite.width > this.boundsSprite.cameraOffset.x + this.boundsSprite.width && (this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x + this.boundsSprite.width - this.sprite.width), this.sprite.cameraOffset.y < this.boundsSprite.cameraOffset.y ? this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y : this.sprite.cameraOffset.y + this.sprite.height > this.boundsSprite.cameraOffset.y + this.boundsSprite.height && (this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y + this.boundsSprite.height - this.sprite.height)) : (this.sprite.left < this.boundsSprite.left ? this.sprite.x = this.boundsSprite.left + this.sprite.offsetX : this.sprite.right > this.boundsSprite.right && (this.sprite.x = this.boundsSprite.right - (this.sprite.width - this.sprite.offsetX)), this.sprite.top < this.boundsSprite.top ? this.sprite.y = this.boundsSprite.top + this.sprite.offsetY : this.sprite.bottom > this.boundsSprite.bottom && (this.sprite.y = this.boundsSprite.bottom - (this.sprite.height - this.sprite.offsetY)))
        }
    },c.InputHandler.prototype.constructor = c.InputHandler,c.Gamepad = function (a) {
        this.game = a, this._gamepadIndexMap = {}, this._rawPads = [], this._active = !1, this.enabled = !0, this._gamepadSupportAvailable = !!navigator.webkitGetGamepads || !!navigator.webkitGamepads || -1 != navigator.userAgent.indexOf("Firefox/") || !!navigator.getGamepads, this._prevRawGamepadTypes = [], this._prevTimestamps = [], this.callbackContext = this, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null, this._ongamepadconnected = null, this._gamepaddisconnected = null, this._gamepads = [new c.SinglePad(a, this), new c.SinglePad(a, this), new c.SinglePad(a, this), new c.SinglePad(a, this)]
    },c.Gamepad.prototype = {
        addCallbacks: function (a, b) {
            "undefined" != typeof b && (this.onConnectCallback = "function" == typeof b.onConnect ? b.onConnect : this.onConnectCallback, this.onDisconnectCallback = "function" == typeof b.onDisconnect ? b.onDisconnect : this.onDisconnectCallback, this.onDownCallback = "function" == typeof b.onDown ? b.onDown : this.onDownCallback, this.onUpCallback = "function" == typeof b.onUp ? b.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof b.onAxis ? b.onAxis : this.onAxisCallback, this.onFloatCallback = "function" == typeof b.onFloat ? b.onFloat : this.onFloatCallback, this.callbackContext = a)
        }, start: function () {
            if (!this._active) {
                this._active = !0;
                var a = this;
                this._onGamepadConnected = function (b) {
                    return a.onGamepadConnected(b)
                }, this._onGamepadDisconnected = function (b) {
                    return a.onGamepadDisconnected(b)
                }, window.addEventListener("gamepadconnected", this._onGamepadConnected, !1), window.addEventListener("gamepaddisconnected", this._onGamepadDisconnected, !1)
            }
        }, onGamepadConnected: function (a) {
            var b = a.gamepad;
            this._rawPads.push(b), this._gamepads[b.index].connect(b)
        }, onGamepadDisconnected: function (a) {
            var b = a.gamepad;
            for (var c in this._rawPads)this._rawPads[c].index === b.index && this._rawPads.splice(c, 1);
            this._gamepads[b.index].disconnect()
        }, update: function () {
            this._pollGamepads(), this.pad1.pollStatus(), this.pad2.pollStatus(), this.pad3.pollStatus(), this.pad4.pollStatus()
        }, _pollGamepads: function () {
            if (this._active) {
                if (navigator.getGamepads)var a = navigator.getGamepads(); else if (navigator.webkitGetGamepads)var a = navigator.webkitGetGamepads(); else if (navigator.webkitGamepads)var a = navigator.webkitGamepads();
                if (a) {
                    this._rawPads = [];
                    for (var b = !1, c = 0; c < a.length && (typeof a[c] !== this._prevRawGamepadTypes[c] && (b = !0, this._prevRawGamepadTypes[c] = typeof a[c]), a[c] && this._rawPads.push(a[c]), 3 !== c); c++);
                    for (var d = 0; d < this._gamepads.length; d++)this._gamepads[d]._rawPad = this._rawPads[d];
                    if (b) {
                        for (var e, f = {
                            rawIndices: {},
                            padIndices: {}
                        }, g = 0; g < this._gamepads.length; g++)if (e = this._gamepads[g], e.connected)for (var h = 0; h < this._rawPads.length; h++)this._rawPads[h].index === e.index && (f.rawIndices[e.index] = !0, f.padIndices[g] = !0);
                        for (var i = 0; i < this._gamepads.length; i++)if (e = this._gamepads[i], !f.padIndices[i]) {
                            this._rawPads.length < 1 && e.disconnect();
                            for (var j = 0; j < this._rawPads.length && !f.padIndices[i]; j++) {
                                var k = this._rawPads[j];
                                if (k) {
                                    if (f.rawIndices[k.index]) {
                                        e.disconnect();
                                        continue
                                    }
                                    e.connect(k), f.rawIndices[k.index] = !0, f.padIndices[i] = !0
                                } else e.disconnect()
                            }
                        }
                    }
                }
            }
        }, setDeadZones: function (a) {
            for (var b = 0; b < this._gamepads.length; b++)this._gamepads[b].deadZone = a
        }, stop: function () {
            this._active = !1, window.removeEventListener("gamepadconnected", this._onGamepadConnected), window.removeEventListener("gamepaddisconnected", this._onGamepadDisconnected)
        }, reset: function () {
            this.update();
            for (var a = 0; a < this._gamepads.length; a++)this._gamepads[a].reset()
        }, justPressed: function (a, b) {
            for (var c = 0; c < this._gamepads.length; c++)if (this._gamepads[c].justPressed(a, b) === !0)return !0;
            return !1
        }, justReleased: function (a, b) {
            for (var c = 0; c < this._gamepads.length; c++)if (this._gamepads[c].justReleased(a, b) === !0)return !0;
            return !1
        }, isDown: function (a) {
            for (var b = 0; b < this._gamepads.length; b++)if (this._gamepads[b].isDown(a) === !0)return !0;
            return !1
        }, destroy: function () {
            this.stop();
            for (var a = 0; a < this._gamepads.length; a++)this._gamepads[a].destroy()
        }
    },c.Gamepad.prototype.constructor = c.Gamepad,Object.defineProperty(c.Gamepad.prototype, "active", {
        get: function () {
            return this._active
        }
    }),Object.defineProperty(c.Gamepad.prototype, "supported", {
        get: function () {
            return this._gamepadSupportAvailable
        }
    }),Object.defineProperty(c.Gamepad.prototype, "padsConnected", {
        get: function () {
            return this._rawPads.length
        }
    }),Object.defineProperty(c.Gamepad.prototype, "pad1", {
        get: function () {
            return this._gamepads[0]
        }
    }),Object.defineProperty(c.Gamepad.prototype, "pad2", {
        get: function () {
            return this._gamepads[1]
        }
    }),Object.defineProperty(c.Gamepad.prototype, "pad3", {
        get: function () {
            return this._gamepads[2]
        }
    }),Object.defineProperty(c.Gamepad.prototype, "pad4", {
        get: function () {
            return this._gamepads[3]
        }
    }),c.Gamepad.BUTTON_0 = 0,c.Gamepad.BUTTON_1 = 1,c.Gamepad.BUTTON_2 = 2,c.Gamepad.BUTTON_3 = 3,c.Gamepad.BUTTON_4 = 4,c.Gamepad.BUTTON_5 = 5,c.Gamepad.BUTTON_6 = 6,c.Gamepad.BUTTON_7 = 7,c.Gamepad.BUTTON_8 = 8,c.Gamepad.BUTTON_9 = 9,c.Gamepad.BUTTON_10 = 10,c.Gamepad.BUTTON_11 = 11,c.Gamepad.BUTTON_12 = 12,c.Gamepad.BUTTON_13 = 13,c.Gamepad.BUTTON_14 = 14,c.Gamepad.BUTTON_15 = 15,c.Gamepad.AXIS_0 = 0,c.Gamepad.AXIS_1 = 1,c.Gamepad.AXIS_2 = 2,c.Gamepad.AXIS_3 = 3,c.Gamepad.AXIS_4 = 4,c.Gamepad.AXIS_5 = 5,c.Gamepad.AXIS_6 = 6,c.Gamepad.AXIS_7 = 7,c.Gamepad.AXIS_8 = 8,c.Gamepad.AXIS_9 = 9,c.Gamepad.XBOX360_A = 0,c.Gamepad.XBOX360_B = 1,c.Gamepad.XBOX360_X = 2,c.Gamepad.XBOX360_Y = 3,c.Gamepad.XBOX360_LEFT_BUMPER = 4,c.Gamepad.XBOX360_RIGHT_BUMPER = 5,c.Gamepad.XBOX360_LEFT_TRIGGER = 6,c.Gamepad.XBOX360_RIGHT_TRIGGER = 7,c.Gamepad.XBOX360_BACK = 8,c.Gamepad.XBOX360_START = 9,c.Gamepad.XBOX360_STICK_LEFT_BUTTON = 10,c.Gamepad.XBOX360_STICK_RIGHT_BUTTON = 11,c.Gamepad.XBOX360_DPAD_LEFT = 14,c.Gamepad.XBOX360_DPAD_RIGHT = 15,c.Gamepad.XBOX360_DPAD_UP = 12,c.Gamepad.XBOX360_DPAD_DOWN = 13,c.Gamepad.XBOX360_STICK_LEFT_X = 0,c.Gamepad.XBOX360_STICK_LEFT_Y = 1,c.Gamepad.XBOX360_STICK_RIGHT_X = 2,c.Gamepad.XBOX360_STICK_RIGHT_Y = 3,c.Gamepad.PS3XC_X = 0,c.Gamepad.PS3XC_CIRCLE = 1,c.Gamepad.PS3XC_SQUARE = 2,c.Gamepad.PS3XC_TRIANGLE = 3,c.Gamepad.PS3XC_L1 = 4,c.Gamepad.PS3XC_R1 = 5,c.Gamepad.PS3XC_L2 = 6,c.Gamepad.PS3XC_R2 = 7,c.Gamepad.PS3XC_SELECT = 8,c.Gamepad.PS3XC_START = 9,c.Gamepad.PS3XC_STICK_LEFT_BUTTON = 10,c.Gamepad.PS3XC_STICK_RIGHT_BUTTON = 11,c.Gamepad.PS3XC_DPAD_UP = 12,c.Gamepad.PS3XC_DPAD_DOWN = 13,c.Gamepad.PS3XC_DPAD_LEFT = 14,c.Gamepad.PS3XC_DPAD_RIGHT = 15,c.Gamepad.PS3XC_STICK_LEFT_X = 0,c.Gamepad.PS3XC_STICK_LEFT_Y = 1,c.Gamepad.PS3XC_STICK_RIGHT_X = 2,c.Gamepad.PS3XC_STICK_RIGHT_Y = 3,c.SinglePad = function (a, b) {
        this.game = a, this.index = null, this.connected = !1, this.callbackContext = this, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null, this.deadZone = .26, this._padParent = b, this._rawPad = null, this._prevTimestamp = null, this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0
    },c.SinglePad.prototype = {
        addCallbacks: function (a, b) {
            "undefined" != typeof b && (this.onConnectCallback = "function" == typeof b.onConnect ? b.onConnect : this.onConnectCallback, this.onDisconnectCallback = "function" == typeof b.onDisconnect ? b.onDisconnect : this.onDisconnectCallback, this.onDownCallback = "function" == typeof b.onDown ? b.onDown : this.onDownCallback, this.onUpCallback = "function" == typeof b.onUp ? b.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof b.onAxis ? b.onAxis : this.onAxisCallback, this.onFloatCallback = "function" == typeof b.onFloat ? b.onFloat : this.onFloatCallback, this.callbackContext = a)
        }, getButton: function (a) {
            return this._buttons[a] ? this._buttons[a] : null
        }, pollStatus: function () {
            if (this.connected && this.game.input.enabled && this.game.input.gamepad.enabled && (!this._rawPad.timestamp || this._rawPad.timestamp !== this._prevTimestamp)) {
                for (var a = 0; a < this._buttonsLen; a++) {
                    var b = isNaN(this._rawPad.buttons[a]) ? this._rawPad.buttons[a].value : this._rawPad.buttons[a];
                    b !== this._buttons[a].value && (1 === b ? this.processButtonDown(a, b) : 0 === b ? this.processButtonUp(a, b) : this.processButtonFloat(a, b))
                }
                for (var c = 0; c < this._axesLen; c++) {
                    var d = this._rawPad.axes[c];
                    d > 0 && d > this.deadZone || 0 > d && d < -this.deadZone ? this.processAxisChange(c, d) : this.processAxisChange(c, 0)
                }
                this._prevTimestamp = this._rawPad.timestamp
            }
        }, connect: function (a) {
            var b = !this.connected;
            this.connected = !0, this.index = a.index, this._rawPad = a, this._buttons = [], this._buttonsLen = a.buttons.length, this._axes = [], this._axesLen = a.axes.length;
            for (var d = 0; d < this._axesLen; d++)this._axes[d] = a.axes[d];
            for (var e in a.buttons)e = parseInt(e, 10), this._buttons[e] = new c.DeviceButton(this, e);
            b && this._padParent.onConnectCallback && this._padParent.onConnectCallback.call(this._padParent.callbackContext, this.index), b && this.onConnectCallback && this.onConnectCallback.call(this.callbackContext)
        }, disconnect: function () {
            var a = this.connected, b = this.index;
            this.connected = !1, this.index = null, this._rawPad = void 0;
            for (var c = 0; c < this._buttonsLen; c++)this._buttons[c].destroy();
            this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, a && this._padParent.onDisconnectCallback && this._padParent.onDisconnectCallback.call(this._padParent.callbackContext, b), a && this.onDisconnectCallback && this.onDisconnectCallback.call(this.callbackContext)
        }, destroy: function () {
            this._rawPad = void 0;
            for (var a = 0; a < this._buttonsLen; a++)this._buttons[a].destroy();
            this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null
        }, processAxisChange: function (a, b) {
            this._axes[a] !== b && (this._axes[a] = b, this._padParent.onAxisCallback && this._padParent.onAxisCallback.call(this._padParent.callbackContext, this, a, b), this.onAxisCallback && this.onAxisCallback.call(this.callbackContext, this, a, b))
        }, processButtonDown: function (a, b) {
            this._buttons[a] && this._buttons[a].start(null, b), this._padParent.onDownCallback && this._padParent.onDownCallback.call(this._padParent.callbackContext, a, b, this.index), this.onDownCallback && this.onDownCallback.call(this.callbackContext, a, b)
        }, processButtonUp: function (a, b) {
            this._padParent.onUpCallback && this._padParent.onUpCallback.call(this._padParent.callbackContext, a, b, this.index), this.onUpCallback && this.onUpCallback.call(this.callbackContext, a, b), this._buttons[a] && this._buttons[a].stop(null, b)
        }, processButtonFloat: function (a, b) {
            this._padParent.onFloatCallback && this._padParent.onFloatCallback.call(this._padParent.callbackContext, a, b, this.index), this.onFloatCallback && this.onFloatCallback.call(this.callbackContext, a, b), this._buttons[a] && this._buttons[a].padFloat(b)
        }, axis: function (a) {
            return this._axes[a] ? this._axes[a] : !1
        }, isDown: function (a) {
            return this._buttons[a] ? this._buttons[a].isDown : !1
        }, isUp: function (a) {
            return this._buttons[a] ? this._buttons[a].isUp : !1
        }, justReleased: function (a, b) {
            return this._buttons[a] ? this._buttons[a].justReleased(b) : void 0
        }, justPressed: function (a, b) {
            return this._buttons[a] ? this._buttons[a].justPressed(b) : void 0
        }, buttonValue: function (a) {
            return this._buttons[a] ? this._buttons[a].value : null
        }, reset: function () {
            for (var a = 0; a < this._axes.length; a++)this._axes[a] = 0
        }
    },c.SinglePad.prototype.constructor = c.SinglePad,c.Key = function (a, b) {
        this.game = a, this._enabled = !0, this.event = null, this.isDown = !1, this.isUp = !0, this.altKey = !1, this.ctrlKey = !1, this.shiftKey = !1, this.timeDown = 0, this.duration = 0, this.timeUp = -2500, this.repeats = 0, this.keyCode = b, this.onDown = new c.Signal, this.onHoldCallback = null, this.onHoldContext = null, this.onUp = new c.Signal, this._justDown = !1, this._justUp = !1
    },c.Key.prototype = {
        update: function () {
            this._enabled && this.isDown && (this.duration = this.game.time.time - this.timeDown, this.repeats++, this.onHoldCallback && this.onHoldCallback.call(this.onHoldContext, this))
        }, processKeyDown: function (a) {
            this._enabled && (this.event = a, this.isDown || (this.altKey = a.altKey, this.ctrlKey = a.ctrlKey, this.shiftKey = a.shiftKey, this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, this.duration = 0, this.repeats = 0, this._justDown = !0, this.onDown.dispatch(this)))
        }, processKeyUp: function (a) {
            this._enabled && (this.event = a, this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.duration = this.game.time.time - this.timeDown, this._justUp = !0, this.onUp.dispatch(this)))
        }, reset: function (a) {
            void 0 === a && (a = !0), this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.duration = 0, this._enabled = !0, this._justDown = !1, this._justUp = !1, a && (this.onDown.removeAll(), this.onUp.removeAll(), this.onHoldCallback = null, this.onHoldContext = null)
        }, downDuration: function (a) {
            return void 0 === a && (a = 50), this.isDown && this.duration < a
        }, upDuration: function (a) {
            return void 0 === a && (a = 50), !this.isDown && this.game.time.time - this.timeUp < a
        }
    },Object.defineProperty(c.Key.prototype, "justDown", {
        get: function () {
            var a = this._justDown;
            return this._justDown = !1, a
        }
    }),Object.defineProperty(c.Key.prototype, "justUp", {
        get: function () {
            var a = this._justUp;
            return this._justUp = !1, a
        }
    }),Object.defineProperty(c.Key.prototype, "enabled", {
        get: function () {
            return this._enabled
        }, set: function (a) {
            a = !!a, a !== this._enabled && (a || this.reset(!1), this._enabled = a)
        }
    }),c.Key.prototype.constructor = c.Key,c.Keyboard = function (a) {
        this.game = a, this.enabled = !0, this.event = null, this.pressEvent = null, this.callbackContext = this, this.onDownCallback = null, this.onPressCallback = null, this.onUpCallback = null, this._keys = [], this._capture = [], this._onKeyDown = null, this._onKeyPress = null, this._onKeyUp = null, this._i = 0, this._k = 0
    },c.Keyboard.prototype = {
        addCallbacks: function (a, b, c, d) {
            this.callbackContext = a, void 0 !== b && null !== b && (this.onDownCallback = b), void 0 !== c && null !== c && (this.onUpCallback = c), void 0 !== d && null !== d && (this.onPressCallback = d)
        }, addKey: function (a) {
            return this._keys[a] || (this._keys[a] = new c.Key(this.game, a), this.addKeyCapture(a)), this._keys[a]
        }, addKeys: function (a) {
            var b = {};
            for (var c in a)b[c] = this.addKey(a[c]);
            return b
        }, removeKey: function (a) {
            this._keys[a] && (this._keys[a] = null, this.removeKeyCapture(a))
        }, createCursorKeys: function () {
            return this.addKeys({up: c.KeyCode.UP, down: c.KeyCode.DOWN, left: c.KeyCode.LEFT, right: c.KeyCode.RIGHT})
        }, start: function () {
            if (!this.game.device.cocoonJS && null === this._onKeyDown) {
                var a = this;
                this._onKeyDown = function (b) {
                    return a.processKeyDown(b)
                }, this._onKeyUp = function (b) {
                    return a.processKeyUp(b)
                }, this._onKeyPress = function (b) {
                    return a.processKeyPress(b)
                }, window.addEventListener("keydown", this._onKeyDown, !1), window.addEventListener("keyup", this._onKeyUp, !1), window.addEventListener("keypress", this._onKeyPress, !1)
            }
        }, stop: function () {
            window.removeEventListener("keydown", this._onKeyDown), window.removeEventListener("keyup", this._onKeyUp), window.removeEventListener("keypress", this._onKeyPress), this._onKeyDown = null, this._onKeyUp = null, this._onKeyPress = null
        }, destroy: function () {
            this.stop(), this.clearCaptures(), this._keys.length = 0, this._i = 0
        }, addKeyCapture: function (a) {
            if ("object" == typeof a)for (var b in a)this._capture[a[b]] = !0; else this._capture[a] = !0
        }, removeKeyCapture: function (a) {
            delete this._capture[a]
        }, clearCaptures: function () {
            this._capture = {}
        }, update: function () {
            for (this._i = this._keys.length; this._i--;)this._keys[this._i] && this._keys[this._i].update()
        }, processKeyDown: function (a) {
            if (this.event = a, this.game.input.enabled && this.enabled) {
                var b = a.keyCode;
                this._capture[b] && a.preventDefault(), this._keys[b] || (this._keys[b] = new c.Key(this.game, b)), this._keys[b].processKeyDown(a), this._k = b, this.onDownCallback && this.onDownCallback.call(this.callbackContext, a)
            }
        }, processKeyPress: function (a) {
            this.pressEvent = a, this.game.input.enabled && this.enabled && this.onPressCallback && this.onPressCallback.call(this.callbackContext, String.fromCharCode(a.charCode), a)
        }, processKeyUp: function (a) {
            if (this.event = a, this.game.input.enabled && this.enabled) {
                var b = a.keyCode;
                this._capture[b] && a.preventDefault(), this._keys[b] || (this._keys[b] = new c.Key(this.game, b)), this._keys[b].processKeyUp(a), this.onUpCallback && this.onUpCallback.call(this.callbackContext, a)
            }
        }, reset: function (a) {
            void 0 === a && (a = !0), this.event = null;
            for (var b = this._keys.length; b--;)this._keys[b] && this._keys[b].reset(a)
        }, downDuration: function (a, b) {
            return this._keys[a] ? this._keys[a].downDuration(b) : null
        }, upDuration: function (a, b) {
            return this._keys[a] ? this._keys[a].upDuration(b) : null
        }, isDown: function (a) {
            return this._keys[a] ? this._keys[a].isDown : null
        }
    },Object.defineProperty(c.Keyboard.prototype, "lastChar", {
        get: function () {
            return 32 === this.event.charCode ? "" : String.fromCharCode(this.pressEvent.charCode)
        }
    }),Object.defineProperty(c.Keyboard.prototype, "lastKey", {
        get: function () {
            return this._keys[this._k]
        }
    }),c.Keyboard.prototype.constructor = c.Keyboard,c.KeyCode = {
        A: "A".charCodeAt(0),
        B: "B".charCodeAt(0),
        C: "C".charCodeAt(0),
        D: "D".charCodeAt(0),
        E: "E".charCodeAt(0),
        F: "F".charCodeAt(0),
        G: "G".charCodeAt(0),
        H: "H".charCodeAt(0),
        I: "I".charCodeAt(0),
        J: "J".charCodeAt(0),
        K: "K".charCodeAt(0),
        L: "L".charCodeAt(0),
        M: "M".charCodeAt(0),
        N: "N".charCodeAt(0),
        O: "O".charCodeAt(0),
        P: "P".charCodeAt(0),
        Q: "Q".charCodeAt(0),
        R: "R".charCodeAt(0),
        S: "S".charCodeAt(0),
        T: "T".charCodeAt(0),
        U: "U".charCodeAt(0),
        V: "V".charCodeAt(0),
        W: "W".charCodeAt(0),
        X: "X".charCodeAt(0),
        Y: "Y".charCodeAt(0),
        Z: "Z".charCodeAt(0),
        ZERO: "0".charCodeAt(0),
        ONE: "1".charCodeAt(0),
        TWO: "2".charCodeAt(0),
        THREE: "3".charCodeAt(0),
        FOUR: "4".charCodeAt(0),
        FIVE: "5".charCodeAt(0),
        SIX: "6".charCodeAt(0),
        SEVEN: "7".charCodeAt(0),
        EIGHT: "8".charCodeAt(0),
        NINE: "9".charCodeAt(0),
        NUMPAD_0: 96,
        NUMPAD_1: 97,
        NUMPAD_2: 98,
        NUMPAD_3: 99,
        NUMPAD_4: 100,
        NUMPAD_5: 101,
        NUMPAD_6: 102,
        NUMPAD_7: 103,
        NUMPAD_8: 104,
        NUMPAD_9: 105,
        NUMPAD_MULTIPLY: 106,
        NUMPAD_ADD: 107,
        NUMPAD_ENTER: 108,
        NUMPAD_SUBTRACT: 109,
        NUMPAD_DECIMAL: 110,
        NUMPAD_DIVIDE: 111,
        F1: 112,
        F2: 113,
        F3: 114,
        F4: 115,
        F5: 116,
        F6: 117,
        F7: 118,
        F8: 119,
        F9: 120,
        F10: 121,
        F11: 122,
        F12: 123,
        F13: 124,
        F14: 125,
        F15: 126,
        COLON: 186,
        EQUALS: 187,
        COMMA: 188,
        UNDERSCORE: 189,
        PERIOD: 190,
        QUESTION_MARK: 191,
        TILDE: 192,
        OPEN_BRACKET: 219,
        BACKWARD_SLASH: 220,
        CLOSED_BRACKET: 221,
        QUOTES: 222,
        BACKSPACE: 8,
        TAB: 9,
        CLEAR: 12,
        ENTER: 13,
        SHIFT: 16,
        CONTROL: 17,
        ALT: 18,
        CAPS_LOCK: 20,
        ESC: 27,
        SPACEBAR: 32,
        PAGE_UP: 33,
        PAGE_DOWN: 34,
        END: 35,
        HOME: 36,
        LEFT: 37,
        UP: 38,
        RIGHT: 39,
        DOWN: 40,
        PLUS: 43,
        MINUS: 44,
        INSERT: 45,
        DELETE: 46,
        HELP: 47,
        NUM_LOCK: 144
    };
    for (var e in c.KeyCode)c.KeyCode.hasOwnProperty(e) && !e.match(/[a-z]/) && (c.Keyboard[e] = c.KeyCode[e]);
    c.Component = function () {
    }, c.Component.Angle = function () {
    }, c.Component.Angle.prototype = {
        angle: {
            get: function () {
                return c.Math.wrapAngle(c.Math.radToDeg(this.rotation))
            }, set: function (a) {
                this.rotation = c.Math.degToRad(c.Math.wrapAngle(a))
            }
        }
    }, c.Component.Animation = function () {
    }, c.Component.Animation.prototype = {
        play: function (a, b, c, d) {
            return this.animations ? this.animations.play(a, b, c, d) : void 0
        }
    }, c.Component.AutoCull = function () {
    }, c.Component.AutoCull.prototype = {
        autoCull: !1, inCamera: {
            get: function () {
                return this.autoCull || this.checkWorldBounds || (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y), this.game.world.camera.view.intersects(this._bounds)
            }
        }
    }, c.Component.Bounds = function () {
    }, c.Component.Bounds.prototype = {
        offsetX: {
            get: function () {
                return this.anchor.x * this.width
            }
        }, offsetY: {
            get: function () {
                return this.anchor.y * this.height
            }
        }, centerX: {
            get: function () {
                return this.x - this.offsetX + .5 * this.width
            }, set: function (a) {
                this.x = a + this.offsetX - .5 * this.width
            }
        }, centerY: {
            get: function () {
                return this.y - this.offsetY + .5 * this.height
            }, set: function (a) {
                this.y = a + this.offsetY - .5 * this.height
            }
        }, left: {
            get: function () {
                return this.x - this.offsetX
            }, set: function (a) {
                this.x = a + this.offsetX
            }
        }, right: {
            get: function () {
                return this.x + this.width - this.offsetX
            }, set: function (a) {
                this.x = a - this.width + this.offsetX
            }
        }, top: {
            get: function () {
                return this.y - this.offsetY
            }, set: function (a) {
                this.y = a + this.offsetY
            }
        }, bottom: {
            get: function () {
                return this.y + this.height - this.offsetY
            }, set: function (a) {
                this.y = a - this.height + this.offsetY
            }
        }, alignIn: function (a, b, d, e) {
            switch (void 0 === d && (d = 0), void 0 === e && (e = 0), b) {
                default:
                case c.TOP_LEFT:
                    this.left = a.left - d, this.top = a.top - e;
                    break;
                case c.TOP_CENTER:
                    this.centerX = a.centerX + d, this.top = a.top - e;
                    break;
                case c.TOP_RIGHT:
                    this.right = a.right + d, this.top = a.top - e;
                    break;
                case c.LEFT_CENTER:
                    this.left = a.left - d, this.centerY = a.centerY + e;
                    break;
                case c.CENTER:
                    this.centerX = a.centerX + d, this.centerY = a.centerY + e;
                    break;
                case c.RIGHT_CENTER:
                    this.right = a.right + d, this.centerY = a.centerY + e;
                    break;
                case c.BOTTOM_LEFT:
                    this.left = a.left - d, this.bottom = a.bottom + e;
                    break;
                case c.BOTTOM_CENTER:
                    this.centerX = a.centerX + d, this.bottom = a.bottom + e;
                    break;
                case c.BOTTOM_RIGHT:
                    this.right = a.right + d, this.bottom = a.bottom + e
            }
            return this
        }, alignTo: function (a, b, d, e) {
            switch (void 0 === d && (d = 0), void 0 === e && (e = 0), b) {
                default:
                case c.TOP_LEFT:
                    this.left = a.left - d, this.bottom = a.top - e;
                    break;
                case c.TOP_CENTER:
                    this.centerX = a.centerX + d, this.bottom = a.top - e;
                    break;
                case c.TOP_RIGHT:
                    this.right = a.right + d, this.bottom = a.top - e;
                    break;
                case c.LEFT_TOP:
                    this.right = a.left - d, this.top = a.top - e;
                    break;
                case c.LEFT_CENTER:
                    this.right = a.left - d, this.centerY = a.centerY + e;
                    break;
                case c.LEFT_BOTTOM:
                    this.right = a.left - d, this.bottom = a.bottom + e;
                    break;
                case c.RIGHT_TOP:
                    this.left = a.right + d, this.top = a.top - e;
                    break;
                case c.RIGHT_CENTER:
                    this.left = a.right + d, this.centerY = a.centerY + e;
                    break;
                case c.RIGHT_BOTTOM:
                    this.left = a.right + d, this.bottom = a.bottom + e;
                    break;
                case c.BOTTOM_LEFT:
                    this.left = a.left - d, this.top = a.bottom + e;
                    break;
                case c.BOTTOM_CENTER:
                    this.centerX = a.centerX + d, this.top = a.bottom + e;
                    break;
                case c.BOTTOM_RIGHT:
                    this.right = a.right + d, this.top = a.bottom + e
            }
            return this
        }
    }, c.Group.prototype.alignIn = c.Component.Bounds.prototype.alignIn, c.Group.prototype.alignTo = c.Component.Bounds.prototype.alignTo, c.Component.BringToTop = function () {
    }, c.Component.BringToTop.prototype.bringToTop = function () {
        return this.parent && this.parent.bringToTop(this), this
    }, c.Component.BringToTop.prototype.sendToBack = function () {
        return this.parent && this.parent.sendToBack(this), this
    }, c.Component.BringToTop.prototype.moveUp = function () {
        return this.parent && this.parent.moveUp(this), this
    }, c.Component.BringToTop.prototype.moveDown = function () {
        return this.parent && this.parent.moveDown(this), this
    }, c.Component.Core = function () {
    }, c.Component.Core.install = function (a) {
        c.Utils.mixinPrototype(this, c.Component.Core.prototype), this.components = {};
        for (var b = 0; b < a.length; b++) {
            var d = a[b], e = !1;
            "Destroy" === d && (e = !0), c.Utils.mixinPrototype(this, c.Component[d].prototype, e), this.components[d] = !0
        }
    }, c.Component.Core.init = function (a, b, d, e, f) {
        this.game = a, this.key = e, this.data = {}, this.position.set(b, d), this.world = new c.Point(b, d), this.previousPosition = new c.Point(b, d), this.events = new c.Events(this), this._bounds = new c.Rectangle, this.components.PhysicsBody && (this.body = this.body), this.components.Animation && (this.animations = new c.AnimationManager(this)), this.components.LoadTexture && null !== e && this.loadTexture(e, f), this.components.FixedToCamera && (this.cameraOffset = new c.Point(b, d))
    }, c.Component.Core.preUpdate = function () {
        if (this.pendingDestroy)return void this.destroy();
        if (this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, !this.exists || !this.parent.exists)return this.renderOrderID = -1, !1;
        this.world.setTo(this.game.camera.x + this.worldTransform.tx, this.game.camera.y + this.worldTransform.ty), this.visible && (this.renderOrderID = this.game.stage.currentRenderOrderID++), this.animations && this.animations.update(), this.body && this.body.preUpdate();
        for (var a = 0; a < this.children.length; a++)this.children[a].preUpdate();
        return !0
    }, c.Component.Core.prototype = {
        game: null,
        name: "",
        data: {},
        components: {},
        z: 0,
        events: void 0,
        animations: void 0,
        key: "",
        world: null,
        debug: !1,
        previousPosition: null,
        previousRotation: 0,
        renderOrderID: 0,
        fresh: !0,
        pendingDestroy: !1,
        _bounds: null,
        _exists: !0,
        exists: {
            get: function () {
                return this._exists
            }, set: function (a) {
                a ? (this._exists = !0, this.body && this.body.type === c.Physics.P2JS && this.body.addToWorld(), this.visible = !0) : (this._exists = !1, this.body && this.body.type === c.Physics.P2JS && this.body.removeFromWorld(), this.visible = !1)
            }
        },
        update: function () {
        },
        postUpdate: function () {
            this.customRender && this.key.render(), this.components.PhysicsBody && c.Component.PhysicsBody.postUpdate.call(this), this.components.FixedToCamera && c.Component.FixedToCamera.postUpdate.call(this);
            for (var a = 0; a < this.children.length; a++)this.children[a].postUpdate()
        }
    }, c.Component.Crop = function () {
    }, c.Component.Crop.prototype = {
        cropRect: null, _crop: null, crop: function (a, b) {
            void 0 === b && (b = !1), a ? (b && null !== this.cropRect ? this.cropRect.setTo(a.x, a.y, a.width, a.height) : b && null === this.cropRect ? this.cropRect = new c.Rectangle(a.x, a.y, a.width, a.height) : this.cropRect = a, this.updateCrop()) : (this._crop = null, this.cropRect = null, this.resetFrame())
        }, updateCrop: function () {
            if (this.cropRect) {
                this._crop = c.Rectangle.clone(this.cropRect, this._crop), this._crop.x += this._frame.x, this._crop.y += this._frame.y;
                var a = Math.max(this._frame.x, this._crop.x), b = Math.max(this._frame.y, this._crop.y), d = Math.min(this._frame.right, this._crop.right) - a, e = Math.min(this._frame.bottom, this._crop.bottom) - b;
                this.texture.crop.x = a, this.texture.crop.y = b, this.texture.crop.width = d, this.texture.crop.height = e, this.texture.frame.width = Math.min(d, this.cropRect.width), this.texture.frame.height = Math.min(e, this.cropRect.height), this.texture.width = this.texture.frame.width, this.texture.height = this.texture.frame.height, this.texture._updateUvs()
            }
        }
    }, c.Component.Delta = function () {
    }, c.Component.Delta.prototype = {
        deltaX: {
            get: function () {
                return this.world.x - this.previousPosition.x
            }
        }, deltaY: {
            get: function () {
                return this.world.y - this.previousPosition.y
            }
        }, deltaZ: {
            get: function () {
                return this.rotation - this.previousRotation
            }
        }
    }, c.Component.Destroy = function () {
    }, c.Component.Destroy.prototype = {
        destroyPhase: !1, destroy: function (a, b) {
            if (null !== this.game && !this.destroyPhase) {
                void 0 === a && (a = !0), void 0 === b && (b = !1), this.destroyPhase = !0, this.events && this.events.onDestroy$dispatch(this), this.parent && (this.parent instanceof c.Group ? this.parent.remove(this) : this.parent.removeChild(this)), this.input && this.input.destroy(), this.animations && this.animations.destroy(), this.body && this.body.destroy(), this.events && this.events.destroy(), this.game.tweens.removeFrom(this);
                var d = this.children.length;
                if (a)for (; d--;)this.children[d].destroy(a); else for (; d--;)this.removeChild(this.children[d]);
                this._crop && (this._crop = null), this._frame && (this._frame = null), c.Video && this.key instanceof c.Video && this.key.onChangeSource.remove(this.resizeFrame, this), c.BitmapText && this._glyphs && (this._glyphs = []), this.alive = !1, this.exists = !1, this.visible = !1, this.filters = null, this.mask = null, this.game = null, this.data = {}, this.renderable = !1, this.transformCallback && (this.transformCallback = null, this.transformCallbackContext = null), this.hitArea = null, this.parent = null, this.stage = null, this.worldTransform = null, this.filterArea = null, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite(), b && this.texture.destroy(!0), this.destroyPhase = !1, this.pendingDestroy = !1
            }
        }
    }, c.Events = function (a) {
        this.parent = a
    }, c.Events.prototype = {
        destroy: function () {
            this._parent = null, this._onDestroy && this._onDestroy.dispose(), this._onAddedToGroup && this._onAddedToGroup.dispose(), this._onRemovedFromGroup && this._onRemovedFromGroup.dispose(), this._onRemovedFromWorld && this._onRemovedFromWorld.dispose(), this._onKilled && this._onKilled.dispose(), this._onRevived && this._onRevived.dispose(), this._onEnterBounds && this._onEnterBounds.dispose(), this._onOutOfBounds && this._onOutOfBounds.dispose(), this._onInputOver && this._onInputOver.dispose(), this._onInputOut && this._onInputOut.dispose(), this._onInputDown && this._onInputDown.dispose(), this._onInputUp && this._onInputUp.dispose(), this._onDragStart && this._onDragStart.dispose(), this._onDragUpdate && this._onDragUpdate.dispose(), this._onDragStop && this._onDragStop.dispose(), this._onAnimationStart && this._onAnimationStart.dispose(), this._onAnimationComplete && this._onAnimationComplete.dispose(), this._onAnimationLoop && this._onAnimationLoop.dispose()
        },
        onAddedToGroup: null,
        onRemovedFromGroup: null,
        onRemovedFromWorld: null,
        onDestroy: null,
        onKilled: null,
        onRevived: null,
        onOutOfBounds: null,
        onEnterBounds: null,
        onInputOver: null,
        onInputOut: null,
        onInputDown: null,
        onInputUp: null,
        onDragStart: null,
        onDragUpdate: null,
        onDragStop: null,
        onAnimationStart: null,
        onAnimationComplete: null,
        onAnimationLoop: null
    }, c.Events.prototype.constructor = c.Events;
    for (var f in c.Events.prototype)c.Events.prototype.hasOwnProperty(f) && 0 === f.indexOf("on") && null === c.Events.prototype[f] && !function (a, b) {
        "use strict";
        Object.defineProperty(c.Events.prototype, a, {
            get: function () {
                return this[b] || (this[b] = new c.Signal)
            }
        }), c.Events.prototype[a + "$dispatch"] = function () {
            return this[b] ? this[b].dispatch.apply(this[b], arguments) : null
        }
    }(f, "_" + f);
    c.Component.FixedToCamera = function () {
    }, c.Component.FixedToCamera.postUpdate = function () {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y)
    }, c.Component.FixedToCamera.prototype = {
        _fixedToCamera: !1, fixedToCamera: {
            get: function () {
                return this._fixedToCamera
            }, set: function (a) {
                a ? (this._fixedToCamera = !0, this.cameraOffset.set(this.x, this.y)) : this._fixedToCamera = !1
            }
        }, cameraOffset: new c.Point
    }, c.Component.Health = function () {
    }, c.Component.Health.prototype = {
        health: 1, maxHealth: 100, damage: function (a) {
            return this.alive && (this.health -= a, this.health <= 0 && this.kill()), this
        }, setHealth: function (a) {
            return this.health = a, this.health > this.maxHealth && (this.health = this.maxHealth), this
        }, heal: function (a) {
            return this.alive && (this.health += a, this.health > this.maxHealth && (this.health = this.maxHealth)), this
        }
    }, c.Component.InCamera = function () {
    }, c.Component.InCamera.prototype = {
        inCamera: {
            get: function () {
                return this.game.world.camera.view.intersects(this._bounds)
            }
        }
    }, c.Component.InputEnabled = function () {
    }, c.Component.InputEnabled.prototype = {
        input: null, inputEnabled: {
            get: function () {
                return this.input && this.input.enabled
            }, set: function (a) {
                a ? null === this.input ? (this.input = new c.InputHandler(this), this.input.start()) : this.input && !this.input.enabled && this.input.start() : this.input && this.input.enabled && this.input.stop()
            }
        }
    }, c.Component.InWorld = function () {
    }, c.Component.InWorld.preUpdate = function () {
        if (this.autoCull || this.checkWorldBounds) {
            if (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y, this.autoCull)if (this.game.world.camera.view.intersects(this._bounds))this.renderable = !0, this.game.world.camera.totalInView++; else if (this.renderable = !1, this.outOfCameraBoundsKill)return this.kill(), !1;
            if (this.checkWorldBounds)if (this._outOfBoundsFired && this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired = !1, this.events.onEnterBounds$dispatch(this); else if (!this._outOfBoundsFired && !this.game.world.bounds.intersects(this._bounds) && (this._outOfBoundsFired = !0, this.events.onOutOfBounds$dispatch(this), this.outOfBoundsKill))return this.kill(), !1
        }
        return !0
    }, c.Component.InWorld.prototype = {
        checkWorldBounds: !1,
        outOfBoundsKill: !1,
        outOfCameraBoundsKill: !1,
        _outOfBoundsFired: !1,
        inWorld: {
            get: function () {
                return this.game.world.bounds.intersects(this.getBounds())
            }
        }
    }, c.Component.LifeSpan = function () {
    }, c.Component.LifeSpan.preUpdate = function () {
        return this.lifespan > 0 && (this.lifespan -= this.game.time.physicsElapsedMS, this.lifespan <= 0) ? (this.kill(), !1) : !0
    }, c.Component.LifeSpan.prototype = {
        alive: !0, lifespan: 0, revive: function (a) {
            return void 0 === a && (a = 100), this.alive = !0, this.exists = !0, this.visible = !0, "function" == typeof this.setHealth && this.setHealth(a), this.events && this.events.onRevived$dispatch(this), this
        }, kill: function () {
            return this.alive = !1, this.exists = !1, this.visible = !1, this.events && this.events.onKilled$dispatch(this), this
        }
    }, c.Component.LoadTexture = function () {
    }, c.Component.LoadTexture.prototype = {
        customRender: !1, _frame: null, loadTexture: function (a, b, d) {
            a === c.PENDING_ATLAS ? (a = b, b = 0) : b = b || 0, (d || void 0 === d) && this.animations && this.animations.stop(), this.key = a, this.customRender = !1;
            var e = this.game.cache, f = !0, g = !this.texture.baseTexture.scaleMode;
            if (c.RenderTexture && a instanceof c.RenderTexture)this.key = a.key, this.setTexture(a); else if (c.BitmapData && a instanceof c.BitmapData)this.customRender = !0, this.setTexture(a.texture), f = e.hasFrameData(a.key, c.Cache.BITMAPDATA) ? !this.animations.loadFrameData(e.getFrameData(a.key, c.Cache.BITMAPDATA), b) : !this.animations.loadFrameData(a.frameData, 0); else if (c.Video && a instanceof c.Video) {
                this.customRender = !0;
                var h = a.texture.valid;
                this.setTexture(a.texture), this.setFrame(a.texture.frame.clone()), a.onChangeSource.add(this.resizeFrame, this), this.texture.valid = h
            } else if (c.Tilemap && a instanceof c.TilemapLayer)this.setTexture(PIXI.Texture.fromCanvas(a.canvas)); else if (a instanceof PIXI.Texture)this.setTexture(a); else {
                var i = e.getImage(a, !0);
                this.key = i.key, this.setTexture(new PIXI.Texture(i.base)), "__default" === a ? this.texture.baseTexture.skipRender = !0 : this.texture.baseTexture.skipRender = !1, f = !this.animations.loadFrameData(i.frameData, b)
            }
            f && (this._frame = c.Rectangle.clone(this.texture.frame)), g || (this.texture.baseTexture.scaleMode = 1)
        }, setFrame: function (a) {
            this._frame = a, this.texture.frame.x = a.x, this.texture.frame.y = a.y, this.texture.frame.width = a.width, this.texture.frame.height = a.height, this.texture.crop.x = a.x, this.texture.crop.y = a.y, this.texture.crop.width = a.width, this.texture.crop.height = a.height, a.trimmed ? (this.texture.trim ? (this.texture.trim.x = a.spriteSourceSizeX, this.texture.trim.y = a.spriteSourceSizeY, this.texture.trim.width = a.sourceSizeW, this.texture.trim.height = a.sourceSizeH) : this.texture.trim = {
                x: a.spriteSourceSizeX,
                y: a.spriteSourceSizeY,
                width: a.sourceSizeW,
                height: a.sourceSizeH
            }, this.texture.width = a.sourceSizeW, this.texture.height = a.sourceSizeH, this.texture.frame.width = a.sourceSizeW, this.texture.frame.height = a.sourceSizeH) : !a.trimmed && this.texture.trim && (this.texture.trim = null), this.cropRect && this.updateCrop(), this.texture.requiresReTint = !0, this.texture._updateUvs(), this.tilingTexture && (this.refreshTexture = !0)
        }, resizeFrame: function (a, b, c) {
            this.texture.frame.resize(b, c), this.texture.setFrame(this.texture.frame)
        }, resetFrame: function () {
            this._frame && this.setFrame(this._frame)
        }, frame: {
            get: function () {
                return this.animations.frame
            }, set: function (a) {
                this.animations.frame = a
            }
        }, frameName: {
            get: function () {
                return this.animations.frameName
            }, set: function (a) {
                this.animations.frameName = a
            }
        }
    }, c.Component.Overlap = function () {
    }, c.Component.Overlap.prototype = {
        overlap: function (a) {
            return c.Rectangle.intersects(this.getBounds(), a.getBounds())
        }
    }, c.Component.PhysicsBody = function () {
    }, c.Component.PhysicsBody.preUpdate = function () {
        return this.fresh && this.exists ? (this.world.setTo(this.parent.position.x + this.position.x, this.parent.position.y + this.position.y), this.worldTransform.tx = this.world.x, this.worldTransform.ty = this.world.y, this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, this.body && this.body.preUpdate(), this.fresh = !1, !1) : (this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, this._exists && this.parent.exists ? !0 : (this.renderOrderID = -1, !1))
    }, c.Component.PhysicsBody.postUpdate = function () {
        this.exists && this.body && this.body.postUpdate()
    }, c.Component.PhysicsBody.prototype = {
        body: null, x: {
            get: function () {
                return this.position.x
            }, set: function (a) {
                this.position.x = a, this.body && !this.body.dirty && (this.body._reset = !0)
            }
        }, y: {
            get: function () {
                return this.position.y
            }, set: function (a) {
                this.position.y = a, this.body && !this.body.dirty && (this.body._reset = !0)
            }
        }
    }, c.Component.Reset = function () {
    }, c.Component.Reset.prototype.reset = function (a, b, c) {
        return void 0 === c && (c = 1), this.world.set(a, b), this.position.set(a, b), this.fresh = !0, this.exists = !0, this.visible = !0, this.renderable = !0, this.components.InWorld && (this._outOfBoundsFired = !1), this.components.LifeSpan && (this.alive = !0, this.health = c), this.components.PhysicsBody && this.body && this.body.reset(a, b, !1, !1), this
    }, c.Component.ScaleMinMax = function () {
    }, c.Component.ScaleMinMax.prototype = {
        transformCallback: null,
        transformCallbackContext: this,
        scaleMin: null,
        scaleMax: null,
        checkTransform: function (a) {
            this.scaleMin && (a.a < this.scaleMin.x && (a.a = this.scaleMin.x), a.d < this.scaleMin.y && (a.d = this.scaleMin.y)), this.scaleMax && (a.a > this.scaleMax.x && (a.a = this.scaleMax.x), a.d > this.scaleMax.y && (a.d = this.scaleMax.y))
        },
        setScaleMinMax: function (a, b, d, e) {
            void 0 === b ? b = d = e = a : void 0 === d && (d = e = b, b = a), null === a ? this.scaleMin = null : this.scaleMin ? this.scaleMin.set(a, b) : this.scaleMin = new c.Point(a, b), null === d ? this.scaleMax = null : this.scaleMax ? this.scaleMax.set(d, e) : this.scaleMax = new c.Point(d, e), null === this.scaleMin ? this.transformCallback = null : (this.transformCallback = this.checkTransform, this.transformCallbackContext = this)
        }
    }, c.Component.Smoothed = function () {
    }, c.Component.Smoothed.prototype = {
        smoothed: {
            get: function () {
                return !this.texture.baseTexture.scaleMode
            }, set: function (a) {
                a ? this.texture && (this.texture.baseTexture.scaleMode = 0) : this.texture && (this.texture.baseTexture.scaleMode = 1)
            }
        }
    }, c.GameObjectFactory = function (a) {
        this.game = a, this.world = this.game.world
    }, c.GameObjectFactory.prototype = {
        existing: function (a) {
            return this.world.add(a)
        }, weapon: function (a, b, d, e) {
            var f = this.game.plugins.add(c.Weapon);
            return f.createBullets(a, b, d, e), f
        }, image: function (a, b, d, e, f) {
            return void 0 === f && (f = this.world), f.add(new c.Image(this.game, a, b, d, e))
        }, sprite: function (a, b, c, d, e) {
            return void 0 === e && (e = this.world), e.create(a, b, c, d)
        }, creature: function (a, b, d, e, f) {
            void 0 === f && (f = this.world);
            var g = new c.Creature(this.game, a, b, d, e);
            return f.add(g), g
        }, tween: function (a) {
            return this.game.tweens.create(a)
        }, group: function (a, b, d, e, f) {
            return new c.Group(this.game, a, b, d, e, f)
        }, physicsGroup: function (a, b, d, e) {
            return new c.Group(this.game, b, d, e, !0, a)
        }, spriteBatch: function (a, b, d) {
            return void 0 === a && (a = null), void 0 === b && (b = "group"), void 0 === d && (d = !1), new c.SpriteBatch(this.game, a, b, d)
        }, audio: function (a, b, c, d) {
            return this.game.sound.add(a, b, c, d)
        }, sound: function (a, b, c, d) {
            return this.game.sound.add(a, b, c, d)
        }, audioSprite: function (a) {
            return this.game.sound.addSprite(a)
        }, tileSprite: function (a, b, d, e, f, g, h) {
            return void 0 === h && (h = this.world), h.add(new c.TileSprite(this.game, a, b, d, e, f, g))
        }, rope: function (a, b, d, e, f, g) {
            return void 0 === g && (g = this.world), g.add(new c.Rope(this.game, a, b, d, e, f))
        }, text: function (a, b, d, e, f) {
            return void 0 === f && (f = this.world), f.add(new c.Text(this.game, a, b, d, e))
        }, button: function (a, b, d, e, f, g, h, i, j, k) {
            return void 0 === k && (k = this.world), k.add(new c.Button(this.game, a, b, d, e, f, g, h, i, j))
        }, graphics: function (a, b, d) {
            return void 0 === d && (d = this.world), d.add(new c.Graphics(this.game, a, b))
        }, emitter: function (a, b, d) {
            return this.game.particles.add(new c.Particles.Arcade.Emitter(this.game, a, b, d))
        }, retroFont: function (a, b, d, e, f, g, h, i, j) {
            return new c.RetroFont(this.game, a, b, d, e, f, g, h, i, j)
        }, bitmapText: function (a, b, d, e, f, g) {
            return void 0 === g && (g = this.world), g.add(new c.BitmapText(this.game, a, b, d, e, f))
        }, tilemap: function (a, b, d, e, f) {
            return new c.Tilemap(this.game, a, b, d, e, f)
        }, renderTexture: function (a, b, d, e) {
            (void 0 === d || "" === d) && (d = this.game.rnd.uuid()), void 0 === e && (e = !1);
            var f = new c.RenderTexture(this.game, a, b, d);
            return e && this.game.cache.addRenderTexture(d, f), f
        }, video: function (a, b) {
            return new c.Video(this.game, a, b)
        }, bitmapData: function (a, b, d, e) {
            void 0 === e && (e = !1), (void 0 === d || "" === d) && (d = this.game.rnd.uuid());
            var f = new c.BitmapData(this.game, d, a, b);
            return e && this.game.cache.addBitmapData(d, f), f
        }, filter: function (a) {
            var b = Array.prototype.slice.call(arguments, 1), a = new c.Filter[a](this.game);
            return a.init.apply(a, b), a
        }, plugin: function (a) {
            return this.game.plugins.add(a)
        }
    }, c.GameObjectFactory.prototype.constructor = c.GameObjectFactory, c.GameObjectCreator = function (a) {
        this.game = a, this.world = this.game.world
    }, c.GameObjectCreator.prototype = {
        image: function (a, b, d, e) {
            return new c.Image(this.game, a, b, d, e)
        }, sprite: function (a, b, d, e) {
            return new c.Sprite(this.game, a, b, d, e)
        }, tween: function (a) {
            return new c.Tween(a, this.game, this.game.tweens)
        }, group: function (a, b, d, e, f) {
            return new c.Group(this.game, a, b, d, e, f)
        }, spriteBatch: function (a, b, d) {
            return void 0 === b && (b = "group"), void 0 === d && (d = !1), new c.SpriteBatch(this.game, a, b, d)
        }, audio: function (a, b, c, d) {
            return this.game.sound.add(a, b, c, d)
        }, audioSprite: function (a) {
            return this.game.sound.addSprite(a)
        }, sound: function (a, b, c, d) {
            return this.game.sound.add(a, b, c, d)
        }, tileSprite: function (a, b, d, e, f, g) {
            return new c.TileSprite(this.game, a, b, d, e, f, g)
        }, rope: function (a, b, d, e, f) {
            return new c.Rope(this.game, a, b, d, e, f)
        }, text: function (a, b, d, e) {
            return new c.Text(this.game, a, b, d, e)
        }, button: function (a, b, d, e, f, g, h, i, j) {
            return new c.Button(this.game, a, b, d, e, f, g, h, i, j)
        }, graphics: function (a, b) {
            return new c.Graphics(this.game, a, b)
        }, emitter: function (a, b, d) {
            return new c.Particles.Arcade.Emitter(this.game, a, b, d)
        }, retroFont: function (a, b, d, e, f, g, h, i, j) {
            return new c.RetroFont(this.game, a, b, d, e, f, g, h, i, j)
        }, bitmapText: function (a, b, d, e, f, g) {
            return new c.BitmapText(this.game, a, b, d, e, f, g)
        }, tilemap: function (a, b, d, e, f) {
            return new c.Tilemap(this.game, a, b, d, e, f)
        }, renderTexture: function (a, b, d, e) {
            (void 0 === d || "" === d) && (d = this.game.rnd.uuid()), void 0 === e && (e = !1);
            var f = new c.RenderTexture(this.game, a, b, d);
            return e && this.game.cache.addRenderTexture(d, f), f
        }, bitmapData: function (a, b, d, e) {
            void 0 === e && (e = !1), (void 0 === d || "" === d) && (d = this.game.rnd.uuid());
            var f = new c.BitmapData(this.game, d, a, b);
            return e && this.game.cache.addBitmapData(d, f), f
        }, filter: function (a) {
            var b = Array.prototype.slice.call(arguments, 1), a = new c.Filter[a](this.game);
            return a.init.apply(a, b), a
        }
    }, c.GameObjectCreator.prototype.constructor = c.GameObjectCreator, c.Sprite = function (a, b, d, e, f) {
        b = b || 0, d = d || 0, e = e || null, f = f || null, this.type = c.SPRITE, this.physicsType = c.SPRITE, PIXI.Sprite.call(this, c.Cache.DEFAULT), c.Component.Core.init.call(this, a, b, d, e, f)
    }, c.Sprite.prototype = Object.create(PIXI.Sprite.prototype), c.Sprite.prototype.constructor = c.Sprite, c.Component.Core.install.call(c.Sprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]), c.Sprite.prototype.preUpdatePhysics = c.Component.PhysicsBody.preUpdate, c.Sprite.prototype.preUpdateLifeSpan = c.Component.LifeSpan.preUpdate, c.Sprite.prototype.preUpdateInWorld = c.Component.InWorld.preUpdate, c.Sprite.prototype.preUpdateCore = c.Component.Core.preUpdate, c.Sprite.prototype.preUpdate = function () {
        return this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld() ? this.preUpdateCore() : !1
    }, c.Image = function (a, b, d, e, f) {
        b = b || 0, d = d || 0, e = e || null, f = f || null, this.type = c.IMAGE, PIXI.Sprite.call(this, c.Cache.DEFAULT), c.Component.Core.init.call(this, a, b, d, e, f)
    }, c.Image.prototype = Object.create(PIXI.Sprite.prototype), c.Image.prototype.constructor = c.Image, c.Component.Core.install.call(c.Image.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Destroy", "FixedToCamera", "InputEnabled", "LifeSpan", "LoadTexture", "Overlap", "Reset", "Smoothed"]), c.Image.prototype.preUpdateInWorld = c.Component.InWorld.preUpdate, c.Image.prototype.preUpdateCore = c.Component.Core.preUpdate, c.Image.prototype.preUpdate = function () {
        return this.preUpdateInWorld() ? this.preUpdateCore() : !1
    }, c.Button = function (a, b, d, e, f, g, h, i, j, k) {
        b = b || 0, d = d || 0, e = e || null, f = f || null, g = g || this, c.Image.call(this, a, b, d, e, i), this.type = c.BUTTON, this.physicsType = c.SPRITE, this._onOverFrame = null, this._onOutFrame = null, this._onDownFrame = null, this._onUpFrame = null, this.onOverSound = null, this.onOutSound = null, this.onDownSound = null, this.onUpSound = null, this.onOverSoundMarker = "", this.onOutSoundMarker = "", this.onDownSoundMarker = "", this.onUpSoundMarker = "", this.onInputOver = new c.Signal, this.onInputOut = new c.Signal, this.onInputDown = new c.Signal, this.onInputUp = new c.Signal, this.onOverMouseOnly = !0, this.justReleasedPreventsOver = c.PointerMode.TOUCH, this.freezeFrames = !1, this.forceOut = !1, this.inputEnabled = !0, this.input.start(0, !0), this.input.useHandCursor = !0, this.setFrames(h, i, j, k), null !== f && this.onInputUp.add(f, g), this.events.onInputOver.add(this.onInputOverHandler, this), this.events.onInputOut.add(this.onInputOutHandler, this), this.events.onInputDown.add(this.onInputDownHandler, this), this.events.onInputUp.add(this.onInputUpHandler, this), this.events.onRemovedFromWorld.add(this.removedFromWorld, this)
    }, c.Button.prototype = Object.create(c.Image.prototype), c.Button.prototype.constructor = c.Button;
    var g = "Over", h = "Out", i = "Down", j = "Up";
    c.Button.prototype.clearFrames = function () {
        this.setFrames(null, null, null, null)
    }, c.Button.prototype.removedFromWorld = function () {
        this.inputEnabled = !1
    }, c.Button.prototype.setStateFrame = function (a, b, c) {
        var d = "_on" + a + "Frame";
        null !== b ? (this[d] = b, c && this.changeStateFrame(a)) : this[d] = null
    }, c.Button.prototype.changeStateFrame = function (a) {
        if (this.freezeFrames)return !1;
        var b = "_on" + a + "Frame", c = this[b];
        return "string" == typeof c ? (this.frameName = c, !0) : "number" == typeof c ? (this.frame = c, !0) : !1
    }, c.Button.prototype.setFrames = function (a, b, c, d) {
        this.setStateFrame(g, a, this.input.pointerOver()), this.setStateFrame(h, b, !this.input.pointerOver()), this.setStateFrame(i, c, this.input.pointerDown()), this.setStateFrame(j, d, this.input.pointerUp())
    }, c.Button.prototype.setStateSound = function (a, b, d) {
        var e = "on" + a + "Sound", f = "on" + a + "SoundMarker";
        b instanceof c.Sound || b instanceof c.AudioSprite ? (this[e] = b, this[f] = "string" == typeof d ? d : "") : (this[e] = null, this[f] = "")
    }, c.Button.prototype.playStateSound = function (a) {
        var b = "on" + a + "Sound", c = this[b];
        if (c) {
            var d = "on" + a + "SoundMarker", e = this[d];
            return c.play(e), !0
        }
        return !1
    }, c.Button.prototype.setSounds = function (a, b, c, d, e, f, k, l) {
        this.setStateSound(g, a, b), this.setStateSound(h, e, f), this.setStateSound(i, c, d), this.setStateSound(j, k, l)
    }, c.Button.prototype.setOverSound = function (a, b) {
        this.setStateSound(g, a, b)
    }, c.Button.prototype.setOutSound = function (a, b) {
        this.setStateSound(h, a, b)
    }, c.Button.prototype.setDownSound = function (a, b) {
        this.setStateSound(i, a, b)
    }, c.Button.prototype.setUpSound = function (a, b) {
        this.setStateSound(j, a, b)
    }, c.Button.prototype.onInputOverHandler = function (a, b) {
        b.justReleased() && (this.justReleasedPreventsOver & b.pointerMode) === b.pointerMode || (this.changeStateFrame(g), (!this.onOverMouseOnly || b.isMouse) && (this.playStateSound(g), this.onInputOver && this.onInputOver.dispatch(this, b)))
    }, c.Button.prototype.onInputOutHandler = function (a, b) {
        this.changeStateFrame(h), this.playStateSound(h), this.onInputOut && this.onInputOut.dispatch(this, b)
    }, c.Button.prototype.onInputDownHandler = function (a, b) {
        this.changeStateFrame(i), this.playStateSound(i), this.onInputDown && this.onInputDown.dispatch(this, b)
    }, c.Button.prototype.onInputUpHandler = function (a, b, c) {
        if (this.playStateSound(j), this.onInputUp && this.onInputUp.dispatch(this, b, c), !this.freezeFrames)if (this.forceOut === !0 || (this.forceOut & b.pointerMode) === b.pointerMode)this.changeStateFrame(h); else {
            var d = this.changeStateFrame(j);
            d || (c ? this.changeStateFrame(g) : this.changeStateFrame(h))
        }
    }, c.SpriteBatch = function (a, b, d, e) {
        (void 0 === b || null === b) && (b = a.world), PIXI.SpriteBatch.call(this), c.Group.call(this, a, b, d, e), this.type = c.SPRITEBATCH
    }, c.SpriteBatch.prototype = c.Utils.extend(!0, c.SpriteBatch.prototype, PIXI.SpriteBatch.prototype, c.Group.prototype), c.SpriteBatch.prototype.constructor = c.SpriteBatch, c.BitmapData = function (a, b, d, e, f) {
        (void 0 === d || 0 === d) && (d = 256), (void 0 === e || 0 === e) && (e = 256), void 0 === f && (f = !1), this.game = a, this.key = b, this.width = d, this.height = e, this.canvas = c.Canvas.create(this, d, e, null, f), this.context = this.canvas.getContext("2d", {alpha: !0}), this.ctx = this.context, this.smoothProperty = a.renderType === c.CANVAS ? a.renderer.renderSession.smoothProperty : c.Canvas.getSmoothingPrefix(this.context), this.imageData = this.context.getImageData(0, 0, d, e), this.data = null, this.imageData && (this.data = this.imageData.data), this.pixels = null, this.data && (this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data), this.baseTexture = new PIXI.BaseTexture(this.canvas), this.texture = new PIXI.Texture(this.baseTexture), this.frameData = new c.FrameData, this.textureFrame = this.frameData.addFrame(new c.Frame(0, 0, 0, d, e, "bitmapData")), this.texture.frame = this.textureFrame, this.type = c.BITMAPDATA, this.disableTextureUpload = !1, this.dirty = !1, this.cls = this.clear, this._image = null, this._pos = new c.Point, this._size = new c.Point, this._scale = new c.Point, this._rotate = 0, this._alpha = {
            prev: 1,
            current: 1
        }, this._anchor = new c.Point, this._tempR = 0, this._tempG = 0, this._tempB = 0, this._circle = new c.Circle, this._swapCanvas = void 0
    }, c.BitmapData.prototype = {
        move: function (a, b, c) {
            return 0 !== a && this.moveH(a, c), 0 !== b && this.moveV(b, c), this
        }, moveH: function (a, b) {
            void 0 === b && (b = !0), void 0 === this._swapCanvas && (this._swapCanvas = PIXI.CanvasPool.create(this, this.width, this.height));
            var c = this._swapCanvas, d = c.getContext("2d"), e = this.height, f = this.canvas;
            if (d.clearRect(0, 0, this.width, this.height), 0 > a) {
                a = Math.abs(a);
                var g = this.width - a;
                b && d.drawImage(f, 0, 0, a, e, g, 0, a, e), d.drawImage(f, a, 0, g, e, 0, 0, g, e)
            } else {
                var g = this.width - a;
                b && d.drawImage(f, g, 0, a, e, 0, 0, a, e), d.drawImage(f, 0, 0, g, e, a, 0, g, e)
            }
            return this.clear(), this.copy(this._swapCanvas)
        }, moveV: function (a, b) {
            void 0 === b && (b = !0), void 0 === this._swapCanvas && (this._swapCanvas = PIXI.CanvasPool.create(this, this.width, this.height));
            var c = this._swapCanvas, d = c.getContext("2d"), e = this.width, f = this.canvas;
            if (d.clearRect(0, 0, this.width, this.height), 0 > a) {
                a = Math.abs(a);
                var g = this.height - a;
                b && d.drawImage(f, 0, 0, e, a, 0, g, e, a), d.drawImage(f, 0, a, e, g, 0, 0, e, g)
            } else {
                var g = this.height - a;
                b && d.drawImage(f, 0, g, e, a, 0, 0, e, a), d.drawImage(f, 0, 0, e, g, 0, a, e, g)
            }
            return this.clear(), this.copy(this._swapCanvas)
        }, add: function (a) {
            if (Array.isArray(a))for (var b = 0; b < a.length; b++)a[b].loadTexture && a[b].loadTexture(this); else a.loadTexture(this);
            return this
        }, load: function (a) {
            return "string" == typeof a && (a = this.game.cache.getImage(a)), a ? (this.resize(a.width, a.height), this.cls(), this.draw(a), this.update(), this) : void 0
        }, clear: function (a, b, c, d) {
            return void 0 === a && (a = 0), void 0 === b && (b = 0), void 0 === c && (c = this.width), void 0 === d && (d = this.height), this.context.clearRect(a, b, c, d), this.dirty = !0, this
        }, fill: function (a, b, c, d) {
            return void 0 === d && (d = 1), this.context.fillStyle = "rgba(" + a + "," + b + "," + c + "," + d + ")", this.context.fillRect(0, 0, this.width, this.height), this.dirty = !0, this
        }, generateTexture: function (a) {
            var b = new Image;
            b.src = this.canvas.toDataURL("image/png");
            var c = this.game.cache.addImage(a, "", b);
            return new PIXI.Texture(c.base)
        }, resize: function (a, b) {
            return (a !== this.width || b !== this.height) && (this.width = a, this.height = b, this.canvas.width = a, this.canvas.height = b, void 0 !== this._swapCanvas && (this._swapCanvas.width = a, this._swapCanvas.height = b), this.baseTexture.width = a, this.baseTexture.height = b, this.textureFrame.width = a, this.textureFrame.height = b, this.texture.width = a, this.texture.height = b, this.texture.crop.width = a, this.texture.crop.height = b, this.update(), this.dirty = !0), this
        }, update: function (a, b, c, d) {
            return void 0 === a && (a = 0), void 0 === b && (b = 0), void 0 === c && (c = Math.max(1, this.width)), void 0 === d && (d = Math.max(1, this.height)), this.imageData = this.context.getImageData(a, b, c, d), this.data = this.imageData.data, this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data, this
        }, processPixelRGB: function (a, b, d, e, f, g) {
            void 0 === d && (d = 0), void 0 === e && (e = 0), void 0 === f && (f = this.width), void 0 === g && (g = this.height);
            for (var h = d + f, i = e + g, j = c.Color.createColor(), k = {
                r: 0,
                g: 0,
                b: 0,
                a: 0
            }, l = !1, m = e; i > m; m++)for (var n = d; h > n; n++)c.Color.unpackPixel(this.getPixel32(n, m), j), k = a.call(b, j, n, m), k !== !1 && null !== k && void 0 !== k && (this.setPixel32(n, m, k.r, k.g, k.b, k.a, !1), l = !0);
            return l && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), this
        }, processPixel: function (a, b, c, d, e, f) {
            void 0 === c && (c = 0), void 0 === d && (d = 0), void 0 === e && (e = this.width), void 0 === f && (f = this.height);
            for (var g = c + e, h = d + f, i = 0, j = 0, k = !1, l = d; h > l; l++)for (var m = c; g > m; m++)i = this.getPixel32(m, l), j = a.call(b, i, m, l), j !== i && (this.pixels[l * this.width + m] = j, k = !0);
            return k && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), this
        }, replaceRGB: function (a, b, d, e, f, g, h, i, j) {
            var k = 0, l = 0, m = this.width, n = this.height, o = c.Color.packPixel(a, b, d, e);
            void 0 !== j && j instanceof c.Rectangle && (k = j.x, l = j.y, m = j.width, n = j.height);
            for (var p = 0; n > p; p++)for (var q = 0; m > q; q++)this.getPixel32(k + q, l + p) === o && this.setPixel32(k + q, l + p, f, g, h, i, !1);
            return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this
        }, setHSL: function (a, b, d, e) {
            var f = a || 0 === a, g = b || 0 === b, h = d || 0 === d;
            if (f || g || h) {
                void 0 === e && (e = new c.Rectangle(0, 0, this.width, this.height));
                for (var i = c.Color.createColor(), j = e.y; j < e.bottom; j++)for (var k = e.x; k < e.right; k++)c.Color.unpackPixel(this.getPixel32(k, j), i, !0), f && (i.h = a), g && (i.s = b), h && (i.l = d), c.Color.HSLtoRGB(i.h, i.s, i.l, i), this.setPixel32(k, j, i.r, i.g, i.b, i.a, !1);
                return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this
            }
        }, shiftHSL: function (a, b, d, e) {
            if ((void 0 === a || null === a) && (a = !1), (void 0 === b || null === b) && (b = !1), (void 0 === d || null === d) && (d = !1), a || b || d) {
                void 0 === e && (e = new c.Rectangle(0, 0, this.width, this.height));
                for (var f = c.Color.createColor(), g = e.y; g < e.bottom; g++)for (var h = e.x; h < e.right; h++)c.Color.unpackPixel(this.getPixel32(h, g), f, !0), a && (f.h = this.game.math.wrap(f.h + a, 0, 1)), b && (f.s = this.game.math.clamp(f.s + b, 0, 1)), d && (f.l = this.game.math.clamp(f.l + d, 0, 1)), c.Color.HSLtoRGB(f.h, f.s, f.l, f), this.setPixel32(h, g, f.r, f.g, f.b, f.a, !1);
                return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this
            }
        }, setPixel32: function (a, b, d, e, f, g, h) {
            return void 0 === h && (h = !0), a >= 0 && a <= this.width && b >= 0 && b <= this.height && (c.Device.LITTLE_ENDIAN ? this.pixels[b * this.width + a] = g << 24 | f << 16 | e << 8 | d : this.pixels[b * this.width + a] = d << 24 | e << 16 | f << 8 | g, h && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0)), this
        }, setPixel: function (a, b, c, d, e, f) {
            return this.setPixel32(a, b, c, d, e, 255, f)
        }, getPixel: function (a, b, d) {
            d || (d = c.Color.createColor());
            var e = ~~(a + b * this.width);
            return e *= 4, d.r = this.data[e], d.g = this.data[++e], d.b = this.data[++e], d.a = this.data[++e], d
        }, getPixel32: function (a, b) {
            return a >= 0 && a <= this.width && b >= 0 && b <= this.height ? this.pixels[b * this.width + a] : void 0
        }, getPixelRGB: function (a, b, d, e, f) {
            return c.Color.unpackPixel(this.getPixel32(a, b), d, e, f)
        }, getPixels: function (a) {
            return this.context.getImageData(a.x, a.y, a.width, a.height)
        }, getFirstPixel: function (a) {
            void 0 === a && (a = 0);
            var b = c.Color.createColor(), d = 0, e = 0, f = 1, g = !1;
            1 === a ? (f = -1, e = this.height) : 3 === a && (f = -1, d = this.width);
            do c.Color.unpackPixel(this.getPixel32(d, e), b), 0 === a || 1 === a ? (d++, d === this.width && (d = 0, e += f, (e >= this.height || 0 >= e) && (g = !0))) : (2 === a || 3 === a) && (e++, e === this.height && (e = 0, d += f, (d >= this.width || 0 >= d) && (g = !0))); while (0 === b.a && !g);
            return b.x = d, b.y = e, b
        }, getBounds: function (a) {
            return void 0 === a && (a = new c.Rectangle), a.x = this.getFirstPixel(2).x, a.x === this.width ? a.setTo(0, 0, 0, 0) : (a.y = this.getFirstPixel(0).y, a.width = this.getFirstPixel(3).x - a.x + 1, a.height = this.getFirstPixel(1).y - a.y + 1, a)
        }, addToWorld: function (a, b, c, d, e, f) {
            e = e || 1, f = f || 1;
            var g = this.game.add.image(a, b, this);
            return g.anchor.set(c, d), g.scale.set(e, f), g
        }, copy: function (a, b, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r) {
            if ((void 0 === a || null === a) && (a = this), (a instanceof c.RenderTexture || a instanceof PIXI.RenderTexture) && (a = a.getCanvas()), this._image = a, a instanceof c.Sprite || a instanceof c.Image || a instanceof c.Text || a instanceof PIXI.Sprite)this._pos.set(a.texture.crop.x, a.texture.crop.y), this._size.set(a.texture.crop.width, a.texture.crop.height), this._scale.set(a.scale.x, a.scale.y), this._anchor.set(a.anchor.x, a.anchor.y), this._rotate = a.rotation, this._alpha.current = a.alpha, a.texture instanceof c.RenderTexture || a.texture instanceof PIXI.RenderTexture ? this._image = a.texture.getCanvas() : this._image = a.texture.baseTexture.source, (void 0 === g || null === g) && (g = a.x), (void 0 === h || null === h) && (h = a.y), a.texture.trim && (g += a.texture.trim.x - a.anchor.x * a.texture.trim.width, h += a.texture.trim.y - a.anchor.y * a.texture.trim.height), 16777215 !== a.tint && (a.cachedTint !== a.tint && (a.cachedTint = a.tint, a.tintedTexture = PIXI.CanvasTinter.getTintedTexture(a, a.tint)), this._image = a.tintedTexture, this._pos.set(0)); else {
                if (this._pos.set(0), this._scale.set(1), this._anchor.set(0), this._rotate = 0, this._alpha.current = 1, a instanceof c.BitmapData)this._image = a.canvas; else if ("string" == typeof a) {
                    if (a = this.game.cache.getImage(a), null === a)return;
                    this._image = a
                }
                this._size.set(this._image.width, this._image.height)
            }
            if ((void 0 === b || null === b) && (b = 0), (void 0 === d || null === d) && (d = 0), e && (this._size.x = e), f && (this._size.y = f), (void 0 === g || null === g) && (g = b), (void 0 === h || null === h) && (h = d), (void 0 === i || null === i) && (i = this._size.x), (void 0 === j || null === j) && (j = this._size.y), "number" == typeof k && (this._rotate = k), "number" == typeof l && (this._anchor.x = l), "number" == typeof m && (this._anchor.y = m), "number" == typeof n && (this._scale.x = n), "number" == typeof o && (this._scale.y = o), "number" == typeof p && (this._alpha.current = p), void 0 === q && (q = null), void 0 === r && (r = !1), !(this._alpha.current <= 0 || 0 === this._scale.x || 0 === this._scale.y || 0 === this._size.x || 0 === this._size.y)) {
                var s = this.context;
                return this._alpha.prev = s.globalAlpha, s.save(), s.globalAlpha = this._alpha.current,
                q && (this.op = q), r && (g |= 0, h |= 0), s.translate(g, h), s.scale(this._scale.x, this._scale.y), s.rotate(this._rotate), s.drawImage(this._image, this._pos.x + b, this._pos.y + d, this._size.x, this._size.y, -i * this._anchor.x, -j * this._anchor.y, i, j), s.restore(), s.globalAlpha = this._alpha.prev, this.dirty = !0, this
            }
        }, copyTransform: function (a, b, d) {
            if (void 0 === b && (b = null), void 0 === d && (d = !1), !a.hasOwnProperty("worldTransform") || !a.worldVisible || 0 === a.worldAlpha)return this;
            var e = a.worldTransform;
            if (this._pos.set(a.texture.crop.x, a.texture.crop.y), this._size.set(a.texture.crop.width, a.texture.crop.height), 0 === e.a || 0 === e.d || 0 === this._size.x || 0 === this._size.y)return this;
            a.texture instanceof c.RenderTexture || a.texture instanceof PIXI.RenderTexture ? this._image = a.texture.getCanvas() : this._image = a.texture.baseTexture.source;
            var f = e.tx, g = e.ty;
            a.texture.trim && (f += a.texture.trim.x - a.anchor.x * a.texture.trim.width, g += a.texture.trim.y - a.anchor.y * a.texture.trim.height), 16777215 !== a.tint && (a.cachedTint !== a.tint && (a.cachedTint = a.tint, a.tintedTexture = PIXI.CanvasTinter.getTintedTexture(a, a.tint)), this._image = a.tintedTexture, this._pos.set(0)), d && (f |= 0, g |= 0);
            var h = this.context;
            return this._alpha.prev = h.globalAlpha, h.save(), h.globalAlpha = this._alpha.current, b && (this.op = b), h[this.smoothProperty] = a.texture.baseTexture.scaleMode === PIXI.scaleModes.LINEAR, h.setTransform(e.a, e.b, e.c, e.d, f, g), h.drawImage(this._image, this._pos.x, this._pos.y, this._size.x, this._size.y, -this._size.x * a.anchor.x, -this._size.y * a.anchor.y, this._size.x, this._size.y), h.restore(), h.globalAlpha = this._alpha.prev, this.dirty = !0, this
        }, copyRect: function (a, b, c, d, e, f, g) {
            return this.copy(a, b.x, b.y, b.width, b.height, c, d, b.width, b.height, 0, 0, 0, 1, 1, e, f, g)
        }, draw: function (a, b, c, d, e, f, g) {
            return this.copy(a, null, null, null, null, b, c, d, e, null, null, null, null, null, null, f, g)
        }, drawGroup: function (a, b, c) {
            return a.total > 0 && a.forEachExists(this.drawGroupProxy, this, b, c), this
        }, drawGroupProxy: function (a, b, d) {
            if (a.hasOwnProperty("texture") && this.copyTransform(a, b, d), a.type === c.GROUP && a.exists)this.drawGroup(a, b, d); else if (a.hasOwnProperty("children") && a.children.length > 0)for (var e = 0; e < a.children.length; e++)a.children[e].exists && this.copyTransform(a.children[e], b, d)
        }, drawFull: function (a, b, d) {
            if (a.worldVisible === !1 || 0 === a.worldAlpha || a.hasOwnProperty("exists") && a.exists === !1)return this;
            if (a.type !== c.GROUP && a.type !== c.EMITTER && a.type !== c.BITMAPTEXT)if (a.type === c.GRAPHICS) {
                var e = a.getBounds();
                this.ctx.save(), this.ctx.translate(e.x, e.y), PIXI.CanvasGraphics.renderGraphics(a, this.ctx), this.ctx.restore()
            } else this.copy(a, null, null, null, null, a.worldPosition.x, a.worldPosition.y, null, null, a.worldRotation, null, null, a.worldScale.x, a.worldScale.y, a.worldAlpha, b, d);
            if (a.children)for (var f = 0; f < a.children.length; f++)this.drawFull(a.children[f], b, d);
            return this
        }, shadow: function (a, b, c, d) {
            var e = this.context;
            void 0 === a || null === a ? e.shadowColor = "rgba(0,0,0,0)" : (e.shadowColor = a, e.shadowBlur = b || 5, e.shadowOffsetX = c || 10, e.shadowOffsetY = d || 10)
        }, alphaMask: function (a, b, c, d) {
            return void 0 === d || null === d ? this.draw(b).blendSourceAtop() : this.draw(b, d.x, d.y, d.width, d.height).blendSourceAtop(), void 0 === c || null === c ? this.draw(a).blendReset() : this.draw(a, c.x, c.y, c.width, c.height).blendReset(), this
        }, extract: function (a, b, c, d, e, f, g, h, i) {
            return void 0 === e && (e = 255), void 0 === f && (f = !1), void 0 === g && (g = b), void 0 === h && (h = c), void 0 === i && (i = d), f && a.resize(this.width, this.height), this.processPixelRGB(function (f, j, k) {
                return f.r === b && f.g === c && f.b === d && a.setPixel32(j, k, g, h, i, e, !1), !1
            }, this), a.context.putImageData(a.imageData, 0, 0), a.dirty = !0, a
        }, rect: function (a, b, c, d, e) {
            return "undefined" != typeof e && (this.context.fillStyle = e), this.context.fillRect(a, b, c, d), this
        }, text: function (a, b, c, d, e, f) {
            void 0 === b && (b = 0), void 0 === c && (c = 0), void 0 === d && (d = "14px Courier"), void 0 === e && (e = "rgb(255,255,255)"), void 0 === f && (f = !0);
            var g = this.context, h = g.font;
            g.font = d, f && (g.fillStyle = "rgb(0,0,0)", g.fillText(a, b + 1, c + 1)), g.fillStyle = e, g.fillText(a, b, c), g.font = h
        }, circle: function (a, b, c, d) {
            var e = this.context;
            return void 0 !== d && (e.fillStyle = d), e.beginPath(), e.arc(a, b, c, 0, 2 * Math.PI, !1), e.closePath(), e.fill(), this
        }, line: function (a, b, c, d, e, f) {
            void 0 === e && (e = "#fff"), void 0 === f && (f = 1);
            var g = this.context;
            return g.beginPath(), g.moveTo(a, b), g.lineTo(c, d), g.lineWidth = f, g.strokeStyle = e, g.stroke(), g.closePath(), this
        }, textureLine: function (a, b, d) {
            if (void 0 === d && (d = "repeat-x"), "string" != typeof b || (b = this.game.cache.getImage(b))) {
                var e = a.length;
                "no-repeat" === d && e > b.width && (e = b.width);
                var f = this.context;
                return f.fillStyle = f.createPattern(b, d), this._circle = new c.Circle(a.start.x, a.start.y, b.height), this._circle.circumferencePoint(a.angle - 1.5707963267948966, !1, this._pos), f.save(), f.translate(this._pos.x, this._pos.y), f.rotate(a.angle), f.fillRect(0, 0, e, b.height), f.restore(), this.dirty = !0, this
            }
        }, render: function () {
            return !this.disableTextureUpload && this.dirty && (this.baseTexture.dirty(), this.dirty = !1), this
        }, destroy: function () {
            this.frameData.destroy(), this.texture.destroy(!0), PIXI.CanvasPool.remove(this)
        }, blendReset: function () {
            return this.op = "source-over", this
        }, blendSourceOver: function () {
            return this.op = "source-over", this
        }, blendSourceIn: function () {
            return this.op = "source-in", this
        }, blendSourceOut: function () {
            return this.op = "source-out", this
        }, blendSourceAtop: function () {
            return this.op = "source-atop", this
        }, blendDestinationOver: function () {
            return this.op = "destination-over", this
        }, blendDestinationIn: function () {
            return this.op = "destination-in", this
        }, blendDestinationOut: function () {
            return this.op = "destination-out", this
        }, blendDestinationAtop: function () {
            return this.op = "destination-atop", this
        }, blendXor: function () {
            return this.op = "xor", this
        }, blendAdd: function () {
            return this.op = "lighter", this
        }, blendMultiply: function () {
            return this.op = "multiply", this
        }, blendScreen: function () {
            return this.op = "screen", this
        }, blendOverlay: function () {
            return this.op = "overlay", this
        }, blendDarken: function () {
            return this.op = "darken", this
        }, blendLighten: function () {
            return this.op = "lighten", this
        }, blendColorDodge: function () {
            return this.op = "color-dodge", this
        }, blendColorBurn: function () {
            return this.op = "color-burn", this
        }, blendHardLight: function () {
            return this.op = "hard-light", this
        }, blendSoftLight: function () {
            return this.op = "soft-light", this
        }, blendDifference: function () {
            return this.op = "difference", this
        }, blendExclusion: function () {
            return this.op = "exclusion", this
        }, blendHue: function () {
            return this.op = "hue", this
        }, blendSaturation: function () {
            return this.op = "saturation", this
        }, blendColor: function () {
            return this.op = "color", this
        }, blendLuminosity: function () {
            return this.op = "luminosity", this
        }
    }, Object.defineProperty(c.BitmapData.prototype, "smoothed", {
        get: function () {
            c.Canvas.getSmoothingEnabled(this.context)
        }, set: function (a) {
            c.Canvas.setSmoothingEnabled(this.context, a)
        }
    }), Object.defineProperty(c.BitmapData.prototype, "op", {
        get: function () {
            return this.context.globalCompositeOperation
        }, set: function (a) {
            this.context.globalCompositeOperation = a
        }
    }), c.BitmapData.getTransform = function (a, b, c, d, e, f) {
        return "number" != typeof a && (a = 0), "number" != typeof b && (b = 0), "number" != typeof c && (c = 1), "number" != typeof d && (d = 1), "number" != typeof e && (e = 0), "number" != typeof f && (f = 0), {
            sx: c,
            sy: d,
            scaleX: c,
            scaleY: d,
            skewX: e,
            skewY: f,
            translateX: a,
            translateY: b,
            tx: a,
            ty: b
        }
    }, c.BitmapData.prototype.constructor = c.BitmapData, PIXI.Graphics = function () {
        PIXI.DisplayObjectContainer.call(this), this.renderable = !0, this.fillAlpha = 1, this.lineWidth = 0, this.lineColor = 0, this.graphicsData = [], this.tint = 16777215, this.blendMode = PIXI.blendModes.NORMAL, this.currentPath = null, this._webGL = [], this.isMask = !1, this.boundsPadding = 0, this._localBounds = new PIXI.Rectangle(0, 0, 1, 1), this.dirty = !0, this.webGLDirty = !1, this.cachedSpriteDirty = !1
    }, PIXI.Graphics.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), PIXI.Graphics.prototype.constructor = PIXI.Graphics, PIXI.Graphics.prototype.lineStyle = function (a, b, c) {
        return this.lineWidth = a || 0, this.lineColor = b || 0, this.lineAlpha = void 0 === c ? 1 : c, this.currentPath && (this.currentPath.shape.points.length ? this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))) : (this.currentPath.lineWidth = this.lineWidth, this.currentPath.lineColor = this.lineColor, this.currentPath.lineAlpha = this.lineAlpha)), this
    }, PIXI.Graphics.prototype.moveTo = function (a, b) {
        return this.drawShape(new PIXI.Polygon([a, b])), this
    }, PIXI.Graphics.prototype.lineTo = function (a, b) {
        return this.currentPath || this.moveTo(0, 0), this.currentPath.shape.points.push(a, b), this.dirty = !0, this.updateLocalBounds(), this
    }, PIXI.Graphics.prototype.quadraticCurveTo = function (a, b, c, d) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0);
        var e, f, g = 20, h = this.currentPath.shape.points;
        0 === h.length && this.moveTo(0, 0);
        for (var i = h[h.length - 2], j = h[h.length - 1], k = 0, l = 1; g >= l; ++l)k = l / g, e = i + (a - i) * k, f = j + (b - j) * k, h.push(e + (a + (c - a) * k - e) * k, f + (b + (d - b) * k - f) * k);
        return this.dirty = !0, this.updateLocalBounds(), this
    }, PIXI.Graphics.prototype.bezierCurveTo = function (a, b, c, d, e, f) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0);
        for (var g, h, i, j, k, l = 20, m = this.currentPath.shape.points, n = m[m.length - 2], o = m[m.length - 1], p = 0, q = 1; l >= q; ++q)p = q / l, g = 1 - p, h = g * g, i = h * g, j = p * p, k = j * p, m.push(i * n + 3 * h * p * a + 3 * g * j * c + k * e, i * o + 3 * h * p * b + 3 * g * j * d + k * f);
        return this.dirty = !0, this.updateLocalBounds(), this
    }, PIXI.Graphics.prototype.arcTo = function (a, b, c, d, e) {
        this.currentPath ? 0 === this.currentPath.shape.points.length && this.currentPath.shape.points.push(a, b) : this.moveTo(a, b);
        var f = this.currentPath.shape.points, g = f[f.length - 2], h = f[f.length - 1], i = h - b, j = g - a, k = d - b, l = c - a, m = Math.abs(i * l - j * k);
        if (1e-8 > m || 0 === e)(f[f.length - 2] !== a || f[f.length - 1] !== b) && f.push(a, b); else {
            var n = i * i + j * j, o = k * k + l * l, p = i * k + j * l, q = e * Math.sqrt(n) / m, r = e * Math.sqrt(o) / m, s = q * p / n, t = r * p / o, u = q * l + r * j, v = q * k + r * i, w = j * (r + s), x = i * (r + s), y = l * (q + t), z = k * (q + t), A = Math.atan2(x - v, w - u), B = Math.atan2(z - v, y - u);
            this.arc(u + a, v + b, e, A, B, j * k > l * i)
        }
        return this.dirty = !0, this.updateLocalBounds(), this
    }, PIXI.Graphics.prototype.arc = function (a, b, c, d, e, f, g) {
        if (d === e)return this;
        void 0 === f && (f = !1), void 0 === g && (g = 40), !f && d >= e ? e += 2 * Math.PI : f && e >= d && (d += 2 * Math.PI);
        var h = f ? -1 * (d - e) : e - d, i = Math.ceil(Math.abs(h) / (2 * Math.PI)) * g;
        if (0 === h)return this;
        var j = a + Math.cos(d) * c, k = b + Math.sin(d) * c;
        f && this.filling ? this.moveTo(a, b) : this.moveTo(j, k);
        for (var l = this.currentPath.shape.points, m = h / (2 * i), n = 2 * m, o = Math.cos(m), p = Math.sin(m), q = i - 1, r = q % 1 / q, s = 0; q >= s; s++) {
            var t = s + r * s, u = m + d + n * t, v = Math.cos(u), w = -Math.sin(u);
            l.push((o * v + p * w) * c + a, (o * -w + p * v) * c + b)
        }
        return this.dirty = !0, this.updateLocalBounds(), this
    }, PIXI.Graphics.prototype.beginFill = function (a, b) {
        return this.filling = !0, this.fillColor = a || 0, this.fillAlpha = void 0 === b ? 1 : b, this.currentPath && this.currentPath.shape.points.length <= 2 && (this.currentPath.fill = this.filling, this.currentPath.fillColor = this.fillColor, this.currentPath.fillAlpha = this.fillAlpha), this
    }, PIXI.Graphics.prototype.endFill = function () {
        return this.filling = !1, this.fillColor = null, this.fillAlpha = 1, this
    }, PIXI.Graphics.prototype.drawRect = function (a, b, c, d) {
        return this.drawShape(new PIXI.Rectangle(a, b, c, d)), this
    }, PIXI.Graphics.prototype.drawRoundedRect = function (a, b, c, d, e) {
        return this.drawShape(new PIXI.RoundedRectangle(a, b, c, d, e)), this
    }, PIXI.Graphics.prototype.drawCircle = function (a, b, c) {
        return this.drawShape(new PIXI.Circle(a, b, c)), this
    }, PIXI.Graphics.prototype.drawEllipse = function (a, b, c, d) {
        return this.drawShape(new PIXI.Ellipse(a, b, c, d)), this
    }, PIXI.Graphics.prototype.drawPolygon = function (a) {
        (a instanceof c.Polygon || a instanceof PIXI.Polygon) && (a = a.points);
        var b = a;
        if (!Array.isArray(b)) {
            b = new Array(arguments.length);
            for (var d = 0; d < b.length; ++d)b[d] = arguments[d]
        }
        return this.drawShape(new c.Polygon(b)), this
    }, PIXI.Graphics.prototype.clear = function () {
        return this.lineWidth = 0, this.filling = !1, this.dirty = !0, this.clearDirty = !0, this.graphicsData = [], this.updateLocalBounds(), this
    }, PIXI.Graphics.prototype.generateTexture = function (a, b, c) {
        void 0 === a && (a = 1), void 0 === b && (b = PIXI.scaleModes.DEFAULT), void 0 === c && (c = 0);
        var d = this.getBounds();
        d.width += c, d.height += c;
        var e = new PIXI.CanvasBuffer(d.width * a, d.height * a), f = PIXI.Texture.fromCanvas(e.canvas, b);
        return f.baseTexture.resolution = a, e.context.scale(a, a), e.context.translate(-d.x, -d.y), PIXI.CanvasGraphics.renderGraphics(this, e.context), f
    }, PIXI.Graphics.prototype._renderWebGL = function (a) {
        if (this.visible !== !1 && 0 !== this.alpha && this.isMask !== !0) {
            if (this._cacheAsBitmap)return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), this._cachedSprite.worldAlpha = this.worldAlpha, void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite, a);
            if (a.spriteBatch.stop(), a.blendModeManager.setBlendMode(this.blendMode), this._mask && a.maskManager.pushMask(this._mask, a), this._filters && a.filterManager.pushFilter(this._filterBlock), this.blendMode !== a.spriteBatch.currentBlendMode) {
                a.spriteBatch.currentBlendMode = this.blendMode;
                var b = PIXI.blendModesWebGL[a.spriteBatch.currentBlendMode];
                a.spriteBatch.gl.blendFunc(b[0], b[1])
            }
            if (this.webGLDirty && (this.dirty = !0, this.webGLDirty = !1), PIXI.WebGLGraphics.renderGraphics(this, a), this.children.length) {
                a.spriteBatch.start();
                for (var c = 0; c < this.children.length; c++)this.children[c]._renderWebGL(a);
                a.spriteBatch.stop()
            }
            this._filters && a.filterManager.popFilter(), this._mask && a.maskManager.popMask(this.mask, a), a.drawCount++, a.spriteBatch.start()
        }
    }, PIXI.Graphics.prototype._renderCanvas = function (a) {
        if (this.visible !== !1 && 0 !== this.alpha && this.isMask !== !0) {
            if (this._prevTint !== this.tint && (this.dirty = !0, this._prevTint = this.tint), this._cacheAsBitmap)return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), this._cachedSprite.alpha = this.alpha, void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite, a);
            var b = a.context, c = this.worldTransform;
            this.blendMode !== a.currentBlendMode && (a.currentBlendMode = this.blendMode, b.globalCompositeOperation = PIXI.blendModesCanvas[a.currentBlendMode]), this._mask && a.maskManager.pushMask(this._mask, a);
            var d = a.resolution, e = c.tx * a.resolution + a.shakeX, f = c.ty * a.resolution + a.shakeY;
            b.setTransform(c.a * d, c.b * d, c.c * d, c.d * d, e, f), PIXI.CanvasGraphics.renderGraphics(this, b);
            for (var g = 0; g < this.children.length; g++)this.children[g]._renderCanvas(a);
            this._mask && a.maskManager.popMask(a)
        }
    }, PIXI.Graphics.prototype.getBounds = function (a) {
        if (!this._currentBounds) {
            if (!this.renderable)return PIXI.EmptyRectangle;
            this.dirty && (this.updateLocalBounds(), this.webGLDirty = !0, this.cachedSpriteDirty = !0, this.dirty = !1);
            var b = this._localBounds, c = b.x, d = b.width + b.x, e = b.y, f = b.height + b.y, g = a || this.worldTransform, h = g.a, i = g.b, j = g.c, k = g.d, l = g.tx, m = g.ty, n = h * d + j * f + l, o = k * f + i * d + m, p = h * c + j * f + l, q = k * f + i * c + m, r = h * c + j * e + l, s = k * e + i * c + m, t = h * d + j * e + l, u = k * e + i * d + m, v = n, w = o, x = n, y = o;
            x = x > p ? p : x, x = x > r ? r : x, x = x > t ? t : x, y = y > q ? q : y, y = y > s ? s : y, y = y > u ? u : y, v = p > v ? p : v, v = r > v ? r : v, v = t > v ? t : v, w = q > w ? q : w, w = s > w ? s : w, w = u > w ? u : w, this._bounds.x = x, this._bounds.width = v - x, this._bounds.y = y, this._bounds.height = w - y, this._currentBounds = this._bounds
        }
        return this._currentBounds
    }, PIXI.Graphics.prototype.containsPoint = function (a) {
        this.worldTransform.applyInverse(a, tempPoint);
        for (var b = this.graphicsData, c = 0; c < b.length; c++) {
            var d = b[c];
            if (d.fill && d.shape && d.shape.contains(tempPoint.x, tempPoint.y))return !0
        }
        return !1
    }, PIXI.Graphics.prototype.updateLocalBounds = function () {
        var a = 1 / 0, b = -(1 / 0), d = 1 / 0, e = -(1 / 0);
        if (this.graphicsData.length)for (var f, g, h, i, j, k, l = 0; l < this.graphicsData.length; l++) {
            var m = this.graphicsData[l], n = m.type, o = m.lineWidth;
            if (f = m.shape, n === PIXI.Graphics.RECT || n === PIXI.Graphics.RREC)h = f.x - o / 2, i = f.y - o / 2, j = f.width + o, k = f.height + o, a = a > h ? h : a, b = h + j > b ? h + j : b, d = d > i ? i : d, e = i + k > e ? i + k : e; else if (n === PIXI.Graphics.CIRC)h = f.x, i = f.y, j = f.radius + o / 2, k = f.radius + o / 2, a = a > h - j ? h - j : a, b = h + j > b ? h + j : b, d = d > i - k ? i - k : d, e = i + k > e ? i + k : e; else if (n === PIXI.Graphics.ELIP)h = f.x, i = f.y, j = f.width + o / 2, k = f.height + o / 2, a = a > h - j ? h - j : a, b = h + j > b ? h + j : b, d = d > i - k ? i - k : d, e = i + k > e ? i + k : e; else {
                g = f.points;
                for (var p = 0; p < g.length; p++)g[p] instanceof c.Point ? (h = g[p].x, i = g[p].y) : (h = g[p], i = g[p + 1], p < g.length - 1 && p++), a = a > h - o ? h - o : a, b = h + o > b ? h + o : b, d = d > i - o ? i - o : d, e = i + o > e ? i + o : e
            }
        } else a = 0, b = 0, d = 0, e = 0;
        var q = this.boundsPadding;
        this._localBounds.x = a - q, this._localBounds.width = b - a + 2 * q, this._localBounds.y = d - q, this._localBounds.height = e - d + 2 * q
    }, PIXI.Graphics.prototype._generateCachedSprite = function () {
        var a = this.getLocalBounds();
        if (this._cachedSprite)this._cachedSprite.buffer.resize(a.width, a.height); else {
            var b = new PIXI.CanvasBuffer(a.width, a.height), c = PIXI.Texture.fromCanvas(b.canvas);
            this._cachedSprite = new PIXI.Sprite(c), this._cachedSprite.buffer = b, this._cachedSprite.worldTransform = this.worldTransform
        }
        this._cachedSprite.anchor.x = -(a.x / a.width), this._cachedSprite.anchor.y = -(a.y / a.height), this._cachedSprite.buffer.context.translate(-a.x, -a.y), this.worldAlpha = 1, PIXI.CanvasGraphics.renderGraphics(this, this._cachedSprite.buffer.context), this._cachedSprite.alpha = this.alpha
    }, PIXI.Graphics.prototype.updateCachedSpriteTexture = function () {
        var a = this._cachedSprite, b = a.texture, c = a.buffer.canvas;
        b.baseTexture.width = c.width, b.baseTexture.height = c.height, b.crop.width = b.frame.width = c.width, b.crop.height = b.frame.height = c.height, a._width = c.width, a._height = c.height, b.baseTexture.dirty()
    }, PIXI.Graphics.prototype.destroyCachedSprite = function () {
        this._cachedSprite.texture.destroy(!0), this._cachedSprite = null
    }, PIXI.Graphics.prototype.drawShape = function (a) {
        this.currentPath && this.currentPath.shape.points.length <= 2 && this.graphicsData.pop(), this.currentPath = null, a instanceof c.Polygon && (a = a.clone(), a.flatten());
        var b = new PIXI.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.filling, a);
        return this.graphicsData.push(b), b.type === PIXI.Graphics.POLY && (b.shape.closed = this.filling, this.currentPath = b), this.dirty = !0, this.updateLocalBounds(), b
    }, Object.defineProperty(PIXI.Graphics.prototype, "cacheAsBitmap", {
        get: function () {
            return this._cacheAsBitmap
        }, set: function (a) {
            this._cacheAsBitmap = a, this._cacheAsBitmap ? this._generateCachedSprite() : this.destroyCachedSprite(), this.dirty = !0, this.webGLDirty = !0
        }
    }), PIXI.GraphicsData = function (a, b, c, d, e, f, g) {
        this.lineWidth = a, this.lineColor = b, this.lineAlpha = c, this._lineTint = b, this.fillColor = d, this.fillAlpha = e, this._fillTint = d, this.fill = f, this.shape = g, this.type = g.type
    }, PIXI.GraphicsData.prototype.constructor = PIXI.GraphicsData, PIXI.GraphicsData.prototype.clone = function () {
        return new GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.fill, this.shape)
    }, PIXI.PolyK = {}, PIXI.PolyK.Triangulate = function (a) {
        var b = !0, c = a.length >> 1;
        if (3 > c)return [];
        for (var d = [], e = [], f = 0; c > f; f++)e.push(f);
        f = 0;
        for (var g = c; g > 3;) {
            var h = e[(f + 0) % g], i = e[(f + 1) % g], j = e[(f + 2) % g], k = a[2 * h], l = a[2 * h + 1], m = a[2 * i], n = a[2 * i + 1], o = a[2 * j], p = a[2 * j + 1], q = !1;
            if (PIXI.PolyK._convex(k, l, m, n, o, p, b)) {
                q = !0;
                for (var r = 0; g > r; r++) {
                    var s = e[r];
                    if (s !== h && s !== i && s !== j && PIXI.PolyK._PointInTriangle(a[2 * s], a[2 * s + 1], k, l, m, n, o, p)) {
                        q = !1;
                        break
                    }
                }
            }
            if (q)d.push(h, i, j), e.splice((f + 1) % g, 1), g--, f = 0; else if (f++ > 3 * g) {
                if (!b)return null;
                for (d = [], e = [], f = 0; c > f; f++)e.push(f);
                f = 0, g = c, b = !1
            }
        }
        return d.push(e[0], e[1], e[2]), d
    }, PIXI.PolyK._PointInTriangle = function (a, b, c, d, e, f, g, h) {
        var i = g - c, j = h - d, k = e - c, l = f - d, m = a - c, n = b - d, o = i * i + j * j, p = i * k + j * l, q = i * m + j * n, r = k * k + l * l, s = k * m + l * n, t = 1 / (o * r - p * p), u = (r * q - p * s) * t, v = (o * s - p * q) * t;
        return u >= 0 && v >= 0 && 1 > u + v
    }, PIXI.PolyK._convex = function (a, b, c, d, e, f, g) {
        return (b - d) * (e - c) + (c - a) * (f - d) >= 0 === g
    }, PIXI.EarCut = {}, PIXI.EarCut.Triangulate = function (a, b, c) {
        c = c || 2;
        var d = b && b.length, e = d ? b[0] * c : a.length, f = PIXI.EarCut.linkedList(a, 0, e, c, !0), g = [];
        if (!f)return g;
        var h, i, j, k, l, m, n;
        if (d && (f = PIXI.EarCut.eliminateHoles(a, b, f, c)), a.length > 80 * c) {
            h = j = a[0], i = k = a[1];
            for (var o = c; e > o; o += c)l = a[o], m = a[o + 1], h > l && (h = l), i > m && (i = m), l > j && (j = l), m > k && (k = m);
            n = Math.max(j - h, k - i)
        }
        return PIXI.EarCut.earcutLinked(f, g, c, h, i, n), g
    }, PIXI.EarCut.linkedList = function (a, b, c, d, e) {
        var f, g, h, i = 0;
        for (f = b, g = c - d; c > f; f += d)i += (a[g] - a[f]) * (a[f + 1] + a[g + 1]), g = f;
        if (e === i > 0)for (f = b; c > f; f += d)h = PIXI.EarCut.insertNode(f, a[f], a[f + 1], h); else for (f = c - d; f >= b; f -= d)h = PIXI.EarCut.insertNode(f, a[f], a[f + 1], h);
        return h
    }, PIXI.EarCut.filterPoints = function (a, b) {
        if (!a)return a;
        b || (b = a);
        var c, d = a;
        do if (c = !1, d.steiner || !PIXI.EarCut.equals(d, d.next) && 0 !== PIXI.EarCut.area(d.prev, d, d.next))d = d.next; else {
            if (PIXI.EarCut.removeNode(d), d = b = d.prev, d === d.next)return null;
            c = !0
        } while (c || d !== b);
        return b
    }, PIXI.EarCut.earcutLinked = function (a, b, c, d, e, f, g) {
        if (a) {
            !g && f && PIXI.EarCut.indexCurve(a, d, e, f);
            for (var h, i, j = a; a.prev !== a.next;)if (h = a.prev, i = a.next, f ? PIXI.EarCut.isEarHashed(a, d, e, f) : PIXI.EarCut.isEar(a))b.push(h.i / c), b.push(a.i / c), b.push(i.i / c), PIXI.EarCut.removeNode(a), a = i.next, j = i.next; else if (a = i, a === j) {
                g ? 1 === g ? (a = PIXI.EarCut.cureLocalIntersections(a, b, c), PIXI.EarCut.earcutLinked(a, b, c, d, e, f, 2)) : 2 === g && PIXI.EarCut.splitEarcut(a, b, c, d, e, f) : PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(a), b, c, d, e, f, 1);
                break
            }
        }
    }, PIXI.EarCut.isEar = function (a) {
        var b = a.prev, c = a, d = a.next;
        if (PIXI.EarCut.area(b, c, d) >= 0)return !1;
        for (var e = a.next.next; e !== a.prev;) {
            if (PIXI.EarCut.pointInTriangle(b.x, b.y, c.x, c.y, d.x, d.y, e.x, e.y) && PIXI.EarCut.area(e.prev, e, e.next) >= 0)return !1;
            e = e.next
        }
        return !0
    }, PIXI.EarCut.isEarHashed = function (a, b, c, d) {
        var e = a.prev, f = a, g = a.next;
        if (PIXI.EarCut.area(e, f, g) >= 0)return !1;
        for (var h = e.x < f.x ? e.x < g.x ? e.x : g.x : f.x < g.x ? f.x : g.x, i = e.y < f.y ? e.y < g.y ? e.y : g.y : f.y < g.y ? f.y : g.y, j = e.x > f.x ? e.x > g.x ? e.x : g.x : f.x > g.x ? f.x : g.x, k = e.y > f.y ? e.y > g.y ? e.y : g.y : f.y > g.y ? f.y : g.y, l = PIXI.EarCut.zOrder(h, i, b, c, d), m = PIXI.EarCut.zOrder(j, k, b, c, d), n = a.nextZ; n && n.z <= m;) {
            if (n !== a.prev && n !== a.next && PIXI.EarCut.pointInTriangle(e.x, e.y, f.x, f.y, g.x, g.y, n.x, n.y) && PIXI.EarCut.area(n.prev, n, n.next) >= 0)return !1;
            n = n.nextZ
        }
        for (n = a.prevZ; n && n.z >= l;) {
            if (n !== a.prev && n !== a.next && PIXI.EarCut.pointInTriangle(e.x, e.y, f.x, f.y, g.x, g.y, n.x, n.y) && PIXI.EarCut.area(n.prev, n, n.next) >= 0)return !1;
            n = n.prevZ
        }
        return !0
    }, PIXI.EarCut.cureLocalIntersections = function (a, b, c) {
        var d = a;
        do {
            var e = d.prev, f = d.next.next;
            PIXI.EarCut.intersects(e, d, d.next, f) && PIXI.EarCut.locallyInside(e, f) && PIXI.EarCut.locallyInside(f, e) && (b.push(e.i / c), b.push(d.i / c), b.push(f.i / c), PIXI.EarCut.removeNode(d), PIXI.EarCut.removeNode(d.next), d = a = f), d = d.next
        } while (d !== a);
        return d
    }, PIXI.EarCut.splitEarcut = function (a, b, c, d, e, f) {
        var g = a;
        do {
            for (var h = g.next.next; h !== g.prev;) {
                if (g.i !== h.i && PIXI.EarCut.isValidDiagonal(g, h)) {
                    var i = PIXI.EarCut.splitPolygon(g, h);
                    return g = PIXI.EarCut.filterPoints(g, g.next), i = PIXI.EarCut.filterPoints(i, i.next), PIXI.EarCut.earcutLinked(g, b, c, d, e, f), void PIXI.EarCut.earcutLinked(i, b, c, d, e, f)
                }
                h = h.next
            }
            g = g.next
        } while (g !== a)
    }, PIXI.EarCut.eliminateHoles = function (a, b, c, d) {
        var e, f, g, h, i, j = [];
        for (e = 0, f = b.length; f > e; e++)g = b[e] * d, h = f - 1 > e ? b[e + 1] * d : a.length, i = PIXI.EarCut.linkedList(a, g, h, d, !1), i === i.next && (i.steiner = !0), j.push(PIXI.EarCut.getLeftmost(i));
        for (j.sort(compareX), e = 0; e < j.length; e++)PIXI.EarCut.eliminateHole(j[e], c), c = PIXI.EarCut.filterPoints(c, c.next);
        return c
    }, PIXI.EarCut.compareX = function (a, b) {
        return a.x - b.x
    }, PIXI.EarCut.eliminateHole = function (a, b) {
        if (b = PIXI.EarCut.findHoleBridge(a, b)) {
            var c = PIXI.EarCut.splitPolygon(b, a);
            PIXI.EarCut.filterPoints(c, c.next)
        }
    }, PIXI.EarCut.findHoleBridge = function (a, b) {
        var c, d = b, e = a.x, f = a.y, g = -(1 / 0);
        do {
            if (f <= d.y && f >= d.next.y) {
                var h = d.x + (f - d.y) * (d.next.x - d.x) / (d.next.y - d.y);
                e >= h && h > g && (g = h, c = d.x < d.next.x ? d : d.next)
            }
            d = d.next
        } while (d !== b);
        if (!c)return null;
        if (a.x === c.x)return c.prev;
        var i, j = c, k = 1 / 0;
        for (d = c.next; d !== j;)e >= d.x && d.x >= c.x && PIXI.EarCut.pointInTriangle(f < c.y ? e : g, f, c.x, c.y, f < c.y ? g : e, f, d.x, d.y) && (i = Math.abs(f - d.y) / (e - d.x), (k > i || i === k && d.x > c.x) && PIXI.EarCut.locallyInside(d, a) && (c = d, k = i)), d = d.next;
        return c
    }, PIXI.EarCut.indexCurve = function (a, b, c, d) {
        var e = a;
        do null === e.z && (e.z = PIXI.EarCut.zOrder(e.x, e.y, b, c, d)), e.prevZ = e.prev, e.nextZ = e.next, e = e.next; while (e !== a);
        e.prevZ.nextZ = null, e.prevZ = null, PIXI.EarCut.sortLinked(e)
    }, PIXI.EarCut.sortLinked = function (a) {
        var b, c, d, e, f, g, h, i, j = 1;
        do {
            for (c = a, a = null, f = null, g = 0; c;) {
                for (g++, d = c, h = 0, b = 0; j > b && (h++, d = d.nextZ, d); b++);
                for (i = j; h > 0 || i > 0 && d;)0 === h ? (e = d, d = d.nextZ, i--) : 0 !== i && d ? c.z <= d.z ? (e = c, c = c.nextZ, h--) : (e = d, d = d.nextZ, i--) : (e = c, c = c.nextZ, h--), f ? f.nextZ = e : a = e, e.prevZ = f, f = e;
                c = d
            }
            f.nextZ = null, j *= 2
        } while (g > 1);
        return a
    }, PIXI.EarCut.zOrder = function (a, b, c, d, e) {
        return a = 32767 * (a - c) / e, b = 32767 * (b - d) / e, a = 16711935 & (a | a << 8), a = 252645135 & (a | a << 4), a = 858993459 & (a | a << 2), a = 1431655765 & (a | a << 1), b = 16711935 & (b | b << 8), b = 252645135 & (b | b << 4), b = 858993459 & (b | b << 2), b = 1431655765 & (b | b << 1), a | b << 1
    }, PIXI.EarCut.getLeftmost = function (a) {
        var b = a, c = a;
        do b.x < c.x && (c = b), b = b.next; while (b !== a);
        return c
    }, PIXI.EarCut.pointInTriangle = function (a, b, c, d, e, f, g, h) {
        return (e - g) * (b - h) - (a - g) * (f - h) >= 0 && (a - g) * (d - h) - (c - g) * (b - h) >= 0 && (c - g) * (f - h) - (e - g) * (d - h) >= 0
    }, PIXI.EarCut.isValidDiagonal = function (a, b) {
        return PIXI.EarCut.equals(a, b) || a.next.i !== b.i && a.prev.i !== b.i && !PIXI.EarCut.intersectsPolygon(a, b) && PIXI.EarCut.locallyInside(a, b) && PIXI.EarCut.locallyInside(b, a) && PIXI.EarCut.middleInside(a, b)
    }, PIXI.EarCut.area = function (a, b, c) {
        return (b.y - a.y) * (c.x - b.x) - (b.x - a.x) * (c.y - b.y)
    }, PIXI.EarCut.equals = function (a, b) {
        return a.x === b.x && a.y === b.y
    }, PIXI.EarCut.intersects = function (a, b, c, d) {
        return PIXI.EarCut.area(a, b, c) > 0 != PIXI.EarCut.area(a, b, d) > 0 && PIXI.EarCut.area(c, d, a) > 0 != PIXI.EarCut.area(c, d, b) > 0
    }, PIXI.EarCut.intersectsPolygon = function (a, b) {
        var c = a;
        do {
            if (c.i !== a.i && c.next.i !== a.i && c.i !== b.i && c.next.i !== b.i && PIXI.EarCut.intersects(c, c.next, a, b))return !0;
            c = c.next
        } while (c !== a);
        return !1
    }, PIXI.EarCut.locallyInside = function (a, b) {
        return PIXI.EarCut.area(a.prev, a, a.next) < 0 ? PIXI.EarCut.area(a, b, a.next) >= 0 && PIXI.EarCut.area(a, a.prev, b) >= 0 : PIXI.EarCut.area(a, b, a.prev) < 0 || PIXI.EarCut.area(a, a.next, b) < 0
    }, PIXI.EarCut.middleInside = function (a, b) {
        var c = a, d = !1, e = (a.x + b.x) / 2, f = (a.y + b.y) / 2;
        do c.y > f != c.next.y > f && e < (c.next.x - c.x) * (f - c.y) / (c.next.y - c.y) + c.x && (d = !d), c = c.next; while (c !== a);
        return d
    }, PIXI.EarCut.splitPolygon = function (a, b) {
        var c = new PIXI.EarCut.Node(a.i, a.x, a.y), d = new PIXI.EarCut.Node(b.i, b.x, b.y), e = a.next, f = b.prev;
        return a.next = b, b.prev = a, c.next = e, e.prev = c, d.next = c, c.prev = d, f.next = d, d.prev = f, d
    }, PIXI.EarCut.insertNode = function (a, b, c, d) {
        var e = new PIXI.EarCut.Node(a, b, c);
        return d ? (e.next = d.next, e.prev = d, d.next.prev = e, d.next = e) : (e.prev = e, e.next = e), e
    }, PIXI.EarCut.removeNode = function (a) {
        a.next.prev = a.prev, a.prev.next = a.next, a.prevZ && (a.prevZ.nextZ = a.nextZ), a.nextZ && (a.nextZ.prevZ = a.prevZ)
    }, PIXI.EarCut.Node = function (a, b, c) {
        this.i = a, this.x = b, this.y = c, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1
    }, PIXI.WebGLGraphics = function () {
    }, PIXI.WebGLGraphics.stencilBufferLimit = 6, PIXI.WebGLGraphics.renderGraphics = function (a, b) {
        var c, d = b.gl, e = b.projection, f = b.offset, g = b.shaderManager.primitiveShader;
        a.dirty && PIXI.WebGLGraphics.updateGraphics(a, d);
        for (var h = a._webGL[d.id], i = 0; i < h.data.length; i++)1 === h.data[i].mode ? (c = h.data[i], b.stencilManager.pushStencil(a, c, b), d.drawElements(d.TRIANGLE_FAN, 4, d.UNSIGNED_SHORT, 2 * (c.indices.length - 4)), b.stencilManager.popStencil(a, c, b)) : (c = h.data[i], b.shaderManager.setShader(g), g = b.shaderManager.primitiveShader, d.uniformMatrix3fv(g.translationMatrix, !1, a.worldTransform.toArray(!0)), d.uniform1f(g.flipY, 1), d.uniform2f(g.projectionVector, e.x, -e.y), d.uniform2f(g.offsetVector, -f.x, -f.y), d.uniform3fv(g.tintColor, PIXI.hex2rgb(a.tint)), d.uniform1f(g.alpha, a.worldAlpha), d.bindBuffer(d.ARRAY_BUFFER, c.buffer), d.vertexAttribPointer(g.aVertexPosition, 2, d.FLOAT, !1, 24, 0), d.vertexAttribPointer(g.colorAttribute, 4, d.FLOAT, !1, 24, 8), d.bindBuffer(d.ELEMENT_ARRAY_BUFFER, c.indexBuffer), d.drawElements(d.TRIANGLE_STRIP, c.indices.length, d.UNSIGNED_SHORT, 0))
    }, PIXI.WebGLGraphics.updateGraphics = function (a, b) {
        var c = a._webGL[b.id];
        c || (c = a._webGL[b.id] = {lastIndex: 0, data: [], gl: b}), a.dirty = !1;
        var d;
        if (a.clearDirty) {
            for (a.clearDirty = !1, d = 0; d < c.data.length; d++) {
                var e = c.data[d];
                e.reset(), PIXI.WebGLGraphics.graphicsDataPool.push(e)
            }
            c.data = [], c.lastIndex = 0
        }
        var f;
        for (d = c.lastIndex; d < a.graphicsData.length; d++) {
            var g = a.graphicsData[d];
            if (g.type === PIXI.Graphics.POLY) {
                if (g.points = g.shape.points.slice(), g.shape.closed && (g.points[0] !== g.points[g.points.length - 2] || g.points[1] !== g.points[g.points.length - 1]) && g.points.push(g.points[0], g.points[1]), g.fill && g.points.length >= PIXI.WebGLGraphics.stencilBufferLimit)if (g.points.length < 2 * PIXI.WebGLGraphics.stencilBufferLimit) {
                    f = PIXI.WebGLGraphics.switchMode(c, 0);
                    var h = PIXI.WebGLGraphics.buildPoly(g, f);
                    h || (f = PIXI.WebGLGraphics.switchMode(c, 1), PIXI.WebGLGraphics.buildComplexPoly(g, f))
                } else f = PIXI.WebGLGraphics.switchMode(c, 1), PIXI.WebGLGraphics.buildComplexPoly(g, f);
                g.lineWidth > 0 && (f = PIXI.WebGLGraphics.switchMode(c, 0), PIXI.WebGLGraphics.buildLine(g, f))
            } else f = PIXI.WebGLGraphics.switchMode(c, 0), g.type === PIXI.Graphics.RECT ? PIXI.WebGLGraphics.buildRectangle(g, f) : g.type === PIXI.Graphics.CIRC || g.type === PIXI.Graphics.ELIP ? PIXI.WebGLGraphics.buildCircle(g, f) : g.type === PIXI.Graphics.RREC && PIXI.WebGLGraphics.buildRoundedRectangle(g, f);
            c.lastIndex++
        }
        for (d = 0; d < c.data.length; d++)f = c.data[d], f.dirty && f.upload()
    }, PIXI.WebGLGraphics.switchMode = function (a, b) {
        var c;
        return a.data.length ? (c = a.data[a.data.length - 1], (c.mode !== b || 1 === b) && (c = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(a.gl), c.mode = b, a.data.push(c))) : (c = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(a.gl), c.mode = b, a.data.push(c)), c.dirty = !0, c
    }, PIXI.WebGLGraphics.buildRectangle = function (a, b) {
        var c = a.shape, d = c.x, e = c.y, f = c.width, g = c.height;
        if (a.fill) {
            var h = PIXI.hex2rgb(a.fillColor), i = a.fillAlpha, j = h[0] * i, k = h[1] * i, l = h[2] * i, m = b.points, n = b.indices, o = m.length / 6;
            m.push(d, e), m.push(j, k, l, i), m.push(d + f, e), m.push(j, k, l, i), m.push(d, e + g), m.push(j, k, l, i), m.push(d + f, e + g), m.push(j, k, l, i), n.push(o, o, o + 1, o + 2, o + 3, o + 3)
        }
        if (a.lineWidth) {
            var p = a.points;
            a.points = [d, e, d + f, e, d + f, e + g, d, e + g, d, e], PIXI.WebGLGraphics.buildLine(a, b), a.points = p
        }
    }, PIXI.WebGLGraphics.buildRoundedRectangle = function (a, b) {
        var c = a.shape, d = c.x, e = c.y, f = c.width, g = c.height, h = c.radius, i = [];
        if (i.push(d, e + h), i = i.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d, e + g - h, d, e + g, d + h, e + g)), i = i.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d + f - h, e + g, d + f, e + g, d + f, e + g - h)), i = i.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d + f, e + h, d + f, e, d + f - h, e)), i = i.concat(PIXI.WebGLGraphics.quadraticBezierCurve(d + h, e, d, e, d, e + h)), a.fill) {
            var j = PIXI.hex2rgb(a.fillColor), k = a.fillAlpha, l = j[0] * k, m = j[1] * k, n = j[2] * k, o = b.points, p = b.indices, q = o.length / 6, r = PIXI.EarCut.Triangulate(i, null, 2), s = 0;
            for (s = 0; s < r.length; s += 3)p.push(r[s] + q), p.push(r[s] + q), p.push(r[s + 1] + q), p.push(r[s + 2] + q), p.push(r[s + 2] + q);
            for (s = 0; s < i.length; s++)o.push(i[s], i[++s], l, m, n, k)
        }
        if (a.lineWidth) {
            var t = a.points;
            a.points = i, PIXI.WebGLGraphics.buildLine(a, b), a.points = t
        }
    }, PIXI.WebGLGraphics.quadraticBezierCurve = function (a, b, c, d, e, f) {
        function g(a, b, c) {
            var d = b - a;
            return a + d * c
        }

        for (var h, i, j, k, l, m, n = 20, o = [], p = 0, q = 0; n >= q; q++)p = q / n, h = g(a, c, p), i = g(b, d, p), j = g(c, e, p), k = g(d, f, p), l = g(h, j, p), m = g(i, k, p), o.push(l, m);
        return o
    }, PIXI.WebGLGraphics.buildCircle = function (a, b) {
        var c, d, e = a.shape, f = e.x, g = e.y;
        a.type === PIXI.Graphics.CIRC ? (c = e.radius, d = e.radius) : (c = e.width, d = e.height);
        var h = 40, i = 2 * Math.PI / h, j = 0;
        if (a.fill) {
            var k = PIXI.hex2rgb(a.fillColor), l = a.fillAlpha, m = k[0] * l, n = k[1] * l, o = k[2] * l, p = b.points, q = b.indices, r = p.length / 6;
            for (q.push(r), j = 0; h + 1 > j; j++)p.push(f, g, m, n, o, l), p.push(f + Math.sin(i * j) * c, g + Math.cos(i * j) * d, m, n, o, l), q.push(r++, r++);
            q.push(r - 1)
        }
        if (a.lineWidth) {
            var s = a.points;
            for (a.points = [], j = 0; h + 1 > j; j++)a.points.push(f + Math.sin(i * j) * c, g + Math.cos(i * j) * d);
            PIXI.WebGLGraphics.buildLine(a, b), a.points = s
        }
    }, PIXI.WebGLGraphics.buildLine = function (a, b) {
        var c = 0, d = a.points;
        if (0 !== d.length) {
            if (a.lineWidth % 2)for (c = 0; c < d.length; c++)d[c] += .5;
            var e = new PIXI.Point(d[0], d[1]), f = new PIXI.Point(d[d.length - 2], d[d.length - 1]);
            if (e.x === f.x && e.y === f.y) {
                d = d.slice(), d.pop(), d.pop(), f = new PIXI.Point(d[d.length - 2], d[d.length - 1]);
                var g = f.x + .5 * (e.x - f.x), h = f.y + .5 * (e.y - f.y);
                d.unshift(g, h), d.push(g, h)
            }
            var i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F = b.points, G = b.indices, H = d.length / 2, I = d.length, J = F.length / 6, K = a.lineWidth / 2, L = PIXI.hex2rgb(a.lineColor), M = a.lineAlpha, N = L[0] * M, O = L[1] * M, P = L[2] * M;
            for (k = d[0], l = d[1], m = d[2], n = d[3], q = -(l - n), r = k - m, E = Math.sqrt(q * q + r * r), q /= E, r /= E, q *= K, r *= K, F.push(k - q, l - r, N, O, P, M), F.push(k + q, l + r, N, O, P, M), c = 1; H - 1 > c; c++)k = d[2 * (c - 1)], l = d[2 * (c - 1) + 1], m = d[2 * c], n = d[2 * c + 1], o = d[2 * (c + 1)], p = d[2 * (c + 1) + 1], q = -(l - n), r = k - m, E = Math.sqrt(q * q + r * r),
                q /= E, r /= E, q *= K, r *= K, s = -(n - p), t = m - o, E = Math.sqrt(s * s + t * t), s /= E, t /= E, s *= K, t *= K, w = -r + l - (-r + n), x = -q + m - (-q + k), y = (-q + k) * (-r + n) - (-q + m) * (-r + l), z = -t + p - (-t + n), A = -s + m - (-s + o), B = (-s + o) * (-t + n) - (-s + m) * (-t + p), C = w * A - z * x, Math.abs(C) < .1 ? (C += 10.1, F.push(m - q, n - r, N, O, P, M), F.push(m + q, n + r, N, O, P, M)) : (i = (x * B - A * y) / C, j = (z * y - w * B) / C, D = (i - m) * (i - m) + (j - n) + (j - n), D > 19600 ? (u = q - s, v = r - t, E = Math.sqrt(u * u + v * v), u /= E, v /= E, u *= K, v *= K, F.push(m - u, n - v), F.push(N, O, P, M), F.push(m + u, n + v), F.push(N, O, P, M), F.push(m - u, n - v), F.push(N, O, P, M), I++) : (F.push(i, j), F.push(N, O, P, M), F.push(m - (i - m), n - (j - n)), F.push(N, O, P, M)));
            for (k = d[2 * (H - 2)], l = d[2 * (H - 2) + 1], m = d[2 * (H - 1)], n = d[2 * (H - 1) + 1], q = -(l - n), r = k - m, E = Math.sqrt(q * q + r * r), q /= E, r /= E, q *= K, r *= K, F.push(m - q, n - r), F.push(N, O, P, M), F.push(m + q, n + r), F.push(N, O, P, M), G.push(J), c = 0; I > c; c++)G.push(J++);
            G.push(J - 1)
        }
    }, PIXI.WebGLGraphics.buildComplexPoly = function (a, b) {
        var c = a.points.slice();
        if (!(c.length < 6)) {
            var d = b.indices;
            b.points = c, b.alpha = a.fillAlpha, b.color = PIXI.hex2rgb(a.fillColor);
            for (var e, f, g = 1 / 0, h = -(1 / 0), i = 1 / 0, j = -(1 / 0), k = 0; k < c.length; k += 2)e = c[k], f = c[k + 1], g = g > e ? e : g, h = e > h ? e : h, i = i > f ? f : i, j = f > j ? f : j;
            c.push(g, i, h, i, h, j, g, j);
            var l = c.length / 2;
            for (k = 0; l > k; k++)d.push(k)
        }
    },PIXI.WebGLGraphics.buildPoly = function (a, b) {
        var c = a.points;
        if (!(c.length < 6)) {
            var d = b.points, e = b.indices, f = c.length / 2, g = PIXI.hex2rgb(a.fillColor), h = a.fillAlpha, i = g[0] * h, j = g[1] * h, k = g[2] * h, l = PIXI.EarCut.Triangulate(c, null, 2);
            if (!l)return !1;
            var m = d.length / 6, n = 0;
            for (n = 0; n < l.length; n += 3)e.push(l[n] + m), e.push(l[n] + m), e.push(l[n + 1] + m), e.push(l[n + 2] + m), e.push(l[n + 2] + m);
            for (n = 0; f > n; n++)d.push(c[2 * n], c[2 * n + 1], i, j, k, h);
            return !0
        }
    },PIXI.WebGLGraphics.graphicsDataPool = [],PIXI.WebGLGraphicsData = function (a) {
        this.gl = a, this.color = [0, 0, 0], this.points = [], this.indices = [], this.buffer = a.createBuffer(), this.indexBuffer = a.createBuffer(), this.mode = 1, this.alpha = 1, this.dirty = !0
    },PIXI.WebGLGraphicsData.prototype.reset = function () {
        this.points = [], this.indices = []
    },PIXI.WebGLGraphicsData.prototype.upload = function () {
        var a = this.gl;
        this.glPoints = new PIXI.Float32Array(this.points), a.bindBuffer(a.ARRAY_BUFFER, this.buffer), a.bufferData(a.ARRAY_BUFFER, this.glPoints, a.STATIC_DRAW), this.glIndicies = new PIXI.Uint16Array(this.indices), a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.indexBuffer), a.bufferData(a.ELEMENT_ARRAY_BUFFER, this.glIndicies, a.STATIC_DRAW), this.dirty = !1
    },PIXI.CanvasGraphics = function () {
    },PIXI.CanvasGraphics.renderGraphics = function (a, b) {
        var c = a.worldAlpha;
        a.dirty && (this.updateGraphicsTint(a), a.dirty = !1);
        for (var d = 0; d < a.graphicsData.length; d++) {
            var e = a.graphicsData[d], f = e.shape, g = e._fillTint, h = e._lineTint;
            if (b.lineWidth = e.lineWidth, e.type === PIXI.Graphics.POLY) {
                b.beginPath();
                var i = f.points;
                b.moveTo(i[0], i[1]);
                for (var j = 1; j < i.length / 2; j++)b.lineTo(i[2 * j], i[2 * j + 1]);
                f.closed && b.lineTo(i[0], i[1]), i[0] === i[i.length - 2] && i[1] === i[i.length - 1] && b.closePath(), e.fill && (b.globalAlpha = e.fillAlpha * c, b.fillStyle = "#" + ("00000" + (0 | g).toString(16)).substr(-6), b.fill()), e.lineWidth && (b.globalAlpha = e.lineAlpha * c, b.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), b.stroke())
            } else if (e.type === PIXI.Graphics.RECT)(e.fillColor || 0 === e.fillColor) && (b.globalAlpha = e.fillAlpha * c, b.fillStyle = "#" + ("00000" + (0 | g).toString(16)).substr(-6), b.fillRect(f.x, f.y, f.width, f.height)), e.lineWidth && (b.globalAlpha = e.lineAlpha * c, b.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), b.strokeRect(f.x, f.y, f.width, f.height)); else if (e.type === PIXI.Graphics.CIRC)b.beginPath(), b.arc(f.x, f.y, f.radius, 0, 2 * Math.PI), b.closePath(), e.fill && (b.globalAlpha = e.fillAlpha * c, b.fillStyle = "#" + ("00000" + (0 | g).toString(16)).substr(-6), b.fill()), e.lineWidth && (b.globalAlpha = e.lineAlpha * c, b.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), b.stroke()); else if (e.type === PIXI.Graphics.ELIP) {
                var k = 2 * f.width, l = 2 * f.height, m = f.x - k / 2, n = f.y - l / 2;
                b.beginPath();
                var o = .5522848, p = k / 2 * o, q = l / 2 * o, r = m + k, s = n + l, t = m + k / 2, u = n + l / 2;
                b.moveTo(m, u), b.bezierCurveTo(m, u - q, t - p, n, t, n), b.bezierCurveTo(t + p, n, r, u - q, r, u), b.bezierCurveTo(r, u + q, t + p, s, t, s), b.bezierCurveTo(t - p, s, m, u + q, m, u), b.closePath(), e.fill && (b.globalAlpha = e.fillAlpha * c, b.fillStyle = "#" + ("00000" + (0 | g).toString(16)).substr(-6), b.fill()), e.lineWidth && (b.globalAlpha = e.lineAlpha * c, b.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), b.stroke())
            } else if (e.type === PIXI.Graphics.RREC) {
                var v = f.x, w = f.y, x = f.width, y = f.height, z = f.radius, A = Math.min(x, y) / 2 | 0;
                z = z > A ? A : z, b.beginPath(), b.moveTo(v, w + z), b.lineTo(v, w + y - z), b.quadraticCurveTo(v, w + y, v + z, w + y), b.lineTo(v + x - z, w + y), b.quadraticCurveTo(v + x, w + y, v + x, w + y - z), b.lineTo(v + x, w + z), b.quadraticCurveTo(v + x, w, v + x - z, w), b.lineTo(v + z, w), b.quadraticCurveTo(v, w, v, w + z), b.closePath(), (e.fillColor || 0 === e.fillColor) && (b.globalAlpha = e.fillAlpha * c, b.fillStyle = "#" + ("00000" + (0 | g).toString(16)).substr(-6), b.fill()), e.lineWidth && (b.globalAlpha = e.lineAlpha * c, b.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), b.stroke())
            }
        }
    },PIXI.CanvasGraphics.renderGraphicsMask = function (a, b) {
        var c = a.graphicsData.length;
        if (0 !== c) {
            b.beginPath();
            for (var d = 0; c > d; d++) {
                var e = a.graphicsData[d], f = e.shape;
                if (e.type === PIXI.Graphics.POLY) {
                    var g = f.points;
                    b.moveTo(g[0], g[1]);
                    for (var h = 1; h < g.length / 2; h++)b.lineTo(g[2 * h], g[2 * h + 1]);
                    g[0] === g[g.length - 2] && g[1] === g[g.length - 1] && b.closePath()
                } else if (e.type === PIXI.Graphics.RECT)b.rect(f.x, f.y, f.width, f.height), b.closePath(); else if (e.type === PIXI.Graphics.CIRC)b.arc(f.x, f.y, f.radius, 0, 2 * Math.PI), b.closePath(); else if (e.type === PIXI.Graphics.ELIP) {
                    var i = 2 * f.width, j = 2 * f.height, k = f.x - i / 2, l = f.y - j / 2, m = .5522848, n = i / 2 * m, o = j / 2 * m, p = k + i, q = l + j, r = k + i / 2, s = l + j / 2;
                    b.moveTo(k, s), b.bezierCurveTo(k, s - o, r - n, l, r, l), b.bezierCurveTo(r + n, l, p, s - o, p, s), b.bezierCurveTo(p, s + o, r + n, q, r, q), b.bezierCurveTo(r - n, q, k, s + o, k, s), b.closePath()
                } else if (e.type === PIXI.Graphics.RREC) {
                    var t = f.x, u = f.y, v = f.width, w = f.height, x = f.radius, y = Math.min(v, w) / 2 | 0;
                    x = x > y ? y : x, b.moveTo(t, u + x), b.lineTo(t, u + w - x), b.quadraticCurveTo(t, u + w, t + x, u + w), b.lineTo(t + v - x, u + w), b.quadraticCurveTo(t + v, u + w, t + v, u + w - x), b.lineTo(t + v, u + x), b.quadraticCurveTo(t + v, u, t + v - x, u), b.lineTo(t + x, u), b.quadraticCurveTo(t, u, t, u + x), b.closePath()
                }
            }
        }
    },PIXI.CanvasGraphics.updateGraphicsTint = function (a) {
        if (16777215 !== a.tint)for (var b = (a.tint >> 16 & 255) / 255, c = (a.tint >> 8 & 255) / 255, d = (255 & a.tint) / 255, e = 0; e < a.graphicsData.length; e++) {
            var f = a.graphicsData[e], g = 0 | f.fillColor, h = 0 | f.lineColor;
            f._fillTint = ((g >> 16 & 255) / 255 * b * 255 << 16) + ((g >> 8 & 255) / 255 * c * 255 << 8) + (255 & g) / 255 * d * 255, f._lineTint = ((h >> 16 & 255) / 255 * b * 255 << 16) + ((h >> 8 & 255) / 255 * c * 255 << 8) + (255 & h) / 255 * d * 255
        }
    },c.Graphics = function (a, b, d) {
        void 0 === b && (b = 0), void 0 === d && (d = 0), this.type = c.GRAPHICS, this.physicsType = c.SPRITE, this.anchor = new c.Point, PIXI.Graphics.call(this), c.Component.Core.init.call(this, a, b, d, "", null)
    },c.Graphics.prototype = Object.create(PIXI.Graphics.prototype),c.Graphics.prototype.constructor = c.Graphics,c.Component.Core.install.call(c.Graphics.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]),c.Graphics.prototype.preUpdatePhysics = c.Component.PhysicsBody.preUpdate,c.Graphics.prototype.preUpdateLifeSpan = c.Component.LifeSpan.preUpdate,c.Graphics.prototype.preUpdateInWorld = c.Component.InWorld.preUpdate,c.Graphics.prototype.preUpdateCore = c.Component.Core.preUpdate,c.Graphics.prototype.preUpdate = function () {
        return this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld() ? this.preUpdateCore() : !1
    },c.Graphics.prototype.destroy = function (a) {
        this.clear(), c.Component.Destroy.prototype.destroy.call(this, a)
    },c.Graphics.prototype.drawTriangle = function (a, b) {
        void 0 === b && (b = !1);
        var d = new c.Polygon(a);
        if (b) {
            var e = new c.Point(this.game.camera.x - a[0].x, this.game.camera.y - a[0].y), f = new c.Point(a[1].x - a[0].x, a[1].y - a[0].y), g = new c.Point(a[1].x - a[2].x, a[1].y - a[2].y), h = g.cross(f);
            e.dot(h) > 0 && this.drawPolygon(d)
        } else this.drawPolygon(d)
    },c.Graphics.prototype.drawTriangles = function (a, b, d) {
        void 0 === d && (d = !1);
        var e, f = new c.Point, g = new c.Point, h = new c.Point, i = [];
        if (b)if (a[0] instanceof c.Point)for (e = 0; e < b.length / 3; e++)i.push(a[b[3 * e]]), i.push(a[b[3 * e + 1]]), i.push(a[b[3 * e + 2]]), 3 === i.length && (this.drawTriangle(i, d), i = []); else for (e = 0; e < b.length; e++)f.x = a[2 * b[e]], f.y = a[2 * b[e] + 1], i.push(f.copyTo({})), 3 === i.length && (this.drawTriangle(i, d), i = []); else if (a[0] instanceof c.Point)for (e = 0; e < a.length / 3; e++)this.drawTriangle([a[3 * e], a[3 * e + 1], a[3 * e + 2]], d); else for (e = 0; e < a.length / 6; e++)f.x = a[6 * e + 0], f.y = a[6 * e + 1], g.x = a[6 * e + 2], g.y = a[6 * e + 3], h.x = a[6 * e + 4], h.y = a[6 * e + 5], this.drawTriangle([f, g, h], d)
    },c.RenderTexture = function (a, b, d, e, f, g) {
        void 0 === e && (e = ""), void 0 === f && (f = c.scaleModes.DEFAULT), void 0 === g && (g = 1), this.game = a, this.key = e, this.type = c.RENDERTEXTURE, this._tempMatrix = new PIXI.Matrix, PIXI.RenderTexture.call(this, b, d, this.game.renderer, f, g), this.render = c.RenderTexture.prototype.render
    },c.RenderTexture.prototype = Object.create(PIXI.RenderTexture.prototype),c.RenderTexture.prototype.constructor = c.RenderTexture,c.RenderTexture.prototype.renderXY = function (a, b, c, d) {
        a.updateTransform(), this._tempMatrix.copyFrom(a.worldTransform), this._tempMatrix.tx = b, this._tempMatrix.ty = c, this.renderer.type === PIXI.WEBGL_RENDERER ? this.renderWebGL(a, this._tempMatrix, d) : this.renderCanvas(a, this._tempMatrix, d)
    },c.RenderTexture.prototype.renderRawXY = function (a, b, c, d) {
        this._tempMatrix.identity().translate(b, c), this.renderer.type === PIXI.WEBGL_RENDERER ? this.renderWebGL(a, this._tempMatrix, d) : this.renderCanvas(a, this._tempMatrix, d)
    },c.RenderTexture.prototype.render = function (a, b, c) {
        void 0 === b || null === b ? this._tempMatrix.copyFrom(a.worldTransform) : this._tempMatrix.copyFrom(b), this.renderer.type === PIXI.WEBGL_RENDERER ? this.renderWebGL(a, this._tempMatrix, c) : this.renderCanvas(a, this._tempMatrix, c)
    },c.Text = function (a, b, d, e, f) {
        b = b || 0, d = d || 0, e = void 0 === e || null === e ? "" : e.toString(), f = c.Utils.extend({}, f), this.type = c.TEXT, this.physicsType = c.SPRITE, this.padding = new c.Point, this.textBounds = null, this.canvas = PIXI.CanvasPool.create(this), this.context = this.canvas.getContext("2d"), this.colors = [], this.strokeColors = [], this.fontStyles = [], this.fontWeights = [], this.autoRound = !1, this.useAdvancedWrap = !1, this._res = a.renderer.resolution, this._text = e, this._fontComponents = null, this._lineSpacing = 0, this._charCount = 0, this._width = 0, this._height = 0, c.Sprite.call(this, a, b, d, PIXI.Texture.fromCanvas(this.canvas)), this.setStyle(f), "" !== e && this.updateText()
    },c.Text.prototype = Object.create(c.Sprite.prototype),c.Text.prototype.constructor = c.Text,c.Text.prototype.preUpdate = function () {
        return this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld() ? this.preUpdateCore() : !1
    },c.Text.prototype.update = function () {
    },c.Text.prototype.destroy = function (a) {
        this.texture.destroy(!0), PIXI.CanvasPool.remove(this), c.Component.Destroy.prototype.destroy.call(this, a)
    },c.Text.prototype.setShadow = function (a, b, c, d, e, f) {
        return void 0 === a && (a = 0), void 0 === b && (b = 0), void 0 === c && (c = "rgba(0, 0, 0, 1)"), void 0 === d && (d = 0), void 0 === e && (e = !0), void 0 === f && (f = !0), this.style.shadowOffsetX = a, this.style.shadowOffsetY = b, this.style.shadowColor = c, this.style.shadowBlur = d, this.style.shadowStroke = e, this.style.shadowFill = f, this.dirty = !0, this
    },c.Text.prototype.setStyle = function (a, b) {
        void 0 === b && (b = !1), a = a || {}, a.font = a.font || "bold 20pt Arial", a.backgroundColor = a.backgroundColor || null, a.fill = a.fill || "black", a.align = a.align || "left", a.boundsAlignH = a.boundsAlignH || "left", a.boundsAlignV = a.boundsAlignV || "top", a.stroke = a.stroke || "black", a.strokeThickness = a.strokeThickness || 0, a.wordWrap = a.wordWrap || !1, a.wordWrapWidth = a.wordWrapWidth || 100, a.maxLines = a.maxLines || 0, a.shadowOffsetX = a.shadowOffsetX || 0, a.shadowOffsetY = a.shadowOffsetY || 0, a.shadowColor = a.shadowColor || "rgba(0,0,0,0)", a.shadowBlur = a.shadowBlur || 0, a.tabs = a.tabs || 0;
        var c = this.fontToComponents(a.font);
        return a.fontStyle && (c.fontStyle = a.fontStyle), a.fontVariant && (c.fontVariant = a.fontVariant), a.fontWeight && (c.fontWeight = a.fontWeight), a.fontSize && ("number" == typeof a.fontSize && (a.fontSize = a.fontSize + "px"), c.fontSize = a.fontSize), this._fontComponents = c, a.font = this.componentsToFont(this._fontComponents), this.style = a, this.dirty = !0, b && this.updateText(), this
    },c.Text.prototype.updateText = function () {
        this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font;
        var a = this.text;
        this.style.wordWrap && (a = this.runWordWrap(this.text));
        var b = a.split(/(?:\r\n|\r|\n)/), c = this.style.tabs, d = [], e = 0, f = this.determineFontProperties(this.style.font), g = b.length;
        this.style.maxLines > 0 && this.style.maxLines < b.length && (g = this.style.maxLines), this._charCount = 0;
        for (var h = 0; g > h; h++) {
            if (0 === c) {
                var i = this.style.strokeThickness + this.padding.x;
                i += this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(b[h]) : this.context.measureText(b[h]).width, this.style.wordWrap && (i -= this.context.measureText(" ").width)
            } else {
                var j = b[h].split(/(?:\t)/), i = this.padding.x + this.style.strokeThickness;
                if (Array.isArray(c))for (var k = 0, l = 0; l < j.length; l++) {
                    var m = 0;
                    m = this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(j[l]) : Math.ceil(this.context.measureText(j[l]).width), l > 0 && (k += c[l - 1]), i = k + m
                } else for (var l = 0; l < j.length; l++) {
                    i += this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(j[l]) : Math.ceil(this.context.measureText(j[l]).width);
                    var n = this.game.math.snapToCeil(i, c) - i;
                    i += n
                }
            }
            d[h] = Math.ceil(i), e = Math.max(e, d[h])
        }
        this.canvas.width = e * this._res;
        var o = f.fontSize + this.style.strokeThickness + this.padding.y, p = o * g, q = this._lineSpacing;
        0 > q && Math.abs(q) > o && (q = -o), 0 !== q && (p += q > 0 ? q * b.length : q * (b.length - 1)), this.canvas.height = p * this._res, this.context.scale(this._res, this._res), navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height), this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor, this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)), this.context.fillStyle = this.style.fill, this.context.font = this.style.font, this.context.strokeStyle = this.style.stroke, this.context.textBaseline = "alphabetic", this.context.lineWidth = this.style.strokeThickness, this.context.lineCap = "round", this.context.lineJoin = "round";
        var r, s;
        for (this._charCount = 0, h = 0; g > h; h++)r = this.style.strokeThickness / 2, s = this.style.strokeThickness / 2 + h * o + f.ascent, h > 0 && (s += q * h), "right" === this.style.align ? r += e - d[h] : "center" === this.style.align && (r += (e - d[h]) / 2), this.autoRound && (r = Math.round(r), s = Math.round(s)), this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.updateLine(b[h], r, s) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke), 0 === c ? this.context.strokeText(b[h], r, s) : this.renderTabLine(b[h], r, s, !1)), this.style.fill && (this.updateShadow(this.style.shadowFill), 0 === c ? this.context.fillText(b[h], r, s) : this.renderTabLine(b[h], r, s, !0)));
        this.updateTexture()
    },c.Text.prototype.renderTabLine = function (a, b, c, d) {
        var e = a.split(/(?:\t)/), f = this.style.tabs, g = 0;
        if (Array.isArray(f))for (var h = 0, i = 0; i < e.length; i++)i > 0 && (h += f[i - 1]), g = b + h, d ? this.context.fillText(e[i], g, c) : this.context.strokeText(e[i], g, c); else for (var i = 0; i < e.length; i++) {
            var j = Math.ceil(this.context.measureText(e[i]).width);
            g = this.game.math.snapToCeil(b, f), d ? this.context.fillText(e[i], g, c) : this.context.strokeText(e[i], g, c), b = g + j
        }
    },c.Text.prototype.updateShadow = function (a) {
        a ? (this.context.shadowOffsetX = this.style.shadowOffsetX, this.context.shadowOffsetY = this.style.shadowOffsetY, this.context.shadowColor = this.style.shadowColor, this.context.shadowBlur = this.style.shadowBlur) : (this.context.shadowOffsetX = 0, this.context.shadowOffsetY = 0, this.context.shadowColor = 0, this.context.shadowBlur = 0)
    },c.Text.prototype.measureLine = function (a) {
        for (var b = 0, c = 0; c < a.length; c++) {
            var d = a[c];
            if (this.fontWeights.length > 0 || this.fontStyles.length > 0) {
                var e = this.fontToComponents(this.context.font);
                this.fontStyles[this._charCount] && (e.fontStyle = this.fontStyles[this._charCount]), this.fontWeights[this._charCount] && (e.fontWeight = this.fontWeights[this._charCount]), this.context.font = this.componentsToFont(e)
            }
            this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), this.updateShadow(this.style.shadowStroke)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), this.updateShadow(this.style.shadowFill)), b += this.context.measureText(d).width, this._charCount++
        }
        return Math.ceil(b)
    },c.Text.prototype.updateLine = function (a, b, c) {
        for (var d = 0; d < a.length; d++) {
            var e = a[d];
            if (this.fontWeights.length > 0 || this.fontStyles.length > 0) {
                var f = this.fontToComponents(this.context.font);
                this.fontStyles[this._charCount] && (f.fontStyle = this.fontStyles[this._charCount]), this.fontWeights[this._charCount] && (f.fontWeight = this.fontWeights[this._charCount]), this.context.font = this.componentsToFont(f)
            }
            this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), this.updateShadow(this.style.shadowStroke), this.context.strokeText(e, b, c)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), this.updateShadow(this.style.shadowFill), this.context.fillText(e, b, c)), b += this.context.measureText(e).width, this._charCount++
        }
    },c.Text.prototype.clearColors = function () {
        return this.colors = [], this.strokeColors = [], this.dirty = !0, this
    },c.Text.prototype.clearFontValues = function () {
        return this.fontStyles = [], this.fontWeights = [], this.dirty = !0, this
    },c.Text.prototype.addColor = function (a, b) {
        return this.colors[b] = a, this.dirty = !0, this
    },c.Text.prototype.addStrokeColor = function (a, b) {
        return this.strokeColors[b] = a, this.dirty = !0, this
    },c.Text.prototype.addFontStyle = function (a, b) {
        return this.fontStyles[b] = a, this.dirty = !0, this
    },c.Text.prototype.addFontWeight = function (a, b) {
        return this.fontWeights[b] = a, this.dirty = !0, this
    },c.Text.prototype.precalculateWordWrap = function (a) {
        this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font;
        var b = this.runWordWrap(a);
        return b.split(/(?:\r\n|\r|\n)/)
    },c.Text.prototype.runWordWrap = function (a) {
        return this.useAdvancedWrap ? this.advancedWordWrap(a) : this.basicWordWrap(a)
    },c.Text.prototype.advancedWordWrap = function (a) {
        for (var b = this.context, c = this.style.wordWrapWidth, d = "", e = a.replace(/ +/gi, " ").split(/\r?\n/gi), f = e.length, g = 0; f > g; g++) {
            var h = e[g], i = "";
            h = h.replace(/^ *|\s*$/gi, "");
            var j = b.measureText(h).width;
            if (c > j)d += h + "\n"; else {
                for (var k = c, l = h.split(" "), m = 0; m < l.length; m++) {
                    var n = l[m], o = n + " ", p = b.measureText(o).width;
                    if (p > k) {
                        if (0 === m) {
                            for (var q = o; q.length && (q = q.slice(0, -1), p = b.measureText(q).width, !(k >= p)););
                            if (!q.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");
                            var r = n.substr(q.length);
                            l[m] = r, i += q
                        }
                        var s = l[m].length ? m : m + 1, t = l.slice(s).join(" ").replace(/[ \n]*$/gi, "");
                        e[g + 1] = t + " " + (e[g + 1] || ""), f = e.length;
                        break
                    }
                    i += o, k -= p
                }
                d += i.replace(/[ \n]*$/gi, "") + "\n"
            }
        }
        return d = d.replace(/[\s|\n]*$/gi, "")
    },c.Text.prototype.basicWordWrap = function (a) {
        for (var b = "", c = a.split("\n"), d = 0; d < c.length; d++) {
            for (var e = this.style.wordWrapWidth, f = c[d].split(" "), g = 0; g < f.length; g++) {
                var h = this.context.measureText(f[g]).width, i = h + this.context.measureText(" ").width;
                i > e ? (g > 0 && (b += "\n"), b += f[g] + " ", e = this.style.wordWrapWidth - h) : (e -= i, b += f[g] + " ")
            }
            d < c.length - 1 && (b += "\n")
        }
        return b
    },c.Text.prototype.updateFont = function (a) {
        var b = this.componentsToFont(a);
        this.style.font !== b && (this.style.font = b, this.dirty = !0, this.parent && this.updateTransform())
    },c.Text.prototype.fontToComponents = function (a) {
        var b = a.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);
        if (b) {
            var c = b[5].trim();
            return /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(c) || /['",]/.exec(c) || (c = "'" + c + "'"), {
                font: a,
                fontStyle: b[1] || "normal",
                fontVariant: b[2] || "normal",
                fontWeight: b[3] || "normal",
                fontSize: b[4] || "medium",
                fontFamily: c
            }
        }
        return console.warn("Phaser.Text - unparsable CSS font: " + a), {font: a}
    },c.Text.prototype.componentsToFont = function (a) {
        var b, c = [];
        return b = a.fontStyle, b && "normal" !== b && c.push(b), b = a.fontVariant, b && "normal" !== b && c.push(b), b = a.fontWeight, b && "normal" !== b && c.push(b), b = a.fontSize, b && "medium" !== b && c.push(b), b = a.fontFamily, b && c.push(b), c.length || c.push(a.font), c.join(" ")
    },c.Text.prototype.setText = function (a, b) {
        return void 0 === b && (b = !1), this.text = a.toString() || "", b ? this.updateText() : this.dirty = !0, this
    },c.Text.prototype.parseList = function (a) {
        if (!Array.isArray(a))return this;
        for (var b = "", c = 0; c < a.length; c++)Array.isArray(a[c]) ? (b += a[c].join("	"), c < a.length - 1 && (b += "\n")) : (b += a[c], c < a.length - 1 && (b += "	"));
        return this.text = b, this.dirty = !0, this
    },c.Text.prototype.setTextBounds = function (a, b, d, e) {
        return void 0 === a ? this.textBounds = null : (this.textBounds ? this.textBounds.setTo(a, b, d, e) : this.textBounds = new c.Rectangle(a, b, d, e), this.style.wordWrapWidth > d && (this.style.wordWrapWidth = d)), this.updateTexture(), this
    },c.Text.prototype.updateTexture = function () {
        var a = this.texture.baseTexture, b = this.texture.crop, c = this.texture.frame, d = this.canvas.width, e = this.canvas.height;
        if (a.width = d, a.height = e, b.width = d, b.height = e, c.width = d, c.height = e, this.texture.width = d, this.texture.height = e, this._width = d, this._height = e, this.textBounds) {
            var f = this.textBounds.x, g = this.textBounds.y;
            "right" === this.style.boundsAlignH ? f += this.textBounds.width - this.canvas.width : "center" === this.style.boundsAlignH && (f += this.textBounds.halfWidth - this.canvas.width / 2), "bottom" === this.style.boundsAlignV ? g += this.textBounds.height - this.canvas.height : "middle" === this.style.boundsAlignV && (g += this.textBounds.halfHeight - this.canvas.height / 2), this.pivot.x = -f, this.pivot.y = -g
        }
        this.renderable = 0 !== d && 0 !== e, this.texture.requiresReTint = !0, this.texture.baseTexture.dirty()
    },c.Text.prototype._renderWebGL = function (a) {
        this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderWebGL.call(this, a)
    },c.Text.prototype._renderCanvas = function (a) {
        this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderCanvas.call(this, a)
    },c.Text.prototype.determineFontProperties = function (a) {
        var b = c.Text.fontPropertiesCache[a];
        if (!b) {
            b = {};
            var d = c.Text.fontPropertiesCanvas, e = c.Text.fontPropertiesContext;
            e.font = a;
            var f = Math.ceil(e.measureText("|Mq").width), g = Math.ceil(e.measureText("|Mq").width), h = 2 * g;
            if (g = 1.4 * g | 0, d.width = f, d.height = h, e.fillStyle = "#f00", e.fillRect(0, 0, f, h), e.font = a, e.textBaseline = "alphabetic", e.fillStyle = "#000", e.fillText("|Mq", 0, g), !e.getImageData(0, 0, f, h))return b.ascent = g, b.descent = g + 6, b.fontSize = b.ascent + b.descent, c.Text.fontPropertiesCache[a] = b, b;
            var i, j, k = e.getImageData(0, 0, f, h).data, l = k.length, m = 4 * f, n = 0, o = !1;
            for (i = 0; g > i; i++) {
                for (j = 0; m > j; j += 4)if (255 !== k[n + j]) {
                    o = !0;
                    break
                }
                if (o)break;
                n += m
            }
            for (b.ascent = g - i, n = l - m, o = !1, i = h; i > g; i--) {
                for (j = 0; m > j; j += 4)if (255 !== k[n + j]) {
                    o = !0;
                    break
                }
                if (o)break;
                n -= m
            }
            b.descent = i - g, b.descent += 6, b.fontSize = b.ascent + b.descent, c.Text.fontPropertiesCache[a] = b
        }
        return b
    },c.Text.prototype.getBounds = function (a) {
        return this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype.getBounds.call(this, a)
    },Object.defineProperty(c.Text.prototype, "text", {
        get: function () {
            return this._text
        }, set: function (a) {
            a !== this._text && (this._text = a.toString() || "", this.dirty = !0, this.parent && this.updateTransform())
        }
    }),Object.defineProperty(c.Text.prototype, "cssFont", {
        get: function () {
            return this.componentsToFont(this._fontComponents)
        }, set: function (a) {
            a = a || "bold 20pt Arial", this._fontComponents = this.fontToComponents(a), this.updateFont(this._fontComponents)
        }
    }),Object.defineProperty(c.Text.prototype, "font", {
        get: function () {
            return this._fontComponents.fontFamily
        }, set: function (a) {
            a = a || "Arial", a = a.trim(), /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(a) || /['",]/.exec(a) || (a = "'" + a + "'"), this._fontComponents.fontFamily = a, this.updateFont(this._fontComponents)
        }
    }),Object.defineProperty(c.Text.prototype, "fontSize", {
        get: function () {
            var a = this._fontComponents.fontSize;
            return a && /(?:^0$|px$)/.exec(a) ? parseInt(a, 10) : a
        }, set: function (a) {
            a = a || "0", "number" == typeof a && (a += "px"), this._fontComponents.fontSize = a, this.updateFont(this._fontComponents)
        }
    }),Object.defineProperty(c.Text.prototype, "fontWeight", {
        get: function () {
            return this._fontComponents.fontWeight || "normal"
        }, set: function (a) {
            a = a || "normal", this._fontComponents.fontWeight = a, this.updateFont(this._fontComponents)
        }
    }),Object.defineProperty(c.Text.prototype, "fontStyle", {
        get: function () {
            return this._fontComponents.fontStyle || "normal"
        }, set: function (a) {
            a = a || "normal", this._fontComponents.fontStyle = a, this.updateFont(this._fontComponents)
        }
    }),Object.defineProperty(c.Text.prototype, "fontVariant", {
        get: function () {
            return this._fontComponents.fontVariant || "normal"
        }, set: function (a) {
            a = a || "normal", this._fontComponents.fontVariant = a, this.updateFont(this._fontComponents)
        }
    }),Object.defineProperty(c.Text.prototype, "fill", {
        get: function () {
            return this.style.fill
        }, set: function (a) {
            a !== this.style.fill && (this.style.fill = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "align", {
        get: function () {
            return this.style.align
        }, set: function (a) {
            a !== this.style.align && (this.style.align = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "resolution", {
        get: function () {
            return this._res
        }, set: function (a) {
            a !== this._res && (this._res = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "tabs", {
        get: function () {
            return this.style.tabs
        }, set: function (a) {
            a !== this.style.tabs && (this.style.tabs = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "boundsAlignH", {
        get: function () {
            return this.style.boundsAlignH
        }, set: function (a) {
            a !== this.style.boundsAlignH && (this.style.boundsAlignH = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "boundsAlignV", {
        get: function () {
            return this.style.boundsAlignV
        }, set: function (a) {
            a !== this.style.boundsAlignV && (this.style.boundsAlignV = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "stroke", {
        get: function () {
            return this.style.stroke
        }, set: function (a) {
            a !== this.style.stroke && (this.style.stroke = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "strokeThickness", {
        get: function () {
            return this.style.strokeThickness
        }, set: function (a) {
            a !== this.style.strokeThickness && (this.style.strokeThickness = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "wordWrap", {
        get: function () {
            return this.style.wordWrap
        }, set: function (a) {
            a !== this.style.wordWrap && (this.style.wordWrap = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "wordWrapWidth", {
        get: function () {
            return this.style.wordWrapWidth
        }, set: function (a) {
            a !== this.style.wordWrapWidth && (this.style.wordWrapWidth = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "lineSpacing", {
        get: function () {
            return this._lineSpacing
        }, set: function (a) {
            a !== this._lineSpacing && (this._lineSpacing = parseFloat(a), this.dirty = !0, this.parent && this.updateTransform())
        }
    }),Object.defineProperty(c.Text.prototype, "shadowOffsetX", {
        get: function () {
            return this.style.shadowOffsetX
        }, set: function (a) {
            a !== this.style.shadowOffsetX && (this.style.shadowOffsetX = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "shadowOffsetY", {
        get: function () {
            return this.style.shadowOffsetY
        }, set: function (a) {
            a !== this.style.shadowOffsetY && (this.style.shadowOffsetY = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "shadowColor", {
        get: function () {
            return this.style.shadowColor
        }, set: function (a) {
            a !== this.style.shadowColor && (this.style.shadowColor = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "shadowBlur", {
        get: function () {
            return this.style.shadowBlur
        }, set: function (a) {
            a !== this.style.shadowBlur && (this.style.shadowBlur = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "shadowStroke", {
        get: function () {
            return this.style.shadowStroke
        }, set: function (a) {
            a !== this.style.shadowStroke && (this.style.shadowStroke = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "shadowFill", {
        get: function () {
            return this.style.shadowFill
        }, set: function (a) {
            a !== this.style.shadowFill && (this.style.shadowFill = a, this.dirty = !0)
        }
    }),Object.defineProperty(c.Text.prototype, "width", {
        get: function () {
            return this.dirty && (this.updateText(), this.dirty = !1), this.scale.x * this.texture.frame.width
        }, set: function (a) {
            this.scale.x = a / this.texture.frame.width, this._width = a
        }
    }),Object.defineProperty(c.Text.prototype, "height", {
        get: function () {
            return this.dirty && (this.updateText(), this.dirty = !1), this.scale.y * this.texture.frame.height
        }, set: function (a) {
            this.scale.y = a / this.texture.frame.height, this._height = a
        }
    }),c.Text.fontPropertiesCache = {},c.Text.fontPropertiesCanvas = document.createElement("canvas"),c.Text.fontPropertiesContext = c.Text.fontPropertiesCanvas.getContext("2d"),c.TileSprite = function (a, b, d, e, f, g, h) {
        b = b || 0, d = d || 0, e = e || 256, f = f || 256, g = g || null, h = h || null, this.type = c.TILESPRITE, this.physicsType = c.SPRITE, this._scroll = new c.Point;
        var i = a.cache.getImage("__default", !0);
        PIXI.TilingSprite.call(this, new PIXI.Texture(i.base), e, f), c.Component.Core.init.call(this, a, b, d, g, h)
    },c.TileSprite.prototype = Object.create(PIXI.TilingSprite.prototype),c.TileSprite.prototype.constructor = c.TileSprite,c.Component.Core.install.call(c.TileSprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "Smoothed"]),c.TileSprite.prototype.preUpdatePhysics = c.Component.PhysicsBody.preUpdate,c.TileSprite.prototype.preUpdateLifeSpan = c.Component.LifeSpan.preUpdate,c.TileSprite.prototype.preUpdateInWorld = c.Component.InWorld.preUpdate,c.TileSprite.prototype.preUpdateCore = c.Component.Core.preUpdate,c.TileSprite.prototype.preUpdate = function () {
        return 0 !== this._scroll.x && (this.tilePosition.x += this._scroll.x * this.game.time.physicsElapsed), 0 !== this._scroll.y && (this.tilePosition.y += this._scroll.y * this.game.time.physicsElapsed), this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld() ? this.preUpdateCore() : !1
    },c.TileSprite.prototype.autoScroll = function (a, b) {
        this._scroll.set(a, b)
    },c.TileSprite.prototype.stopScroll = function () {
        this._scroll.set(0, 0)
    },c.TileSprite.prototype.destroy = function (a) {
        c.Component.Destroy.prototype.destroy.call(this, a), PIXI.TilingSprite.prototype.destroy.call(this)
    },c.TileSprite.prototype.reset = function (a, b) {
        return c.Component.Reset.prototype.reset.call(this, a, b), this.tilePosition.x = 0, this.tilePosition.y = 0, this
    },c.Device = function () {
        this.deviceReadyAt = 0, this.initialized = !1, this.desktop = !1, this.iOS = !1, this.iOSVersion = 0, this.cocoonJS = !1, this.cocoonJSApp = !1, this.cordova = !1, this.node = !1, this.nodeWebkit = !1, this.electron = !1, this.ejecta = !1, this.crosswalk = !1, this.android = !1, this.chromeOS = !1, this.linux = !1, this.macOS = !1, this.windows = !1, this.windowsPhone = !1, this.canvas = !1, this.canvasBitBltShift = null, this.webGL = !1, this.file = !1, this.fileSystem = !1, this.localStorage = !1, this.worker = !1, this.css3D = !1, this.pointerLock = !1, this.typedArray = !1, this.vibration = !1, this.getUserMedia = !0, this.quirksMode = !1, this.touch = !1, this.mspointer = !1, this.wheelEvent = null, this.arora = !1, this.chrome = !1, this.chromeVersion = 0, this.epiphany = !1, this.firefox = !1, this.firefoxVersion = 0, this.ie = !1, this.ieVersion = 0, this.trident = !1, this.tridentVersion = 0, this.edge = !1, this.mobileSafari = !1, this.midori = !1, this.opera = !1, this.safari = !1, this.safariVersion = 0, this.webApp = !1, this.silk = !1, this.audioData = !1, this.webAudio = !1, this.ogg = !1, this.opus = !1, this.mp3 = !1, this.wav = !1, this.m4a = !1, this.webm = !1, this.dolby = !1, this.oggVideo = !1, this.h264Video = !1, this.mp4Video = !1, this.webmVideo = !1, this.vp9Video = !1, this.hlsVideo = !1, this.iPhone = !1, this.iPhone4 = !1, this.iPad = !1, this.pixelRatio = 0, this.littleEndian = !1, this.LITTLE_ENDIAN = !1, this.support32bit = !1, this.fullscreen = !1, this.requestFullscreen = "", this.cancelFullscreen = "", this.fullscreenKeyboard = !1
    },c.Device = new c.Device,c.Device.onInitialized = new c.Signal,c.Device.whenReady = function (a, b, c) {
        var d = this._readyCheck;
        if (this.deviceReadyAt || !d)a.call(b, this); else if (d._monitor || c)d._queue = d._queue || [], d._queue.push([a, b]); else {
            d._monitor = d.bind(this), d._queue = d._queue || [], d._queue.push([a, b]);
            var e = "undefined" != typeof window.cordova, f = navigator.isCocoonJS;
            "complete" === document.readyState || "interactive" === document.readyState ? window.setTimeout(d._monitor, 0) : e && !f ? document.addEventListener("deviceready", d._monitor, !1) : (document.addEventListener("DOMContentLoaded", d._monitor, !1),
                window.addEventListener("load", d._monitor, !1))
        }
    },c.Device._readyCheck = function () {
        var a = this._readyCheck;
        if (document.body) {
            if (!this.deviceReadyAt) {
                this.deviceReadyAt = Date.now(), document.removeEventListener("deviceready", a._monitor), document.removeEventListener("DOMContentLoaded", a._monitor), window.removeEventListener("load", a._monitor), this._initialize(), this.initialized = !0, this.onInitialized.dispatch(this);
                for (var b; b = a._queue.shift();) {
                    var c = b[0], d = b[1];
                    c.call(d, this)
                }
                this._readyCheck = null, this._initialize = null, this.onInitialized = null
            }
        } else window.setTimeout(a._monitor, 20)
    },c.Device._initialize = function () {
        function a() {
            var a = navigator.userAgent;
            /Playstation Vita/.test(a) ? l.vita = !0 : /Kindle/.test(a) || /\bKF[A-Z][A-Z]+/.test(a) || /Silk.*Mobile Safari/.test(a) ? l.kindle = !0 : /Android/.test(a) ? l.android = !0 : /CrOS/.test(a) ? l.chromeOS = !0 : /iP[ao]d|iPhone/i.test(a) ? (l.iOS = !0, navigator.appVersion.match(/OS (\d+)/), l.iOSVersion = parseInt(RegExp.$1, 10)) : /Linux/.test(a) ? l.linux = !0 : /Mac OS/.test(a) ? l.macOS = !0 : /Windows/.test(a) && (l.windows = !0), (/Windows Phone/i.test(a) || /IEMobile/i.test(a)) && (l.android = !1, l.iOS = !1, l.macOS = !1, l.windows = !0, l.windowsPhone = !0);
            var b = /Silk/.test(a);
            (l.windows || l.macOS || l.linux && !b || l.chromeOS) && (l.desktop = !0), (l.windowsPhone || /Windows NT/i.test(a) && /Touch/i.test(a)) && (l.desktop = !1)
        }

        function b() {
            l.canvas = !!window.CanvasRenderingContext2D || l.cocoonJS;
            try {
                l.localStorage = !!localStorage.getItem
            } catch (a) {
                l.localStorage = !1
            }
            l.file = !!(window.File && window.FileReader && window.FileList && window.Blob), l.fileSystem = !!window.requestFileSystem, l.webGL = function () {
                try {
                    var a = document.createElement("canvas");
                    return a.screencanvas = !1, !!window.WebGLRenderingContext && (a.getContext("webgl") || a.getContext("experimental-webgl"))
                } catch (b) {
                    return !1
                }
            }(), l.webGL = !!l.webGL, l.worker = !!window.Worker, l.pointerLock = "pointerLockElement" in document || "mozPointerLockElement" in document || "webkitPointerLockElement" in document, l.quirksMode = "CSS1Compat" === document.compatMode ? !1 : !0, navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia, window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL, l.getUserMedia = l.getUserMedia && !!navigator.getUserMedia && !!window.URL, l.firefox && l.firefoxVersion < 21 && (l.getUserMedia = !1), !l.iOS && (l.ie || l.firefox || l.chrome) && (l.canvasBitBltShift = !0), (l.safari || l.mobileSafari) && (l.canvasBitBltShift = !1)
        }

        function c() {
            ("ontouchstart" in document.documentElement || window.navigator.maxTouchPoints && window.navigator.maxTouchPoints >= 1) && (l.touch = !0), (window.navigator.msPointerEnabled || window.navigator.pointerEnabled) && (l.mspointer = !0), l.cocoonJS || ("onwheel" in window || l.ie && "WheelEvent" in window ? l.wheelEvent = "wheel" : "onmousewheel" in window ? l.wheelEvent = "mousewheel" : l.firefox && "MouseScrollEvent" in window && (l.wheelEvent = "DOMMouseScroll"))
        }

        function d() {
            for (var a = ["requestFullscreen", "requestFullScreen", "webkitRequestFullscreen", "webkitRequestFullScreen", "msRequestFullscreen", "msRequestFullScreen", "mozRequestFullScreen", "mozRequestFullscreen"], b = document.createElement("div"), c = 0; c < a.length; c++)if (b[a[c]]) {
                l.fullscreen = !0, l.requestFullscreen = a[c];
                break
            }
            var d = ["cancelFullScreen", "exitFullscreen", "webkitCancelFullScreen", "webkitExitFullscreen", "msCancelFullScreen", "msExitFullscreen", "mozCancelFullScreen", "mozExitFullscreen"];
            if (l.fullscreen)for (var c = 0; c < d.length; c++)if (document[d[c]]) {
                l.cancelFullscreen = d[c];
                break
            }
            window.Element && Element.ALLOW_KEYBOARD_INPUT && (l.fullscreenKeyboard = !0)
        }

        function e() {
            var a = navigator.userAgent;
            if (/Arora/.test(a) ? l.arora = !0 : /Edge\/\d+/.test(a) ? l.edge = !0 : /Chrome\/(\d+)/.test(a) && !l.windowsPhone ? (l.chrome = !0, l.chromeVersion = parseInt(RegExp.$1, 10)) : /Epiphany/.test(a) ? l.epiphany = !0 : /Firefox\D+(\d+)/.test(a) ? (l.firefox = !0, l.firefoxVersion = parseInt(RegExp.$1, 10)) : /AppleWebKit/.test(a) && l.iOS ? l.mobileSafari = !0 : /MSIE (\d+\.\d+);/.test(a) ? (l.ie = !0, l.ieVersion = parseInt(RegExp.$1, 10)) : /Midori/.test(a) ? l.midori = !0 : /Opera/.test(a) ? l.opera = !0 : /Safari\/(\d+)/.test(a) && !l.windowsPhone ? (l.safari = !0, /Version\/(\d+)\./.test(a) && (l.safariVersion = parseInt(RegExp.$1, 10))) : /Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(a) && (l.ie = !0, l.trident = !0, l.tridentVersion = parseInt(RegExp.$1, 10), l.ieVersion = parseInt(RegExp.$3, 10)), /Silk/.test(a) && (l.silk = !0), navigator.standalone && (l.webApp = !0), "undefined" != typeof window.cordova && (l.cordova = !0), "undefined" != typeof process && "undefined" != typeof require && (l.node = !0), l.node && "object" == typeof process.versions && (l.nodeWebkit = !!process.versions["node-webkit"], l.electron = !!process.versions.electron), navigator.isCocoonJS && (l.cocoonJS = !0), l.cocoonJS)try {
                l.cocoonJSApp = "undefined" != typeof CocoonJS
            } catch (b) {
                l.cocoonJSApp = !1
            }
            "undefined" != typeof window.ejecta && (l.ejecta = !0), /Crosswalk/.test(a) && (l.crosswalk = !0)
        }

        function f() {
            var a = document.createElement("video"), b = !1;
            try {
                (b = !!a.canPlayType) && (a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, "") && (l.oggVideo = !0), a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, "") && (l.h264Video = !0, l.mp4Video = !0), a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "") && (l.webmVideo = !0), a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/, "") && (l.vp9Video = !0), a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/, "") && (l.hlsVideo = !0))
            } catch (c) {
            }
        }

        function g() {
            l.audioData = !!window.Audio, l.webAudio = !(!window.AudioContext && !window.webkitAudioContext);
            var a = document.createElement("audio"), b = !1;
            try {
                if ((b = !!a.canPlayType) && (a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, "") && (l.ogg = !0), (a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/, "") || a.canPlayType("audio/opus;").replace(/^no$/, "")) && (l.opus = !0), a.canPlayType("audio/mpeg;").replace(/^no$/, "") && (l.mp3 = !0), a.canPlayType('audio/wav; codecs="1"').replace(/^no$/, "") && (l.wav = !0), (a.canPlayType("audio/x-m4a;") || a.canPlayType("audio/aac;").replace(/^no$/, "")) && (l.m4a = !0), a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, "") && (l.webm = !0), "" !== a.canPlayType('audio/mp4;codecs="ec-3"')))if (l.edge)l.dolby = !0; else if (l.safari && l.safariVersion >= 9 && /Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)) {
                    var c = parseInt(RegExp.$1, 10), d = parseInt(RegExp.$2, 10);
                    (10 === c && d >= 11 || c > 10) && (l.dolby = !0)
                }
            } catch (e) {
            }
        }

        function h() {
            l.pixelRatio = window.devicePixelRatio || 1, l.iPhone = -1 != navigator.userAgent.toLowerCase().indexOf("iphone"), l.iPhone4 = 2 == l.pixelRatio && l.iPhone, l.iPad = -1 != navigator.userAgent.toLowerCase().indexOf("ipad"), "undefined" != typeof Int8Array ? l.typedArray = !0 : l.typedArray = !1, "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array && "undefined" != typeof Uint32Array && (l.littleEndian = i(), l.LITTLE_ENDIAN = l.littleEndian), l.support32bit = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8ClampedArray && "undefined" != typeof Int32Array && null !== l.littleEndian && j(), navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate, navigator.vibrate && (l.vibration = !0)
        }

        function i() {
            var a = new ArrayBuffer(4), b = new Uint8Array(a), c = new Uint32Array(a);
            return b[0] = 161, b[1] = 178, b[2] = 195, b[3] = 212, 3569595041 == c[0] ? !0 : 2712847316 == c[0] ? !1 : null
        }

        function j() {
            if (void 0 === Uint8ClampedArray)return !1;
            var a = PIXI.CanvasPool.create(this, 1, 1), b = a.getContext("2d");
            if (!b)return !1;
            var c = b.createImageData(1, 1);
            return PIXI.CanvasPool.remove(this), c.data instanceof Uint8ClampedArray
        }

        function k() {
            var a, b = document.createElement("p"), c = {
                webkitTransform: "-webkit-transform",
                OTransform: "-o-transform",
                msTransform: "-ms-transform",
                MozTransform: "-moz-transform",
                transform: "transform"
            };
            document.body.insertBefore(b, null);
            for (var d in c)void 0 !== b.style[d] && (b.style[d] = "translate3d(1px,1px,1px)", a = window.getComputedStyle(b).getPropertyValue(c[d]));
            document.body.removeChild(b), l.css3D = void 0 !== a && a.length > 0 && "none" !== a
        }

        var l = this;
        a(), e(), g(), f(), k(), h(), b(), d(), c()
    },c.Device.canPlayAudio = function (a) {
        return "mp3" === a && this.mp3 ? !0 : "ogg" === a && (this.ogg || this.opus) ? !0 : "m4a" === a && this.m4a ? !0 : "opus" === a && this.opus ? !0 : "wav" === a && this.wav ? !0 : "webm" === a && this.webm ? !0 : "mp4" === a && this.dolby ? !0 : !1
    },c.Device.canPlayVideo = function (a) {
        return "webm" === a && (this.webmVideo || this.vp9Video) ? !0 : "mp4" === a && (this.mp4Video || this.h264Video) ? !0 : "ogg" !== a && "ogv" !== a || !this.oggVideo ? "mpeg" === a && this.hlsVideo ? !0 : !1 : !0
    },c.Device.isConsoleOpen = function () {
        return window.console && window.console.firebug ? !0 : window.console && (console.profile(), console.profileEnd(), console.clear && console.clear(), console.profiles) ? console.profiles.length > 0 : !1
    },c.Device.isAndroidStockBrowser = function () {
        var a = window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);
        return a && a[1] < 537
    },c.Canvas = {
        create: function (a, b, c, d, e) {
            b = b || 256, c = c || 256;
            var f = e ? document.createElement("canvas") : PIXI.CanvasPool.create(a, b, c);
            return "string" == typeof d && "" !== d && (f.id = d), f.width = b, f.height = c, f.style.display = "block", f
        }, setBackgroundColor: function (a, b) {
            return b = b || "rgb(0,0,0)", a.style.backgroundColor = b, a
        }, setTouchAction: function (a, b) {
            return b = b || "none", a.style.msTouchAction = b, a.style["ms-touch-action"] = b, a.style["touch-action"] = b, a
        }, setUserSelect: function (a, b) {
            return b = b || "none", a.style["-webkit-touch-callout"] = b, a.style["-webkit-user-select"] = b, a.style["-khtml-user-select"] = b, a.style["-moz-user-select"] = b, a.style["-ms-user-select"] = b, a.style["user-select"] = b, a.style["-webkit-tap-highlight-color"] = "rgba(0, 0, 0, 0)", a
        }, addToDOM: function (a, b, c) {
            var d;
            return void 0 === c && (c = !0), b && ("string" == typeof b ? d = document.getElementById(b) : "object" == typeof b && 1 === b.nodeType && (d = b)), d || (d = document.body), c && d.style && (d.style.overflow = "hidden"), d.appendChild(a), a
        }, removeFromDOM: function (a) {
            a.parentNode && a.parentNode.removeChild(a)
        }, setTransform: function (a, b, c, d, e, f, g) {
            return a.setTransform(d, f, g, e, b, c), a
        }, setSmoothingEnabled: function (a, b) {
            var d = c.Canvas.getSmoothingPrefix(a);
            return d && (a[d] = b), a
        }, getSmoothingPrefix: function (a) {
            var b = ["i", "webkitI", "msI", "mozI", "oI"];
            for (var c in b) {
                var d = b[c] + "mageSmoothingEnabled";
                if (d in a)return d
            }
            return null
        }, getSmoothingEnabled: function (a) {
            var b = c.Canvas.getSmoothingPrefix(a);
            return b ? a[b] : void 0
        }, setImageRenderingCrisp: function (a) {
            for (var b = ["optimizeSpeed", "crisp-edges", "-moz-crisp-edges", "-webkit-optimize-contrast", "optimize-contrast", "pixelated"], c = 0; c < b.length; c++)a.style["image-rendering"] = b[c];
            return a.style.msInterpolationMode = "nearest-neighbor", a
        }, setImageRenderingBicubic: function (a) {
            return a.style["image-rendering"] = "auto", a.style.msInterpolationMode = "bicubic", a
        }
    },c.RequestAnimationFrame = function (a, b) {
        void 0 === b && (b = !1), this.game = a, this.isRunning = !1, this.forceSetTimeOut = b;
        for (var c = ["ms", "moz", "webkit", "o"], d = 0; d < c.length && !window.requestAnimationFrame; d++)window.requestAnimationFrame = window[c[d] + "RequestAnimationFrame"], window.cancelAnimationFrame = window[c[d] + "CancelAnimationFrame"];
        this._isSetTimeOut = !1, this._onLoop = null, this._timeOutID = null
    },c.RequestAnimationFrame.prototype = {
        start: function () {
            this.isRunning = !0;
            var a = this;
            !window.requestAnimationFrame || this.forceSetTimeOut ? (this._isSetTimeOut = !0, this._onLoop = function () {
                return a.updateSetTimeout()
            }, this._timeOutID = window.setTimeout(this._onLoop, 0)) : (this._isSetTimeOut = !1, this._onLoop = function (b) {
                return a.updateRAF(b)
            }, this._timeOutID = window.requestAnimationFrame(this._onLoop))
        }, updateRAF: function (a) {
            this.isRunning && (this.game.update(Math.floor(a)), this._timeOutID = window.requestAnimationFrame(this._onLoop))
        }, updateSetTimeout: function () {
            this.isRunning && (this.game.update(Date.now()), this._timeOutID = window.setTimeout(this._onLoop, this.game.time.timeToCall))
        }, stop: function () {
            this._isSetTimeOut ? clearTimeout(this._timeOutID) : window.cancelAnimationFrame(this._timeOutID), this.isRunning = !1
        }, isSetTimeOut: function () {
            return this._isSetTimeOut
        }, isRAF: function () {
            return this._isSetTimeOut === !1
        }
    },c.RequestAnimationFrame.prototype.constructor = c.RequestAnimationFrame,c.Math = {
        PI2: 2 * Math.PI,
        between: function (a, b) {
            return Math.floor(Math.random() * (b - a + 1) + a)
        },
        fuzzyEqual: function (a, b, c) {
            return void 0 === c && (c = 1e-4), Math.abs(a - b) < c
        },
        fuzzyLessThan: function (a, b, c) {
            return void 0 === c && (c = 1e-4), b + c > a
        },
        fuzzyGreaterThan: function (a, b, c) {
            return void 0 === c && (c = 1e-4), a > b - c
        },
        fuzzyCeil: function (a, b) {
            return void 0 === b && (b = 1e-4), Math.ceil(a - b)
        },
        fuzzyFloor: function (a, b) {
            return void 0 === b && (b = 1e-4), Math.floor(a + b)
        },
        average: function () {
            for (var a = 0, b = arguments.length, c = 0; b > c; c++)a += +arguments[c];
            return a / b
        },
        shear: function (a) {
            return a % 1
        },
        snapTo: function (a, b, c) {
            return void 0 === c && (c = 0), 0 === b ? a : (a -= c, a = b * Math.round(a / b), c + a)
        },
        snapToFloor: function (a, b, c) {
            return void 0 === c && (c = 0), 0 === b ? a : (a -= c, a = b * Math.floor(a / b), c + a)
        },
        snapToCeil: function (a, b, c) {
            return void 0 === c && (c = 0), 0 === b ? a : (a -= c, a = b * Math.ceil(a / b), c + a)
        },
        roundTo: function (a, b, c) {
            void 0 === b && (b = 0), void 0 === c && (c = 10);
            var d = Math.pow(c, -b);
            return Math.round(a * d) / d
        },
        floorTo: function (a, b, c) {
            void 0 === b && (b = 0), void 0 === c && (c = 10);
            var d = Math.pow(c, -b);
            return Math.floor(a * d) / d
        },
        ceilTo: function (a, b, c) {
            void 0 === b && (b = 0), void 0 === c && (c = 10);
            var d = Math.pow(c, -b);
            return Math.ceil(a * d) / d
        },
        angleBetween: function (a, b, c, d) {
            return Math.atan2(d - b, c - a)
        },
        angleBetweenY: function (a, b, c, d) {
            return Math.atan2(c - a, d - b)
        },
        angleBetweenPoints: function (a, b) {
            return Math.atan2(b.y - a.y, b.x - a.x)
        },
        angleBetweenPointsY: function (a, b) {
            return Math.atan2(b.x - a.x, b.y - a.y)
        },
        reverseAngle: function (a) {
            return this.normalizeAngle(a + Math.PI, !0)
        },
        normalizeAngle: function (a) {
            return a %= 2 * Math.PI, a >= 0 ? a : a + 2 * Math.PI
        },
        maxAdd: function (a, b, c) {
            return Math.min(a + b, c)
        },
        minSub: function (a, b, c) {
            return Math.max(a - b, c)
        },
        wrap: function (a, b, c) {
            var d = c - b;
            if (0 >= d)return 0;
            var e = (a - b) % d;
            return 0 > e && (e += d), e + b
        },
        wrapValue: function (a, b, c) {
            var d;
            return a = Math.abs(a), b = Math.abs(b), c = Math.abs(c), d = (a + b) % c
        },
        isOdd: function (a) {
            return !!(1 & a)
        },
        isEven: function (a) {
            return !(1 & a)
        },
        min: function () {
            if (1 === arguments.length && "object" == typeof arguments[0])var a = arguments[0]; else var a = arguments;
            for (var b = 1, c = 0, d = a.length; d > b; b++)a[b] < a[c] && (c = b);
            return a[c]
        },
        max: function () {
            if (1 === arguments.length && "object" == typeof arguments[0])var a = arguments[0]; else var a = arguments;
            for (var b = 1, c = 0, d = a.length; d > b; b++)a[b] > a[c] && (c = b);
            return a[c]
        },
        minProperty: function (a) {
            if (2 === arguments.length && "object" == typeof arguments[1])var b = arguments[1]; else var b = arguments.slice(1);
            for (var c = 1, d = 0, e = b.length; e > c; c++)b[c][a] < b[d][a] && (d = c);
            return b[d][a]
        },
        maxProperty: function (a) {
            if (2 === arguments.length && "object" == typeof arguments[1])var b = arguments[1]; else var b = arguments.slice(1);
            for (var c = 1, d = 0, e = b.length; e > c; c++)b[c][a] > b[d][a] && (d = c);
            return b[d][a]
        },
        wrapAngle: function (a, b) {
            return b ? this.wrap(a, -Math.PI, Math.PI) : this.wrap(a, -180, 180)
        },
        linearInterpolation: function (a, b) {
            var c = a.length - 1, d = c * b, e = Math.floor(d);
            return 0 > b ? this.linear(a[0], a[1], d) : b > 1 ? this.linear(a[c], a[c - 1], c - d) : this.linear(a[e], a[e + 1 > c ? c : e + 1], d - e)
        },
        bezierInterpolation: function (a, b) {
            for (var c = 0, d = a.length - 1, e = 0; d >= e; e++)c += Math.pow(1 - b, d - e) * Math.pow(b, e) * a[e] * this.bernstein(d, e);
            return c
        },
        catmullRomInterpolation: function (a, b) {
            var c = a.length - 1, d = c * b, e = Math.floor(d);
            return a[0] === a[c] ? (0 > b && (e = Math.floor(d = c * (1 + b))), this.catmullRom(a[(e - 1 + c) % c], a[e], a[(e + 1) % c], a[(e + 2) % c], d - e)) : 0 > b ? a[0] - (this.catmullRom(a[0], a[0], a[1], a[1], -d) - a[0]) : b > 1 ? a[c] - (this.catmullRom(a[c], a[c], a[c - 1], a[c - 1], d - c) - a[c]) : this.catmullRom(a[e ? e - 1 : 0], a[e], a[e + 1 > c ? c : e + 1], a[e + 2 > c ? c : e + 2], d - e)
        },
        linear: function (a, b, c) {
            return (b - a) * c + a
        },
        bernstein: function (a, b) {
            return this.factorial(a) / this.factorial(b) / this.factorial(a - b)
        },
        factorial: function (a) {
            if (0 === a)return 1;
            for (var b = a; --a;)b *= a;
            return b
        },
        catmullRom: function (a, b, c, d, e) {
            var f = .5 * (c - a), g = .5 * (d - b), h = e * e, i = e * h;
            return (2 * b - 2 * c + f + g) * i + (-3 * b + 3 * c - 2 * f - g) * h + f * e + b
        },
        difference: function (a, b) {
            return Math.abs(a - b)
        },
        roundAwayFromZero: function (a) {
            return a > 0 ? Math.ceil(a) : Math.floor(a)
        },
        sinCosGenerator: function (a, b, c, d) {
            void 0 === b && (b = 1), void 0 === c && (c = 1), void 0 === d && (d = 1);
            for (var e = b, f = c, g = d * Math.PI / a, h = [], i = [], j = 0; a > j; j++)f -= e * g, e += f * g, h[j] = f, i[j] = e;
            return {sin: i, cos: h, length: a}
        },
        distance: function (a, b, c, d) {
            var e = a - c, f = b - d;
            return Math.sqrt(e * e + f * f)
        },
        distanceSq: function (a, b, c, d) {
            var e = a - c, f = b - d;
            return e * e + f * f
        },
        distancePow: function (a, b, c, d, e) {
            return void 0 === e && (e = 2), Math.sqrt(Math.pow(c - a, e) + Math.pow(d - b, e))
        },
        clamp: function (a, b, c) {
            return b > a ? b : a > c ? c : a
        },
        clampBottom: function (a, b) {
            return b > a ? b : a
        },
        within: function (a, b, c) {
            return Math.abs(a - b) <= c
        },
        mapLinear: function (a, b, c, d, e) {
            return d + (a - b) * (e - d) / (c - b)
        },
        smoothstep: function (a, b, c) {
            return a = Math.max(0, Math.min(1, (a - b) / (c - b))), a * a * (3 - 2 * a)
        },
        smootherstep: function (a, b, c) {
            return a = Math.max(0, Math.min(1, (a - b) / (c - b))), a * a * a * (a * (6 * a - 15) + 10)
        },
        sign: function (a) {
            return 0 > a ? -1 : a > 0 ? 1 : 0
        },
        percent: function (a, b, c) {
            return void 0 === c && (c = 0), a > b || c > b ? 1 : c > a || c > a ? 0 : (a - c) / b
        }
    };
    var k = Math.PI / 180, l = 180 / Math.PI;
    return c.Math.degToRad = function (a) {
        return a * k
    }, c.Math.radToDeg = function (a) {
        return a * l
    }, c.RandomDataGenerator = function (a) {
        void 0 === a && (a = []), this.c = 1, this.s0 = 0, this.s1 = 0, this.s2 = 0, "string" == typeof a ? this.state(a) : this.sow(a)
    }, c.RandomDataGenerator.prototype = {
        rnd: function () {
            var a = 2091639 * this.s0 + 2.3283064365386963e-10 * this.c;
            return this.c = 0 | a, this.s0 = this.s1, this.s1 = this.s2, this.s2 = a - this.c, this.s2
        }, sow: function (a) {
            if (this.s0 = this.hash(" "), this.s1 = this.hash(this.s0), this.s2 = this.hash(this.s1), this.c = 1, a)for (var b = 0; b < a.length && null != a[b]; b++) {
                var c = a[b];
                this.s0 -= this.hash(c), this.s0 += ~~(this.s0 < 0), this.s1 -= this.hash(c), this.s1 += ~~(this.s1 < 0), this.s2 -= this.hash(c), this.s2 += ~~(this.s2 < 0)
            }
        }, hash: function (a) {
            var b, c, d;
            for (d = 4022871197, a = a.toString(), c = 0; c < a.length; c++)d += a.charCodeAt(c), b = .02519603282416938 * d, d = b >>> 0, b -= d, b *= d, d = b >>> 0, b -= d, d += 4294967296 * b;
            return 2.3283064365386963e-10 * (d >>> 0)
        }, integer: function () {
            return 4294967296 * this.rnd.apply(this)
        }, frac: function () {
            return this.rnd.apply(this) + 1.1102230246251565e-16 * (2097152 * this.rnd.apply(this) | 0)
        }, real: function () {
            return this.integer() + this.frac()
        }, integerInRange: function (a, b) {
            return Math.floor(this.realInRange(0, b - a + 1) + a)
        }, between: function (a, b) {
            return this.integerInRange(a, b)
        }, realInRange: function (a, b) {
            return this.frac() * (b - a) + a
        }, normal: function () {
            return 1 - 2 * this.frac()
        }, uuid: function () {
            var a = "", b = "";
            for (b = a = ""; a++ < 36; b += ~a % 5 | 3 * a & 4 ? (15 ^ a ? 8 ^ this.frac() * (20 ^ a ? 16 : 4) : 4).toString(16) : "-");
            return b
        }, pick: function (a) {
            return a[this.integerInRange(0, a.length - 1)]
        }, sign: function () {
            return this.pick([-1, 1])
        }, weightedPick: function (a) {
            return a[~~(Math.pow(this.frac(), 2) * (a.length - 1) + .5)]
        }, timestamp: function (a, b) {
            return this.realInRange(a || 9466848e5, b || 1577862e6)
        }, angle: function () {
            return this.integerInRange(-180, 180)
        }, state: function (a) {
            return "string" == typeof a && a.match(/^!rnd/) && (a = a.split(","), this.c = parseFloat(a[1]), this.s0 = parseFloat(a[2]), this.s1 = parseFloat(a[3]), this.s2 = parseFloat(a[4])), ["!rnd", this.c, this.s0, this.s1, this.s2].join(",")
        }
    }, c.RandomDataGenerator.prototype.constructor = c.RandomDataGenerator, c.QuadTree = function (a, b, c, d, e, f, g) {
        this.maxObjects = 10, this.maxLevels = 4, this.level = 0, this.bounds = {}, this.objects = [], this.nodes = [], this._empty = [], this.reset(a, b, c, d, e, f, g)
    }, c.QuadTree.prototype = {
        reset: function (a, b, c, d, e, f, g) {
            this.maxObjects = e || 10, this.maxLevels = f || 4, this.level = g || 0, this.bounds = {
                x: Math.round(a),
                y: Math.round(b),
                width: c,
                height: d,
                subWidth: Math.floor(c / 2),
                subHeight: Math.floor(d / 2),
                right: Math.round(a) + Math.floor(c / 2),
                bottom: Math.round(b) + Math.floor(d / 2)
            }, this.objects.length = 0, this.nodes.length = 0
        }, populate: function (a) {
            a.forEach(this.populateHandler, this, !0)
        }, populateHandler: function (a) {
            a.body && a.exists && this.insert(a.body)
        }, split: function () {
            this.nodes[0] = new c.QuadTree(this.bounds.right, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[1] = new c.QuadTree(this.bounds.x, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[2] = new c.QuadTree(this.bounds.x, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[3] = new c.QuadTree(this.bounds.right, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1)
        }, insert: function (a) {
            var b, c = 0;
            if (null != this.nodes[0] && (b = this.getIndex(a), -1 !== b))return void this.nodes[b].insert(a);
            if (this.objects.push(a), this.objects.length > this.maxObjects && this.level < this.maxLevels)for (null == this.nodes[0] && this.split(); c < this.objects.length;)b = this.getIndex(this.objects[c]), -1 !== b ? this.nodes[b].insert(this.objects.splice(c, 1)[0]) : c++
        }, getIndex: function (a) {
            var b = -1;
            return a.x < this.bounds.right && a.right < this.bounds.right ? a.y < this.bounds.bottom && a.bottom < this.bounds.bottom ? b = 1 : a.y > this.bounds.bottom && (b = 2) : a.x > this.bounds.right && (a.y < this.bounds.bottom && a.bottom < this.bounds.bottom ? b = 0 : a.y > this.bounds.bottom && (b = 3)), b
        }, retrieve: function (a) {
            if (a instanceof c.Rectangle)var b = this.objects, d = this.getIndex(a); else {
                if (!a.body)return this._empty;
                var b = this.objects, d = this.getIndex(a.body)
            }
            return this.nodes[0] && (-1 !== d ? b = b.concat(this.nodes[d].retrieve(a)) : (b = b.concat(this.nodes[0].retrieve(a)), b = b.concat(this.nodes[1].retrieve(a)), b = b.concat(this.nodes[2].retrieve(a)), b = b.concat(this.nodes[3].retrieve(a)))), b
        }, clear: function () {
            this.objects.length = 0;
            for (var a = this.nodes.length; a--;)this.nodes[a].clear(), this.nodes.splice(a, 1);
            this.nodes.length = 0
        }
    }, c.QuadTree.prototype.constructor = c.QuadTree, c.Net = function (a) {
        this.game = a
    }, c.Net.prototype = {
        getHostName: function () {
            return window.location && window.location.hostname ? window.location.hostname : null
        }, checkDomainName: function (a) {
            return -1 !== window.location.hostname.indexOf(a)
        }, updateQueryString: function (a, b, c, d) {
            void 0 === c && (c = !1), (void 0 === d || "" === d) && (d = window.location.href);
            var e = "", f = new RegExp("([?|&])" + a + "=.*?(&|#|$)(.*)", "gi");
            if (f.test(d))e = "undefined" != typeof b && null !== b ? d.replace(f, "$1" + a + "=" + b + "$2$3") : d.replace(f, "$1$3").replace(/(&|\?)$/, ""); else if ("undefined" != typeof b && null !== b) {
                var g = -1 !== d.indexOf("?") ? "&" : "?", h = d.split("#");
                d = h[0] + g + a + "=" + b, h[1] && (d += "#" + h[1]), e = d
            } else e = d;
            return c ? void(window.location.href = e) : e
        }, getQueryString: function (a) {
            void 0 === a && (a = "");
            var b = {}, c = location.search.substring(1).split("&");
            for (var d in c) {
                var e = c[d].split("=");
                if (e.length > 1) {
                    if (a && a == this.decodeURI(e[0]))return this.decodeURI(e[1]);
                    b[this.decodeURI(e[0])] = this.decodeURI(e[1])
                }
            }
            return b
        }, decodeURI: function (a) {
            return decodeURIComponent(a.replace(/\+/g, " "))
        }
    }, c.Net.prototype.constructor = c.Net, c.TweenManager = function (a) {
        this.game = a, this.frameBased = !1, this._tweens = [], this._add = [], this.easeMap = {
            Power0: c.Easing.Power0,
            Power1: c.Easing.Power1,
            Power2: c.Easing.Power2,
            Power3: c.Easing.Power3,
            Power4: c.Easing.Power4,
            Linear: c.Easing.Linear.None,
            Quad: c.Easing.Quadratic.Out,
            Cubic: c.Easing.Cubic.Out,
            Quart: c.Easing.Quartic.Out,
            Quint: c.Easing.Quintic.Out,
            Sine: c.Easing.Sinusoidal.Out,
            Expo: c.Easing.Exponential.Out,
            Circ: c.Easing.Circular.Out,
            Elastic: c.Easing.Elastic.Out,
            Back: c.Easing.Back.Out,
            Bounce: c.Easing.Bounce.Out,
            "Quad.easeIn": c.Easing.Quadratic.In,
            "Cubic.easeIn": c.Easing.Cubic.In,
            "Quart.easeIn": c.Easing.Quartic.In,
            "Quint.easeIn": c.Easing.Quintic.In,
            "Sine.easeIn": c.Easing.Sinusoidal.In,
            "Expo.easeIn": c.Easing.Exponential.In,
            "Circ.easeIn": c.Easing.Circular.In,
            "Elastic.easeIn": c.Easing.Elastic.In,
            "Back.easeIn": c.Easing.Back.In,
            "Bounce.easeIn": c.Easing.Bounce.In,
            "Quad.easeOut": c.Easing.Quadratic.Out,
            "Cubic.easeOut": c.Easing.Cubic.Out,
            "Quart.easeOut": c.Easing.Quartic.Out,
            "Quint.easeOut": c.Easing.Quintic.Out,
            "Sine.easeOut": c.Easing.Sinusoidal.Out,
            "Expo.easeOut": c.Easing.Exponential.Out,
            "Circ.easeOut": c.Easing.Circular.Out,
            "Elastic.easeOut": c.Easing.Elastic.Out,
            "Back.easeOut": c.Easing.Back.Out,
            "Bounce.easeOut": c.Easing.Bounce.Out,
            "Quad.easeInOut": c.Easing.Quadratic.InOut,
            "Cubic.easeInOut": c.Easing.Cubic.InOut,
            "Quart.easeInOut": c.Easing.Quartic.InOut,
            "Quint.easeInOut": c.Easing.Quintic.InOut,
            "Sine.easeInOut": c.Easing.Sinusoidal.InOut,
            "Expo.easeInOut": c.Easing.Exponential.InOut,
            "Circ.easeInOut": c.Easing.Circular.InOut,
            "Elastic.easeInOut": c.Easing.Elastic.InOut,
            "Back.easeInOut": c.Easing.Back.InOut,
            "Bounce.easeInOut": c.Easing.Bounce.InOut
        }, this.game.onPause.add(this._pauseAll, this), this.game.onResume.add(this._resumeAll, this)
    }, c.TweenManager.prototype = {
        getAll: function () {
            return this._tweens
        }, removeAll: function () {
            for (var a = 0; a < this._tweens.length; a++)this._tweens[a].pendingDelete = !0;
            this._add = []
        }, removeFrom: function (a, b) {
            void 0 === b && (b = !0);
            var d, e;
            if (Array.isArray(a))for (d = 0, e = a.length; e > d; d++)this.removeFrom(a[d]); else if (a.type === c.GROUP && b)for (var d = 0, e = a.children.length; e > d; d++)this.removeFrom(a.children[d]); else {
                for (d = 0, e = this._tweens.length; e > d; d++)a === this._tweens[d].target && this.remove(this._tweens[d]);
                for (d = 0, e = this._add.length; e > d; d++)a === this._add[d].target && this.remove(this._add[d])
            }
        }, add: function (a) {
            a._manager = this, this._add.push(a)
        }, create: function (a) {
            return new c.Tween(a, this.game, this)
        }, remove: function (a) {
            var b = this._tweens.indexOf(a);
            -1 !== b ? this._tweens[b].pendingDelete = !0 : (b = this._add.indexOf(a), -1 !== b && (this._add[b].pendingDelete = !0))
        }, update: function () {
            var a = this._add.length, b = this._tweens.length;
            if (0 === b && 0 === a)return !1;
            for (var c = 0; b > c;)this._tweens[c].update(this.game.time.time) ? c++ : (this._tweens.splice(c, 1), b--);
            return a > 0 && (this._tweens = this._tweens.concat(this._add), this._add.length = 0), !0
        }, isTweening: function (a) {
            return this._tweens.some(function (b) {
                return b.target === a
            })
        }, _pauseAll: function () {
            for (var a = this._tweens.length - 1; a >= 0; a--)this._tweens[a]._pause()
        }, _resumeAll: function () {
            for (var a = this._tweens.length - 1; a >= 0; a--)this._tweens[a]._resume()
        }, pauseAll: function () {
            for (var a = this._tweens.length - 1; a >= 0; a--)this._tweens[a].pause()
        }, resumeAll: function () {
            for (var a = this._tweens.length - 1; a >= 0; a--)this._tweens[a].resume(!0)
        }
    }, c.TweenManager.prototype.constructor = c.TweenManager, c.Tween = function (a, b, d) {
        this.game = b, this.target = a, this.manager = d, this.timeline = [], this.reverse = !1, this.timeScale = 1, this.repeatCounter = 0, this.pendingDelete = !1, this.onStart = new c.Signal, this.onLoop = new c.Signal, this.onRepeat = new c.Signal, this.onChildComplete = new c.Signal, this.onComplete = new c.Signal, this.isRunning = !1, this.current = 0, this.properties = {}, this.chainedTween = null, this.isPaused = !1, this.frameBased = d.frameBased, this._onUpdateCallback = null, this._onUpdateCallbackContext = null, this._pausedTime = 0, this._codePaused = !1, this._hasStarted = !1
    }, c.Tween.prototype = {
        to: function (a, b, d, e, f, g, h) {
            return (void 0 === b || 0 >= b) && (b = 1e3), (void 0 === d || null === d) && (d = c.Easing.Default), void 0 === e && (e = !1), void 0 === f && (f = 0), void 0 === g && (g = 0), void 0 === h && (h = !1), "string" == typeof d && this.manager.easeMap[d] && (d = this.manager.easeMap[d]), this.isRunning ? (console.warn("Phaser.Tween.to cannot be called after Tween.start"), this) : (this.timeline.push(new c.TweenData(this).to(a, b, d, f, g, h)), e && this.start(), this)
        }, from: function (a, b, d, e, f, g, h) {
            return void 0 === b && (b = 1e3), (void 0 === d || null === d) && (d = c.Easing.Default), void 0 === e && (e = !1), void 0 === f && (f = 0), void 0 === g && (g = 0), void 0 === h && (h = !1), "string" == typeof d && this.manager.easeMap[d] && (d = this.manager.easeMap[d]), this.isRunning ? (console.warn("Phaser.Tween.from cannot be called after Tween.start"), this) : (this.timeline.push(new c.TweenData(this).from(a, b, d, f, g, h)), e && this.start(), this)
        }, start: function (a) {
            if (void 0 === a && (a = 0), null === this.game || null === this.target || 0 === this.timeline.length || this.isRunning)return this;
            for (var b = 0; b < this.timeline.length; b++)for (var c in this.timeline[b].vEnd)this.properties[c] = this.target[c] || 0, Array.isArray(this.properties[c]) || (this.properties[c] *= 1);
            for (var b = 0; b < this.timeline.length; b++)this.timeline[b].loadValues();
            return this.manager.add(this), this.isRunning = !0, (0 > a || a > this.timeline.length - 1) && (a = 0), this.current = a, this.timeline[this.current].start(), this
        }, stop: function (a) {
            return void 0 === a && (a = !1), this.isRunning = !1, this._onUpdateCallback = null, this._onUpdateCallbackContext = null, a && (this.onComplete.dispatch(this.target, this), this._hasStarted = !1, this.chainedTween && this.chainedTween.start()), this.manager.remove(this), this
        }, updateTweenData: function (a, b, c) {
            if (0 === this.timeline.length)return this;
            if (void 0 === c && (c = 0), -1 === c)for (var d = 0; d < this.timeline.length; d++)this.timeline[d][a] = b; else this.timeline[c][a] = b;
            return this
        }, delay: function (a, b) {
            return this.updateTweenData("delay", a, b)
        }, repeat: function (a, b, c) {
            return void 0 === b && (b = 0), this.updateTweenData("repeatCounter", a, c), this.updateTweenData("repeatDelay", b, c)
        }, repeatDelay: function (a, b) {
            return this.updateTweenData("repeatDelay", a, b)
        }, yoyo: function (a, b, c) {
            return void 0 === b && (b = 0), this.updateTweenData("yoyo", a, c), this.updateTweenData("yoyoDelay", b, c)
        }, yoyoDelay: function (a, b) {
            return this.updateTweenData("yoyoDelay", a, b)
        }, easing: function (a, b) {
            return "string" == typeof a && this.manager.easeMap[a] && (a = this.manager.easeMap[a]), this.updateTweenData("easingFunction", a, b)
        }, interpolation: function (a, b, d) {
            return void 0 === b && (b = c.Math), this.updateTweenData("interpolationFunction", a, d), this.updateTweenData("interpolationContext", b, d)
        }, repeatAll: function (a) {
            return void 0 === a && (a = 0), this.repeatCounter = a, this
        }, chain: function () {
            for (var a = arguments.length; a--;)a > 0 ? arguments[a - 1].chainedTween = arguments[a] : this.chainedTween = arguments[a];
            return this
        }, loop: function (a) {
            return void 0 === a && (a = !0), this.repeatCounter = a ? -1 : 0, this
        }, onUpdateCallback: function (a, b) {
            return this._onUpdateCallback = a, this._onUpdateCallbackContext = b, this
        }, pause: function () {
            this.isPaused = !0, this._codePaused = !0, this._pausedTime = this.game.time.time
        }, _pause: function () {
            this._codePaused || (this.isPaused = !0, this._pausedTime = this.game.time.time)
        }, resume: function () {
            if (this.isPaused) {
                this.isPaused = !1, this._codePaused = !1;
                for (var a = 0; a < this.timeline.length; a++)this.timeline[a].isRunning || (this.timeline[a].startTime += this.game.time.time - this._pausedTime)
            }
        }, _resume: function () {
            this._codePaused || this.resume()
        }, update: function (a) {
            if (this.pendingDelete || !this.target)return !1;
            if (this.isPaused)return !0;
            var b = this.timeline[this.current].update(a);
            if (b === c.TweenData.PENDING)return !0;
            if (b === c.TweenData.RUNNING)return this._hasStarted || (this.onStart.dispatch(this.target, this), this._hasStarted = !0), null !== this._onUpdateCallback && this._onUpdateCallback.call(this._onUpdateCallbackContext, this, this.timeline[this.current].value, this.timeline[this.current]), this.isRunning;
            if (b === c.TweenData.LOOPED)return -1 === this.timeline[this.current].repeatCounter ? this.onLoop.dispatch(this.target, this) : this.onRepeat.dispatch(this.target, this), !0;
            if (b === c.TweenData.COMPLETE) {
                var d = !1;
                return this.reverse ? (this.current--, this.current < 0 && (this.current = this.timeline.length - 1, d = !0)) : (this.current++, this.current === this.timeline.length && (this.current = 0, d = !0)), d ? -1 === this.repeatCounter ? (this.timeline[this.current].start(), this.onLoop.dispatch(this.target, this), !0) : this.repeatCounter > 0 ? (this.repeatCounter--, this.timeline[this.current].start(), this.onRepeat.dispatch(this.target, this), !0) : (this.isRunning = !1, this.onComplete.dispatch(this.target, this), this._hasStarted = !1, this.chainedTween && this.chainedTween.start(), !1) : (this.onChildComplete.dispatch(this.target, this), this.timeline[this.current].start(), !0)
            }
        }, generateData: function (a, b) {
            if (null === this.game || null === this.target)return null;
            void 0 === a && (a = 60), void 0 === b && (b = []);
            for (var c = 0; c < this.timeline.length; c++)for (var d in this.timeline[c].vEnd)this.properties[d] = this.target[d] || 0, Array.isArray(this.properties[d]) || (this.properties[d] *= 1);
            for (var c = 0; c < this.timeline.length; c++)this.timeline[c].loadValues();
            for (var c = 0; c < this.timeline.length; c++)b = b.concat(this.timeline[c].generateData(a));
            return b
        }
    }, Object.defineProperty(c.Tween.prototype, "totalDuration", {
        get: function () {
            for (var a = 0, b = 0; b < this.timeline.length; b++)a += this.timeline[b].duration;
            return a
        }
    }), c.Tween.prototype.constructor = c.Tween, c.TweenData = function (a) {
        this.parent = a, this.game = a.game, this.vStart = {}, this.vStartCache = {}, this.vEnd = {}, this.vEndCache = {}, this.duration = 1e3, this.percent = 0, this.value = 0, this.repeatCounter = 0, this.repeatDelay = 0, this.repeatTotal = 0, this.interpolate = !1, this.yoyo = !1, this.yoyoDelay = 0, this.inReverse = !1, this.delay = 0, this.dt = 0, this.startTime = null, this.easingFunction = c.Easing.Default, this.interpolationFunction = c.Math.linearInterpolation, this.interpolationContext = c.Math, this.isRunning = !1, this.isFrom = !1
    }, c.TweenData.PENDING = 0,
        c.TweenData.RUNNING = 1, c.TweenData.LOOPED = 2, c.TweenData.COMPLETE = 3, c.TweenData.prototype = {
        to: function (a, b, c, d, e, f) {
            return this.vEnd = a, this.duration = b, this.easingFunction = c, this.delay = d, this.repeatTotal = e, this.yoyo = f, this.isFrom = !1, this
        }, from: function (a, b, c, d, e, f) {
            return this.vEnd = a, this.duration = b, this.easingFunction = c, this.delay = d, this.repeatTotal = e, this.yoyo = f, this.isFrom = !0, this
        }, start: function () {
            if (this.startTime = this.game.time.time + this.delay, this.parent.reverse ? this.dt = this.duration : this.dt = 0, this.delay > 0 ? this.isRunning = !1 : this.isRunning = !0, this.isFrom)for (var a in this.vStartCache)this.vStart[a] = this.vEndCache[a], this.vEnd[a] = this.vStartCache[a], this.parent.target[a] = this.vStart[a];
            return this.value = 0, this.yoyoCounter = 0, this.repeatCounter = this.repeatTotal, this
        }, loadValues: function () {
            for (var a in this.parent.properties) {
                if (this.vStart[a] = this.parent.properties[a], Array.isArray(this.vEnd[a])) {
                    if (0 === this.vEnd[a].length)continue;
                    0 === this.percent && (this.vEnd[a] = [this.vStart[a]].concat(this.vEnd[a]))
                }
                "undefined" != typeof this.vEnd[a] ? ("string" == typeof this.vEnd[a] && (this.vEnd[a] = this.vStart[a] + parseFloat(this.vEnd[a], 10)), this.parent.properties[a] = this.vEnd[a]) : this.vEnd[a] = this.vStart[a], this.vStartCache[a] = this.vStart[a], this.vEndCache[a] = this.vEnd[a]
            }
            return this
        }, update: function (a) {
            if (this.isRunning) {
                if (a < this.startTime)return c.TweenData.RUNNING
            } else {
                if (!(a >= this.startTime))return c.TweenData.PENDING;
                this.isRunning = !0
            }
            var b = this.parent.frameBased ? this.game.time.physicsElapsedMS : this.game.time.elapsedMS;
            this.parent.reverse ? (this.dt -= b * this.parent.timeScale, this.dt = Math.max(this.dt, 0)) : (this.dt += b * this.parent.timeScale, this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, this.value = this.easingFunction(this.percent);
            for (var d in this.vEnd) {
                var e = this.vStart[d], f = this.vEnd[d];
                Array.isArray(f) ? this.parent.target[d] = this.interpolationFunction.call(this.interpolationContext, f, this.value) : this.parent.target[d] = e + (f - e) * this.value
            }
            return !this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent ? this.repeat() : c.TweenData.RUNNING
        }, generateData: function (a) {
            this.parent.reverse ? this.dt = this.duration : this.dt = 0;
            var b = [], c = !1, d = 1 / a * 1e3;
            do {
                this.parent.reverse ? (this.dt -= d, this.dt = Math.max(this.dt, 0)) : (this.dt += d, this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, this.value = this.easingFunction(this.percent);
                var e = {};
                for (var f in this.vEnd) {
                    var g = this.vStart[f], h = this.vEnd[f];
                    Array.isArray(h) ? e[f] = this.interpolationFunction(h, this.value) : e[f] = g + (h - g) * this.value
                }
                b.push(e), (!this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent) && (c = !0)
            } while (!c);
            if (this.yoyo) {
                var i = b.slice();
                i.reverse(), b = b.concat(i)
            }
            return b
        }, repeat: function () {
            if (this.yoyo) {
                if (this.inReverse && 0 === this.repeatCounter) {
                    for (var a in this.vStartCache)this.vStart[a] = this.vStartCache[a], this.vEnd[a] = this.vEndCache[a];
                    return this.inReverse = !1, c.TweenData.COMPLETE
                }
                this.inReverse = !this.inReverse
            } else if (0 === this.repeatCounter)return c.TweenData.COMPLETE;
            if (this.inReverse)for (var a in this.vStartCache)this.vStart[a] = this.vEndCache[a], this.vEnd[a] = this.vStartCache[a]; else {
                for (var a in this.vStartCache)this.vStart[a] = this.vStartCache[a], this.vEnd[a] = this.vEndCache[a];
                this.repeatCounter > 0 && this.repeatCounter--
            }
            return this.startTime = this.game.time.time, this.yoyo && this.inReverse ? this.startTime += this.yoyoDelay : this.inReverse || (this.startTime += this.repeatDelay), this.parent.reverse ? this.dt = this.duration : this.dt = 0, c.TweenData.LOOPED
        }
    }, c.TweenData.prototype.constructor = c.TweenData, c.Easing = {
        Linear: {
            None: function (a) {
                return a
            }
        }, Quadratic: {
            In: function (a) {
                return a * a
            }, Out: function (a) {
                return a * (2 - a)
            }, InOut: function (a) {
                return (a *= 2) < 1 ? .5 * a * a : -.5 * (--a * (a - 2) - 1)
            }
        }, Cubic: {
            In: function (a) {
                return a * a * a
            }, Out: function (a) {
                return --a * a * a + 1
            }, InOut: function (a) {
                return (a *= 2) < 1 ? .5 * a * a * a : .5 * ((a -= 2) * a * a + 2)
            }
        }, Quartic: {
            In: function (a) {
                return a * a * a * a
            }, Out: function (a) {
                return 1 - --a * a * a * a
            }, InOut: function (a) {
                return (a *= 2) < 1 ? .5 * a * a * a * a : -.5 * ((a -= 2) * a * a * a - 2)
            }
        }, Quintic: {
            In: function (a) {
                return a * a * a * a * a
            }, Out: function (a) {
                return --a * a * a * a * a + 1
            }, InOut: function (a) {
                return (a *= 2) < 1 ? .5 * a * a * a * a * a : .5 * ((a -= 2) * a * a * a * a + 2)
            }
        }, Sinusoidal: {
            In: function (a) {
                return 0 === a ? 0 : 1 === a ? 1 : 1 - Math.cos(a * Math.PI / 2)
            }, Out: function (a) {
                return 0 === a ? 0 : 1 === a ? 1 : Math.sin(a * Math.PI / 2)
            }, InOut: function (a) {
                return 0 === a ? 0 : 1 === a ? 1 : .5 * (1 - Math.cos(Math.PI * a))
            }
        }, Exponential: {
            In: function (a) {
                return 0 === a ? 0 : Math.pow(1024, a - 1)
            }, Out: function (a) {
                return 1 === a ? 1 : 1 - Math.pow(2, -10 * a)
            }, InOut: function (a) {
                return 0 === a ? 0 : 1 === a ? 1 : (a *= 2) < 1 ? .5 * Math.pow(1024, a - 1) : .5 * (-Math.pow(2, -10 * (a - 1)) + 2)
            }
        }, Circular: {
            In: function (a) {
                return 1 - Math.sqrt(1 - a * a)
            }, Out: function (a) {
                return Math.sqrt(1 - --a * a)
            }, InOut: function (a) {
                return (a *= 2) < 1 ? -.5 * (Math.sqrt(1 - a * a) - 1) : .5 * (Math.sqrt(1 - (a -= 2) * a) + 1)
            }
        }, Elastic: {
            In: function (a) {
                var b, c = .1, d = .4;
                return 0 === a ? 0 : 1 === a ? 1 : (!c || 1 > c ? (c = 1, b = d / 4) : b = d * Math.asin(1 / c) / (2 * Math.PI), -(c * Math.pow(2, 10 * (a -= 1)) * Math.sin((a - b) * (2 * Math.PI) / d)))
            }, Out: function (a) {
                var b, c = .1, d = .4;
                return 0 === a ? 0 : 1 === a ? 1 : (!c || 1 > c ? (c = 1, b = d / 4) : b = d * Math.asin(1 / c) / (2 * Math.PI), c * Math.pow(2, -10 * a) * Math.sin((a - b) * (2 * Math.PI) / d) + 1)
            }, InOut: function (a) {
                var b, c = .1, d = .4;
                return 0 === a ? 0 : 1 === a ? 1 : (!c || 1 > c ? (c = 1, b = d / 4) : b = d * Math.asin(1 / c) / (2 * Math.PI), (a *= 2) < 1 ? -.5 * (c * Math.pow(2, 10 * (a -= 1)) * Math.sin((a - b) * (2 * Math.PI) / d)) : c * Math.pow(2, -10 * (a -= 1)) * Math.sin((a - b) * (2 * Math.PI) / d) * .5 + 1)
            }
        }, Back: {
            In: function (a) {
                var b = 1.70158;
                return a * a * ((b + 1) * a - b)
            }, Out: function (a) {
                var b = 1.70158;
                return --a * a * ((b + 1) * a + b) + 1
            }, InOut: function (a) {
                var b = 2.5949095;
                return (a *= 2) < 1 ? .5 * (a * a * ((b + 1) * a - b)) : .5 * ((a -= 2) * a * ((b + 1) * a + b) + 2)
            }
        }, Bounce: {
            In: function (a) {
                return 1 - c.Easing.Bounce.Out(1 - a)
            }, Out: function (a) {
                return 1 / 2.75 > a ? 7.5625 * a * a : 2 / 2.75 > a ? 7.5625 * (a -= 1.5 / 2.75) * a + .75 : 2.5 / 2.75 > a ? 7.5625 * (a -= 2.25 / 2.75) * a + .9375 : 7.5625 * (a -= 2.625 / 2.75) * a + .984375
            }, InOut: function (a) {
                return .5 > a ? .5 * c.Easing.Bounce.In(2 * a) : .5 * c.Easing.Bounce.Out(2 * a - 1) + .5
            }
        }
    }, c.Easing.Default = c.Easing.Linear.None, c.Easing.Power0 = c.Easing.Linear.None, c.Easing.Power1 = c.Easing.Quadratic.Out, c.Easing.Power2 = c.Easing.Cubic.Out, c.Easing.Power3 = c.Easing.Quartic.Out, c.Easing.Power4 = c.Easing.Quintic.Out, c.Time = function (a) {
        this.game = a, this.time = 0, this.prevTime = 0, this.now = 0, this.elapsed = 0, this.elapsedMS = 0, this.physicsElapsed = 1 / 60, this.physicsElapsedMS = 1 / 60 * 1e3, this.desiredFpsMult = 1 / 60, this._desiredFps = 60, this.suggestedFps = this.desiredFps, this.slowMotion = 1, this.advancedTiming = !1, this.frames = 0, this.fps = 0, this.fpsMin = 1e3, this.fpsMax = 0, this.msMin = 1e3, this.msMax = 0, this.pauseDuration = 0, this.timeToCall = 0, this.timeExpected = 0, this.events = new c.Timer(this.game, !1), this._frameCount = 0, this._elapsedAccumulator = 0, this._started = 0, this._timeLastSecond = 0, this._pauseStarted = 0, this._justResumed = !1, this._timers = []
    }, c.Time.prototype = {
        boot: function () {
            this._started = Date.now(), this.time = Date.now(), this.events.start(), this.timeExpected = this.time
        }, add: function (a) {
            return this._timers.push(a), a
        }, create: function (a) {
            void 0 === a && (a = !0);
            var b = new c.Timer(this.game, a);
            return this._timers.push(b), b
        }, removeAll: function () {
            for (var a = 0; a < this._timers.length; a++)this._timers[a].destroy();
            this._timers = [], this.events.removeAll()
        }, refresh: function () {
            var a = this.time;
            this.time = Date.now(), this.elapsedMS = this.time - a
        }, update: function (a) {
            var b = this.time;
            this.time = Date.now(), this.elapsedMS = this.time - b, this.prevTime = this.now, this.now = a, this.elapsed = this.now - this.prevTime, this.game.raf._isSetTimeOut && (this.timeToCall = Math.floor(Math.max(0, 1e3 / this._desiredFps - (this.timeExpected - a))), this.timeExpected = a + this.timeToCall), this.advancedTiming && this.updateAdvancedTiming(), this.game.paused || (this.events.update(this.time), this._timers.length && this.updateTimers())
        }, updateTimers: function () {
            for (var a = 0, b = this._timers.length; b > a;)this._timers[a].update(this.time) ? a++ : (this._timers.splice(a, 1), b--)
        }, updateAdvancedTiming: function () {
            this._frameCount++, this._elapsedAccumulator += this.elapsed, this._frameCount >= 2 * this._desiredFps && (this.suggestedFps = 5 * Math.floor(200 / (this._elapsedAccumulator / this._frameCount)), this._frameCount = 0, this._elapsedAccumulator = 0), this.msMin = Math.min(this.msMin, this.elapsed), this.msMax = Math.max(this.msMax, this.elapsed), this.frames++, this.now > this._timeLastSecond + 1e3 && (this.fps = Math.round(1e3 * this.frames / (this.now - this._timeLastSecond)), this.fpsMin = Math.min(this.fpsMin, this.fps), this.fpsMax = Math.max(this.fpsMax, this.fps), this._timeLastSecond = this.now, this.frames = 0)
        }, gamePaused: function () {
            this._pauseStarted = Date.now(), this.events.pause();
            for (var a = this._timers.length; a--;)this._timers[a]._pause()
        }, gameResumed: function () {
            this.time = Date.now(), this.pauseDuration = this.time - this._pauseStarted, this.events.resume();
            for (var a = this._timers.length; a--;)this._timers[a]._resume()
        }, totalElapsedSeconds: function () {
            return .001 * (this.time - this._started)
        }, elapsedSince: function (a) {
            return this.time - a
        }, elapsedSecondsSince: function (a) {
            return .001 * (this.time - a)
        }, reset: function () {
            this._started = this.time, this.removeAll()
        }
    }, Object.defineProperty(c.Time.prototype, "desiredFps", {
        get: function () {
            return this._desiredFps
        }, set: function (a) {
            this._desiredFps = a, this.physicsElapsed = 1 / a, this.physicsElapsedMS = 1e3 * this.physicsElapsed, this.desiredFpsMult = 1 / a
        }
    }), c.Time.prototype.constructor = c.Time, c.Timer = function (a, b) {
        void 0 === b && (b = !0), this.game = a, this.running = !1, this.autoDestroy = b, this.expired = !1, this.elapsed = 0, this.events = [], this.onComplete = new c.Signal, this.nextTick = 0, this.timeCap = 1e3, this.paused = !1, this._codePaused = !1, this._started = 0, this._pauseStarted = 0, this._pauseTotal = 0, this._now = Date.now(), this._len = 0, this._marked = 0, this._i = 0, this._diff = 0, this._newTick = 0
    }, c.Timer.MINUTE = 6e4, c.Timer.SECOND = 1e3, c.Timer.HALF = 500, c.Timer.QUARTER = 250, c.Timer.prototype = {
        create: function (a, b, d, e, f, g) {
            a = Math.round(a);
            var h = a;
            h += 0 === this._now ? this.game.time.time : this._now;
            var i = new c.TimerEvent(this, a, h, d, b, e, f, g);
            return this.events.push(i), this.order(), this.expired = !1, i
        }, add: function (a, b, c) {
            return this.create(a, !1, 0, b, c, Array.prototype.slice.call(arguments, 3))
        }, repeat: function (a, b, c, d) {
            return this.create(a, !1, b, c, d, Array.prototype.slice.call(arguments, 4))
        }, loop: function (a, b, c) {
            return this.create(a, !0, 0, b, c, Array.prototype.slice.call(arguments, 3))
        }, start: function (a) {
            if (!this.running) {
                this._started = this.game.time.time + (a || 0), this.running = !0;
                for (var b = 0; b < this.events.length; b++)this.events[b].tick = this.events[b].delay + this._started
            }
        }, stop: function (a) {
            this.running = !1, void 0 === a && (a = !0), a && (this.events.length = 0)
        }, remove: function (a) {
            for (var b = 0; b < this.events.length; b++)if (this.events[b] === a)return this.events[b].pendingDelete = !0, !0;
            return !1
        }, order: function () {
            this.events.length > 0 && (this.events.sort(this.sortHandler), this.nextTick = this.events[0].tick)
        }, sortHandler: function (a, b) {
            return a.tick < b.tick ? -1 : a.tick > b.tick ? 1 : 0
        }, clearPendingEvents: function () {
            for (this._i = this.events.length; this._i--;)this.events[this._i].pendingDelete && this.events.splice(this._i, 1);
            this._len = this.events.length, this._i = 0
        }, update: function (a) {
            if (this.paused)return !0;
            if (this.elapsed = a - this._now, this._now = a, this.elapsed > this.timeCap && this.adjustEvents(a - this.elapsed), this._marked = 0, this.clearPendingEvents(), this.running && this._now >= this.nextTick && this._len > 0) {
                for (; this._i < this._len && this.running && this._now >= this.events[this._i].tick && !this.events[this._i].pendingDelete;)this._newTick = this._now + this.events[this._i].delay - (this._now - this.events[this._i].tick), this._newTick < 0 && (this._newTick = this._now + this.events[this._i].delay), this.events[this._i].loop === !0 ? (this.events[this._i].tick = this._newTick, this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args)) : this.events[this._i].repeatCount > 0 ? (this.events[this._i].repeatCount--, this.events[this._i].tick = this._newTick, this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args)) : (this._marked++, this.events[this._i].pendingDelete = !0, this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args)), this._i++;
                this.events.length > this._marked ? this.order() : (this.expired = !0, this.onComplete.dispatch(this))
            }
            return this.expired && this.autoDestroy ? !1 : !0
        }, pause: function () {
            this.running && (this._codePaused = !0, this.paused || (this._pauseStarted = this.game.time.time, this.paused = !0))
        }, _pause: function () {
            !this.paused && this.running && (this._pauseStarted = this.game.time.time, this.paused = !0)
        }, adjustEvents: function (a) {
            for (var b = 0; b < this.events.length; b++)if (!this.events[b].pendingDelete) {
                var c = this.events[b].tick - a;
                0 > c && (c = 0), this.events[b].tick = this._now + c
            }
            var d = this.nextTick - a;
            0 > d ? this.nextTick = this._now : this.nextTick = this._now + d
        }, resume: function () {
            if (this.paused) {
                var a = this.game.time.time;
                this._pauseTotal += a - this._now, this._now = a, this.adjustEvents(this._pauseStarted), this.paused = !1, this._codePaused = !1
            }
        }, _resume: function () {
            this._codePaused || this.resume()
        }, removeAll: function () {
            this.onComplete.removeAll(), this.events.length = 0, this._len = 0, this._i = 0
        }, destroy: function () {
            this.onComplete.removeAll(), this.running = !1, this.events = [], this._len = 0, this._i = 0
        }
    }, Object.defineProperty(c.Timer.prototype, "next", {
        get: function () {
            return this.nextTick
        }
    }), Object.defineProperty(c.Timer.prototype, "duration", {
        get: function () {
            return this.running && this.nextTick > this._now ? this.nextTick - this._now : 0
        }
    }), Object.defineProperty(c.Timer.prototype, "length", {
        get: function () {
            return this.events.length
        }
    }), Object.defineProperty(c.Timer.prototype, "ms", {
        get: function () {
            return this.running ? this._now - this._started - this._pauseTotal : 0
        }
    }), Object.defineProperty(c.Timer.prototype, "seconds", {
        get: function () {
            return this.running ? .001 * this.ms : 0
        }
    }), c.Timer.prototype.constructor = c.Timer, c.TimerEvent = function (a, b, c, d, e, f, g, h) {
        this.timer = a, this.delay = b, this.tick = c, this.repeatCount = d - 1, this.loop = e, this.callback = f, this.callbackContext = g, this.args = h, this.pendingDelete = !1
    }, c.TimerEvent.prototype.constructor = c.TimerEvent, c.AnimationManager = function (a) {
        this.sprite = a, this.game = a.game, this.currentFrame = null, this.currentAnim = null, this.updateIfVisible = !0, this.isLoaded = !1, this._frameData = null, this._anims = {}, this._outputFrames = []
    }, c.AnimationManager.prototype = {
        loadFrameData: function (a, b) {
            if (void 0 === a)return !1;
            if (this.isLoaded)for (var c in this._anims)this._anims[c].updateFrameData(a);
            return this._frameData = a, void 0 === b || null === b ? this.frame = 0 : "string" == typeof b ? this.frameName = b : this.frame = b, this.isLoaded = !0, !0
        }, copyFrameData: function (a, b) {
            if (this._frameData = a.clone(), this.isLoaded)for (var c in this._anims)this._anims[c].updateFrameData(this._frameData);
            return void 0 === b || null === b ? this.frame = 0 : "string" == typeof b ? this.frameName = b : this.frame = b, this.isLoaded = !0, !0
        }, add: function (a, b, d, e, f) {
            return b = b || [], d = d || 60, void 0 === e && (e = !1), void 0 === f && (f = b && "number" == typeof b[0] ? !0 : !1), this._outputFrames = [], this._frameData.getFrameIndexes(b, f, this._outputFrames), this._anims[a] = new c.Animation(this.game, this.sprite, a, this._frameData, this._outputFrames, d, e), this.currentAnim = this._anims[a], this.sprite.tilingTexture && (this.sprite.refreshTexture = !0), this._anims[a]
        }, validateFrames: function (a, b) {
            void 0 === b && (b = !0);
            for (var c = 0; c < a.length; c++)if (b === !0) {
                if (a[c] > this._frameData.total)return !1
            } else if (this._frameData.checkFrameName(a[c]) === !1)return !1;
            return !0
        }, play: function (a, b, c, d) {
            return this._anims[a] ? this.currentAnim === this._anims[a] ? this.currentAnim.isPlaying === !1 ? (this.currentAnim.paused = !1, this.currentAnim.play(b, c, d)) : this.currentAnim : (this.currentAnim && this.currentAnim.isPlaying && this.currentAnim.stop(), this.currentAnim = this._anims[a], this.currentAnim.paused = !1, this.currentFrame = this.currentAnim.currentFrame, this.currentAnim.play(b, c, d)) : void 0
        }, stop: function (a, b) {
            void 0 === b && (b = !1), !this.currentAnim || "string" == typeof a && a !== this.currentAnim.name || this.currentAnim.stop(b)
        }, update: function () {
            return this.updateIfVisible && !this.sprite.visible ? !1 : this.currentAnim && this.currentAnim.update() ? (this.currentFrame = this.currentAnim.currentFrame, !0) : !1
        }, next: function (a) {
            this.currentAnim && (this.currentAnim.next(a), this.currentFrame = this.currentAnim.currentFrame)
        }, previous: function (a) {
            this.currentAnim && (this.currentAnim.previous(a), this.currentFrame = this.currentAnim.currentFrame)
        }, getAnimation: function (a) {
            return "string" == typeof a && this._anims[a] ? this._anims[a] : null
        }, refreshFrame: function () {
        }, destroy: function () {
            var a = null;
            for (var a in this._anims)this._anims.hasOwnProperty(a) && this._anims[a].destroy();
            this._anims = {}, this._outputFrames = [], this._frameData = null, this.currentAnim = null, this.currentFrame = null, this.sprite = null, this.game = null
        }
    }, c.AnimationManager.prototype.constructor = c.AnimationManager, Object.defineProperty(c.AnimationManager.prototype, "frameData", {
        get: function () {
            return this._frameData
        }
    }), Object.defineProperty(c.AnimationManager.prototype, "frameTotal", {
        get: function () {
            return this._frameData.total
        }
    }), Object.defineProperty(c.AnimationManager.prototype, "paused", {
        get: function () {
            return this.currentAnim.isPaused
        }, set: function (a) {
            this.currentAnim.paused = a
        }
    }), Object.defineProperty(c.AnimationManager.prototype, "name", {
        get: function () {
            return this.currentAnim ? this.currentAnim.name : void 0
        }
    }), Object.defineProperty(c.AnimationManager.prototype, "frame", {
        get: function () {
            return this.currentFrame ? this.currentFrame.index : void 0
        }, set: function (a) {
            "number" == typeof a && this._frameData && null !== this._frameData.getFrame(a) && (this.currentFrame = this._frameData.getFrame(a), this.currentFrame && this.sprite.setFrame(this.currentFrame))
        }
    }), Object.defineProperty(c.AnimationManager.prototype, "frameName", {
        get: function () {
            return this.currentFrame ? this.currentFrame.name : void 0
        }, set: function (a) {
            "string" == typeof a && this._frameData && null !== this._frameData.getFrameByName(a) ? (this.currentFrame = this._frameData.getFrameByName(a), this.currentFrame && (this._frameIndex = this.currentFrame.index, this.sprite.setFrame(this.currentFrame))) : console.warn("Cannot set frameName: " + a)
        }
    }), c.Animation = function (a, b, d, e, f, g, h) {
        void 0 === h && (h = !1), this.game = a, this._parent = b, this._frameData = e, this.name = d, this._frames = [], this._frames = this._frames.concat(f), this.delay = 1e3 / g, this.loop = h, this.loopCount = 0, this.killOnComplete = !1, this.isFinished = !1, this.isPlaying = !1, this.isPaused = !1, this._pauseStartTime = 0, this._frameIndex = 0, this._frameDiff = 0, this._frameSkip = 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.onStart = new c.Signal, this.onUpdate = null, this.onComplete = new c.Signal, this.onLoop = new c.Signal, this.isReversed = !1, this.game.onPause.add(this.onPause, this), this.game.onResume.add(this.onResume, this)
    }, c.Animation.prototype = {
        play: function (a, b, c) {
            return "number" == typeof a && (this.delay = 1e3 / a), "boolean" == typeof b && (this.loop = b), "undefined" != typeof c && (this.killOnComplete = c), this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = this.isReversed ? this._frames.length - 1 : 0, this.updateCurrentFrame(!1, !0), this._parent.events.onAnimationStart$dispatch(this._parent, this), this.onStart.dispatch(this._parent, this), this._parent.animations.currentAnim = this, this._parent.animations.currentFrame = this.currentFrame, this
        }, restart: function () {
            this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = 0, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this._parent.setFrame(this.currentFrame), this._parent.animations.currentAnim = this, this._parent.animations.currentFrame = this.currentFrame, this.onStart.dispatch(this._parent, this)
        }, reverse: function () {
            return this.reversed = !this.reversed, this
        }, reverseOnce: function () {
            return this.onComplete.addOnce(this.reverse.bind(this)), this.reverse()
        }, setFrame: function (a, b) {
            var c;
            if (void 0 === b && (b = !1), "string" == typeof a)for (var d = 0; d < this._frames.length; d++)this._frameData.getFrame(this._frames[d]).name === a && (c = d); else if ("number" == typeof a)if (b)c = a; else for (var d = 0; d < this._frames.length; d++)this._frames[d] === a && (c = d);
            c && (this._frameIndex = c - 1, this._timeNextFrame = this.game.time.time, this.update())
        }, stop: function (a, b) {
            void 0 === a && (a = !1), void 0 === b && (b = !1), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, a && (this.currentFrame = this._frameData.getFrame(this._frames[0]), this._parent.setFrame(this.currentFrame)), b && (this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this))
        }, onPause: function () {
            this.isPlaying && (this._frameDiff = this._timeNextFrame - this.game.time.time)
        }, onResume: function () {
            this.isPlaying && (this._timeNextFrame = this.game.time.time + this._frameDiff)
        }, update: function () {
            return this.isPaused ? !1 : this.isPlaying && this.game.time.time >= this._timeNextFrame ? (this._frameSkip = 1, this._frameDiff = this.game.time.time - this._timeNextFrame, this._timeLastFrame = this.game.time.time, this._frameDiff > this.delay && (this._frameSkip = Math.floor(this._frameDiff / this.delay), this._frameDiff -= this._frameSkip * this.delay), this._timeNextFrame = this.game.time.time + (this.delay - this._frameDiff), this.isReversed ? this._frameIndex -= this._frameSkip : this._frameIndex += this._frameSkip, !this.isReversed && this._frameIndex >= this._frames.length || this.isReversed && this._frameIndex <= -1 ? this.loop ? (this._frameIndex = Math.abs(this._frameIndex) % this._frames.length, this.isReversed && (this._frameIndex = this._frames.length - 1 - this._frameIndex), this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && this._parent.setFrame(this.currentFrame), this.loopCount++, this._parent.events.onAnimationLoop$dispatch(this._parent, this), this.onLoop.dispatch(this._parent, this), this.onUpdate ? (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData) : !0) : (this.complete(), !1) : this.updateCurrentFrame(!0)) : !1
        }, updateCurrentFrame: function (a, b) {
            if (void 0 === b && (b = !1), !this._frameData)return !1;
            var c = this.currentFrame.index;
            return this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && (b || !b && c !== this.currentFrame.index) && this._parent.setFrame(this.currentFrame), this.onUpdate && a ? (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData) : !0
        }, next: function (a) {
            void 0 === a && (a = 1);
            var b = this._frameIndex + a;
            b >= this._frames.length && (this.loop ? b %= this._frames.length : b = this._frames.length - 1), b !== this._frameIndex && (this._frameIndex = b, this.updateCurrentFrame(!0))
        }, previous: function (a) {
            void 0 === a && (a = 1);
            var b = this._frameIndex - a;
            0 > b && (this.loop ? b = this._frames.length + b : b++), b !== this._frameIndex && (this._frameIndex = b, this.updateCurrentFrame(!0))
        }, updateFrameData: function (a) {
            this._frameData = a, this.currentFrame = this._frameData ? this._frameData.getFrame(this._frames[this._frameIndex % this._frames.length]) : null
        }, destroy: function () {
            this._frameData && (this.game.onPause.remove(this.onPause, this), this.game.onResume.remove(this.onResume, this), this.game = null, this._parent = null, this._frames = null, this._frameData = null, this.currentFrame = null, this.isPlaying = !1, this.onStart.dispose(), this.onLoop.dispose(), this.onComplete.dispose(), this.onUpdate && this.onUpdate.dispose())
        }, complete: function () {
            this._frameIndex = this._frames.length - 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this), this.killOnComplete && this._parent.kill()
        }
    }, c.Animation.prototype.constructor = c.Animation, Object.defineProperty(c.Animation.prototype, "paused", {
        get: function () {
            return this.isPaused
        }, set: function (a) {
            this.isPaused = a, a ? this._pauseStartTime = this.game.time.time : this.isPlaying && (this._timeNextFrame = this.game.time.time + this.delay)
        }
    }), Object.defineProperty(c.Animation.prototype, "reversed", {
        get: function () {
            return this.isReversed
        }, set: function (a) {
            this.isReversed = a
        }
    }), Object.defineProperty(c.Animation.prototype, "frameTotal", {
        get: function () {
            return this._frames.length
        }
    }), Object.defineProperty(c.Animation.prototype, "frame", {
        get: function () {
            return null !== this.currentFrame ? this.currentFrame.index : this._frameIndex
        }, set: function (a) {
            this.currentFrame = this._frameData.getFrame(this._frames[a]), null !== this.currentFrame && (this._frameIndex = a, this._parent.setFrame(this.currentFrame), this.onUpdate && this.onUpdate.dispatch(this, this.currentFrame))
        }
    }), Object.defineProperty(c.Animation.prototype, "speed", {
        get: function () {
            return Math.round(1e3 / this.delay)
        }, set: function (a) {
            a >= 1 && (this.delay = 1e3 / a)
        }
    }), Object.defineProperty(c.Animation.prototype, "enableUpdate", {
        get: function () {
            return null !== this.onUpdate
        }, set: function (a) {
            a && null === this.onUpdate ? this.onUpdate = new c.Signal : a || null === this.onUpdate || (this.onUpdate.dispose(), this.onUpdate = null)
        }
    }), c.Animation.generateFrameNames = function (a, b, d, e, f) {
        void 0 === e && (e = "");
        var g = [], h = "";
        if (d > b)for (var i = b; d >= i; i++)h = "number" == typeof f ? c.Utils.pad(i.toString(), f, "0", 1) : i.toString(), h = a + h + e, g.push(h); else for (var i = b; i >= d; i--)h = "number" == typeof f ? c.Utils.pad(i.toString(), f, "0", 1) : i.toString(), h = a + h + e, g.push(h);
        return g
    }, c.Frame = function (a, b, d, e, f, g) {
        this.index = a, this.x = b, this.y = d, this.width = e, this.height = f, this.name = g, this.centerX = Math.floor(e / 2), this.centerY = Math.floor(f / 2), this.distance = c.Math.distance(0, 0, e, f), this.rotated = !1, this.rotationDirection = "cw", this.trimmed = !1, this.sourceSizeW = e, this.sourceSizeH = f, this.spriteSourceSizeX = 0, this.spriteSourceSizeY = 0, this.spriteSourceSizeW = 0, this.spriteSourceSizeH = 0, this.right = this.x + this.width, this.bottom = this.y + this.height
    }, c.Frame.prototype = {
        resize: function (a, b) {
            this.width = a, this.height = b, this.centerX = Math.floor(a / 2), this.centerY = Math.floor(b / 2), this.distance = c.Math.distance(0, 0, a, b), this.sourceSizeW = a, this.sourceSizeH = b, this.right = this.x + a, this.bottom = this.y + b
        }, setTrim: function (a, b, c, d, e, f, g) {
            this.trimmed = a, a && (this.sourceSizeW = b, this.sourceSizeH = c, this.centerX = Math.floor(b / 2), this.centerY = Math.floor(c / 2), this.spriteSourceSizeX = d, this.spriteSourceSizeY = e, this.spriteSourceSizeW = f, this.spriteSourceSizeH = g)
        }, clone: function () {
            var a = new c.Frame(this.index, this.x, this.y, this.width, this.height, this.name);
            for (var b in this)this.hasOwnProperty(b) && (a[b] = this[b]);
            return a
        }, getRect: function (a) {
            return void 0 === a ? a = new c.Rectangle(this.x, this.y, this.width, this.height) : a.setTo(this.x, this.y, this.width, this.height), a
        }
    }, c.Frame.prototype.constructor = c.Frame, c.FrameData = function () {
        this._frames = [], this._frameNames = []
    }, c.FrameData.prototype = {
        addFrame: function (a) {
            return a.index = this._frames.length, this._frames.push(a), "" !== a.name && (this._frameNames[a.name] = a.index), a
        }, getFrame: function (a) {
            return a >= this._frames.length && (a = 0), this._frames[a]
        }, getFrameByName: function (a) {
            return "number" == typeof this._frameNames[a] ? this._frames[this._frameNames[a]] : null
        }, checkFrameName: function (a) {
            return null == this._frameNames[a] ? !1 : !0
        }, clone: function () {
            for (var a = new c.FrameData, b = 0; b < this._frames.length; b++)a._frames.push(this._frames[b].clone());
            for (var d in this._frameNames)this._frameNames.hasOwnProperty(d) && a._frameNames.push(this._frameNames[d]);
            return a
        }, getFrameRange: function (a, b, c) {
            void 0 === c && (c = []);
            for (var d = a; b >= d; d++)c.push(this._frames[d]);
            return c
        }, getFrames: function (a, b, c) {
            if (void 0 === b && (b = !0), void 0 === c && (c = []), void 0 === a || 0 === a.length)for (var d = 0; d < this._frames.length; d++)c.push(this._frames[d]); else for (var d = 0; d < a.length; d++)b ? c.push(this.getFrame(a[d])) : c.push(this.getFrameByName(a[d]));
            return c
        }, getFrameIndexes: function (a, b, c) {
            if (void 0 === b && (b = !0), void 0 === c && (c = []), void 0 === a || 0 === a.length)for (var d = 0; d < this._frames.length; d++)c.push(this._frames[d].index); else for (var d = 0; d < a.length; d++)b && this._frames[a[d]] ? c.push(this._frames[a[d]].index) : this.getFrameByName(a[d]) && c.push(this.getFrameByName(a[d]).index);
            return c
        }, destroy: function () {
            this._frames = null, this._frameNames = null
        }
    }, c.FrameData.prototype.constructor = c.FrameData, Object.defineProperty(c.FrameData.prototype, "total", {
        get: function () {
            return this._frames.length
        }
    }), c.AnimationParser = {
        spriteSheet: function (a, b, d, e, f, g, h) {
            var i = b;
            if ("string" == typeof b && (i = a.cache.getImage(b)), null === i)return null;
            var j = i.width, k = i.height;
            0 >= d && (d = Math.floor(-j / Math.min(-1, d))), 0 >= e && (e = Math.floor(-k / Math.min(-1, e)));
            var l = Math.floor((j - g) / (d + h)), m = Math.floor((k - g) / (e + h)), n = l * m;
            if (-1 !== f && (n = f), 0 === j || 0 === k || d > j || e > k || 0 === n)return console.warn("Phaser.AnimationParser.spriteSheet: '" + b + "'s width/height zero or width/height < given frameWidth/frameHeight"), null;
            for (var o = new c.FrameData, p = g, q = g, r = 0; n > r; r++)o.addFrame(new c.Frame(r, p, q, d, e, "")), p += d + h, p + d > j && (p = g, q += e + h);
            return o
        }, JSONData: function (a, b) {
            if (!b.frames)return console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"), void console.log(b);
            for (var d, e = new c.FrameData, f = b.frames, g = 0; g < f.length; g++)d = e.addFrame(new c.Frame(g, f[g].frame.x, f[g].frame.y, f[g].frame.w, f[g].frame.h, f[g].filename)), f[g].trimmed && d.setTrim(f[g].trimmed, f[g].sourceSize.w, f[g].sourceSize.h, f[g].spriteSourceSize.x, f[g].spriteSourceSize.y, f[g].spriteSourceSize.w, f[g].spriteSourceSize.h);
            return e
        }, JSONDataPyxel: function (a, b) {
            var d = ["layers", "tilewidth", "tileheight", "tileswide", "tileshigh"];
            if (d.forEach(function (a) {
                    return b[a] ? void 0 : (console.warn("Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing '" + a + "' key."), void console.log(b))
                }), 1 != b.layers.length)return console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps."), void console.log(b);
            for (var e, f = new c.FrameData, g = b.tileheight, h = b.tilewidth, i = b.layers[0].tiles, j = 0; j < i.length; j++)e = f.addFrame(new c.Frame(j, i[j].x, i[j].y, h, g, "frame_" + j)), e.setTrim(!1);
            return f
        }, JSONDataHash: function (a, b) {
            if (!b.frames)return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"), void console.log(b);
            var d, e = new c.FrameData, f = b.frames, g = 0;
            for (var h in f)d = e.addFrame(new c.Frame(g, f[h].frame.x, f[h].frame.y, f[h].frame.w, f[h].frame.h, h)), f[h].trimmed && d.setTrim(f[h].trimmed, f[h].sourceSize.w, f[h].sourceSize.h, f[h].spriteSourceSize.x, f[h].spriteSourceSize.y, f[h].spriteSourceSize.w, f[h].spriteSourceSize.h), g++;
            return e
        }, XMLData: function (a, b) {
            if (!b.getElementsByTagName("TextureAtlas"))return void console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag");
            for (var d, e, f, g, h, i, j, k, l, m, n, o = new c.FrameData, p = b.getElementsByTagName("SubTexture"), q = 0; q < p.length; q++)f = p[q].attributes, e = f.name.value, g = parseInt(f.x.value, 10), h = parseInt(f.y.value, 10), i = parseInt(f.width.value, 10), j = parseInt(f.height.value, 10), k = null, l = null, f.frameX && (k = Math.abs(parseInt(f.frameX.value, 10)), l = Math.abs(parseInt(f.frameY.value, 10)), m = parseInt(f.frameWidth.value, 10), n = parseInt(f.frameHeight.value, 10)), d = o.addFrame(new c.Frame(q, g, h, i, j, e)), (null !== k || null !== l) && d.setTrim(!0, i, j, k, l, m, n);
            return o
        }
    }, c.Cache = function (a) {
        this.game = a, this.autoResolveURL = !1, this._cache = {
            canvas: {},
            image: {},
            texture: {},
            sound: {},
            video: {},
            text: {},
            json: {},
            xml: {},
            physics: {},
            tilemap: {},
            binary: {},
            bitmapData: {},
            bitmapFont: {},
            shader: {},
            renderTexture: {}
        }, this._urlMap = {}, this._urlResolver = new Image, this._urlTemp = null, this.onSoundUnlock = new c.Signal, this._cacheMap = [], this._cacheMap[c.Cache.CANVAS] = this._cache.canvas, this._cacheMap[c.Cache.IMAGE] = this._cache.image, this._cacheMap[c.Cache.TEXTURE] = this._cache.texture, this._cacheMap[c.Cache.SOUND] = this._cache.sound, this._cacheMap[c.Cache.TEXT] = this._cache.text, this._cacheMap[c.Cache.PHYSICS] = this._cache.physics, this._cacheMap[c.Cache.TILEMAP] = this._cache.tilemap, this._cacheMap[c.Cache.BINARY] = this._cache.binary, this._cacheMap[c.Cache.BITMAPDATA] = this._cache.bitmapData, this._cacheMap[c.Cache.BITMAPFONT] = this._cache.bitmapFont, this._cacheMap[c.Cache.JSON] = this._cache.json, this._cacheMap[c.Cache.XML] = this._cache.xml, this._cacheMap[c.Cache.VIDEO] = this._cache.video, this._cacheMap[c.Cache.SHADER] = this._cache.shader, this._cacheMap[c.Cache.RENDER_TEXTURE] = this._cache.renderTexture, this.addDefaultImage(), this.addMissingImage()
    }, c.Cache.CANVAS = 1, c.Cache.IMAGE = 2, c.Cache.TEXTURE = 3, c.Cache.SOUND = 4, c.Cache.TEXT = 5, c.Cache.PHYSICS = 6, c.Cache.TILEMAP = 7, c.Cache.BINARY = 8, c.Cache.BITMAPDATA = 9, c.Cache.BITMAPFONT = 10, c.Cache.JSON = 11,
        c.Cache.XML = 12, c.Cache.VIDEO = 13, c.Cache.SHADER = 14, c.Cache.RENDER_TEXTURE = 15, c.Cache.DEFAULT = null, c.Cache.MISSING = null, c.Cache.prototype = {
        addCanvas: function (a, b, c) {
            void 0 === c && (c = b.getContext("2d")), this._cache.canvas[a] = {canvas: b, context: c}
        }, addImage: function (a, b, d) {
            this.checkImageKey(a) && this.removeImage(a);
            var e = {
                key: a,
                url: b,
                data: d,
                base: new PIXI.BaseTexture(d),
                frame: new c.Frame(0, 0, 0, d.width, d.height, a),
                frameData: new c.FrameData
            };
            return e.frameData.addFrame(new c.Frame(0, 0, 0, d.width, d.height, b)), this._cache.image[a] = e, this._resolveURL(b, e), "__default" === a ? c.Cache.DEFAULT = new PIXI.Texture(e.base) : "__missing" === a && (c.Cache.MISSING = new PIXI.Texture(e.base)), e
        }, addDefaultImage: function () {
            var a = new Image;
            a.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";
            var b = this.addImage("__default", null, a);
            b.base.skipRender = !0, c.Cache.DEFAULT = new PIXI.Texture(b.base)
        }, addMissingImage: function () {
            var a = new Image;
            a.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";
            var b = this.addImage("__missing", null, a);
            c.Cache.MISSING = new PIXI.Texture(b.base)
        }, addSound: function (a, b, c, d, e) {
            void 0 === d && (d = !0, e = !1), void 0 === e && (d = !1, e = !0);
            var f = !1;
            e && (f = !0), this._cache.sound[a] = {
                url: b,
                data: c,
                isDecoding: !1,
                decoded: f,
                webAudio: d,
                audioTag: e,
                locked: this.game.sound.touchLocked
            }, this._resolveURL(b, this._cache.sound[a])
        }, addText: function (a, b, c) {
            this._cache.text[a] = {url: b, data: c}, this._resolveURL(b, this._cache.text[a])
        }, addPhysicsData: function (a, b, c, d) {
            this._cache.physics[a] = {url: b, data: c, format: d}, this._resolveURL(b, this._cache.physics[a])
        }, addTilemap: function (a, b, c, d) {
            this._cache.tilemap[a] = {url: b, data: c, format: d}, this._resolveURL(b, this._cache.tilemap[a])
        }, addBinary: function (a, b) {
            this._cache.binary[a] = b
        }, addBitmapData: function (a, b, d) {
            return b.key = a, void 0 === d && (d = new c.FrameData, d.addFrame(b.textureFrame)), this._cache.bitmapData[a] = {
                data: b,
                frameData: d
            }, b
        }, addBitmapFont: function (a, b, d, e, f, g, h) {
            var i = {url: b, data: d, font: null, base: new PIXI.BaseTexture(d)};
            void 0 === g && (g = 0), void 0 === h && (h = 0), "json" === f ? i.font = c.LoaderParser.jsonBitmapFont(e, i.base, g, h) : i.font = c.LoaderParser.xmlBitmapFont(e, i.base, g, h), this._cache.bitmapFont[a] = i, this._resolveURL(b, i)
        }, addJSON: function (a, b, c) {
            this._cache.json[a] = {url: b, data: c}, this._resolveURL(b, this._cache.json[a])
        }, addXML: function (a, b, c) {
            this._cache.xml[a] = {url: b, data: c}, this._resolveURL(b, this._cache.xml[a])
        }, addVideo: function (a, b, c, d) {
            this._cache.video[a] = {url: b, data: c, isBlob: d, locked: !0}, this._resolveURL(b, this._cache.video[a])
        }, addShader: function (a, b, c) {
            this._cache.shader[a] = {url: b, data: c}, this._resolveURL(b, this._cache.shader[a])
        }, addRenderTexture: function (a, b) {
            this._cache.renderTexture[a] = {texture: b, frame: new c.Frame(0, 0, 0, b.width, b.height, "", "")}
        }, addSpriteSheet: function (a, b, d, e, f, g, h, i) {
            void 0 === g && (g = -1), void 0 === h && (h = 0), void 0 === i && (i = 0);
            var j = {
                key: a,
                url: b,
                data: d,
                frameWidth: e,
                frameHeight: f,
                margin: h,
                spacing: i,
                base: new PIXI.BaseTexture(d),
                frameData: c.AnimationParser.spriteSheet(this.game, d, e, f, g, h, i)
            };
            this._cache.image[a] = j, this._resolveURL(b, j)
        }, addTextureAtlas: function (a, b, d, e, f) {
            var g = {key: a, url: b, data: d, base: new PIXI.BaseTexture(d)};
            f === c.Loader.TEXTURE_ATLAS_XML_STARLING ? g.frameData = c.AnimationParser.XMLData(this.game, e, a) : f === c.Loader.TEXTURE_ATLAS_JSON_PYXEL ? g.frameData = c.AnimationParser.JSONDataPyxel(this.game, e, a) : Array.isArray(e.frames) ? g.frameData = c.AnimationParser.JSONData(this.game, e, a) : g.frameData = c.AnimationParser.JSONDataHash(this.game, e, a), this._cache.image[a] = g, this._resolveURL(b, g)
        }, reloadSound: function (a) {
            var b = this, c = this.getSound(a);
            c && (c.data.src = c.url, c.data.addEventListener("canplaythrough", function () {
                return b.reloadSoundComplete(a)
            }, !1), c.data.load())
        }, reloadSoundComplete: function (a) {
            var b = this.getSound(a);
            b && (b.locked = !1, this.onSoundUnlock.dispatch(a))
        }, updateSound: function (a, b, c) {
            var d = this.getSound(a);
            d && (d[b] = c)
        }, decodedSound: function (a, b) {
            var c = this.getSound(a);
            c.data = b, c.decoded = !0, c.isDecoding = !1
        }, isSoundDecoded: function (a) {
            var b = this.getItem(a, c.Cache.SOUND, "isSoundDecoded");
            return b ? b.decoded : void 0
        }, isSoundReady: function (a) {
            var b = this.getItem(a, c.Cache.SOUND, "isSoundDecoded");
            return b ? b.decoded && !this.game.sound.touchLocked : void 0
        }, checkKey: function (a, b) {
            return this._cacheMap[a][b] ? !0 : !1
        }, checkURL: function (a) {
            return this._urlMap[this._resolveURL(a)] ? !0 : !1
        }, checkCanvasKey: function (a) {
            return this.checkKey(c.Cache.CANVAS, a)
        }, checkImageKey: function (a) {
            return this.checkKey(c.Cache.IMAGE, a)
        }, checkTextureKey: function (a) {
            return this.checkKey(c.Cache.TEXTURE, a)
        }, checkSoundKey: function (a) {
            return this.checkKey(c.Cache.SOUND, a)
        }, checkTextKey: function (a) {
            return this.checkKey(c.Cache.TEXT, a)
        }, checkPhysicsKey: function (a) {
            return this.checkKey(c.Cache.PHYSICS, a)
        }, checkTilemapKey: function (a) {
            return this.checkKey(c.Cache.TILEMAP, a)
        }, checkBinaryKey: function (a) {
            return this.checkKey(c.Cache.BINARY, a)
        }, checkBitmapDataKey: function (a) {
            return this.checkKey(c.Cache.BITMAPDATA, a)
        }, checkBitmapFontKey: function (a) {
            return this.checkKey(c.Cache.BITMAPFONT, a)
        }, checkJSONKey: function (a) {
            return this.checkKey(c.Cache.JSON, a)
        }, checkXMLKey: function (a) {
            return this.checkKey(c.Cache.XML, a)
        }, checkVideoKey: function (a) {
            return this.checkKey(c.Cache.VIDEO, a)
        }, checkShaderKey: function (a) {
            return this.checkKey(c.Cache.SHADER, a)
        }, checkRenderTextureKey: function (a) {
            return this.checkKey(c.Cache.RENDER_TEXTURE, a)
        }, getItem: function (a, b, c, d) {
            return this.checkKey(b, a) ? void 0 === d ? this._cacheMap[b][a] : this._cacheMap[b][a][d] : (c && console.warn("Phaser.Cache." + c + ': Key "' + a + '" not found in Cache.'), null)
        }, getCanvas: function (a) {
            return this.getItem(a, c.Cache.CANVAS, "getCanvas", "canvas")
        }, getImage: function (a, b) {
            (void 0 === a || null === a) && (a = "__default"), void 0 === b && (b = !1);
            var d = this.getItem(a, c.Cache.IMAGE, "getImage");
            return null === d && (d = this.getItem("__missing", c.Cache.IMAGE, "getImage")), b ? d : d.data
        }, getTextureFrame: function (a) {
            return this.getItem(a, c.Cache.TEXTURE, "getTextureFrame", "frame")
        }, getSound: function (a) {
            return this.getItem(a, c.Cache.SOUND, "getSound")
        }, getSoundData: function (a) {
            return this.getItem(a, c.Cache.SOUND, "getSoundData", "data")
        }, getText: function (a) {
            return this.getItem(a, c.Cache.TEXT, "getText", "data")
        }, getPhysicsData: function (a, b, d) {
            var e = this.getItem(a, c.Cache.PHYSICS, "getPhysicsData", "data");
            if (null === e || void 0 === b || null === b)return e;
            if (e[b]) {
                var f = e[b];
                if (!f || !d)return f;
                for (var g in f)if (g = f[g], g.fixtureKey === d)return g;
                console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "' + d + " in " + a + '"')
            } else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "' + a + " / " + b + '"');
            return null
        }, getTilemapData: function (a) {
            return this.getItem(a, c.Cache.TILEMAP, "getTilemapData")
        }, getBinary: function (a) {
            return this.getItem(a, c.Cache.BINARY, "getBinary")
        }, getBitmapData: function (a) {
            return this.getItem(a, c.Cache.BITMAPDATA, "getBitmapData", "data")
        }, getBitmapFont: function (a) {
            return this.getItem(a, c.Cache.BITMAPFONT, "getBitmapFont")
        }, getJSON: function (a, b) {
            var d = this.getItem(a, c.Cache.JSON, "getJSON", "data");
            return d ? b ? c.Utils.extend(!0, Array.isArray(d) ? [] : {}, d) : d : null
        }, getXML: function (a) {
            return this.getItem(a, c.Cache.XML, "getXML", "data")
        }, getVideo: function (a) {
            return this.getItem(a, c.Cache.VIDEO, "getVideo")
        }, getShader: function (a) {
            return this.getItem(a, c.Cache.SHADER, "getShader", "data")
        }, getRenderTexture: function (a) {
            return this.getItem(a, c.Cache.RENDER_TEXTURE, "getRenderTexture")
        }, getBaseTexture: function (a, b) {
            return void 0 === b && (b = c.Cache.IMAGE), this.getItem(a, b, "getBaseTexture", "base")
        }, getFrame: function (a, b) {
            return void 0 === b && (b = c.Cache.IMAGE), this.getItem(a, b, "getFrame", "frame")
        }, getFrameCount: function (a, b) {
            var c = this.getFrameData(a, b);
            return c ? c.total : 0
        }, getFrameData: function (a, b) {
            return void 0 === b && (b = c.Cache.IMAGE), this.getItem(a, b, "getFrameData", "frameData")
        }, hasFrameData: function (a, b) {
            return void 0 === b && (b = c.Cache.IMAGE), null !== this.getItem(a, b, "", "frameData")
        }, updateFrameData: function (a, b, d) {
            void 0 === d && (d = c.Cache.IMAGE), this._cacheMap[d][a] && (this._cacheMap[d][a].frameData = b)
        }, getFrameByIndex: function (a, b, c) {
            var d = this.getFrameData(a, c);
            return d ? d.getFrame(b) : null
        }, getFrameByName: function (a, b, c) {
            var d = this.getFrameData(a, c);
            return d ? d.getFrameByName(b) : null
        }, getURL: function (a) {
            var a = this._resolveURL(a);
            return a ? this._urlMap[a] : (console.warn('Phaser.Cache.getUrl: Invalid url: "' + a + '" or Cache.autoResolveURL was false'), null)
        }, getKeys: function (a) {
            void 0 === a && (a = c.Cache.IMAGE);
            var b = [];
            if (this._cacheMap[a])for (var d in this._cacheMap[a])"__default" !== d && "__missing" !== d && b.push(d);
            return b
        }, removeCanvas: function (a) {
            delete this._cache.canvas[a]
        }, removeImage: function (a, b) {
            void 0 === b && (b = !0);
            var c = this.getImage(a, !0);
            b && c.base && c.base.destroy(), delete this._cache.image[a]
        }, removeSound: function (a) {
            delete this._cache.sound[a]
        }, removeText: function (a) {
            delete this._cache.text[a]
        }, removePhysics: function (a) {
            delete this._cache.physics[a]
        }, removeTilemap: function (a) {
            delete this._cache.tilemap[a]
        }, removeBinary: function (a) {
            delete this._cache.binary[a]
        }, removeBitmapData: function (a) {
            delete this._cache.bitmapData[a]
        }, removeBitmapFont: function (a) {
            delete this._cache.bitmapFont[a]
        }, removeJSON: function (a) {
            delete this._cache.json[a]
        }, removeXML: function (a) {
            delete this._cache.xml[a]
        }, removeVideo: function (a) {
            delete this._cache.video[a]
        }, removeShader: function (a) {
            delete this._cache.shader[a]
        }, removeRenderTexture: function (a) {
            delete this._cache.renderTexture[a]
        }, removeSpriteSheet: function (a) {
            delete this._cache.spriteSheet[a]
        }, removeTextureAtlas: function (a) {
            delete this._cache.atlas[a]
        }, clearGLTextures: function () {
            for (var a in this._cache.image)this._cache.image[a].base._glTextures = []
        }, _resolveURL: function (a, b) {
            return this.autoResolveURL ? (this._urlResolver.src = this.game.load.baseURL + a, this._urlTemp = this._urlResolver.src, this._urlResolver.src = "", b && (this._urlMap[this._urlTemp] = b), this._urlTemp) : null
        }, destroy: function () {
            for (var a = 0; a < this._cacheMap.length; a++) {
                var b = this._cacheMap[a];
                for (var c in b)"__default" !== c && "__missing" !== c && (b[c].destroy && b[c].destroy(), delete b[c])
            }
            this._urlMap = null, this._urlResolver = null, this._urlTemp = null
        }
    }, c.Cache.prototype.constructor = c.Cache, c.Loader = function (a) {
        this.game = a, this.cache = a.cache, this.resetLocked = !1, this.isLoading = !1, this.hasLoaded = !1, this.preloadSprite = null, this.crossOrigin = !1, this.baseURL = "", this.path = "", this.headers = {
            json: "application/json",
            xml: "application/xml"
        }, this.onLoadStart = new c.Signal, this.onLoadComplete = new c.Signal, this.onPackComplete = new c.Signal, this.onFileStart = new c.Signal, this.onFileComplete = new c.Signal, this.onFileError = new c.Signal, this.useXDomainRequest = !1, this._warnedAboutXDomainRequest = !1, this.enableParallel = !0, this.maxParallelDownloads = 4, this._withSyncPointDepth = 0, this._fileList = [], this._flightQueue = [], this._processingHead = 0, this._fileLoadStarted = !1, this._totalPackCount = 0, this._totalFileCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0
    }, c.Loader.TEXTURE_ATLAS_JSON_ARRAY = 0, c.Loader.TEXTURE_ATLAS_JSON_HASH = 1, c.Loader.TEXTURE_ATLAS_XML_STARLING = 2,c.Loader.PHYSICS_LIME_CORONA_JSON = 3,c.Loader.PHYSICS_PHASER_JSON = 4,c.Loader.TEXTURE_ATLAS_JSON_PYXEL = 5,c.Loader.prototype = {
        setPreloadSprite: function (a, b) {
            b = b || 0, this.preloadSprite = {
                sprite: a,
                direction: b,
                width: a.width,
                height: a.height,
                rect: null
            }, 0 === b ? this.preloadSprite.rect = new c.Rectangle(0, 0, 1, a.height) : this.preloadSprite.rect = new c.Rectangle(0, 0, a.width, 1), a.crop(this.preloadSprite.rect), a.visible = !0
        }, resize: function () {
            this.preloadSprite && this.preloadSprite.height !== this.preloadSprite.sprite.height && (this.preloadSprite.rect.height = this.preloadSprite.sprite.height)
        }, checkKeyExists: function (a, b) {
            return this.getAssetIndex(a, b) > -1
        }, getAssetIndex: function (a, b) {
            for (var c = -1, d = 0; d < this._fileList.length; d++) {
                var e = this._fileList[d];
                if (e.type === a && e.key === b && (c = d, !e.loaded && !e.loading))break
            }
            return c
        }, getAsset: function (a, b) {
            var c = this.getAssetIndex(a, b);
            return c > -1 ? {index: c, file: this._fileList[c]} : !1
        }, reset: function (a, b) {
            void 0 === b && (b = !1), this.resetLocked || (a && (this.preloadSprite = null), this.isLoading = !1, this._processingHead = 0, this._fileList.length = 0, this._flightQueue.length = 0, this._fileLoadStarted = !1, this._totalFileCount = 0, this._totalPackCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0, b && (this.onLoadStart.removeAll(), this.onLoadComplete.removeAll(), this.onPackComplete.removeAll(), this.onFileStart.removeAll(), this.onFileComplete.removeAll(), this.onFileError.removeAll()))
        }, addToFileList: function (a, b, c, d, e, f) {
            if (void 0 === e && (e = !1), void 0 === b || "" === b)return console.warn("Phaser.Loader: Invalid or no key given of type " + a), this;
            if (void 0 === c || null === c) {
                if (!f)return console.warn("Phaser.Loader: No URL given for file type: " + a + " key: " + b), this;
                c = b + f
            }
            var g = {
                type: a,
                key: b,
                path: this.path,
                url: c,
                syncPoint: this._withSyncPointDepth > 0,
                data: null,
                loading: !1,
                loaded: !1,
                error: !1
            };
            if (d)for (var h in d)g[h] = d[h];
            var i = this.getAssetIndex(a, b);
            if (e && i > -1) {
                var j = this._fileList[i];
                j.loading || j.loaded ? (this._fileList.push(g), this._totalFileCount++) : this._fileList[i] = g
            } else-1 === i && (this._fileList.push(g), this._totalFileCount++);
            return this
        }, replaceInFileList: function (a, b, c, d) {
            return this.addToFileList(a, b, c, d, !0)
        }, pack: function (a, b, c, d) {
            if (void 0 === b && (b = null), void 0 === c && (c = null), void 0 === d && (d = null), !b && !c)return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."), this;
            var e = {
                type: "packfile",
                key: a,
                url: b,
                path: this.path,
                syncPoint: !0,
                data: null,
                loading: !1,
                loaded: !1,
                error: !1,
                callbackContext: d
            };
            c && ("string" == typeof c && (c = JSON.parse(c)), e.data = c || {}, e.loaded = !0);
            for (var f = 0; f < this._fileList.length + 1; f++) {
                var g = this._fileList[f];
                if (!g || !g.loaded && !g.loading && "packfile" !== g.type) {
                    this._fileList.splice(f, 0, e), this._totalPackCount++;
                    break
                }
            }
            return this
        }, image: function (a, b, c) {
            return this.addToFileList("image", a, b, void 0, c, ".png")
        }, images: function (a, b) {
            if (Array.isArray(b))for (var c = 0; c < a.length; c++)this.image(a[c], b[c]); else for (var c = 0; c < a.length; c++)this.image(a[c]);
            return this
        }, text: function (a, b, c) {
            return this.addToFileList("text", a, b, void 0, c, ".txt")
        }, json: function (a, b, c) {
            return this.addToFileList("json", a, b, void 0, c, ".json")
        }, shader: function (a, b, c) {
            return this.addToFileList("shader", a, b, void 0, c, ".frag")
        }, xml: function (a, b, c) {
            return this.addToFileList("xml", a, b, void 0, c, ".xml")
        }, script: function (a, b, c, d) {
            return void 0 === c && (c = !1), c !== !1 && void 0 === d && (d = this), this.addToFileList("script", a, b, {
                syncPoint: !0,
                callback: c,
                callbackContext: d
            }, !1, ".js")
        }, binary: function (a, b, c, d) {
            return void 0 === c && (c = !1), c !== !1 && void 0 === d && (d = c), this.addToFileList("binary", a, b, {
                callback: c,
                callbackContext: d
            }, !1, ".bin")
        }, spritesheet: function (a, b, c, d, e, f, g) {
            return void 0 === e && (e = -1), void 0 === f && (f = 0), void 0 === g && (g = 0), this.addToFileList("spritesheet", a, b, {
                frameWidth: c,
                frameHeight: d,
                frameMax: e,
                margin: f,
                spacing: g
            }, !1, ".png")
        }, audio: function (a, b, c) {
            return this.game.sound.noAudio ? this : (void 0 === c && (c = !0), "string" == typeof b && (b = [b]), this.addToFileList("audio", a, b, {
                buffer: null,
                autoDecode: c
            }))
        }, audioSprite: function (a, b, c, d, e) {
            return this.game.sound.noAudio ? this : (void 0 === c && (c = null), void 0 === d && (d = null), void 0 === e && (e = !0), this.audio(a, b, e), c ? this.json(a + "-audioatlas", c) : d ? ("string" == typeof d && (d = JSON.parse(d)), this.cache.addJSON(a + "-audioatlas", "", d)) : console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object"), this)
        }, audiosprite: function (a, b, c, d, e) {
            return this.audioSprite(a, b, c, d, e)
        }, video: function (a, b, c, d) {
            return void 0 === c && (c = this.game.device.firefox ? "loadeddata" : "canplaythrough"), void 0 === d && (d = !1), "string" == typeof b && (b = [b]), this.addToFileList("video", a, b, {
                buffer: null,
                asBlob: d,
                loadEvent: c
            })
        }, tilemap: function (a, b, d, e) {
            if (void 0 === b && (b = null), void 0 === d && (d = null), void 0 === e && (e = c.Tilemap.CSV), b || d || (b = e === c.Tilemap.CSV ? a + ".csv" : a + ".json"), d) {
                switch (e) {
                    case c.Tilemap.CSV:
                        break;
                    case c.Tilemap.TILED_JSON:
                        "string" == typeof d && (d = JSON.parse(d))
                }
                this.cache.addTilemap(a, null, d, e)
            } else this.addToFileList("tilemap", a, b, {format: e});
            return this
        }, physics: function (a, b, d, e) {
            return void 0 === b && (b = null), void 0 === d && (d = null), void 0 === e && (e = c.Physics.LIME_CORONA_JSON), b || d || (b = a + ".json"), d ? ("string" == typeof d && (d = JSON.parse(d)), this.cache.addPhysicsData(a, null, d, e)) : this.addToFileList("physics", a, b, {format: e}), this
        }, bitmapFont: function (a, b, c, d, e, f) {
            if ((void 0 === b || null === b) && (b = a + ".png"), void 0 === c && (c = null), void 0 === d && (d = null), null === c && null === d && (c = a + ".xml"), void 0 === e && (e = 0), void 0 === f && (f = 0), c)this.addToFileList("bitmapfont", a, b, {
                atlasURL: c,
                xSpacing: e,
                ySpacing: f
            }); else if ("string" == typeof d) {
                var g, h;
                try {
                    g = JSON.parse(d)
                } catch (i) {
                    h = this.parseXml(d)
                }
                if (!h && !g)throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");
                this.addToFileList("bitmapfont", a, b, {
                    atlasURL: null,
                    atlasData: g || h,
                    atlasType: g ? "json" : "xml",
                    xSpacing: e,
                    ySpacing: f
                })
            }
            return this
        }, atlasJSONArray: function (a, b, d, e) {
            return this.atlas(a, b, d, e, c.Loader.TEXTURE_ATLAS_JSON_ARRAY)
        }, atlasJSONHash: function (a, b, d, e) {
            return this.atlas(a, b, d, e, c.Loader.TEXTURE_ATLAS_JSON_HASH)
        }, atlasXML: function (a, b, d, e) {
            return void 0 === d && (d = null), void 0 === e && (e = null), d || e || (d = a + ".xml"), this.atlas(a, b, d, e, c.Loader.TEXTURE_ATLAS_XML_STARLING)
        }, atlas: function (a, b, d, e, f) {
            if ((void 0 === b || null === b) && (b = a + ".png"), void 0 === d && (d = null), void 0 === e && (e = null), void 0 === f && (f = c.Loader.TEXTURE_ATLAS_JSON_ARRAY), d || e || (d = f === c.Loader.TEXTURE_ATLAS_XML_STARLING ? a + ".xml" : a + ".json"), d)this.addToFileList("textureatlas", a, b, {
                atlasURL: d,
                format: f
            }); else {
                switch (f) {
                    case c.Loader.TEXTURE_ATLAS_JSON_ARRAY:
                        "string" == typeof e && (e = JSON.parse(e));
                        break;
                    case c.Loader.TEXTURE_ATLAS_XML_STARLING:
                        if ("string" == typeof e) {
                            var g = this.parseXml(e);
                            if (!g)throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");
                            e = g
                        }
                }
                this.addToFileList("textureatlas", a, b, {atlasURL: null, atlasData: e, format: f})
            }
            return this
        }, withSyncPoint: function (a, b) {
            this._withSyncPointDepth++;
            try {
                a.call(b || this, this)
            } finally {
                this._withSyncPointDepth--
            }
            return this
        }, addSyncPoint: function (a, b) {
            var c = this.getAsset(a, b);
            return c && (c.file.syncPoint = !0), this
        }, removeFile: function (a, b) {
            var c = this.getAsset(a, b);
            c && (c.loaded || c.loading || this._fileList.splice(c.index, 1))
        }, removeAll: function () {
            this._fileList.length = 0, this._flightQueue.length = 0
        }, start: function () {
            this.isLoading || (this.hasLoaded = !1, this.isLoading = !0, this.updateProgress(), this.processLoadQueue())
        }, processLoadQueue: function () {
            if (!this.isLoading)return console.warn("Phaser.Loader - active loading canceled / reset"), void this.finishedLoading(!0);
            for (var a = 0; a < this._flightQueue.length; a++) {
                var b = this._flightQueue[a];
                (b.loaded || b.error) && (this._flightQueue.splice(a, 1), a--, b.loading = !1, b.requestUrl = null, b.requestObject = null, b.error && this.onFileError.dispatch(b.key, b), "packfile" !== b.type ? (this._loadedFileCount++, this.onFileComplete.dispatch(this.progress, b.key, !b.error, this._loadedFileCount, this._totalFileCount)) : "packfile" === b.type && b.error && (this._loadedPackCount++, this.onPackComplete.dispatch(b.key, !b.error, this._loadedPackCount, this._totalPackCount)))
            }
            for (var d = !1, e = this.enableParallel ? c.Math.clamp(this.maxParallelDownloads, 1, 12) : 1, a = this._processingHead; a < this._fileList.length; a++) {
                var b = this._fileList[a];
                if ("packfile" === b.type && !b.error && b.loaded && a === this._processingHead && (this.processPack(b), this._loadedPackCount++, this.onPackComplete.dispatch(b.key, !b.error, this._loadedPackCount, this._totalPackCount)), b.loaded || b.error ? a === this._processingHead && (this._processingHead = a + 1) : !b.loading && this._flightQueue.length < e && ("packfile" !== b.type || b.data ? d || (this._fileLoadStarted || (this._fileLoadStarted = !0, this.onLoadStart.dispatch()), this._flightQueue.push(b), b.loading = !0, this.onFileStart.dispatch(this.progress, b.key, b.url), this.loadFile(b)) : (this._flightQueue.push(b), b.loading = !0, this.loadFile(b))), !b.loaded && b.syncPoint && (d = !0), this._flightQueue.length >= e || d && this._loadedPackCount === this._totalPackCount)break
            }
            if (this.updateProgress(), this._processingHead >= this._fileList.length)this.finishedLoading(); else if (!this._flightQueue.length) {
                console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");
                var f = this;
                setTimeout(function () {
                    f.finishedLoading(!0)
                }, 2e3)
            }
        }, finishedLoading: function (a) {
            this.hasLoaded || (this.hasLoaded = !0, this.isLoading = !1, a || this._fileLoadStarted || (this._fileLoadStarted = !0, this.onLoadStart.dispatch()), this.onLoadComplete.dispatch(), this.game.state.loadComplete(), this.reset())
        }, asyncComplete: function (a, b) {
            void 0 === b && (b = ""), a.loaded = !0, a.error = !!b, b && (a.errorMessage = b, console.warn("Phaser.Loader - " + a.type + "[" + a.key + "]: " + b)), this.processLoadQueue()
        }, processPack: function (a) {
            var b = a.data[a.key];
            if (!b)return void console.warn("Phaser.Loader - " + a.key + ": pack has data, but not for pack key");
            for (var d = 0; d < b.length; d++) {
                var e = b[d];
                switch (e.type) {
                    case"image":
                        this.image(e.key, e.url, e.overwrite);
                        break;
                    case"text":
                        this.text(e.key, e.url, e.overwrite);
                        break;
                    case"json":
                        this.json(e.key, e.url, e.overwrite);
                        break;
                    case"xml":
                        this.xml(e.key, e.url, e.overwrite);
                        break;
                    case"script":
                        this.script(e.key, e.url, e.callback, a.callbackContext || this);
                        break;
                    case"binary":
                        this.binary(e.key, e.url, e.callback, a.callbackContext || this);
                        break;
                    case"spritesheet":
                        this.spritesheet(e.key, e.url, e.frameWidth, e.frameHeight, e.frameMax, e.margin, e.spacing);
                        break;
                    case"video":
                        this.video(e.key, e.urls);
                        break;
                    case"audio":
                        this.audio(e.key, e.urls, e.autoDecode);
                        break;
                    case"audiosprite":
                        this.audiosprite(e.key, e.urls, e.jsonURL, e.jsonData, e.autoDecode);
                        break;
                    case"tilemap":
                        this.tilemap(e.key, e.url, e.data, c.Tilemap[e.format]);
                        break;
                    case"physics":
                        this.physics(e.key, e.url, e.data, c.Loader[e.format]);
                        break;
                    case"bitmapFont":
                        this.bitmapFont(e.key, e.textureURL, e.atlasURL, e.atlasData, e.xSpacing, e.ySpacing);
                        break;
                    case"atlasJSONArray":
                        this.atlasJSONArray(e.key, e.textureURL, e.atlasURL, e.atlasData);
                        break;
                    case"atlasJSONHash":
                        this.atlasJSONHash(e.key, e.textureURL, e.atlasURL, e.atlasData);
                        break;
                    case"atlasXML":
                        this.atlasXML(e.key, e.textureURL, e.atlasURL, e.atlasData);
                        break;
                    case"atlas":
                        this.atlas(e.key, e.textureURL, e.atlasURL, e.atlasData, c.Loader[e.format]);
                        break;
                    case"shader":
                        this.shader(e.key, e.url, e.overwrite)
                }
            }
        }, transformUrl: function (a, b) {
            return a ? a.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/) ? a : this.baseURL + b.path + a : !1
        }, loadFile: function (a) {
            switch (a.type) {
                case"packfile":
                    this.xhrLoad(a, this.transformUrl(a.url, a), "text", this.fileComplete);
                    break;
                case"image":
                case"spritesheet":
                case"textureatlas":
                case"bitmapfont":
                    this.loadImageTag(a);
                    break;
                case"audio":
                    a.url = this.getAudioURL(a.url), a.url ? this.game.sound.usingWebAudio ? this.xhrLoad(a, this.transformUrl(a.url, a), "arraybuffer", this.fileComplete) : this.game.sound.usingAudioTag && this.loadAudioTag(a) : this.fileError(a, null, "No supported audio URL specified or device does not have audio playback support");
                    break;
                case"video":
                    a.url = this.getVideoURL(a.url), a.url ? a.asBlob ? this.xhrLoad(a, this.transformUrl(a.url, a), "blob", this.fileComplete) : this.loadVideoTag(a) : this.fileError(a, null, "No supported video URL specified or device does not have video playback support");
                    break;
                case"json":
                    this.xhrLoad(a, this.transformUrl(a.url, a), "text", this.jsonLoadComplete);
                    break;
                case"xml":
                    this.xhrLoad(a, this.transformUrl(a.url, a), "text", this.xmlLoadComplete);
                    break;
                case"tilemap":
                    a.format === c.Tilemap.TILED_JSON ? this.xhrLoad(a, this.transformUrl(a.url, a), "text", this.jsonLoadComplete) : a.format === c.Tilemap.CSV ? this.xhrLoad(a, this.transformUrl(a.url, a), "text", this.csvLoadComplete) : this.asyncComplete(a, "invalid Tilemap format: " + a.format);
                    break;
                case"text":
                case"script":
                case"shader":
                case"physics":
                    this.xhrLoad(a, this.transformUrl(a.url, a), "text", this.fileComplete);
                    break;
                case"binary":
                    this.xhrLoad(a, this.transformUrl(a.url, a), "arraybuffer", this.fileComplete)
            }
        }, loadImageTag: function (a) {
            var b = this;
            a.data = new Image, a.data.name = a.key, this.crossOrigin && (a.data.crossOrigin = this.crossOrigin), a.data.onload = function () {
                a.data.onload && (a.data.onload = null, a.data.onerror = null, b.fileComplete(a))
            }, a.data.onerror = function () {
                a.data.onload && (a.data.onload = null, a.data.onerror = null, b.fileError(a))
            }, a.data.src = this.transformUrl(a.url, a), a.data.complete && a.data.width && a.data.height && (a.data.onload = null, a.data.onerror = null, this.fileComplete(a))
        }, loadVideoTag: function (a) {
            var b = this;
            a.data = document.createElement("video"), a.data.name = a.key, a.data.controls = !1, a.data.autoplay = !1;
            var d = function () {
                a.data.removeEventListener(a.loadEvent, d, !1), a.data.onerror = null, a.data.canplay = !0, c.GAMES[b.game.id].load.fileComplete(a)
            };
            a.data.onerror = function () {
                a.data.removeEventListener(a.loadEvent, d, !1), a.data.onerror = null, a.data.canplay = !1, b.fileError(a)
            }, a.data.addEventListener(a.loadEvent, d, !1), a.data.src = this.transformUrl(a.url, a), a.data.load()
        }, loadAudioTag: function (a) {
            var b = this;
            if (this.game.sound.touchLocked)a.data = new Audio, a.data.name = a.key, a.data.preload = "auto", a.data.src = this.transformUrl(a.url, a), this.fileComplete(a); else {
                a.data = new Audio, a.data.name = a.key;
                var c = function () {
                    a.data.removeEventListener("canplaythrough", c, !1), a.data.onerror = null, b.fileComplete(a)
                };
                a.data.onerror = function () {
                    a.data.removeEventListener("canplaythrough", c, !1), a.data.onerror = null, b.fileError(a)
                }, a.data.preload = "auto", a.data.src = this.transformUrl(a.url, a), a.data.addEventListener("canplaythrough", c, !1), a.data.load()
            }
        }, xhrLoad: function (a, b, c, d, e) {
            if (this.useXDomainRequest && window.XDomainRequest)return void this.xhrLoadWithXDR(a, b, c, d, e);
            var f = new XMLHttpRequest;
            f.open("GET", b, !0), f.responseType = c, this.headers[a.type] && f.setRequestHeader("Accept", this.headers[a.type]), e = e || this.fileError;
            var g = this;
            f.onload = function () {
                try {
                    return 4 == f.readyState && f.status >= 400 && f.status <= 599 ? e.call(g, a, f) : d.call(g, a, f)
                } catch (b) {
                    g.hasLoaded ? window.console && console.error(b) : g.asyncComplete(a, b.message || "Exception")
                }
            }, f.onerror = function () {
                try {
                    return e.call(g, a, f)
                } catch (b) {
                    g.hasLoaded ? window.console && console.error(b) : g.asyncComplete(a, b.message || "Exception")
                }
            }, a.requestObject = f, a.requestUrl = b, f.send()
        }, xhrLoadWithXDR: function (a, b, c, d, e) {
            this._warnedAboutXDomainRequest || this.game.device.ie && !(this.game.device.ieVersion >= 10) || (this._warnedAboutXDomainRequest = !0, console.warn("Phaser.Loader - using XDomainRequest outside of IE 9"));
            var f = new window.XDomainRequest;
            f.open("GET", b, !0), f.responseType = c, f.timeout = 3e3, e = e || this.fileError;
            var g = this;
            f.onerror = function () {
                try {
                    return e.call(g, a, f)
                } catch (b) {
                    g.asyncComplete(a, b.message || "Exception")
                }
            }, f.ontimeout = function () {
                try {
                    return e.call(g, a, f)
                } catch (b) {
                    g.asyncComplete(a, b.message || "Exception")
                }
            }, f.onprogress = function () {
            }, f.onload = function () {
                try {
                    return 4 == f.readyState && f.status >= 400 && f.status <= 599 ? e.call(g, a, f) : d.call(g, a, f)
                } catch (b) {
                    g.asyncComplete(a, b.message || "Exception")
                }
            }, a.requestObject = f, a.requestUrl = b, setTimeout(function () {
                f.send()
            }, 0)
        }, getVideoURL: function (a) {
            for (var b = 0; b < a.length; b++) {
                var c, d = a[b];
                if (d.uri) {
                    if (c = d.type, d = d.uri, this.game.device.canPlayVideo(c))return d
                } else {
                    if (0 === d.indexOf("blob:") || 0 === d.indexOf("data:"))return d;
                    d.indexOf("?") >= 0 && (d = d.substr(0, d.indexOf("?")));
                    var e = d.substr((Math.max(0, d.lastIndexOf(".")) || 1 / 0) + 1);
                    if (c = e.toLowerCase(), this.game.device.canPlayVideo(c))return a[b]
                }
            }
            return null
        }, getAudioURL: function (a) {
            if (this.game.sound.noAudio)return null;
            for (var b = 0; b < a.length; b++) {
                var c, d = a[b];
                if (d.uri) {
                    if (c = d.type, d = d.uri, this.game.device.canPlayAudio(c))return d
                } else {
                    if (0 === d.indexOf("blob:") || 0 === d.indexOf("data:"))return d;
                    d.indexOf("?") >= 0 && (d = d.substr(0, d.indexOf("?")));
                    var e = d.substr((Math.max(0, d.lastIndexOf(".")) || 1 / 0) + 1);
                    if (c = e.toLowerCase(), this.game.device.canPlayAudio(c))return a[b]
                }
            }
            return null
        }, fileError: function (a, b, c) {
            var d = a.requestUrl || this.transformUrl(a.url, a), e = "error loading asset from URL " + d;
            !c && b && (c = b.status), c && (e = e + " (" + c + ")"), this.asyncComplete(a, e)
        }, fileComplete: function (a, b) {
            var d = !0;
            switch (a.type) {
                case"packfile":
                    var e = JSON.parse(b.responseText);
                    a.data = e || {};
                    break;
                case"image":
                    this.cache.addImage(a.key, a.url, a.data);
                    break;
                case"spritesheet":
                    this.cache.addSpriteSheet(a.key, a.url, a.data, a.frameWidth, a.frameHeight, a.frameMax, a.margin, a.spacing);
                    break;
                case"textureatlas":
                    if (null == a.atlasURL)this.cache.addTextureAtlas(a.key, a.url, a.data, a.atlasData, a.format); else if (d = !1, a.format == c.Loader.TEXTURE_ATLAS_JSON_ARRAY || a.format == c.Loader.TEXTURE_ATLAS_JSON_HASH || a.format == c.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(a, this.transformUrl(a.atlasURL, a), "text", this.jsonLoadComplete); else {
                        if (a.format != c.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: " + a.format);
                        this.xhrLoad(a, this.transformUrl(a.atlasURL, a), "text", this.xmlLoadComplete)
                    }
                    break;
                case"bitmapfont":
                    a.atlasURL ? (d = !1, this.xhrLoad(a, this.transformUrl(a.atlasURL, a), "text", function (a, b) {
                        var c;
                        try {
                            c = JSON.parse(b.responseText)
                        } catch (d) {
                        }
                        c ? (a.atlasType = "json", this.jsonLoadComplete(a, b)) : (a.atlasType = "xml", this.xmlLoadComplete(a, b))
                    })) : this.cache.addBitmapFont(a.key, a.url, a.data, a.atlasData, a.atlasType, a.xSpacing, a.ySpacing);
                    break;
                case"video":
                    if (a.asBlob)try {
                        a.data = b.response
                    } catch (f) {
                        throw new Error("Phaser.Loader. Unable to parse video file as Blob: " + a.key)
                    }
                    this.cache.addVideo(a.key, a.url, a.data, a.asBlob);
                    break;
                case"audio":
                    this.game.sound.usingWebAudio ? (a.data = b.response, this.cache.addSound(a.key, a.url, a.data, !0, !1), a.autoDecode && this.game.sound.decode(a.key)) : this.cache.addSound(a.key, a.url, a.data, !1, !0);
                    break;
                case"text":
                    a.data = b.responseText, this.cache.addText(a.key, a.url, a.data);
                    break;
                case"shader":
                    a.data = b.responseText, this.cache.addShader(a.key, a.url, a.data);
                    break;
                case"physics":
                    var e = JSON.parse(b.responseText);
                    this.cache.addPhysicsData(a.key, a.url, e, a.format);
                    break;
                case"script":
                    a.data = document.createElement("script"), a.data.language = "javascript", a.data.type = "text/javascript", a.data.defer = !1, a.data.text = b.responseText, document.head.appendChild(a.data), a.callback && (a.data = a.callback.call(a.callbackContext, a.key, b.responseText));
                    break;
                case"binary":
                    a.callback ? a.data = a.callback.call(a.callbackContext, a.key, b.response) : a.data = b.response, this.cache.addBinary(a.key, a.data)
            }
            d && this.asyncComplete(a)
        }, jsonLoadComplete: function (a, b) {
            var c = JSON.parse(b.responseText);
            "tilemap" === a.type ? this.cache.addTilemap(a.key, a.url, c, a.format) : "bitmapfont" === a.type ? this.cache.addBitmapFont(a.key, a.url, a.data, c, a.atlasType, a.xSpacing, a.ySpacing) : "json" === a.type ? this.cache.addJSON(a.key, a.url, c) : this.cache.addTextureAtlas(a.key, a.url, a.data, c, a.format), this.asyncComplete(a)
        }, csvLoadComplete: function (a, b) {
            var c = b.responseText;
            this.cache.addTilemap(a.key, a.url, c, a.format), this.asyncComplete(a)
        }, xmlLoadComplete: function (a, b) {
            var c = b.responseText, d = this.parseXml(c);
            if (!d) {
                var e = b.responseType || b.contentType;
                return console.warn("Phaser.Loader - " + a.key + ": invalid XML (" + e + ")"), void this.asyncComplete(a, "invalid XML")
            }
            "bitmapfont" === a.type ? this.cache.addBitmapFont(a.key, a.url, a.data, d, a.atlasType, a.xSpacing, a.ySpacing) : "textureatlas" === a.type ? this.cache.addTextureAtlas(a.key, a.url, a.data, d, a.format) : "xml" === a.type && this.cache.addXML(a.key, a.url, d), this.asyncComplete(a)
        }, parseXml: function (a) {
            var b;
            try {
                if (window.DOMParser) {
                    var c = new DOMParser;
                    b = c.parseFromString(a, "text/xml")
                } else b = new ActiveXObject("Microsoft.XMLDOM"), b.async = "false", b.loadXML(a)
            } catch (d) {
                b = null
            }
            return b && b.documentElement && !b.getElementsByTagName("parsererror").length ? b : null
        }, updateProgress: function () {
            this.preloadSprite && (0 === this.preloadSprite.direction ? this.preloadSprite.rect.width = Math.floor(this.preloadSprite.width / 100 * this.progress) : this.preloadSprite.rect.height = Math.floor(this.preloadSprite.height / 100 * this.progress), this.preloadSprite.sprite ? this.preloadSprite.sprite.updateCrop() : this.preloadSprite = null)
        }, totalLoadedFiles: function () {
            return this._loadedFileCount
        }, totalQueuedFiles: function () {
            return this._totalFileCount - this._loadedFileCount
        }, totalLoadedPacks: function () {
            return this._totalPackCount
        }, totalQueuedPacks: function () {
            return this._totalPackCount - this._loadedPackCount;
        }
    },Object.defineProperty(c.Loader.prototype, "progressFloat", {
        get: function () {
            var a = this._loadedFileCount / this._totalFileCount * 100;
            return c.Math.clamp(a || 0, 0, 100)
        }
    }),Object.defineProperty(c.Loader.prototype, "progress", {
        get: function () {
            return Math.round(this.progressFloat)
        }
    }),c.Loader.prototype.constructor = c.Loader,c.LoaderParser = {
        bitmapFont: function (a, b, c, d) {
            return this.xmlBitmapFont(a, b, c, d)
        }, xmlBitmapFont: function (a, b, c, d) {
            var e = {}, f = a.getElementsByTagName("info")[0], g = a.getElementsByTagName("common")[0];
            e.font = f.getAttribute("face"), e.size = parseInt(f.getAttribute("size"), 10), e.lineHeight = parseInt(g.getAttribute("lineHeight"), 10) + d, e.chars = {};
            for (var h = a.getElementsByTagName("char"), i = 0; i < h.length; i++) {
                var j = parseInt(h[i].getAttribute("id"), 10);
                e.chars[j] = {
                    x: parseInt(h[i].getAttribute("x"), 10),
                    y: parseInt(h[i].getAttribute("y"), 10),
                    width: parseInt(h[i].getAttribute("width"), 10),
                    height: parseInt(h[i].getAttribute("height"), 10),
                    xOffset: parseInt(h[i].getAttribute("xoffset"), 10),
                    yOffset: parseInt(h[i].getAttribute("yoffset"), 10),
                    xAdvance: parseInt(h[i].getAttribute("xadvance"), 10) + c,
                    kerning: {}
                }
            }
            var k = a.getElementsByTagName("kerning");
            for (i = 0; i < k.length; i++) {
                var l = parseInt(k[i].getAttribute("first"), 10), m = parseInt(k[i].getAttribute("second"), 10), n = parseInt(k[i].getAttribute("amount"), 10);
                e.chars[m].kerning[l] = n
            }
            return this.finalizeBitmapFont(b, e)
        }, jsonBitmapFont: function (a, b, c, d) {
            var e = {
                font: a.font.info._face,
                size: parseInt(a.font.info._size, 10),
                lineHeight: parseInt(a.font.common._lineHeight, 10) + d,
                chars: {}
            };
            return a.font.chars["char"].forEach(function (a) {
                var b = parseInt(a._id, 10);
                e.chars[b] = {
                    x: parseInt(a._x, 10),
                    y: parseInt(a._y, 10),
                    width: parseInt(a._width, 10),
                    height: parseInt(a._height, 10),
                    xOffset: parseInt(a._xoffset, 10),
                    yOffset: parseInt(a._yoffset, 10),
                    xAdvance: parseInt(a._xadvance, 10) + c,
                    kerning: {}
                }
            }), a.font.kernings && a.font.kernings.kerning && a.font.kernings.kerning.forEach(function (a) {
                e.chars[a._second].kerning[a._first] = parseInt(a._amount, 10)
            }), this.finalizeBitmapFont(b, e)
        }, finalizeBitmapFont: function (a, b) {
            return Object.keys(b.chars).forEach(function (d) {
                var e = b.chars[d];
                e.texture = new PIXI.Texture(a, new c.Rectangle(e.x, e.y, e.width, e.height))
            }), b
        }
    },c.AudioSprite = function (a, b) {
        this.game = a, this.key = b, this.config = this.game.cache.getJSON(b + "-audioatlas"), this.autoplayKey = null, this.autoplay = !1, this.sounds = {};
        for (var c in this.config.spritemap) {
            var d = this.config.spritemap[c], e = this.game.add.sound(this.key);
            e.addMarker(c, d.start, d.end - d.start, null, d.loop), this.sounds[c] = e
        }
        this.config.autoplay && (this.autoplayKey = this.config.autoplay, this.play(this.autoplayKey), this.autoplay = this.sounds[this.autoplayKey])
    },c.AudioSprite.prototype = {
        play: function (a, b) {
            return void 0 === b && (b = 1), this.sounds[a].play(a, null, b)
        }, stop: function (a) {
            if (a)this.sounds[a].stop(); else for (var b in this.sounds)this.sounds[b].stop()
        }, get: function (a) {
            return this.sounds[a]
        }
    },c.AudioSprite.prototype.constructor = c.AudioSprite,c.Sound = function (a, b, d, e, f) {
        void 0 === d && (d = 1), void 0 === e && (e = !1), void 0 === f && (f = a.sound.connectToMaster), this.game = a, this.name = b, this.key = b, this.loop = e, this.markers = {}, this.context = null, this.autoplay = !1, this.totalDuration = 0, this.startTime = 0, this.currentTime = 0, this.duration = 0, this.durationMS = 0, this.position = 0, this.stopTime = 0, this.paused = !1, this.pausedPosition = 0, this.pausedTime = 0, this.isPlaying = !1, this.currentMarker = "", this.fadeTween = null, this.pendingPlayback = !1, this.override = !1, this.allowMultiple = !1, this.usingWebAudio = this.game.sound.usingWebAudio, this.usingAudioTag = this.game.sound.usingAudioTag, this.externalNode = null, this.masterGainNode = null, this.gainNode = null, this._sound = null, this.usingWebAudio ? (this.context = this.game.sound.context, this.masterGainNode = this.game.sound.masterGain, void 0 === this.context.createGain ? this.gainNode = this.context.createGainNode() : this.gainNode = this.context.createGain(), this.gainNode.gain.value = d * this.game.sound.volume, f && this.gainNode.connect(this.masterGainNode)) : this.usingAudioTag && (this.game.cache.getSound(b) && this.game.cache.isSoundReady(b) ? (this._sound = this.game.cache.getSoundData(b), this.totalDuration = 0, this._sound.duration && (this.totalDuration = this._sound.duration)) : this.game.cache.onSoundUnlock.add(this.soundHasUnlocked, this)), this.onDecoded = new c.Signal, this.onPlay = new c.Signal, this.onPause = new c.Signal, this.onResume = new c.Signal, this.onLoop = new c.Signal, this.onStop = new c.Signal, this.onMute = new c.Signal, this.onMarkerComplete = new c.Signal, this.onFadeComplete = new c.Signal, this._volume = d, this._buffer = null, this._muted = !1, this._tempMarker = 0, this._tempPosition = 0, this._tempVolume = 0, this._tempPause = 0, this._muteVolume = 0, this._tempLoop = 0, this._paused = !1, this._onDecodedEventDispatched = !1
    },c.Sound.prototype = {
        soundHasUnlocked: function (a) {
            a === this.key && (this._sound = this.game.cache.getSoundData(this.key), this.totalDuration = this._sound.duration)
        }, addMarker: function (a, b, c, d, e) {
            (void 0 === c || null === c) && (c = 1), (void 0 === d || null === d) && (d = 1), void 0 === e && (e = !1), this.markers[a] = {
                name: a,
                start: b,
                stop: b + c,
                volume: d,
                duration: c,
                durationMS: 1e3 * c,
                loop: e
            }
        }, removeMarker: function (a) {
            delete this.markers[a]
        }, onEndedHandler: function () {
            this._sound.onended = null, this.isPlaying = !1, this.currentTime = this.durationMS, this.stop()
        }, update: function () {
            return this.game.cache.checkSoundKey(this.key) ? (this.isDecoded && !this._onDecodedEventDispatched && (this.onDecoded.dispatch(this), this._onDecodedEventDispatched = !0), this.pendingPlayback && this.game.cache.isSoundReady(this.key) && (this.pendingPlayback = !1, this.play(this._tempMarker, this._tempPosition, this._tempVolume, this._tempLoop)), void(this.isPlaying && (this.currentTime = this.game.time.time - this.startTime, this.currentTime >= this.durationMS && (this.usingWebAudio ? this.loop ? (this.onLoop.dispatch(this), this.isPlaying = !1, "" === this.currentMarker ? (this.currentTime = 0, this.startTime = this.game.time.time, this.isPlaying = !0) : (this.onMarkerComplete.dispatch(this.currentMarker, this), this.play(this.currentMarker, 0, this.volume, !0, !0))) : "" !== this.currentMarker && this.stop() : this.loop ? (this.onLoop.dispatch(this), "" === this.currentMarker && (this.currentTime = 0, this.startTime = this.game.time.time), this.isPlaying = !1, this.play(this.currentMarker, 0, this.volume, !0, !0)) : this.stop())))) : void this.destroy()
        }, loopFull: function (a) {
            this.play(null, 0, a, !0)
        }, play: function (a, b, c, d, e) {
            if ((void 0 === a || a === !1 || null === a) && (a = ""), void 0 === e && (e = !0), this.isPlaying && !this.allowMultiple && !e && !this.override)return this;
            if (this._sound && this.isPlaying && !this.allowMultiple && (this.override || e))if (this.usingWebAudio) {
                if (void 0 === this._sound.stop)this._sound.noteOff(0); else try {
                    this._sound.stop(0)
                } catch (f) {
                }
                this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode)
            } else this.usingAudioTag && (this._sound.pause(), this._sound.currentTime = 0);
            if ("" === a && Object.keys(this.markers).length > 0)return this;
            if ("" !== a) {
                if (this.currentMarker = a, !this.markers[a])return this;
                this.position = this.markers[a].start, this.volume = this.markers[a].volume, this.loop = this.markers[a].loop, this.duration = this.markers[a].duration, this.durationMS = this.markers[a].durationMS, "undefined" != typeof c && (this.volume = c), "undefined" != typeof d && (this.loop = d), this._tempMarker = a, this._tempPosition = this.position, this._tempVolume = this.volume, this._tempLoop = this.loop
            } else b = b || 0, void 0 === c && (c = this._volume), void 0 === d && (d = this.loop), this.position = Math.max(0, b), this.volume = c, this.loop = d, this.duration = 0, this.durationMS = 0, this._tempMarker = a, this._tempPosition = b, this._tempVolume = c, this._tempLoop = d;
            return this.usingWebAudio ? this.game.cache.isSoundDecoded(this.key) ? (this._sound = this.context.createBufferSource(), this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode), this._buffer = this.game.cache.getSoundData(this.key), this._sound.buffer = this._buffer, this.loop && "" === a && (this._sound.loop = !0), this.loop || "" !== a || (this._sound.onended = this.onEndedHandler.bind(this)), this.totalDuration = this._sound.buffer.duration, 0 === this.duration && (this.duration = this.totalDuration, this.durationMS = Math.ceil(1e3 * this.totalDuration)), void 0 === this._sound.start ? this._sound.noteGrainOn(0, this.position, this.duration) : this.loop && "" === a ? this._sound.start(0, 0) : this._sound.start(0, this.position, this.duration), this.isPlaying = !0, this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : (this.pendingPlayback = !0, this.game.cache.getSound(this.key) && this.game.cache.getSound(this.key).isDecoding === !1 && this.game.sound.decode(this.key, this)) : this.game.cache.getSound(this.key) && this.game.cache.getSound(this.key).locked ? (this.game.cache.reloadSound(this.key), this.pendingPlayback = !0) : this._sound && (this.game.device.cocoonJS || 4 === this._sound.readyState) ? (this._sound.play(), this.totalDuration = this._sound.duration, 0 === this.duration && (this.duration = this.totalDuration, this.durationMS = 1e3 * this.totalDuration), this._sound.currentTime = this.position, this._sound.muted = this._muted, this._muted || this.game.sound.mute ? this._sound.volume = 0 : this._sound.volume = this._volume, this.isPlaying = !0, this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : this.pendingPlayback = !0, this
        }, restart: function (a, b, c, d) {
            a = a || "", b = b || 0, c = c || 1, void 0 === d && (d = !1), this.play(a, b, c, d, !0)
        }, pause: function () {
            this.isPlaying && this._sound && (this.paused = !0, this.pausedPosition = this.currentTime, this.pausedTime = this.game.time.time, this._tempPause = this._sound.currentTime, this.onPause.dispatch(this), this.stop())
        }, resume: function () {
            if (this.paused && this._sound) {
                if (this.usingWebAudio) {
                    var a = Math.max(0, this.position + this.pausedPosition / 1e3);
                    this._sound = this.context.createBufferSource(), this._sound.buffer = this._buffer, this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode), this.loop && (this._sound.loop = !0), this.loop || "" !== this.currentMarker || (this._sound.onended = this.onEndedHandler.bind(this));
                    var b = this.duration - this.pausedPosition / 1e3;
                    void 0 === this._sound.start ? this._sound.noteGrainOn(0, a, b) : this.loop && this.game.device.chrome ? 42 === this.game.device.chromeVersion ? this._sound.start(0) : this._sound.start(0, a) : this._sound.start(0, a, b)
                } else this._sound.currentTime = this._tempPause, this._sound.play();
                this.isPlaying = !0, this.paused = !1, this.startTime += this.game.time.time - this.pausedTime, this.onResume.dispatch(this)
            }
        }, stop: function () {
            if (this.isPlaying && this._sound)if (this.usingWebAudio) {
                if (void 0 === this._sound.stop)this._sound.noteOff(0); else try {
                    this._sound.stop(0)
                } catch (a) {
                }
                this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode)
            } else this.usingAudioTag && (this._sound.pause(), this._sound.currentTime = 0);
            if (this.pendingPlayback = !1, this.isPlaying = !1, !this.paused) {
                var b = this.currentMarker;
                "" !== this.currentMarker && this.onMarkerComplete.dispatch(this.currentMarker, this), this.currentMarker = "", null !== this.fadeTween && this.fadeTween.stop(), this.onStop.dispatch(this, b)
            }
        }, fadeIn: function (a, b, c) {
            void 0 === b && (b = !1), void 0 === c && (c = this.currentMarker), this.paused || (this.play(c, 0, 0, b), this.fadeTo(a, 1))
        }, fadeOut: function (a) {
            this.fadeTo(a, 0)
        }, fadeTo: function (a, b) {
            if (this.isPlaying && !this.paused && b !== this.volume) {
                if (void 0 === a && (a = 1e3), void 0 === b)return void console.warn("Phaser.Sound.fadeTo: No Volume Specified.");
                this.fadeTween = this.game.add.tween(this).to({volume: b}, a, c.Easing.Linear.None, !0), this.fadeTween.onComplete.add(this.fadeComplete, this)
            }
        }, fadeComplete: function () {
            this.onFadeComplete.dispatch(this, this.volume), 0 === this.volume && this.stop()
        }, updateGlobalVolume: function (a) {
            this.usingAudioTag && this._sound && (this._sound.volume = a * this._volume)
        }, destroy: function (a) {
            void 0 === a && (a = !0), this.stop(), a ? this.game.sound.remove(this) : (this.markers = {}, this.context = null, this._buffer = null, this.externalNode = null, this.onDecoded.dispose(), this.onPlay.dispose(), this.onPause.dispose(), this.onResume.dispose(), this.onLoop.dispose(), this.onStop.dispose(), this.onMute.dispose(), this.onMarkerComplete.dispose())
        }
    },c.Sound.prototype.constructor = c.Sound,Object.defineProperty(c.Sound.prototype, "isDecoding", {
        get: function () {
            return this.game.cache.getSound(this.key).isDecoding
        }
    }),Object.defineProperty(c.Sound.prototype, "isDecoded", {
        get: function () {
            return this.game.cache.isSoundDecoded(this.key)
        }
    }),Object.defineProperty(c.Sound.prototype, "mute", {
        get: function () {
            return this._muted || this.game.sound.mute
        }, set: function (a) {
            a = a || !1, a !== this._muted && (a ? (this._muted = !0, this._muteVolume = this._tempVolume, this.usingWebAudio ? this.gainNode.gain.value = 0 : this.usingAudioTag && this._sound && (this._sound.volume = 0)) : (this._muted = !1, this.usingWebAudio ? this.gainNode.gain.value = this._muteVolume : this.usingAudioTag && this._sound && (this._sound.volume = this._muteVolume)), this.onMute.dispatch(this))
        }
    }),Object.defineProperty(c.Sound.prototype, "volume", {
        get: function () {
            return this._volume
        }, set: function (a) {
            return this.game.device.firefox && this.usingAudioTag && (a = this.game.math.clamp(a, 0, 1)), this._muted ? void(this._muteVolume = a) : (this._tempVolume = a, this._volume = a, void(this.usingWebAudio ? this.gainNode.gain.value = a : this.usingAudioTag && this._sound && (this._sound.volume = a)))
        }
    }),c.SoundManager = function (a) {
        this.game = a, this.onSoundDecode = new c.Signal, this.onVolumeChange = new c.Signal, this.onMute = new c.Signal, this.onUnMute = new c.Signal, this.context = null, this.usingWebAudio = !1, this.usingAudioTag = !1, this.noAudio = !1, this.connectToMaster = !0, this.touchLocked = !1, this.channels = 32, this.muteOnPause = !0, this._codeMuted = !1, this._muted = !1, this._unlockSource = null, this._volume = 1, this._sounds = [], this._watchList = new c.ArraySet, this._watching = !1, this._watchCallback = null, this._watchContext = null
    },c.SoundManager.prototype = {
        boot: function () {
            if (this.game.device.iOS && this.game.device.webAudio === !1 && (this.channels = 1), window.PhaserGlobal) {
                if (window.PhaserGlobal.disableAudio === !0)return this.noAudio = !0, void(this.touchLocked = !1);
                if (window.PhaserGlobal.disableWebAudio === !0)return this.usingAudioTag = !0, void(this.touchLocked = !1)
            }
            if (window.PhaserGlobal && window.PhaserGlobal.audioContext)this.context = window.PhaserGlobal.audioContext; else if (window.AudioContext)try {
                this.context = new window.AudioContext
            } catch (a) {
                this.context = null, this.usingWebAudio = !1, this.touchLocked = !1
            } else if (window.webkitAudioContext)try {
                this.context = new window.webkitAudioContext
            } catch (a) {
                this.context = null, this.usingWebAudio = !1, this.touchLocked = !1
            }
            if (null === this.context) {
                if (void 0 === window.Audio)return void(this.noAudio = !0);
                this.usingAudioTag = !0
            } else this.usingWebAudio = !0, void 0 === this.context.createGain ? this.masterGain = this.context.createGainNode() : this.masterGain = this.context.createGain(), this.masterGain.gain.value = 1, this.masterGain.connect(this.context.destination);
            this.noAudio || (!this.game.device.cocoonJS && this.game.device.iOS || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock) && this.setTouchLock()
        }, setTouchLock: function () {
            this.noAudio || window.PhaserGlobal && window.PhaserGlobal.disableAudio === !0 || (this.game.device.iOSVersion > 8 ? this.game.input.touch.addTouchLockCallback(this.unlock, this, !0) : this.game.input.touch.addTouchLockCallback(this.unlock, this), this.touchLocked = !0)
        }, unlock: function () {
            if (this.noAudio || !this.touchLocked || null !== this._unlockSource)return !0;
            if (this.usingAudioTag)this.touchLocked = !1, this._unlockSource = null; else if (this.usingWebAudio) {
                var a = this.context.createBuffer(1, 1, 22050);
                this._unlockSource = this.context.createBufferSource(), this._unlockSource.buffer = a, this._unlockSource.connect(this.context.destination), void 0 === this._unlockSource.start ? this._unlockSource.noteOn(0) : this._unlockSource.start(0)
            }
            return !0
        }, stopAll: function () {
            if (!this.noAudio)for (var a = 0; a < this._sounds.length; a++)this._sounds[a] && this._sounds[a].stop()
        }, pauseAll: function () {
            if (!this.noAudio)for (var a = 0; a < this._sounds.length; a++)this._sounds[a] && this._sounds[a].pause()
        }, resumeAll: function () {
            if (!this.noAudio)for (var a = 0; a < this._sounds.length; a++)this._sounds[a] && this._sounds[a].resume()
        }, decode: function (a, b) {
            b = b || null;
            var c = this.game.cache.getSoundData(a);
            if (c && this.game.cache.isSoundDecoded(a) === !1) {
                this.game.cache.updateSound(a, "isDecoding", !0);
                var d = this;
                try {
                    this.context.decodeAudioData(c, function (c) {
                        c && (d.game.cache.decodedSound(a, c), d.onSoundDecode.dispatch(a, b))
                    })
                } catch (e) {
                }
            }
        }, setDecodedCallback: function (a, b, d) {
            "string" == typeof a && (a = [a]), this._watchList.reset();
            for (var e = 0; e < a.length; e++)a[e] instanceof c.Sound ? this.game.cache.isSoundDecoded(a[e].key) || this._watchList.add(a[e].key) : this.game.cache.isSoundDecoded(a[e]) || this._watchList.add(a[e]);
            0 === this._watchList.total ? (this._watching = !1, b.call(d)) : (this._watching = !0, this._watchCallback = b, this._watchContext = d)
        }, update: function () {
            if (!this.noAudio) {
                !this.touchLocked || null === this._unlockSource || this._unlockSource.playbackState !== this._unlockSource.PLAYING_STATE && this._unlockSource.playbackState !== this._unlockSource.FINISHED_STATE || (this.touchLocked = !1, this._unlockSource = null);
                for (var a = 0; a < this._sounds.length; a++)this._sounds[a].update();
                if (this._watching) {
                    for (var b = this._watchList.first; b;)this.game.cache.isSoundDecoded(b) && this._watchList.remove(b), b = this._watchList.next;
                    0 === this._watchList.total && (this._watching = !1, this._watchCallback.call(this._watchContext))
                }
            }
        }, add: function (a, b, d, e) {
            void 0 === b && (b = 1), void 0 === d && (d = !1), void 0 === e && (e = this.connectToMaster);
            var f = new c.Sound(this.game, a, b, d, e);
            return this._sounds.push(f), f
        }, addSprite: function (a) {
            var b = new c.AudioSprite(this.game, a);
            return b
        }, remove: function (a) {
            for (var b = this._sounds.length; b--;)if (this._sounds[b] === a)return this._sounds[b].destroy(!1), this._sounds.splice(b, 1), !0;
            return !1
        }, removeByKey: function (a) {
            for (var b = this._sounds.length, c = 0; b--;)this._sounds[b].key === a && (this._sounds[b].destroy(!1), this._sounds.splice(b, 1), c++);
            return c
        }, play: function (a, b, c) {
            if (!this.noAudio) {
                var d = this.add(a, b, c);
                return d.play(), d
            }
        }, setMute: function () {
            if (!this._muted) {
                this._muted = !0, this.usingWebAudio && (this._muteVolume = this.masterGain.gain.value, this.masterGain.gain.value = 0);
                for (var a = 0; a < this._sounds.length; a++)this._sounds[a].usingAudioTag && (this._sounds[a].mute = !0);
                this.onMute.dispatch()
            }
        }, unsetMute: function () {
            if (this._muted && !this._codeMuted) {
                this._muted = !1, this.usingWebAudio && (this.masterGain.gain.value = this._muteVolume);
                for (var a = 0; a < this._sounds.length; a++)this._sounds[a].usingAudioTag && (this._sounds[a].mute = !1);
                this.onUnMute.dispatch()
            }
        }, destroy: function () {
            this.stopAll();
            for (var a = 0; a < this._sounds.length; a++)this._sounds[a] && this._sounds[a].destroy();
            this._sounds = [], this.onSoundDecode.dispose(), this.context && (window.PhaserGlobal ? window.PhaserGlobal.audioContext = this.context : this.context.close && this.context.close())
        }
    },c.SoundManager.prototype.constructor = c.SoundManager,Object.defineProperty(c.SoundManager.prototype, "mute", {
        get: function () {
            return this._muted
        }, set: function (a) {
            if (a = a || !1) {
                if (this._muted)return;
                this._codeMuted = !0, this.setMute()
            } else {
                if (!this._muted)return;
                this._codeMuted = !1, this.unsetMute()
            }
        }
    }),Object.defineProperty(c.SoundManager.prototype, "volume", {
        get: function () {
            return this._volume
        }, set: function (a) {
            if (0 > a ? a = 0 : a > 1 && (a = 1), this._volume !== a) {
                if (this._volume = a, this.usingWebAudio)this.masterGain.gain.value = a; else for (var b = 0; b < this._sounds.length; b++)this._sounds[b].usingAudioTag && this._sounds[b].updateGlobalVolume(a);
                this.onVolumeChange.dispatch(a)
            }
        }
    }),c.ScaleManager = function (a, b, d) {
        this.game = a, this.dom = c.DOM, this.grid = null, this.width = 0, this.height = 0, this.minWidth = null, this.maxWidth = null, this.minHeight = null, this.maxHeight = null, this.offset = new c.Point, this.forceLandscape = !1, this.forcePortrait = !1, this.incorrectOrientation = !1, this._pageAlignHorizontally = !1, this._pageAlignVertically = !1, this.onOrientationChange = new c.Signal, this.enterIncorrectOrientation = new c.Signal, this.leaveIncorrectOrientation = new c.Signal, this.fullScreenTarget = null, this._createdFullScreenTarget = null, this.onFullScreenInit = new c.Signal, this.onFullScreenChange = new c.Signal, this.onFullScreenError = new c.Signal, this.screenOrientation = this.dom.getScreenOrientation(), this.scaleFactor = new c.Point(1, 1), this.scaleFactorInversed = new c.Point(1, 1), this.margin = {
            left: 0,
            top: 0,
            right: 0,
            bottom: 0,
            x: 0,
            y: 0
        }, this.bounds = new c.Rectangle, this.aspectRatio = 0, this.sourceAspectRatio = 0, this.event = null, this.windowConstraints = {
            right: "layout",
            bottom: ""
        }, this.compatibility = {
            supportsFullScreen: !1,
            orientationFallback: null,
            noMargins: !1,
            scrollTo: null,
            forceMinimumDocumentHeight: !1,
            canExpandParent: !0,
            clickTrampoline: ""
        }, this._scaleMode = c.ScaleManager.NO_SCALE, this._fullScreenScaleMode = c.ScaleManager.NO_SCALE, this.parentIsWindow = !1, this.parentNode = null, this.parentScaleFactor = new c.Point(1, 1), this.trackParentInterval = 2e3, this.onSizeChange = new c.Signal, this.onResize = null, this.onResizeContext = null, this._pendingScaleMode = null, this._fullScreenRestore = null, this._gameSize = new c.Rectangle, this._userScaleFactor = new c.Point(1, 1), this._userScaleTrim = new c.Point(0, 0), this._lastUpdate = 0, this._updateThrottle = 0, this._updateThrottleReset = 100, this._parentBounds = new c.Rectangle, this._tempBounds = new c.Rectangle, this._lastReportedCanvasSize = new c.Rectangle, this._lastReportedGameSize = new c.Rectangle, this._booted = !1, a.config && this.parseConfig(a.config), this.setupScale(b, d)
    },c.ScaleManager.EXACT_FIT = 0,c.ScaleManager.NO_SCALE = 1,c.ScaleManager.SHOW_ALL = 2,c.ScaleManager.RESIZE = 3,c.ScaleManager.USER_SCALE = 4,c.ScaleManager.prototype = {
        boot: function () {
            var a = this.compatibility;
            a.supportsFullScreen = this.game.device.fullscreen && !this.game.device.cocoonJS, this.game.device.iPad || this.game.device.webApp || this.game.device.desktop || (this.game.device.android && !this.game.device.chrome ? a.scrollTo = new c.Point(0, 1) : a.scrollTo = new c.Point(0, 0)), this.game.device.desktop ? (a.orientationFallback = "screen", a.clickTrampoline = "when-not-mouse") : (a.orientationFallback = "", a.clickTrampoline = "");
            var b = this;
            this._orientationChange = function (a) {
                return b.orientationChange(a)
            }, this._windowResize = function (a) {
                return b.windowResize(a)
            }, window.addEventListener("orientationchange", this._orientationChange, !1), window.addEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (this._fullScreenChange = function (a) {
                return b.fullScreenChange(a)
            }, this._fullScreenError = function (a) {
                return b.fullScreenError(a)
            }, document.addEventListener("webkitfullscreenchange", this._fullScreenChange, !1), document.addEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.addEventListener("MSFullscreenChange", this._fullScreenChange, !1), document.addEventListener("fullscreenchange", this._fullScreenChange, !1), document.addEventListener("webkitfullscreenerror", this._fullScreenError, !1), document.addEventListener("mozfullscreenerror", this._fullScreenError, !1), document.addEventListener("MSFullscreenError", this._fullScreenError, !1), document.addEventListener("fullscreenerror", this._fullScreenError, !1)), this.game.onResume.add(this._gameResumed, this), this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.setGameSize(this.game.width, this.game.height), this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), c.FlexGrid && (this.grid = new c.FlexGrid(this, this.width, this.height)), this._booted = !0, null !== this._pendingScaleMode && (this.scaleMode = this._pendingScaleMode, this._pendingScaleMode = null)
        }, parseConfig: function (a) {
            void 0 !== a.scaleMode && (this._booted ? this.scaleMode = a.scaleMode : this._pendingScaleMode = a.scaleMode), void 0 !== a.fullScreenScaleMode && (this.fullScreenScaleMode = a.fullScreenScaleMode), a.fullScreenTarget && (this.fullScreenTarget = a.fullScreenTarget)
        }, setupScale: function (a, b) {
            var d, e = new c.Rectangle;
            "" !== this.game.parent && ("string" == typeof this.game.parent ? d = document.getElementById(this.game.parent) : this.game.parent && 1 === this.game.parent.nodeType && (d = this.game.parent)), d ? (this.parentNode = d, this.parentIsWindow = !1, this.getParentBounds(this._parentBounds), e.width = this._parentBounds.width, e.height = this._parentBounds.height, this.offset.set(this._parentBounds.x, this._parentBounds.y)) : (this.parentNode = null, this.parentIsWindow = !0, e.width = this.dom.visualBounds.width, e.height = this.dom.visualBounds.height, this.offset.set(0, 0));
            var f = 0, g = 0;
            "number" == typeof a ? f = a : (this.parentScaleFactor.x = parseInt(a, 10) / 100, f = e.width * this.parentScaleFactor.x), "number" == typeof b ? g = b : (this.parentScaleFactor.y = parseInt(b, 10) / 100, g = e.height * this.parentScaleFactor.y), f = Math.floor(f), g = Math.floor(g), this._gameSize.setTo(0, 0, f, g), this.updateDimensions(f, g, !1)
        }, _gameResumed: function () {
            this.queueUpdate(!0)
        }, setGameSize: function (a, b) {
            this._gameSize.setTo(0, 0, a, b), this.currentScaleMode !== c.ScaleManager.RESIZE && this.updateDimensions(a, b, !0), this.queueUpdate(!0)
        }, setUserScale: function (a, b, c, d) {
            this._userScaleFactor.setTo(a, b), this._userScaleTrim.setTo(0 | c, 0 | d), this.queueUpdate(!0)
        }, setResizeCallback: function (a, b) {
            this.onResize = a, this.onResizeContext = b
        }, signalSizeChange: function () {
            if (!c.Rectangle.sameDimensions(this, this._lastReportedCanvasSize) || !c.Rectangle.sameDimensions(this.game, this._lastReportedGameSize)) {
                var a = this.width, b = this.height;
                this._lastReportedCanvasSize.setTo(0, 0, a, b), this._lastReportedGameSize.setTo(0, 0, this.game.width, this.game.height), this.grid && this.grid.onResize(a, b), this.onSizeChange.dispatch(this, a, b), this.currentScaleMode === c.ScaleManager.RESIZE && (this.game.state.resize(a, b), this.game.load.resize(a, b))
            }
        }, setMinMax: function (a, b, c, d) {
            this.minWidth = a, this.minHeight = b, "undefined" != typeof c && (this.maxWidth = c), "undefined" != typeof d && (this.maxHeight = d)
        }, preUpdate: function () {
            if (!(this.game.time.time < this._lastUpdate + this._updateThrottle)) {
                var a = this._updateThrottle;
                this._updateThrottleReset = a >= 400 ? 0 : 100, this.dom.getOffset(this.game.canvas, this.offset);
                var b = this._parentBounds.width, d = this._parentBounds.height, e = this.getParentBounds(this._parentBounds), f = e.width !== b || e.height !== d, g = this.updateOrientationState();
                (f || g) && (this.onResize && this.onResize.call(this.onResizeContext, this, e), this.updateLayout(), this.signalSizeChange());
                var h = 2 * this._updateThrottle;
                this._updateThrottle < a && (h = Math.min(a, this._updateThrottleReset)), this._updateThrottle = c.Math.clamp(h, 25, this.trackParentInterval), this._lastUpdate = this.game.time.time
            }
        }, pauseUpdate: function () {
            this.preUpdate(), this._updateThrottle = this.trackParentInterval
        }, updateDimensions: function (a, b, c) {
            this.width = a * this.parentScaleFactor.x, this.height = b * this.parentScaleFactor.y, this.game.width = this.width, this.game.height = this.height, this.sourceAspectRatio = this.width / this.height, this.updateScalingAndBounds(), c && (this.game.renderer.resize(this.width, this.height), this.game.camera.setSize(this.width, this.height), this.game.world.resize(this.width, this.height))
        }, updateScalingAndBounds: function () {
            this.scaleFactor.x = this.game.width / this.width, this.scaleFactor.y = this.game.height / this.height, this.scaleFactorInversed.x = this.width / this.game.width, this.scaleFactorInversed.y = this.height / this.game.height, this.aspectRatio = this.width / this.height, this.game.canvas && this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.game.input && this.game.input.scale && this.game.input.scale.setTo(this.scaleFactor.x, this.scaleFactor.y)
        }, forceOrientation: function (a, b) {
            void 0 === b && (b = !1), this.forceLandscape = a, this.forcePortrait = b, this.queueUpdate(!0)
        }, classifyOrientation: function (a) {
            return "portrait-primary" === a || "portrait-secondary" === a ? "portrait" : "landscape-primary" === a || "landscape-secondary" === a ? "landscape" : null
        }, updateOrientationState: function () {
            var a = this.screenOrientation, b = this.incorrectOrientation;
            this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), this.incorrectOrientation = this.forceLandscape && !this.isLandscape || this.forcePortrait && !this.isPortrait;
            var c = a !== this.screenOrientation, d = b !== this.incorrectOrientation;
            return d && (this.incorrectOrientation ? this.enterIncorrectOrientation.dispatch() : this.leaveIncorrectOrientation.dispatch()), (c || d) && this.onOrientationChange.dispatch(this, a, b), c || d
        }, orientationChange: function (a) {
            this.event = a, this.queueUpdate(!0)
        }, windowResize: function (a) {
            this.event = a, this.queueUpdate(!0)
        }, scrollTop: function () {
            var a = this.compatibility.scrollTo;
            a && window.scrollTo(a.x, a.y)
        }, refresh: function () {
            this.scrollTop(), this.queueUpdate(!0)
        }, updateLayout: function () {
            var a = this.currentScaleMode;
            if (a === c.ScaleManager.RESIZE)return void this.reflowGame();
            if (this.scrollTop(), this.compatibility.forceMinimumDocumentHeight && (document.documentElement.style.minHeight = window.innerHeight + "px"), this.incorrectOrientation ? this.setMaximum() : a === c.ScaleManager.EXACT_FIT ? this.setExactFit() : a === c.ScaleManager.SHOW_ALL ? !this.isFullScreen && this.boundingParent && this.compatibility.canExpandParent ? (this.setShowAll(!0), this.resetCanvas(), this.setShowAll()) : this.setShowAll() : a === c.ScaleManager.NO_SCALE ? (this.width = this.game.width, this.height = this.game.height) : a === c.ScaleManager.USER_SCALE && (this.width = this.game.width * this._userScaleFactor.x - this._userScaleTrim.x, this.height = this.game.height * this._userScaleFactor.y - this._userScaleTrim.y), !this.compatibility.canExpandParent && (a === c.ScaleManager.SHOW_ALL || a === c.ScaleManager.USER_SCALE)) {
                var b = this.getParentBounds(this._tempBounds);
                this.width = Math.min(this.width, b.width), this.height = Math.min(this.height, b.height)
            }
            this.width = 0 | this.width, this.height = 0 | this.height, this.reflowCanvas()
        }, getParentBounds: function (a) {
            var b = a || new c.Rectangle, d = this.boundingParent, e = this.dom.visualBounds, f = this.dom.layoutBounds;
            if (d) {
                var g = d.getBoundingClientRect(), h = d.offsetParent ? d.offsetParent.getBoundingClientRect() : d.getBoundingClientRect();
                b.setTo(g.left - h.left, g.top - h.top, g.width, g.height);
                var i = this.windowConstraints;
                if (i.right) {
                    var j = "layout" === i.right ? f : e;
                    b.right = Math.min(b.right, j.width)
                }
                if (i.bottom) {
                    var j = "layout" === i.bottom ? f : e;
                    b.bottom = Math.min(b.bottom, j.height)
                }
            } else b.setTo(0, 0, e.width, e.height);
            return b.setTo(Math.round(b.x), Math.round(b.y), Math.round(b.width), Math.round(b.height)), b
        }, alignCanvas: function (a, b) {
            var c = this.getParentBounds(this._tempBounds), d = this.game.canvas, e = this.margin;
            if (a) {
                e.left = e.right = 0;
                var f = d.getBoundingClientRect();
                if (this.width < c.width && !this.incorrectOrientation) {
                    var g = f.left - c.x, h = c.width / 2 - this.width / 2;
                    h = Math.max(h, 0);
                    var i = h - g;
                    e.left = Math.round(i)
                }
                d.style.marginLeft = e.left + "px", 0 !== e.left && (e.right = -(c.width - f.width - e.left), d.style.marginRight = e.right + "px")
            }
            if (b) {
                e.top = e.bottom = 0;
                var f = d.getBoundingClientRect();
                if (this.height < c.height && !this.incorrectOrientation) {
                    var g = f.top - c.y, h = c.height / 2 - this.height / 2;
                    h = Math.max(h, 0);
                    var i = h - g;
                    e.top = Math.round(i)
                }
                d.style.marginTop = e.top + "px", 0 !== e.top && (e.bottom = -(c.height - f.height - e.top), d.style.marginBottom = e.bottom + "px")
            }
            e.x = e.left, e.y = e.top
        }, reflowGame: function () {
            this.resetCanvas("", "");
            var a = this.getParentBounds(this._tempBounds);
            this.updateDimensions(a.width, a.height, !0)
        }, reflowCanvas: function () {
            this.incorrectOrientation || (this.width = c.Math.clamp(this.width, this.minWidth || 0, this.maxWidth || this.width), this.height = c.Math.clamp(this.height, this.minHeight || 0, this.maxHeight || this.height)), this.resetCanvas(), this.compatibility.noMargins || (this.isFullScreen && this._createdFullScreenTarget ? this.alignCanvas(!0, !0) : this.alignCanvas(this.pageAlignHorizontally, this.pageAlignVertically)), this.updateScalingAndBounds()
        }, resetCanvas: function (a, b) {
            void 0 === a && (a = this.width + "px"), void 0 === b && (b = this.height + "px");
            var c = this.game.canvas;
            this.compatibility.noMargins || (c.style.marginLeft = "", c.style.marginTop = "", c.style.marginRight = "", c.style.marginBottom = ""), c.style.width = a, c.style.height = b
        }, queueUpdate: function (a) {
            a && (this._parentBounds.width = 0, this._parentBounds.height = 0), this._updateThrottle = this._updateThrottleReset
        }, reset: function (a) {
            a && this.grid && this.grid.reset()
        }, setMaximum: function () {
            this.width = this.dom.visualBounds.width, this.height = this.dom.visualBounds.height
        }, setShowAll: function (a) {
            var b, c = this.getParentBounds(this._tempBounds), d = c.width, e = c.height;
            b = a ? Math.max(e / this.game.height, d / this.game.width) : Math.min(e / this.game.height, d / this.game.width), this.width = Math.round(this.game.width * b), this.height = Math.round(this.game.height * b)
        }, setExactFit: function () {
            var a = this.getParentBounds(this._tempBounds);
            this.width = a.width, this.height = a.height, this.isFullScreen || (this.maxWidth && (this.width = Math.min(this.width, this.maxWidth)), this.maxHeight && (this.height = Math.min(this.height, this.maxHeight)))
        }, createFullScreenTarget: function () {
            var a = document.createElement("div");
            return a.style.margin = "0", a.style.padding = "0", a.style.background = "#000", a
        }, startFullScreen: function (a, b) {
            if (this.isFullScreen)return !1;
            if (!this.compatibility.supportsFullScreen) {
                var d = this;
                return void setTimeout(function () {
                    d.fullScreenError()
                }, 10)
            }
            if ("when-not-mouse" === this.compatibility.clickTrampoline) {
                var e = this.game.input;
                if (e.activePointer && e.activePointer !== e.mousePointer && (b || b !== !1))return void e.activePointer.addClickTrampoline("startFullScreen", this.startFullScreen, this, [a, !1])
            }
            "undefined" != typeof a && this.game.renderType === c.CANVAS && (this.game.stage.smoothed = a);
            var f = this.fullScreenTarget;
            f || (this.cleanupCreatedTarget(), this._createdFullScreenTarget = this.createFullScreenTarget(), f = this._createdFullScreenTarget);
            var g = {targetElement: f};
            if (this.onFullScreenInit.dispatch(this, g), this._createdFullScreenTarget) {
                var h = this.game.canvas, i = h.parentNode;
                i.insertBefore(f, h), f.appendChild(h)
            }
            return this.game.device.fullscreenKeyboard ? f[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT) : f[this.game.device.requestFullscreen](), !0
        }, stopFullScreen: function () {
            return this.isFullScreen && this.compatibility.supportsFullScreen ? (document[this.game.device.cancelFullscreen](), !0) : !1
        }, cleanupCreatedTarget: function () {
            var a = this._createdFullScreenTarget;
            if (a && a.parentNode) {
                var b = a.parentNode;
                b.insertBefore(this.game.canvas, a), b.removeChild(a)
            }
            this._createdFullScreenTarget = null
        }, prepScreenMode: function (a) {
            var b = !!this._createdFullScreenTarget, d = this._createdFullScreenTarget || this.fullScreenTarget;
            a ? (b || this.fullScreenScaleMode === c.ScaleManager.EXACT_FIT) && d !== this.game.canvas && (this._fullScreenRestore = {
                targetWidth: d.style.width,
                targetHeight: d.style.height
            }, d.style.width = "100%", d.style.height = "100%") : (this._fullScreenRestore && (d.style.width = this._fullScreenRestore.targetWidth, d.style.height = this._fullScreenRestore.targetHeight, this._fullScreenRestore = null), this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.resetCanvas())
        }, fullScreenChange: function (a) {
            this.event = a, this.isFullScreen ? (this.prepScreenMode(!0), this.updateLayout(), this.queueUpdate(!0)) : (this.prepScreenMode(!1), this.cleanupCreatedTarget(), this.updateLayout(), this.queueUpdate(!0)), this.onFullScreenChange.dispatch(this, this.width, this.height)
        }, fullScreenError: function (a) {
            this.event = a, this.cleanupCreatedTarget(), console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API"), this.onFullScreenError.dispatch(this)
        }, scaleSprite: function (a, b, c, d) {
            if (void 0 === b && (b = this.width), void 0 === c && (c = this.height), void 0 === d && (d = !1), !a || !a.scale)return a;
            if (a.scale.x = 1, a.scale.y = 1, a.width <= 0 || a.height <= 0 || 0 >= b || 0 >= c)return a;
            var e = b, f = a.height * b / a.width, g = a.width * c / a.height, h = c, i = g > b;
            return i = i ? d : !d, i ? (a.width = Math.floor(e), a.height = Math.floor(f)) : (a.width = Math.floor(g), a.height = Math.floor(h)), a
        }, destroy: function () {
            this.game.onResume.remove(this._gameResumed, this), window.removeEventListener("orientationchange", this._orientationChange, !1), window.removeEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (document.removeEventListener("webkitfullscreenchange", this._fullScreenChange, !1), document.removeEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.removeEventListener("MSFullscreenChange", this._fullScreenChange, !1), document.removeEventListener("fullscreenchange", this._fullScreenChange, !1), document.removeEventListener("webkitfullscreenerror", this._fullScreenError, !1), document.removeEventListener("mozfullscreenerror", this._fullScreenError, !1), document.removeEventListener("MSFullscreenError", this._fullScreenError, !1), document.removeEventListener("fullscreenerror", this._fullScreenError, !1))
        }
    },c.ScaleManager.prototype.constructor = c.ScaleManager,Object.defineProperty(c.ScaleManager.prototype, "boundingParent", {
        get: function () {
            if (this.parentIsWindow || this.isFullScreen && !this._createdFullScreenTarget)return null;
            var a = this.game.canvas && this.game.canvas.parentNode;
            return a || null
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "scaleMode", {
        get: function () {
            return this._scaleMode
        }, set: function (a) {
            return a !== this._scaleMode && (this.isFullScreen || (this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.queueUpdate(!0)), this._scaleMode = a), this._scaleMode
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "fullScreenScaleMode", {
        get: function () {
            return this._fullScreenScaleMode
        }, set: function (a) {
            return a !== this._fullScreenScaleMode && (this.isFullScreen ? (this.prepScreenMode(!1), this._fullScreenScaleMode = a, this.prepScreenMode(!0), this.queueUpdate(!0)) : this._fullScreenScaleMode = a), this._fullScreenScaleMode
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "currentScaleMode", {
        get: function () {
            return this.isFullScreen ? this._fullScreenScaleMode : this._scaleMode
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "pageAlignHorizontally", {
        get: function () {
            return this._pageAlignHorizontally
        }, set: function (a) {
            a !== this._pageAlignHorizontally && (this._pageAlignHorizontally = a, this.queueUpdate(!0))
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "pageAlignVertically", {
        get: function () {
            return this._pageAlignVertically
        }, set: function (a) {
            a !== this._pageAlignVertically && (this._pageAlignVertically = a, this.queueUpdate(!0))
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "isFullScreen", {
        get: function () {
            return !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "isPortrait", {
        get: function () {
            return "portrait" === this.classifyOrientation(this.screenOrientation)
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "isLandscape", {
        get: function () {
            return "landscape" === this.classifyOrientation(this.screenOrientation)
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "isGamePortrait", {
        get: function () {
            return this.height > this.width
        }
    }),Object.defineProperty(c.ScaleManager.prototype, "isGameLandscape", {
        get: function () {
            return this.width > this.height
        }
    }),c.Utils.Debug = function (a) {
        this.game = a, this.sprite = null, this.bmd = null, this.canvas = null, this.context = null, this.font = "14px Courier", this.columnWidth = 100, this.lineHeight = 16, this.renderShadow = !0, this.currentX = 0, this.currentY = 0, this.currentAlpha = 1, this.dirty = !1
    },c.Utils.Debug.prototype = {
        boot: function () {
            this.game.renderType === c.CANVAS ? this.context = this.game.context : (this.bmd = new c.BitmapData(this.game, "__DEBUG", this.game.width, this.game.height, !0), this.sprite = this.game.make.image(0, 0, this.bmd), this.game.stage.addChild(this.sprite), this.game.scale.onSizeChange.add(this.resize, this), this.canvas = PIXI.CanvasPool.create(this, this.game.width, this.game.height), this.context = this.canvas.getContext("2d"))
        }, resize: function (a, b, c) {
            this.bmd.resize(b, c), this.canvas.width = b, this.canvas.height = c
        }, preUpdate: function () {
            this.dirty && this.sprite && (this.bmd.clear(), this.bmd.draw(this.canvas, 0, 0), this.context.clearRect(0, 0, this.game.width, this.game.height), this.dirty = !1)
        }, reset: function () {
            this.context && this.context.clearRect(0, 0, this.game.width, this.game.height), this.sprite && this.bmd.clear()
        }, start: function (a, b, c, d) {
            "number" != typeof a && (a = 0), "number" != typeof b && (b = 0), c = c || "rgb(255,255,255)", void 0 === d && (d = 0), this.currentX = a, this.currentY = b, this.currentColor = c, this.columnWidth = d, this.dirty = !0, this.context.save(), this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.strokeStyle = c, this.context.fillStyle = c, this.context.font = this.font, this.context.globalAlpha = this.currentAlpha
        }, stop: function () {
            this.context.restore()
        }, line: function () {
            for (var a = this.currentX, b = 0; b < arguments.length; b++)this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(arguments[b], a + 1, this.currentY + 1), this.context.fillStyle = this.currentColor), this.context.fillText(arguments[b], a, this.currentY), a += this.columnWidth;
            this.currentY += this.lineHeight
        }, soundInfo: function (a, b, c, d) {
            this.start(b, c, d), this.line("Sound: " + a.key + " Locked: " + a.game.sound.touchLocked), this.line("Is Ready?: " + this.game.cache.isSoundReady(a.key) + " Pending Playback: " + a.pendingPlayback), this.line("Decoded: " + a.isDecoded + " Decoding: " + a.isDecoding), this.line("Total Duration: " + a.totalDuration + " Playing: " + a.isPlaying), this.line("Time: " + a.currentTime), this.line("Volume: " + a.volume + " Muted: " + a.mute), this.line("WebAudio: " + a.usingWebAudio + " Audio: " + a.usingAudioTag), "" !== a.currentMarker && (this.line("Marker: " + a.currentMarker + " Duration: " + a.duration + " (ms: " + a.durationMS + ")"), this.line("Start: " + a.markers[a.currentMarker].start + " Stop: " + a.markers[a.currentMarker].stop), this.line("Position: " + a.position)), this.stop()
        }, cameraInfo: function (a, b, c, d) {
            this.start(b, c, d), this.line("Camera (" + a.width + " x " + a.height + ")"), this.line("X: " + a.x + " Y: " + a.y), a.bounds && this.line("Bounds x: " + a.bounds.x + " Y: " + a.bounds.y + " w: " + a.bounds.width + " h: " + a.bounds.height), this.line("View x: " + a.view.x + " Y: " + a.view.y + " w: " + a.view.width + " h: " + a.view.height), this.line("Total in view: " + a.totalInView), this.stop()
        }, timer: function (a, b, c, d) {
            this.start(b, c, d), this.line("Timer (running: " + a.running + " expired: " + a.expired + ")"), this.line("Next Tick: " + a.next + " Duration: " + a.duration), this.line("Paused: " + a.paused + " Length: " + a.length), this.stop()
        }, pointer: function (a, b, c, d, e) {
            null != a && (void 0 === b && (b = !1), c = c || "rgba(0,255,0,0.5)", d = d || "rgba(255,0,0,0.5)", (b !== !0 || a.isUp !== !0) && (this.start(a.x, a.y - 100, e), this.context.beginPath(), this.context.arc(a.x, a.y, a.circle.radius, 0, 2 * Math.PI), a.active ? this.context.fillStyle = c : this.context.fillStyle = d, this.context.fill(), this.context.closePath(), this.context.beginPath(), this.context.moveTo(a.positionDown.x, a.positionDown.y), this.context.lineTo(a.position.x, a.position.y), this.context.lineWidth = 2, this.context.stroke(), this.context.closePath(), this.line("ID: " + a.id + " Active: " + a.active), this.line("World X: " + a.worldX + " World Y: " + a.worldY), this.line("Screen X: " + a.x + " Screen Y: " + a.y + " In: " + a.withinGame), this.line("Duration: " + a.duration + " ms"), this.line("is Down: " + a.isDown + " is Up: " + a.isUp), this.stop()))
        }, spriteInputInfo: function (a, b, c, d) {
            this.start(b, c, d), this.line("Sprite Input: (" + a.width + " x " + a.height + ")"), this.line("x: " + a.input.pointerX().toFixed(1) + " y: " + a.input.pointerY().toFixed(1)), this.line("over: " + a.input.pointerOver() + " duration: " + a.input.overDuration().toFixed(0)), this.line("down: " + a.input.pointerDown() + " duration: " + a.input.downDuration().toFixed(0)), this.line("just over: " + a.input.justOver() + " just out: " + a.input.justOut()), this.stop()
        }, key: function (a, b, c, d) {
            this.start(b, c, d, 150), this.line("Key:", a.keyCode, "isDown:", a.isDown), this.line("justDown:", a.justDown, "justUp:", a.justUp), this.line("Time Down:", a.timeDown.toFixed(0), "duration:", a.duration.toFixed(0)), this.stop()
        }, inputInfo: function (a, b, c) {
            this.start(a, b, c), this.line("Input"), this.line("X: " + this.game.input.x + " Y: " + this.game.input.y), this.line("World X: " + this.game.input.worldX + " World Y: " + this.game.input.worldY), this.line("Scale X: " + this.game.input.scale.x.toFixed(1) + " Scale Y: " + this.game.input.scale.x.toFixed(1)), this.line("Screen X: " + this.game.input.activePointer.screenX + " Screen Y: " + this.game.input.activePointer.screenY), this.stop()
        }, spriteBounds: function (a, b, c) {
            var d = a.getBounds();
            d.x += this.game.camera.x, d.y += this.game.camera.y, this.rectangle(d, b, c)
        }, ropeSegments: function (a, b, c) {
            var d = a.segments, e = this;
            d.forEach(function (a) {
                e.rectangle(a, b, c)
            }, this)
        }, spriteInfo: function (a, b, c, d) {
            this.start(b, c, d), this.line("Sprite:  (" + a.width + " x " + a.height + ") anchor: " + a.anchor.x + " x " + a.anchor.y), this.line("x: " + a.x.toFixed(1) + " y: " + a.y.toFixed(1)), this.line("angle: " + a.angle.toFixed(1) + " rotation: " + a.rotation.toFixed(1)), this.line("visible: " + a.visible + " in camera: " + a.inCamera), this.line("bounds x: " + a._bounds.x.toFixed(1) + " y: " + a._bounds.y.toFixed(1) + " w: " + a._bounds.width.toFixed(1) + " h: " + a._bounds.height.toFixed(1)), this.stop()
        }, spriteCoords: function (a, b, c, d) {
            this.start(b, c, d, 100), a.name && this.line(a.name), this.line("x:", a.x.toFixed(2), "y:", a.y.toFixed(2)), this.line("pos x:", a.position.x.toFixed(2), "pos y:", a.position.y.toFixed(2)), this.line("world x:", a.world.x.toFixed(2), "world y:", a.world.y.toFixed(2)), this.stop()
        }, lineInfo: function (a, b, c, d) {
            this.start(b, c, d, 80), this.line("start.x:", a.start.x.toFixed(2), "start.y:", a.start.y.toFixed(2)), this.line("end.x:", a.end.x.toFixed(2), "end.y:", a.end.y.toFixed(2)), this.line("length:", a.length.toFixed(2), "angle:", a.angle), this.stop()
        }, pixel: function (a, b, c, d) {
            d = d || 2, this.start(), this.context.fillStyle = c, this.context.fillRect(a, b, d, d), this.stop()
        }, geom: function (a, b, d, e) {
            void 0 === d && (d = !0), void 0 === e && (e = 0), b = b || "rgba(0,255,0,0.4)", this.start(), this.context.fillStyle = b, this.context.strokeStyle = b, a instanceof c.Rectangle || 1 === e ? d ? this.context.fillRect(a.x - this.game.camera.x, a.y - this.game.camera.y, a.width, a.height) : this.context.strokeRect(a.x - this.game.camera.x, a.y - this.game.camera.y, a.width, a.height) : a instanceof c.Circle || 2 === e ? (this.context.beginPath(), this.context.arc(a.x - this.game.camera.x, a.y - this.game.camera.y, a.radius, 0, 2 * Math.PI, !1), this.context.closePath(), d ? this.context.fill() : this.context.stroke()) : a instanceof c.Point || 3 === e ? this.context.fillRect(a.x - this.game.camera.x, a.y - this.game.camera.y, 4, 4) : (a instanceof c.Line || 4 === e) && (this.context.lineWidth = 1, this.context.beginPath(), this.context.moveTo(a.start.x + .5 - this.game.camera.x, a.start.y + .5 - this.game.camera.y), this.context.lineTo(a.end.x + .5 - this.game.camera.x, a.end.y + .5 - this.game.camera.y), this.context.closePath(), this.context.stroke()), this.stop()
        }, rectangle: function (a, b, c) {
            void 0 === c && (c = !0), b = b || "rgba(0, 255, 0, 0.4)", this.start(), c ? (this.context.fillStyle = b, this.context.fillRect(a.x - this.game.camera.x, a.y - this.game.camera.y, a.width, a.height)) : (this.context.strokeStyle = b, this.context.strokeRect(a.x - this.game.camera.x, a.y - this.game.camera.y, a.width, a.height)), this.stop()
        }, text: function (a, b, c, d, e) {
            d = d || "rgb(255,255,255)", e = e || "16px Courier", this.start(), this.context.font = e, this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(a, b + 1, c + 1)), this.context.fillStyle = d, this.context.fillText(a, b, c), this.stop()
        }, quadTree: function (a, b) {
            b = b || "rgba(255,0,0,0.3)", this.start();
            var c = a.bounds;
            if (0 === a.nodes.length) {
                this.context.strokeStyle = b, this.context.strokeRect(c.x, c.y, c.width, c.height), this.text("size: " + a.objects.length, c.x + 4, c.y + 16, "rgb(0,200,0)", "12px Courier"), this.context.strokeStyle = "rgb(0,255,0)";
                for (var d = 0; d < a.objects.length; d++)this.context.strokeRect(a.objects[d].x, a.objects[d].y, a.objects[d].width, a.objects[d].height)
            } else for (var d = 0; d < a.nodes.length; d++)this.quadTree(a.nodes[d]);
            this.stop()
        }, body: function (a, b, d) {
            a.body && (this.start(), a.body.type === c.Physics.ARCADE ? c.Physics.Arcade.Body.render(this.context, a.body, b, d) : a.body.type === c.Physics.NINJA ? c.Physics.Ninja.Body.render(this.context, a.body, b, d) : a.body.type === c.Physics.BOX2D && c.Physics.Box2D.renderBody(this.context, a.body, b), this.stop())
        }, bodyInfo: function (a, b, d, e) {
            a.body && (this.start(b, d, e, 210), a.body.type === c.Physics.ARCADE ? c.Physics.Arcade.Body.renderBodyInfo(this, a.body) : a.body.type === c.Physics.BOX2D && this.game.physics.box2d.renderBodyInfo(this, a.body), this.stop())
        }, box2dWorld: function () {
            this.start(), this.context.translate(-this.game.camera.view.x, -this.game.camera.view.y, 0), this.game.physics.box2d.renderDebugDraw(this.context), this.stop()
        }, box2dBody: function (a, b) {
            this.start(), c.Physics.Box2D.renderBody(this.context, a, b), this.stop()
        }, displayList: function (a) {
            if (void 0 === a && (a = this.game.world), a.hasOwnProperty("renderOrderID") ? console.log("[" + a.renderOrderID + "]", a) : console.log("[]", a), a.children && a.children.length > 0)for (var b = 0; b < a.children.length; b++)this.game.debug.displayList(a.children[b])
        }, destroy: function () {
            PIXI.CanvasPool.remove(this)
        }
    },c.Utils.Debug.prototype.constructor = c.Utils.Debug,c.DOM = {
        getOffset: function (a, b) {
            b = b || new c.Point;
            var d = a.getBoundingClientRect(), e = c.DOM.scrollY, f = c.DOM.scrollX, g = document.documentElement.clientTop, h = document.documentElement.clientLeft;
            return b.x = d.left + f - h, b.y = d.top + e - g, b
        }, getBounds: function (a, b) {
            return void 0 === b && (b = 0), a = a && !a.nodeType ? a[0] : a, a && 1 === a.nodeType ? this.calibrate(a.getBoundingClientRect(), b) : !1
        }, calibrate: function (a, b) {
            b = +b || 0;
            var c = {width: 0, height: 0, left: 0, right: 0, top: 0, bottom: 0};
            return c.width = (c.right = a.right + b) - (c.left = a.left - b), c.height = (c.bottom = a.bottom + b) - (c.top = a.top - b), c
        }, getAspectRatio: function (a) {
            a = null == a ? this.visualBounds : 1 === a.nodeType ? this.getBounds(a) : a;
            var b = a.width, c = a.height;
            return "function" == typeof b && (b = b.call(a)), "function" == typeof c && (c = c.call(a)), b / c
        }, inLayoutViewport: function (a, b) {
            var c = this.getBounds(a, b);
            return !!c && c.bottom >= 0 && c.right >= 0 && c.top <= this.layoutBounds.width && c.left <= this.layoutBounds.height
        }, getScreenOrientation: function (a) {
            var b = window.screen, c = b.orientation || b.mozOrientation || b.msOrientation;
            if (c && "string" == typeof c.type)return c.type;
            if ("string" == typeof c)return c;
            var d = "portrait-primary", e = "landscape-primary";
            if ("screen" === a)return b.height > b.width ? d : e;
            if ("viewport" === a)return this.visualBounds.height > this.visualBounds.width ? d : e;
            if ("window.orientation" === a && "number" == typeof window.orientation)return 0 === window.orientation || 180 === window.orientation ? d : e;
            if (window.matchMedia) {
                if (window.matchMedia("(orientation: portrait)").matches)return d;
                if (window.matchMedia("(orientation: landscape)").matches)return e
            }
            return this.visualBounds.height > this.visualBounds.width ? d : e
        }, visualBounds: new c.Rectangle, layoutBounds: new c.Rectangle, documentBounds: new c.Rectangle
    },c.Device.whenReady(function (a) {
        var b = window && "pageXOffset" in window ? function () {
            return window.pageXOffset
        } : function () {
            return document.documentElement.scrollLeft
        }, d = window && "pageYOffset" in window ? function () {
            return window.pageYOffset
        } : function () {
            return document.documentElement.scrollTop
        };
        Object.defineProperty(c.DOM, "scrollX", {get: b}), Object.defineProperty(c.DOM, "scrollY", {get: d}), Object.defineProperty(c.DOM.visualBounds, "x", {get: b}), Object.defineProperty(c.DOM.visualBounds, "y", {get: d}), Object.defineProperty(c.DOM.layoutBounds, "x", {value: 0}), Object.defineProperty(c.DOM.layoutBounds, "y", {value: 0});
        var e = a.desktop && document.documentElement.clientWidth <= window.innerWidth && document.documentElement.clientHeight <= window.innerHeight;
        if (e) {
            var f = function () {
                return Math.max(window.innerWidth, document.documentElement.clientWidth)
            }, g = function () {
                return Math.max(window.innerHeight, document.documentElement.clientHeight)
            };
            Object.defineProperty(c.DOM.visualBounds, "width", {get: f}), Object.defineProperty(c.DOM.visualBounds, "height", {get: g}), Object.defineProperty(c.DOM.layoutBounds, "width", {get: f}), Object.defineProperty(c.DOM.layoutBounds, "height", {get: g})
        } else Object.defineProperty(c.DOM.visualBounds, "width", {
            get: function () {
                return window.innerWidth
            }
        }), Object.defineProperty(c.DOM.visualBounds, "height", {
            get: function () {
                return window.innerHeight
            }
        }), Object.defineProperty(c.DOM.layoutBounds, "width", {
            get: function () {
                var a = document.documentElement.clientWidth, b = window.innerWidth;
                return b > a ? b : a
            }
        }), Object.defineProperty(c.DOM.layoutBounds, "height", {
            get: function () {
                var a = document.documentElement.clientHeight, b = window.innerHeight;
                return b > a ? b : a
            }
        });
        Object.defineProperty(c.DOM.documentBounds, "x", {value: 0}), Object.defineProperty(c.DOM.documentBounds, "y", {value: 0}), Object.defineProperty(c.DOM.documentBounds, "width", {
            get: function () {
                var a = document.documentElement;
                return Math.max(a.clientWidth, a.offsetWidth, a.scrollWidth)
            }
        }), Object.defineProperty(c.DOM.documentBounds, "height", {
            get: function () {
                var a = document.documentElement;
                return Math.max(a.clientHeight, a.offsetHeight, a.scrollHeight)
            }
        })
    }, null, !0),c.ArraySet = function (a) {
        this.position = 0, this.list = a || []
    },c.ArraySet.prototype = {
        add: function (a) {
            return this.exists(a) || this.list.push(a), a
        }, getIndex: function (a) {
            return this.list.indexOf(a)
        }, getByKey: function (a, b) {
            for (var c = this.list.length; c--;)if (this.list[c][a] === b)return this.list[c];
            return null
        }, exists: function (a) {
            return this.list.indexOf(a) > -1
        }, reset: function () {
            this.list.length = 0
        }, remove: function (a) {
            var b = this.list.indexOf(a);
            return b > -1 ? (this.list.splice(b, 1), a) : void 0
        }, setAll: function (a, b) {
            for (var c = this.list.length; c--;)this.list[c] && (this.list[c][a] = b)
        }, callAll: function (a) {
            for (var b = Array.prototype.slice.call(arguments, 1), c = this.list.length; c--;)this.list[c] && this.list[c][a] && this.list[c][a].apply(this.list[c], b)
        }, removeAll: function (a) {
            void 0 === a && (a = !1);
            for (var b = this.list.length; b--;)if (this.list[b]) {
                var c = this.remove(this.list[b]);
                a && c.destroy()
            }
            this.position = 0, this.list = []
        }
    },Object.defineProperty(c.ArraySet.prototype, "total", {
        get: function () {
            return this.list.length
        }
    }),Object.defineProperty(c.ArraySet.prototype, "first", {
        get: function () {
            return this.position = 0, this.list.length > 0 ? this.list[0] : null
        }
    }),Object.defineProperty(c.ArraySet.prototype, "next", {
        get: function () {
            return this.position < this.list.length ? (this.position++, this.list[this.position]) : null
        }
    }),c.ArraySet.prototype.constructor = c.ArraySet,c.ArrayUtils = {
        getRandomItem: function (a, b, c) {
            if (null === a)return null;
            void 0 === b && (b = 0), void 0 === c && (c = a.length);
            var d = b + Math.floor(Math.random() * c);
            return void 0 === a[d] ? null : a[d]
        }, removeRandomItem: function (a, b, c) {
            if (null == a)return null;
            void 0 === b && (b = 0), void 0 === c && (c = a.length);
            var d = b + Math.floor(Math.random() * c);
            if (d < a.length) {
                var e = a.splice(d, 1);
                return void 0 === e[0] ? null : e[0]
            }
            return null
        }, shuffle: function (a) {
            for (var b = a.length - 1; b > 0; b--) {
                var c = Math.floor(Math.random() * (b + 1)), d = a[b];
                a[b] = a[c], a[c] = d
            }
            return a
        }, transposeMatrix: function (a) {
            for (var b = a.length, c = a[0].length, d = new Array(c), e = 0; c > e; e++) {
                d[e] = new Array(b);
                for (var f = b - 1; f > -1; f--)d[e][f] = a[f][e]
            }
            return d
        }, rotateMatrix: function (a, b) {
            if ("string" != typeof b && (b = (b % 360 + 360) % 360), 90 === b || -270 === b || "rotateLeft" === b)a = c.ArrayUtils.transposeMatrix(a), a = a.reverse(); else if (-90 === b || 270 === b || "rotateRight" === b)a = a.reverse(), a = c.ArrayUtils.transposeMatrix(a); else if (180 === Math.abs(b) || "rotate180" === b) {
                for (var d = 0; d < a.length; d++)a[d].reverse();
                a = a.reverse()
            }
            return a
        }, findClosest: function (a, b) {
            if (!b.length)return NaN;
            if (1 === b.length || a < b[0])return b[0];
            for (var c = 1; b[c] < a;)c++;
            var d = b[c - 1], e = c < b.length ? b[c] : Number.POSITIVE_INFINITY;
            return a - d >= e - a ? e : d
        }, rotateRight: function (a) {
            var b = a.pop();
            return a.unshift(b), b
        }, rotateLeft: function (a) {
            var b = a.shift();
            return a.push(b), b
        }, rotate: function (a) {
            var b = a.shift();
            return a.push(b), b
        }, numberArray: function (a, b) {
            for (var c = [], d = a; b >= d; d++)c.push(d);
            return c
        }, numberArrayStep: function (a, b, d) {
            (void 0 === a || null === a) && (a = 0), (void 0 === b || null === b) && (b = a, a = 0), void 0 === d && (d = 1);
            for (var e = [], f = Math.max(c.Math.roundAwayFromZero((b - a) / (d || 1)), 0), g = 0; f > g; g++)e.push(a), a += d;
            return e
        }
    },c.LinkedList = function () {
        this.next = null, this.prev = null, this.first = null, this.last = null, this.total = 0
    },c.LinkedList.prototype = {
        add: function (a) {
            return 0 === this.total && null === this.first && null === this.last ? (this.first = a, this.last = a, this.next = a, a.prev = this, this.total++, a) : (this.last.next = a, a.prev = this.last, this.last = a, this.total++, a)
        }, reset: function () {
            this.first = null, this.last = null, this.next = null, this.prev = null, this.total = 0
        }, remove: function (a) {
            return 1 === this.total ? (this.reset(), void(a.next = a.prev = null)) : (a === this.first ? this.first = this.first.next : a === this.last && (this.last = this.last.prev), a.prev && (a.prev.next = a.next), a.next && (a.next.prev = a.prev), a.next = a.prev = null, null === this.first && (this.last = null), void this.total--)
        }, callAll: function (a) {
            if (this.first && this.last) {
                var b = this.first;
                do b && b[a] && b[a].call(b), b = b.next; while (b != this.last.next)
            }
        }
    },c.LinkedList.prototype.constructor = c.LinkedList,c.Create = function (a) {
        this.game = a, this.bmd = null, this.canvas = null, this.ctx = null, this.palettes = [{
            0: "#000",
            1: "#9D9D9D",
            2: "#FFF",
            3: "#BE2633",
            4: "#E06F8B",
            5: "#493C2B",
            6: "#A46422",
            7: "#EB8931",
            8: "#F7E26B",
            9: "#2F484E",
            A: "#44891A",
            B: "#A3CE27",
            C: "#1B2632",
            D: "#005784",
            E: "#31A2F2",
            F: "#B2DCEF"
        }, {
            0: "#000",
            1: "#191028",
            2: "#46af45",
            3: "#a1d685",
            4: "#453e78",
            5: "#7664fe",
            6: "#833129",
            7: "#9ec2e8",
            8: "#dc534b",
            9: "#e18d79",
            A: "#d6b97b",
            B: "#e9d8a1",
            C: "#216c4b",
            D: "#d365c8",
            E: "#afaab9",
            F: "#f5f4eb"
        }, {
            0: "#000",
            1: "#2234d1",
            2: "#0c7e45",
            3: "#44aacc",
            4: "#8a3622",
            5: "#5c2e78",
            6: "#aa5c3d",
            7: "#b5b5b5",
            8: "#5e606e",
            9: "#4c81fb",
            A: "#6cd947",
            B: "#7be2f9",
            C: "#eb8a60",
            D: "#e23d69",
            E: "#ffd93f",
            F: "#fff"
        }, {
            0: "#000",
            1: "#fff",
            2: "#8b4131",
            3: "#7bbdc5",
            4: "#8b41ac",
            5: "#6aac41",
            6: "#3931a4",
            7: "#d5de73",
            8: "#945a20",
            9: "#5a4100",
            A: "#bd736a",
            B: "#525252",
            C: "#838383",
            D: "#acee8b",
            E: "#7b73de",
            F: "#acacac"
        }, {
            0: "#000",
            1: "#191028",
            2: "#46af45",
            3: "#a1d685",
            4: "#453e78",
            5: "#7664fe",
            6: "#833129",
            7: "#9ec2e8",
            8: "#dc534b",
            9: "#e18d79",
            A: "#d6b97b",
            B: "#e9d8a1",
            C: "#216c4b",
            D: "#d365c8",
            E: "#afaab9",
            F: "#fff"
        }]
    },c.Create.PALETTE_ARNE = 0,c.Create.PALETTE_JMP = 1,c.Create.PALETTE_CGA = 2,c.Create.PALETTE_C64 = 3,c.Create.PALETTE_JAPANESE_MACHINE = 4,c.Create.prototype = {
        texture: function (a, b, c, d, e) {
            void 0 === c && (c = 8), void 0 === d && (d = c), void 0 === e && (e = 0);
            var f = b[0].length * c, g = b.length * d;
            null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(f, g), this.bmd.clear();
            for (var h = 0; h < b.length; h++)for (var i = b[h], j = 0; j < i.length; j++) {
                var k = i[j];
                "." !== k && " " !== k && (this.ctx.fillStyle = this.palettes[e][k], this.ctx.fillRect(j * c, h * d, c, d))
            }
            return this.bmd.generateTexture(a)
        }, grid: function (a, b, c, d, e, f) {
            null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(b, c), this.ctx.fillStyle = f;
            for (var g = 0; c > g; g += e)this.ctx.fillRect(0, g, b, 1);
            for (var h = 0; b > h; h += d)this.ctx.fillRect(h, 0, 1, c);
            return this.bmd.generateTexture(a)
        }
    },c.Create.prototype.constructor = c.Create,c.FlexGrid = function (a, b, d) {
        this.game = a.game, this.manager = a, this.width = b, this.height = d, this.boundsCustom = new c.Rectangle(0, 0, b, d), this.boundsFluid = new c.Rectangle(0, 0, b, d), this.boundsFull = new c.Rectangle(0, 0, b, d), this.boundsNone = new c.Rectangle(0, 0, b, d), this.positionCustom = new c.Point(0, 0), this.positionFluid = new c.Point(0, 0), this.positionFull = new c.Point(0, 0), this.positionNone = new c.Point(0, 0), this.scaleCustom = new c.Point(1, 1), this.scaleFluid = new c.Point(1, 1), this.scaleFluidInversed = new c.Point(1, 1), this.scaleFull = new c.Point(1, 1), this.scaleNone = new c.Point(1, 1), this.customWidth = 0, this.customHeight = 0, this.customOffsetX = 0, this.customOffsetY = 0, this.ratioH = b / d, this.ratioV = d / b, this.multiplier = 0, this.layers = []
    },c.FlexGrid.prototype = {
        setSize: function (a, b) {
            this.width = a, this.height = b, this.ratioH = a / b, this.ratioV = b / a, this.scaleNone = new c.Point(1, 1), this.boundsNone.width = this.width, this.boundsNone.height = this.height, this.refresh()
        }, createCustomLayer: function (a, b, d, e) {
            void 0 === e && (e = !0), this.customWidth = a, this.customHeight = b, this.boundsCustom.width = a, this.boundsCustom.height = b;
            var f = new c.FlexLayer(this, this.positionCustom, this.boundsCustom, this.scaleCustom);
            return e && this.game.world.add(f), this.layers.push(f), "undefined" != typeof d && null !== typeof d && f.addMultiple(d), f
        }, createFluidLayer: function (a, b) {
            void 0 === b && (b = !0);
            var d = new c.FlexLayer(this, this.positionFluid, this.boundsFluid, this.scaleFluid);
            return b && this.game.world.add(d), this.layers.push(d), "undefined" != typeof a && null !== typeof a && d.addMultiple(a), d
        }, createFullLayer: function (a) {
            var b = new c.FlexLayer(this, this.positionFull, this.boundsFull, this.scaleFluid);
            return this.game.world.add(b), this.layers.push(b), "undefined" != typeof a && b.addMultiple(a), b
        }, createFixedLayer: function (a) {
            var b = new c.FlexLayer(this, this.positionNone, this.boundsNone, this.scaleNone);
            return this.game.world.add(b), this.layers.push(b), "undefined" != typeof a && b.addMultiple(a), b
        }, reset: function () {
            for (var a = this.layers.length; a--;)this.layers[a].persist || (this.layers[a].position = null, this.layers[a].scale = null, this.layers.slice(a, 1))
        }, onResize: function (a, b) {
            this.ratioH = a / b, this.ratioV = b / a, this.refresh(a, b)
        }, refresh: function () {
            this.multiplier = Math.min(this.manager.height / this.height, this.manager.width / this.width), this.boundsFluid.width = Math.round(this.width * this.multiplier), this.boundsFluid.height = Math.round(this.height * this.multiplier), this.scaleFluid.set(this.boundsFluid.width / this.width, this.boundsFluid.height / this.height), this.scaleFluidInversed.set(this.width / this.boundsFluid.width, this.height / this.boundsFluid.height), this.scaleFull.set(this.boundsFull.width / this.width, this.boundsFull.height / this.height), this.boundsFull.width = Math.round(this.manager.width * this.scaleFluidInversed.x), this.boundsFull.height = Math.round(this.manager.height * this.scaleFluidInversed.y), this.boundsFluid.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), this.boundsNone.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), this.positionFluid.set(this.boundsFluid.x, this.boundsFluid.y), this.positionNone.set(this.boundsNone.x, this.boundsNone.y)
        }, fitSprite: function (a) {
            this.manager.scaleSprite(a), a.x = this.manager.bounds.centerX, a.y = this.manager.bounds.centerY
        }, debug: function () {
            this.game.debug.text(this.boundsFluid.width + " x " + this.boundsFluid.height, this.boundsFluid.x + 4, this.boundsFluid.y + 16), this.game.debug.geom(this.boundsFluid, "rgba(255,0,0,0.9", !1)
        }
    },c.FlexGrid.prototype.constructor = c.FlexGrid,c.FlexLayer = function (a, b, d, e) {
        c.Group.call(this, a.game, null, "__flexLayer" + a.game.rnd.uuid(), !1), this.manager = a.manager, this.grid = a, this.persist = !1, this.position = b, this.bounds = d, this.scale = e, this.topLeft = d.topLeft, this.topMiddle = new c.Point(d.halfWidth, 0), this.topRight = d.topRight, this.bottomLeft = d.bottomLeft, this.bottomMiddle = new c.Point(d.halfWidth, d.bottom), this.bottomRight = d.bottomRight
    },c.FlexLayer.prototype = Object.create(c.Group.prototype),c.FlexLayer.prototype.constructor = c.FlexLayer,c.FlexLayer.prototype.resize = function () {
    },c.FlexLayer.prototype.debug = function () {
        this.game.debug.text(this.bounds.width + " x " + this.bounds.height, this.bounds.x + 4, this.bounds.y + 16), this.game.debug.geom(this.bounds, "rgba(0,0,255,0.9", !1), this.game.debug.geom(this.topLeft, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topMiddle, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topRight, "rgba(255,255,255,0.9")
    },c.Color = {
        packPixel: function (a, b, d, e) {
            return c.Device.LITTLE_ENDIAN ? (e << 24 | d << 16 | b << 8 | a) >>> 0 : (a << 24 | b << 16 | d << 8 | e) >>> 0
        }, unpackPixel: function (a, b, d, e) {
            return (void 0 === b || null === b) && (b = c.Color.createColor()), (void 0 === d || null === d) && (d = !1), (void 0 === e || null === e) && (e = !1), c.Device.LITTLE_ENDIAN ? (b.a = (4278190080 & a) >>> 24, b.b = (16711680 & a) >>> 16, b.g = (65280 & a) >>> 8, b.r = 255 & a) : (b.r = (4278190080 & a) >>> 24, b.g = (16711680 & a) >>> 16, b.b = (65280 & a) >>> 8, b.a = 255 & a), b.color = a, b.rgba = "rgba(" + b.r + "," + b.g + "," + b.b + "," + b.a / 255 + ")", d && c.Color.RGBtoHSL(b.r, b.g, b.b, b), e && c.Color.RGBtoHSV(b.r, b.g, b.b, b), b
        }, fromRGBA: function (a, b) {
            return b || (b = c.Color.createColor()), b.r = (4278190080 & a) >>> 24, b.g = (16711680 & a) >>> 16, b.b = (65280 & a) >>> 8, b.a = 255 & a, b.rgba = "rgba(" + b.r + "," + b.g + "," + b.b + "," + b.a + ")", b
        }, toRGBA: function (a, b, c, d) {
            return a << 24 | b << 16 | c << 8 | d
        }, toABGR: function (a, b, c, d) {
            return (d << 24 | c << 16 | b << 8 | a) >>> 0
        }, RGBtoHSL: function (a, b, d, e) {
            e || (e = c.Color.createColor(a, b, d, 1)), a /= 255, b /= 255, d /= 255;
            var f = Math.min(a, b, d), g = Math.max(a, b, d);
            if (e.h = 0, e.s = 0, e.l = (g + f) / 2, g !== f) {
                var h = g - f;
                e.s = e.l > .5 ? h / (2 - g - f) : h / (g + f), g === a ? e.h = (b - d) / h + (d > b ? 6 : 0) : g === b ? e.h = (d - a) / h + 2 : g === d && (e.h = (a - b) / h + 4), e.h /= 6
            }
            return e
        }, HSLtoRGB: function (a, b, d, e) {
            if (e ? (e.r = d, e.g = d, e.b = d) : e = c.Color.createColor(d, d, d), 0 !== b) {
                var f = .5 > d ? d * (1 + b) : d + b - d * b, g = 2 * d - f;
                e.r = c.Color.hueToColor(g, f, a + 1 / 3), e.g = c.Color.hueToColor(g, f, a), e.b = c.Color.hueToColor(g, f, a - 1 / 3)
            }
            return e.r = Math.floor(255 * e.r | 0), e.g = Math.floor(255 * e.g | 0), e.b = Math.floor(255 * e.b | 0), c.Color.updateColor(e), e
        }, RGBtoHSV: function (a, b, d, e) {
            e || (e = c.Color.createColor(a, b, d, 255)), a /= 255, b /= 255, d /= 255;
            var f = Math.min(a, b, d), g = Math.max(a, b, d), h = g - f;
            return e.h = 0, e.s = 0 === g ? 0 : h / g, e.v = g, g !== f && (g === a ? e.h = (b - d) / h + (d > b ? 6 : 0) : g === b ? e.h = (d - a) / h + 2 : g === d && (e.h = (a - b) / h + 4), e.h /= 6), e
        }, HSVtoRGB: function (a, b, d, e) {
            void 0 === e && (e = c.Color.createColor(0, 0, 0, 1, a, b, 0, d));
            var f, g, h, i = Math.floor(6 * a), j = 6 * a - i, k = d * (1 - b), l = d * (1 - j * b), m = d * (1 - (1 - j) * b);
            switch (i % 6) {
                case 0:
                    f = d, g = m, h = k;
                    break;
                case 1:
                    f = l, g = d, h = k;
                    break;
                case 2:
                    f = k, g = d, h = m;
                    break;
                case 3:
                    f = k, g = l, h = d;
                    break;
                case 4:
                    f = m, g = k, h = d;
                    break;
                case 5:
                    f = d, g = k, h = l
            }
            return e.r = Math.floor(255 * f), e.g = Math.floor(255 * g), e.b = Math.floor(255 * h), c.Color.updateColor(e), e
        }, hueToColor: function (a, b, c) {
            return 0 > c && (c += 1), c > 1 && (c -= 1), 1 / 6 > c ? a + 6 * (b - a) * c : .5 > c ? b : 2 / 3 > c ? a + (b - a) * (2 / 3 - c) * 6 : a
        }, createColor: function (a, b, d, e, f, g, h, i) {
            var j = {
                r: a || 0,
                g: b || 0,
                b: d || 0,
                a: e || 1,
                h: f || 0,
                s: g || 0,
                l: h || 0,
                v: i || 0,
                color: 0,
                color32: 0,
                rgba: ""
            };
            return c.Color.updateColor(j)
        }, updateColor: function (a) {
            return a.rgba = "rgba(" + a.r.toString() + "," + a.g.toString() + "," + a.b.toString() + "," + a.a.toString() + ")", a.color = c.Color.getColor(a.r, a.g, a.b), a.color32 = c.Color.getColor32(255 * a.a, a.r, a.g, a.b), a
        }, getColor32: function (a, b, c, d) {
            return a << 24 | b << 16 | c << 8 | d
        }, getColor: function (a, b, c) {
            return a << 16 | b << 8 | c
        }, RGBtoString: function (a, b, d, e, f) {
            return void 0 === e && (e = 255), void 0 === f && (f = "#"), "#" === f ? "#" + ((1 << 24) + (a << 16) + (b << 8) + d).toString(16).slice(1) : "0x" + c.Color.componentToHex(e) + c.Color.componentToHex(a) + c.Color.componentToHex(b) + c.Color.componentToHex(d)
        }, hexToRGB: function (a) {
            var b = c.Color.hexToColor(a);
            return b ? c.Color.getColor32(b.a, b.r, b.g, b.b) : void 0
        }, hexToColor: function (a, b) {
            a = a.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i, function (a, b, c, d) {
                return b + b + c + c + d + d
            });
            var d = /^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);
            if (d) {
                var e = parseInt(d[1], 16), f = parseInt(d[2], 16), g = parseInt(d[3], 16);
                b ? (b.r = e, b.g = f, b.b = g) : b = c.Color.createColor(e, f, g)
            }
            return b
        }, webToColor: function (a, b) {
            b || (b = c.Color.createColor());
            var d = /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(a);
            return d && (b.r = parseInt(d[1], 10), b.g = parseInt(d[2], 10), b.b = parseInt(d[3], 10), b.a = void 0 !== d[4] ? parseFloat(d[4]) : 1, c.Color.updateColor(b)), b
        }, valueToColor: function (a, b) {
            if (b || (b = c.Color.createColor()), "string" == typeof a)return 0 === a.indexOf("rgb") ? c.Color.webToColor(a, b) : (b.a = 1, c.Color.hexToColor(a, b));
            if ("number" == typeof a) {
                var d = c.Color.getRGB(a);
                return b.r = d.r, b.g = d.g, b.b = d.b, b.a = d.a / 255, b
            }
            return b
        }, componentToHex: function (a) {
            var b = a.toString(16);
            return 1 == b.length ? "0" + b : b
        }, HSVColorWheel: function (a, b) {
            void 0 === a && (a = 1), void 0 === b && (b = 1);
            for (var d = [], e = 0; 359 >= e; e++)d.push(c.Color.HSVtoRGB(e / 359, a, b));
            return d
        }, HSLColorWheel: function (a, b) {
            void 0 === a && (a = .5), void 0 === b && (b = .5);
            for (var d = [], e = 0; 359 >= e; e++)d.push(c.Color.HSLtoRGB(e / 359, a, b));
            return d
        }, interpolateColor: function (a, b, d, e, f) {
            void 0 === f && (f = 255);
            var g = c.Color.getRGB(a), h = c.Color.getRGB(b), i = (h.red - g.red) * e / d + g.red, j = (h.green - g.green) * e / d + g.green, k = (h.blue - g.blue) * e / d + g.blue;
            return c.Color.getColor32(f, i, j, k)
        }, interpolateColorWithRGB: function (a, b, d, e, f, g) {
            var h = c.Color.getRGB(a), i = (b - h.red) * g / f + h.red, j = (d - h.green) * g / f + h.green, k = (e - h.blue) * g / f + h.blue;
            return c.Color.getColor(i, j, k)
        }, interpolateRGB: function (a, b, d, e, f, g, h, i) {
            var j = (e - a) * i / h + a, k = (f - b) * i / h + b, l = (g - d) * i / h + d;
            return c.Color.getColor(j, k, l)
        }, getRandomColor: function (a, b, d) {
            if (void 0 === a && (a = 0), void 0 === b && (b = 255), void 0 === d && (d = 255), b > 255 || a > b)return c.Color.getColor(255, 255, 255);
            var e = a + Math.round(Math.random() * (b - a)), f = a + Math.round(Math.random() * (b - a)), g = a + Math.round(Math.random() * (b - a));
            return c.Color.getColor32(d, e, f, g)
        }, getRGB: function (a) {
            return a > 16777215 ? {
                alpha: a >>> 24,
                red: a >> 16 & 255,
                green: a >> 8 & 255,
                blue: 255 & a,
                a: a >>> 24,
                r: a >> 16 & 255,
                g: a >> 8 & 255,
                b: 255 & a
            } : {
                alpha: 255,
                red: a >> 16 & 255,
                green: a >> 8 & 255,
                blue: 255 & a,
                a: 255,
                r: a >> 16 & 255,
                g: a >> 8 & 255,
                b: 255 & a
            }
        }, getWebRGB: function (a) {
            if ("object" == typeof a)return "rgba(" + a.r.toString() + "," + a.g.toString() + "," + a.b.toString() + "," + (a.a / 255).toString() + ")";
            var b = c.Color.getRGB(a);
            return "rgba(" + b.r.toString() + "," + b.g.toString() + "," + b.b.toString() + "," + (b.a / 255).toString() + ")"
        }, getAlpha: function (a) {
            return a >>> 24
        }, getAlphaFloat: function (a) {
            return (a >>> 24) / 255
        }, getRed: function (a) {
            return a >> 16 & 255
        }, getGreen: function (a) {
            return a >> 8 & 255
        }, getBlue: function (a) {
            return 255 & a
        }, blendNormal: function (a) {
            return a
        }, blendLighten: function (a, b) {
            return b > a ? b : a
        }, blendDarken: function (a, b) {
            return b > a ? a : b
        }, blendMultiply: function (a, b) {
            return a * b / 255
        }, blendAverage: function (a, b) {
            return (a + b) / 2
        }, blendAdd: function (a, b) {
            return Math.min(255, a + b)
        }, blendSubtract: function (a, b) {
            return Math.max(0, a + b - 255)
        }, blendDifference: function (a, b) {
            return Math.abs(a - b)
        }, blendNegation: function (a, b) {
            return 255 - Math.abs(255 - a - b)
        }, blendScreen: function (a, b) {
            return 255 - ((255 - a) * (255 - b) >> 8)
        }, blendExclusion: function (a, b) {
            return a + b - 2 * a * b / 255
        }, blendOverlay: function (a, b) {
            return 128 > b ? 2 * a * b / 255 : 255 - 2 * (255 - a) * (255 - b) / 255
        }, blendSoftLight: function (a, b) {
            return 128 > b ? 2 * ((a >> 1) + 64) * (b / 255) : 255 - 2 * (255 - ((a >> 1) + 64)) * (255 - b) / 255
        }, blendHardLight: function (a, b) {
            return c.Color.blendOverlay(b, a)
        }, blendColorDodge: function (a, b) {
            return 255 === b ? b : Math.min(255, (a << 8) / (255 - b))
        }, blendColorBurn: function (a, b) {
            return 0 === b ? b : Math.max(0, 255 - (255 - a << 8) / b)
        }, blendLinearDodge: function (a, b) {
            return c.Color.blendAdd(a, b)
        }, blendLinearBurn: function (a, b) {
            return c.Color.blendSubtract(a, b)
        }, blendLinearLight: function (a, b) {
            return 128 > b ? c.Color.blendLinearBurn(a, 2 * b) : c.Color.blendLinearDodge(a, 2 * (b - 128))
        }, blendVividLight: function (a, b) {
            return 128 > b ? c.Color.blendColorBurn(a, 2 * b) : c.Color.blendColorDodge(a, 2 * (b - 128))
        }, blendPinLight: function (a, b) {
            return 128 > b ? c.Color.blendDarken(a, 2 * b) : c.Color.blendLighten(a, 2 * (b - 128))
        }, blendHardMix: function (a, b) {
            return c.Color.blendVividLight(a, b) < 128 ? 0 : 255
        }, blendReflect: function (a, b) {
            return 255 === b ? b : Math.min(255, a * a / (255 - b))
        }, blendGlow: function (a, b) {
            return c.Color.blendReflect(b, a)
        }, blendPhoenix: function (a, b) {
            return Math.min(a, b) - Math.max(a, b) + 255
        }
    },c.Physics = function (a, b) {
        b = b || {}, this.game = a, this.config = b, this.arcade = null, this.p2 = null, this.ninja = null, this.box2d = null, this.chipmunk = null, this.matter = null, this.parseConfig()
    },c.Physics.ARCADE = 0,c.Physics.P2JS = 1,c.Physics.NINJA = 2,c.Physics.BOX2D = 3,c.Physics.CHIPMUNK = 4,c.Physics.MATTERJS = 5,c.Physics.prototype = {
        parseConfig: function () {
            this.config.hasOwnProperty("arcade") && this.config.arcade !== !0 || !c.Physics.hasOwnProperty("Arcade") || (this.arcade = new c.Physics.Arcade(this.game)), this.config.hasOwnProperty("ninja") && this.config.ninja === !0 && c.Physics.hasOwnProperty("Ninja") && (this.ninja = new c.Physics.Ninja(this.game)), this.config.hasOwnProperty("p2") && this.config.p2 === !0 && c.Physics.hasOwnProperty("P2") && (this.p2 = new c.Physics.P2(this.game, this.config)), this.config.hasOwnProperty("box2d") && this.config.box2d === !0 && c.Physics.hasOwnProperty("BOX2D") && (this.box2d = new c.Physics.BOX2D(this.game, this.config)), this.config.hasOwnProperty("matter") && this.config.matter === !0 && c.Physics.hasOwnProperty("Matter") && (this.matter = new c.Physics.Matter(this.game, this.config))
        }, startSystem: function (a) {
            a === c.Physics.ARCADE ? this.arcade = new c.Physics.Arcade(this.game) : a === c.Physics.P2JS ? null === this.p2 ? this.p2 = new c.Physics.P2(this.game, this.config) : this.p2.reset() : a === c.Physics.NINJA ? this.ninja = new c.Physics.Ninja(this.game) : a === c.Physics.BOX2D ? null === this.box2d ? this.box2d = new c.Physics.Box2D(this.game, this.config) : this.box2d.reset() : a === c.Physics.MATTERJS && (null === this.matter ? this.matter = new c.Physics.Matter(this.game, this.config) : this.matter.reset())
        }, enable: function (a, b, d) {
            void 0 === b && (b = c.Physics.ARCADE), void 0 === d && (d = !1), b === c.Physics.ARCADE ? this.arcade.enable(a) : b === c.Physics.P2JS && this.p2 ? this.p2.enable(a, d) : b === c.Physics.NINJA && this.ninja ? this.ninja.enableAABB(a) : b === c.Physics.BOX2D && this.box2d ? this.box2d.enable(a) : b === c.Physics.MATTERJS && this.matter ? this.matter.enable(a) : console.warn(a.key + " is attempting to enable a physics body using an unknown physics system.")
        }, preUpdate: function () {
            this.p2 && this.p2.preUpdate(), this.box2d && this.box2d.preUpdate(), this.matter && this.matter.preUpdate()
        }, update: function () {
            this.p2 && this.p2.update(), this.box2d && this.box2d.update(), this.matter && this.matter.update()
        }, setBoundsToWorld: function () {
            this.arcade && this.arcade.setBoundsToWorld(), this.ninja && this.ninja.setBoundsToWorld(), this.p2 && this.p2.setBoundsToWorld(), this.box2d && this.box2d.setBoundsToWorld(), this.matter && this.matter.setBoundsToWorld()
        }, clear: function () {
            this.p2 && this.p2.clear(), this.box2d && this.box2d.clear(), this.matter && this.matter.clear()
        }, reset: function () {
            this.p2 && this.p2.reset(), this.box2d && this.box2d.reset(), this.matter && this.matter.reset()
        }, destroy: function () {
            this.p2 && this.p2.destroy(), this.box2d && this.box2d.destroy(), this.matter && this.matter.destroy(), this.arcade = null, this.ninja = null, this.p2 = null, this.box2d = null, this.matter = null
        }
    },c.Physics.prototype.constructor = c.Physics,c.ImageCollection = function (a, b, c, d, e, f, g) {
        (void 0 === c || 0 >= c) && (c = 32), (void 0 === d || 0 >= d) && (d = 32), void 0 === e && (e = 0), void 0 === f && (f = 0), this.name = a, this.firstgid = 0 | b, this.imageWidth = 0 | c, this.imageHeight = 0 | d, this.imageMargin = 0 | e, this.imageSpacing = 0 | f, this.properties = g || {}, this.images = [], this.total = 0
    },c.ImageCollection.prototype = {
        containsImageIndex: function (a) {
            return a >= this.firstgid && a < this.firstgid + this.total
        }, addImage: function (a, b) {
            this.images.push({gid: a, image: b}), this.total++
        }
    },c.ImageCollection.prototype.constructor = c.ImageCollection,c.Tile = function (a, b, c, d, e, f) {
        this.layer = a, this.index = b, this.x = c, this.y = d, this.rotation = 0, this.flipped = !1, this.worldX = c * e, this.worldY = d * f, this.width = e, this.height = f, this.centerX = Math.abs(e / 2), this.centerY = Math.abs(f / 2), this.alpha = 1, this.properties = {}, this.scanned = !1, this.faceTop = !1, this.faceBottom = !1, this.faceLeft = !1, this.faceRight = !1, this.collideLeft = !1, this.collideRight = !1, this.collideUp = !1, this.collideDown = !1, this.collisionCallback = null, this.collisionCallbackContext = this
    },c.Tile.prototype = {
        containsPoint: function (a, b) {
            return !(a < this.worldX || b < this.worldY || a > this.right || b > this.bottom)
        }, intersects: function (a, b, c, d) {
            return c <= this.worldX ? !1 : d <= this.worldY ? !1 : a >= this.worldX + this.width ? !1 : b >= this.worldY + this.height ? !1 : !0
        }, setCollisionCallback: function (a, b) {
            this.collisionCallback = a, this.collisionCallbackContext = b
        }, destroy: function () {
            this.collisionCallback = null, this.collisionCallbackContext = null, this.properties = null
        }, setCollision: function (a, b, c, d) {
            this.collideLeft = a, this.collideRight = b, this.collideUp = c, this.collideDown = d, this.faceLeft = a, this.faceRight = b, this.faceTop = c, this.faceBottom = d
        }, resetCollision: function () {
            this.collideLeft = !1, this.collideRight = !1, this.collideUp = !1, this.collideDown = !1, this.faceTop = !1, this.faceBottom = !1, this.faceLeft = !1, this.faceRight = !1
        }, isInteresting: function (a, b) {
            return a && b ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.faceTop || this.faceBottom || this.faceLeft || this.faceRight || this.collisionCallback : a ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown : b ? this.faceTop || this.faceBottom || this.faceLeft || this.faceRight : !1
        }, copy: function (a) {
            this.index = a.index, this.alpha = a.alpha, this.properties = a.properties, this.collideUp = a.collideUp, this.collideDown = a.collideDown, this.collideLeft = a.collideLeft, this.collideRight = a.collideRight, this.collisionCallback = a.collisionCallback, this.collisionCallbackContext = a.collisionCallbackContext
        }
    },c.Tile.prototype.constructor = c.Tile,Object.defineProperty(c.Tile.prototype, "collides", {
        get: function () {
            return this.collideLeft || this.collideRight || this.collideUp || this.collideDown
        }
    }),Object.defineProperty(c.Tile.prototype, "canCollide", {
        get: function () {
            return this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.collisionCallback
        }
    }),Object.defineProperty(c.Tile.prototype, "left", {
        get: function () {
            return this.worldX
        }
    }),Object.defineProperty(c.Tile.prototype, "right", {
        get: function () {
            return this.worldX + this.width
        }
    }),Object.defineProperty(c.Tile.prototype, "top", {
        get: function () {
            return this.worldY
        }
    }),Object.defineProperty(c.Tile.prototype, "bottom", {
        get: function () {
            return this.worldY + this.height
        }
    }),c.Tilemap = function (a, b, d, e, f, g) {
        this.game = a, this.key = b;
        var h = c.TilemapParser.parse(this.game, b, d, e, f, g);
        null !== h && (this.width = h.width, this.height = h.height, this.tileWidth = h.tileWidth, this.tileHeight = h.tileHeight, this.orientation = h.orientation, this.format = h.format, this.version = h.version, this.properties = h.properties, this.widthInPixels = h.widthInPixels, this.heightInPixels = h.heightInPixels, this.layers = h.layers, this.tilesets = h.tilesets, this.imagecollections = h.imagecollections, this.tiles = h.tiles, this.objects = h.objects, this.collideIndexes = [], this.collision = h.collision, this.images = h.images, this.currentLayer = 0, this.debugMap = [], this._results = [], this._tempA = 0, this._tempB = 0)
    },c.Tilemap.CSV = 0,c.Tilemap.TILED_JSON = 1,c.Tilemap.NORTH = 0,c.Tilemap.EAST = 1,c.Tilemap.SOUTH = 2,c.Tilemap.WEST = 3,c.Tilemap.prototype = {
        create: function (a, b, c, d, e, f) {
            return void 0 === f && (f = this.game.world), this.width = b, this.height = c, this.setTileSize(d, e), this.layers.length = 0, this.createBlankLayer(a, b, c, d, e, f)
        }, setTileSize: function (a, b) {
            this.tileWidth = a, this.tileHeight = b, this.widthInPixels = this.width * a, this.heightInPixels = this.height * b
        }, addTilesetImage: function (a, b, d, e, f, g, h) {
            if (void 0 === a)return null;
            void 0 === d && (d = this.tileWidth), void 0 === e && (e = this.tileHeight), void 0 === f && (f = 0), void 0 === g && (g = 0), void 0 === h && (h = 0), 0 === d && (d = 32), 0 === e && (e = 32);
            var i = null;
            if ((void 0 === b || null === b) && (b = a), b instanceof c.BitmapData)i = b.canvas; else {
                if (!this.game.cache.checkImageKey(b))return console.warn('Phaser.Tilemap.addTilesetImage: Invalid image key given: "' + b + '"'), null;
                i = this.game.cache.getImage(b)
            }
            var j = this.getTilesetIndex(a);
            if (null === j && this.format === c.Tilemap.TILED_JSON)return console.warn('Phaser.Tilemap.addTilesetImage: No data found in the JSON matching the tileset name: "' + a + '"'), null;
            if (this.tilesets[j])return this.tilesets[j].setImage(i), this.tilesets[j];
            var k = new c.Tileset(a, h, d, e, f, g, {});
            k.setImage(i), this.tilesets.push(k);
            for (var l = this.tilesets.length - 1, m = f, n = f, o = 0, p = 0, q = 0, r = h; r < h + k.total && (this.tiles[r] = [m, n, l], m += d + g, o++, o !== k.total) && (p++, p !== k.columns || (m = f, n += e + g, p = 0, q++, q !== k.rows)); r++);
            return k
        }, createFromObjects: function (a, b, d, e, f, g, h, i, j) {
            if (void 0 === f && (f = !0), void 0 === g && (g = !1), void 0 === h && (h = this.game.world), void 0 === i && (i = c.Sprite), void 0 === j && (j = !0), !this.objects[a])return void console.warn("Tilemap.createFromObjects: Invalid objectgroup name given: " + a);
            for (var k = 0; k < this.objects[a].length; k++) {
                var l = !1, m = this.objects[a][k];
                if (void 0 !== m.gid && "number" == typeof b && m.gid === b ? l = !0 : void 0 !== m.id && "number" == typeof b && m.id === b ? l = !0 : void 0 !== m.name && "string" == typeof b && m.name === b && (l = !0), l) {
                    var n = new i(this.game, parseFloat(m.x, 10), parseFloat(m.y, 10), d, e);
                    n.name = m.name, n.visible = m.visible, n.autoCull = g, n.exists = f, m.width && (n.width = m.width), m.height && (n.height = m.height), m.rotation && (n.angle = m.rotation), j && (n.y -= n.height), h.add(n);
                    for (var o in m.properties)h.set(n, o, m.properties[o], !1, !1, 0, !0)
                }
            }
        }, createFromTiles: function (a, b, d, e, f, g) {
            "number" == typeof a && (a = [a]), void 0 === b || null === b ? b = [] : "number" == typeof b && (b = [b]), e = this.getLayer(e), void 0 === f && (f = this.game.world), void 0 === g && (g = {}), void 0 === g.customClass && (g.customClass = c.Sprite), void 0 === g.adjustY && (g.adjustY = !0);
            var h = this.layers[e].width, i = this.layers[e].height;
            if (this.copy(0, 0, h, i, e), this._results.length < 2)return 0;
            for (var j, k = 0, l = 1, m = this._results.length; m > l; l++)if (-1 !== a.indexOf(this._results[l].index)) {
                j = new g.customClass(this.game, this._results[l].worldX, this._results[l].worldY, d);
                for (var n in g)j[n] = g[n];
                f.add(j), k++
            }
            if (1 === b.length)for (l = 0; l < a.length; l++)this.replace(a[l], b[0], 0, 0, h, i, e); else if (b.length > 1)for (l = 0; l < a.length; l++)this.replace(a[l], b[l], 0, 0, h, i, e);
            return k
        }, createLayer: function (a, b, d, e, f) {
            void 0 === b && (b = this.game.width), void 0 === d && (d = this.game.height), void 0 === e && (e = this.game.world);
            var g = a;
            return "string" == typeof a && (g = this.getLayerIndex(a)), null === g || g > this.layers.length ? void console.warn("Tilemap.createLayer: Invalid layer ID given: " + g) : f ? e.add(new c.TilemapLayerGL(this.game, this, g, b, d)) : e.add(new c.TilemapLayer(this.game, this, g, b, d))
        }, createBlankLayer: function (a, b, d, e, f, g) {
            if (void 0 === g && (g = this.game.world), null !== this.getLayerIndex(a))return void console.warn("Tilemap.createBlankLayer: Layer with matching name already exists");
            for (var h, i = {
                name: a,
                x: 0,
                y: 0,
                width: b,
                height: d,
                widthInPixels: b * e,
                heightInPixels: d * f,
                alpha: 1,
                visible: !0,
                properties: {},
                indexes: [],
                callbacks: [],
                bodies: [],
                data: null
            }, j = [], k = 0; d > k; k++) {
                h = [];
                for (var l = 0; b > l; l++)h.push(new c.Tile(i, -1, l, k, e, f));
                j.push(h)
            }
            i.data = j, this.layers.push(i), this.currentLayer = this.layers.length - 1;
            var m = i.widthInPixels, n = i.heightInPixels;
            m > this.game.width && (m = this.game.width), n > this.game.height && (n = this.game.height);
            var j = new c.TilemapLayer(this.game, this, this.layers.length - 1, m, n);
            return j.name = a, g.add(j)
        }, getIndex: function (a, b) {
            for (var c = 0; c < a.length; c++)if (a[c].name === b)return c;
            return null
        }, getLayerIndex: function (a) {
            return this.getIndex(this.layers, a)
        }, getTilesetIndex: function (a) {
            return this.getIndex(this.tilesets, a)
        }, getImageIndex: function (a) {
            return this.getIndex(this.images, a)
        }, setTileIndexCallback: function (a, b, c, d) {
            if (d = this.getLayer(d), "number" == typeof a)this.layers[d].callbacks[a] = {
                callback: b,
                callbackContext: c
            }; else for (var e = 0, f = a.length; f > e; e++)this.layers[d].callbacks[a[e]] = {
                callback: b,
                callbackContext: c
            }
        }, setTileLocationCallback: function (a, b, c, d, e, f, g) {
            if (g = this.getLayer(g), this.copy(a, b, c, d, g), !(this._results.length < 2))for (var h = 1; h < this._results.length; h++)this._results[h].setCollisionCallback(e, f)
        }, setCollision: function (a, b, c, d) {
            if (void 0 === b && (b = !0), void 0 === d && (d = !0), c = this.getLayer(c), "number" == typeof a)return this.setCollisionByIndex(a, b, c, !0);
            if (Array.isArray(a)) {
                for (var e = 0; e < a.length; e++)this.setCollisionByIndex(a[e], b, c, !1);
                d && this.calculateFaces(c)
            }
        }, setCollisionBetween: function (a, b, c, d, e) {
            if (void 0 === c && (c = !0), void 0 === e && (e = !0), d = this.getLayer(d), !(a > b)) {
                for (var f = a; b >= f; f++)this.setCollisionByIndex(f, c, d, !1);
                e && this.calculateFaces(d)
            }
        }, setCollisionByExclusion: function (a, b, c, d) {
            void 0 === b && (b = !0), void 0 === d && (d = !0), c = this.getLayer(c);
            for (var e = 0, f = this.tiles.length; f > e; e++)-1 === a.indexOf(e) && this.setCollisionByIndex(e, b, c, !1);
            d && this.calculateFaces(c)
        }, setCollisionByIndex: function (a, b, c, d) {
            if (void 0 === b && (b = !0), void 0 === c && (c = this.currentLayer), void 0 === d && (d = !0), b)this.collideIndexes.push(a); else {
                var e = this.collideIndexes.indexOf(a);
                e > -1 && this.collideIndexes.splice(e, 1)
            }
            for (var f = 0; f < this.layers[c].height; f++)for (var g = 0; g < this.layers[c].width; g++) {
                var h = this.layers[c].data[f][g];
                h && h.index === a && (b ? h.setCollision(!0, !0, !0, !0) : h.resetCollision(), h.faceTop = b, h.faceBottom = b, h.faceLeft = b, h.faceRight = b)
            }
            return d && this.calculateFaces(c), c
        }, getLayer: function (a) {
            return void 0 === a ? a = this.currentLayer : "string" == typeof a ? a = this.getLayerIndex(a) : a instanceof c.TilemapLayer && (a = a.index), a
        }, setPreventRecalculate: function (a) {
            if (a === !0 && this.preventingRecalculate !== !0 && (this.preventingRecalculate = !0, this.needToRecalculate = {}), a === !1 && this.preventingRecalculate === !0) {
                this.preventingRecalculate = !1;
                for (var b in this.needToRecalculate)this.calculateFaces(b);
                this.needToRecalculate = !1
            }
        }, calculateFaces: function (a) {
            if (this.preventingRecalculate)return void(this.needToRecalculate[a] = !0);
            for (var b = null, c = null, d = null, e = null, f = 0, g = this.layers[a].height; g > f; f++)for (var h = 0, i = this.layers[a].width; i > h; h++) {
                var j = this.layers[a].data[f][h];
                j && (b = this.getTileAbove(a, h, f), c = this.getTileBelow(a, h, f), d = this.getTileLeft(a, h, f), e = this.getTileRight(a, h, f), j.collides && (j.faceTop = !0, j.faceBottom = !0, j.faceLeft = !0, j.faceRight = !0), b && b.collides && (j.faceTop = !1), c && c.collides && (j.faceBottom = !1), d && d.collides && (j.faceLeft = !1), e && e.collides && (j.faceRight = !1))
            }
        }, getTileAbove: function (a, b, c) {
            return c > 0 ? this.layers[a].data[c - 1][b] : null
        }, getTileBelow: function (a, b, c) {
            return c < this.layers[a].height - 1 ? this.layers[a].data[c + 1][b] : null
        }, getTileLeft: function (a, b, c) {
            return b > 0 ? this.layers[a].data[c][b - 1] : null
        }, getTileRight: function (a, b, c) {
            return b < this.layers[a].width - 1 ? this.layers[a].data[c][b + 1] : null
        }, setLayer: function (a) {
            a = this.getLayer(a), this.layers[a] && (this.currentLayer = a)
        }, hasTile: function (a, b, c) {
            return c = this.getLayer(c), void 0 === this.layers[c].data[b] || void 0 === this.layers[c].data[b][a] ? !1 : this.layers[c].data[b][a].index > -1
        }, removeTile: function (a, b, d) {
            if (d = this.getLayer(d), a >= 0 && a < this.layers[d].width && b >= 0 && b < this.layers[d].height && this.hasTile(a, b, d)) {
                var e = this.layers[d].data[b][a];
                return this.layers[d].data[b][a] = new c.Tile(this.layers[d], -1, a, b, this.tileWidth, this.tileHeight), this.layers[d].dirty = !0, this.calculateFaces(d), e
            }
        }, removeTileWorldXY: function (a, b, c, d, e) {
            return e = this.getLayer(e), a = this.game.math.snapToFloor(a, c) / c, b = this.game.math.snapToFloor(b, d) / d, this.removeTile(a, b, e)
        }, putTile: function (a, b, d, e) {
            if (null === a)return this.removeTile(b, d, e);
            if (e = this.getLayer(e), b >= 0 && b < this.layers[e].width && d >= 0 && d < this.layers[e].height) {
                var f;
                return a instanceof c.Tile ? (f = a.index, this.hasTile(b, d, e) ? this.layers[e].data[d][b].copy(a) : this.layers[e].data[d][b] = new c.Tile(e, f, b, d, a.width, a.height)) : (f = a, this.hasTile(b, d, e) ? this.layers[e].data[d][b].index = f : this.layers[e].data[d][b] = new c.Tile(this.layers[e], f, b, d, this.tileWidth, this.tileHeight)), this.collideIndexes.indexOf(f) > -1 ? this.layers[e].data[d][b].setCollision(!0, !0, !0, !0) : this.layers[e].data[d][b].resetCollision(), this.layers[e].dirty = !0, this.calculateFaces(e), this.layers[e].data[d][b]
            }
            return null
        }, putTileWorldXY: function (a, b, c, d, e, f) {
            return f = this.getLayer(f), b = this.game.math.snapToFloor(b, d) / d, c = this.game.math.snapToFloor(c, e) / e, this.putTile(a, b, c, f)
        }, searchTileIndex: function (a, b, c, d) {
            void 0 === b && (b = 0), void 0 === c && (c = !1), d = this.getLayer(d);
            var e = 0;
            if (c) {
                for (var f = this.layers[d].height - 1; f >= 0; f--)for (var g = this.layers[d].width - 1; g >= 0; g--)if (this.layers[d].data[f][g].index === a) {
                    if (e === b)return this.layers[d].data[f][g];
                    e++
                }
            } else for (var f = 0; f < this.layers[d].height; f++)for (var g = 0; g < this.layers[d].width; g++)if (this.layers[d].data[f][g].index === a) {
                if (e === b)return this.layers[d].data[f][g];
                e++
            }
            return null
        }, getTile: function (a, b, c, d) {
            return void 0 === d && (d = !1), c = this.getLayer(c), a >= 0 && a < this.layers[c].width && b >= 0 && b < this.layers[c].height ? -1 === this.layers[c].data[b][a].index ? d ? this.layers[c].data[b][a] : null : this.layers[c].data[b][a] : null
        }, getTileWorldXY: function (a, b, c, d, e, f) {
            return void 0 === c && (c = this.tileWidth), void 0 === d && (d = this.tileHeight), e = this.getLayer(e), a = this.game.math.snapToFloor(a, c) / c, b = this.game.math.snapToFloor(b, d) / d, this.getTile(a, b, e, f)
        }, copy: function (a, b, c, d, e) {
            if (e = this.getLayer(e), !this.layers[e])return void(this._results.length = 0);
            void 0 === a && (a = 0), void 0 === b && (b = 0), void 0 === c && (c = this.layers[e].width), void 0 === d && (d = this.layers[e].height), 0 > a && (a = 0), 0 > b && (b = 0), c > this.layers[e].width && (c = this.layers[e].width), d > this.layers[e].height && (d = this.layers[e].height), this._results.length = 0, this._results.push({
                x: a,
                y: b,
                width: c,
                height: d,
                layer: e
            });
            for (var f = b; b + d > f; f++)for (var g = a; a + c > g; g++)this._results.push(this.layers[e].data[f][g]);
            return this._results
        }, paste: function (a, b, c, d) {
            if (void 0 === a && (a = 0), void 0 === b && (b = 0), d = this.getLayer(d), c && !(c.length < 2)) {
                for (var e = a - c[1].x, f = b - c[1].y, g = 1; g < c.length; g++)this.layers[d].data[f + c[g].y][e + c[g].x].copy(c[g]);
                this.layers[d].dirty = !0, this.calculateFaces(d)
            }
        }, swap: function (a, b, c, d, e, f, g) {
            g = this.getLayer(g), this.copy(c, d, e, f, g), this._results.length < 2 || (this._tempA = a, this._tempB = b, this._results.forEach(this.swapHandler, this), this.paste(c, d, this._results, g))
        }, swapHandler: function (a) {
            a.index === this._tempA ? a.index = this._tempB : a.index === this._tempB && (a.index = this._tempA)
        }, forEach: function (a, b, c, d, e, f, g) {
            g = this.getLayer(g), this.copy(c, d, e, f, g), this._results.length < 2 || (this._results.forEach(a, b), this.paste(c, d, this._results, g))
        }, replace: function (a, b, c, d, e, f, g) {
            if (g = this.getLayer(g), this.copy(c, d, e, f, g), !(this._results.length < 2)) {
                for (var h = 1; h < this._results.length; h++)this._results[h].index === a && (this._results[h].index = b);
                this.paste(c, d, this._results, g)
            }
        }, random: function (a, b, c, d, e) {
            if (e = this.getLayer(e), this.copy(a, b, c, d, e), !(this._results.length < 2)) {
                for (var f = [], g = 1; g < this._results.length; g++)if (this._results[g].index) {
                    var h = this._results[g].index;
                    -1 === f.indexOf(h) && f.push(h)
                }
                for (var i = 1; i < this._results.length; i++)this._results[i].index = this.game.rnd.pick(f);
                this.paste(a, b, this._results, e)
            }
        }, shuffle: function (a, b, d, e, f) {
            if (f = this.getLayer(f), this.copy(a, b, d, e, f), !(this._results.length < 2)) {
                for (var g = [], h = 1; h < this._results.length; h++)this._results[h].index && g.push(this._results[h].index);
                c.ArrayUtils.shuffle(g);
                for (var i = 1; i < this._results.length; i++)this._results[i].index = g[i - 1];
                this.paste(a, b, this._results, f)
            }
        }, fill: function (a, b, c, d, e, f) {
            if (f = this.getLayer(f), this.copy(b, c, d, e, f), !(this._results.length < 2)) {
                for (var g = 1; g < this._results.length; g++)this._results[g].index = a;
                this.paste(b, c, this._results, f)
            }
        }, removeAllLayers: function () {
            this.layers.length = 0, this.currentLayer = 0
        }, dump: function () {
            for (var a = "", b = [""], c = 0; c < this.layers[this.currentLayer].height; c++) {
                for (var d = 0; d < this.layers[this.currentLayer].width; d++)a += "%c  ", this.layers[this.currentLayer].data[c][d] > 1 ? this.debugMap[this.layers[this.currentLayer].data[c][d]] ? b.push("background: " + this.debugMap[this.layers[this.currentLayer].data[c][d]]) : b.push("background: #ffffff") : b.push("background: rgb(0, 0, 0)");
                a += "\n"
            }
            b[0] = a, console.log.apply(console, b)
        }, destroy: function () {
            this.removeAllLayers(), this.data = [], this.game = null
        }
    },c.Tilemap.prototype.constructor = c.Tilemap,Object.defineProperty(c.Tilemap.prototype, "layer", {
        get: function () {
            return this.layers[this.currentLayer]
        }, set: function (a) {
            a !== this.currentLayer && this.setLayer(a)
        }
    }),c.TilemapLayer = function (a, b, d, e, f) {
        e |= 0, f |= 0, c.Sprite.call(this, a, 0, 0), this.map = b, this.index = d, this.layer = b.layers[d], this.canvas = PIXI.CanvasPool.create(this, e, f), this.context = this.canvas.getContext("2d"), this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas))), this.type = c.TILEMAPLAYER, this.physicsType = c.TILEMAPLAYER, this.renderSettings = {
            enableScrollDelta: !1,
            overdrawRatio: .2,
            copyCanvas: null
        }, this.debug = !1, this.exists = !0, this.debugSettings = {
            missingImageFill: "rgb(255,255,255)",
            debuggedTileOverfill: "rgba(0,255,0,0.4)",
            forceFullRedraw: !0,
            debugAlpha: .5,
            facingEdgeStroke: "rgba(0,255,0,1)",
            collidingTileOverfill: "rgba(0,255,0,0.2)"
        }, this.scrollFactorX = 1, this.scrollFactorY = 1, this.dirty = !0, this.rayStepRate = 4, this._wrap = !1, this._mc = {
            scrollX: 0,
            scrollY: 0,
            renderWidth: 0,
            renderHeight: 0,
            tileWidth: b.tileWidth,
            tileHeight: b.tileHeight,
            cw: b.tileWidth,
            ch: b.tileHeight,
            tilesets: []
        }, this._scrollX = 0, this._scrollY = 0, this._results = [], a.device.canvasBitBltShift || (this.renderSettings.copyCanvas = c.TilemapLayer.ensureSharedCopyCanvas()), this.fixedToCamera = !0
    },c.TilemapLayer.prototype = Object.create(c.Sprite.prototype),c.TilemapLayer.prototype.constructor = c.TilemapLayer,c.TilemapLayer.prototype.preUpdateCore = c.Component.Core.preUpdate,c.TilemapLayer.sharedCopyCanvas = null,c.TilemapLayer.ensureSharedCopyCanvas = function () {
        return this.sharedCopyCanvas || (this.sharedCopyCanvas = c.Canvas.create(2, 2)), this.sharedCopyCanvas
    },c.TilemapLayer.prototype.preUpdate = function () {
        return this.preUpdateCore()
    },c.TilemapLayer.prototype.postUpdate = function () {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x, this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y
    },c.TilemapLayer.prototype._renderCanvas = function (a) {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x, this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y, this.render(), PIXI.Sprite.prototype._renderCanvas.call(this, a)
    },c.TilemapLayer.prototype._renderWebGL = function (a) {
        this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x, this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y, this.render(), PIXI.Sprite.prototype._renderWebGL.call(this, a)
    },c.TilemapLayer.prototype.destroy = function () {
        PIXI.CanvasPool.remove(this), c.Component.Destroy.prototype.destroy.call(this)
    },c.TilemapLayer.prototype.resize = function (a, b) {
        this.canvas.width = a, this.canvas.height = b, this.texture.frame.resize(a, b), this.texture.width = a, this.texture.height = b, this.texture.crop.width = a, this.texture.crop.height = b, this.texture.baseTexture.width = a, this.texture.baseTexture.height = b, this.texture.baseTexture.dirty(), this.texture.requiresUpdate = !0, this.texture._updateUvs(), this.dirty = !0
    },c.TilemapLayer.prototype.resizeWorld = function () {
        this.game.world.setBounds(0, 0, this.layer.widthInPixels * this.scale.x, this.layer.heightInPixels * this.scale.y)
    },c.TilemapLayer.prototype._fixX = function (a) {
        return 1 === this.scrollFactorX || 0 === this.scrollFactorX && 0 === this.position.x ? a : 0 === this.scrollFactorX && 0 !== this.position.x ? a - this.position.x : this._scrollX + (a - this._scrollX / this.scrollFactorX)
    },c.TilemapLayer.prototype._unfixX = function (a) {
        return 1 === this.scrollFactorX ? a : this._scrollX / this.scrollFactorX + (a - this._scrollX)
    },c.TilemapLayer.prototype._fixY = function (a) {
        return 1 === this.scrollFactorY || 0 === this.scrollFactorY && 0 === this.position.y ? a : 0 === this.scrollFactorY && 0 !== this.position.y ? a - this.position.y : this._scrollY + (a - this._scrollY / this.scrollFactorY)
    },c.TilemapLayer.prototype._unfixY = function (a) {
        return 1 === this.scrollFactorY ? a : this._scrollY / this.scrollFactorY + (a - this._scrollY)
    },c.TilemapLayer.prototype.getTileX = function (a) {
        return Math.floor(this._fixX(a) / this._mc.tileWidth)
    },c.TilemapLayer.prototype.getTileY = function (a) {
        return Math.floor(this._fixY(a) / this._mc.tileHeight)
    },c.TilemapLayer.prototype.getTileXY = function (a, b, c) {
        return c.x = this.getTileX(a), c.y = this.getTileY(b), c
    },c.TilemapLayer.prototype.getRayCastTiles = function (a, b, c, d) {
        b || (b = this.rayStepRate), void 0 === c && (c = !1), void 0 === d && (d = !1);
        var e = this.getTiles(a.x, a.y, a.width, a.height, c, d);
        if (0 === e.length)return [];
        for (var f = a.coordinatesOnLine(b), g = [], h = 0; h < e.length; h++)for (var i = 0; i < f.length; i++) {
            var j = e[h], k = f[i];
            if (j.containsPoint(k[0], k[1])) {
                g.push(j);
                break
            }
        }
        return g
    },c.TilemapLayer.prototype.getTiles = function (a, b, c, d, e, f) {
        void 0 === e && (e = !1), void 0 === f && (f = !1);
        var g = !(e || f);
        a = this._fixX(a), b = this._fixY(b);
        for (var h = Math.floor(a / (this._mc.cw * this.scale.x)), i = Math.floor(b / (this._mc.ch * this.scale.y)), j = Math.ceil((a + c) / (this._mc.cw * this.scale.x)) - h, k = Math.ceil((b + d) / (this._mc.ch * this.scale.y)) - i; this._results.length;)this._results.pop();
        for (var l = i; i + k > l; l++)for (var m = h; h + j > m; m++) {
            var n = this.layer.data[l];
            n && n[m] && (g || n[m].isInteresting(e, f)) && this._results.push(n[m])
        }
        return this._results.slice()
    },c.TilemapLayer.prototype.resolveTileset = function (a) {
        var b = this._mc.tilesets;
        if (2e3 > a)for (; b.length < a;)b.push(void 0);
        var c = this.map.tiles[a] && this.map.tiles[a][2];
        if (null != c) {
            var d = this.map.tilesets[c];
            if (d && d.containsTileIndex(a))return b[a] = d
        }
        return b[a] = null
    },c.TilemapLayer.prototype.resetTilesetCache = function () {
        for (var a = this._mc.tilesets; a.length;)a.pop()
    },c.TilemapLayer.prototype.setScale = function (a, b) {
        a = a || 1, b = b || a;
        for (var c = 0; c < this.layer.data.length; c++)for (var d = this.layer.data[c], e = 0; e < d.length; e++) {
            var f = d[e];
            f.width = this.map.tileWidth * a, f.height = this.map.tileHeight * b, f.worldX = f.x * f.width, f.worldY = f.y * f.height
        }
        this.scale.setTo(a, b)
    },c.TilemapLayer.prototype.shiftCanvas = function (a, b, c) {
        var d = a.canvas, e = d.width - Math.abs(b), f = d.height - Math.abs(c), g = 0, h = 0, i = b, j = c;
        0 > b && (g = -b, i = 0), 0 > c && (h = -c, j = 0);
        var k = this.renderSettings.copyCanvas;
        if (k) {
            (k.width < e || k.height < f) && (k.width = e, k.height = f);
            var l = k.getContext("2d");
            l.clearRect(0, 0, e, f), l.drawImage(d, g, h, e, f, 0, 0, e, f), a.clearRect(i, j, e, f), a.drawImage(k, 0, 0, e, f, i, j, e, f)
        } else a.save(), a.globalCompositeOperation = "copy", a.drawImage(d, g, h, e, f, i, j, e, f), a.restore()
    },c.TilemapLayer.prototype.renderRegion = function (a, b, c, d, e, f) {
        var g = this.context, h = this.layer.width, i = this.layer.height, j = this._mc.tileWidth, k = this._mc.tileHeight, l = this._mc.tilesets, m = NaN;
        this._wrap || (e >= c && (c = Math.max(0, c), e = Math.min(h - 1, e)), f >= d && (d = Math.max(0, d), f = Math.min(i - 1, f)));
        var n, o, p, q, r, s, t = c * j - a, u = d * k - b, v = (c + (1 << 20) * h) % h, w = (d + (1 << 20) * i) % i;
        for (q = w, s = f - d, o = u; s >= 0; q++, s--, o += k) {
            q >= i && (q -= i);
            var x = this.layer.data[q];
            for (p = v, r = e - c, n = t; r >= 0; p++, r--, n += j) {
                p >= h && (p -= h);
                var y = x[p];
                if (y && !(y.index < 0)) {
                    var z = y.index, A = l[z];
                    void 0 === A && (A = this.resolveTileset(z)), y.alpha === m || this.debug || (g.globalAlpha = y.alpha, m = y.alpha), A ? y.rotation || y.flipped ? (g.save(), g.translate(n + y.centerX, o + y.centerY), g.rotate(y.rotation), y.flipped && g.scale(-1, 1), A.draw(g, -y.centerX, -y.centerY, z), g.restore()) : A.draw(g, n, o, z) : this.debugSettings.missingImageFill && (g.fillStyle = this.debugSettings.missingImageFill, g.fillRect(n, o, j, k)), y.debug && this.debugSettings.debuggedTileOverfill && (g.fillStyle = this.debugSettings.debuggedTileOverfill, g.fillRect(n, o, j, k))
                }
            }
        }
    },c.TilemapLayer.prototype.renderDeltaScroll = function (a, b) {
        var c = this._mc.scrollX, d = this._mc.scrollY, e = this.canvas.width, f = this.canvas.height, g = this._mc.tileWidth, h = this._mc.tileHeight, i = 0, j = -g, k = 0, l = -h;
        if (0 > a ? (i = e + a, j = e - 1) : a > 0 && (j = a), 0 > b ? (k = f + b, l = f - 1) : b > 0 && (l = b), this.shiftCanvas(this.context, a, b), i = Math.floor((i + c) / g), j = Math.floor((j + c) / g), k = Math.floor((k + d) / h), l = Math.floor((l + d) / h), j >= i) {
            this.context.clearRect(i * g - c, 0, (j - i + 1) * g, f);
            var m = Math.floor((0 + d) / h), n = Math.floor((f - 1 + d) / h);
            this.renderRegion(c, d, i, m, j, n)
        }
        if (l >= k) {
            this.context.clearRect(0, k * h - d, e, (l - k + 1) * h);
            var o = Math.floor((0 + c) / g), p = Math.floor((e - 1 + c) / g);
            this.renderRegion(c, d, o, k, p, l)
        }
    },c.TilemapLayer.prototype.renderFull = function () {
        var a = this._mc.scrollX, b = this._mc.scrollY, c = this.canvas.width, d = this.canvas.height, e = this._mc.tileWidth, f = this._mc.tileHeight, g = Math.floor(a / e), h = Math.floor((c - 1 + a) / e), i = Math.floor(b / f), j = Math.floor((d - 1 + b) / f);
        this.context.clearRect(0, 0, c, d), this.renderRegion(a, b, g, i, h, j)
    },c.TilemapLayer.prototype.render = function () {
        var a = !1;
        if (this.visible) {
            (this.dirty || this.layer.dirty) && (this.layer.dirty = !1, a = !0);
            var b = this.canvas.width, c = this.canvas.height, d = 0 | this._scrollX, e = 0 | this._scrollY, f = this._mc, g = f.scrollX - d, h = f.scrollY - e;
            if (a || 0 !== g || 0 !== h || f.renderWidth !== b || f.renderHeight !== c)return this.context.save(), f.scrollX = d, f.scrollY = e, (f.renderWidth !== b || f.renderHeight !== c) && (f.renderWidth = b, f.renderHeight = c), this.debug && (this.context.globalAlpha = this.debugSettings.debugAlpha, this.debugSettings.forceFullRedraw && (a = !0)), !a && this.renderSettings.enableScrollDelta && Math.abs(g) + Math.abs(h) < Math.min(b, c) ? this.renderDeltaScroll(g, h) : this.renderFull(), this.debug && (this.context.globalAlpha = 1, this.renderDebug()), this.texture.baseTexture.dirty(), this.dirty = !1, this.context.restore(), !0
        }
    },c.TilemapLayer.prototype.renderDebug = function () {
        var a, b, c, d, e, f, g = this._mc.scrollX, h = this._mc.scrollY, i = this.context, j = this.canvas.width, k = this.canvas.height, l = this.layer.width, m = this.layer.height, n = this._mc.tileWidth, o = this._mc.tileHeight, p = Math.floor(g / n), q = Math.floor((j - 1 + g) / n), r = Math.floor(h / o), s = Math.floor((k - 1 + h) / o), t = p * n - g, u = r * o - h, v = (p + (1 << 20) * l) % l, w = (r + (1 << 20) * m) % m;
        for (i.strokeStyle = this.debugSettings.facingEdgeStroke, d = w, f = s - r, b = u; f >= 0; d++, f--, b += o) {
            d >= m && (d -= m);
            var x = this.layer.data[d];
            for (c = v, e = q - p, a = t; e >= 0; c++, e--, a += n) {
                c >= l && (c -= l);
                var y = x[c];
                !y || y.index < 0 || !y.collides || (this.debugSettings.collidingTileOverfill && (i.fillStyle = this.debugSettings.collidingTileOverfill, i.fillRect(a, b, this._mc.cw, this._mc.ch)), this.debugSettings.facingEdgeStroke && (i.beginPath(), y.faceTop && (i.moveTo(a, b), i.lineTo(a + this._mc.cw, b)), y.faceBottom && (i.moveTo(a, b + this._mc.ch), i.lineTo(a + this._mc.cw, b + this._mc.ch)), y.faceLeft && (i.moveTo(a, b), i.lineTo(a, b + this._mc.ch)), y.faceRight && (i.moveTo(a + this._mc.cw, b), i.lineTo(a + this._mc.cw, b + this._mc.ch)), i.stroke()))
            }
        }
    },Object.defineProperty(c.TilemapLayer.prototype, "wrap", {
        get: function () {
            return this._wrap
        }, set: function (a) {
            this._wrap = a, this.dirty = !0
        }
    }),Object.defineProperty(c.TilemapLayer.prototype, "scrollX", {
        get: function () {
            return this._scrollX
        }, set: function (a) {
            this._scrollX = a
        }
    }),Object.defineProperty(c.TilemapLayer.prototype, "scrollY", {
        get: function () {
            return this._scrollY
        }, set: function (a) {
            this._scrollY = a
        }
    }),Object.defineProperty(c.TilemapLayer.prototype, "collisionWidth", {
        get: function () {
            return this._mc.cw
        }, set: function (a) {
            this._mc.cw = 0 | a, this.dirty = !0
        }
    }),Object.defineProperty(c.TilemapLayer.prototype, "collisionHeight", {
        get: function () {
            return this._mc.ch
        }, set: function (a) {
            this._mc.ch = 0 | a, this.dirty = !0
        }
    }),c.TilemapParser = {
        INSERT_NULL: !1,
        FLIPPED_HORIZONTALLY_FLAG: 2147483648,
        FLIPPED_VERTICALLY_FLAG: 1073741824,
        FLIPPED_DIAGONALLY_FLAG: 536870912,
        parse: function (a, b, d, e, f, g) {
            if (void 0 === d && (d = 32), void 0 === e && (e = 32), void 0 === f && (f = 10), void 0 === g && (g = 10), void 0 === b)return this.getEmptyData();
            if (null === b)return this.getEmptyData(d, e, f, g);
            var h = a.cache.getTilemapData(b);
            if (h) {
                if (h.format === c.Tilemap.CSV)return this.parseCSV(b, h.data, d, e);
                if (!h.format || h.format === c.Tilemap.TILED_JSON)return this.parseTiledJSON(h.data)
            } else console.warn("Phaser.TilemapParser.parse - No map data found for key " + b)
        },
        parseCSV: function (a, b, d, e) {
            var f = this.getEmptyData();
            b = b.trim();
            for (var g = [], h = b.split("\n"), i = h.length, j = 0, k = 0; k < h.length; k++) {
                g[k] = [];
                for (var l = h[k].split(","), m = 0; m < l.length; m++)g[k][m] = new c.Tile(f.layers[0], parseInt(l[m], 10), m, k, d, e);
                0 === j && (j = l.length)
            }
            return f.format = c.Tilemap.CSV, f.name = a, f.width = j, f.height = i, f.tileWidth = d, f.tileHeight = e, f.widthInPixels = j * d, f.heightInPixels = i * e, f.layers[0].width = j, f.layers[0].height = i, f.layers[0].widthInPixels = f.widthInPixels, f.layers[0].heightInPixels = f.heightInPixels, f.layers[0].data = g, f
        },
        getEmptyData: function (a, b, c, d) {
            var e = {};
            e.width = 0, e.height = 0, e.tileWidth = 0, e.tileHeight = 0, "undefined" != typeof a && null !== a && (e.tileWidth = a), "undefined" != typeof b && null !== b && (e.tileHeight = b), "undefined" != typeof c && null !== c && (e.width = c), "undefined" != typeof d && null !== d && (e.height = d), e.orientation = "orthogonal", e.version = "1", e.properties = {}, e.widthInPixels = 0, e.heightInPixels = 0;
            var f = [], g = {
                name: "layer",
                x: 0,
                y: 0,
                width: 0,
                height: 0,
                widthInPixels: 0,
                heightInPixels: 0,
                alpha: 1,
                visible: !0,
                properties: {},
                indexes: [],
                callbacks: [],
                bodies: [],
                data: []
            };
            return f.push(g), e.layers = f, e.images = [], e.objects = {}, e.collision = {}, e.tilesets = [], e.tiles = [], e
        },
        parseTiledJSON: function (a) {
            function b(a, b) {
                var c = {};
                for (var d in b) {
                    var e = b[d];
                    "undefined" != typeof a[e] && (c[e] = a[e])
                }
                return c
            }

            if ("orthogonal" !== a.orientation)return console.warn("TilemapParser.parseTiledJSON - Only orthogonal map types are supported in this version of Phaser"), null;
            var d = {};
            d.width = a.width, d.height = a.height, d.tileWidth = a.tilewidth, d.tileHeight = a.tileheight, d.orientation = a.orientation, d.format = c.Tilemap.TILED_JSON, d.version = a.version, d.properties = a.properties, d.widthInPixels = d.width * d.tileWidth, d.heightInPixels = d.height * d.tileHeight;
            for (var e = [], f = 0; f < a.layers.length; f++)if ("tilelayer" === a.layers[f].type) {
                var g = a.layers[f];
                if (!g.compression && g.encoding && "base64" === g.encoding) {
                    for (var h = window.atob(g.data), i = h.length, j = new Array(i), k = 0; i > k; k += 4)j[k / 4] = (h.charCodeAt(k) | h.charCodeAt(k + 1) << 8 | h.charCodeAt(k + 2) << 16 | h.charCodeAt(k + 3) << 24) >>> 0;
                    g.data = j, delete g.encoding
                } else if (g.compression) {
                    console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '" + g.name + "'");
                    continue
                }
                var l = {
                    name: g.name,
                    x: g.x,
                    y: g.y,
                    width: g.width,
                    height: g.height,
                    widthInPixels: g.width * a.tilewidth,
                    heightInPixels: g.height * a.tileheight,
                    alpha: g.opacity,
                    visible: g.visible,
                    properties: {},
                    indexes: [],
                    callbacks: [],
                    bodies: []
                };
                g.properties && (l.properties = g.properties);
                for (var m, n, o, p, q = 0, r = [], s = [], t = 0, i = g.data.length; i > t; t++) {
                    if (m = 0, n = !1, p = g.data[t], p > 536870912)switch (o = 0, p > 2147483648 && (p -= 2147483648, o += 4), p > 1073741824 && (p -= 1073741824, o += 2), p > 536870912 && (p -= 536870912, o += 1), o) {
                        case 5:
                            m = Math.PI / 2;
                            break;
                        case 6:
                            m = Math.PI;
                            break;
                        case 3:
                            m = 3 * Math.PI / 2;
                            break;
                        case 4:
                            m = 0, n = !0;
                            break;
                        case 7:
                            m = Math.PI / 2, n = !0;
                            break;
                        case 2:
                            m = Math.PI, n = !0;
                            break;
                        case 1:
                            m = 3 * Math.PI / 2, n = !0
                    }
                    p > 0 ? (r.push(new c.Tile(l, p, q, s.length, a.tilewidth, a.tileheight)), r[r.length - 1].rotation = m, r[r.length - 1].flipped = n) : c.TilemapParser.INSERT_NULL ? r.push(null) : r.push(new c.Tile(l, -1, q, s.length, a.tilewidth, a.tileheight)), q++, q === g.width && (s.push(r), q = 0, r = [])
                }
                l.data = s, e.push(l)
            }
            d.layers = e;
            for (var u = [], f = 0; f < a.layers.length; f++)if ("imagelayer" === a.layers[f].type) {
                var v = a.layers[f], w = {
                    name: v.name,
                    image: v.image,
                    x: v.x,
                    y: v.y,
                    alpha: v.opacity,
                    visible: v.visible,
                    properties: {}
                };
                v.properties && (w.properties = v.properties), u.push(w)
            }
            d.images = u;
            for (var x = [], y = [], f = 0; f < a.tilesets.length; f++) {
                var z = a.tilesets[f];
                if (z.image) {
                    var A = new c.Tileset(z.name, z.firstgid, z.tilewidth, z.tileheight, z.margin, z.spacing, z.properties);
                    z.tileproperties && (A.tileProperties = z.tileproperties), A.updateTileData(z.imagewidth, z.imageheight), x.push(A)
                } else {
                    var B = new c.ImageCollection(z.name, z.firstgid, z.tilewidth, z.tileheight, z.margin, z.spacing, z.properties);
                    for (var C in z.tiles) {
                        var w = z.tiles[C].image, p = z.firstgid + parseInt(C, 10);
                        B.addImage(p, w)
                    }
                    y.push(B)
                }
            }
            d.tilesets = x, d.imagecollections = y;
            for (var D = {}, E = {}, f = 0; f < a.layers.length; f++)if ("objectgroup" === a.layers[f].type) {
                var F = a.layers[f];
                D[F.name] = [], E[F.name] = [];
                for (var G = 0, i = F.objects.length; i > G; G++)if (F.objects[G].gid) {
                    var H = this, I = {
                        gid: F.objects[G].gid,
                        name: F.objects[G].name,
                        type: F.objects[G].hasOwnProperty("type") ? F.objects[G].type : "",
                        x: F.objects[G].x,
                        y: F.objects[G].y,
                        width: F.objects[G].width,
                        height: F.objects[G].height,
                        visible: F.objects[G].visible,
                        properties: F.objects[G].properties,
                        horizontallyFlipped: F.objects[G].gid & H.FLIPPED_HORIZONTALLY_FLAG,
                        verticallyFlipped: F.objects[G].gid & H.FLIPPED_VERTICALLY_FLAG,
                        diagonallyFlipped: F.objects[G].gid & H.FLIPPED_DIAGONALLY_FLAG
                    };
                    F.objects[G].rotation && (I.rotation = F.objects[G].rotation), D[F.name].push(I)
                } else if (F.objects[G].polyline) {
                    var I = {
                        name: F.objects[G].name,
                        type: F.objects[G].type,
                        x: F.objects[G].x,
                        y: F.objects[G].y,
                        width: F.objects[G].width,
                        height: F.objects[G].height,
                        visible: F.objects[G].visible,
                        properties: F.objects[G].properties
                    };
                    F.objects[G].rotation && (I.rotation = F.objects[G].rotation), I.polyline = [];
                    for (var J = 0; J < F.objects[G].polyline.length; J++)I.polyline.push([F.objects[G].polyline[J].x, F.objects[G].polyline[J].y]);
                    E[F.name].push(I), D[F.name].push(I)
                } else if (F.objects[G].polygon) {
                    var I = b(F.objects[G], ["name", "type", "x", "y", "visible", "rotation", "properties"]);
                    I.polygon = [];
                    for (var J = 0; J < F.objects[G].polygon.length; J++)I.polygon.push([F.objects[G].polygon[J].x, F.objects[G].polygon[J].y]);
                    D[F.name].push(I)
                } else if (F.objects[G].ellipse) {
                    var I = b(F.objects[G], ["name", "type", "ellipse", "x", "y", "width", "height", "visible", "rotation", "properties"]);
                    D[F.name].push(I)
                } else {
                    var I = b(F.objects[G], ["name", "type", "x", "y", "width", "height", "visible", "rotation", "properties"]);
                    I.rectangle = !0, D[F.name].push(I)
                }
            }
            d.objects = D, d.collision = E, d.tiles = [];
            for (var f = 0; f < d.tilesets.length; f++)for (var z = d.tilesets[f], q = z.tileMargin, K = z.tileMargin, L = 0, M = 0, N = 0, t = z.firstgid; t < z.firstgid + z.total && (d.tiles[t] = [q, K, f], q += z.tileWidth + z.tileSpacing, L++, L !== z.total) && (M++, M !== z.columns || (q = z.tileMargin, K += z.tileHeight + z.tileSpacing, M = 0, N++, N !== z.rows)); t++);
            for (var l, O, P, z, f = 0; f < d.layers.length; f++) {
                l = d.layers[f];
                for (var k = 0; k < l.data.length; k++) {
                    r = l.data[k];
                    for (var Q = 0; Q < r.length; Q++)O = r[Q], null === O || O.index < 0 || (P = d.tiles[O.index][2], z = d.tilesets[P], z.tileProperties && z.tileProperties[O.index - z.firstgid] && (O.properties = c.Utils.mixin(z.tileProperties[O.index - z.firstgid], O.properties)))
                }
            }
            return d
        }
    },c.Tileset = function (a, b, c, d, e, f, g) {
        (void 0 === c || 0 >= c) && (c = 32), (void 0 === d || 0 >= d) && (d = 32), void 0 === e && (e = 0), void 0 === f && (f = 0), this.name = a, this.firstgid = 0 | b, this.tileWidth = 0 | c, this.tileHeight = 0 | d, this.tileMargin = 0 | e, this.tileSpacing = 0 | f, this.properties = g || {}, this.image = null, this.rows = 0, this.columns = 0, this.total = 0, this.drawCoords = []
    },c.Tileset.prototype = {
        draw: function (a, b, c, d) {
            var e = d - this.firstgid << 1;
            e >= 0 && e + 1 < this.drawCoords.length && a.drawImage(this.image, this.drawCoords[e], this.drawCoords[e + 1], this.tileWidth, this.tileHeight, b, c, this.tileWidth, this.tileHeight)
        }, containsTileIndex: function (a) {
            return a >= this.firstgid && a < this.firstgid + this.total
        }, setImage: function (a) {
            this.image = a, this.updateTileData(a.width, a.height)
        }, setSpacing: function (a, b) {
            this.tileMargin = 0 | a, this.tileSpacing = 0 | b, this.image && this.updateTileData(this.image.width, this.image.height)
        }, updateTileData: function (a, b) {
            var c = (b - 2 * this.tileMargin + this.tileSpacing) / (this.tileHeight + this.tileSpacing), d = (a - 2 * this.tileMargin + this.tileSpacing) / (this.tileWidth + this.tileSpacing);
            (c % 1 !== 0 || d % 1 !== 0) && console.warn("Phaser.Tileset - " + this.name + " image tile area is not an even multiple of tile size"), c = Math.floor(c), d = Math.floor(d), (this.rows && this.rows !== c || this.columns && this.columns !== d) && console.warn("Phaser.Tileset - actual and expected number of tile rows and columns differ"), this.rows = c, this.columns = d, this.total = c * d, this.drawCoords.length = 0;
            for (var e = this.tileMargin, f = this.tileMargin, g = 0; g < this.rows; g++) {
                for (var h = 0; h < this.columns; h++)this.drawCoords.push(e), this.drawCoords.push(f), e += this.tileWidth + this.tileSpacing;
                e = this.tileMargin, f += this.tileHeight + this.tileSpacing
            }
        }
    },c.Tileset.prototype.constructor = c.Tileset,c.Particles = function (a) {
        this.game = a, this.emitters = {}, this.ID = 0
    },c.Particles.prototype = {
        add: function (a) {
            return this.emitters[a.name] = a, a
        }, remove: function (a) {
            delete this.emitters[a.name]
        }, update: function () {
            for (var a in this.emitters)this.emitters[a].exists && this.emitters[a].update()
        }
    },c.Particles.prototype.constructor = c.Particles,void 0 === PIXI.blendModes && (PIXI.blendModes = c.blendModes),void 0 === PIXI.scaleModes && (PIXI.scaleModes = c.scaleModes),void 0 === PIXI.Texture.emptyTexture && (PIXI.Texture.emptyTexture = new PIXI.Texture(new PIXI.BaseTexture)),void 0 === PIXI.DisplayObject._tempMatrix && (PIXI.DisplayObject._tempMatrix = new PIXI.Matrix),void 0 === PIXI.RenderTexture.tempMatrix && (PIXI.RenderTexture.tempMatrix = new PIXI.Matrix),PIXI.Graphics && void 0 === PIXI.Graphics.POLY && (PIXI.Graphics.POLY = c.POLYGON, PIXI.Graphics.RECT = c.RECTANGLE, PIXI.Graphics.CIRC = c.CIRCLE, PIXI.Graphics.ELIP = c.ELLIPSE, PIXI.Graphics.RREC = c.ROUNDEDRECTANGLE),PIXI.TextureSilentFail = !0,"undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = c), exports.Phaser = c) : "undefined" != typeof define && define.amd ? define("Phaser", function () {
        return b.Phaser = c
    }()) : b.Phaser = c,c
}.call(this), define("phaser", function () {
}), function () {
    var a, b, c, d, e, f, g, h, i, j, k, l, m, n, o;
    c = Math.floor, j = Math.min, b = function (a, b) {
        return b > a ? -1 : a > b ? 1 : 0
    }, i = function (a, d, e, f, g) {
        var h;
        if (null == e && (e = 0), null == g && (g = b), 0 > e)throw new Error("lo must be non-negative");
        for (null == f && (f = a.length); f > e;)h = c((e + f) / 2), g(d, a[h]) < 0 ? f = h : e = h + 1;
        return [].splice.apply(a, [e, e - e].concat(d)), d
    }, f = function (a, c, d) {
        return null == d && (d = b), a.push(c), n(a, 0, a.length - 1, d)
    }, e = function (a, c) {
        var d, e;
        return null == c && (c = b), d = a.pop(), a.length ? (e = a[0], a[0] = d, o(a, 0, c)) : e = d, e
    }, h = function (a, c, d) {
        var e;
        return null == d && (d = b), e = a[0], a[0] = c, o(a, 0, d), e
    }, g = function (a, c, d) {
        var e;
        return null == d && (d = b), a.length && d(a[0], c) < 0 && (e = [a[0], c], c = e[0], a[0] = e[1], o(a, 0, d)), c
    }, d = function (a, d) {
        var e, f, g, h, i, j;
        for (null == d && (d = b), h = function () {
            j = [];
            for (var b = 0, d = c(a.length / 2); d >= 0 ? d > b : b > d; d >= 0 ? b++ : b--)j.push(b);
            return j
        }.apply(this).reverse(), i = [], f = 0, g = h.length; g > f; f++)e = h[f], i.push(o(a, e, d));
        return i
    }, m = function (a, c, d) {
        var e;
        return null == d && (d = b), e = a.indexOf(c), -1 !== e ? (n(a, 0, e, d), o(a, e, d)) : void 0
    }, k = function (a, c, e) {
        var f, h, i, j, k;
        if (null == e && (e = b), h = a.slice(0, c), !h.length)return h;
        for (d(h, e), k = a.slice(c), i = 0, j = k.length; j > i; i++)f = k[i], g(h, f, e);
        return h.sort(e).reverse()
    }, l = function (a, c, f) {
        var g, h, k, l, m, n, o, p, q, r;
        if (null == f && (f = b), 10 * c <= a.length) {
            if (l = a.slice(0, c).sort(f), !l.length)return l;
            for (k = l[l.length - 1], p = a.slice(c), m = 0, o = p.length; o > m; m++)g = p[m], f(g, k) < 0 && (i(l, g, 0, null, f), l.pop(), k = l[l.length - 1]);
            return l
        }
        for (d(a, f), r = [], h = n = 0, q = j(c, a.length); q >= 0 ? q > n : n > q; h = q >= 0 ? ++n : --n)r.push(e(a, f));
        return r
    }, n = function (a, c, d, e) {
        var f, g, h;
        for (null == e && (e = b), f = a[d]; d > c && (h = d - 1 >> 1, g = a[h], e(f, g) < 0);)a[d] = g, d = h;
        return a[d] = f
    }, o = function (a, c, d) {
        var e, f, g, h, i;
        for (null == d && (d = b), f = a.length, i = c, g = a[c], e = 2 * c + 1; f > e;)h = e + 1, f > h && !(d(a[e], a[h]) < 0) && (e = h), a[c] = a[e], c = e, e = 2 * c + 1;
        return a[c] = g, n(a, i, c, d)
    }, a = function () {
        function a(a) {
            this.cmp = null != a ? a : b, this.nodes = []
        }

        return a.push = f, a.pop = e, a.replace = h, a.pushpop = g, a.heapify = d, a.updateItem = m, a.nlargest = k, a.nsmallest = l, a.prototype.push = function (a) {
            return f(this.nodes, a, this.cmp)
        }, a.prototype.pop = function () {
            return e(this.nodes, this.cmp)
        }, a.prototype.peek = function () {
            return this.nodes[0]
        }, a.prototype.contains = function (a) {
            return -1 !== this.nodes.indexOf(a)
        }, a.prototype.replace = function (a) {
            return h(this.nodes, a, this.cmp)
        }, a.prototype.pushpop = function (a) {
            return g(this.nodes, a, this.cmp)
        }, a.prototype.heapify = function () {
            return d(this.nodes, this.cmp)
        }, a.prototype.updateItem = function (a) {
            return m(this.nodes, a, this.cmp)
        }, a.prototype.clear = function () {
            return this.nodes = []
        }, a.prototype.empty = function () {
            return 0 === this.nodes.length
        }, a.prototype.size = function () {
            return this.nodes.length
        }, a.prototype.clone = function () {
            var b;
            return b = new a, b.nodes = this.nodes.slice(0), b
        }, a.prototype.toArray = function () {
            return this.nodes.slice(0)
        }, a.prototype.insert = a.prototype.push, a.prototype.top = a.prototype.peek, a.prototype.front = a.prototype.peek, a.prototype.has = a.prototype.contains, a.prototype.copy = a.prototype.clone, a
    }(), function (a, b) {
        return "function" == typeof define && define.amd ? define("heap", [], b) : "object" == typeof exports ? module.exports = b() : a.Heap = b()
    }(this, function () {
        return a
    })
}.call(this), define("KME/phext/BodyIsometric", ["phaser"], function () {
    function a(a, b) {
        var c = Math.atan2(.5 * b, a);
        return c = 0 > c ? 2 * Math.PI + c : c, 1 - .4 * Math.abs(Math.sin(c))
    }

    var b = 2, c = .8;
    Phaser.BodyIsometric = function (a, b, c) {
        var d, e = "circle16", f = !1, g = !1, h = !1, i = 0, j = .5, k = .5;
        "undefined" != typeof c && ("undefined" != typeof c.shape && (e = c.shape), "undefined" != typeof c.moveBlock && (f = c.moveBlock), "undefined" != typeof c.viewBlock && (g = c.viewBlock), "undefined" != typeof c.doAction && (h = c.doAction), "undefined" != typeof c.frame && (i = c.frame), "undefined" != typeof c.anchorX && (j = c.anchorX), "undefined" != typeof c.anchorY && (k = c.anchorY), "undefined" != typeof c.angle && (d = c.angle), "undefined" != typeof c.wallShape && (this.wallShape = c.wallShape)), this.moveBlock = f, this.viewBlock = g, this.doAction = h, this.game = a, this.worldObject = b, this.source = a.cache.getImage(e);
        var l;
        l = a.cache.getFrameByIndex(e, i), null === l && (l = {
            x: 0,
            y: 0,
            width: this.source.width,
            height: this.source.height
        });
        var m, n = e + "-" + i;
        f && g ? (m = "rgba(255, 0, 0, 1)", n += "_1") : f ? (m = "rgba(0, 0, 255, 1)", n += "_2") : g ? (m = "rgba(255, 0, 255, 1)", n += "_3") : (m = "rgba(0, 255, 0, 1)", n += "_4");
        var o = !1;
        "undefined" != typeof d ? (this.shapeWidth = l.width, this.shapeHeight = l.width, this.shape = new Phaser.BitmapData(a, null, 2 * l.width, 2 * l.width), this.shape.context.translate(l.width, l.width), this.shape.context.save(), this.shape.context.rotate(d), this.shape.context.drawImage(this.source, l.x, l.y, l.width, l.height, 0, -l.height / 2, l.width, l.height), this.shape.context.restore(), o = !0) : (a.cache.checkBitmapDataKey(n) ? this.shape = a.cache.getBitmapData(n) : (this.shape = new Phaser.BitmapData(a, null, l.width, l.height), a.cache.addBitmapData(n, this.shape), this.shape.context.drawImage(this.source, l.x, l.y, l.width, l.height, 0, 0, l.width, l.height), o = !0), this.shapeWidth = this.shape.width, this.shapeHeight = this.shape.height), o ? (this.shape.context.globalCompositeOperation = "source-atop", this.shape.context.globalAlpha = 1, this.shape.context.fillStyle = m, "undefined" != typeof d ? this.shape.context.fillRect(-l.width, -l.width, this.shape.width, this.shape.height) : this.shape.context.fillRect(0, 0, this.shape.width, this.shape.height), this.collideImageData = this.shape.context.getImageData(0, 0, this.shape.width, this.shape.height), "undefined" == typeof d && a.cache.addBinary(n, this.collideImageData)) : this.collideImageData = a.cache.getBinary(n), this.collideImageData = this.shape.context.getImageData(0, 0, this.shape.width, this.shape.height), this.anchor = new Phaser.Point, this.anchor.x = j, this.anchor.y = k, this.width = this.shape.width, this.height = this.shape.height, this.newPos = new Phaser.Point(b.x, b.y), this.oldPos = new Phaser.Point(b.x, b.y), this.pointer = null, this.targetObject = null, this.range = 0, this.collideExcludeObject = null, this.inMove = !1, this.refreshMove = !1, this.lastFace = KME.world.faceDirections[2], this.newAngle = this.oldAngle = 0, this.startMoveHandler = null, this.stopMoveHandler = null, this.stopMoveCollideHandler = null, this.inRageObjectHandler = null
    }, Phaser.BodyIsometric.prototype = {
        stepCheck: function (a) {
            if (a != this.worldObject && a != this.collideExcludeObject) {
                var b, c, d, e = a.body;
                if ("undefined" != typeof e && (e.viewBlock || e.moveBlock && this.moveBlock) && "undefined" != typeof e.collideImageData && "undefined" != typeof this.collideImageData) {
                    var f = this.oldPos.x + this.anchor.x * -this.width, g = this.oldPos.y + this.anchor.y * -this.height, h = e.x + e.anchor.x * -e.width, i = e.y + e.anchor.y * -e.height;
                    for (b = 0, c = this.pathTry.length; c > b; b++)d = this.pathTry[b], d.block || Phaser.isPixelCollision(a.body.collideImageData, h, i, this.collideImageData, f + d.x | 0, g + d.y | 0, !1) && (d.block = !0)
                }
            }
        }, isCollideCheck: function (a, b) {
            if ("undefined" == typeof b && (b = !1), a != this.worldObject && a != this.collideExcludeObject) {
                var c = a.body;
                if ("undefined" != typeof c && (b || c.viewBlock || c.moveBlock && this.moveBlock) && "undefined" != typeof c.collideImageData && "undefined" != typeof this.collideImageData) {
                    var d = this.x + this.anchor.x * -this.width, e = this.y + this.anchor.y * -this.height, f = c.x + c.anchor.x * -c.width, g = c.y + c.anchor.y * -c.height;
                    if (Phaser.isPixelCollision(a.body.collideImageData, f, g, this.collideImageData, d, e, !1))return this.isCanStruck && !b && this.isPositionChanged() && (d = this.oldX + this.anchor.x * -this.width, e = this.oldY + this.anchor.y * -this.height, Phaser.isPixelCollision(a.body.collideImageData, f, g, this.collideImageData, d, e, !1)) ? !1 : (this.collide = {
                        spX: d,
                        spY: e
                    }, !0)
                }
            }
            return !1
        }, setCollideExcludeObject: function (a) {
            this.collideExcludeObject = a
        }, setCollideAngle: function (a) {
            this.shape.context.globalCompositeOperation = "source-over", this.shape.context.clearRect(-this.source.width, -this.source.width, this.shape.width, this.shape.height), this.shape.context.save(), this.shape.context.rotate(a), this.shape.context.drawImage(this.source, this.source.x, this.source.y, this.source.width, this.source.height, 0, -this.source.height / 2, this.source.width, this.source.height), this.shape.context.restore(), this.shape.context.globalCompositeOperation = "source-atop", this.shape.context.fillRect(-this.source.width, -this.source.width, this.shape.width, this.shape.height), this.collideImageData = this.shape.context.getImageData(0, 0, this.shape.width, this.shape.height)
        }, setCollidePosition: function (a, b) {
            this.x = a, this.y = b
        }, isNearObject: function (a) {
            var b, c, d = a.body;
            if (d) {
                var e, f;
                .5 !== d.anchor.x || .5 !== d.anchor.y ? (e = a.x + (.5 - d.anchor.x) * d.width, f = a.y + (.5 - d.anchor.y) * d.height) : (e = a.x, f = a.y), b = Math.abs(this.x - e), c = Math.abs(this.y - f);
                var g = .03 * this.worldSpeed;
                if (b < this.width + g + d.width / 2 && c < this.height + g + d.height / 2)return !0
            } else if (b = Math.abs(this.x - a.x), c = Math.abs(this.y - a.y), b < this.width && c < this.height)return !0;
            return !1
        }, isInRangeObject: function (a, b) {
            if (b > 0) {
                var c, d;
                return c = Math.abs(this.x - a.x), d = Math.abs(this.y - a.y), c > b || d > b ? !1 : Math.sqrt(c * c + d * d) <= b
            }
            return this.isNearObject(a)
        }, getFace: function () {
            var a = this.newAngle - 1.875 * Math.PI;
            a = 0 > a ? 2 * Math.PI + a : a;
            var b = a / (2 * Math.PI);
            return this.lastFace = KME.world.faceDirections[Math.floor(8 * b)], this.lastFace
        }, setInRangeObjectHandler: function (a, b) {
            this.inRageObjectHandler = a, this.handlerContext = b
        }, setStartMoveHandler: function (a, b) {
            this.startMoveHandler = a, this.handlerContext = b
        }, setStopMoveHandler: function (a, b) {
            this.stopMoveHandler = a, this.handlerContext = b
        }, setStopMoveCollideHandler: function (a, b) {
            this.stopMoveCollideHandler = a, this.handlerContext = b
        }, setAngle: function (a) {
            a = 0 > a ? 2 * Math.PI + a : a, this.newAngle = this.oldAngle = a
        }, calcAngleAndFace: function (a, b) {
            var c = a - this.x, d = b - this.y;
            if (0 !== c || 0 !== d) {
                var e = Math.atan2(d, c);
                e = 0 > e ? 2 * Math.PI + e : e, this.oldAngle = this.newAngle = e;
                var f = e / (2 * Math.PI);
                this.lastFace = KME.world.faceDirections[Math.floor(8 * f)]
            }
        }, getCenterXY: function () {
            return .5 !== this.anchor.x || .5 !== this.anchor.y ? {
                x: this.x + (.5 - this.anchor.x) * this.width,
                y: this.y + (.5 - this.anchor.y) * this.height
            } : {x: this.x, y: this.y}
        }, _checkAndChangeTargetPoint: function () {
            if (this.targetObject) {
                var a, b;
                !this.targetObject.body || .5 === this.targetObject.body.anchor.x && .5 === this.targetObject.body.anchor.y ? (a = this.targetObject.x, b = this.targetObject.y) : (a = this.targetObject.x + (.5 - this.targetObject.body.anchor.x) * this.targetObject.body.width, b = this.targetObject.y + (.5 - this.targetObject.body.anchor.y) * this.targetObject.body.height), this.pointer && a == this.pointer.x && b == this.pointer.y || this.changeMovePointer(a, b)
            }
        }, setTargetObject: function (a, b, c, d, e) {
            this.worldSpeed = this.worldObject.getSpeed(e), this.isRun = e, "undefined" == typeof d && (d = 0), this.inRageObjectHandler = null, "undefined" != typeof b && this.setInRangeObjectHandler(b, c), this.targetObject = a, this.pointer = null, this.range = d, this._checkAndChangeTargetPoint()
        }, fullStop: function (a) {
            this.pointer && this.stopMoving(a), this.targetObject = null, this.inRageObjectHandler = null
        }, changeMovePointer: function (a, b) {
            this.pointer = {x: Math.floor(a), y: Math.floor(b)}, this.startOrUpdateMove()
        }, setXYAngle: function (a, b, c) {
            this.newAngle = c, this.newPos.x = a, this.newPos.y = b
        }, setXY: function (a, b) {
            this.newPos.x = a, this.newPos.y = b
        }, startOrUpdateMove: function () {
            this.pointer && this.worldObject && this.worldObject.calcAngleAndFace && this.worldObject.calcAngleAndFace(this.pointer.x, this.pointer.y), this.startMoveHandler && this.startMoveHandler.call(this.handlerContext), this.refreshMove = !0
        }, setMovePointer: function (a, b, c, d) {
            a = Math.floor(a), b = Math.floor(b), (a !== this.x || b !== this.y) && (this.pointer = {
                x: Math.floor(a),
                y: Math.floor(b)
            }, this.worldSpeed = this.worldObject.getSpeed(c), this.isRun = c, this.isFindPath = d, this.findSide = null, this.targetObject = null, this.z && (this.zCounter = 0), this.startOrUpdateMove())
        }, setParabolic: function (a, b) {
            this.addZ = a, this.speedZ = a / 30;
            var c = b / this.worldObject.speed;
            this.gravityZ = 2 * (-a - c * this.speedZ) / (c * c + c)
        }, findPathToPointer: function () {
            var d, e, f, g, h = this.pointer.x - this.newPos.x, i = this.pointer.y - this.newPos.y;
            if (0 !== h || 0 !== i) {
                this.pathTry = [], d = Math.atan2(i, h), d = 0 > d ? 2 * Math.PI + d : d;
                var j = this.worldSpeed * KME.gameState.myPhysicElapsed * a(h, i);
                for (j >= this.shapeHeight && (j = this.shapeHeight - 1), h = Math.cos(d) * j, i = Math.sin(d) * j, this.pathTry.push({
                    x: h,
                    y: i,
                    a: d
                }), e = 1; b >= e; e++) {
                    var k, l, m;
                    (null === this.findSide || 1 === this.findSide) && (k = d + c * e, k = 0 > k ? 2 * Math.PI + k : k, l = Math.cos(k) * j, m = Math.sin(k) * j, this.pathTry.push({
                        x: l,
                        y: m,
                        a: k
                    })), (null === this.findSide || 0 === this.findSide) && (k = d - c * e, k = 0 > k ? 2 * Math.PI + k : k, l = Math.cos(k) * j, m = Math.sin(k) * j, this.pathTry.push({
                        x: l,
                        y: m,
                        a: k
                    }))
                }
                for (KME.world.map.collisionLayer.findPathCheck(this), e = 0, f = this.pathTry.length; f > e; e++)if (g = this.pathTry[e], !g.block) {
                    h = g.x, i = g.y, d = g.a, e > 0 && null === this.findSide && (this.findSide = e % 2);
                    break
                }
            }
            Math.abs(i) >= Math.abs(this.newPos.y - this.pointer.y) && Math.abs(h) >= Math.abs(this.pointer.x - this.oldPos.x) ? (this.newPos.x = this.pointer.x, this.newPos.y = this.pointer.y, this.pointer = null) : (this.newPos.x = this.oldPos.x + h, this.newPos.y = this.oldPos.y + i)
        }, moveToPointer: function () {
            "undefined" != typeof this.addZ && (this.addZ += this.speedZ, this.speedZ += this.gravityZ, this.worldObject.addZ = Math.floor(this.addZ));
            var b = this.pointer.x - this.newPos.x, c = this.pointer.y - this.newPos.y;
            if (0 !== b || 0 !== c) {
                var d = Math.atan2(c, b);
                d = 0 > d ? 2 * Math.PI + d : d;
                var e = this.worldSpeed * KME.gameState.myPhysicElapsed * a(b, c);
                b = Math.cos(d) * e, c = Math.sin(d) * e
            }
            Math.abs(c) >= Math.abs(this.newPos.y - this.pointer.y) && Math.abs(b) >= Math.abs(this.pointer.x - this.oldPos.x) ? (this.newPos.x = this.pointer.x, this.newPos.y = this.pointer.y, this.pointer = null) : (this.newPos.x = this.oldPos.x + b, this.newPos.y = this.oldPos.y + c)
        }, stopMoving: function (a) {
            this.newPos.x = this.oldPos.x, this.newPos.y = this.oldPos.y, this.newAngle = this.oldAngle, this.pointer = null, this.stopMoveHandler && !a && this.stopMoveHandler.call(this.handlerContext), this.inMove = !1
        }, collideBlockTile: function () {
            this.doAction && this.worldObject.doAction(), this.stopMoving(), this.stopMoveCollideHandler && this.stopMoveCollideHandler.call(this.handlerContext)
        }, collideObject: function (a) {
            this.doAction && this.worldObject.doAction(a), a.body.moveBlock && (this.stopMoving(), this.stopMoveCollideHandler && this.stopMoveCollideHandler.call(this.handlerContext)), a.body.doAction && this.worldObject.doAction(a)
        }, checkTargetObject: function () {
            var a = !1;
            if (this.targetObject) {
                var b = this.isInRangeObject(this.targetObject, this.range);
                b ? (this.pointer && (this.stopMoving(), a = !0), this.inRageObjectHandler && this.inRageObjectHandler.call(this.handlerContext), this.targetObject = null, this.inRageObjectHandler = null) : this.pointer ? this._checkAndChangeTargetPoint() : (this.targetObject = null, this.inRageObjectHandler = null)
            }
            return a
        }, preUpdate: function () {
            this.oldInMove = this.inMove, this.inMove = this.oldPos.x != this.newPos.x || this.oldPos.y != this.newPos.y, this.oldPos.x = this.newPos.x, this.oldPos.y = this.newPos.y, this.oldAngle = this.newAngle;
            var a = this.checkTargetObject();
            null != this.pointer && (this.isFindPath ? this.findPathToPointer() : this.moveToPointer()), a || this.inMove || !this.oldInMove || this.refreshMove || this.stopMoveHandler && this.stopMoveHandler.call(this.handlerContext), this.refreshMove = !1
        }, isPositionChanged: function () {
            return this.oldPos.x != this.newPos.x || this.oldPos.y != this.newPos.y
        }, moved: function () {
            return this.oldPos.x != this.newPos.x || this.oldPos.y != this.newPos.y || this.oldAngle != this.newAngle
        }, postUpdate: function () {
            this.worldObject.x = 0 | this.newPos.x, this.worldObject.y = 0 | this.newPos.y
        }, drawToContext: function (a, b, c) {
            var d = this.x + b + this.anchor.x * -this.width, e = this.y + c + this.anchor.y * -this.height;
            a.drawImage(this.shape.baseTexture.source, 0, 0, this.shape.width, this.shape.height, d, e, this.shape.width, this.shape.height)
        }
    }, Object.defineProperty(Phaser.BodyIsometric.prototype, "x", {
        get: function () {
            return 0 | this.newPos.x
        }, set: function (a) {
            this.newPos.x = a
        }
    }), Object.defineProperty(Phaser.BodyIsometric.prototype, "y", {
        get: function () {
            return 0 | this.newPos.y
        }, set: function (a) {
            this.newPos.y = a
        }
    }), Object.defineProperty(Phaser.BodyIsometric.prototype, "oldX", {
        get: function () {
            return 0 | this.oldPos.x
        }
    }), Object.defineProperty(Phaser.BodyIsometric.prototype, "oldY", {
        get: function () {
            return 0 | this.oldPos.y
        }
    })
}), define("KME/phext/CollisionIsometric", ["phaser"], function () {
    Phaser.isPixelCollision = function (a, b, c, d, e, f, g) {
        b = Math.round(b), c = Math.round(c), e = Math.round(e), f = Math.round(f);
        var h = a.width, i = a.height, j = d.width, k = d.height;
        g && (b -= h / 2 + .5 << 0, c -= i / 2 + .5 << 0, e -= j / 2 + .5 << 0, f -= k / 2 + .5 << 0);
        var l = Math.max(b, e), m = Math.max(c, f), n = Math.min(b + h, e + j), o = Math.min(c + i, f + k);
        if (l >= n || m >= o)return !1;
        var p, q, r = n - l, s = o - m, t = a.data, u = d.data;
        if (4 > r && 4 > s) {
            for (p = l; n > p; p++)for (q = m; o > q; q++)if (0 !== t[4 * (p - b + (q - c) * h) + 3] && 0 !== u[4 * (p - e + (q - f) * j) + 3])return !0
        } else {
            var v = r / 3, w = s / 3;
            v = ~~v === v ? v : v + 1 | 0, w = ~~w === w ? w : w + 1 | 0;
            for (var x = 0; w > x; x++)for (var y = 0; v > y; y++)for (q = m + x; o > q; q += w)for (p = l + y; n > p; p += v)if (0 !== t[4 * (p - b + (q - c) * h) + 3] && 0 !== u[4 * (p - e + (q - f) * j) + 3])return !0
        }
        return !1
    }
}), define("KME/phext/TileIsometric", ["phaser"], function () {
    Phaser.TileIsometric = function (a) {
        Phaser.Tile.apply(this, arguments), this.worldX = Math.floor(this.x * this.width / 2 - this.y * this.width / 2 + (a.mapWidth - 1) * this.width / 2), this.worldY = Math.floor(this.x * this.height / 2 + this.y * this.height / 2), this.moveBlock = !1, this.viewBlock = !1
    }, Phaser.TileIsometric.prototype = Object.create(Phaser.Tile.prototype), Phaser.TileIsometric.prototype.constructor = Phaser.TileIsometric, Phaser.TileIsometric.prototype.setCollision = function (a, b) {
        "undefined" == typeof a && (a = !1), "undefined" == typeof b && (b = !1), this.moveBlock = a, this.viewBlock = b
    }, Phaser.TileIsometric.prototype.resetCollision = function () {
        this.moveBlock = !1, this.viewBlock = !1
    }, Phaser.TileIsometric.prototype.isInteresting = function () {
        return this.moveBlock || this.viewBlock
    }, Phaser.TileIsometric.prototype.intersects = function (a, b, c, d) {
        return c <= this.worldX ? !1 : d <= this.worldY ? !1 : a >= this.worldX + this.width ? !1 : b < this.worldY + this.height
    }
}), define("KME/phext/TilemapIsometric", ["phaser"], function () {
    Phaser.TilemapIsometric = function (a) {
        this.game = a, this.moveBlockIndexes = [], this.viewBlockIndexes = [], this.blockImageDatas = [], this.currentLayer = 0, this.debugMap = [], this._tempA = 0, this._tempB = 0
    }, Phaser.TilemapIsometric.prototype = Object.create(Phaser.Tilemap.prototype), Phaser.TilemapIsometric.prototype.constructor = Phaser.TilemapIsometric, Phaser.TilemapIsometric.prototype._addRoom = function (a) {
        if (a.tiles && Object.keys(a.tiles).length) {
            a.collisionObjects = {}, this.newRoomsArray.push(a);
            var b = a.roomX * this.roomWidth + this.mapSettings.nXLeft, c = a.roomY * this.roomHeight + this.mapSettings.nYUp;
            a.worldCoords = {
                leftX: b * this.tileWidth,
                upY: c * this.tileHalfHeight,
                rightX: (b + this.roomWidth) * this.tileWidth,
                downY: (c + this.roomHeight) * this.tileHalfHeight
            }, null === this.currentRoomsNXLeft || this.currentRoomsNXLeft > b ? (this.currentRoomsNXLeft = b, this.currentRoomsWorldXLeft = this.currentRoomsNXLeft * this.tileWidth) : this.currentRoomsNXLeft + this.roomWidth < b && (this.currentRoomsNXLeft = b - this.roomWidth, this.currentRoomsWorldXLeft = this.currentRoomsNXLeft * this.tileWidth), null === this.currentRoomsNYUp || this.currentRoomsNYUp > c ? (this.currentRoomsNYUp = c, this.currentRoomsWorldYUp = this.currentRoomsNYUp * this.tileHalfHeight) : this.currentRoomsNYUp + this.roomHeight < c && (this.currentRoomsNYUp = c - this.roomHeight, this.currentRoomsWorldYUp = this.currentRoomsNYUp * this.tileHalfHeight), this.rooms[a.roomId] = a
        } else console.error("addRoom error", a.roomId)
    }, Phaser.TilemapIsometric.prototype._clearRoom = function (a) {
        var b = this.rooms[a];
        b && (b.cleared = !0, delete this.rooms[a])
    }, Phaser.TilemapIsometric.prototype.roomsUpdate = function (a, b) {
        "undefined" == typeof this.rooms ? this.rooms = {} : this.newRoomAdded = !0;
        var c, d;
        for (c = 0, d = a.rooms.length; d > c; c++)this._addRoom(a.rooms[c]);
        for (this.setBounds(), c = 0, d = a.clear.length; d > c; c++)this._clearRoom(a.clear[c]);
        b && b(), KME.world.view.getRoomsBorders()
    }, Phaser.TilemapIsometric.prototype.setBounds = function () {
        console.log("setBounds", this.currentRoomsWorldXLeft - this.roomWidth * this.normalWidth, this.currentRoomsWorldYUp - this.roomHeight * this.normalHeight, 2 * this.backgroundBitmapWidth, 2 * this.backgroundBitmapHeight), this.game.world.setBounds(this.currentRoomsWorldXLeft - this.roomWidth * this.normalWidth, this.currentRoomsWorldYUp - this.roomHeight * this.normalHeight, 2 * this.backgroundBitmapWidth, 2 * this.backgroundBitmapHeight)
    }, Phaser.TilemapIsometric.prototype.getWorkerIndex = function (a) {
        var b = this.rooms[a];
        return b ? b.workerIndex : null
    }, Phaser.TilemapIsometric.prototype.setWorldSettings = function (a, b) {
        this.roomsAmountWidth = a.roomsAmountWidth, this.roomsAmountHeight = a.roomsAmountHeight, this.mapSettings = a.mapSettings, this.currentMapWidth = a.currentMapWidth, this.currentMapHalfWidth = a.currentMapWidth / 2 | 0, this.currentMapHeight = a.currentMapHeight, this.roomWidth = a.roomWidth, this.roomsFullWidth = 2 * a.roomWidth, this.roomHeight = a.roomHeight, this.roomsFullHeight = 2 * a.roomHeight, this.tileWidth = a.tileWidth, this.tileHalfWidth = a.tileWidth / 2, this.tileHeight = a.tileHeight, this.tileHalfHeight = a.tileHeight / 2, this.normalWidth = a.normalWidth, this.normalHalfWidth = a.normalHalfWidth, this.normalHeight = a.normalHeight, this.normalHalfHeight = a.normalHalfHeight, this.backgroundBitmapWidth = this.roomWidth * this.normalWidth * 2, this.backgroundBitmapHeight = this.roomHeight * this.normalHeight * 2, this.setBlockImageData(1, 4), this.setMoveBlockIndexes(1, 2), this.setViewBlockIndexes(1, 1), this.layers = [{name: "background"}, {name: "objects"}, {name: "collision"}], this.newRoomsArray = [], this.currentRoomsNXLeft = null, this.currentRoomsNYUp = null, b && b()
    }, Phaser.TilemapIsometric.prototype.isInRooms = function (a, b) {
        return !(a >= this.currentRoomsNXLeft + 2 * this.roomWidth || a < this.currentRoomsNXLeft || b >= this.currentRoomsNYUp + 2 * this.roomHeight || b < this.currentRoomsNYUp)
    }, Phaser.TilemapIsometric.prototype.isInWorld = function (a, b) {
        return !(a >= this.mapSettings.nXRight || a < this.mapSettings.nXLeft || b >= this.mapSettings.nYDown || b < this.mapSettings.nYUp)
    }, Phaser.TilemapIsometric.prototype.getRoomIdByNormalCoords = function (a) {
        var b = a.nX - this.mapSettings.nXLeft, c = a.nY - this.mapSettings.nYUp, d = b / this.roomWidth | 0, e = c / this.roomHeight | 0;
        return d + e * this.roomsAmountWidth
    }, Phaser.TilemapIsometric.prototype.getWorldByNormal = function (a) {
        var b = a.nY % 2 ? this.normalHalfWidth : 0;
        return {x: a.nX * this.normalWidth + b, y: a.nY * this.normalHeight}
    }, Phaser.TilemapIsometric.prototype.getWorldTileCenterByNormal = function (a) {
        var b = a.nY % 2 ? this.tileWidth : this.tileHalfWidth;
        return {x: a.nX * this.normalWidth + b, y: a.nY * this.normalHeight + this.tileHalfHeight}
    }, Phaser.TilemapIsometric.prototype.convertNormal2IsoTile = function (a, b) {
        var c = a - this.mapSettings.nXLeft, d = b - this.mapSettings.nYUp, e = -this.currentMapHalfWidth + (c + (d / 2 | 0)) + d % 2, f = this.currentMapHalfWidth - (c - (d / 2 | 0));
        return {x: e, y: f}
    }, Phaser.TilemapIsometric.prototype.convertIsoTile2Normal = function (a, b) {
        var c = a + b, d = -c % 2 + (a - b + this.currentMapWidth) / 2 | 0;
        return {nX: d + this.mapSettings.nXLeft, nY: c + this.mapSettings.nYUp}
    }, Phaser.TilemapIsometric.prototype.getTileByIsoXY = function (a, b) {
        var c = this.convertIsoTile2Normal(a, b);
        return this.getTile(c.nX, c.nY)
    }, Phaser.TilemapIsometric.prototype.hasRoom = function (a) {
        return !!this.rooms[a]
    }, Phaser.TilemapIsometric.prototype.getRoomAndTileIndex = function (a, b) {
        var c = a - this.mapSettings.nXLeft, d = b - this.mapSettings.nYUp, e = c / this.roomWidth | 0, f = d / this.roomHeight | 0, g = e + f * this.roomsAmountWidth, h = c - e * this.roomWidth, i = d - f * this.roomHeight, j = h + i * this.roomWidth;
        return {room: this.rooms[g], roomTileNormalIndex: j}
    }, Phaser.TilemapIsometric.prototype.getCollisionObjectsByNormalTileXY = function (a, b) {
        var c = this.getRoomAndTileIndex(a, b);
        return c.room ? c.room.collisionObjects[c.roomTileNormalIndex] : null
    }, Phaser.TilemapIsometric.prototype.getFogTile = function (a, b) {
        var c = this.getWorldByNormal({nX: a, nY: b});
        return {nX: a, nY: b, wX: c.x, wY: c.y, bI: 999, oI: 0, cI: 2}
    }, Phaser.TilemapIsometric.prototype.getVoidTile = function (a, b) {
        var c = this.getWorldByNormal({nX: a, nY: b});
        return {nX: a, nY: b, wX: c.x, wY: c.y, bI: 888, oI: 0, cI: 2}
    }, Phaser.TilemapIsometric.prototype.getTile = function (a, b) {
        if (this.isInWorld(a, b)) {
            if (this.isInRooms(a, b)) {
                var c = this.getRoomAndTileIndex(a, b);
                return c.room ? c.room.tiles[c.roomTileNormalIndex] : this.getFogTile(a, b)
            }
            return this.getFogTile(a, b)
        }
        return this.getVoidTile(a, b)
    }, Phaser.TilemapIsometric.prototype.addCollisionObject = function (a, b, c) {
        "undefined" == typeof b && (b = a.normalPoint.nX, c = a.normalPoint.nY);
        var d = this.getRoomAndTileIndex(b, c);
        d.room ? ("undefined" == typeof d.room.collisionObjects[d.roomTileNormalIndex] && (d.room.collisionObjects[d.roomTileNormalIndex] = []), d.room.collisionObjects[d.roomTileNormalIndex].push(a)) : console.log("addCollisionObject room nof found:", a.objectTypeName ? a.objectTypeName : a.typeName, b, c)
    }, Phaser.TilemapIsometric.prototype.removeCollisionObject = function (a) {
        var b, c, d = a.normalPoint.nX, e = a.normalPoint.nY, f = this.getRoomAndTileIndex(d, e);
        return f.room && (b = f.room.collisionObjects[f.roomTileNormalIndex], b && (c = b.indexOf(a), c >= 0)) ? (b.splice(c, 1), !0) : void 0
    }, Phaser.TilemapIsometric.prototype.collisionChangeTile = function (a, b) {
        this.removeCollisionObject(a), this.addCollisionObject(a, b.nX, b.nY)
    }, Phaser.TilemapIsometric.prototype.updateTile = function (a) {
        var b = this.getRoomAndTileIndex(a.nX, a.nY);
        if (b.room) {
            var c = b.room.tiles[b.roomTileNormalIndex];
            c && ("undefined" != typeof a.bI && (c.bI = a.bI), "undefined" != typeof a.oI && (c.oI = a.oI))
        }
    }, Phaser.TilemapIsometric.prototype.createLayer = function (a, b, c, d) {
        "undefined" == typeof b && (b = this.game.width), "undefined" == typeof c && (c = this.game.height), "undefined" == typeof d && (d = this.game.world);
        var e = a;
        return "string" == typeof a && (e = this.getLayerIndex(a)), d.add(new Phaser.TilemapLayerIsometric(this.game, this, e, b, c))
    }, Phaser.TilemapIsometric.prototype.getNormalFromWorldWrong = function (a, b) {
        var c = (b - this.tileHalfHeight) / this.normalHeight | 0, d = c % 2 ? this.normalHalfWidth : 0, e = (a - d) / this.normalWidth | 0;
        return {nX: e, nY: c}
    }, Phaser.TilemapIsometric.prototype.getNormalFromWorld = function (a, b) {
        var c = 0 | a, d = 0 | b, e = Math.floor(((c - this.currentMapWidth * this.tileHalfWidth) / 2 + d) / this.tileHalfWidth), f = Math.floor(-((c - this.currentMapWidth * this.tileHalfWidth) / 2 - d) / this.tileHalfWidth), g = e + f, h = (e - f + this.currentMapWidth) / 2 - g % 2 | 0;
        return {x: e, y: f, nX: h, nY: g}
    }, Phaser.TilemapIsometric.prototype.getWorldFromIsoTileXYOld = function (a, b) {
        var c = this.width * this.tileWidth, d = a * this.tileHeight, e = b * this.tileHeight;
        return {x: Math.floor(d - e + c / 2), y: Math.floor((d + e + this.tileHeight) / 2)}
    }, Phaser.TilemapIsometric.prototype.getWorldXY = function (a, b, c) {
        return c.x = a * this.tileWidth / 2 - b * this.tileWidth / 2 + (this.width - 1) * this.tileWidth / 2, c.y = a * this.tileHeight / 2 + b * this.tileHeight / 2, c
    }, Phaser.TilemapIsometric.prototype.createBlankLayer = function (a, b, c, d, e, f) {
        if ("undefined" == typeof f && (f = this.game.world), null !== this.getLayerIndex(a))return console.warn("Tilemap.createBlankLayer: Layer with matching name already exists"), null;
        for (var g, h = {
            name: a,
            x: 0,
            y: 0,
            width: b,
            height: c,
            widthInPixels: b * d,
            heightInPixels: c * e,
            alpha: 1,
            visible: !0,
            properties: {},
            indexes: [],
            callbacks: [],
            bodies: [],
            data: null
        }, i = [], j = 0; c > j; j++) {
            g = [];
            for (var k = 0; b > k; k++)g.push(new Phaser.TileIsometric(h, -1, k, j, d, e));
            i.push(g)
        }
        h.data = i, this.layers.push(h), this.currentLayer = this.layers.length - 1;
        var l = h.widthInPixels, m = h.heightInPixels;
        return l > this.game.width && (l = this.game.width), m > this.game.height && (m = this.game.height), i = new Phaser.TilemapLayerIsometric(this.game, this, this.layers.length - 1, l, m), i.name = a, f.add(i)
    }, Phaser.TilemapIsometric.prototype.setBlockImageData = function (a, b) {
        var c = this.game.cache.getImage("collision"), d = new Phaser.BitmapData(this.game, null, c.width, c.height);
        d.context.drawImage(c, 0, 0, c.width, c.height);
        for (var e = a; b >= e; e++)this.blockImageDatas[e] = d.context.getImageData(this.tileWidth * (e - 1), 0, this.tileWidth, this.tileHeight)
    }, Phaser.TilemapIsometric.prototype.setMoveBlockIndexes = function (a, b) {
        for (var c = a; b >= c; c++)this.moveBlockIndexes[c] = !0
    }, Phaser.TilemapIsometric.prototype.setViewBlockIndexes = function (a, b) {
        for (var c = a; b >= c; c++)this.viewBlockIndexes[c] = !0
    }
}), define("KME/phext/TilemapMask", ["phaser"], function () {
    Phaser.TilemapMask = function (a, b, c, d, e) {
        this.game = a, this.tileIndexes = c, this.tilemapLayer = b, this.maskImage = this.game.cache.getImage(d), this.maskWidth = e, this.map = b.map, this.maskHeight = e / 2 | 0, this.triangleWidth = e / 2 | 0, this.triangleHeight = e / 4 | 0, this.frameDefinitions = {
            full: 0,
            edged: 1,
            spotted: 2,
            hSpotted: 3,
            vSpotted: 4
        }, this.triangleDefinitions = {upLeft: 0, upRight: 1, downRight: 2, downLeft: 3}, this.maskFrames = [];
        var f = this;
        Object.keys(this.frameDefinitions).forEach(function (a) {
            var b = f.frameDefinitions[a];
            f.maskFrames[b] = f.doTriangles(b)
        })
    }, Phaser.TilemapMask.prototype = {
        doTriangles: function (a) {
            var b = {
                x: 0 + a * this.maskWidth,
                y: 0,
                width: this.maskWidth,
                height: this.maskHeight,
                offsetX: 0,
                offsetY: 0,
                triangles: []
            }, c = this;
            return Object.keys(this.triangleDefinitions).forEach(function (d) {
                var e = c.triangleDefinitions[d];
                b.triangles[e] = {
                    x: 0 + a * c.maskWidth,
                    y: 0,
                    width: c.triangleWidth,
                    height: c.triangleHeight,
                    offsetX: 0,
                    offsetY: 0
                }
            }), b.triangles[this.triangleDefinitions.upRight].x += this.triangleWidth, b.triangles[this.triangleDefinitions.upRight].offsetX += this.triangleWidth, b.triangles[this.triangleDefinitions.downLeft].y += this.triangleHeight, b.triangles[this.triangleDefinitions.downLeft].offsetY += this.triangleHeight, b.triangles[this.triangleDefinitions.downRight].x += this.triangleWidth, b.triangles[this.triangleDefinitions.downRight].y += this.triangleHeight, b.triangles[this.triangleDefinitions.downRight].offsetX += this.triangleWidth, b.triangles[this.triangleDefinitions.downRight].offsetY += this.triangleHeight, b
        }, determineTriangle: function (a, b, c, d, e) {
            var f, g, h;
            g = a, h = b;
            var i, j = !1, k = !1, l = !1;
            if (i = this.map.getTileByIsoXY(g, h), j = i && "undefined" != typeof this.tileIndexes[i.bI]) {
                var m, n;
                g = a + c, h = b + d, i = this.map.getTileByIsoXY(g, h), i && "undefined" != typeof this.tileIndexes[i.bI] && (e ? (m = d, n = c) : (m = -d, n = -c), g = a + c + m, h = b + d + n, i = this.map.getTileByIsoXY(g, h), k = i && "undefined" != typeof this.tileIndexes[i.bI]), g = a - c, h = b - d, i = this.map.getTileByIsoXY(g, h), i && "undefined" != typeof this.tileIndexes[i.bI] && (e ? (m = d, n = c) : (m = -d, n = -c), g = a - c + m, h = b - d + n, i = this.map.getTileByIsoXY(g, h), l = i && "undefined" != typeof this.tileIndexes[i.bI]), f = k && l ? this.frameDefinitions.full : k ? e ? this.frameDefinitions.vSpotted : this.frameDefinitions.hSpotted : l ? e ? this.frameDefinitions.hSpotted : this.frameDefinitions.vSpotted : this.frameDefinitions.spotted
            } else f = this.frameDefinitions.edged;
            return f
        }, draw: function (a, b, c, d, e) {
            var f, g, h, i = this.map.convertNormal2IsoTile(b, c);
            f = this.determineTriangle(i.x - 1, i.y, 0, 1, !0), g = this.maskFrames[f], h = g.triangles[this.triangleDefinitions.upLeft], a.drawImage(this.maskImage, h.x, h.y, h.width, h.height, d + h.offsetX, e + h.offsetY, h.width, h.height), f = this.determineTriangle(i.x, i.y - 1, 1, 0, !0), g = this.maskFrames[f], h = g.triangles[this.triangleDefinitions.upRight], a.drawImage(this.maskImage, h.x, h.y, h.width, h.height, d + h.offsetX, e + h.offsetY, h.width, h.height), f = this.determineTriangle(i.x + 1, i.y, 0, 1, !1), g = this.maskFrames[f], h = g.triangles[this.triangleDefinitions.downRight], a.drawImage(this.maskImage, h.x, h.y, h.width, h.height, d + h.offsetX, e + h.offsetY, h.width, h.height), f = this.determineTriangle(i.x, i.y + 1, 1, 0, !1), g = this.maskFrames[f], h = g.triangles[this.triangleDefinitions.downLeft], a.drawImage(this.maskImage, h.x, h.y, h.width, h.height, d + h.offsetX, e + h.offsetY, h.width, h.height)
        }
    }
}), define("KME/phext/TilemapBackgroundLayer", ["phaser", "KME/phext/TilemapMask"], function () {
    Phaser.TilemapBackgroundLayer = function () {
        Phaser.TilemapLayer.apply(this, arguments)
    }, Phaser.TilemapBackgroundLayer.prototype = Object.create(Phaser.TilemapLayer.prototype), Phaser.TilemapBackgroundLayer.prototype.constructor = Phaser.TilemapBackgroundLayer, Phaser.TilemapBackgroundLayer.prototype.init = function (a, b) {
        this.textureConfig = {
            999: {imageName: "fogTexture", tileIndexes: {999: 1}, maskName: "tileMaskSmooth"},
            888: {imageName: "soilDeepWaterTexture", tileIndexes: {888: 1, 1: 1}, maskName: "tileMaskSmooth"},
            1: {imageName: "soilDeepWaterTexture", tileIndexes: {1: 1, 2: 1, 888: 1}, maskName: "tileMaskSmooth"},
            2: {imageName: "soilWaterTexture", tileIndexes: {2: 1, 3: 1}, maskName: "tileMaskSmooth"},
            3: {imageName: "soilTexture", tileIndexes: {3: 1, 4: 1, 50: 1, 5: 1}, maskName: "tileMaskSmooth"},
            4: {imageName: "grassTexture", tileIndexes: {4: 1, 5: 1}, maskName: "tileMaskDefault"},
            5: {imageName: "soilTexture", tileIndexes: {5: 1, 6: 1, 3: 1}, maskName: "tileMaskDefault"},
            6: {imageName: "snowSoilTexture", tileIndexes: {6: 1, 7: 1}, maskName: "tileMaskSmooth"},
            7: {imageName: "snowGrassTexture", tileIndexes: {7: 1, 8: 1}, maskName: "tileMaskSmooth"},
            8: {imageName: "frozenWaterTexture", tileIndexes: {8: 1}, maskName: "tileMaskSmooth"},
            50: {imageName: "pavedTexture", tileIndexes: {50: 1}, maskName: "tileMaskInGrass"}
        }, this.addedTileIndexes = {
            888: 1,
            2: 1,
            3: 2,
            4: 3,
            5: 4,
            6: 5,
            7: 6,
            8: 7,
            50: 3
        }, this.gridDebug = a, this.tileMaskDebug = b, this.backgroundData = new Phaser.BitmapData(this.game, null, this.map.backgroundBitmapWidth, this.map.backgroundBitmapHeight), this.maskedData = new Phaser.BitmapData(this.game, null, this.backgroundData.width, this.backgroundData.height);
        var c = this;
        Object.keys(this.textureConfig).forEach(function (a) {
            var b = c.textureConfig[a];
            if (b.image = c.game.cache.getImage(b.imageName), b.pattern = c.context.createPattern(b.image, "repeat"), b.maskName) {
                var d;
                d = c.tileMaskDebug ? "tileMaskDebug" : b.maskName, b.mask = new Phaser.TilemapMask(c.game, c, b.tileIndexes, d, c.map.tileWidth)
            }
        }), this.fogTexture = this.textureConfig[999]
    }, Phaser.TilemapBackgroundLayer.prototype._getBackgroundTile = function (a, b) {
        return this.map.getTile(a, b)
    }, Phaser.TilemapBackgroundLayer.prototype.prepare = function (a) {
        var b, c, d, e, f, g = this.textureConfig[5];
        c = this.map.currentRoomsWorldXLeft % g.image.width, d = this.map.currentRoomsWorldYUp % g.image.height, this.backgroundData.context.fillStyle = g.pattern, this.backgroundData.context.translate(-c, -d), this.backgroundData.context.fillRect(c, d, this.backgroundData.width, this.backgroundData.height), this.backgroundData.context.translate(c, d), this.backgroundStartX = this.map.currentRoomsWorldXLeft, this.backgroundStartY = this.map.currentRoomsWorldYUp, this.gridDebug && ("undefined" == typeof this.gridDebugData && (this.gridDebugData = new Phaser.BitmapData(this.game, null, this.backgroundData.width, this.backgroundData.height)), this.gridDebugData.context.clearRect(0, 0, this.gridDebugData.width, this.gridDebugData.height));
        var h, i, j, k = this.map.currentRoomsWorldXLeft, l = this.map.currentRoomsWorldYUp, m = k / this.map.tileWidth | 0, n = (m + this.backgroundData.width / this.map.tileWidth | 0) + 2, o = (l / (this.map.tileHeight / 2) | 0) - 3, p = (o + this.backgroundData.height / (this.map.tileHeight / 2) | 0) + 3, q = {}, r = null;
        for (f = o; p > f; f++) {
            for (j = null, e = m; n > e; e++)if (b = this._getBackgroundTile(e, f), b && b.bI && ("undefined" == typeof q[b.bI] && (q[b.bI] = []), q[b.bI].push(b), this.addedTileIndexes[b.bI] && ("undefined" == typeof q[this.addedTileIndexes[b.bI]] && (q[this.addedTileIndexes[b.bI]] = []), q[this.addedTileIndexes[b.bI]].push(b))), this.gridDebug) {
                h = this.map.getRoomIdByNormalCoords({nX: e, nY: f}), null === j && (i = h);
                var s = e * this.map.tileWidth - f % 2 * this.map.tileHalfWidth + this.map.tileHalfWidth, t = (f + 1) * this.map.tileHalfHeight;
                f % 2 === 0 && null !== j && j !== h ? this.gridDebugData.context.strokeStyle = "rgba(255, 0, 0, 1)" : null !== r && r !== i ? this.gridDebugData.context.strokeStyle = "rgba(255, 0, 0, 1)" : this.gridDebugData.context.strokeStyle = "rgba(0, 0, 0, 1)", this.gridDebugData.context.beginPath(), this.gridDebugData.context.moveTo(s - this.map.tileWidth / 2 - k, t - l), this.gridDebugData.context.lineTo(s - k, t - this.map.tileHeight / 2 - l), this.gridDebugData.context.stroke(), f % 2 !== 0 && null !== j && j !== h ? this.gridDebugData.context.strokeStyle = "rgba(255, 0, 0, 1)" : null !== r && r !== i ? this.gridDebugData.context.strokeStyle = "rgba(255, 0, 0, 1)" : this.gridDebugData.context.strokeStyle = "rgba(0, 0, 0, 1)", this.gridDebugData.context.beginPath(), this.gridDebugData.context.moveTo(s - k, t - this.map.tileHeight / 2 - l), this.gridDebugData.context.lineTo(s + this.map.tileWidth / 2 - k, t - l), this.gridDebugData.context.stroke(), j = h
            }
            r = i
        }
        var u, v, w = this;
        Object.keys(q).forEach(function (a) {
            var c = q[a], d = w.textureConfig[a];
            w.maskedData.context.globalCompositeOperation = "source-over", w.maskedData.context.clearRect(0, 0, w.maskedData.width, w.maskedData.height);
            for (var e = 0, f = c.length; f > e; e++)b = c[e], d.mask.draw(w.maskedData.context, b.nX, b.nY, b.wX - k, b.wY - l);
            w.tileMaskDebug || (u = k % d.image.width, v = l % d.image.height, w.maskedData.context.globalCompositeOperation = "source-atop", w.maskedData.context.fillStyle = d.pattern, w.maskedData.context.translate(-u, -v), w.maskedData.context.fillRect(u, v, w.backgroundData.width, w.backgroundData.height), w.maskedData.context.translate(u, v)), w.backgroundData.context.drawImage(w.maskedData.baseTexture.source, 0, 0, w.backgroundData.width, w.backgroundData.height)
        }), this.gridDebug && this.backgroundData.context.drawImage(this.gridDebugData.baseTexture.source, 0, 0, this.backgroundData.width, this.backgroundData.height), this.layer.dirty = !0, a && a()
    }, Phaser.TilemapBackgroundLayer.prototype.render = function () {
        if (this.backgroundData) {
            if (this.layer.dirty && (this.dirty = !0), !this.dirty) {
                var a = this._mc, b = a.scrollX - this.scrollX, c = a.scrollY - this.scrollY;
                if (0 === b && 0 === c)return;
                a.scrollX = this.scrollX, a.scrollY = this.scrollY
            }
            var d = this.scrollX - this.backgroundStartX, e = this.scrollY - this.backgroundStartY;
            this.context.drawImage(this.backgroundData.baseTexture.source, d, e, this.canvas.width, this.canvas.height, 0, 0, this.canvas.width, this.canvas.height), this.texture.baseTexture.dirty(), this.dirty = !1, this.layer.dirty = !1
        }
    }
}), define("KME/phext/TilemapCollisionLayer", ["phaser"], function () {
    Phaser.TilemapCollisionLayer = function () {
        Phaser.TilemapLayer.apply(this, arguments), this.lineSightInit()
    }, Phaser.TilemapCollisionLayer.prototype = Object.create(Phaser.TilemapLayer.prototype), Phaser.TilemapCollisionLayer.prototype.constructor = Phaser.TilemapCollisionLayer, Phaser.TilemapCollisionLayer.prototype.lineSightInit = function () {
        this.lineStepLength = 16;
        var a = {
            shape: "bar" + this.lineStepLength,
            moveBlock: !1,
            viewBlock: !1,
            doAction: !1,
            angle: 0,
            anchorX: .5,
            anchorY: .5
        };
        this.lineStepBody = new Phaser.BodyIsometric(this.game, {x: 0, y: 0}, a), a = {
            shape: "bar150",
            moveBlock: !1,
            viewBlock: !1,
            doAction: !1,
            angle: 0,
            anchorX: .5,
            anchorY: .5
        }, this.lineTestBody = new Phaser.BodyIsometric(this.game, {x: 0, y: 0}, a)
    }, Phaser.TilemapCollisionLayer.prototype.isLineSight = function (a, b) {
        var c, d, e, f, g, h, i, j, k, l, m, n, o, p, q;
        if (b.body ? (d = b.body.getCenterXY(), b.body.wallShape && (q = !0)) : d = {
                x: b.x,
                y: b.y
            }, e = d.x - a.x, f = d.y - a.y, 0 === e && 0 === f)return !0;
        if (g = Math.atan2(f, e), g = 0 > g ? 2 * Math.PI + g : g, this.lineTestBody.setCollideExcludeObject(a), this.lineTestBody.setCollidePosition(a.x, a.y), this.lineTestBody.setCollideAngle(g), h = this.getCollideObjects(this.lineTestBody), 0 === h.length)return !0;
        i = Math.sqrt(e * e + f * f), j = Math.ceil(i / this.lineStepLength), this.lineStepBody.setCollidePosition(a.x, a.y), this.lineStepBody.setCollideAngle(g), k = Math.cos(g), l = Math.sin(g);
        for (var r = 0; j > r; r++) {
            for (o = !1, p = !1, m = 0, n = h.length; n > m; m++)if (c = h[m], q)if (c === b) {
                if (this.lineStepBody.isCollideCheck(b, !0))return !0
            } else c.body.viewBlock && this.lineStepBody.isCollideCheck(c, !0) && (o = !0); else if (c === b)this.lineStepBody.isCollideCheck(b, !0) && (o = !0); else if (c.body.viewBlock && this.lineStepBody.isCollideCheck(c, !0)) {
                if (c.body.wallShape)return !1;
                p = !0
            }
            if (q) {
                if (o)return !1
            } else {
                if (o)return !0;
                if (p)return !1
            }
            j - 1 > r && this.lineStepBody.setCollidePosition(this.lineStepBody.x + k * this.lineStepLength, this.lineStepBody.y + l * this.lineStepLength)
        }
        return !0
    }, Phaser.TilemapCollisionLayer.prototype.hitLineSightCheck = function (a, b, c) {
        var d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t = [];
        if (!c) {
            var u = [];
            for (r = 0, s = b.length; s > r; r++)d = b[r], d.body.viewBlock && u.push(d);
            u.length > 0 && (b = u)
        }
        for (r = 0, s = b.length; s > r; r++) {
            if (d = b[r], f = d.body.getCenterXY(), g = f.x - a.x, h = f.y - a.y, 0 === g && 0 === h)t.push(d); else {
                i = Math.sqrt(g * g + h * h), m = Math.ceil(i / this.lineStepLength), j = Math.atan2(h, g), j = 0 > j ? 2 * Math.PI + j : j, this.lineStepBody.setCollidePosition(a.x, a.y), this.lineStepBody.setCollideAngle(j), k = Math.cos(j), l = Math.sin(j);
                for (var v = 0; m > v; v++) {
                    if (n = !1, d.body.wallShape) {
                        if (this.lineStepBody.isCollideCheck(d, !0))t.push(d), n = !0; else for (p = 0, q = b.length; q > p; p++)if (e = b[p], e !== d && e.body.viewBlock && this.lineStepBody.isCollideCheck(e, !0)) {
                            n = !0;
                            break
                        }
                    } else {
                        for (o = !1, p = 0, q = b.length; q > p && (e = b[p], !(e !== d && e.body.viewBlock && this.lineStepBody.isCollideCheck(e, !0) && (o = e.body.wallShape, n = !0, o))); p++);
                        !o && this.lineStepBody.isCollideCheck(d, !0) && (t.push(d), n = !0)
                    }
                    if (n)break;
                    m - 1 > v ? this.lineStepBody.setCollidePosition(this.lineStepBody.x + k * this.lineStepLength, this.lineStepBody.y + l * this.lineStepLength) : t.push(d)
                }
            }
            if (!c && t.length > 0)break
        }
        return t
    }, Phaser.TilemapCollisionLayer.prototype.getCollideObjects = function (a) {
        var b, c, d, e, f, g, h = [], i = a.x / this.map.tileWidth | 0, j = a.y / this.map.tileHalfHeight | 0, k = Math.floor((a.width + a.height) / (this.map.tileWidth + this.map.tileHeight));
        i -= 1 + k, b = i + 3 + 2 * k, j -= 2 + k, c = j + 5 + 2 * k;
        for (var l = j; c > l; l++)for (var m = i; b > m; m++)if (d = this.map.getCollisionObjectsByNormalTileXY(m, l))for (e = 0, f = d.length; f > e; e++)g = d[e], a.isCollideCheck(g, !0) && h.push(g);
        return h
    }, Phaser.TilemapCollisionLayer.prototype.getCollisionTile = function (a, b) {
        return this.map.getTile(a, b)
    }, Phaser.TilemapCollisionLayer.prototype.getFreePlace = function (a, b) {
        var c = this.map.getNormalFromWorld(a, b), d = this.getFreeTileBySpire(c.x, c.y);
        return d ? this.map.getWorldFromIsoTileXY(d.x, d.y) : null
    }, Phaser.TilemapCollisionLayer.prototype.getFreeTileBySpire = function (a, b, c) {
        for (var d, e, f, g, h, i, j = !0, k = 1, l = 0, m = c ? c : 1; 64 > m;) {
            if (a >= 0 && a < this.map.width && b >= 0 && b < this.map.height && (d = (a - b + this.width) / 2 | 0, e = a + b, i = !1, f = this.getCollisionTile(d, e), f && 0 === f.cI && this.map.moveBlockIndexes[f.cI] && (i = !0), !i)) {
                if (g = this.map.getCollisionObjectsByNormalTileXY(d, e))for (var n = 0, o = g.length; o > n; n++)if (h = g[n], h.isPathFindNotWalkable()) {
                    i = !0;
                    break
                }
                if (!i)return {x: a, y: b}
            }
            j ? a += k : b += k, l++, l >= m && (j || (k = -k, m++), j = !j, l = 0)
        }
        return null
    }, Phaser.TilemapCollisionLayer.prototype.findPathCheck = function (a) {
        var b, c, d, e, f, g, h, i, j, k = a.oldPos.x + a.anchor.x * -a.width, l = a.oldPos.y + a.anchor.y * -a.height, m = a.x / this.map.tileWidth | 0, n = a.y / this.map.tileHalfHeight | 0, o = Math.floor((a.width + a.height) / (this.map.tileWidth + this.map.tileHeight)) + 1;
        m -= 1 + o, b = m + 3 + 2 * o, n -= 2 + o, c = n + 5 + 2 * o;
        for (var p = n; c > p; p++)for (var q = m; b > q; q++) {
            if (d = this.getCollisionTile(q, p), d && d.cI && (this.map.viewBlockIndexes[d.cI] || this.map.moveBlockIndexes[d.cI]) && this.map.blockImageDatas[d.cI])for (h = 0, i = a.pathTry.length; i > h; h++)j = a.pathTry[h], j.block || Phaser.isPixelCollision(this.map.blockImageDatas[d.cI], d.wX, d.wY, a.collideImageData, k + j.x | 0, l + j.y | 0, !1) && (j.block = !0);
            if (e = this.map.getCollisionObjectsByNormalTileXY(q, p))for (f = 0, g = e.length; g > f; f++)a.stepCheck(e[f])
        }
        return !1
    }, Phaser.TilemapCollisionLayer.prototype.objectCollisionCheck = function (a, b) {
        //RIM
        //return true;
        //RIM
        "undefined" == typeof b && (b = !1);
        var c = a.body;
        if (a.viewZoneCheck && KME.world.view.isCollide(c))return c.collideBlockTile(), !0;
        var d, e, f, g, h, i, j, k = c.x + c.anchor.x * -c.width, l = c.y + c.anchor.y * -c.height, m = c.x / this.map.tileWidth | 0, n = c.y / this.map.tileHalfHeight | 0, o = Math.floor((c.width + c.height) / (this.map.tileWidth + this.map.tileHeight)) + 1;
        m -= 1 + o, d = m + 3 + 2 * o, n -= 2 + o, e = n + 5 + 2 * o;
        for (var p = n; e > p; p++)for (var q = m; d > q; q++) {
            if (f = this.getCollisionTile(q, p), f && f.cI && (b || this.map.viewBlockIndexes[f.cI] || this.map.moveBlockIndexes[f.cI] && (c.moveBlock || b)) && this.map.blockImageDatas[f.cI] && Phaser.isPixelCollision(this.map.blockImageDatas[f.cI], f.wX, f.wY, c.collideImageData, k, l, !1))return b || c.collideBlockTile(), !0;
            if (g = this.map.getCollisionObjectsByNormalTileXY(q, p))for (h = 0, i = g.length; i > h; h++)if (j = g[h], c.isCollideCheck(j, b))return b || c.collideObject(j), !0
        }
        return !1
    }, Phaser.TilemapCollisionLayer.prototype.busyTileForObjectPlace = function (a) {
        var b = this.getCollisionTile(a.normalPoint.nX, a.normalPoint.nY);
        return b && b.cI ? !0 : !1
    }, Phaser.TilemapCollisionLayer.prototype.init = function (a) {
        this.resizeWorld(), this.collisionDebug = a
    }, Phaser.TilemapCollisionLayer.prototype.render = function () {
    }, Phaser.TilemapCollisionLayer.prototype.getTiles = function (a, b, c, d) {
        var e, f = [], g = a / this.map.tileWidth | 0, h = g + c / this.map.tileWidth | 0, i = b / (this.map.tileHeight / 2) | 0, j = i + d / (this.map.tileHeight / 2) | 0;
        g -= 1, h += 2, i -= 1, j += 2;
        for (var k = i; j > k; k++)for (var l = g; h > l; l++)e = this.getCollisionTile(l, k), e && e.cI && f.push(e);
        return f
    }, Phaser.TilemapCollisionLayer.prototype.getTilesArea = function (a, b, c, d) {
        var e, f, g, h = a / this.map.tileWidth | 0, i = b / this.map.tileHalfHeight | 0, j = Math.floor((c + d) / (this.map.tileWidth + this.map.tileHeight));
        h -= 1 + j, e = h + 3 + 2 * j, i -= 2 + j, f = i + 5 + 2 * j;
        for (var k = [], l = i; f > l; l++)for (var m = h; e > m; m++)g = this.getCollisionTile(m, l), g && g.cI && k.push(g);
        return k
    }
}), define("KME/phext/phext", ["phaser", "./BodyIsometric", "./CollisionIsometric", "./TileIsometric", "./TilemapIsometric", "./TilemapBackgroundLayer", "./TilemapCollisionLayer"], function () {
}), define("KME/controllers/controllers", ["require", "./game/GameController", "./input/InputController", "./network/NetworkController", "./sound/SoundController", "./interface/InterfaceController", "./data/DataController"], function (a) {
    window.KME.controllers = {
        game: a("./game/GameController"),
        input: a("./input/InputController"),
        network: a("./network/NetworkController"),
        sound: a("./sound/SoundController"),
        ui: a("./interface/InterfaceController"),
        data: a("./data/DataController")
    }
}), define("KME/controllers/Controllers", function () {
}), define("modernizr", [], function () {
    return window.Modernizr = function (a, b, c) {
        function d(a) {
            n.cssText = a
        }

        function e(a, b) {
            return typeof a === b
        }

        var f, g, h, i = "2.8.3", j = {}, k = b.documentElement, l = "modernizr", m = b.createElement(l), n = m.style, o = ({}.toString, " -webkit- -moz- -o- -ms- ".split(" ")), p = {}, q = [], r = q.slice, s = function (a, c, d, e) {
            var f, g, h, i, j = b.createElement("div"), m = b.body, n = m || b.createElement("body");
            if (parseInt(d, 10))for (; d--;)h = b.createElement("div"), h.id = e ? e[d] : l + (d + 1), j.appendChild(h);
            return f = ["&#173;", '<style id="s', l, '">', a, "</style>"].join(""), j.id = l, (m ? j : n).innerHTML += f, n.appendChild(j), m || (n.style.background = "", n.style.overflow = "hidden", i = k.style.overflow, k.style.overflow = "hidden", k.appendChild(n)), g = c(j, a), m ? j.parentNode.removeChild(j) : (n.parentNode.removeChild(n), k.style.overflow = i), !!g
        }, t = {}.hasOwnProperty;
        h = e(t, "undefined") || e(t.call, "undefined") ? function (a, b) {
            return b in a && e(a.constructor.prototype[b], "undefined")
        } : function (a, b) {
            return t.call(a, b)
        }, Function.prototype.bind || (Function.prototype.bind = function (a) {
            var b = this;
            if ("function" != typeof b)throw new TypeError;
            var c = r.call(arguments, 1), d = function () {
                if (this instanceof d) {
                    var e = function () {
                    };
                    e.prototype = b.prototype;
                    var f = new e, g = b.apply(f, c.concat(r.call(arguments)));
                    return Object(g) === g ? g : f
                }
                return b.apply(a, c.concat(r.call(arguments)))
            };
            return d
        }), p.webgl = function () {
            return !!a.WebGLRenderingContext
        }, p.touch = function () {
            var c;
            return "ontouchstart" in a || a.DocumentTouch && b instanceof DocumentTouch ? c = !0 : s(["@media (", o.join("touch-enabled),("), l, ")", "{#modernizr{top:9px;position:absolute}}"].join(""), function (a) {
                c = 9 === a.offsetTop
            }), c
        };
        for (var u in p)h(p, u) && (g = u.toLowerCase(), j[g] = p[u](), q.push((j[g] ? "" : "no-") + g));
        return j.addTest = function (a, b) {
            if ("object" == typeof a)for (var d in a)h(a, d) && j.addTest(d, a[d]); else {
                if (a = a.toLowerCase(), j[a] !== c)return j;
                b = "function" == typeof b ? b() : b, "undefined" != typeof enableClasses && enableClasses && (k.className += " " + (b ? "" : "no-") + a), j[a] = b
            }
            return j
        }, d(""), m = f = null, function (a, b) {
            function c(a, b) {
                var c = a.createElement("p"), d = a.getElementsByTagName("head")[0] || a.documentElement;
                return c.innerHTML = "x<style>" + b + "</style>", d.insertBefore(c.lastChild, d.firstChild)
            }

            function d() {
                var a = s.elements;
                return "string" == typeof a ? a.split(" ") : a
            }

            function e(a) {
                var b = r[a[p]];
                return b || (b = {}, q++, a[p] = q, r[q] = b), b
            }

            function f(a, c, d) {
                if (c || (c = b), k)return c.createElement(a);
                d || (d = e(c));
                var f;
                return f = d.cache[a] ? d.cache[a].cloneNode() : o.test(a) ? (d.cache[a] = d.createElem(a)).cloneNode() : d.createElem(a), !f.canHaveChildren || n.test(a) || f.tagUrn ? f : d.frag.appendChild(f)
            }

            function g(a, c) {
                if (a || (a = b), k)return a.createDocumentFragment();
                c = c || e(a);
                for (var f = c.frag.cloneNode(), g = 0, h = d(), i = h.length; i > g; g++)f.createElement(h[g]);
                return f
            }

            function h(a, b) {
                b.cache || (b.cache = {}, b.createElem = a.createElement, b.createFrag = a.createDocumentFragment, b.frag = b.createFrag()), a.createElement = function (c) {
                    return s.shivMethods ? f(c, a, b) : b.createElem(c)
                }, a.createDocumentFragment = Function("h,f", "return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&(" + d().join().replace(/[\w\-]+/g, function (a) {
                        return b.createElem(a), b.frag.createElement(a), 'c("' + a + '")'
                    }) + ");return n}")(s, b.frag)
            }

            function i(a) {
                a || (a = b);
                var d = e(a);
                return s.shivCSS && !j && !d.hasCSS && (d.hasCSS = !!c(a, "article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")), k || h(a, d), a
            }

            var j, k, l = "3.7.0", m = a.html5 || {}, n = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i, o = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i, p = "_html5shiv", q = 0, r = {};
            !function () {
                try {
                    var a = b.createElement("a");
                    a.innerHTML = "<xyz></xyz>", j = "hidden" in a, k = 1 == a.childNodes.length || function () {
                            b.createElement("a");
                            var a = b.createDocumentFragment();
                            return "undefined" == typeof a.cloneNode || "undefined" == typeof a.createDocumentFragment || "undefined" == typeof a.createElement
                        }()
                } catch (c) {
                    j = !0, k = !0
                }
            }();
            var s = {
                elements: m.elements || "abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",
                version: l,
                shivCSS: m.shivCSS !== !1,
                supportsUnknownElements: k,
                shivMethods: m.shivMethods !== !1,
                type: "default",
                shivDocument: i,
                createElement: f,
                createDocumentFragment: g
            };
            a.html5 = s, i(b)
        }(this, b), j._version = i, j._prefixes = o, j.testStyles = s, j
    }(this, this.document), function (a, b, c) {
        function d(a) {
            return "[object Function]" == q.call(a)
        }

        function e(a) {
            return "string" == typeof a
        }

        function f() {
        }

        function g(a) {
            return !a || "loaded" == a || "complete" == a || "uninitialized" == a
        }

        function h() {
            var a = r.shift();
            s = 1, a ? a.t ? o(function () {
                ("c" == a.t ? m.injectCss : m.injectJs)(a.s, 0, a.a, a.x, a.e, 1)
            }, 0) : (a(), h()) : s = 0
        }

        function i(a, c, d, e, f, i, j) {
            function k(b) {
                if (!n && g(l.readyState) && (t.r = n = 1, !s && h(), l.onload = l.onreadystatechange = null, b)) {
                    "img" != a && o(function () {
                        v.removeChild(l)
                    }, 50);
                    for (var d in A[c])A[c].hasOwnProperty(d) && A[c][d].onload()
                }
            }

            var j = j || m.errorTimeout, l = b.createElement(a), n = 0, q = 0, t = {t: d, s: c, e: f, a: i, x: j};
            1 === A[c] && (q = 1, A[c] = []), "object" == a ? l.data = c : (l.src = c, l.type = a), l.width = l.height = "0", l.onerror = l.onload = l.onreadystatechange = function () {
                k.call(this, q)
            }, r.splice(e, 0, t), "img" != a && (q || 2 === A[c] ? (v.insertBefore(l, u ? null : p), o(k, j)) : A[c].push(l))
        }

        function j(a, b, c, d, f) {
            return s = 0, b = b || "j", e(a) ? i("c" == b ? x : w, a, b, this.i++, c, d, f) : (r.splice(this.i++, 0, a), 1 == r.length && h()), this
        }

        function k() {
            var a = m;
            return a.loader = {load: j, i: 0}, a
        }

        var l, m, n = b.documentElement, o = a.setTimeout, p = b.getElementsByTagName("script")[0], q = {}.toString, r = [], s = 0, t = "MozAppearance" in n.style, u = t && !!b.createRange().compareNode, v = u ? n : p.parentNode, n = a.opera && "[object Opera]" == q.call(a.opera), n = !!b.attachEvent && !n, w = t ? "object" : n ? "script" : "img", x = n ? "script" : w, y = Array.isArray || function (a) {
                return "[object Array]" == q.call(a)
            }, z = [], A = {}, B = {
            timeout: function (a, b) {
                return b.length && (a.timeout = b[0]), a
            }
        };
        m = function (a) {
            function b(a) {
                var b, c, d, a = a.split("!"), e = z.length, f = a.pop(), g = a.length, f = {
                    url: f,
                    origUrl: f,
                    prefixes: a
                };
                for (c = 0; g > c; c++)d = a[c].split("="), (b = B[d.shift()]) && (f = b(f, d));
                for (c = 0; e > c; c++)f = z[c](f);
                return f
            }

            function g(a, e, f, g, h) {
                var i = b(a), j = i.autoCallback;
                i.url.split(".").pop().split("?").shift(), i.bypass || (e && (e = d(e) ? e : e[a] || e[g] || e[a.split("/").pop().split("?")[0]]), i.instead ? i.instead(a, e, f, g, h) : (A[i.url] ? i.noexec = !0 : A[i.url] = 1, f.load(i.url, i.forceCSS || !i.forceJS && "css" == i.url.split(".").pop().split("?").shift() ? "c" : c, i.noexec, i.attrs, i.timeout), (d(e) || d(j)) && f.load(function () {
                    k(), e && e(i.origUrl, h, g), j && j(i.origUrl, h, g), A[i.url] = 2
                })))
            }

            function h(a, b) {
                function c(a, c) {
                    if (a) {
                        if (e(a))c || (l = function () {
                            var a = [].slice.call(arguments);
                            m.apply(this, a), n()
                        }), g(a, l, b, 0, j); else if (Object(a) === a)for (i in h = function () {
                            var b, c = 0;
                            for (b in a)a.hasOwnProperty(b) && c++;
                            return c
                        }(), a)a.hasOwnProperty(i) && (!c && !--h && (d(l) ? l = function () {
                            var a = [].slice.call(arguments);
                            m.apply(this, a), n()
                        } : l[i] = function (a) {
                            return function () {
                                var b = [].slice.call(arguments);
                                a && a.apply(this, b), n()
                            }
                        }(m[i])), g(a[i], l, b, i, j))
                    } else!c && n()
                }

                var h, i, j = !!a.test, k = a.load || a.both, l = a.callback || f, m = l, n = a.complete || f;
                c(j ? a.yep : a.nope, !!k), k && c(k)
            }

            var i, j, l = this.yepnope.loader;
            if (e(a))g(a, 0, l, 0); else if (y(a))for (i = 0; i < a.length; i++)j = a[i], e(j) ? g(j, 0, l, 0) : y(j) ? m(j) : Object(j) === j && h(j, l); else Object(a) === a && h(a, l)
        }, m.addPrefix = function (a, b) {
            B[a] = b
        }, m.addFilter = function (a) {
            z.push(a)
        }, m.errorTimeout = 1e4, null == b.readyState && b.addEventListener && (b.readyState = "loading", b.addEventListener("DOMContentLoaded", l = function () {
            b.removeEventListener("DOMContentLoaded", l, 0), b.readyState = "complete"
        }, 0)), a.yepnope = k(), a.yepnope.executeStack = h, a.yepnope.injectJs = function (a, c, d, e, i, j) {
            var k, l, n = b.createElement("script"), e = e || m.errorTimeout;
            n.src = a;
            for (l in d)n.setAttribute(l, d[l]);
            c = j ? h : c || f, n.onreadystatechange = n.onload = function () {
                !k && g(n.readyState) && (k = 1, c(), n.onload = n.onreadystatechange = null)
            }, o(function () {
                k || (k = 1, c(1))
            }, e), i ? n.onload() : p.parentNode.insertBefore(n, p)
        }, a.yepnope.injectCss = function (a, c, d, e, g, i) {
            var j, e = b.createElement("link"), c = i ? h : c || f;
            e.href = a, e.rel = "stylesheet", e.type = "text/css";
            for (j in d)e.setAttribute(j, d[j]);
            g || (p.parentNode.insertBefore(e, p), o(c, 0))
        }
    }(this, document), Modernizr.load = function () {
        yepnope.apply(window, [].slice.call(arguments, 0))
    }, Modernizr.addTest("pointerevents", function () {
        var a, b = document.createElement("x"), c = document.documentElement, d = window.getComputedStyle;
        return "pointerEvents" in b.style ? (b.style.pointerEvents = "auto", b.style.pointerEvents = "x", c.appendChild(b), a = d && "auto" === d(b, "").pointerEvents, c.removeChild(b), !!a) : !1
    }), window.Modernizr
}), function () {
    function a(a) {
        var c = !1;
        return function () {
            if (c)throw new Error("Callback was already called.");
            c = !0, a.apply(b, arguments)
        }
    }

    var b, c, d = {};
    b = this, null != b && (c = b.async), d.noConflict = function () {
        return b.async = c, d
    };
    var e = Object.prototype.toString, f = Array.isArray || function (a) {
            return "[object Array]" === e.call(a)
        }, g = function (a, b) {
        if (a.forEach)return a.forEach(b);
        for (var c = 0; c < a.length; c += 1)b(a[c], c, a)
    }, h = function (a, b) {
        if (a.map)return a.map(b);
        var c = [];
        return g(a, function (a, d, e) {
            c.push(b(a, d, e))
        }), c
    }, i = function (a, b, c) {
        return a.reduce ? a.reduce(b, c) : (g(a, function (a, d, e) {
            c = b(c, a, d, e)
        }), c)
    }, j = function (a) {
        if (Object.keys)return Object.keys(a);
        var b = [];
        for (var c in a)a.hasOwnProperty(c) && b.push(c);
        return b
    };
    "undefined" != typeof process && process.nextTick ? (d.nextTick = process.nextTick, "undefined" != typeof setImmediate ? d.setImmediate = function (a) {
        setImmediate(a)
    } : d.setImmediate = d.nextTick) : "function" == typeof setImmediate ? (d.nextTick = function (a) {
        setImmediate(a)
    }, d.setImmediate = d.nextTick) : (d.nextTick = function (a) {
        setTimeout(a, 0)
    }, d.setImmediate = d.nextTick), d.each = function (b, c, d) {
        function e(a) {
            a ? (d(a), d = function () {
            }) : (f += 1, f >= b.length && d())
        }

        if (d = d || function () {
                }, !b.length)return d();
        var f = 0;
        g(b, function (b) {
            c(b, a(e))
        })
    }, d.forEach = d.each, d.eachSeries = function (a, b, c) {
        if (c = c || function () {
                }, !a.length)return c();
        var d = 0, e = function () {
            b(a[d], function (b) {
                b ? (c(b), c = function () {
                }) : (d += 1, d >= a.length ? c() : e())
            })
        };
        e()
    }, d.forEachSeries = d.eachSeries, d.eachLimit = function (a, b, c, d) {
        var e = k(b);
        e.apply(null, [a, c, d])
    }, d.forEachLimit = d.eachLimit;
    var k = function (a) {
        return function (b, c, d) {
            if (d = d || function () {
                    }, !b.length || 0 >= a)return d();
            var e = 0, f = 0, g = 0;
            !function h() {
                if (e >= b.length)return d();
                for (; a > g && f < b.length;)f += 1, g += 1, c(b[f - 1], function (a) {
                    a ? (d(a), d = function () {
                    }) : (e += 1, g -= 1, e >= b.length ? d() : h())
                })
            }()
        }
    }, l = function (a) {
        return function () {
            var b = Array.prototype.slice.call(arguments);
            return a.apply(null, [d.each].concat(b))
        }
    }, m = function (a, b) {
        return function () {
            var c = Array.prototype.slice.call(arguments);
            return b.apply(null, [k(a)].concat(c))
        }
    }, n = function (a) {
        return function () {
            var b = Array.prototype.slice.call(arguments);
            return a.apply(null, [d.eachSeries].concat(b))
        }
    }, o = function (a, b, c, d) {
        if (b = h(b, function (a, b) {
                return {index: b, value: a}
            }), d) {
            var e = [];
            a(b, function (a, b) {
                c(a.value, function (c, d) {
                    e[a.index] = d, b(c)
                })
            }, function (a) {
                d(a, e)
            })
        } else a(b, function (a, b) {
            c(a.value, function (a) {
                b(a)
            })
        })
    };
    d.map = l(o), d.mapSeries = n(o), d.mapLimit = function (a, b, c, d) {
        return p(b)(a, c, d)
    };
    var p = function (a) {
        return m(a, o)
    };
    d.reduce = function (a, b, c, e) {
        d.eachSeries(a, function (a, d) {
            c(b, a, function (a, c) {
                b = c, d(a)
            })
        }, function (a) {
            e(a, b)
        })
    }, d.inject = d.reduce, d.foldl = d.reduce, d.reduceRight = function (a, b, c, e) {
        var f = h(a, function (a) {
            return a
        }).reverse();
        d.reduce(f, b, c, e)
    }, d.foldr = d.reduceRight;
    var q = function (a, b, c, d) {
        var e = [];
        b = h(b, function (a, b) {
            return {index: b, value: a}
        }), a(b, function (a, b) {
            c(a.value, function (c) {
                c && e.push(a), b()
            })
        }, function (a) {
            d(h(e.sort(function (a, b) {
                return a.index - b.index
            }), function (a) {
                return a.value
            }))
        })
    };
    d.filter = l(q), d.filterSeries = n(q), d.select = d.filter, d.selectSeries = d.filterSeries;
    var r = function (a, b, c, d) {
        var e = [];
        b = h(b, function (a, b) {
            return {index: b, value: a}
        }), a(b, function (a, b) {
            c(a.value, function (c) {
                c || e.push(a), b()
            })
        }, function (a) {
            d(h(e.sort(function (a, b) {
                return a.index - b.index
            }), function (a) {
                return a.value
            }))
        })
    };
    d.reject = l(r), d.rejectSeries = n(r);
    var s = function (a, b, c, d) {
        a(b, function (a, b) {
            c(a, function (c) {
                c ? (d(a), d = function () {
                }) : b()
            })
        }, function (a) {
            d()
        })
    };
    d.detect = l(s), d.detectSeries = n(s), d.some = function (a, b, c) {
        d.each(a, function (a, d) {
            b(a, function (a) {
                a && (c(!0), c = function () {
                }), d()
            })
        }, function (a) {
            c(!1)
        })
    }, d.any = d.some, d.every = function (a, b, c) {
        d.each(a, function (a, d) {
            b(a, function (a) {
                a || (c(!1), c = function () {
                }), d()
            })
        }, function (a) {
            c(!0)
        })
    }, d.all = d.every, d.sortBy = function (a, b, c) {
        d.map(a, function (a, c) {
            b(a, function (b, d) {
                b ? c(b) : c(null, {value: a, criteria: d})
            })
        }, function (a, b) {
            if (a)return c(a);
            var d = function (a, b) {
                var c = a.criteria, d = b.criteria;
                return d > c ? -1 : c > d ? 1 : 0
            };
            c(null, h(b.sort(d), function (a) {
                return a.value
            }))
        })
    }, d.auto = function (a, b) {
        b = b || function () {
            };
        var c = j(a), e = c.length;
        if (!e)return b();
        var h = {}, k = [], l = function (a) {
            k.unshift(a)
        }, m = function (a) {
            for (var b = 0; b < k.length; b += 1)if (k[b] === a)return void k.splice(b, 1)
        }, n = function () {
            e--, g(k.slice(0), function (a) {
                a()
            })
        };
        l(function () {
            if (!e) {
                var a = b;
                b = function () {
                }, a(null, h)
            }
        }), g(c, function (c) {
            var e = f(a[c]) ? a[c] : [a[c]], k = function (a) {
                var e = Array.prototype.slice.call(arguments, 1);
                if (e.length <= 1 && (e = e[0]), a) {
                    var f = {};
                    g(j(h), function (a) {
                        f[a] = h[a]
                    }), f[c] = e, b(a, f), b = function () {
                    }
                } else h[c] = e, d.setImmediate(n)
            }, o = e.slice(0, Math.abs(e.length - 1)) || [], p = function () {
                return i(o, function (a, b) {
                        return a && h.hasOwnProperty(b)
                    }, !0) && !h.hasOwnProperty(c)
            };
            if (p())e[e.length - 1](k, h); else {
                var q = function () {
                    p() && (m(q), e[e.length - 1](k, h))
                };
                l(q)
            }
        })
    }, d.retry = function (a, b, c) {
        var e = 5, f = [];
        "function" == typeof a && (c = b, b = a, a = e), a = parseInt(a, 10) || e;
        var g = function (e, g) {
            for (var h = function (a, b) {
                return function (c) {
                    a(function (a, d) {
                        c(!a || b, {err: a, result: d})
                    }, g)
                }
            }; a;)f.push(h(b, !(a -= 1)));
            d.series(f, function (a, b) {
                b = b[b.length - 1], (e || c)(b.err, b.result)
            })
        };
        return c ? g() : g
    }, d.waterfall = function (a, b) {
        if (b = b || function () {
                }, !f(a)) {
            var c = new Error("First argument to waterfall must be an array of functions");
            return b(c)
        }
        if (!a.length)return b();
        var e = function (a) {
            return function (c) {
                if (c)b.apply(null, arguments), b = function () {
                }; else {
                    var f = Array.prototype.slice.call(arguments, 1), g = a.next();
                    g ? f.push(e(g)) : f.push(b), d.setImmediate(function () {
                        a.apply(null, f)
                    })
                }
            }
        };
        e(d.iterator(a))()
    };
    var t = function (a, b, c) {
        if (c = c || function () {
                }, f(b))a.map(b, function (a, b) {
            a && a(function (a) {
                var c = Array.prototype.slice.call(arguments, 1);
                c.length <= 1 && (c = c[0]), b.call(null, a, c)
            })
        }, c); else {
            var d = {};
            a.each(j(b), function (a, c) {
                b[a](function (b) {
                    var e = Array.prototype.slice.call(arguments, 1);
                    e.length <= 1 && (e = e[0]), d[a] = e, c(b)
                })
            }, function (a) {
                c(a, d)
            })
        }
    };
    d.parallel = function (a, b) {
        t({map: d.map, each: d.each}, a, b)
    }, d.parallelLimit = function (a, b, c) {
        t({map: p(b), each: k(b)}, a, c)
    }, d.series = function (a, b) {
        if (b = b || function () {
                }, f(a))d.mapSeries(a, function (a, b) {
            a && a(function (a) {
                var c = Array.prototype.slice.call(arguments, 1);
                c.length <= 1 && (c = c[0]), b.call(null, a, c)
            })
        }, b); else {
            var c = {};
            d.eachSeries(j(a), function (b, d) {
                a[b](function (a) {
                    var e = Array.prototype.slice.call(arguments, 1);
                    e.length <= 1 && (e = e[0]), c[b] = e, d(a)
                })
            }, function (a) {
                b(a, c)
            })
        }
    }, d.iterator = function (a) {
        var b = function (c) {
            var d = function () {
                return a.length && a[c].apply(null, arguments), d.next()
            };
            return d.next = function () {
                return c < a.length - 1 ? b(c + 1) : null
            }, d
        };
        return b(0)
    }, d.apply = function (a) {
        var b = Array.prototype.slice.call(arguments, 1);
        return function () {
            return a.apply(null, b.concat(Array.prototype.slice.call(arguments)))
        }
    };
    var u = function (a, b, c, d) {
        var e = [];
        a(b, function (a, b) {
            c(a, function (a, c) {
                e = e.concat(c || []), b(a)
            })
        }, function (a) {
            d(a, e)
        })
    };
    d.concat = l(u), d.concatSeries = n(u), d.whilst = function (a, b, c) {
        a() ? b(function (e) {
            return e ? c(e) : void d.whilst(a, b, c)
        }) : c()
    }, d.doWhilst = function (a, b, c) {
        a(function (e) {
            if (e)return c(e);
            var f = Array.prototype.slice.call(arguments, 1);
            b.apply(null, f) ? d.doWhilst(a, b, c) : c()
        })
    }, d.until = function (a, b, c) {
        a() ? c() : b(function (e) {
            return e ? c(e) : void d.until(a, b, c)
        })
    }, d.doUntil = function (a, b, c) {
        a(function (e) {
            if (e)return c(e);
            var f = Array.prototype.slice.call(arguments, 1);
            b.apply(null, f) ? c() : d.doUntil(a, b, c)
        })
    }, d.queue = function (b, c) {
        function e(a, b, c, e) {
            return a.started || (a.started = !0), f(b) || (b = [b]), 0 == b.length ? d.setImmediate(function () {
                a.drain && a.drain()
            }) : void g(b, function (b) {
                var f = {data: b, callback: "function" == typeof e ? e : null};
                c ? a.tasks.unshift(f) : a.tasks.push(f), a.saturated && a.tasks.length === a.concurrency && a.saturated(), d.setImmediate(a.process)
            })
        }

        void 0 === c && (c = 1);
        var h = 0, i = {
            tasks: [],
            concurrency: c,
            saturated: null,
            empty: null,
            drain: null,
            started: !1,
            paused: !1,
            push: function (a, b) {
                e(i, a, !1, b)
            },
            kill: function () {
                i.drain = null, i.tasks = []
            },
            unshift: function (a, b) {
                e(i, a, !0, b)
            },
            process: function () {
                if (!i.paused && h < i.concurrency && i.tasks.length) {
                    var c = i.tasks.shift();
                    i.empty && 0 === i.tasks.length && i.empty(), h += 1;
                    var d = function () {
                        h -= 1, c.callback && c.callback.apply(c, arguments), i.drain && i.tasks.length + h === 0 && i.drain(), i.process()
                    }, e = a(d);
                    b(c.data, e)
                }
            },
            length: function () {
                return i.tasks.length
            },
            running: function () {
                return h
            },
            idle: function () {
                return i.tasks.length + h === 0
            },
            pause: function () {
                i.paused !== !0 && (i.paused = !0)
            },
            resume: function () {
                if (i.paused !== !1) {
                    i.paused = !1;
                    for (var a = 1; a <= i.concurrency; a++)d.setImmediate(i.process)
                }
            }
        };
        return i
    }, d.priorityQueue = function (a, b) {
        function c(a, b) {
            return a.priority - b.priority
        }

        function e(a, b, c) {
            for (var d = -1, e = a.length - 1; e > d;) {
                var f = d + (e - d + 1 >>> 1);
                c(b, a[f]) >= 0 ? d = f : e = f - 1
            }
            return d
        }

        function h(a, b, h, i) {
            return a.started || (a.started = !0), f(b) || (b = [b]), 0 == b.length ? d.setImmediate(function () {
                a.drain && a.drain()
            }) : void g(b, function (b) {
                var f = {data: b, priority: h, callback: "function" == typeof i ? i : null};
                a.tasks.splice(e(a.tasks, f, c) + 1, 0, f), a.saturated && a.tasks.length === a.concurrency && a.saturated(), d.setImmediate(a.process)
            })
        }

        var i = d.queue(a, b);
        return i.push = function (a, b, c) {
            h(i, a, b, c)
        }, delete i.unshift, i
    }, d.cargo = function (a, b) {
        var c = !1, e = [], i = {
            tasks: e,
            payload: b,
            saturated: null,
            empty: null,
            drain: null,
            drained: !0,
            push: function (a, c) {
                f(a) || (a = [a]), g(a, function (a) {
                    e.push({
                        data: a,
                        callback: "function" == typeof c ? c : null
                    }), i.drained = !1, i.saturated && e.length === b && i.saturated()
                }), d.setImmediate(i.process)
            },
            process: function j() {
                if (!c) {
                    if (0 === e.length)return i.drain && !i.drained && i.drain(), void(i.drained = !0);
                    var d = "number" == typeof b ? e.splice(0, b) : e.splice(0, e.length), f = h(d, function (a) {
                        return a.data
                    });
                    i.empty && i.empty(), c = !0, a(f, function () {
                        c = !1;
                        var a = arguments;
                        g(d, function (b) {
                            b.callback && b.callback.apply(null, a)
                        }), j()
                    })
                }
            },
            length: function () {
                return e.length
            },
            running: function () {
                return c
            }
        };
        return i
    };
    var v = function (a) {
        return function (b) {
            var c = Array.prototype.slice.call(arguments, 1);
            b.apply(null, c.concat([function (b) {
                var c = Array.prototype.slice.call(arguments, 1);
                "undefined" != typeof console && (b ? console.error && console.error(b) : console[a] && g(c, function (b) {
                    console[a](b)
                }))
            }]))
        }
    };
    d.log = v("log"), d.dir = v("dir"), d.memoize = function (a, b) {
        var c = {}, e = {};
        b = b || function (a) {
                return a
            };
        var f = function () {
            var f = Array.prototype.slice.call(arguments), g = f.pop(), h = b.apply(null, f);
            h in c ? d.nextTick(function () {
                g.apply(null, c[h])
            }) : h in e ? e[h].push(g) : (e[h] = [g], a.apply(null, f.concat([function () {
                c[h] = arguments;
                var a = e[h];
                delete e[h];
                for (var b = 0, d = a.length; d > b; b++)a[b].apply(null, arguments)
            }])))
        };
        return f.memo = c, f.unmemoized = a, f
    }, d.unmemoize = function (a) {
        return function () {
            return (a.unmemoized || a).apply(null, arguments)
        }
    }, d.times = function (a, b, c) {
        for (var e = [], f = 0; a > f; f++)e.push(f);
        return d.map(e, b, c)
    }, d.timesSeries = function (a, b, c) {
        for (var e = [], f = 0; a > f; f++)e.push(f);
        return d.mapSeries(e, b, c)
    }, d.seq = function () {
        var a = arguments;
        return function () {
            var b = this, c = Array.prototype.slice.call(arguments), e = c.pop();
            d.reduce(a, c, function (a, c, d) {
                c.apply(b, a.concat([function () {
                    var a = arguments[0], b = Array.prototype.slice.call(arguments, 1);
                    d(a, b)
                }]))
            }, function (a, c) {
                e.apply(b, [a].concat(c))
            })
        }
    }, d.compose = function () {
        return d.seq.apply(null, Array.prototype.reverse.call(arguments))
    };
    var w = function (a, b) {
        var c = function () {
            var c = this, d = Array.prototype.slice.call(arguments), e = d.pop();
            return a(b, function (a, b) {
                a.apply(c, d.concat([b]))
            }, e)
        };
        if (arguments.length > 2) {
            var d = Array.prototype.slice.call(arguments, 2);
            return c.apply(this, d)
        }
        return c
    };
    d.applyEach = l(w), d.applyEachSeries = n(w), d.forever = function (a, b) {
        function c(d) {
            if (d) {
                if (b)return b(d);
                throw d
            }
            a(c)
        }

        c()
    }, "undefined" != typeof module && module.exports ? module.exports = d : "undefined" != typeof define && define.amd ? define("async", [], function () {
        return d
    }) : b.async = d
}();
var THREE = {REVISION: "78"};
"function" == typeof define && define.amd ? define("three", THREE) : "undefined" != typeof exports && "undefined" != typeof module && (module.exports = THREE), void 0 === Number.EPSILON && (Number.EPSILON = Math.pow(2, -52)), void 0 === Math.sign && (Math.sign = function (a) {
    return 0 > a ? -1 : a > 0 ? 1 : +a
}), void 0 === Function.prototype.name && Object.defineProperty(Function.prototype, "name", {
    get: function () {
        return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]
    }
}), void 0 === Object.assign && !function () {
    Object.assign = function (a) {
        "use strict";
        if (void 0 === a || null === a)throw new TypeError("Cannot convert undefined or null to object");
        for (var b = Object(a), c = 1; c < arguments.length; c++) {
            var d = arguments[c];
            if (void 0 !== d && null !== d)for (var e in d)Object.prototype.hasOwnProperty.call(d, e) && (b[e] = d[e])
        }
        return b
    }
}(), Object.assign(THREE, {
    MOUSE: {LEFT: 0, MIDDLE: 1, RIGHT: 2},
    CullFaceNone: 0,
    CullFaceBack: 1,
    CullFaceFront: 2,
    CullFaceFrontBack: 3,
    FrontFaceDirectionCW: 0,
    FrontFaceDirectionCCW: 1,
    BasicShadowMap: 0,
    PCFShadowMap: 1,
    PCFSoftShadowMap: 2,
    FrontSide: 0,
    BackSide: 1,
    DoubleSide: 2,
    FlatShading: 1,
    SmoothShading: 2,
    NoColors: 0,
    FaceColors: 1,
    VertexColors: 2,
    NoBlending: 0,
    NormalBlending: 1,
    AdditiveBlending: 2,
    SubtractiveBlending: 3,
    MultiplyBlending: 4,
    CustomBlending: 5,
    AddEquation: 100,
    SubtractEquation: 101,
    ReverseSubtractEquation: 102,
    MinEquation: 103,
    MaxEquation: 104,
    ZeroFactor: 200,
    OneFactor: 201,
    SrcColorFactor: 202,
    OneMinusSrcColorFactor: 203,
    SrcAlphaFactor: 204,
    OneMinusSrcAlphaFactor: 205,
    DstAlphaFactor: 206,
    OneMinusDstAlphaFactor: 207,
    DstColorFactor: 208,
    OneMinusDstColorFactor: 209,
    SrcAlphaSaturateFactor: 210,
    NeverDepth: 0,
    AlwaysDepth: 1,
    LessDepth: 2,
    LessEqualDepth: 3,
    EqualDepth: 4,
    GreaterEqualDepth: 5,
    GreaterDepth: 6,
    NotEqualDepth: 7,
    MultiplyOperation: 0,
    MixOperation: 1,
    AddOperation: 2,
    NoToneMapping: 0,
    LinearToneMapping: 1,
    ReinhardToneMapping: 2,
    Uncharted2ToneMapping: 3,
    CineonToneMapping: 4,
    UVMapping: 300,
    CubeReflectionMapping: 301,
    CubeRefractionMapping: 302,
    EquirectangularReflectionMapping: 303,
    EquirectangularRefractionMapping: 304,
    SphericalReflectionMapping: 305,
    CubeUVReflectionMapping: 306,
    CubeUVRefractionMapping: 307,
    RepeatWrapping: 1e3,
    ClampToEdgeWrapping: 1001,
    MirroredRepeatWrapping: 1002,
    NearestFilter: 1003,
    NearestMipMapNearestFilter: 1004,
    NearestMipMapLinearFilter: 1005,
    LinearFilter: 1006,
    LinearMipMapNearestFilter: 1007,
    LinearMipMapLinearFilter: 1008,
    UnsignedByteType: 1009,
    ByteType: 1010,
    ShortType: 1011,
    UnsignedShortType: 1012,
    IntType: 1013,
    UnsignedIntType: 1014,
    FloatType: 1015,
    HalfFloatType: 1025,
    UnsignedShort4444Type: 1016,
    UnsignedShort5551Type: 1017,
    UnsignedShort565Type: 1018,
    AlphaFormat: 1019,
    RGBFormat: 1020,
    RGBAFormat: 1021,
    LuminanceFormat: 1022,
    LuminanceAlphaFormat: 1023,
    RGBEFormat: THREE.RGBAFormat,
    DepthFormat: 1026,
    RGB_S3TC_DXT1_Format: 2001,
    RGBA_S3TC_DXT1_Format: 2002,
    RGBA_S3TC_DXT3_Format: 2003,
    RGBA_S3TC_DXT5_Format: 2004,
    RGB_PVRTC_4BPPV1_Format: 2100,
    RGB_PVRTC_2BPPV1_Format: 2101,
    RGBA_PVRTC_4BPPV1_Format: 2102,
    RGBA_PVRTC_2BPPV1_Format: 2103,
    RGB_ETC1_Format: 2151,
    LoopOnce: 2200,
    LoopRepeat: 2201,
    LoopPingPong: 2202,
    InterpolateDiscrete: 2300,
    InterpolateLinear: 2301,
    InterpolateSmooth: 2302,
    ZeroCurvatureEnding: 2400,
    ZeroSlopeEnding: 2401,
    WrapAroundEnding: 2402,
    TrianglesDrawMode: 0,
    TriangleStripDrawMode: 1,
    TriangleFanDrawMode: 2,
    LinearEncoding: 3e3,
    sRGBEncoding: 3001,
    GammaEncoding: 3007,
    RGBEEncoding: 3002,
    LogLuvEncoding: 3003,
    RGBM7Encoding: 3004,
    RGBM16Encoding: 3005,
    RGBDEncoding: 3006,
    BasicDepthPacking: 3200,
    RGBADepthPacking: 3201
}), THREE.Color = function (a, b, c) {
    return void 0 === b && void 0 === c ? this.set(a) : this.setRGB(a, b, c)
}, THREE.Color.prototype = {
    constructor: THREE.Color, r: 1, g: 1, b: 1, set: function (a) {
        return a instanceof THREE.Color ? this.copy(a) : "number" == typeof a ? this.setHex(a) : "string" == typeof a && this.setStyle(a), this
    }, setScalar: function (a) {
        this.r = a, this.g = a, this.b = a
    }, setHex: function (a) {
        return a = Math.floor(a), this.r = (a >> 16 & 255) / 255, this.g = (a >> 8 & 255) / 255, this.b = (255 & a) / 255, this
    }, setRGB: function (a, b, c) {
        return this.r = a, this.g = b, this.b = c, this
    }, setHSL: function () {
        function a(a, b, c) {
            return 0 > c && (c += 1), c > 1 && (c -= 1), 1 / 6 > c ? a + 6 * (b - a) * c : .5 > c ? b : 2 / 3 > c ? a + 6 * (b - a) * (2 / 3 - c) : a
        }

        return function (b, c, d) {
            if (b = THREE.Math.euclideanModulo(b, 1), c = THREE.Math.clamp(c, 0, 1), d = THREE.Math.clamp(d, 0, 1), 0 === c)this.r = this.g = this.b = d; else {
                var e = .5 >= d ? d * (1 + c) : d + c - d * c, f = 2 * d - e;
                this.r = a(f, e, b + 1 / 3), this.g = a(f, e, b), this.b = a(f, e, b - 1 / 3)
            }
            return this
        }
    }(), setStyle: function (a) {
        function b(b) {
            void 0 !== b && parseFloat(b) < 1 && console.warn("THREE.Color: Alpha component of " + a + " will be ignored.")
        }

        var c;
        if (c = /^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)) {
            var d, e = c[1], f = c[2];
            switch (e) {
                case"rgb":
                case"rgba":
                    if (d = /^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(f))return this.r = Math.min(255, parseInt(d[1], 10)) / 255, this.g = Math.min(255, parseInt(d[2], 10)) / 255, this.b = Math.min(255, parseInt(d[3], 10)) / 255, b(d[5]), this;
                    if (d = /^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(f))return this.r = Math.min(100, parseInt(d[1], 10)) / 100, this.g = Math.min(100, parseInt(d[2], 10)) / 100, this.b = Math.min(100, parseInt(d[3], 10)) / 100, b(d[5]), this;
                    break;
                case"hsl":
                case"hsla":
                    if (d = /^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(f)) {
                        var g = parseFloat(d[1]) / 360, h = parseInt(d[2], 10) / 100, i = parseInt(d[3], 10) / 100;
                        return b(d[5]), this.setHSL(g, h, i)
                    }
            }
        } else if (c = /^\#([A-Fa-f0-9]+)$/.exec(a)) {
            var j = c[1], k = j.length;
            if (3 === k)return this.r = parseInt(j.charAt(0) + j.charAt(0), 16) / 255, this.g = parseInt(j.charAt(1) + j.charAt(1), 16) / 255, this.b = parseInt(j.charAt(2) + j.charAt(2), 16) / 255, this;
            if (6 === k)return this.r = parseInt(j.charAt(0) + j.charAt(1), 16) / 255, this.g = parseInt(j.charAt(2) + j.charAt(3), 16) / 255, this.b = parseInt(j.charAt(4) + j.charAt(5), 16) / 255, this
        }
        if (a && a.length > 0) {
            var j = THREE.ColorKeywords[a];
            void 0 !== j ? this.setHex(j) : console.warn("THREE.Color: Unknown color " + a)
        }
        return this
    }, clone: function () {
        return new this.constructor(this.r, this.g, this.b)
    }, copy: function (a) {
        return this.r = a.r, this.g = a.g, this.b = a.b, this
    }, copyGammaToLinear: function (a, b) {
        return void 0 === b && (b = 2), this.r = Math.pow(a.r, b), this.g = Math.pow(a.g, b), this.b = Math.pow(a.b, b), this
    }, copyLinearToGamma: function (a, b) {
        void 0 === b && (b = 2);
        var c = b > 0 ? 1 / b : 1;
        return this.r = Math.pow(a.r, c), this.g = Math.pow(a.g, c), this.b = Math.pow(a.b, c), this
    }, convertGammaToLinear: function () {
        var a = this.r, b = this.g, c = this.b;
        return this.r = a * a, this.g = b * b, this.b = c * c, this
    }, convertLinearToGamma: function () {
        return this.r = Math.sqrt(this.r), this.g = Math.sqrt(this.g), this.b = Math.sqrt(this.b), this
    }, getHex: function () {
        return 255 * this.r << 16 ^ 255 * this.g << 8 ^ 255 * this.b << 0
    }, getHexString: function () {
        return ("000000" + this.getHex().toString(16)).slice(-6)
    }, getHSL: function (a) {
        var b, c, d = a || {
                h: 0,
                s: 0,
                l: 0
            }, e = this.r, f = this.g, g = this.b, h = Math.max(e, f, g), i = Math.min(e, f, g), j = (i + h) / 2;
        if (i === h)b = 0, c = 0; else {
            var k = h - i;
            switch (c = .5 >= j ? k / (h + i) : k / (2 - h - i), h) {
                case e:
                    b = (f - g) / k + (g > f ? 6 : 0);
                    break;
                case f:
                    b = (g - e) / k + 2;
                    break;
                case g:
                    b = (e - f) / k + 4
            }
            b /= 6
        }
        return d.h = b, d.s = c, d.l = j, d
    }, getStyle: function () {
        return "rgb(" + (255 * this.r | 0) + "," + (255 * this.g | 0) + "," + (255 * this.b | 0) + ")"
    }, offsetHSL: function (a, b, c) {
        var d = this.getHSL();
        return d.h += a, d.s += b, d.l += c, this.setHSL(d.h, d.s, d.l), this
    }, add: function (a) {
        return this.r += a.r, this.g += a.g, this.b += a.b, this
    }, addColors: function (a, b) {
        return this.r = a.r + b.r, this.g = a.g + b.g, this.b = a.b + b.b, this
    }, addScalar: function (a) {
        return this.r += a, this.g += a, this.b += a, this
    }, multiply: function (a) {
        return this.r *= a.r, this.g *= a.g, this.b *= a.b, this
    }, multiplyScalar: function (a) {
        return this.r *= a, this.g *= a, this.b *= a, this
    }, lerp: function (a, b) {
        return this.r += (a.r - this.r) * b, this.g += (a.g - this.g) * b, this.b += (a.b - this.b) * b, this
    }, equals: function (a) {
        return a.r === this.r && a.g === this.g && a.b === this.b
    }, fromArray: function (a, b) {
        return void 0 === b && (b = 0), this.r = a[b], this.g = a[b + 1], this.b = a[b + 2], this
    }, toArray: function (a, b) {
        return void 0 === a && (a = []), void 0 === b && (b = 0), a[b] = this.r, a[b + 1] = this.g, a[b + 2] = this.b, a
    }
}, THREE.ColorKeywords = {
    aliceblue: 15792383,
    antiquewhite: 16444375,
    aqua: 65535,
    aquamarine: 8388564,
    azure: 15794175,
    beige: 16119260,
    bisque: 16770244,
    black: 0,
    blanchedalmond: 16772045,
    blue: 255,
    blueviolet: 9055202,
    brown: 10824234,
    burlywood: 14596231,
    cadetblue: 6266528,
    chartreuse: 8388352,
    chocolate: 13789470,
    coral: 16744272,
    cornflowerblue: 6591981,
    cornsilk: 16775388,
    crimson: 14423100,
    cyan: 65535,
    darkblue: 139,
    darkcyan: 35723,
    darkgoldenrod: 12092939,
    darkgray: 11119017,
    darkgreen: 25600,
    darkgrey: 11119017,
    darkkhaki: 12433259,
    darkmagenta: 9109643,
    darkolivegreen: 5597999,
    darkorange: 16747520,
    darkorchid: 10040012,
    darkred: 9109504,
    darksalmon: 15308410,
    darkseagreen: 9419919,
    darkslateblue: 4734347,
    darkslategray: 3100495,
    darkslategrey: 3100495,
    darkturquoise: 52945,
    darkviolet: 9699539,
    deeppink: 16716947,
    deepskyblue: 49151,
    dimgray: 6908265,
    dimgrey: 6908265,
    dodgerblue: 2003199,
    firebrick: 11674146,
    floralwhite: 16775920,
    forestgreen: 2263842,
    fuchsia: 16711935,
    gainsboro: 14474460,
    ghostwhite: 16316671,
    gold: 16766720,
    goldenrod: 14329120,
    gray: 8421504,
    green: 32768,
    greenyellow: 11403055,
    grey: 8421504,
    honeydew: 15794160,
    hotpink: 16738740,
    indianred: 13458524,
    indigo: 4915330,
    ivory: 16777200,
    khaki: 15787660,
    lavender: 15132410,
    lavenderblush: 16773365,
    lawngreen: 8190976,
    lemonchiffon: 16775885,
    lightblue: 11393254,
    lightcoral: 15761536,
    lightcyan: 14745599,
    lightgoldenrodyellow: 16448210,
    lightgray: 13882323,
    lightgreen: 9498256,
    lightgrey: 13882323,
    lightpink: 16758465,
    lightsalmon: 16752762,
    lightseagreen: 2142890,
    lightskyblue: 8900346,
    lightslategray: 7833753,
    lightslategrey: 7833753,
    lightsteelblue: 11584734,
    lightyellow: 16777184,
    lime: 65280,
    limegreen: 3329330,
    linen: 16445670,
    magenta: 16711935,
    maroon: 8388608,
    mediumaquamarine: 6737322,
    mediumblue: 205,
    mediumorchid: 12211667,
    mediumpurple: 9662683,
    mediumseagreen: 3978097,
    mediumslateblue: 8087790,
    mediumspringgreen: 64154,
    mediumturquoise: 4772300,
    mediumvioletred: 13047173,
    midnightblue: 1644912,
    mintcream: 16121850,
    mistyrose: 16770273,
    moccasin: 16770229,
    navajowhite: 16768685,
    navy: 128,
    oldlace: 16643558,
    olive: 8421376,
    olivedrab: 7048739,
    orange: 16753920,
    orangered: 16729344,
    orchid: 14315734,
    palegoldenrod: 15657130,
    palegreen: 10025880,
    paleturquoise: 11529966,
    palevioletred: 14381203,
    papayawhip: 16773077,
    peachpuff: 16767673,
    peru: 13468991,
    pink: 16761035,
    plum: 14524637,
    powderblue: 11591910,
    purple: 8388736,
    red: 16711680,
    rosybrown: 12357519,
    royalblue: 4286945,
    saddlebrown: 9127187,
    salmon: 16416882,
    sandybrown: 16032864,
    seagreen: 3050327,
    seashell: 16774638,
    sienna: 10506797,
    silver: 12632256,
    skyblue: 8900331,
    slateblue: 6970061,
    slategray: 7372944,
    slategrey: 7372944,
    snow: 16775930,
    springgreen: 65407,
    steelblue: 4620980,
    tan: 13808780,
    teal: 32896,
    thistle: 14204888,
    tomato: 16737095,
    turquoise: 4251856,
    violet: 15631086,
    wheat: 16113331,
    white: 16777215,
    whitesmoke: 16119285,
    yellow: 16776960,
    yellowgreen: 10145074
}, THREE.Quaternion = function (a, b, c, d) {
    this._x = a || 0, this._y = b || 0, this._z = c || 0, this._w = void 0 !== d ? d : 1
}, THREE.Quaternion.prototype = {
    constructor: THREE.Quaternion, get x() {
        return this._x
    }, set x(a) {
        this._x = a, this.onChangeCallback()
    }, get y() {
        return this._y
    }, set y(a) {
        this._y = a, this.onChangeCallback()
    }, get z() {
        return this._z
    }, set z(a) {
        this._z = a, this.onChangeCallback()
    }, get w() {
        return this._w
    }, set w(a) {
        this._w = a, this.onChangeCallback()
    }, set: function (a, b, c, d) {
        return this._x = a, this._y = b, this._z = c, this._w = d, this.onChangeCallback(), this
    }, clone: function () {
        return new this.constructor(this._x, this._y, this._z, this._w)
    }, copy: function (a) {
        return this._x = a.x, this._y = a.y, this._z = a.z, this._w = a.w, this.onChangeCallback(), this
    }, setFromEuler: function (a, b) {
        if (a instanceof THREE.Euler == !1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
        var c = Math.cos(a._x / 2), d = Math.cos(a._y / 2), e = Math.cos(a._z / 2), f = Math.sin(a._x / 2), g = Math.sin(a._y / 2), h = Math.sin(a._z / 2), i = a.order;
        return "XYZ" === i ? (this._x = f * d * e + c * g * h, this._y = c * g * e - f * d * h, this._z = c * d * h + f * g * e, this._w = c * d * e - f * g * h) : "YXZ" === i ? (this._x = f * d * e + c * g * h, this._y = c * g * e - f * d * h, this._z = c * d * h - f * g * e, this._w = c * d * e + f * g * h) : "ZXY" === i ? (this._x = f * d * e - c * g * h, this._y = c * g * e + f * d * h, this._z = c * d * h + f * g * e, this._w = c * d * e - f * g * h) : "ZYX" === i ? (this._x = f * d * e - c * g * h, this._y = c * g * e + f * d * h, this._z = c * d * h - f * g * e, this._w = c * d * e + f * g * h) : "YZX" === i ? (this._x = f * d * e + c * g * h, this._y = c * g * e + f * d * h, this._z = c * d * h - f * g * e, this._w = c * d * e - f * g * h) : "XZY" === i && (this._x = f * d * e - c * g * h, this._y = c * g * e - f * d * h, this._z = c * d * h + f * g * e, this._w = c * d * e + f * g * h), b !== !1 && this.onChangeCallback(), this
    }, setFromAxisAngle: function (a, b) {
        var c = b / 2, d = Math.sin(c);
        return this._x = a.x * d, this._y = a.y * d, this._z = a.z * d, this._w = Math.cos(c), this.onChangeCallback(), this
    }, setFromRotationMatrix: function (a) {
        var b, c = a.elements, d = c[0], e = c[4], f = c[8], g = c[1], h = c[5], i = c[9], j = c[2], k = c[6], l = c[10], m = d + h + l;
        return m > 0 ? (b = .5 / Math.sqrt(m + 1), this._w = .25 / b, this._x = (k - i) * b, this._y = (f - j) * b, this._z = (g - e) * b) : d > h && d > l ? (b = 2 * Math.sqrt(1 + d - h - l), this._w = (k - i) / b, this._x = .25 * b, this._y = (e + g) / b, this._z = (f + j) / b) : h > l ? (b = 2 * Math.sqrt(1 + h - d - l), this._w = (f - j) / b, this._x = (e + g) / b, this._y = .25 * b, this._z = (i + k) / b) : (b = 2 * Math.sqrt(1 + l - d - h), this._w = (g - e) / b, this._x = (f + j) / b, this._y = (i + k) / b, this._z = .25 * b), this.onChangeCallback(), this
    }, setFromUnitVectors: function () {
        var a, b, c = 1e-6;
        return function (d, e) {
            return void 0 === a && (a = new THREE.Vector3), b = d.dot(e) + 1, c > b ? (b = 0, Math.abs(d.x) > Math.abs(d.z) ? a.set(-d.y, d.x, 0) : a.set(0, -d.z, d.y)) : a.crossVectors(d, e), this._x = a.x, this._y = a.y, this._z = a.z, this._w = b, this.normalize()
        }
    }(), inverse: function () {
        return this.conjugate().normalize()
    }, conjugate: function () {
        return this._x *= -1, this._y *= -1, this._z *= -1, this.onChangeCallback(), this
    }, dot: function (a) {
        return this._x * a._x + this._y * a._y + this._z * a._z + this._w * a._w
    }, lengthSq: function () {
        return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w
    }, length: function () {
        return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w)
    }, normalize: function () {
        var a = this.length();
        return 0 === a ? (this._x = 0, this._y = 0, this._z = 0, this._w = 1) : (a = 1 / a, this._x = this._x * a, this._y = this._y * a, this._z = this._z * a, this._w = this._w * a), this.onChangeCallback(), this
    }, multiply: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."), this.multiplyQuaternions(a, b)) : this.multiplyQuaternions(this, a)
    }, premultiply: function (a) {
        return this.multiplyQuaternions(a, this)
    }, multiplyQuaternions: function (a, b) {
        var c = a._x, d = a._y, e = a._z, f = a._w, g = b._x, h = b._y, i = b._z, j = b._w;
        return this._x = c * j + f * g + d * i - e * h, this._y = d * j + f * h + e * g - c * i, this._z = e * j + f * i + c * h - d * g, this._w = f * j - c * g - d * h - e * i, this.onChangeCallback(), this
    }, slerp: function (a, b) {
        if (0 === b)return this;
        if (1 === b)return this.copy(a);
        var c = this._x, d = this._y, e = this._z, f = this._w, g = f * a._w + c * a._x + d * a._y + e * a._z;
        if (0 > g ? (this._w = -a._w, this._x = -a._x, this._y = -a._y, this._z = -a._z, g = -g) : this.copy(a), g >= 1)return this._w = f, this._x = c, this._y = d, this._z = e, this;
        var h = Math.sqrt(1 - g * g);
        if (Math.abs(h) < .001)return this._w = .5 * (f + this._w), this._x = .5 * (c + this._x), this._y = .5 * (d + this._y), this._z = .5 * (e + this._z), this;
        var i = Math.atan2(h, g), j = Math.sin((1 - b) * i) / h, k = Math.sin(b * i) / h;
        return this._w = f * j + this._w * k, this._x = c * j + this._x * k, this._y = d * j + this._y * k, this._z = e * j + this._z * k, this.onChangeCallback(), this
    }, equals: function (a) {
        return a._x === this._x && a._y === this._y && a._z === this._z && a._w === this._w
    }, fromArray: function (a, b) {
        return void 0 === b && (b = 0), this._x = a[b], this._y = a[b + 1], this._z = a[b + 2], this._w = a[b + 3], this.onChangeCallback(), this
    }, toArray: function (a, b) {
        return void 0 === a && (a = []), void 0 === b && (b = 0), a[b] = this._x, a[b + 1] = this._y, a[b + 2] = this._z, a[b + 3] = this._w, a
    }, onChange: function (a) {
        return this.onChangeCallback = a, this
    }, onChangeCallback: function () {
    }
}, Object.assign(THREE.Quaternion, {
    slerp: function (a, b, c, d) {
        return c.copy(a).slerp(b, d)
    }, slerpFlat: function (a, b, c, d, e, f, g) {
        var h = c[d + 0], i = c[d + 1], j = c[d + 2], k = c[d + 3], l = e[f + 0], m = e[f + 1], n = e[f + 2], o = e[f + 3];
        if (k !== o || h !== l || i !== m || j !== n) {
            var p = 1 - g, q = h * l + i * m + j * n + k * o, r = q >= 0 ? 1 : -1, s = 1 - q * q;
            if (s > Number.EPSILON) {
                var t = Math.sqrt(s), u = Math.atan2(t, q * r);
                p = Math.sin(p * u) / t, g = Math.sin(g * u) / t
            }
            var v = g * r;
            if (h = h * p + l * v, i = i * p + m * v, j = j * p + n * v, k = k * p + o * v, p === 1 - g) {
                var w = 1 / Math.sqrt(h * h + i * i + j * j + k * k);
                h *= w, i *= w, j *= w, k *= w
            }
        }
        a[b] = h, a[b + 1] = i, a[b + 2] = j, a[b + 3] = k
    }
}), THREE.Vector2 = function (a, b) {
    this.x = a || 0, this.y = b || 0
}, THREE.Vector2.prototype = {
    constructor: THREE.Vector2, get width() {
        return this.x
    }, set width(a) {
        this.x = a
    }, get height() {
        return this.y
    }, set height(a) {
        this.y = a
    }, set: function (a, b) {
        return this.x = a, this.y = b, this
    }, setScalar: function (a) {
        return this.x = a, this.y = a, this
    }, setX: function (a) {
        return this.x = a, this
    }, setY: function (a) {
        return this.y = a, this
    }, setComponent: function (a, b) {
        switch (a) {
            case 0:
                this.x = b;
                break;
            case 1:
                this.y = b;
                break;
            default:
                throw new Error("index is out of range: " + a)
        }
    }, getComponent: function (a) {
        switch (a) {
            case 0:
                return this.x;
            case 1:
                return this.y;
            default:
                throw new Error("index is out of range: " + a)
        }
    }, clone: function () {
        return new this.constructor(this.x, this.y)
    }, copy: function (a) {
        return this.x = a.x, this.y = a.y, this
    }, add: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(a, b)) : (this.x += a.x, this.y += a.y, this)
    }, addScalar: function (a) {
        return this.x += a, this.y += a, this
    }, addVectors: function (a, b) {
        return this.x = a.x + b.x, this.y = a.y + b.y, this
    }, addScaledVector: function (a, b) {
        return this.x += a.x * b, this.y += a.y * b, this
    }, sub: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(a, b)) : (this.x -= a.x, this.y -= a.y, this)
    }, subScalar: function (a) {
        return this.x -= a, this.y -= a, this
    }, subVectors: function (a, b) {
        return this.x = a.x - b.x, this.y = a.y - b.y, this
    }, multiply: function (a) {
        return this.x *= a.x, this.y *= a.y, this
    }, multiplyScalar: function (a) {
        return isFinite(a) ? (this.x *= a, this.y *= a) : (this.x = 0, this.y = 0), this
    }, divide: function (a) {
        return this.x /= a.x, this.y /= a.y, this
    }, divideScalar: function (a) {
        return this.multiplyScalar(1 / a)
    }, min: function (a) {
        return this.x = Math.min(this.x, a.x), this.y = Math.min(this.y, a.y), this
    }, max: function (a) {
        return this.x = Math.max(this.x, a.x), this.y = Math.max(this.y, a.y), this
    }, clamp: function (a, b) {
        return this.x = Math.max(a.x, Math.min(b.x, this.x)), this.y = Math.max(a.y, Math.min(b.y, this.y)), this
    }, clampScalar: function () {
        var a, b;
        return function (c, d) {
            return void 0 === a && (a = new THREE.Vector2, b = new THREE.Vector2),
                a.set(c, c), b.set(d, d), this.clamp(a, b)
        }
    }(), clampLength: function (a, b) {
        var c = this.length();
        return this.multiplyScalar(Math.max(a, Math.min(b, c)) / c)
    }, floor: function () {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
    }, ceil: function () {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this
    }, round: function () {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this
    }, roundToZero: function () {
        return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this
    }, negate: function () {
        return this.x = -this.x, this.y = -this.y, this
    }, dot: function (a) {
        return this.x * a.x + this.y * a.y
    }, lengthSq: function () {
        return this.x * this.x + this.y * this.y
    }, length: function () {
        return Math.sqrt(this.x * this.x + this.y * this.y)
    }, lengthManhattan: function () {
        return Math.abs(this.x) + Math.abs(this.y)
    }, normalize: function () {
        return this.divideScalar(this.length())
    }, angle: function () {
        var a = Math.atan2(this.y, this.x);
        return 0 > a && (a += 2 * Math.PI), a
    }, distanceTo: function (a) {
        return Math.sqrt(this.distanceToSquared(a))
    }, distanceToSquared: function (a) {
        var b = this.x - a.x, c = this.y - a.y;
        return b * b + c * c
    }, setLength: function (a) {
        return this.multiplyScalar(a / this.length())
    }, lerp: function (a, b) {
        return this.x += (a.x - this.x) * b, this.y += (a.y - this.y) * b, this
    }, lerpVectors: function (a, b, c) {
        return this.subVectors(b, a).multiplyScalar(c).add(a)
    }, equals: function (a) {
        return a.x === this.x && a.y === this.y
    }, fromArray: function (a, b) {
        return void 0 === b && (b = 0), this.x = a[b], this.y = a[b + 1], this
    }, toArray: function (a, b) {
        return void 0 === a && (a = []), void 0 === b && (b = 0), a[b] = this.x, a[b + 1] = this.y, a
    }, fromAttribute: function (a, b, c) {
        return void 0 === c && (c = 0), b = b * a.itemSize + c, this.x = a.array[b], this.y = a.array[b + 1], this
    }, rotateAround: function (a, b) {
        var c = Math.cos(b), d = Math.sin(b), e = this.x - a.x, f = this.y - a.y;
        return this.x = e * c - f * d + a.x, this.y = e * d + f * c + a.y, this
    }
}, THREE.Vector3 = function (a, b, c) {
    this.x = a || 0, this.y = b || 0, this.z = c || 0
}, THREE.Vector3.prototype = {
    constructor: THREE.Vector3, set: function (a, b, c) {
        return this.x = a, this.y = b, this.z = c, this
    }, setScalar: function (a) {
        return this.x = a, this.y = a, this.z = a, this
    }, setX: function (a) {
        return this.x = a, this
    }, setY: function (a) {
        return this.y = a, this
    }, setZ: function (a) {
        return this.z = a, this
    }, setComponent: function (a, b) {
        switch (a) {
            case 0:
                this.x = b;
                break;
            case 1:
                this.y = b;
                break;
            case 2:
                this.z = b;
                break;
            default:
                throw new Error("index is out of range: " + a)
        }
    }, getComponent: function (a) {
        switch (a) {
            case 0:
                return this.x;
            case 1:
                return this.y;
            case 2:
                return this.z;
            default:
                throw new Error("index is out of range: " + a)
        }
    }, clone: function () {
        return new this.constructor(this.x, this.y, this.z)
    }, copy: function (a) {
        return this.x = a.x, this.y = a.y, this.z = a.z, this
    }, add: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(a, b)) : (this.x += a.x, this.y += a.y, this.z += a.z, this)
    }, addScalar: function (a) {
        return this.x += a, this.y += a, this.z += a, this
    }, addVectors: function (a, b) {
        return this.x = a.x + b.x, this.y = a.y + b.y, this.z = a.z + b.z, this
    }, addScaledVector: function (a, b) {
        return this.x += a.x * b, this.y += a.y * b, this.z += a.z * b, this
    }, sub: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(a, b)) : (this.x -= a.x, this.y -= a.y, this.z -= a.z, this)
    }, subScalar: function (a) {
        return this.x -= a, this.y -= a, this.z -= a, this
    }, subVectors: function (a, b) {
        return this.x = a.x - b.x, this.y = a.y - b.y, this.z = a.z - b.z, this
    }, multiply: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."), this.multiplyVectors(a, b)) : (this.x *= a.x, this.y *= a.y, this.z *= a.z, this)
    }, multiplyScalar: function (a) {
        return isFinite(a) ? (this.x *= a, this.y *= a, this.z *= a) : (this.x = 0, this.y = 0, this.z = 0), this
    }, multiplyVectors: function (a, b) {
        return this.x = a.x * b.x, this.y = a.y * b.y, this.z = a.z * b.z, this
    }, applyEuler: function () {
        var a;
        return function (b) {
            return b instanceof THREE.Euler == !1 && console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."), void 0 === a && (a = new THREE.Quaternion), this.applyQuaternion(a.setFromEuler(b))
        }
    }(), applyAxisAngle: function () {
        var a;
        return function (b, c) {
            return void 0 === a && (a = new THREE.Quaternion), this.applyQuaternion(a.setFromAxisAngle(b, c))
        }
    }(), applyMatrix3: function (a) {
        var b = this.x, c = this.y, d = this.z, e = a.elements;
        return this.x = e[0] * b + e[3] * c + e[6] * d, this.y = e[1] * b + e[4] * c + e[7] * d, this.z = e[2] * b + e[5] * c + e[8] * d, this
    }, applyMatrix4: function (a) {
        var b = this.x, c = this.y, d = this.z, e = a.elements;
        return this.x = e[0] * b + e[4] * c + e[8] * d + e[12], this.y = e[1] * b + e[5] * c + e[9] * d + e[13], this.z = e[2] * b + e[6] * c + e[10] * d + e[14], this
    }, applyProjection: function (a) {
        var b = this.x, c = this.y, d = this.z, e = a.elements, f = 1 / (e[3] * b + e[7] * c + e[11] * d + e[15]);
        return this.x = (e[0] * b + e[4] * c + e[8] * d + e[12]) * f, this.y = (e[1] * b + e[5] * c + e[9] * d + e[13]) * f, this.z = (e[2] * b + e[6] * c + e[10] * d + e[14]) * f, this
    }, applyQuaternion: function (a) {
        var b = this.x, c = this.y, d = this.z, e = a.x, f = a.y, g = a.z, h = a.w, i = h * b + f * d - g * c, j = h * c + g * b - e * d, k = h * d + e * c - f * b, l = -e * b - f * c - g * d;
        return this.x = i * h + l * -e + j * -g - k * -f, this.y = j * h + l * -f + k * -e - i * -g, this.z = k * h + l * -g + i * -f - j * -e, this
    }, project: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.multiplyMatrices(b.projectionMatrix, a.getInverse(b.matrixWorld)), this.applyProjection(a)
        }
    }(), unproject: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.multiplyMatrices(b.matrixWorld, a.getInverse(b.projectionMatrix)), this.applyProjection(a)
        }
    }(), transformDirection: function (a) {
        var b = this.x, c = this.y, d = this.z, e = a.elements;
        return this.x = e[0] * b + e[4] * c + e[8] * d, this.y = e[1] * b + e[5] * c + e[9] * d, this.z = e[2] * b + e[6] * c + e[10] * d, this.normalize()
    }, divide: function (a) {
        return this.x /= a.x, this.y /= a.y, this.z /= a.z, this
    }, divideScalar: function (a) {
        return this.multiplyScalar(1 / a)
    }, min: function (a) {
        return this.x = Math.min(this.x, a.x), this.y = Math.min(this.y, a.y), this.z = Math.min(this.z, a.z), this
    }, max: function (a) {
        return this.x = Math.max(this.x, a.x), this.y = Math.max(this.y, a.y), this.z = Math.max(this.z, a.z), this
    }, clamp: function (a, b) {
        return this.x = Math.max(a.x, Math.min(b.x, this.x)), this.y = Math.max(a.y, Math.min(b.y, this.y)), this.z = Math.max(a.z, Math.min(b.z, this.z)), this
    }, clampScalar: function () {
        var a, b;
        return function (c, d) {
            return void 0 === a && (a = new THREE.Vector3, b = new THREE.Vector3), a.set(c, c, c), b.set(d, d, d), this.clamp(a, b)
        }
    }(), clampLength: function (a, b) {
        var c = this.length();
        return this.multiplyScalar(Math.max(a, Math.min(b, c)) / c)
    }, floor: function () {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this
    }, ceil: function () {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this
    }, round: function () {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this
    }, roundToZero: function () {
        return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this
    }, negate: function () {
        return this.x = -this.x, this.y = -this.y, this.z = -this.z, this
    }, dot: function (a) {
        return this.x * a.x + this.y * a.y + this.z * a.z
    }, lengthSq: function () {
        return this.x * this.x + this.y * this.y + this.z * this.z
    }, length: function () {
        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
    }, lengthManhattan: function () {
        return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
    }, normalize: function () {
        return this.divideScalar(this.length())
    }, setLength: function (a) {
        return this.multiplyScalar(a / this.length())
    }, lerp: function (a, b) {
        return this.x += (a.x - this.x) * b, this.y += (a.y - this.y) * b, this.z += (a.z - this.z) * b, this
    }, lerpVectors: function (a, b, c) {
        return this.subVectors(b, a).multiplyScalar(c).add(a)
    }, cross: function (a, b) {
        if (void 0 !== b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."), this.crossVectors(a, b);
        var c = this.x, d = this.y, e = this.z;
        return this.x = d * a.z - e * a.y, this.y = e * a.x - c * a.z, this.z = c * a.y - d * a.x, this
    }, crossVectors: function (a, b) {
        var c = a.x, d = a.y, e = a.z, f = b.x, g = b.y, h = b.z;
        return this.x = d * h - e * g, this.y = e * f - c * h, this.z = c * g - d * f, this
    }, projectOnVector: function (a) {
        var b = a.dot(this) / a.lengthSq();
        return this.copy(a).multiplyScalar(b)
    }, projectOnPlane: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Vector3), a.copy(this).projectOnVector(b), this.sub(a)
        }
    }(), reflect: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Vector3), this.sub(a.copy(b).multiplyScalar(2 * this.dot(b)))
        }
    }(), angleTo: function (a) {
        var b = this.dot(a) / Math.sqrt(this.lengthSq() * a.lengthSq());
        return Math.acos(THREE.Math.clamp(b, -1, 1))
    }, distanceTo: function (a) {
        return Math.sqrt(this.distanceToSquared(a))
    }, distanceToSquared: function (a) {
        var b = this.x - a.x, c = this.y - a.y, d = this.z - a.z;
        return b * b + c * c + d * d
    }, setFromSpherical: function (a) {
        var b = Math.sin(a.phi) * a.radius;
        return this.x = b * Math.sin(a.theta), this.y = Math.cos(a.phi) * a.radius, this.z = b * Math.cos(a.theta), this
    }, setFromMatrixPosition: function (a) {
        return this.setFromMatrixColumn(a, 3)
    }, setFromMatrixScale: function (a) {
        var b = this.setFromMatrixColumn(a, 0).length(), c = this.setFromMatrixColumn(a, 1).length(), d = this.setFromMatrixColumn(a, 2).length();
        return this.x = b, this.y = c, this.z = d, this
    }, setFromMatrixColumn: function (a, b) {
        if ("number" == typeof a) {
            console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");
            var c = a;
            a = b, b = c
        }
        return this.fromArray(a.elements, 4 * b)
    }, equals: function (a) {
        return a.x === this.x && a.y === this.y && a.z === this.z
    }, fromArray: function (a, b) {
        return void 0 === b && (b = 0), this.x = a[b], this.y = a[b + 1], this.z = a[b + 2], this
    }, toArray: function (a, b) {
        return void 0 === a && (a = []), void 0 === b && (b = 0), a[b] = this.x, a[b + 1] = this.y, a[b + 2] = this.z, a
    }, fromAttribute: function (a, b, c) {
        return void 0 === c && (c = 0), b = b * a.itemSize + c, this.x = a.array[b], this.y = a.array[b + 1], this.z = a.array[b + 2], this
    }
}, THREE.Vector4 = function (a, b, c, d) {
    this.x = a || 0, this.y = b || 0, this.z = c || 0, this.w = void 0 !== d ? d : 1
}, THREE.Vector4.prototype = {
    constructor: THREE.Vector4, set: function (a, b, c, d) {
        return this.x = a, this.y = b, this.z = c, this.w = d, this
    }, setScalar: function (a) {
        return this.x = a, this.y = a, this.z = a, this.w = a, this
    }, setX: function (a) {
        return this.x = a, this
    }, setY: function (a) {
        return this.y = a, this
    }, setZ: function (a) {
        return this.z = a, this
    }, setW: function (a) {
        return this.w = a, this
    }, setComponent: function (a, b) {
        switch (a) {
            case 0:
                this.x = b;
                break;
            case 1:
                this.y = b;
                break;
            case 2:
                this.z = b;
                break;
            case 3:
                this.w = b;
                break;
            default:
                throw new Error("index is out of range: " + a)
        }
    }, getComponent: function (a) {
        switch (a) {
            case 0:
                return this.x;
            case 1:
                return this.y;
            case 2:
                return this.z;
            case 3:
                return this.w;
            default:
                throw new Error("index is out of range: " + a)
        }
    }, clone: function () {
        return new this.constructor(this.x, this.y, this.z, this.w)
    }, copy: function (a) {
        return this.x = a.x, this.y = a.y, this.z = a.z, this.w = void 0 !== a.w ? a.w : 1, this
    }, add: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(a, b)) : (this.x += a.x, this.y += a.y, this.z += a.z, this.w += a.w, this)
    }, addScalar: function (a) {
        return this.x += a, this.y += a, this.z += a, this.w += a, this
    }, addVectors: function (a, b) {
        return this.x = a.x + b.x, this.y = a.y + b.y, this.z = a.z + b.z, this.w = a.w + b.w, this
    }, addScaledVector: function (a, b) {
        return this.x += a.x * b, this.y += a.y * b, this.z += a.z * b, this.w += a.w * b, this
    }, sub: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(a, b)) : (this.x -= a.x, this.y -= a.y, this.z -= a.z, this.w -= a.w, this)
    }, subScalar: function (a) {
        return this.x -= a, this.y -= a, this.z -= a, this.w -= a, this
    }, subVectors: function (a, b) {
        return this.x = a.x - b.x, this.y = a.y - b.y, this.z = a.z - b.z, this.w = a.w - b.w, this
    }, multiplyScalar: function (a) {
        return isFinite(a) ? (this.x *= a, this.y *= a, this.z *= a, this.w *= a) : (this.x = 0, this.y = 0, this.z = 0, this.w = 0), this
    }, applyMatrix4: function (a) {
        var b = this.x, c = this.y, d = this.z, e = this.w, f = a.elements;
        return this.x = f[0] * b + f[4] * c + f[8] * d + f[12] * e, this.y = f[1] * b + f[5] * c + f[9] * d + f[13] * e, this.z = f[2] * b + f[6] * c + f[10] * d + f[14] * e, this.w = f[3] * b + f[7] * c + f[11] * d + f[15] * e, this
    }, divideScalar: function (a) {
        return this.multiplyScalar(1 / a)
    }, setAxisAngleFromQuaternion: function (a) {
        this.w = 2 * Math.acos(a.w);
        var b = Math.sqrt(1 - a.w * a.w);
        return 1e-4 > b ? (this.x = 1, this.y = 0, this.z = 0) : (this.x = a.x / b, this.y = a.y / b, this.z = a.z / b), this
    }, setAxisAngleFromRotationMatrix: function (a) {
        var b, c, d, e, f = .01, g = .1, h = a.elements, i = h[0], j = h[4], k = h[8], l = h[1], m = h[5], n = h[9], o = h[2], p = h[6], q = h[10];
        if (Math.abs(j - l) < f && Math.abs(k - o) < f && Math.abs(n - p) < f) {
            if (Math.abs(j + l) < g && Math.abs(k + o) < g && Math.abs(n + p) < g && Math.abs(i + m + q - 3) < g)return this.set(1, 0, 0, 0), this;
            b = Math.PI;
            var r = (i + 1) / 2, s = (m + 1) / 2, t = (q + 1) / 2, u = (j + l) / 4, v = (k + o) / 4, w = (n + p) / 4;
            return r > s && r > t ? f > r ? (c = 0, d = .707106781, e = .707106781) : (c = Math.sqrt(r), d = u / c, e = v / c) : s > t ? f > s ? (c = .707106781, d = 0, e = .707106781) : (d = Math.sqrt(s), c = u / d, e = w / d) : f > t ? (c = .707106781, d = .707106781, e = 0) : (e = Math.sqrt(t), c = v / e, d = w / e), this.set(c, d, e, b), this
        }
        var x = Math.sqrt((p - n) * (p - n) + (k - o) * (k - o) + (l - j) * (l - j));
        return Math.abs(x) < .001 && (x = 1), this.x = (p - n) / x, this.y = (k - o) / x, this.z = (l - j) / x, this.w = Math.acos((i + m + q - 1) / 2), this
    }, min: function (a) {
        return this.x = Math.min(this.x, a.x), this.y = Math.min(this.y, a.y), this.z = Math.min(this.z, a.z), this.w = Math.min(this.w, a.w), this
    }, max: function (a) {
        return this.x = Math.max(this.x, a.x), this.y = Math.max(this.y, a.y), this.z = Math.max(this.z, a.z), this.w = Math.max(this.w, a.w), this
    }, clamp: function (a, b) {
        return this.x = Math.max(a.x, Math.min(b.x, this.x)), this.y = Math.max(a.y, Math.min(b.y, this.y)), this.z = Math.max(a.z, Math.min(b.z, this.z)), this.w = Math.max(a.w, Math.min(b.w, this.w)), this
    }, clampScalar: function () {
        var a, b;
        return function (c, d) {
            return void 0 === a && (a = new THREE.Vector4, b = new THREE.Vector4), a.set(c, c, c, c), b.set(d, d, d, d), this.clamp(a, b)
        }
    }(), floor: function () {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this.w = Math.floor(this.w), this
    }, ceil: function () {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this.w = Math.ceil(this.w), this
    }, round: function () {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this.w = Math.round(this.w), this
    }, roundToZero: function () {
        return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w), this
    }, negate: function () {
        return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this
    }, dot: function (a) {
        return this.x * a.x + this.y * a.y + this.z * a.z + this.w * a.w
    }, lengthSq: function () {
        return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w
    }, length: function () {
        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)
    }, lengthManhattan: function () {
        return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w)
    }, normalize: function () {
        return this.divideScalar(this.length())
    }, setLength: function (a) {
        return this.multiplyScalar(a / this.length())
    }, lerp: function (a, b) {
        return this.x += (a.x - this.x) * b, this.y += (a.y - this.y) * b, this.z += (a.z - this.z) * b, this.w += (a.w - this.w) * b, this
    }, lerpVectors: function (a, b, c) {
        return this.subVectors(b, a).multiplyScalar(c).add(a)
    }, equals: function (a) {
        return a.x === this.x && a.y === this.y && a.z === this.z && a.w === this.w
    }, fromArray: function (a, b) {
        return void 0 === b && (b = 0), this.x = a[b], this.y = a[b + 1], this.z = a[b + 2], this.w = a[b + 3], this
    }, toArray: function (a, b) {
        return void 0 === a && (a = []), void 0 === b && (b = 0), a[b] = this.x, a[b + 1] = this.y, a[b + 2] = this.z, a[b + 3] = this.w, a
    }, fromAttribute: function (a, b, c) {
        return void 0 === c && (c = 0), b = b * a.itemSize + c, this.x = a.array[b], this.y = a.array[b + 1], this.z = a.array[b + 2], this.w = a.array[b + 3], this
    }
}, THREE.Euler = function (a, b, c, d) {
    this._x = a || 0, this._y = b || 0, this._z = c || 0, this._order = d || THREE.Euler.DefaultOrder
}, THREE.Euler.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"], THREE.Euler.DefaultOrder = "XYZ", THREE.Euler.prototype = {
    constructor: THREE.Euler,
    get x() {
        return this._x
    },
    set x(a) {
        this._x = a, this.onChangeCallback()
    },
    get y() {
        return this._y
    },
    set y(a) {
        this._y = a, this.onChangeCallback()
    },
    get z() {
        return this._z
    },
    set z(a) {
        this._z = a, this.onChangeCallback()
    },
    get order() {
        return this._order
    },
    set order(a) {
        this._order = a, this.onChangeCallback()
    },
    set: function (a, b, c, d) {
        return this._x = a, this._y = b, this._z = c, this._order = d || this._order, this.onChangeCallback(), this
    },
    clone: function () {
        return new this.constructor(this._x, this._y, this._z, this._order)
    },
    copy: function (a) {
        return this._x = a._x, this._y = a._y, this._z = a._z, this._order = a._order, this.onChangeCallback(), this
    },
    setFromRotationMatrix: function (a, b, c) {
        var d = THREE.Math.clamp, e = a.elements, f = e[0], g = e[4], h = e[8], i = e[1], j = e[5], k = e[9], l = e[2], m = e[6], n = e[10];
        return b = b || this._order, "XYZ" === b ? (this._y = Math.asin(d(h, -1, 1)), Math.abs(h) < .99999 ? (this._x = Math.atan2(-k, n), this._z = Math.atan2(-g, f)) : (this._x = Math.atan2(m, j), this._z = 0)) : "YXZ" === b ? (this._x = Math.asin(-d(k, -1, 1)), Math.abs(k) < .99999 ? (this._y = Math.atan2(h, n), this._z = Math.atan2(i, j)) : (this._y = Math.atan2(-l, f), this._z = 0)) : "ZXY" === b ? (this._x = Math.asin(d(m, -1, 1)), Math.abs(m) < .99999 ? (this._y = Math.atan2(-l, n), this._z = Math.atan2(-g, j)) : (this._y = 0, this._z = Math.atan2(i, f))) : "ZYX" === b ? (this._y = Math.asin(-d(l, -1, 1)), Math.abs(l) < .99999 ? (this._x = Math.atan2(m, n), this._z = Math.atan2(i, f)) : (this._x = 0, this._z = Math.atan2(-g, j))) : "YZX" === b ? (this._z = Math.asin(d(i, -1, 1)), Math.abs(i) < .99999 ? (this._x = Math.atan2(-k, j), this._y = Math.atan2(-l, f)) : (this._x = 0, this._y = Math.atan2(h, n))) : "XZY" === b ? (this._z = Math.asin(-d(g, -1, 1)), Math.abs(g) < .99999 ? (this._x = Math.atan2(m, j), this._y = Math.atan2(h, f)) : (this._x = Math.atan2(-k, n), this._y = 0)) : console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: " + b), this._order = b, c !== !1 && this.onChangeCallback(), this
    },
    setFromQuaternion: function () {
        var a;
        return function (b, c, d) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationFromQuaternion(b), this.setFromRotationMatrix(a, c, d)
        }
    }(),
    setFromVector3: function (a, b) {
        return this.set(a.x, a.y, a.z, b || this._order)
    },
    reorder: function () {
        var a = new THREE.Quaternion;
        return function (b) {
            return a.setFromEuler(this), this.setFromQuaternion(a, b)
        }
    }(),
    equals: function (a) {
        return a._x === this._x && a._y === this._y && a._z === this._z && a._order === this._order
    },
    fromArray: function (a) {
        return this._x = a[0], this._y = a[1], this._z = a[2], void 0 !== a[3] && (this._order = a[3]), this.onChangeCallback(), this
    },
    toArray: function (a, b) {
        return void 0 === a && (a = []), void 0 === b && (b = 0), a[b] = this._x, a[b + 1] = this._y, a[b + 2] = this._z, a[b + 3] = this._order, a
    },
    toVector3: function (a) {
        return a ? a.set(this._x, this._y, this._z) : new THREE.Vector3(this._x, this._y, this._z)
    },
    onChange: function (a) {
        return this.onChangeCallback = a, this
    },
    onChangeCallback: function () {
    }
}, THREE.Line3 = function (a, b) {
    this.start = void 0 !== a ? a : new THREE.Vector3, this.end = void 0 !== b ? b : new THREE.Vector3
}, THREE.Line3.prototype = {
    constructor: THREE.Line3, set: function (a, b) {
        return this.start.copy(a), this.end.copy(b), this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.start.copy(a.start), this.end.copy(a.end), this
    }, center: function (a) {
        var b = a || new THREE.Vector3;
        return b.addVectors(this.start, this.end).multiplyScalar(.5)
    }, delta: function (a) {
        var b = a || new THREE.Vector3;
        return b.subVectors(this.end, this.start)
    }, distanceSq: function () {
        return this.start.distanceToSquared(this.end)
    }, distance: function () {
        return this.start.distanceTo(this.end)
    }, at: function (a, b) {
        var c = b || new THREE.Vector3;
        return this.delta(c).multiplyScalar(a).add(this.start)
    }, closestPointToPointParameter: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3;
        return function (c, d) {
            a.subVectors(c, this.start), b.subVectors(this.end, this.start);
            var e = b.dot(b), f = b.dot(a), g = f / e;
            return d && (g = THREE.Math.clamp(g, 0, 1)), g
        }
    }(), closestPointToPoint: function (a, b, c) {
        var d = this.closestPointToPointParameter(a, b), e = c || new THREE.Vector3;
        return this.delta(e).multiplyScalar(d).add(this.start)
    }, applyMatrix4: function (a) {
        return this.start.applyMatrix4(a), this.end.applyMatrix4(a), this
    }, equals: function (a) {
        return a.start.equals(this.start) && a.end.equals(this.end)
    }
}, THREE.Box2 = function (a, b) {
    this.min = void 0 !== a ? a : new THREE.Vector2(+(1 / 0), +(1 / 0)), this.max = void 0 !== b ? b : new THREE.Vector2(-(1 / 0), -(1 / 0))
}, THREE.Box2.prototype = {
    constructor: THREE.Box2, set: function (a, b) {
        return this.min.copy(a), this.max.copy(b), this
    }, setFromPoints: function (a) {
        this.makeEmpty();
        for (var b = 0, c = a.length; c > b; b++)this.expandByPoint(a[b]);
        return this
    }, setFromCenterAndSize: function () {
        var a = new THREE.Vector2;
        return function (b, c) {
            var d = a.copy(c).multiplyScalar(.5);
            return this.min.copy(b).sub(d), this.max.copy(b).add(d), this
        }
    }(), clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.min.copy(a.min), this.max.copy(a.max), this
    }, makeEmpty: function () {
        return this.min.x = this.min.y = +(1 / 0), this.max.x = this.max.y = -(1 / 0), this
    }, isEmpty: function () {
        return this.max.x < this.min.x || this.max.y < this.min.y
    }, center: function (a) {
        var b = a || new THREE.Vector2;
        return b.addVectors(this.min, this.max).multiplyScalar(.5)
    }, size: function (a) {
        var b = a || new THREE.Vector2;
        return b.subVectors(this.max, this.min)
    }, expandByPoint: function (a) {
        return this.min.min(a), this.max.max(a), this
    }, expandByVector: function (a) {
        return this.min.sub(a), this.max.add(a), this
    }, expandByScalar: function (a) {
        return this.min.addScalar(-a), this.max.addScalar(a), this
    }, containsPoint: function (a) {
        return a.x < this.min.x || a.x > this.max.x || a.y < this.min.y || a.y > this.max.y ? !1 : !0
    }, containsBox: function (a) {
        return this.min.x <= a.min.x && a.max.x <= this.max.x && this.min.y <= a.min.y && a.max.y <= this.max.y ? !0 : !1
    }, getParameter: function (a, b) {
        var c = b || new THREE.Vector2;
        return c.set((a.x - this.min.x) / (this.max.x - this.min.x), (a.y - this.min.y) / (this.max.y - this.min.y))
    }, intersectsBox: function (a) {
        return a.max.x < this.min.x || a.min.x > this.max.x || a.max.y < this.min.y || a.min.y > this.max.y ? !1 : !0
    }, clampPoint: function (a, b) {
        var c = b || new THREE.Vector2;
        return c.copy(a).clamp(this.min, this.max)
    }, distanceToPoint: function () {
        var a = new THREE.Vector2;
        return function (b) {
            var c = a.copy(b).clamp(this.min, this.max);
            return c.sub(b).length()
        }
    }(), intersect: function (a) {
        return this.min.max(a.min), this.max.min(a.max), this
    }, union: function (a) {
        return this.min.min(a.min), this.max.max(a.max), this
    }, translate: function (a) {
        return this.min.add(a), this.max.add(a), this
    }, equals: function (a) {
        return a.min.equals(this.min) && a.max.equals(this.max)
    }
}, THREE.Box3 = function (a, b) {
    this.min = void 0 !== a ? a : new THREE.Vector3(+(1 / 0), +(1 / 0), +(1 / 0)), this.max = void 0 !== b ? b : new THREE.Vector3(-(1 / 0), -(1 / 0), -(1 / 0))
}, THREE.Box3.prototype = {
    constructor: THREE.Box3, set: function (a, b) {
        return this.min.copy(a), this.max.copy(b), this
    }, setFromArray: function (a) {
        for (var b = +(1 / 0), c = +(1 / 0), d = +(1 / 0), e = -(1 / 0), f = -(1 / 0), g = -(1 / 0), h = 0, i = a.length; i > h; h += 3) {
            var j = a[h], k = a[h + 1], l = a[h + 2];
            b > j && (b = j), c > k && (c = k), d > l && (d = l), j > e && (e = j), k > f && (f = k), l > g && (g = l)
        }
        this.min.set(b, c, d), this.max.set(e, f, g)
    }, setFromPoints: function (a) {
        this.makeEmpty();
        for (var b = 0, c = a.length; c > b; b++)this.expandByPoint(a[b]);
        return this
    }, setFromCenterAndSize: function () {
        var a = new THREE.Vector3;
        return function (b, c) {
            var d = a.copy(c).multiplyScalar(.5);
            return this.min.copy(b).sub(d), this.max.copy(b).add(d), this
        }
    }(), setFromObject: function () {
        var a = new THREE.Vector3;
        return function (b) {
            var c = this;
            return b.updateMatrixWorld(!0), this.makeEmpty(), b.traverse(function (b) {
                var d = b.geometry;
                if (void 0 !== d)if (d instanceof THREE.Geometry)for (var e = d.vertices, f = 0, g = e.length; g > f; f++)a.copy(e[f]), a.applyMatrix4(b.matrixWorld), c.expandByPoint(a); else if (d instanceof THREE.BufferGeometry && void 0 !== d.attributes.position)for (var h = d.attributes.position.array, f = 0, g = h.length; g > f; f += 3)a.fromArray(h, f), a.applyMatrix4(b.matrixWorld), c.expandByPoint(a)
            }), this
        }
    }(), clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.min.copy(a.min), this.max.copy(a.max), this
    }, makeEmpty: function () {
        return this.min.x = this.min.y = this.min.z = +(1 / 0), this.max.x = this.max.y = this.max.z = -(1 / 0), this
    }, isEmpty: function () {
        return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
    }, center: function (a) {
        var b = a || new THREE.Vector3;
        return b.addVectors(this.min, this.max).multiplyScalar(.5)
    }, size: function (a) {
        var b = a || new THREE.Vector3;
        return b.subVectors(this.max, this.min)
    }, expandByPoint: function (a) {
        return this.min.min(a), this.max.max(a), this
    }, expandByVector: function (a) {
        return this.min.sub(a), this.max.add(a), this
    }, expandByScalar: function (a) {
        return this.min.addScalar(-a), this.max.addScalar(a), this
    }, containsPoint: function (a) {
        return a.x < this.min.x || a.x > this.max.x || a.y < this.min.y || a.y > this.max.y || a.z < this.min.z || a.z > this.max.z ? !1 : !0
    }, containsBox: function (a) {
        return this.min.x <= a.min.x && a.max.x <= this.max.x && this.min.y <= a.min.y && a.max.y <= this.max.y && this.min.z <= a.min.z && a.max.z <= this.max.z ? !0 : !1
    }, getParameter: function (a, b) {
        var c = b || new THREE.Vector3;
        return c.set((a.x - this.min.x) / (this.max.x - this.min.x), (a.y - this.min.y) / (this.max.y - this.min.y), (a.z - this.min.z) / (this.max.z - this.min.z))
    }, intersectsBox: function (a) {
        return a.max.x < this.min.x || a.min.x > this.max.x || a.max.y < this.min.y || a.min.y > this.max.y || a.max.z < this.min.z || a.min.z > this.max.z ? !1 : !0
    }, intersectsSphere: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Vector3), this.clampPoint(b.center, a), a.distanceToSquared(b.center) <= b.radius * b.radius
        }
    }(), intersectsPlane: function (a) {
        var b, c;
        return a.normal.x > 0 ? (b = a.normal.x * this.min.x, c = a.normal.x * this.max.x) : (b = a.normal.x * this.max.x, c = a.normal.x * this.min.x), a.normal.y > 0 ? (b += a.normal.y * this.min.y, c += a.normal.y * this.max.y) : (b += a.normal.y * this.max.y, c += a.normal.y * this.min.y), a.normal.z > 0 ? (b += a.normal.z * this.min.z, c += a.normal.z * this.max.z) : (b += a.normal.z * this.max.z, c += a.normal.z * this.min.z), b <= a.constant && c >= a.constant
    }, clampPoint: function (a, b) {
        var c = b || new THREE.Vector3;
        return c.copy(a).clamp(this.min, this.max)
    }, distanceToPoint: function () {
        var a = new THREE.Vector3;
        return function (b) {
            var c = a.copy(b).clamp(this.min, this.max);
            return c.sub(b).length()
        }
    }(), getBoundingSphere: function () {
        var a = new THREE.Vector3;
        return function (b) {
            var c = b || new THREE.Sphere;
            return c.center = this.center(), c.radius = .5 * this.size(a).length(), c
        }
    }(), intersect: function (a) {
        return this.min.max(a.min), this.max.min(a.max), this.isEmpty() && this.makeEmpty(), this
    }, union: function (a) {
        return this.min.min(a.min), this.max.max(a.max), this
    }, applyMatrix4: function () {
        var a = [new THREE.Vector3, new THREE.Vector3, new THREE.Vector3, new THREE.Vector3, new THREE.Vector3, new THREE.Vector3, new THREE.Vector3, new THREE.Vector3];
        return function (b) {
            return this.isEmpty() ? this : (a[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(b), a[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(b), a[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(b), a[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(b), a[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(b), a[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(b), a[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(b), a[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(b), this.setFromPoints(a), this)
        }
    }(), translate: function (a) {
        return this.min.add(a), this.max.add(a), this
    }, equals: function (a) {
        return a.min.equals(this.min) && a.max.equals(this.max)
    }
}, THREE.Matrix3 = function () {
    this.elements = new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]), arguments.length > 0 && console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")
}, THREE.Matrix3.prototype = {
    constructor: THREE.Matrix3, set: function (a, b, c, d, e, f, g, h, i) {
        var j = this.elements;
        return j[0] = a, j[1] = d, j[2] = g, j[3] = b, j[4] = e, j[5] = h, j[6] = c, j[7] = f, j[8] = i, this
    }, identity: function () {
        return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1), this
    }, clone: function () {
        return (new this.constructor).fromArray(this.elements)
    }, copy: function (a) {
        var b = a.elements;
        return this.set(b[0], b[3], b[6], b[1], b[4], b[7], b[2], b[5], b[8]), this
    }, setFromMatrix4: function (a) {
        var b = a.elements;
        return this.set(b[0], b[4], b[8], b[1], b[5], b[9], b[2], b[6], b[10]), this
    }, applyToVector3Array: function () {
        var a;
        return function (b, c, d) {
            void 0 === a && (a = new THREE.Vector3), void 0 === c && (c = 0), void 0 === d && (d = b.length);
            for (var e = 0, f = c; d > e; e += 3, f += 3)a.fromArray(b, f), a.applyMatrix3(this), a.toArray(b, f);
            return b
        }
    }(), applyToBuffer: function () {
        var a;
        return function (b, c, d) {
            void 0 === a && (a = new THREE.Vector3), void 0 === c && (c = 0), void 0 === d && (d = b.length / b.itemSize);
            for (var e = 0, f = c; d > e; e++, f++)a.x = b.getX(f), a.y = b.getY(f), a.z = b.getZ(f), a.applyMatrix3(this), b.setXYZ(a.x, a.y, a.z);
            return b
        }
    }(), multiplyScalar: function (a) {
        var b = this.elements;
        return b[0] *= a, b[3] *= a, b[6] *= a, b[1] *= a, b[4] *= a, b[7] *= a, b[2] *= a, b[5] *= a, b[8] *= a, this
    }, determinant: function () {
        var a = this.elements, b = a[0], c = a[1], d = a[2], e = a[3], f = a[4], g = a[5], h = a[6], i = a[7], j = a[8];
        return b * f * j - b * g * i - c * e * j + c * g * h + d * e * i - d * f * h
    }, getInverse: function (a, b) {
        a instanceof THREE.Matrix4 && console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");
        var c = a.elements, d = this.elements, e = c[0], f = c[1], g = c[2], h = c[3], i = c[4], j = c[5], k = c[6], l = c[7], m = c[8], n = m * i - j * l, o = j * k - m * h, p = l * h - i * k, q = e * n + f * o + g * p;
        if (0 === q) {
            var r = "THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";
            if (b)throw new Error(r);
            return console.warn(r), this.identity()
        }
        var s = 1 / q;
        return d[0] = n * s, d[1] = (g * l - m * f) * s, d[2] = (j * f - g * i) * s, d[3] = o * s, d[4] = (m * e - g * k) * s, d[5] = (g * h - j * e) * s, d[6] = p * s, d[7] = (f * k - l * e) * s, d[8] = (i * e - f * h) * s, this
    }, transpose: function () {
        var a, b = this.elements;
        return a = b[1], b[1] = b[3], b[3] = a, a = b[2], b[2] = b[6], b[6] = a, a = b[5], b[5] = b[7], b[7] = a, this
    }, flattenToArrayOffset: function (a, b) {
        return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."), this.toArray(a, b)
    }, getNormalMatrix: function (a) {
        return this.setFromMatrix4(a).getInverse(this).transpose()
    }, transposeIntoArray: function (a) {
        var b = this.elements;
        return a[0] = b[0], a[1] = b[3], a[2] = b[6], a[3] = b[1], a[4] = b[4], a[5] = b[7], a[6] = b[2], a[7] = b[5], a[8] = b[8], this
    }, fromArray: function (a) {
        return this.elements.set(a), this
    }, toArray: function (a, b) {
        void 0 === a && (a = []), void 0 === b && (b = 0);
        var c = this.elements;
        return a[b] = c[0], a[b + 1] = c[1], a[b + 2] = c[2], a[b + 3] = c[3], a[b + 4] = c[4], a[b + 5] = c[5], a[b + 6] = c[6], a[b + 7] = c[7], a[b + 8] = c[8], a
    }
}, THREE.Matrix4 = function () {
    this.elements = new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]), arguments.length > 0 && console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")
}, THREE.Matrix4.prototype = {
    constructor: THREE.Matrix4, set: function (a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p) {
        var q = this.elements;
        return q[0] = a, q[4] = b, q[8] = c, q[12] = d, q[1] = e, q[5] = f, q[9] = g, q[13] = h, q[2] = i, q[6] = j, q[10] = k, q[14] = l, q[3] = m, q[7] = n, q[11] = o, q[15] = p, this
    }, identity: function () {
        return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
    }, clone: function () {
        return (new THREE.Matrix4).fromArray(this.elements)
    }, copy: function (a) {
        return this.elements.set(a.elements), this
    }, copyPosition: function (a) {
        var b = this.elements, c = a.elements;
        return b[12] = c[12], b[13] = c[13], b[14] = c[14], this
    }, extractBasis: function (a, b, c) {
        return a.setFromMatrixColumn(this, 0), b.setFromMatrixColumn(this, 1), c.setFromMatrixColumn(this, 2), this
    }, makeBasis: function (a, b, c) {
        return this.set(a.x, b.x, c.x, 0, a.y, b.y, c.y, 0, a.z, b.z, c.z, 0, 0, 0, 0, 1), this
    }, extractRotation: function () {
        var a;
        return function (b) {
            void 0 === a && (a = new THREE.Vector3);
            var c = this.elements, d = b.elements, e = 1 / a.setFromMatrixColumn(b, 0).length(), f = 1 / a.setFromMatrixColumn(b, 1).length(), g = 1 / a.setFromMatrixColumn(b, 2).length();
            return c[0] = d[0] * e, c[1] = d[1] * e, c[2] = d[2] * e, c[4] = d[4] * f, c[5] = d[5] * f, c[6] = d[6] * f, c[8] = d[8] * g, c[9] = d[9] * g, c[10] = d[10] * g, this
        }
    }(), makeRotationFromEuler: function (a) {
        a instanceof THREE.Euler == !1 && console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
        var b = this.elements, c = a.x, d = a.y, e = a.z, f = Math.cos(c), g = Math.sin(c), h = Math.cos(d), i = Math.sin(d), j = Math.cos(e), k = Math.sin(e);
        if ("XYZ" === a.order) {
            var l = f * j, m = f * k, n = g * j, o = g * k;
            b[0] = h * j, b[4] = -h * k, b[8] = i, b[1] = m + n * i, b[5] = l - o * i, b[9] = -g * h, b[2] = o - l * i, b[6] = n + m * i, b[10] = f * h
        } else if ("YXZ" === a.order) {
            var p = h * j, q = h * k, r = i * j, s = i * k;
            b[0] = p + s * g, b[4] = r * g - q, b[8] = f * i, b[1] = f * k, b[5] = f * j, b[9] = -g, b[2] = q * g - r, b[6] = s + p * g, b[10] = f * h
        } else if ("ZXY" === a.order) {
            var p = h * j, q = h * k, r = i * j, s = i * k;
            b[0] = p - s * g, b[4] = -f * k, b[8] = r + q * g, b[1] = q + r * g, b[5] = f * j, b[9] = s - p * g, b[2] = -f * i, b[6] = g, b[10] = f * h
        } else if ("ZYX" === a.order) {
            var l = f * j, m = f * k, n = g * j, o = g * k;
            b[0] = h * j, b[4] = n * i - m, b[8] = l * i + o, b[1] = h * k, b[5] = o * i + l, b[9] = m * i - n, b[2] = -i, b[6] = g * h, b[10] = f * h
        } else if ("YZX" === a.order) {
            var t = f * h, u = f * i, v = g * h, w = g * i;
            b[0] = h * j, b[4] = w - t * k, b[8] = v * k + u, b[1] = k, b[5] = f * j, b[9] = -g * j, b[2] = -i * j, b[6] = u * k + v,
                b[10] = t - w * k
        } else if ("XZY" === a.order) {
            var t = f * h, u = f * i, v = g * h, w = g * i;
            b[0] = h * j, b[4] = -k, b[8] = i * j, b[1] = t * k + w, b[5] = f * j, b[9] = u * k - v, b[2] = v * k - u, b[6] = g * j, b[10] = w * k + t
        }
        return b[3] = 0, b[7] = 0, b[11] = 0, b[12] = 0, b[13] = 0, b[14] = 0, b[15] = 1, this
    }, makeRotationFromQuaternion: function (a) {
        var b = this.elements, c = a.x, d = a.y, e = a.z, f = a.w, g = c + c, h = d + d, i = e + e, j = c * g, k = c * h, l = c * i, m = d * h, n = d * i, o = e * i, p = f * g, q = f * h, r = f * i;
        return b[0] = 1 - (m + o), b[4] = k - r, b[8] = l + q, b[1] = k + r, b[5] = 1 - (j + o), b[9] = n - p, b[2] = l - q, b[6] = n + p, b[10] = 1 - (j + m), b[3] = 0, b[7] = 0, b[11] = 0, b[12] = 0, b[13] = 0, b[14] = 0, b[15] = 1, this
    }, lookAt: function () {
        var a, b, c;
        return function (d, e, f) {
            void 0 === a && (a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Vector3);
            var g = this.elements;
            return c.subVectors(d, e).normalize(), 0 === c.lengthSq() && (c.z = 1), a.crossVectors(f, c).normalize(), 0 === a.lengthSq() && (c.z += 1e-4, a.crossVectors(f, c).normalize()), b.crossVectors(c, a), g[0] = a.x, g[4] = b.x, g[8] = c.x, g[1] = a.y, g[5] = b.y, g[9] = c.y, g[2] = a.z, g[6] = b.z, g[10] = c.z, this
        }
    }(), multiply: function (a, b) {
        return void 0 !== b ? (console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."), this.multiplyMatrices(a, b)) : this.multiplyMatrices(this, a)
    }, premultiply: function (a) {
        return this.multiplyMatrices(a, this)
    }, multiplyMatrices: function (a, b) {
        var c = a.elements, d = b.elements, e = this.elements, f = c[0], g = c[4], h = c[8], i = c[12], j = c[1], k = c[5], l = c[9], m = c[13], n = c[2], o = c[6], p = c[10], q = c[14], r = c[3], s = c[7], t = c[11], u = c[15], v = d[0], w = d[4], x = d[8], y = d[12], z = d[1], A = d[5], B = d[9], C = d[13], D = d[2], E = d[6], F = d[10], G = d[14], H = d[3], I = d[7], J = d[11], K = d[15];
        return e[0] = f * v + g * z + h * D + i * H, e[4] = f * w + g * A + h * E + i * I, e[8] = f * x + g * B + h * F + i * J, e[12] = f * y + g * C + h * G + i * K, e[1] = j * v + k * z + l * D + m * H, e[5] = j * w + k * A + l * E + m * I, e[9] = j * x + k * B + l * F + m * J, e[13] = j * y + k * C + l * G + m * K, e[2] = n * v + o * z + p * D + q * H, e[6] = n * w + o * A + p * E + q * I, e[10] = n * x + o * B + p * F + q * J, e[14] = n * y + o * C + p * G + q * K, e[3] = r * v + s * z + t * D + u * H, e[7] = r * w + s * A + t * E + u * I, e[11] = r * x + s * B + t * F + u * J, e[15] = r * y + s * C + t * G + u * K, this
    }, multiplyToArray: function (a, b, c) {
        var d = this.elements;
        return this.multiplyMatrices(a, b), c[0] = d[0], c[1] = d[1], c[2] = d[2], c[3] = d[3], c[4] = d[4], c[5] = d[5], c[6] = d[6], c[7] = d[7], c[8] = d[8], c[9] = d[9], c[10] = d[10], c[11] = d[11], c[12] = d[12], c[13] = d[13], c[14] = d[14], c[15] = d[15], this
    }, multiplyScalar: function (a) {
        var b = this.elements;
        return b[0] *= a, b[4] *= a, b[8] *= a, b[12] *= a, b[1] *= a, b[5] *= a, b[9] *= a, b[13] *= a, b[2] *= a, b[6] *= a, b[10] *= a, b[14] *= a, b[3] *= a, b[7] *= a, b[11] *= a, b[15] *= a, this
    }, applyToVector3Array: function () {
        var a;
        return function (b, c, d) {
            void 0 === a && (a = new THREE.Vector3), void 0 === c && (c = 0), void 0 === d && (d = b.length);
            for (var e = 0, f = c; d > e; e += 3, f += 3)a.fromArray(b, f), a.applyMatrix4(this), a.toArray(b, f);
            return b
        }
    }(), applyToBuffer: function () {
        var a;
        return function (b, c, d) {
            void 0 === a && (a = new THREE.Vector3), void 0 === c && (c = 0), void 0 === d && (d = b.length / b.itemSize);
            for (var e = 0, f = c; d > e; e++, f++)a.x = b.getX(f), a.y = b.getY(f), a.z = b.getZ(f), a.applyMatrix4(this), b.setXYZ(a.x, a.y, a.z);
            return b
        }
    }(), determinant: function () {
        var a = this.elements, b = a[0], c = a[4], d = a[8], e = a[12], f = a[1], g = a[5], h = a[9], i = a[13], j = a[2], k = a[6], l = a[10], m = a[14], n = a[3], o = a[7], p = a[11], q = a[15];
        return n * (+e * h * k - d * i * k - e * g * l + c * i * l + d * g * m - c * h * m) + o * (+b * h * m - b * i * l + e * f * l - d * f * m + d * i * j - e * h * j) + p * (+b * i * k - b * g * m - e * f * k + c * f * m + e * g * j - c * i * j) + q * (-d * g * j - b * h * k + b * g * l + d * f * k - c * f * l + c * h * j)
    }, transpose: function () {
        var a, b = this.elements;
        return a = b[1], b[1] = b[4], b[4] = a, a = b[2], b[2] = b[8], b[8] = a, a = b[6], b[6] = b[9], b[9] = a, a = b[3], b[3] = b[12], b[12] = a, a = b[7], b[7] = b[13], b[13] = a, a = b[11], b[11] = b[14], b[14] = a, this
    }, flattenToArrayOffset: function (a, b) {
        return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."), this.toArray(a, b)
    }, getPosition: function () {
        var a;
        return function () {
            return void 0 === a && (a = new THREE.Vector3), console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."), a.setFromMatrixColumn(this, 3)
        }
    }(), setPosition: function (a) {
        var b = this.elements;
        return b[12] = a.x, b[13] = a.y, b[14] = a.z, this
    }, getInverse: function (a, b) {
        var c = this.elements, d = a.elements, e = d[0], f = d[1], g = d[2], h = d[3], i = d[4], j = d[5], k = d[6], l = d[7], m = d[8], n = d[9], o = d[10], p = d[11], q = d[12], r = d[13], s = d[14], t = d[15], u = n * s * l - r * o * l + r * k * p - j * s * p - n * k * t + j * o * t, v = q * o * l - m * s * l - q * k * p + i * s * p + m * k * t - i * o * t, w = m * r * l - q * n * l + q * j * p - i * r * p - m * j * t + i * n * t, x = q * n * k - m * r * k - q * j * o + i * r * o + m * j * s - i * n * s, y = e * u + f * v + g * w + h * x;
        if (0 === y) {
            var z = "THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";
            if (b)throw new Error(z);
            return console.warn(z), this.identity()
        }
        var A = 1 / y;
        return c[0] = u * A, c[1] = (r * o * h - n * s * h - r * g * p + f * s * p + n * g * t - f * o * t) * A, c[2] = (j * s * h - r * k * h + r * g * l - f * s * l - j * g * t + f * k * t) * A, c[3] = (n * k * h - j * o * h - n * g * l + f * o * l + j * g * p - f * k * p) * A, c[4] = v * A, c[5] = (m * s * h - q * o * h + q * g * p - e * s * p - m * g * t + e * o * t) * A, c[6] = (q * k * h - i * s * h - q * g * l + e * s * l + i * g * t - e * k * t) * A, c[7] = (i * o * h - m * k * h + m * g * l - e * o * l - i * g * p + e * k * p) * A, c[8] = w * A, c[9] = (q * n * h - m * r * h - q * f * p + e * r * p + m * f * t - e * n * t) * A, c[10] = (i * r * h - q * j * h + q * f * l - e * r * l - i * f * t + e * j * t) * A, c[11] = (m * j * h - i * n * h - m * f * l + e * n * l + i * f * p - e * j * p) * A, c[12] = x * A, c[13] = (m * r * g - q * n * g + q * f * o - e * r * o - m * f * s + e * n * s) * A, c[14] = (q * j * g - i * r * g - q * f * k + e * r * k + i * f * s - e * j * s) * A, c[15] = (i * n * g - m * j * g + m * f * k - e * n * k - i * f * o + e * j * o) * A, this
    }, scale: function (a) {
        var b = this.elements, c = a.x, d = a.y, e = a.z;
        return b[0] *= c, b[4] *= d, b[8] *= e, b[1] *= c, b[5] *= d, b[9] *= e, b[2] *= c, b[6] *= d, b[10] *= e, b[3] *= c, b[7] *= d, b[11] *= e, this
    }, getMaxScaleOnAxis: function () {
        var a = this.elements, b = a[0] * a[0] + a[1] * a[1] + a[2] * a[2], c = a[4] * a[4] + a[5] * a[5] + a[6] * a[6], d = a[8] * a[8] + a[9] * a[9] + a[10] * a[10];
        return Math.sqrt(Math.max(b, c, d))
    }, makeTranslation: function (a, b, c) {
        return this.set(1, 0, 0, a, 0, 1, 0, b, 0, 0, 1, c, 0, 0, 0, 1), this
    }, makeRotationX: function (a) {
        var b = Math.cos(a), c = Math.sin(a);
        return this.set(1, 0, 0, 0, 0, b, -c, 0, 0, c, b, 0, 0, 0, 0, 1), this
    }, makeRotationY: function (a) {
        var b = Math.cos(a), c = Math.sin(a);
        return this.set(b, 0, c, 0, 0, 1, 0, 0, -c, 0, b, 0, 0, 0, 0, 1), this
    }, makeRotationZ: function (a) {
        var b = Math.cos(a), c = Math.sin(a);
        return this.set(b, -c, 0, 0, c, b, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
    }, makeRotationAxis: function (a, b) {
        var c = Math.cos(b), d = Math.sin(b), e = 1 - c, f = a.x, g = a.y, h = a.z, i = e * f, j = e * g;
        return this.set(i * f + c, i * g - d * h, i * h + d * g, 0, i * g + d * h, j * g + c, j * h - d * f, 0, i * h - d * g, j * h + d * f, e * h * h + c, 0, 0, 0, 0, 1), this
    }, makeScale: function (a, b, c) {
        return this.set(a, 0, 0, 0, 0, b, 0, 0, 0, 0, c, 0, 0, 0, 0, 1), this
    }, compose: function (a, b, c) {
        return this.makeRotationFromQuaternion(b), this.scale(c), this.setPosition(a), this
    }, decompose: function () {
        var a, b;
        return function (c, d, e) {
            void 0 === a && (a = new THREE.Vector3, b = new THREE.Matrix4);
            var f = this.elements, g = a.set(f[0], f[1], f[2]).length(), h = a.set(f[4], f[5], f[6]).length(), i = a.set(f[8], f[9], f[10]).length(), j = this.determinant();
            0 > j && (g = -g), c.x = f[12], c.y = f[13], c.z = f[14], b.elements.set(this.elements);
            var k = 1 / g, l = 1 / h, m = 1 / i;
            return b.elements[0] *= k, b.elements[1] *= k, b.elements[2] *= k, b.elements[4] *= l, b.elements[5] *= l, b.elements[6] *= l, b.elements[8] *= m, b.elements[9] *= m, b.elements[10] *= m, d.setFromRotationMatrix(b), e.x = g, e.y = h, e.z = i, this
        }
    }(), makeFrustum: function (a, b, c, d, e, f) {
        var g = this.elements, h = 2 * e / (b - a), i = 2 * e / (d - c), j = (b + a) / (b - a), k = (d + c) / (d - c), l = -(f + e) / (f - e), m = -2 * f * e / (f - e);
        return g[0] = h, g[4] = 0, g[8] = j, g[12] = 0, g[1] = 0, g[5] = i, g[9] = k, g[13] = 0, g[2] = 0, g[6] = 0, g[10] = l, g[14] = m, g[3] = 0, g[7] = 0, g[11] = -1, g[15] = 0, this
    }, makePerspective: function (a, b, c, d) {
        var e = c * Math.tan(THREE.Math.DEG2RAD * a * .5), f = -e, g = f * b, h = e * b;
        return this.makeFrustum(g, h, f, e, c, d)
    }, makeOrthographic: function (a, b, c, d, e, f) {
        var g = this.elements, h = 1 / (b - a), i = 1 / (c - d), j = 1 / (f - e), k = (b + a) * h, l = (c + d) * i, m = (f + e) * j;
        return g[0] = 2 * h, g[4] = 0, g[8] = 0, g[12] = -k, g[1] = 0, g[5] = 2 * i, g[9] = 0, g[13] = -l, g[2] = 0, g[6] = 0, g[10] = -2 * j, g[14] = -m, g[3] = 0, g[7] = 0, g[11] = 0, g[15] = 1, this
    }, equals: function (a) {
        for (var b = this.elements, c = a.elements, d = 0; 16 > d; d++)if (b[d] !== c[d])return !1;
        return !0
    }, fromArray: function (a) {
        return this.elements.set(a), this
    }, toArray: function (a, b) {
        void 0 === a && (a = []), void 0 === b && (b = 0);
        var c = this.elements;
        return a[b] = c[0], a[b + 1] = c[1], a[b + 2] = c[2], a[b + 3] = c[3], a[b + 4] = c[4], a[b + 5] = c[5], a[b + 6] = c[6], a[b + 7] = c[7], a[b + 8] = c[8], a[b + 9] = c[9], a[b + 10] = c[10], a[b + 11] = c[11], a[b + 12] = c[12], a[b + 13] = c[13], a[b + 14] = c[14], a[b + 15] = c[15], a
    }
}, THREE.Ray = function (a, b) {
    this.origin = void 0 !== a ? a : new THREE.Vector3, this.direction = void 0 !== b ? b : new THREE.Vector3
}, THREE.Ray.prototype = {
    constructor: THREE.Ray, set: function (a, b) {
        return this.origin.copy(a), this.direction.copy(b), this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.origin.copy(a.origin), this.direction.copy(a.direction), this
    }, at: function (a, b) {
        var c = b || new THREE.Vector3;
        return c.copy(this.direction).multiplyScalar(a).add(this.origin)
    }, lookAt: function (a) {
        return this.direction.copy(a).sub(this.origin).normalize(), this
    }, recast: function () {
        var a = new THREE.Vector3;
        return function (b) {
            return this.origin.copy(this.at(b, a)), this
        }
    }(), closestPointToPoint: function (a, b) {
        var c = b || new THREE.Vector3;
        c.subVectors(a, this.origin);
        var d = c.dot(this.direction);
        return 0 > d ? c.copy(this.origin) : c.copy(this.direction).multiplyScalar(d).add(this.origin)
    }, distanceToPoint: function (a) {
        return Math.sqrt(this.distanceSqToPoint(a))
    }, distanceSqToPoint: function () {
        var a = new THREE.Vector3;
        return function (b) {
            var c = a.subVectors(b, this.origin).dot(this.direction);
            return 0 > c ? this.origin.distanceToSquared(b) : (a.copy(this.direction).multiplyScalar(c).add(this.origin), a.distanceToSquared(b))
        }
    }(), distanceSqToSegment: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Vector3;
        return function (d, e, f, g) {
            a.copy(d).add(e).multiplyScalar(.5), b.copy(e).sub(d).normalize(), c.copy(this.origin).sub(a);
            var h, i, j, k, l = .5 * d.distanceTo(e), m = -this.direction.dot(b), n = c.dot(this.direction), o = -c.dot(b), p = c.lengthSq(), q = Math.abs(1 - m * m);
            if (q > 0)if (h = m * o - n, i = m * n - o, k = l * q, h >= 0)if (i >= -k)if (k >= i) {
                var r = 1 / q;
                h *= r, i *= r, j = h * (h + m * i + 2 * n) + i * (m * h + i + 2 * o) + p
            } else i = l, h = Math.max(0, -(m * i + n)), j = -h * h + i * (i + 2 * o) + p; else i = -l, h = Math.max(0, -(m * i + n)), j = -h * h + i * (i + 2 * o) + p; else-k >= i ? (h = Math.max(0, -(-m * l + n)), i = h > 0 ? -l : Math.min(Math.max(-l, -o), l), j = -h * h + i * (i + 2 * o) + p) : k >= i ? (h = 0, i = Math.min(Math.max(-l, -o), l), j = i * (i + 2 * o) + p) : (h = Math.max(0, -(m * l + n)), i = h > 0 ? l : Math.min(Math.max(-l, -o), l), j = -h * h + i * (i + 2 * o) + p); else i = m > 0 ? -l : l, h = Math.max(0, -(m * i + n)), j = -h * h + i * (i + 2 * o) + p;
            return f && f.copy(this.direction).multiplyScalar(h).add(this.origin), g && g.copy(b).multiplyScalar(i).add(a), j
        }
    }(), intersectSphere: function () {
        var a = new THREE.Vector3;
        return function (b, c) {
            a.subVectors(b.center, this.origin);
            var d = a.dot(this.direction), e = a.dot(a) - d * d, f = b.radius * b.radius;
            if (e > f)return null;
            var g = Math.sqrt(f - e), h = d - g, i = d + g;
            return 0 > h && 0 > i ? null : 0 > h ? this.at(i, c) : this.at(h, c)
        }
    }(), intersectsSphere: function (a) {
        return this.distanceToPoint(a.center) <= a.radius
    }, distanceToPlane: function (a) {
        var b = a.normal.dot(this.direction);
        if (0 === b)return 0 === a.distanceToPoint(this.origin) ? 0 : null;
        var c = -(this.origin.dot(a.normal) + a.constant) / b;
        return c >= 0 ? c : null
    }, intersectPlane: function (a, b) {
        var c = this.distanceToPlane(a);
        return null === c ? null : this.at(c, b)
    }, intersectsPlane: function (a) {
        var b = a.distanceToPoint(this.origin);
        if (0 === b)return !0;
        var c = a.normal.dot(this.direction);
        return 0 > c * b ? !0 : !1
    }, intersectBox: function (a, b) {
        var c, d, e, f, g, h, i = 1 / this.direction.x, j = 1 / this.direction.y, k = 1 / this.direction.z, l = this.origin;
        return i >= 0 ? (c = (a.min.x - l.x) * i, d = (a.max.x - l.x) * i) : (c = (a.max.x - l.x) * i, d = (a.min.x - l.x) * i), j >= 0 ? (e = (a.min.y - l.y) * j, f = (a.max.y - l.y) * j) : (e = (a.max.y - l.y) * j, f = (a.min.y - l.y) * j), c > f || e > d ? null : ((e > c || c !== c) && (c = e), (d > f || d !== d) && (d = f), k >= 0 ? (g = (a.min.z - l.z) * k, h = (a.max.z - l.z) * k) : (g = (a.max.z - l.z) * k, h = (a.min.z - l.z) * k), c > h || g > d ? null : ((g > c || c !== c) && (c = g), (d > h || d !== d) && (d = h), 0 > d ? null : this.at(c >= 0 ? c : d, b)))
    }, intersectsBox: function () {
        var a = new THREE.Vector3;
        return function (b) {
            return null !== this.intersectBox(b, a)
        }
    }(), intersectTriangle: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Vector3, d = new THREE.Vector3;
        return function (e, f, g, h, i) {
            b.subVectors(f, e), c.subVectors(g, e), d.crossVectors(b, c);
            var j, k = this.direction.dot(d);
            if (k > 0) {
                if (h)return null;
                j = 1
            } else {
                if (!(0 > k))return null;
                j = -1, k = -k
            }
            a.subVectors(this.origin, e);
            var l = j * this.direction.dot(c.crossVectors(a, c));
            if (0 > l)return null;
            var m = j * this.direction.dot(b.cross(a));
            if (0 > m)return null;
            if (l + m > k)return null;
            var n = -j * a.dot(d);
            return 0 > n ? null : this.at(n / k, i)
        }
    }(), applyMatrix4: function (a) {
        return this.direction.add(this.origin).applyMatrix4(a), this.origin.applyMatrix4(a), this.direction.sub(this.origin), this.direction.normalize(), this
    }, equals: function (a) {
        return a.origin.equals(this.origin) && a.direction.equals(this.direction)
    }
}, THREE.Sphere = function (a, b) {
    this.center = void 0 !== a ? a : new THREE.Vector3, this.radius = void 0 !== b ? b : 0
}, THREE.Sphere.prototype = {
    constructor: THREE.Sphere, set: function (a, b) {
        return this.center.copy(a), this.radius = b, this
    }, setFromPoints: function () {
        var a = new THREE.Box3;
        return function (b, c) {
            var d = this.center;
            void 0 !== c ? d.copy(c) : a.setFromPoints(b).center(d);
            for (var e = 0, f = 0, g = b.length; g > f; f++)e = Math.max(e, d.distanceToSquared(b[f]));
            return this.radius = Math.sqrt(e), this
        }
    }(), clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.center.copy(a.center), this.radius = a.radius, this
    }, empty: function () {
        return this.radius <= 0
    }, containsPoint: function (a) {
        return a.distanceToSquared(this.center) <= this.radius * this.radius
    }, distanceToPoint: function (a) {
        return a.distanceTo(this.center) - this.radius
    }, intersectsSphere: function (a) {
        var b = this.radius + a.radius;
        return a.center.distanceToSquared(this.center) <= b * b
    }, intersectsBox: function (a) {
        return a.intersectsSphere(this)
    }, intersectsPlane: function (a) {
        return Math.abs(this.center.dot(a.normal) - a.constant) <= this.radius
    }, clampPoint: function (a, b) {
        var c = this.center.distanceToSquared(a), d = b || new THREE.Vector3;
        return d.copy(a), c > this.radius * this.radius && (d.sub(this.center).normalize(), d.multiplyScalar(this.radius).add(this.center)), d
    }, getBoundingBox: function (a) {
        var b = a || new THREE.Box3;
        return b.set(this.center, this.center), b.expandByScalar(this.radius), b
    }, applyMatrix4: function (a) {
        return this.center.applyMatrix4(a), this.radius = this.radius * a.getMaxScaleOnAxis(), this
    }, translate: function (a) {
        return this.center.add(a), this
    }, equals: function (a) {
        return a.center.equals(this.center) && a.radius === this.radius
    }
}, THREE.Frustum = function (a, b, c, d, e, f) {
    this.planes = [void 0 !== a ? a : new THREE.Plane, void 0 !== b ? b : new THREE.Plane, void 0 !== c ? c : new THREE.Plane, void 0 !== d ? d : new THREE.Plane, void 0 !== e ? e : new THREE.Plane, void 0 !== f ? f : new THREE.Plane]
}, THREE.Frustum.prototype = {
    constructor: THREE.Frustum, set: function (a, b, c, d, e, f) {
        var g = this.planes;
        return g[0].copy(a), g[1].copy(b), g[2].copy(c), g[3].copy(d), g[4].copy(e), g[5].copy(f), this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        for (var b = this.planes, c = 0; 6 > c; c++)b[c].copy(a.planes[c]);
        return this
    }, setFromMatrix: function (a) {
        var b = this.planes, c = a.elements, d = c[0], e = c[1], f = c[2], g = c[3], h = c[4], i = c[5], j = c[6], k = c[7], l = c[8], m = c[9], n = c[10], o = c[11], p = c[12], q = c[13], r = c[14], s = c[15];
        return b[0].setComponents(g - d, k - h, o - l, s - p).normalize(), b[1].setComponents(g + d, k + h, o + l, s + p).normalize(), b[2].setComponents(g + e, k + i, o + m, s + q).normalize(), b[3].setComponents(g - e, k - i, o - m, s - q).normalize(), b[4].setComponents(g - f, k - j, o - n, s - r).normalize(), b[5].setComponents(g + f, k + j, o + n, s + r).normalize(), this
    }, intersectsObject: function () {
        var a = new THREE.Sphere;
        return function (b) {
            var c = b.geometry;
            return null === c.boundingSphere && c.computeBoundingSphere(), a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld), this.intersectsSphere(a)
        }
    }(), intersectsSprite: function () {
        var a = new THREE.Sphere;
        return function (b) {
            return a.center.set(0, 0, 0), a.radius = .7071067811865476, a.applyMatrix4(b.matrixWorld), this.intersectsSphere(a)
        }
    }(), intersectsSphere: function (a) {
        for (var b = this.planes, c = a.center, d = -a.radius, e = 0; 6 > e; e++) {
            var f = b[e].distanceToPoint(c);
            if (d > f)return !1
        }
        return !0
    }, intersectsBox: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3;
        return function (c) {
            for (var d = this.planes, e = 0; 6 > e; e++) {
                var f = d[e];
                a.x = f.normal.x > 0 ? c.min.x : c.max.x, b.x = f.normal.x > 0 ? c.max.x : c.min.x, a.y = f.normal.y > 0 ? c.min.y : c.max.y, b.y = f.normal.y > 0 ? c.max.y : c.min.y, a.z = f.normal.z > 0 ? c.min.z : c.max.z, b.z = f.normal.z > 0 ? c.max.z : c.min.z;
                var g = f.distanceToPoint(a), h = f.distanceToPoint(b);
                if (0 > g && 0 > h)return !1
            }
            return !0
        }
    }(), containsPoint: function (a) {
        for (var b = this.planes, c = 0; 6 > c; c++)if (b[c].distanceToPoint(a) < 0)return !1;
        return !0
    }
}, THREE.Plane = function (a, b) {
    this.normal = void 0 !== a ? a : new THREE.Vector3(1, 0, 0), this.constant = void 0 !== b ? b : 0
}, THREE.Plane.prototype = {
    constructor: THREE.Plane, set: function (a, b) {
        return this.normal.copy(a), this.constant = b, this
    }, setComponents: function (a, b, c, d) {
        return this.normal.set(a, b, c), this.constant = d, this
    }, setFromNormalAndCoplanarPoint: function (a, b) {
        return this.normal.copy(a), this.constant = -b.dot(this.normal), this
    }, setFromCoplanarPoints: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3;
        return function (c, d, e) {
            var f = a.subVectors(e, d).cross(b.subVectors(c, d)).normalize();
            return this.setFromNormalAndCoplanarPoint(f, c), this
        }
    }(), clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.normal.copy(a.normal), this.constant = a.constant, this
    }, normalize: function () {
        var a = 1 / this.normal.length();
        return this.normal.multiplyScalar(a), this.constant *= a, this
    }, negate: function () {
        return this.constant *= -1, this.normal.negate(), this
    }, distanceToPoint: function (a) {
        return this.normal.dot(a) + this.constant
    }, distanceToSphere: function (a) {
        return this.distanceToPoint(a.center) - a.radius
    }, projectPoint: function (a, b) {
        return this.orthoPoint(a, b).sub(a).negate()
    }, orthoPoint: function (a, b) {
        var c = this.distanceToPoint(a), d = b || new THREE.Vector3;
        return d.copy(this.normal).multiplyScalar(c)
    }, intersectLine: function () {
        var a = new THREE.Vector3;
        return function (b, c) {
            var d = c || new THREE.Vector3, e = b.delta(a), f = this.normal.dot(e);
            if (0 === f)return 0 === this.distanceToPoint(b.start) ? d.copy(b.start) : void 0;
            var g = -(b.start.dot(this.normal) + this.constant) / f;
            return 0 > g || g > 1 ? void 0 : d.copy(e).multiplyScalar(g).add(b.start)
        }
    }(), intersectsLine: function (a) {
        var b = this.distanceToPoint(a.start), c = this.distanceToPoint(a.end);
        return 0 > b && c > 0 || 0 > c && b > 0
    }, intersectsBox: function (a) {
        return a.intersectsPlane(this)
    }, intersectsSphere: function (a) {
        return a.intersectsPlane(this)
    }, coplanarPoint: function (a) {
        var b = a || new THREE.Vector3;
        return b.copy(this.normal).multiplyScalar(-this.constant)
    }, applyMatrix4: function () {
        var a = new THREE.Vector3, b = new THREE.Matrix3;
        return function (c, d) {
            var e = this.coplanarPoint(a).applyMatrix4(c), f = d || b.getNormalMatrix(c), g = this.normal.applyMatrix3(f).normalize();
            return this.constant = -e.dot(g), this
        }
    }(), translate: function (a) {
        return this.constant = this.constant - a.dot(this.normal), this
    }, equals: function (a) {
        return a.normal.equals(this.normal) && a.constant === this.constant
    }
}, THREE.Spherical = function (a, b, c) {
    return this.radius = void 0 !== a ? a : 1, this.phi = void 0 !== b ? b : 0, this.theta = void 0 !== c ? c : 0, this
}, THREE.Spherical.prototype = {
    constructor: THREE.Spherical, set: function (a, b, c) {
        return this.radius = a, this.phi = b, this.theta = c, this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.radius.copy(a.radius), this.phi.copy(a.phi), this.theta.copy(a.theta), this
    }, makeSafe: function () {
        var a = 1e-6;
        return this.phi = Math.max(a, Math.min(Math.PI - a, this.phi)), this
    }, setFromVector3: function (a) {
        return this.radius = a.length(), 0 === this.radius ? (this.theta = 0, this.phi = 0) : (this.theta = Math.atan2(a.x, a.z), this.phi = Math.acos(THREE.Math.clamp(a.y / this.radius, -1, 1))), this
    }
}, THREE.Math = {
    DEG2RAD: Math.PI / 180, RAD2DEG: 180 / Math.PI, generateUUID: function () {
        var a, b = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), c = new Array(36), d = 0;
        return function () {
            for (var e = 0; 36 > e; e++)8 === e || 13 === e || 18 === e || 23 === e ? c[e] = "-" : 14 === e ? c[e] = "4" : (2 >= d && (d = 33554432 + 16777216 * Math.random() | 0), a = 15 & d, d >>= 4, c[e] = b[19 === e ? 3 & a | 8 : a]);
            return c.join("")
        }
    }(), clamp: function (a, b, c) {
        return Math.max(b, Math.min(c, a))
    }, euclideanModulo: function (a, b) {
        return (a % b + b) % b
    }, mapLinear: function (a, b, c, d, e) {
        return d + (a - b) * (e - d) / (c - b)
    }, smoothstep: function (a, b, c) {
        return b >= a ? 0 : a >= c ? 1 : (a = (a - b) / (c - b), a * a * (3 - 2 * a))
    }, smootherstep: function (a, b, c) {
        return b >= a ? 0 : a >= c ? 1 : (a = (a - b) / (c - b), a * a * a * (a * (6 * a - 15) + 10))
    }, random16: function () {
        return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."), Math.random()
    }, randInt: function (a, b) {
        return a + Math.floor(Math.random() * (b - a + 1))
    }, randFloat: function (a, b) {
        return a + Math.random() * (b - a)
    }, randFloatSpread: function (a) {
        return a * (.5 - Math.random())
    }, degToRad: function (a) {
        return a * THREE.Math.DEG2RAD
    }, radToDeg: function (a) {
        return a * THREE.Math.RAD2DEG
    }, isPowerOfTwo: function (a) {
        return 0 === (a & a - 1) && 0 !== a
    }, nearestPowerOfTwo: function (a) {
        return Math.pow(2, Math.round(Math.log(a) / Math.LN2))
    }, nextPowerOfTwo: function (a) {
        return a--, a |= a >> 1, a |= a >> 2, a |= a >> 4, a |= a >> 8, a |= a >> 16, a++, a
    }
}, THREE.Spline = function (a) {
    function b(a, b, c, d, e, f, g) {
        var h = .5 * (c - a), i = .5 * (d - b);
        return (2 * (b - c) + h + i) * g + (-3 * (b - c) - 2 * h - i) * f + h * e + b
    }

    this.points = a;
    var c, d, e, f, g, h, i, j, k, l = [], m = {x: 0, y: 0, z: 0};
    this.initFromArray = function (a) {
        this.points = [];
        for (var b = 0; b < a.length; b++)this.points[b] = {x: a[b][0], y: a[b][1], z: a[b][2]}
    }, this.getPoint = function (a) {
        return c = (this.points.length - 1) * a, d = Math.floor(c), e = c - d, l[0] = 0 === d ? d : d - 1, l[1] = d, l[2] = d > this.points.length - 2 ? this.points.length - 1 : d + 1, l[3] = d > this.points.length - 3 ? this.points.length - 1 : d + 2, h = this.points[l[0]], i = this.points[l[1]], j = this.points[l[2]], k = this.points[l[3]], f = e * e, g = e * f, m.x = b(h.x, i.x, j.x, k.x, e, f, g), m.y = b(h.y, i.y, j.y, k.y, e, f, g), m.z = b(h.z, i.z, j.z, k.z, e, f, g), m
    }, this.getControlPointsArray = function () {
        var a, b, c = this.points.length, d = [];
        for (a = 0; c > a; a++)b = this.points[a], d[a] = [b.x, b.y, b.z];
        return d
    }, this.getLength = function (a) {
        var b, c, d, e, f = 0, g = 0, h = 0, i = new THREE.Vector3, j = new THREE.Vector3, k = [], l = 0;
        for (k[0] = 0, a || (a = 100), d = this.points.length * a, i.copy(this.points[0]), b = 1; d > b; b++)c = b / d, e = this.getPoint(c), j.copy(e), l += j.distanceTo(i), i.copy(e), f = (this.points.length - 1) * c, g = Math.floor(f), g !== h && (k[g] = l, h = g);
        return k[k.length] = l, {chunks: k, total: l}
    }, this.reparametrizeByArcLength = function (a) {
        var b, c, d, e, f, g, h, i, j = [], k = new THREE.Vector3, l = this.getLength();
        for (j.push(k.copy(this.points[0]).clone()), b = 1; b < this.points.length; b++) {
            for (g = l.chunks[b] - l.chunks[b - 1], h = Math.ceil(a * g / l.total), e = (b - 1) / (this.points.length - 1), f = b / (this.points.length - 1), c = 1; h - 1 > c; c++)d = e + c * (1 / h) * (f - e), i = this.getPoint(d), j.push(k.copy(i).clone());
            j.push(k.copy(this.points[b]).clone())
        }
        this.points = j
    }
}, THREE.Triangle = function (a, b, c) {
    this.a = void 0 !== a ? a : new THREE.Vector3, this.b = void 0 !== b ? b : new THREE.Vector3, this.c = void 0 !== c ? c : new THREE.Vector3
}, THREE.Triangle.normal = function () {
    var a = new THREE.Vector3;
    return function (b, c, d, e) {
        var f = e || new THREE.Vector3;
        f.subVectors(d, c), a.subVectors(b, c), f.cross(a);
        var g = f.lengthSq();
        return g > 0 ? f.multiplyScalar(1 / Math.sqrt(g)) : f.set(0, 0, 0)
    }
}(), THREE.Triangle.barycoordFromPoint = function () {
    var a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Vector3;
    return function (d, e, f, g, h) {
        a.subVectors(g, e), b.subVectors(f, e), c.subVectors(d, e);
        var i = a.dot(a), j = a.dot(b), k = a.dot(c), l = b.dot(b), m = b.dot(c), n = i * l - j * j, o = h || new THREE.Vector3;
        if (0 === n)return o.set(-2, -1, -1);
        var p = 1 / n, q = (l * k - j * m) * p, r = (i * m - j * k) * p;
        return o.set(1 - q - r, r, q)
    }
}(), THREE.Triangle.containsPoint = function () {
    var a = new THREE.Vector3;
    return function (b, c, d, e) {
        var f = THREE.Triangle.barycoordFromPoint(b, c, d, e, a);
        return f.x >= 0 && f.y >= 0 && f.x + f.y <= 1
    }
}(), THREE.Triangle.prototype = {
    constructor: THREE.Triangle, set: function (a, b, c) {
        return this.a.copy(a), this.b.copy(b), this.c.copy(c), this
    }, setFromPointsAndIndices: function (a, b, c, d) {
        return this.a.copy(a[b]), this.b.copy(a[c]), this.c.copy(a[d]), this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.a.copy(a.a), this.b.copy(a.b), this.c.copy(a.c), this
    }, area: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3;
        return function () {
            return a.subVectors(this.c, this.b), b.subVectors(this.a, this.b), .5 * a.cross(b).length()
        }
    }(), midpoint: function (a) {
        var b = a || new THREE.Vector3;
        return b.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3)
    }, normal: function (a) {
        return THREE.Triangle.normal(this.a, this.b, this.c, a)
    }, plane: function (a) {
        var b = a || new THREE.Plane;
        return b.setFromCoplanarPoints(this.a, this.b, this.c)
    }, barycoordFromPoint: function (a, b) {
        return THREE.Triangle.barycoordFromPoint(a, this.a, this.b, this.c, b)
    }, containsPoint: function (a) {
        return THREE.Triangle.containsPoint(a, this.a, this.b, this.c)
    }, closestPointToPoint: function () {
        var a, b, c, d;
        return function (e, f) {
            void 0 === a && (a = new THREE.Plane, b = [new THREE.Line3, new THREE.Line3, new THREE.Line3], c = new THREE.Vector3, d = new THREE.Vector3);
            var g = f || new THREE.Vector3, h = 1 / 0;
            if (a.setFromCoplanarPoints(this.a, this.b, this.c), a.projectPoint(e, c), this.containsPoint(c) === !0)g.copy(c); else {
                b[0].set(this.a, this.b), b[1].set(this.b, this.c), b[2].set(this.c, this.a);
                for (var i = 0; i < b.length; i++) {
                    b[i].closestPointToPoint(c, !0, d);
                    var j = c.distanceToSquared(d);
                    h > j && (h = j, g.copy(d))
                }
            }
            return g
        }
    }(), equals: function (a) {
        return a.a.equals(this.a) && a.b.equals(this.b) && a.c.equals(this.c)
    }
}, THREE.Interpolant = function (a, b, c, d) {
    this.parameterPositions = a, this._cachedIndex = 0, this.resultBuffer = void 0 !== d ? d : new b.constructor(c), this.sampleValues = b, this.valueSize = c
}, THREE.Interpolant.prototype = {
    constructor: THREE.Interpolant, evaluate: function (a) {
        var b = this.parameterPositions, c = this._cachedIndex, d = b[c], e = b[c - 1];
        a:{
            b:{
                var f;
                c:{
                    d:if (!(d > a)) {
                        for (var g = c + 2; ;) {
                            if (void 0 === d) {
                                if (e > a)break d;
                                return c = b.length, this._cachedIndex = c, this.afterEnd_(c - 1, a, e)
                            }
                            if (c === g)break;
                            if (e = d, d = b[++c], d > a)break b
                        }
                        f = b.length;
                        break c
                    }
                    {
                        if (a >= e)break a;
                        var h = b[1];
                        h > a && (c = 2, e = h);
                        for (var g = c - 2; ;) {
                            if (void 0 === e)return this._cachedIndex = 0, this.beforeStart_(0, a, d);
                            if (c === g)break;
                            if (d = e, e = b[--c - 1], a >= e)break b
                        }
                        f = c, c = 0
                    }
                }
                for (; f > c;) {
                    var i = c + f >>> 1;
                    a < b[i] ? f = i : c = i + 1
                }
                if (d = b[c], e = b[c - 1], void 0 === e)return this._cachedIndex = 0, this.beforeStart_(0, a, d);
                if (void 0 === d)return c = b.length, this._cachedIndex = c, this.afterEnd_(c - 1, e, a)
            }
            this._cachedIndex = c, this.intervalChanged_(c, e, d)
        }
        return this.interpolate_(c, e, a, d)
    }, settings: null, DefaultSettings_: {}, getSettings_: function () {
        return this.settings || this.DefaultSettings_
    }, copySampleValue_: function (a) {
        for (var b = this.resultBuffer, c = this.sampleValues, d = this.valueSize, e = a * d, f = 0; f !== d; ++f)b[f] = c[e + f];
        return b
    }, interpolate_: function (a, b, c, d) {
        throw new Error("call to abstract method")
    }, intervalChanged_: function (a, b, c) {
    }
}, Object.assign(THREE.Interpolant.prototype, {
    beforeStart_: THREE.Interpolant.prototype.copySampleValue_,
    afterEnd_: THREE.Interpolant.prototype.copySampleValue_
}), THREE.CubicInterpolant = function (a, b, c, d) {
    THREE.Interpolant.call(this, a, b, c, d), this._weightPrev = -0, this._offsetPrev = -0, this._weightNext = -0, this._offsetNext = -0
}, THREE.CubicInterpolant.prototype = Object.assign(Object.create(THREE.Interpolant.prototype), {
    constructor: THREE.CubicInterpolant,
    DefaultSettings_: {endingStart: THREE.ZeroCurvatureEnding, endingEnd: THREE.ZeroCurvatureEnding},
    intervalChanged_: function (a, b, c) {
        var d = this.parameterPositions, e = a - 2, f = a + 1, g = d[e], h = d[f];
        if (void 0 === g)switch (this.getSettings_().endingStart) {
            case THREE.ZeroSlopeEnding:
                e = a, g = 2 * b - c;
                break;
            case THREE.WrapAroundEnding:
                e = d.length - 2, g = b + d[e] - d[e + 1];
                break;
            default:
                e = a, g = c
        }
        if (void 0 === h)switch (this.getSettings_().endingEnd) {
            case THREE.ZeroSlopeEnding:
                f = a, h = 2 * c - b;
                break;
            case THREE.WrapAroundEnding:
                f = 1, h = c + d[1] - d[0];
                break;
            default:
                f = a - 1, h = b
        }
        var i = .5 * (c - b), j = this.valueSize;
        this._weightPrev = i / (b - g), this._weightNext = i / (h - c), this._offsetPrev = e * j, this._offsetNext = f * j
    },
    interpolate_: function (a, b, c, d) {
        for (var e = this.resultBuffer, f = this.sampleValues, g = this.valueSize, h = a * g, i = h - g, j = this._offsetPrev, k = this._offsetNext, l = this._weightPrev, m = this._weightNext, n = (c - b) / (d - b), o = n * n, p = o * n, q = -l * p + 2 * l * o - l * n, r = (1 + l) * p + (-1.5 - 2 * l) * o + (-.5 + l) * n + 1, s = (-1 - m) * p + (1.5 + m) * o + .5 * n, t = m * p - m * o, u = 0; u !== g; ++u)e[u] = q * f[j + u] + r * f[i + u] + s * f[h + u] + t * f[k + u];
        return e
    }
}), THREE.DiscreteInterpolant = function (a, b, c, d) {
    THREE.Interpolant.call(this, a, b, c, d)
}, THREE.DiscreteInterpolant.prototype = Object.assign(Object.create(THREE.Interpolant.prototype), {
    constructor: THREE.DiscreteInterpolant,
    interpolate_: function (a, b, c, d) {
        return this.copySampleValue_(a - 1)
    }
}), THREE.LinearInterpolant = function (a, b, c, d) {
    THREE.Interpolant.call(this, a, b, c, d)
}, THREE.LinearInterpolant.prototype = Object.assign(Object.create(THREE.Interpolant.prototype), {
    constructor: THREE.LinearInterpolant,
    interpolate_: function (a, b, c, d) {
        for (var e = this.resultBuffer, f = this.sampleValues, g = this.valueSize, h = a * g, i = h - g, j = (c - b) / (d - b), k = 1 - j, l = 0; l !== g; ++l)e[l] = f[i + l] * k + f[h + l] * j;
        return e
    }
}), THREE.QuaternionLinearInterpolant = function (a, b, c, d) {
    THREE.Interpolant.call(this, a, b, c, d)
}, THREE.QuaternionLinearInterpolant.prototype = Object.assign(Object.create(THREE.Interpolant.prototype), {
    constructor: THREE.QuaternionLinearInterpolant,
    interpolate_: function (a, b, c, d) {
        for (var e = this.resultBuffer, f = this.sampleValues, g = this.valueSize, h = a * g, i = (c - b) / (d - b), j = h + g; h !== j; h += 4)THREE.Quaternion.slerpFlat(e, 0, f, h - g, f, h, i);
        return e
    }
}), THREE.Clock = function (a) {
    this.autoStart = void 0 !== a ? a : !0, this.startTime = 0, this.oldTime = 0, this.elapsedTime = 0, this.running = !1
}, THREE.Clock.prototype = {
    constructor: THREE.Clock, start: function () {
        this.startTime = (performance || Date).now(), this.oldTime = this.startTime, this.running = !0
    }, stop: function () {
        this.getElapsedTime(), this.running = !1
    }, getElapsedTime: function () {
        return this.getDelta(), this.elapsedTime
    }, getDelta: function () {
        var a = 0;
        if (this.autoStart && !this.running && this.start(), this.running) {
            var b = (performance || Date).now();
            a = (b - this.oldTime) / 1e3, this.oldTime = b, this.elapsedTime += a
        }
        return a
    }
}, THREE.EventDispatcher = function () {
}, Object.assign(THREE.EventDispatcher.prototype, {
    addEventListener: function (a, b) {
        void 0 === this._listeners && (this._listeners = {});
        var c = this._listeners;
        void 0 === c[a] && (c[a] = []), -1 === c[a].indexOf(b) && c[a].push(b)
    }, hasEventListener: function (a, b) {
        if (void 0 === this._listeners)return !1;
        var c = this._listeners;
        return void 0 !== c[a] && -1 !== c[a].indexOf(b) ? !0 : !1
    }, removeEventListener: function (a, b) {
        if (void 0 !== this._listeners) {
            var c = this._listeners, d = c[a];
            if (void 0 !== d) {
                var e = d.indexOf(b);
                -1 !== e && d.splice(e, 1)
            }
        }
    }, dispatchEvent: function (a) {
        if (void 0 !== this._listeners) {
            var b = this._listeners, c = b[a.type];
            if (void 0 !== c) {
                a.target = this;
                var d = [], e = 0, f = c.length;
                for (e = 0; f > e; e++)d[e] = c[e];
                for (e = 0; f > e; e++)d[e].call(this, a)
            }
        }
    }
}), THREE.Layers = function () {
    this.mask = 1
}, THREE.Layers.prototype = {
    constructor: THREE.Layers, set: function (a) {
        this.mask = 1 << a
    }, enable: function (a) {
        this.mask |= 1 << a
    }, toggle: function (a) {
        this.mask ^= 1 << a
    }, disable: function (a) {
        this.mask &= ~(1 << a)
    }, test: function (a) {
        return 0 !== (this.mask & a.mask)
    }
}, function (a) {
    function b(a, b) {
        return a.distance - b.distance
    }

    function c(a, b, d, e) {
        if (a.visible !== !1 && (a.raycast(b, d), e === !0))for (var f = a.children, g = 0, h = f.length; h > g; g++)c(f[g], b, d, !0)
    }

    a.Raycaster = function (b, c, d, e) {
        this.ray = new a.Ray(b, c), this.near = d || 0, this.far = e || 1 / 0, this.params = {
            Mesh: {},
            Line: {},
            LOD: {},
            Points: {threshold: 1},
            Sprite: {}
        }, Object.defineProperties(this.params, {
            PointCloud: {
                get: function () {
                    return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."), this.Points
                }
            }
        })
    }, a.Raycaster.prototype = {
        constructor: a.Raycaster, linePrecision: 1, set: function (a, b) {
            this.ray.set(a, b)
        }, setFromCamera: function (b, c) {
            c instanceof a.PerspectiveCamera ? (this.ray.origin.setFromMatrixPosition(c.matrixWorld), this.ray.direction.set(b.x, b.y, .5).unproject(c).sub(this.ray.origin).normalize()) : c instanceof a.OrthographicCamera ? (this.ray.origin.set(b.x, b.y, (c.near + c.far) / (c.near - c.far)).unproject(c), this.ray.direction.set(0, 0, -1).transformDirection(c.matrixWorld)) : console.error("THREE.Raycaster: Unsupported camera type.")
        }, intersectObject: function (a, d) {
            var e = [];
            return c(a, this, e, d), e.sort(b), e
        }, intersectObjects: function (a, d) {
            var e = [];
            if (Array.isArray(a) === !1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."), e;
            for (var f = 0, g = a.length; g > f; f++)c(a[f], this, e, d);
            return e.sort(b), e
        }
    }
}(THREE), THREE.Object3D = function () {
    function a() {
        e.setFromEuler(d, !1)
    }

    function b() {
        d.setFromQuaternion(e, void 0, !1)
    }

    Object.defineProperty(this, "id", {value: THREE.Object3DIdCount++}), this.uuid = THREE.Math.generateUUID(), this.name = "", this.type = "Object3D", this.parent = null, this.children = [], this.up = THREE.Object3D.DefaultUp.clone();
    var c = new THREE.Vector3, d = new THREE.Euler, e = new THREE.Quaternion, f = new THREE.Vector3(1, 1, 1);
    d.onChange(a), e.onChange(b), Object.defineProperties(this, {
        position: {enumerable: !0, value: c},
        rotation: {enumerable: !0, value: d},
        quaternion: {enumerable: !0, value: e},
        scale: {enumerable: !0, value: f},
        modelViewMatrix: {value: new THREE.Matrix4},
        normalMatrix: {
            value: new THREE.Matrix3
        }
    }), this.matrix = new THREE.Matrix4, this.matrixWorld = new THREE.Matrix4, this.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate, this.matrixWorldNeedsUpdate = !1, this.layers = new THREE.Layers, this.visible = !0, this.castShadow = !1, this.receiveShadow = !1, this.frustumCulled = !0, this.renderOrder = 0, this.userData = {}
}, THREE.Object3D.DefaultUp = new THREE.Vector3(0, 1, 0), THREE.Object3D.DefaultMatrixAutoUpdate = !0, Object.assign(THREE.Object3D.prototype, THREE.EventDispatcher.prototype, {
    applyMatrix: function (a) {
        this.matrix.multiplyMatrices(a, this.matrix), this.matrix.decompose(this.position, this.quaternion, this.scale)
    }, setRotationFromAxisAngle: function (a, b) {
        this.quaternion.setFromAxisAngle(a, b)
    }, setRotationFromEuler: function (a) {
        this.quaternion.setFromEuler(a, !0)
    }, setRotationFromMatrix: function (a) {
        this.quaternion.setFromRotationMatrix(a)
    }, setRotationFromQuaternion: function (a) {
        this.quaternion.copy(a)
    }, rotateOnAxis: function () {
        var a = new THREE.Quaternion;
        return function (b, c) {
            return a.setFromAxisAngle(b, c), this.quaternion.multiply(a), this
        }
    }(), rotateX: function () {
        var a = new THREE.Vector3(1, 0, 0);
        return function (b) {
            return this.rotateOnAxis(a, b)
        }
    }(), rotateY: function () {
        var a = new THREE.Vector3(0, 1, 0);
        return function (b) {
            return this.rotateOnAxis(a, b)
        }
    }(), rotateZ: function () {
        var a = new THREE.Vector3(0, 0, 1);
        return function (b) {
            return this.rotateOnAxis(a, b)
        }
    }(), translateOnAxis: function () {
        var a = new THREE.Vector3;
        return function (b, c) {
            return a.copy(b).applyQuaternion(this.quaternion), this.position.add(a.multiplyScalar(c)), this
        }
    }(), translateX: function () {
        var a = new THREE.Vector3(1, 0, 0);
        return function (b) {
            return this.translateOnAxis(a, b)
        }
    }(), translateY: function () {
        var a = new THREE.Vector3(0, 1, 0);
        return function (b) {
            return this.translateOnAxis(a, b)
        }
    }(), translateZ: function () {
        var a = new THREE.Vector3(0, 0, 1);
        return function (b) {
            return this.translateOnAxis(a, b)
        }
    }(), localToWorld: function (a) {
        return a.applyMatrix4(this.matrixWorld)
    }, worldToLocal: function () {
        var a = new THREE.Matrix4;
        return function (b) {
            return b.applyMatrix4(a.getInverse(this.matrixWorld))
        }
    }(), lookAt: function () {
        var a = new THREE.Matrix4;
        return function (b) {
            a.lookAt(b, this.position, this.up), this.quaternion.setFromRotationMatrix(a)
        }
    }(), add: function (a) {
        if (arguments.length > 1) {
            for (var b = 0; b < arguments.length; b++)this.add(arguments[b]);
            return this
        }
        return a === this ? (console.error("THREE.Object3D.add: object can't be added as a child of itself.", a), this) : (a instanceof THREE.Object3D ? (null !== a.parent && a.parent.remove(a), a.parent = this, a.dispatchEvent({type: "added"}), this.children.push(a)) : console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", a), this)
    }, remove: function (a) {
        if (arguments.length > 1)for (var b = 0; b < arguments.length; b++)this.remove(arguments[b]);
        var c = this.children.indexOf(a);
        -1 !== c && (a.parent = null, a.dispatchEvent({type: "removed"}), this.children.splice(c, 1))
    }, getObjectById: function (a) {
        return this.getObjectByProperty("id", a)
    }, getObjectByName: function (a) {
        return this.getObjectByProperty("name", a)
    }, getObjectByProperty: function (a, b) {
        if (this[a] === b)return this;
        for (var c = 0, d = this.children.length; d > c; c++) {
            var e = this.children[c], f = e.getObjectByProperty(a, b);
            if (void 0 !== f)return f
        }
        return void 0
    }, getWorldPosition: function (a) {
        var b = a || new THREE.Vector3;
        return this.updateMatrixWorld(!0), b.setFromMatrixPosition(this.matrixWorld)
    }, getWorldQuaternion: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3;
        return function (c) {
            var d = c || new THREE.Quaternion;
            return this.updateMatrixWorld(!0), this.matrixWorld.decompose(a, d, b), d
        }
    }(), getWorldRotation: function () {
        var a = new THREE.Quaternion;
        return function (b) {
            var c = b || new THREE.Euler;
            return this.getWorldQuaternion(a), c.setFromQuaternion(a, this.rotation.order, !1)
        }
    }(), getWorldScale: function () {
        var a = new THREE.Vector3, b = new THREE.Quaternion;
        return function (c) {
            var d = c || new THREE.Vector3;
            return this.updateMatrixWorld(!0), this.matrixWorld.decompose(a, b, d), d
        }
    }(), getWorldDirection: function () {
        var a = new THREE.Quaternion;
        return function (b) {
            var c = b || new THREE.Vector3;
            return this.getWorldQuaternion(a), c.set(0, 0, 1).applyQuaternion(a)
        }
    }(), raycast: function () {
    }, traverse: function (a) {
        a(this);
        for (var b = this.children, c = 0, d = b.length; d > c; c++)b[c].traverse(a)
    }, traverseVisible: function (a) {
        if (this.visible !== !1) {
            a(this);
            for (var b = this.children, c = 0, d = b.length; d > c; c++)b[c].traverseVisible(a)
        }
    }, traverseAncestors: function (a) {
        var b = this.parent;
        null !== b && (a(b), b.traverseAncestors(a))
    }, updateMatrix: function () {
        this.matrix.compose(this.position, this.quaternion, this.scale), this.matrixWorldNeedsUpdate = !0
    }, updateMatrixWorld: function (a) {
        this.matrixAutoUpdate === !0 && this.updateMatrix(), (this.matrixWorldNeedsUpdate === !0 || a === !0) && (null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.matrixWorldNeedsUpdate = !1, a = !0);
        for (var b = 0, c = this.children.length; c > b; b++)this.children[b].updateMatrixWorld(a)
    }, toJSON: function (a) {
        function b(a) {
            var b = [];
            for (var c in a) {
                var d = a[c];
                delete d.metadata, b.push(d)
            }
            return b
        }

        var c = void 0 === a || "" === a, d = {};
        c && (a = {geometries: {}, materials: {}, textures: {}, images: {}}, d.metadata = {
            version: 4.4,
            type: "Object",
            generator: "Object3D.toJSON"
        });
        var e = {};
        if (e.uuid = this.uuid, e.type = this.type, "" !== this.name && (e.name = this.name), "{}" !== JSON.stringify(this.userData) && (e.userData = this.userData), this.castShadow === !0 && (e.castShadow = !0), this.receiveShadow === !0 && (e.receiveShadow = !0), this.visible === !1 && (e.visible = !1), e.matrix = this.matrix.toArray(), void 0 !== this.geometry && (void 0 === a.geometries[this.geometry.uuid] && (a.geometries[this.geometry.uuid] = this.geometry.toJSON(a)), e.geometry = this.geometry.uuid), void 0 !== this.material && (void 0 === a.materials[this.material.uuid] && (a.materials[this.material.uuid] = this.material.toJSON(a)), e.material = this.material.uuid), this.children.length > 0) {
            e.children = [];
            for (var f = 0; f < this.children.length; f++)e.children.push(this.children[f].toJSON(a).object)
        }
        if (c) {
            var g = b(a.geometries), h = b(a.materials), i = b(a.textures), j = b(a.images);
            g.length > 0 && (d.geometries = g), h.length > 0 && (d.materials = h), i.length > 0 && (d.textures = i), j.length > 0 && (d.images = j)
        }
        return d.object = e, d
    }, clone: function (a) {
        return (new this.constructor).copy(this, a)
    }, copy: function (a, b) {
        if (void 0 === b && (b = !0), this.name = a.name, this.up.copy(a.up), this.position.copy(a.position), this.quaternion.copy(a.quaternion), this.scale.copy(a.scale), this.matrix.copy(a.matrix), this.matrixWorld.copy(a.matrixWorld), this.matrixAutoUpdate = a.matrixAutoUpdate, this.matrixWorldNeedsUpdate = a.matrixWorldNeedsUpdate, this.visible = a.visible, this.castShadow = a.castShadow, this.receiveShadow = a.receiveShadow, this.frustumCulled = a.frustumCulled, this.renderOrder = a.renderOrder, this.userData = JSON.parse(JSON.stringify(a.userData)), b === !0)for (var c = 0; c < a.children.length; c++) {
            var d = a.children[c];
            this.add(d.clone())
        }
        return this
    }
}), THREE.Object3DIdCount = 0, THREE.Face3 = function (a, b, c, d, e, f) {
    this.a = a, this.b = b, this.c = c, this.normal = d instanceof THREE.Vector3 ? d : new THREE.Vector3, this.vertexNormals = Array.isArray(d) ? d : [], this.color = e instanceof THREE.Color ? e : new THREE.Color, this.vertexColors = Array.isArray(e) ? e : [], this.materialIndex = void 0 !== f ? f : 0
}, THREE.Face3.prototype = {
    constructor: THREE.Face3, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        this.a = a.a, this.b = a.b, this.c = a.c, this.normal.copy(a.normal), this.color.copy(a.color), this.materialIndex = a.materialIndex;
        for (var b = 0, c = a.vertexNormals.length; c > b; b++)this.vertexNormals[b] = a.vertexNormals[b].clone();
        for (var b = 0, c = a.vertexColors.length; c > b; b++)this.vertexColors[b] = a.vertexColors[b].clone();
        return this
    }
}, THREE.BufferAttribute = function (a, b, c) {
    this.uuid = THREE.Math.generateUUID(), this.array = a, this.itemSize = b, this.dynamic = !1, this.updateRange = {
        offset: 0,
        count: -1
    }, this.version = 0, this.normalized = c === !0
}, THREE.BufferAttribute.prototype = {
    constructor: THREE.BufferAttribute, get count() {
        return this.array.length / this.itemSize
    }, set needsUpdate(a) {
        a === !0 && this.version++
    }, setDynamic: function (a) {
        return this.dynamic = a, this
    }, copy: function (a) {
        return this.array = new a.array.constructor(a.array), this.itemSize = a.itemSize, this.dynamic = a.dynamic, this
    }, copyAt: function (a, b, c) {
        a *= this.itemSize, c *= b.itemSize;
        for (var d = 0, e = this.itemSize; e > d; d++)this.array[a + d] = b.array[c + d];
        return this
    }, copyArray: function (a) {
        return this.array.set(a), this
    }, copyColorsArray: function (a) {
        for (var b = this.array, c = 0, d = 0, e = a.length; e > d; d++) {
            var f = a[d];
            void 0 === f && (console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined", d), f = new THREE.Color), b[c++] = f.r, b[c++] = f.g, b[c++] = f.b
        }
        return this
    }, copyIndicesArray: function (a) {
        for (var b = this.array, c = 0, d = 0, e = a.length; e > d; d++) {
            var f = a[d];
            b[c++] = f.a, b[c++] = f.b, b[c++] = f.c
        }
        return this
    }, copyVector2sArray: function (a) {
        for (var b = this.array, c = 0, d = 0, e = a.length; e > d; d++) {
            var f = a[d];
            void 0 === f && (console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined", d), f = new THREE.Vector2), b[c++] = f.x, b[c++] = f.y
        }
        return this
    }, copyVector3sArray: function (a) {
        for (var b = this.array, c = 0, d = 0, e = a.length; e > d; d++) {
            var f = a[d];
            void 0 === f && (console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined", d), f = new THREE.Vector3), b[c++] = f.x, b[c++] = f.y, b[c++] = f.z
        }
        return this
    }, copyVector4sArray: function (a) {
        for (var b = this.array, c = 0, d = 0, e = a.length; e > d; d++) {
            var f = a[d];
            void 0 === f && (console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined", d), f = new THREE.Vector4), b[c++] = f.x, b[c++] = f.y, b[c++] = f.z, b[c++] = f.w
        }
        return this
    }, set: function (a, b) {
        return void 0 === b && (b = 0), this.array.set(a, b), this
    }, getX: function (a) {
        return this.array[a * this.itemSize]
    }, setX: function (a, b) {
        return this.array[a * this.itemSize] = b, this
    }, getY: function (a) {
        return this.array[a * this.itemSize + 1]
    }, setY: function (a, b) {
        return this.array[a * this.itemSize + 1] = b, this
    }, getZ: function (a) {
        return this.array[a * this.itemSize + 2]
    }, setZ: function (a, b) {
        return this.array[a * this.itemSize + 2] = b, this
    }, getW: function (a) {
        return this.array[a * this.itemSize + 3]
    }, setW: function (a, b) {
        return this.array[a * this.itemSize + 3] = b, this
    }, setXY: function (a, b, c) {
        return a *= this.itemSize, this.array[a + 0] = b, this.array[a + 1] = c, this
    }, setXYZ: function (a, b, c, d) {
        return a *= this.itemSize, this.array[a + 0] = b, this.array[a + 1] = c, this.array[a + 2] = d, this
    }, setXYZW: function (a, b, c, d, e) {
        return a *= this.itemSize, this.array[a + 0] = b, this.array[a + 1] = c, this.array[a + 2] = d, this.array[a + 3] = e, this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }
}, THREE.Int8Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Int8Array(a), b)
}, THREE.Uint8Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Uint8Array(a), b)
}, THREE.Uint8ClampedAttribute = function (a, b) {
    return new THREE.BufferAttribute(new Uint8ClampedArray(a), b)
}, THREE.Int16Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Int16Array(a), b)
}, THREE.Uint16Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Uint16Array(a), b)
}, THREE.Int32Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Int32Array(a), b)
}, THREE.Uint32Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Uint32Array(a), b)
}, THREE.Float32Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Float32Array(a), b)
}, THREE.Float64Attribute = function (a, b) {
    return new THREE.BufferAttribute(new Float64Array(a), b)
}, THREE.DynamicBufferAttribute = function (a, b) {
    return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."), new THREE.BufferAttribute(a, b).setDynamic(!0)
}, THREE.InstancedBufferAttribute = function (a, b, c) {
    THREE.BufferAttribute.call(this, a, b), this.meshPerAttribute = c || 1
}, THREE.InstancedBufferAttribute.prototype = Object.create(THREE.BufferAttribute.prototype), THREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute, THREE.InstancedBufferAttribute.prototype.copy = function (a) {
    return THREE.BufferAttribute.prototype.copy.call(this, a), this.meshPerAttribute = a.meshPerAttribute, this
}, THREE.InterleavedBuffer = function (a, b) {
    this.uuid = THREE.Math.generateUUID(), this.array = a, this.stride = b, this.dynamic = !1, this.updateRange = {
        offset: 0,
        count: -1
    }, this.version = 0
}, THREE.InterleavedBuffer.prototype = {
    constructor: THREE.InterleavedBuffer, get length() {
        return this.array.length
    }, get count() {
        return this.array.length / this.stride
    }, set needsUpdate(a) {
        a === !0 && this.version++
    }, setDynamic: function (a) {
        return this.dynamic = a, this
    }, copy: function (a) {
        return this.array = new a.array.constructor(a.array), this.stride = a.stride, this.dynamic = a.dynamic, this
    }, copyAt: function (a, b, c) {
        a *= this.stride, c *= b.stride;
        for (var d = 0, e = this.stride; e > d; d++)this.array[a + d] = b.array[c + d];
        return this
    }, set: function (a, b) {
        return void 0 === b && (b = 0), this.array.set(a, b), this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }
}, THREE.InstancedInterleavedBuffer = function (a, b, c) {
    THREE.InterleavedBuffer.call(this, a, b), this.meshPerAttribute = c || 1
}, THREE.InstancedInterleavedBuffer.prototype = Object.create(THREE.InterleavedBuffer.prototype), THREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer, THREE.InstancedInterleavedBuffer.prototype.copy = function (a) {
    return THREE.InterleavedBuffer.prototype.copy.call(this, a), this.meshPerAttribute = a.meshPerAttribute, this
}, THREE.InterleavedBufferAttribute = function (a, b, c) {
    this.uuid = THREE.Math.generateUUID(), this.data = a, this.itemSize = b, this.offset = c
}, THREE.InterleavedBufferAttribute.prototype = {
    constructor: THREE.InterleavedBufferAttribute, get length() {
        return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."), this.array.length
    }, get count() {
        return this.data.count
    }, setX: function (a, b) {
        return this.data.array[a * this.data.stride + this.offset] = b, this
    }, setY: function (a, b) {
        return this.data.array[a * this.data.stride + this.offset + 1] = b, this
    }, setZ: function (a, b) {
        return this.data.array[a * this.data.stride + this.offset + 2] = b, this
    }, setW: function (a, b) {
        return this.data.array[a * this.data.stride + this.offset + 3] = b, this
    }, getX: function (a) {
        return this.data.array[a * this.data.stride + this.offset]
    }, getY: function (a) {
        return this.data.array[a * this.data.stride + this.offset + 1]
    }, getZ: function (a) {
        return this.data.array[a * this.data.stride + this.offset + 2]
    }, getW: function (a) {
        return this.data.array[a * this.data.stride + this.offset + 3]
    }, setXY: function (a, b, c) {
        return a = a * this.data.stride + this.offset, this.data.array[a + 0] = b, this.data.array[a + 1] = c, this
    }, setXYZ: function (a, b, c, d) {
        return a = a * this.data.stride + this.offset, this.data.array[a + 0] = b, this.data.array[a + 1] = c, this.data.array[a + 2] = d, this
    }, setXYZW: function (a, b, c, d, e) {
        return a = a * this.data.stride + this.offset, this.data.array[a + 0] = b, this.data.array[a + 1] = c, this.data.array[a + 2] = d, this.data.array[a + 3] = e, this
    }
}, THREE.Geometry = function () {
    Object.defineProperty(this, "id", {value: THREE.GeometryIdCount++}), this.uuid = THREE.Math.generateUUID(), this.name = "", this.type = "Geometry", this.vertices = [], this.colors = [], this.faces = [], this.faceVertexUvs = [[]], this.morphTargets = [], this.morphNormals = [], this.skinWeights = [], this.skinIndices = [], this.lineDistances = [], this.boundingBox = null, this.boundingSphere = null, this.verticesNeedUpdate = !1, this.elementsNeedUpdate = !1, this.uvsNeedUpdate = !1, this.normalsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.lineDistancesNeedUpdate = !1, this.groupsNeedUpdate = !1
}, Object.assign(THREE.Geometry.prototype, THREE.EventDispatcher.prototype, {
    applyMatrix: function (a) {
        for (var b = (new THREE.Matrix3).getNormalMatrix(a), c = 0, d = this.vertices.length; d > c; c++) {
            var e = this.vertices[c];
            e.applyMatrix4(a)
        }
        for (var c = 0, d = this.faces.length; d > c; c++) {
            var f = this.faces[c];
            f.normal.applyMatrix3(b).normalize();
            for (var g = 0, h = f.vertexNormals.length; h > g; g++)f.vertexNormals[g].applyMatrix3(b).normalize()
        }
        return null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere(), this.verticesNeedUpdate = !0, this.normalsNeedUpdate = !0, this
    }, rotateX: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationX(b), this.applyMatrix(a), this
        }
    }(), rotateY: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationY(b), this.applyMatrix(a), this
        }
    }(), rotateZ: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationZ(b), this.applyMatrix(a), this
        }
    }(), translate: function () {
        var a;
        return function (b, c, d) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeTranslation(b, c, d), this.applyMatrix(a), this
        }
    }(), scale: function () {
        var a;
        return function (b, c, d) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeScale(b, c, d), this.applyMatrix(a), this
        }
    }(), lookAt: function () {
        var a;
        return function (b) {
            void 0 === a && (a = new THREE.Object3D), a.lookAt(b), a.updateMatrix(), this.applyMatrix(a.matrix)
        }
    }(), fromBufferGeometry: function (a) {
        function b(a, b, d, e) {
            var f = void 0 !== g ? [k[a].clone(), k[b].clone(), k[d].clone()] : [], n = void 0 !== h ? [c.colors[a].clone(), c.colors[b].clone(), c.colors[d].clone()] : [], o = new THREE.Face3(a, b, d, f, n, e);
            c.faces.push(o), void 0 !== i && c.faceVertexUvs[0].push([l[a].clone(), l[b].clone(), l[d].clone()]), void 0 !== j && c.faceVertexUvs[1].push([m[a].clone(), m[b].clone(), m[d].clone()])
        }

        var c = this, d = null !== a.index ? a.index.array : void 0, e = a.attributes, f = e.position.array, g = void 0 !== e.normal ? e.normal.array : void 0, h = void 0 !== e.color ? e.color.array : void 0, i = void 0 !== e.uv ? e.uv.array : void 0, j = void 0 !== e.uv2 ? e.uv2.array : void 0;
        void 0 !== j && (this.faceVertexUvs[1] = []);
        for (var k = [], l = [], m = [], n = 0, o = 0; n < f.length; n += 3, o += 2)c.vertices.push(new THREE.Vector3(f[n], f[n + 1], f[n + 2])), void 0 !== g && k.push(new THREE.Vector3(g[n], g[n + 1], g[n + 2])), void 0 !== h && c.colors.push(new THREE.Color(h[n], h[n + 1], h[n + 2])), void 0 !== i && l.push(new THREE.Vector2(i[o], i[o + 1])), void 0 !== j && m.push(new THREE.Vector2(j[o], j[o + 1]));
        if (void 0 !== d) {
            var p = a.groups;
            if (p.length > 0)for (var n = 0; n < p.length; n++)for (var q = p[n], r = q.start, s = q.count, o = r, t = r + s; t > o; o += 3)b(d[o], d[o + 1], d[o + 2], q.materialIndex); else for (var n = 0; n < d.length; n += 3)b(d[n], d[n + 1], d[n + 2])
        } else for (var n = 0; n < f.length / 3; n += 3)b(n, n + 1, n + 2);
        return this.computeFaceNormals(), null !== a.boundingBox && (this.boundingBox = a.boundingBox.clone()), null !== a.boundingSphere && (this.boundingSphere = a.boundingSphere.clone()), this
    }, center: function () {
        this.computeBoundingBox();
        var a = this.boundingBox.center().negate();
        return this.translate(a.x, a.y, a.z), a
    }, normalize: function () {
        this.computeBoundingSphere();
        var a = this.boundingSphere.center, b = this.boundingSphere.radius, c = 0 === b ? 1 : 1 / b, d = new THREE.Matrix4;
        return d.set(c, 0, 0, -c * a.x, 0, c, 0, -c * a.y, 0, 0, c, -c * a.z, 0, 0, 0, 1), this.applyMatrix(d), this
    }, computeFaceNormals: function () {
        for (var a = new THREE.Vector3, b = new THREE.Vector3, c = 0, d = this.faces.length; d > c; c++) {
            var e = this.faces[c], f = this.vertices[e.a], g = this.vertices[e.b], h = this.vertices[e.c];
            a.subVectors(h, g), b.subVectors(f, g), a.cross(b), a.normalize(), e.normal.copy(a)
        }
    }, computeVertexNormals: function (a) {
        void 0 === a && (a = !0);
        var b, c, d, e, f, g;
        for (g = new Array(this.vertices.length), b = 0, c = this.vertices.length; c > b; b++)g[b] = new THREE.Vector3;
        if (a) {
            var h, i, j, k = new THREE.Vector3, l = new THREE.Vector3;
            for (d = 0, e = this.faces.length; e > d; d++)f = this.faces[d], h = this.vertices[f.a], i = this.vertices[f.b], j = this.vertices[f.c], k.subVectors(j, i), l.subVectors(h, i), k.cross(l), g[f.a].add(k), g[f.b].add(k), g[f.c].add(k)
        } else for (d = 0, e = this.faces.length; e > d; d++)f = this.faces[d], g[f.a].add(f.normal), g[f.b].add(f.normal), g[f.c].add(f.normal);
        for (b = 0, c = this.vertices.length; c > b; b++)g[b].normalize();
        for (d = 0, e = this.faces.length; e > d; d++) {
            f = this.faces[d];
            var m = f.vertexNormals;
            3 === m.length ? (m[0].copy(g[f.a]), m[1].copy(g[f.b]), m[2].copy(g[f.c])) : (m[0] = g[f.a].clone(), m[1] = g[f.b].clone(), m[2] = g[f.c].clone())
        }
        this.faces.length > 0 && (this.normalsNeedUpdate = !0)
    }, computeMorphNormals: function () {
        var a, b, c, d, e;
        for (c = 0, d = this.faces.length; d > c; c++)for (e = this.faces[c], e.__originalFaceNormal ? e.__originalFaceNormal.copy(e.normal) : e.__originalFaceNormal = e.normal.clone(), e.__originalVertexNormals || (e.__originalVertexNormals = []), a = 0, b = e.vertexNormals.length; b > a; a++)e.__originalVertexNormals[a] ? e.__originalVertexNormals[a].copy(e.vertexNormals[a]) : e.__originalVertexNormals[a] = e.vertexNormals[a].clone();
        var f = new THREE.Geometry;
        for (f.faces = this.faces, a = 0, b = this.morphTargets.length; b > a; a++) {
            if (!this.morphNormals[a]) {
                this.morphNormals[a] = {}, this.morphNormals[a].faceNormals = [], this.morphNormals[a].vertexNormals = [];
                var g, h, i = this.morphNormals[a].faceNormals, j = this.morphNormals[a].vertexNormals;
                for (c = 0, d = this.faces.length; d > c; c++)g = new THREE.Vector3, h = {
                    a: new THREE.Vector3,
                    b: new THREE.Vector3,
                    c: new THREE.Vector3
                }, i.push(g), j.push(h)
            }
            var k = this.morphNormals[a];
            f.vertices = this.morphTargets[a].vertices, f.computeFaceNormals(), f.computeVertexNormals();
            var g, h;
            for (c = 0, d = this.faces.length; d > c; c++)e = this.faces[c], g = k.faceNormals[c], h = k.vertexNormals[c], g.copy(e.normal), h.a.copy(e.vertexNormals[0]), h.b.copy(e.vertexNormals[1]), h.c.copy(e.vertexNormals[2])
        }
        for (c = 0, d = this.faces.length; d > c; c++)e = this.faces[c], e.normal = e.__originalFaceNormal, e.vertexNormals = e.__originalVertexNormals
    }, computeTangents: function () {
        console.warn("THREE.Geometry: .computeTangents() has been removed.")
    }, computeLineDistances: function () {
        for (var a = 0, b = this.vertices, c = 0, d = b.length; d > c; c++)c > 0 && (a += b[c].distanceTo(b[c - 1])), this.lineDistances[c] = a
    }, computeBoundingBox: function () {
        null === this.boundingBox && (this.boundingBox = new THREE.Box3), this.boundingBox.setFromPoints(this.vertices)
    }, computeBoundingSphere: function () {
        null === this.boundingSphere && (this.boundingSphere = new THREE.Sphere), this.boundingSphere.setFromPoints(this.vertices)
    }, merge: function (a, b, c) {
        if (a instanceof THREE.Geometry == !1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.", a);
        var d, e = this.vertices.length, f = this.vertices, g = a.vertices, h = this.faces, i = a.faces, j = this.faceVertexUvs[0], k = a.faceVertexUvs[0];
        void 0 === c && (c = 0), void 0 !== b && (d = (new THREE.Matrix3).getNormalMatrix(b));
        for (var l = 0, m = g.length; m > l; l++) {
            var n = g[l], o = n.clone();
            void 0 !== b && o.applyMatrix4(b), f.push(o)
        }
        for (l = 0, m = i.length; m > l; l++) {
            var p, q, r, s = i[l], t = s.vertexNormals, u = s.vertexColors;
            p = new THREE.Face3(s.a + e, s.b + e, s.c + e), p.normal.copy(s.normal), void 0 !== d && p.normal.applyMatrix3(d).normalize();
            for (var v = 0, w = t.length; w > v; v++)q = t[v].clone(), void 0 !== d && q.applyMatrix3(d).normalize(), p.vertexNormals.push(q);
            p.color.copy(s.color);
            for (var v = 0, w = u.length; w > v; v++)r = u[v], p.vertexColors.push(r.clone());
            p.materialIndex = s.materialIndex + c, h.push(p)
        }
        for (l = 0, m = k.length; m > l; l++) {
            var x = k[l], y = [];
            if (void 0 !== x) {
                for (var v = 0, w = x.length; w > v; v++)y.push(x[v].clone());
                j.push(y)
            }
        }
    }, mergeMesh: function (a) {
        return a instanceof THREE.Mesh == !1 ? void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.", a) : (a.matrixAutoUpdate && a.updateMatrix(), void this.merge(a.geometry, a.matrix))
    }, mergeVertices: function () {
        var a, b, c, d, e, f, g, h, i = {}, j = [], k = [], l = 4, m = Math.pow(10, l);
        for (c = 0, d = this.vertices.length; d > c; c++)a = this.vertices[c], b = Math.round(a.x * m) + "_" + Math.round(a.y * m) + "_" + Math.round(a.z * m), void 0 === i[b] ? (i[b] = c, j.push(this.vertices[c]), k[c] = j.length - 1) : k[c] = k[i[b]];
        var n = [];
        for (c = 0, d = this.faces.length; d > c; c++) {
            e = this.faces[c], e.a = k[e.a], e.b = k[e.b], e.c = k[e.c], f = [e.a, e.b, e.c];
            for (var o = -1, p = 0; 3 > p; p++)if (f[p] === f[(p + 1) % 3]) {
                o = p, n.push(c);
                break
            }
        }
        for (c = n.length - 1; c >= 0; c--) {
            var q = n[c];
            for (this.faces.splice(q, 1), g = 0, h = this.faceVertexUvs.length; h > g; g++)this.faceVertexUvs[g].splice(q, 1)
        }
        var r = this.vertices.length - j.length;
        return this.vertices = j, r
    }, sortFacesByMaterialIndex: function () {
        function a(a, b) {
            return a.materialIndex - b.materialIndex
        }

        for (var b = this.faces, c = b.length, d = 0; c > d; d++)b[d]._id = d;
        b.sort(a);
        var e, f, g = this.faceVertexUvs[0], h = this.faceVertexUvs[1];
        g && g.length === c && (e = []), h && h.length === c && (f = []);
        for (var d = 0; c > d; d++) {
            var i = b[d]._id;
            e && e.push(g[i]), f && f.push(h[i])
        }
        e && (this.faceVertexUvs[0] = e), f && (this.faceVertexUvs[1] = f)
    }, toJSON: function () {
        function a(a, b, c) {
            return c ? a | 1 << b : a & ~(1 << b)
        }

        function b(a) {
            var b = a.x.toString() + a.y.toString() + a.z.toString();
            return void 0 !== m[b] ? m[b] : (m[b] = l.length / 3, l.push(a.x, a.y, a.z), m[b])
        }

        function c(a) {
            var b = a.r.toString() + a.g.toString() + a.b.toString();
            return void 0 !== o[b] ? o[b] : (o[b] = n.length, n.push(a.getHex()), o[b])
        }

        function d(a) {
            var b = a.x.toString() + a.y.toString();
            return void 0 !== q[b] ? q[b] : (q[b] = p.length / 2, p.push(a.x, a.y), q[b])
        }

        var e = {metadata: {version: 4.4, type: "Geometry", generator: "Geometry.toJSON"}};
        if (e.uuid = this.uuid, e.type = this.type, "" !== this.name && (e.name = this.name), void 0 !== this.parameters) {
            var f = this.parameters;
            for (var g in f)void 0 !== f[g] && (e[g] = f[g]);
            return e
        }
        for (var h = [], i = 0; i < this.vertices.length; i++) {
            var j = this.vertices[i];
            h.push(j.x, j.y, j.z)
        }
        for (var k = [], l = [], m = {}, n = [], o = {}, p = [], q = {}, i = 0; i < this.faces.length; i++) {
            var r = this.faces[i], s = !0, t = !1, u = void 0 !== this.faceVertexUvs[0][i], v = r.normal.length() > 0, w = r.vertexNormals.length > 0, x = 1 !== r.color.r || 1 !== r.color.g || 1 !== r.color.b, y = r.vertexColors.length > 0, z = 0;
            if (z = a(z, 0, 0), z = a(z, 1, s), z = a(z, 2, t), z = a(z, 3, u), z = a(z, 4, v), z = a(z, 5, w), z = a(z, 6, x), z = a(z, 7, y), k.push(z), k.push(r.a, r.b, r.c), k.push(r.materialIndex), u) {
                var A = this.faceVertexUvs[0][i];
                k.push(d(A[0]), d(A[1]), d(A[2]))
            }
            if (v && k.push(b(r.normal)), w) {
                var B = r.vertexNormals;
                k.push(b(B[0]), b(B[1]), b(B[2]))
            }
            if (x && k.push(c(r.color)), y) {
                var C = r.vertexColors;
                k.push(c(C[0]), c(C[1]), c(C[2]))
            }
        }
        return e.data = {}, e.data.vertices = h, e.data.normals = l, n.length > 0 && (e.data.colors = n), p.length > 0 && (e.data.uvs = [p]), e.data.faces = k, e
    }, clone: function () {
        return (new THREE.Geometry).copy(this)
    }, copy: function (a) {
        this.vertices = [], this.faces = [], this.faceVertexUvs = [[]];
        for (var b = a.vertices, c = 0, d = b.length; d > c; c++)this.vertices.push(b[c].clone());
        for (var e = a.faces, c = 0, d = e.length; d > c; c++)this.faces.push(e[c].clone());
        for (var c = 0, d = a.faceVertexUvs.length; d > c; c++) {
            var f = a.faceVertexUvs[c];
            void 0 === this.faceVertexUvs[c] && (this.faceVertexUvs[c] = []);
            for (var g = 0, h = f.length; h > g; g++) {
                for (var i = f[g], j = [], k = 0, l = i.length; l > k; k++) {
                    var m = i[k];
                    j.push(m.clone())
                }
                this.faceVertexUvs[c].push(j)
            }
        }
        return this
    }, dispose: function () {
        this.dispatchEvent({type: "dispose"})
    }
}), THREE.GeometryIdCount = 0,THREE.DirectGeometry = function () {
    Object.defineProperty(this, "id", {value: THREE.GeometryIdCount++}), this.uuid = THREE.Math.generateUUID(), this.name = "", this.type = "DirectGeometry", this.indices = [], this.vertices = [], this.normals = [], this.colors = [], this.uvs = [], this.uvs2 = [], this.groups = [], this.morphTargets = {}, this.skinWeights = [], this.skinIndices = [], this.boundingBox = null, this.boundingSphere = null, this.verticesNeedUpdate = !1, this.normalsNeedUpdate = !1, this.colorsNeedUpdate = !1, this.uvsNeedUpdate = !1, this.groupsNeedUpdate = !1
},Object.assign(THREE.DirectGeometry.prototype, THREE.EventDispatcher.prototype, {
    computeBoundingBox: THREE.Geometry.prototype.computeBoundingBox,
    computeBoundingSphere: THREE.Geometry.prototype.computeBoundingSphere,
    computeFaceNormals: function () {
        console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")
    },
    computeVertexNormals: function () {
        console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")
    },
    computeGroups: function (a) {
        for (var b, c, d = [], e = a.faces, f = 0; f < e.length; f++) {
            var g = e[f];
            g.materialIndex !== c && (c = g.materialIndex, void 0 !== b && (b.count = 3 * f - b.start, d.push(b)), b = {
                start: 3 * f,
                materialIndex: c
            })
        }
        void 0 !== b && (b.count = 3 * f - b.start, d.push(b)), this.groups = d
    },
    fromGeometry: function (a) {
        var b, c = a.faces, d = a.vertices, e = a.faceVertexUvs, f = e[0] && e[0].length > 0, g = e[1] && e[1].length > 0, h = a.morphTargets, i = h.length;
        if (i > 0) {
            b = [];
            for (var j = 0; i > j; j++)b[j] = [];
            this.morphTargets.position = b
        }
        var k, l = a.morphNormals, m = l.length;
        if (m > 0) {
            k = [];
            for (var j = 0; m > j; j++)k[j] = [];
            this.morphTargets.normal = k
        }
        for (var n = a.skinIndices, o = a.skinWeights, p = n.length === d.length, q = o.length === d.length, j = 0; j < c.length; j++) {
            var r = c[j];
            this.vertices.push(d[r.a], d[r.b], d[r.c]);
            var s = r.vertexNormals;
            if (3 === s.length)this.normals.push(s[0], s[1], s[2]); else {
                var t = r.normal;
                this.normals.push(t, t, t)
            }
            var u = r.vertexColors;
            if (3 === u.length)this.colors.push(u[0], u[1], u[2]); else {
                var v = r.color;
                this.colors.push(v, v, v)
            }
            if (f === !0) {
                var w = e[0][j];
                void 0 !== w ? this.uvs.push(w[0], w[1], w[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ", j), this.uvs.push(new THREE.Vector2, new THREE.Vector2, new THREE.Vector2))
            }
            if (g === !0) {
                var w = e[1][j];
                void 0 !== w ? this.uvs2.push(w[0], w[1], w[2]) : (console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ", j), this.uvs2.push(new THREE.Vector2, new THREE.Vector2, new THREE.Vector2))
            }
            for (var x = 0; i > x; x++) {
                var y = h[x].vertices;
                b[x].push(y[r.a], y[r.b], y[r.c])
            }
            for (var x = 0; m > x; x++) {
                var z = l[x].vertexNormals[j];
                k[x].push(z.a, z.b, z.c)
            }
            p && this.skinIndices.push(n[r.a], n[r.b], n[r.c]), q && this.skinWeights.push(o[r.a], o[r.b], o[r.c])
        }
        return this.computeGroups(a), this.verticesNeedUpdate = a.verticesNeedUpdate, this.normalsNeedUpdate = a.normalsNeedUpdate, this.colorsNeedUpdate = a.colorsNeedUpdate, this.uvsNeedUpdate = a.uvsNeedUpdate, this.groupsNeedUpdate = a.groupsNeedUpdate, this
    },
    dispose: function () {
        this.dispatchEvent({type: "dispose"})
    }
}),THREE.BufferGeometry = function () {
    Object.defineProperty(this, "id", {value: THREE.GeometryIdCount++}), this.uuid = THREE.Math.generateUUID(), this.name = "", this.type = "BufferGeometry", this.index = null, this.attributes = {}, this.morphAttributes = {}, this.groups = [], this.boundingBox = null, this.boundingSphere = null, this.drawRange = {
        start: 0,
        count: 1 / 0
    }
},Object.assign(THREE.BufferGeometry.prototype, THREE.EventDispatcher.prototype, {
    getIndex: function () {
        return this.index
    }, setIndex: function (a) {
        this.index = a
    }, addAttribute: function (a, b) {
        return b instanceof THREE.BufferAttribute == !1 && b instanceof THREE.InterleavedBufferAttribute == !1 ? (console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."), void this.addAttribute(a, new THREE.BufferAttribute(arguments[1], arguments[2]))) : "index" === a ? (console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."), void this.setIndex(b)) : (this.attributes[a] = b, this)
    }, getAttribute: function (a) {
        return this.attributes[a]
    }, removeAttribute: function (a) {
        return delete this.attributes[a], this
    }, addGroup: function (a, b, c) {
        this.groups.push({start: a, count: b, materialIndex: void 0 !== c ? c : 0})
    }, clearGroups: function () {
        this.groups = []
    }, setDrawRange: function (a, b) {
        this.drawRange.start = a, this.drawRange.count = b
    }, applyMatrix: function (a) {
        var b = this.attributes.position;
        void 0 !== b && (a.applyToVector3Array(b.array), b.needsUpdate = !0);
        var c = this.attributes.normal;
        if (void 0 !== c) {
            var d = (new THREE.Matrix3).getNormalMatrix(a);
            d.applyToVector3Array(c.array), c.needsUpdate = !0
        }
        return null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere(), this
    }, rotateX: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationX(b), this.applyMatrix(a), this
        }
    }(), rotateY: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationY(b), this.applyMatrix(a), this
        }
    }(), rotateZ: function () {
        var a;
        return function (b) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeRotationZ(b), this.applyMatrix(a), this
        }
    }(), translate: function () {
        var a;
        return function (b, c, d) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeTranslation(b, c, d), this.applyMatrix(a), this
        }
    }(), scale: function () {
        var a;
        return function (b, c, d) {
            return void 0 === a && (a = new THREE.Matrix4), a.makeScale(b, c, d), this.applyMatrix(a), this
        }
    }(), lookAt: function () {
        var a;
        return function (b) {
            void 0 === a && (a = new THREE.Object3D), a.lookAt(b), a.updateMatrix(), this.applyMatrix(a.matrix)
        }
    }(), center: function () {
        this.computeBoundingBox();
        var a = this.boundingBox.center().negate();
        return this.translate(a.x, a.y, a.z), a
    }, setFromObject: function (a) {
        var b = a.geometry;
        if (a instanceof THREE.Points || a instanceof THREE.Line) {
            var c = new THREE.Float32Attribute(3 * b.vertices.length, 3), d = new THREE.Float32Attribute(3 * b.colors.length, 3);
            if (this.addAttribute("position", c.copyVector3sArray(b.vertices)), this.addAttribute("color", d.copyColorsArray(b.colors)), b.lineDistances && b.lineDistances.length === b.vertices.length) {
                var e = new THREE.Float32Attribute(b.lineDistances.length, 1);
                this.addAttribute("lineDistance", e.copyArray(b.lineDistances))
            }
            null !== b.boundingSphere && (this.boundingSphere = b.boundingSphere.clone()), null !== b.boundingBox && (this.boundingBox = b.boundingBox.clone())
        } else a instanceof THREE.Mesh && b instanceof THREE.Geometry && this.fromGeometry(b);
        return this
    }, updateFromObject: function (a) {
        var b = a.geometry;
        if (a instanceof THREE.Mesh) {
            var c = b.__directGeometry;
            if (void 0 === c)return this.fromGeometry(b);
            c.verticesNeedUpdate = b.verticesNeedUpdate, c.normalsNeedUpdate = b.normalsNeedUpdate, c.colorsNeedUpdate = b.colorsNeedUpdate, c.uvsNeedUpdate = b.uvsNeedUpdate, c.groupsNeedUpdate = b.groupsNeedUpdate, b.verticesNeedUpdate = !1, b.normalsNeedUpdate = !1, b.colorsNeedUpdate = !1, b.uvsNeedUpdate = !1, b.groupsNeedUpdate = !1, b = c
        }
        if (b.verticesNeedUpdate === !0) {
            var d = this.attributes.position;
            void 0 !== d && (d.copyVector3sArray(b.vertices), d.needsUpdate = !0), b.verticesNeedUpdate = !1
        }
        if (b.normalsNeedUpdate === !0) {
            var d = this.attributes.normal;
            void 0 !== d && (d.copyVector3sArray(b.normals), d.needsUpdate = !0), b.normalsNeedUpdate = !1
        }
        if (b.colorsNeedUpdate === !0) {
            var d = this.attributes.color;
            void 0 !== d && (d.copyColorsArray(b.colors), d.needsUpdate = !0), b.colorsNeedUpdate = !1
        }
        if (b.uvsNeedUpdate) {
            var d = this.attributes.uv;
            void 0 !== d && (d.copyVector2sArray(b.uvs), d.needsUpdate = !0), b.uvsNeedUpdate = !1
        }
        if (b.lineDistancesNeedUpdate) {
            var d = this.attributes.lineDistance;
            void 0 !== d && (d.copyArray(b.lineDistances), d.needsUpdate = !0), b.lineDistancesNeedUpdate = !1
        }
        return b.groupsNeedUpdate && (b.computeGroups(a.geometry), this.groups = b.groups, b.groupsNeedUpdate = !1), this
    }, fromGeometry: function (a) {
        return a.__directGeometry = (new THREE.DirectGeometry).fromGeometry(a), this.fromDirectGeometry(a.__directGeometry)
    }, fromDirectGeometry: function (a) {
        var b = new Float32Array(3 * a.vertices.length);
        if (this.addAttribute("position", new THREE.BufferAttribute(b, 3).copyVector3sArray(a.vertices)), a.normals.length > 0) {
            var c = new Float32Array(3 * a.normals.length);
            this.addAttribute("normal", new THREE.BufferAttribute(c, 3).copyVector3sArray(a.normals))
        }
        if (a.colors.length > 0) {
            var d = new Float32Array(3 * a.colors.length);
            this.addAttribute("color", new THREE.BufferAttribute(d, 3).copyColorsArray(a.colors))
        }
        if (a.uvs.length > 0) {
            var e = new Float32Array(2 * a.uvs.length);
            this.addAttribute("uv", new THREE.BufferAttribute(e, 2).copyVector2sArray(a.uvs))
        }
        if (a.uvs2.length > 0) {
            var f = new Float32Array(2 * a.uvs2.length);
            this.addAttribute("uv2", new THREE.BufferAttribute(f, 2).copyVector2sArray(a.uvs2))
        }
        if (a.indices.length > 0) {
            var g = a.vertices.length > 65535 ? Uint32Array : Uint16Array, h = new g(3 * a.indices.length);
            this.setIndex(new THREE.BufferAttribute(h, 1).copyIndicesArray(a.indices))
        }
        this.groups = a.groups;
        for (var i in a.morphTargets) {
            for (var j = [], k = a.morphTargets[i], l = 0, m = k.length; m > l; l++) {
                var n = k[l], o = new THREE.Float32Attribute(3 * n.length, 3);
                j.push(o.copyVector3sArray(n))
            }
            this.morphAttributes[i] = j
        }
        if (a.skinIndices.length > 0) {
            var p = new THREE.Float32Attribute(4 * a.skinIndices.length, 4);
            this.addAttribute("skinIndex", p.copyVector4sArray(a.skinIndices))
        }
        if (a.skinWeights.length > 0) {
            var q = new THREE.Float32Attribute(4 * a.skinWeights.length, 4);
            this.addAttribute("skinWeight", q.copyVector4sArray(a.skinWeights))
        }
        return null !== a.boundingSphere && (this.boundingSphere = a.boundingSphere.clone()), null !== a.boundingBox && (this.boundingBox = a.boundingBox.clone()), this
    }, computeBoundingBox: function () {
        null === this.boundingBox && (this.boundingBox = new THREE.Box3);
        var a = this.attributes.position.array;
        void 0 !== a ? this.boundingBox.setFromArray(a) : this.boundingBox.makeEmpty(), (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.', this)
    }, computeBoundingSphere: function () {
        var a = new THREE.Box3, b = new THREE.Vector3;
        return function () {
            null === this.boundingSphere && (this.boundingSphere = new THREE.Sphere);
            var c = this.attributes.position;
            if (c) {
                var d = c.array, e = this.boundingSphere.center;
                a.setFromArray(d), a.center(e);
                for (var f = 0, g = 0, h = d.length; h > g; g += 3)b.fromArray(d, g), f = Math.max(f, e.distanceToSquared(b));
                this.boundingSphere.radius = Math.sqrt(f), isNaN(this.boundingSphere.radius) && console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.', this)
            }
        }
    }(), computeFaceNormals: function () {
    }, computeVertexNormals: function () {
        var a = this.index, b = this.attributes, c = this.groups;
        if (b.position) {
            var d = b.position.array;
            if (void 0 === b.normal)this.addAttribute("normal", new THREE.BufferAttribute(new Float32Array(d.length), 3)); else for (var e = b.normal.array, f = 0, g = e.length; g > f; f++)e[f] = 0;
            var h, i, j, k = b.normal.array, l = new THREE.Vector3, m = new THREE.Vector3, n = new THREE.Vector3, o = new THREE.Vector3, p = new THREE.Vector3;
            if (a) {
                var q = a.array;
                0 === c.length && this.addGroup(0, q.length);
                for (var r = 0, s = c.length; s > r; ++r)for (var t = c[r], u = t.start, v = t.count, f = u, g = u + v; g > f; f += 3)h = 3 * q[f + 0], i = 3 * q[f + 1], j = 3 * q[f + 2], l.fromArray(d, h), m.fromArray(d, i), n.fromArray(d, j), o.subVectors(n, m), p.subVectors(l, m), o.cross(p), k[h] += o.x, k[h + 1] += o.y, k[h + 2] += o.z, k[i] += o.x, k[i + 1] += o.y, k[i + 2] += o.z, k[j] += o.x, k[j + 1] += o.y, k[j + 2] += o.z
            } else for (var f = 0, g = d.length; g > f; f += 9)l.fromArray(d, f), m.fromArray(d, f + 3), n.fromArray(d, f + 6), o.subVectors(n, m), p.subVectors(l, m), o.cross(p), k[f] = o.x, k[f + 1] = o.y, k[f + 2] = o.z, k[f + 3] = o.x, k[f + 4] = o.y, k[f + 5] = o.z, k[f + 6] = o.x, k[f + 7] = o.y, k[f + 8] = o.z;
            this.normalizeNormals(), b.normal.needsUpdate = !0
        }
    }, merge: function (a, b) {
        if (a instanceof THREE.BufferGeometry == !1)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", a);
        void 0 === b && (b = 0);
        var c = this.attributes;
        for (var d in c)if (void 0 !== a.attributes[d])for (var e = c[d], f = e.array, g = a.attributes[d], h = g.array, i = g.itemSize, j = 0, k = i * b; j < h.length; j++, k++)f[k] = h[j];
        return this
    }, normalizeNormals: function () {
        for (var a, b, c, d, e = this.attributes.normal.array, f = 0, g = e.length; g > f; f += 3)a = e[f], b = e[f + 1], c = e[f + 2], d = 1 / Math.sqrt(a * a + b * b + c * c), e[f] *= d, e[f + 1] *= d, e[f + 2] *= d
    }, toNonIndexed: function () {
        if (null === this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."), this;
        var a = new THREE.BufferGeometry, b = this.index.array, c = this.attributes;
        for (var d in c) {
            for (var e = c[d], f = e.array, g = e.itemSize, h = new f.constructor(b.length * g), i = 0, j = 0, k = 0, l = b.length; l > k; k++) {
                i = b[k] * g;
                for (var m = 0; g > m; m++)h[j++] = f[i++]
            }
            a.addAttribute(d, new THREE.BufferAttribute(h, g))
        }
        return a
    }, toJSON: function () {
        var a = {metadata: {version: 4.4, type: "BufferGeometry", generator: "BufferGeometry.toJSON"}};
        if (a.uuid = this.uuid, a.type = this.type, "" !== this.name && (a.name = this.name), void 0 !== this.parameters) {
            var b = this.parameters;
            for (var c in b)void 0 !== b[c] && (a[c] = b[c]);
            return a
        }
        a.data = {attributes: {}};
        var d = this.index;
        if (null !== d) {
            var e = Array.prototype.slice.call(d.array);
            a.data.index = {type: d.array.constructor.name, array: e}
        }
        var f = this.attributes;
        for (var c in f) {
            var g = f[c], e = Array.prototype.slice.call(g.array);
            a.data.attributes[c] = {
                itemSize: g.itemSize,
                type: g.array.constructor.name,
                array: e,
                normalized: g.normalized
            }
        }
        var h = this.groups;
        h.length > 0 && (a.data.groups = JSON.parse(JSON.stringify(h)));
        var i = this.boundingSphere;
        return null !== i && (a.data.boundingSphere = {center: i.center.toArray(), radius: i.radius}), a
    }, clone: function () {
        return (new THREE.BufferGeometry).copy(this)
    }, copy: function (a) {
        var b = a.index;
        null !== b && this.setIndex(b.clone());
        var c = a.attributes;
        for (var d in c) {
            var e = c[d];
            this.addAttribute(d, e.clone())
        }
        for (var f = a.groups, g = 0, h = f.length; h > g; g++) {
            var i = f[g];
            this.addGroup(i.start, i.count, i.materialIndex)
        }
        return this
    }, dispose: function () {
        this.dispatchEvent({type: "dispose"})
    }
}),THREE.BufferGeometry.MaxIndex = 65535,THREE.InstancedBufferGeometry = function () {
    THREE.BufferGeometry.call(this), this.type = "InstancedBufferGeometry", this.maxInstancedCount = void 0
},THREE.InstancedBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry,THREE.InstancedBufferGeometry.prototype.addGroup = function (a, b, c) {
    this.groups.push({start: a, count: b, instances: c})
},THREE.InstancedBufferGeometry.prototype.copy = function (a) {
    var b = a.index;
    null !== b && this.setIndex(b.clone());
    var c = a.attributes;
    for (var d in c) {
        var e = c[d];
        this.addAttribute(d, e.clone())
    }
    for (var f = a.groups, g = 0, h = f.length; h > g; g++) {
        var i = f[g];
        this.addGroup(i.start, i.count, i.instances)
    }
    return this
},THREE.Uniform = function (a) {
    "string" == typeof a && (console.warn("THREE.Uniform: Type parameter is no longer needed."), a = arguments[1]), this.value = a, this.dynamic = !1
},THREE.Uniform.prototype = {
    constructor: THREE.Uniform, onUpdate: function (a) {
        return this.dynamic = !0, this.onUpdateCallback = a, this
    }
},THREE.AnimationAction = function () {
    throw new Error("THREE.AnimationAction: Use mixer.clipAction for construction.")
},THREE.AnimationAction._new = function (a, b, c) {
    this._mixer = a, this._clip = b, this._localRoot = c || null;
    for (var d = b.tracks, e = d.length, f = new Array(e), g = {
        endingStart: THREE.ZeroCurvatureEnding,
        endingEnd: THREE.ZeroCurvatureEnding
    }, h = 0; h !== e; ++h) {
        var i = d[h].createInterpolant(null);
        f[h] = i, i.settings = g
    }
    this._interpolantSettings = g, this._interpolants = f, this._propertyBindings = new Array(e), this._cacheIndex = null, this._byClipCacheIndex = null, this._timeScaleInterpolant = null, this._weightInterpolant = null, this.loop = THREE.LoopRepeat, this._loopCount = -1, this._startTime = null, this.time = 0, this.timeScale = 1, this._effectiveTimeScale = 1, this.weight = 1, this._effectiveWeight = 1, this.repetitions = 1 / 0, this.paused = !1, this.enabled = !0, this.clampWhenFinished = !1, this.zeroSlopeAtStart = !0, this.zeroSlopeAtEnd = !0
},THREE.AnimationAction._new.prototype = {
    constructor: THREE.AnimationAction._new, play: function () {
        return this._mixer._activateAction(this), this
    }, stop: function () {
        return this._mixer._deactivateAction(this), this.reset()
    }, reset: function () {
        return this.paused = !1, this.enabled = !0, this.time = 0, this._loopCount = -1, this._startTime = null, this.stopFading().stopWarping()
    }, isRunning: function () {
        this._startTime;
        return this.enabled && !this.paused && 0 !== this.timeScale && null === this._startTime && this._mixer._isActiveAction(this)
    }, isScheduled: function () {
        return this._mixer._isActiveAction(this)
    }, startAt: function (a) {
        return this._startTime = a, this
    }, setLoop: function (a, b) {
        return this.loop = a, this.repetitions = b, this
    }, setEffectiveWeight: function (a) {
        return this.weight = a, this._effectiveWeight = this.enabled ? a : 0, this.stopFading()
    }, getEffectiveWeight: function () {
        return this._effectiveWeight
    }, fadeIn: function (a) {
        return this._scheduleFading(a, 0, 1)
    }, fadeOut: function (a) {
        return this._scheduleFading(a, 1, 0)
    }, crossFadeFrom: function (a, b, c) {
        this._mixer;
        if (a.fadeOut(b), this.fadeIn(b), c) {
            var d = this._clip.duration, e = a._clip.duration, f = e / d, g = d / e;
            a.warp(1, f, b), this.warp(g, 1, b)
        }
        return this
    }, crossFadeTo: function (a, b, c) {
        return a.crossFadeFrom(this, b, c)
    }, stopFading: function () {
        var a = this._weightInterpolant;
        return null !== a && (this._weightInterpolant = null, this._mixer._takeBackControlInterpolant(a)), this
    }, setEffectiveTimeScale: function (a) {
        return this.timeScale = a, this._effectiveTimeScale = this.paused ? 0 : a, this.stopWarping()
    }, getEffectiveTimeScale: function () {
        return this._effectiveTimeScale
    }, setDuration: function (a) {
        return this.timeScale = this._clip.duration / a, this.stopWarping()
    }, syncWith: function (a) {
        return this.time = a.time, this.timeScale = a.timeScale, this.stopWarping()
    }, halt: function (a) {
        return this.warp(this._effectiveTimeScale, 0, a)
    }, warp: function (a, b, c) {
        var d = this._mixer, e = d.time, f = this._timeScaleInterpolant, g = this.timeScale;
        null === f && (f = d._lendControlInterpolant(), this._timeScaleInterpolant = f);
        var h = f.parameterPositions, i = f.sampleValues;
        return h[0] = e, h[1] = e + c, i[0] = a / g, i[1] = b / g, this
    }, stopWarping: function () {
        var a = this._timeScaleInterpolant;
        return null !== a && (this._timeScaleInterpolant = null, this._mixer._takeBackControlInterpolant(a)), this
    }, getMixer: function () {
        return this._mixer
    }, getClip: function () {
        return this._clip
    }, getRoot: function () {
        return this._localRoot || this._mixer._root
    }, _update: function (a, b, c, d) {
        var e = this._startTime;
        if (null !== e) {
            var f = (a - e) * c;
            if (0 > f || 0 === c)return;
            this._startTime = null, b = c * f
        }
        b *= this._updateTimeScale(a);
        var g = this._updateTime(b), h = this._updateWeight(a);
        if (h > 0)for (var i = this._interpolants, j = this._propertyBindings, k = 0, l = i.length; k !== l; ++k)i[k].evaluate(g), j[k].accumulate(d, h)
    }, _updateWeight: function (a) {
        var b = 0;
        if (this.enabled) {
            b = this.weight;
            var c = this._weightInterpolant;
            if (null !== c) {
                var d = c.evaluate(a)[0];
                b *= d, a > c.parameterPositions[1] && (this.stopFading(), 0 === d && (this.enabled = !1))
            }
        }
        return this._effectiveWeight = b, b
    }, _updateTimeScale: function (a) {
        var b = 0;
        if (!this.paused) {
            b = this.timeScale;
            var c = this._timeScaleInterpolant;
            if (null !== c) {
                var d = c.evaluate(a)[0];
                b *= d, a > c.parameterPositions[1] && (this.stopWarping(), 0 === b ? this.paused = !0 : this.timeScale = b)
            }
        }
        return this._effectiveTimeScale = b, b
    }, _updateTime: function (a) {
        var b = this.time + a;
        if (0 === a)return b;
        var c = this._clip.duration, d = this.loop, e = this._loopCount;
        if (d === THREE.LoopOnce) {
            -1 === e && (this.loopCount = 0, this._setEndings(!0, !0, !1));
            a:{
                if (b >= c)b = c; else {
                    if (!(0 > b))break a;
                    b = 0
                }
                this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, this._mixer.dispatchEvent({
                    type: "finished",
                    action: this,
                    direction: 0 > a ? -1 : 1
                })
            }
        } else {
            var f = d === THREE.LoopPingPong;
            if (-1 === e && (a >= 0 ? (e = 0, this._setEndings(!0, 0 === this.repetitions, f)) : this._setEndings(0 === this.repetitions, !0, f)), b >= c || 0 > b) {
                var g = Math.floor(b / c);
                b -= c * g, e += Math.abs(g);
                var h = this.repetitions - e;
                if (0 > h)this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, b = a > 0 ? c : 0, this._mixer.dispatchEvent({
                    type: "finished",
                    action: this,
                    direction: a > 0 ? 1 : -1
                }); else {
                    if (0 === h) {
                        var i = 0 > a;
                        this._setEndings(i, !i, f)
                    } else this._setEndings(!1, !1, f);
                    this._loopCount = e, this._mixer.dispatchEvent({type: "loop", action: this, loopDelta: g})
                }
            }
            if (f && 1 === (1 & e))return this.time = b, c - b
        }
        return this.time = b, b
    }, _setEndings: function (a, b, c) {
        var d = this._interpolantSettings;
        c ? (d.endingStart = THREE.ZeroSlopeEnding, d.endingEnd = THREE.ZeroSlopeEnding) : (a ? d.endingStart = this.zeroSlopeAtStart ? THREE.ZeroSlopeEnding : THREE.ZeroCurvatureEnding : d.endingStart = THREE.WrapAroundEnding, b ? d.endingEnd = this.zeroSlopeAtEnd ? THREE.ZeroSlopeEnding : THREE.ZeroCurvatureEnding : d.endingEnd = THREE.WrapAroundEnding)
    }, _scheduleFading: function (a, b, c) {
        var d = this._mixer, e = d.time, f = this._weightInterpolant;
        null === f && (f = d._lendControlInterpolant(), this._weightInterpolant = f);
        var g = f.parameterPositions, h = f.sampleValues;
        return g[0] = e, h[0] = b, g[1] = e + a, h[1] = c, this
    }
},THREE.AnimationClip = function (a, b, c) {
    this.name = a, this.tracks = c, this.duration = void 0 !== b ? b : -1, this.uuid = THREE.Math.generateUUID(), this.duration < 0 && this.resetDuration(), this.trim(), this.optimize()
},THREE.AnimationClip.prototype = {
    constructor: THREE.AnimationClip, resetDuration: function () {
        for (var a = this.tracks, b = 0, c = 0, d = a.length; c !== d; ++c) {
            var e = this.tracks[c];
            b = Math.max(b, e.times[e.times.length - 1])
        }
        this.duration = b
    }, trim: function () {
        for (var a = 0; a < this.tracks.length; a++)this.tracks[a].trim(0, this.duration);
        return this
    }, optimize: function () {
        for (var a = 0; a < this.tracks.length; a++)this.tracks[a].optimize();
        return this
    }
},Object.assign(THREE.AnimationClip, {
    parse: function (a) {
        for (var b = [], c = a.tracks, d = 1 / (a.fps || 1), e = 0, f = c.length; e !== f; ++e)b.push(THREE.KeyframeTrack.parse(c[e]).scale(d));
        return new THREE.AnimationClip(a.name, a.duration, b)
    }, toJSON: function (a) {
        for (var b = [], c = a.tracks, d = {
            name: a.name,
            duration: a.duration,
            tracks: b
        }, e = 0, f = c.length; e !== f; ++e)b.push(THREE.KeyframeTrack.toJSON(c[e]));
        return d
    }, CreateFromMorphTargetSequence: function (a, b, c, d) {
        for (var e = b.length, f = [], g = 0; e > g; g++) {
            var h = [], i = [];
            h.push((g + e - 1) % e, g, (g + 1) % e), i.push(0, 1, 0);
            var j = THREE.AnimationUtils.getKeyframeOrder(h);
            h = THREE.AnimationUtils.sortedArray(h, 1, j), i = THREE.AnimationUtils.sortedArray(i, 1, j), d || 0 !== h[0] || (h.push(e), i.push(i[0])), f.push(new THREE.NumberKeyframeTrack(".morphTargetInfluences[" + b[g].name + "]", h, i).scale(1 / c))
        }
        return new THREE.AnimationClip(a, -1, f)
    }, findByName: function (a, b) {
        var c = a;
        if (!Array.isArray(a)) {
            var d = a;
            c = d.geometry && d.geometry.animations || d.animations
        }
        for (var e = 0; e < c.length; e++)if (c[e].name === b)return c[e];
        return null
    }, CreateClipsFromMorphTargetSequences: function (a, b, c) {
        for (var d = {}, e = /^([\w-]*?)([\d]+)$/, f = 0, g = a.length; g > f; f++) {
            var h = a[f], i = h.name.match(e);
            if (i && i.length > 1) {
                var j = i[1], k = d[j];
                k || (d[j] = k = []), k.push(h)
            }
        }
        var l = [];
        for (var j in d)l.push(THREE.AnimationClip.CreateFromMorphTargetSequence(j, d[j], b, c));
        return l
    }, parseAnimation: function (a, b, c) {
        if (!a)return console.error("  no animation in JSONLoader data"), null;
        for (var d = function (a, b, c, d, e) {
            if (0 !== c.length) {
                var f = [], g = [];
                THREE.AnimationUtils.flattenJSON(c, f, g, d), 0 !== f.length && e.push(new a(b, f, g))
            }
        }, e = [], f = a.name || "default", g = a.length || -1, h = a.fps || 30, i = a.hierarchy || [], j = 0; j < i.length; j++) {
            var k = i[j].keys;
            if (k && 0 !== k.length)if (k[0].morphTargets) {
                for (var l = {}, m = 0; m < k.length; m++)if (k[m].morphTargets)for (var n = 0; n < k[m].morphTargets.length; n++)l[k[m].morphTargets[n]] = -1;
                for (var o in l) {
                    for (var p = [], q = [], n = 0; n !== k[m].morphTargets.length; ++n) {
                        var r = k[m];
                        p.push(r.time), q.push(r.morphTarget === o ? 1 : 0)
                    }
                    e.push(new THREE.NumberKeyframeTrack(".morphTargetInfluence[" + o + "]", p, q))
                }
                g = l.length * (h || 1)
            } else {
                var s = ".bones[" + b[j].name + "]";
                d(THREE.VectorKeyframeTrack, s + ".position", k, "pos", e), d(THREE.QuaternionKeyframeTrack, s + ".quaternion", k, "rot", e), d(THREE.VectorKeyframeTrack, s + ".scale", k, "scl", e)
            }
        }
        if (0 === e.length)return null;
        var t = new THREE.AnimationClip(f, g, e);
        return t
    }
}),THREE.AnimationMixer = function (a) {
    this._root = a, this._initMemoryManager(), this._accuIndex = 0, this.time = 0, this.timeScale = 1
},Object.assign(THREE.AnimationMixer.prototype, THREE.EventDispatcher.prototype, {
    clipAction: function (a, b) {
        var c = b || this._root, d = c.uuid, e = "string" == typeof a ? THREE.AnimationClip.findByName(c, a) : a, f = null !== e ? e.uuid : a, g = this._actionsByClip[f], h = null;
        if (void 0 !== g) {
            var i = g.actionByRoot[d];
            if (void 0 !== i)return i;
            h = g.knownActions[0], null === e && (e = h._clip)
        }
        if (null === e)return null;
        var j = new THREE.AnimationMixer._Action(this, e, b);
        return this._bindAction(j, h), this._addInactiveAction(j, f, d), j
    }, existingAction: function (a, b) {
        var c = b || this._root, d = c.uuid, e = "string" == typeof a ? THREE.AnimationClip.findByName(c, a) : a, f = e ? e.uuid : a, g = this._actionsByClip[f];
        return void 0 !== g ? g.actionByRoot[d] || null : null
    }, stopAllAction: function () {
        var a = this._actions, b = this._nActiveActions, c = this._bindings, d = this._nActiveBindings;
        this._nActiveActions = 0, this._nActiveBindings = 0;
        for (var e = 0; e !== b; ++e)a[e].reset();
        for (var e = 0; e !== d; ++e)c[e].useCount = 0;
        return this
    }, update: function (a) {
        a *= this.timeScale;
        for (var b = this._actions, c = this._nActiveActions, d = this.time += a, e = Math.sign(a), f = this._accuIndex ^= 1, g = 0; g !== c; ++g) {
            var h = b[g];
            h.enabled && h._update(d, a, e, f)
        }
        for (var i = this._bindings, j = this._nActiveBindings, g = 0; g !== j; ++g)i[g].apply(f);
        return this
    }, getRoot: function () {
        return this._root
    }, uncacheClip: function (a) {
        var b = this._actions, c = a.uuid, d = this._actionsByClip, e = d[c];
        if (void 0 !== e) {
            for (var f = e.knownActions, g = 0, h = f.length; g !== h; ++g) {
                var i = f[g];
                this._deactivateAction(i);
                var j = i._cacheIndex, k = b[b.length - 1];
                i._cacheIndex = null, i._byClipCacheIndex = null, k._cacheIndex = j, b[j] = k, b.pop(), this._removeInactiveBindingsForAction(i)
            }
            delete d[c]
        }
    }, uncacheRoot: function (a) {
        var b = a.uuid, c = this._actionsByClip;
        for (var d in c) {
            var e = c[d].actionByRoot, f = e[b];
            void 0 !== f && (this._deactivateAction(f), this._removeInactiveAction(f))
        }
        var g = this._bindingsByRootAndName, h = g[b];
        if (void 0 !== h)for (var i in h) {
            var j = h[i];
            j.restoreOriginalState(), this._removeInactiveBinding(j)
        }
    }, uncacheAction: function (a, b) {
        var c = this.existingAction(a, b);
        null !== c && (this._deactivateAction(c), this._removeInactiveAction(c))
    }
}),THREE.AnimationMixer._Action = THREE.AnimationAction._new,Object.assign(THREE.AnimationMixer.prototype, {
    _bindAction: function (a, b) {
        var c = a._localRoot || this._root, d = a._clip.tracks, e = d.length, f = a._propertyBindings, g = a._interpolants, h = c.uuid, i = this._bindingsByRootAndName, j = i[h];
        void 0 === j && (j = {}, i[h] = j);
        for (var k = 0; k !== e; ++k) {
            var l = d[k], m = l.name, n = j[m];
            if (void 0 !== n)f[k] = n; else {
                if (n = f[k], void 0 !== n) {
                    null === n._cacheIndex && (++n.referenceCount, this._addInactiveBinding(n, h, m));
                    continue
                }
                var o = b && b._propertyBindings[k].binding.parsedPath;
                n = new THREE.PropertyMixer(THREE.PropertyBinding.create(c, m, o), l.ValueTypeName, l.getValueSize()), ++n.referenceCount, this._addInactiveBinding(n, h, m), f[k] = n
            }
            g[k].resultBuffer = n.buffer
        }
    }, _activateAction: function (a) {
        if (!this._isActiveAction(a)) {
            if (null === a._cacheIndex) {
                var b = (a._localRoot || this._root).uuid, c = a._clip.uuid, d = this._actionsByClip[c];
                this._bindAction(a, d && d.knownActions[0]), this._addInactiveAction(a, c, b)
            }
            for (var e = a._propertyBindings, f = 0, g = e.length; f !== g; ++f) {
                var h = e[f];
                0 === h.useCount++ && (this._lendBinding(h), h.saveOriginalState())
            }
            this._lendAction(a)
        }
    }, _deactivateAction: function (a) {
        if (this._isActiveAction(a)) {
            for (var b = a._propertyBindings, c = 0, d = b.length; c !== d; ++c) {
                var e = b[c];
                0 === --e.useCount && (e.restoreOriginalState(), this._takeBackBinding(e))
            }
            this._takeBackAction(a)
        }
    }, _initMemoryManager: function () {
        this._actions = [], this._nActiveActions = 0, this._actionsByClip = {}, this._bindings = [], this._nActiveBindings = 0, this._bindingsByRootAndName = {}, this._controlInterpolants = [], this._nActiveControlInterpolants = 0;
        var a = this;
        this.stats = {
            actions: {
                get total() {
                    return a._actions.length
                }, get inUse() {
                    return a._nActiveActions
                }
            }, bindings: {
                get total() {
                    return a._bindings.length
                }, get inUse() {
                    return a._nActiveBindings
                }
            }, controlInterpolants: {
                get total() {
                    return a._controlInterpolants.length
                }, get inUse() {
                    return a._nActiveControlInterpolants
                }
            }
        }
    }, _isActiveAction: function (a) {
        var b = a._cacheIndex;
        return null !== b && b < this._nActiveActions
    }, _addInactiveAction: function (a, b, c) {
        var d = this._actions, e = this._actionsByClip, f = e[b];
        if (void 0 === f)f = {knownActions: [a], actionByRoot: {}}, a._byClipCacheIndex = 0, e[b] = f; else {
            var g = f.knownActions;
            a._byClipCacheIndex = g.length, g.push(a)
        }
        a._cacheIndex = d.length, d.push(a), f.actionByRoot[c] = a
    }, _removeInactiveAction: function (a) {
        var b = this._actions, c = b[b.length - 1], d = a._cacheIndex;
        c._cacheIndex = d, b[d] = c, b.pop(), a._cacheIndex = null;
        var e = a._clip.uuid, f = this._actionsByClip, g = f[e], h = g.knownActions, i = h[h.length - 1], j = a._byClipCacheIndex;
        i._byClipCacheIndex = j, h[j] = i, h.pop(), a._byClipCacheIndex = null;
        var k = g.actionByRoot, l = (b._localRoot || this._root).uuid;
        delete k[l], 0 === h.length && delete f[e], this._removeInactiveBindingsForAction(a)
    }, _removeInactiveBindingsForAction: function (a) {
        for (var b = a._propertyBindings, c = 0, d = b.length; c !== d; ++c) {
            var e = b[c];
            0 === --e.referenceCount && this._removeInactiveBinding(e)
        }
    }, _lendAction: function (a) {
        var b = this._actions, c = a._cacheIndex, d = this._nActiveActions++, e = b[d];
        a._cacheIndex = d, b[d] = a, e._cacheIndex = c, b[c] = e
    }, _takeBackAction: function (a) {
        var b = this._actions, c = a._cacheIndex, d = --this._nActiveActions, e = b[d];
        a._cacheIndex = d, b[d] = a, e._cacheIndex = c, b[c] = e
    }, _addInactiveBinding: function (a, b, c) {
        var d = this._bindingsByRootAndName, e = d[b], f = this._bindings;
        void 0 === e && (e = {}, d[b] = e), e[c] = a, a._cacheIndex = f.length, f.push(a)
    }, _removeInactiveBinding: function (a) {
        var b = this._bindings, c = a.binding, d = c.rootNode.uuid, e = c.path, f = this._bindingsByRootAndName, g = f[d], h = b[b.length - 1], i = a._cacheIndex;
        h._cacheIndex = i, b[i] = h, b.pop(), delete g[e];
        a:{
            for (var j in g)break a;
            delete f[d]
        }
    }, _lendBinding: function (a) {
        var b = this._bindings, c = a._cacheIndex, d = this._nActiveBindings++, e = b[d];
        a._cacheIndex = d, b[d] = a, e._cacheIndex = c, b[c] = e
    }, _takeBackBinding: function (a) {
        var b = this._bindings, c = a._cacheIndex, d = --this._nActiveBindings, e = b[d];
        a._cacheIndex = d, b[d] = a, e._cacheIndex = c, b[c] = e
    }, _lendControlInterpolant: function () {
        var a = this._controlInterpolants, b = this._nActiveControlInterpolants++, c = a[b];
        return void 0 === c && (c = new THREE.LinearInterpolant(new Float32Array(2), new Float32Array(2), 1, this._controlInterpolantsResultBuffer), c.__cacheIndex = b, a[b] = c), c
    }, _takeBackControlInterpolant: function (a) {
        var b = this._controlInterpolants, c = a.__cacheIndex, d = --this._nActiveControlInterpolants, e = b[d];
        a.__cacheIndex = d, b[d] = a, e.__cacheIndex = c, b[c] = e
    }, _controlInterpolantsResultBuffer: new Float32Array(1)
}),THREE.AnimationObjectGroup = function (a) {
    this.uuid = THREE.Math.generateUUID(), this._objects = Array.prototype.slice.call(arguments), this.nCachedObjects_ = 0;
    var b = {};
    this._indicesByUUID = b;
    for (var c = 0, d = arguments.length; c !== d; ++c)b[arguments[c].uuid] = c;
    this._paths = [], this._parsedPaths = [], this._bindings = [], this._bindingsIndicesByPath = {};
    var e = this;
    this.stats = {
        objects: {
            get total() {
                return e._objects.length
            }, get inUse() {
                return this.total - e.nCachedObjects_
            }
        }, get bindingsPerObject() {
            return e._bindings.length
        }
    }
},THREE.AnimationObjectGroup.prototype = {
    constructor: THREE.AnimationObjectGroup, add: function (a) {
        for (var b = this._objects, c = b.length, d = this.nCachedObjects_, e = this._indicesByUUID, f = this._paths, g = this._parsedPaths, h = this._bindings, i = h.length, j = 0, k = arguments.length; j !== k; ++j) {
            var l = arguments[j], m = l.uuid, n = e[m];
            if (void 0 === n) {
                n = c++, e[m] = n, b.push(l);
                for (var o = 0, p = i; o !== p; ++o)h[o].push(new THREE.PropertyBinding(l, f[o], g[o]))
            } else if (d > n) {
                var q = b[n], r = --d, s = b[r];
                e[s.uuid] = n, b[n] = s, e[m] = r, b[r] = l;
                for (var o = 0, p = i; o !== p; ++o) {
                    var t = h[o], u = t[r], v = t[n];
                    t[n] = u, void 0 === v && (v = new THREE.PropertyBinding(l, f[o], g[o])), t[r] = v
                }
            } else b[n] !== q && console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")
        }
        this.nCachedObjects_ = d
    }, remove: function (a) {
        for (var b = this._objects, c = (b.length, this.nCachedObjects_), d = this._indicesByUUID, e = this._bindings, f = e.length, g = 0, h = arguments.length; g !== h; ++g) {
            var i = arguments[g], j = i.uuid, k = d[j];
            if (void 0 !== k && k >= c) {
                var l = c++, m = b[l];
                d[m.uuid] = k, b[k] = m, d[j] = l, b[l] = i;
                for (var n = 0, o = f; n !== o; ++n) {
                    var p = e[n], q = p[l], r = p[k];
                    p[k] = q, p[l] = r
                }
            }
        }
        this.nCachedObjects_ = c
    }, uncache: function (a) {
        for (var b = this._objects, c = b.length, d = this.nCachedObjects_, e = this._indicesByUUID, f = this._bindings, g = f.length, h = 0, i = arguments.length; h !== i; ++h) {
            var j = arguments[h], k = j.uuid, l = e[k];
            if (void 0 !== l)if (delete e[k], d > l) {
                var m = --d, n = b[m], o = --c, p = b[o];
                e[n.uuid] = l, b[l] = n, e[p.uuid] = m, b[m] = p, b.pop();
                for (var q = 0, r = g; q !== r; ++q) {
                    var s = f[q], t = s[m], u = s[o];
                    s[l] = t, s[m] = u, s.pop()
                }
            } else {
                var o = --c, p = b[o];
                e[p.uuid] = l, b[l] = p, b.pop();
                for (var q = 0, r = g; q !== r; ++q) {
                    var s = f[q];
                    s[l] = s[o], s.pop()
                }
            }
        }
        this.nCachedObjects_ = d
    }, subscribe_: function (a, b) {
        var c = this._bindingsIndicesByPath, d = c[a], e = this._bindings;
        if (void 0 !== d)return e[d];
        var f = this._paths, g = this._parsedPaths, h = this._objects, i = h.length, j = this.nCachedObjects_, k = new Array(i);
        d = e.length, c[a] = d, f.push(a), g.push(b), e.push(k);
        for (var l = j, m = h.length; l !== m; ++l) {
            var n = h[l];
            k[l] = new THREE.PropertyBinding(n, a, b)
        }
        return k
    }, unsubscribe_: function (a) {
        var b = this._bindingsIndicesByPath, c = b[a];
        if (void 0 !== c) {
            var d = this._paths, e = this._parsedPaths, f = this._bindings, g = f.length - 1, h = f[g], i = a[g];
            b[i] = c, f[c] = h, f.pop(), e[c] = e[g], e.pop(), d[c] = d[g], d.pop()
        }
    }
},THREE.AnimationUtils = {
    arraySlice: function (a, b, c) {
        return THREE.AnimationUtils.isTypedArray(a) ? new a.constructor(a.subarray(b, c)) : a.slice(b, c)
    }, convertArray: function (a, b, c) {
        return !a || !c && a.constructor === b ? a : "number" == typeof b.BYTES_PER_ELEMENT ? new b(a) : Array.prototype.slice.call(a)
    }, isTypedArray: function (a) {
        return ArrayBuffer.isView(a) && !(a instanceof DataView)
    }, getKeyframeOrder: function (a) {
        function b(b, c) {
            return a[b] - a[c]
        }

        for (var c = a.length, d = new Array(c), e = 0; e !== c; ++e)d[e] = e;
        return d.sort(b), d
    }, sortedArray: function (a, b, c) {
        for (var d = a.length, e = new a.constructor(d), f = 0, g = 0; g !== d; ++f)for (var h = c[f] * b, i = 0; i !== b; ++i)e[g++] = a[h + i];
        return e
    }, flattenJSON: function (a, b, c, d) {
        for (var e = 1, f = a[0]; void 0 !== f && void 0 === f[d];)f = a[e++];
        if (void 0 !== f) {
            var g = f[d];
            if (void 0 !== g)if (Array.isArray(g)) {
                do g = f[d], void 0 !== g && (b.push(f.time), c.push.apply(c, g)), f = a[e++]; while (void 0 !== f)
            } else if (void 0 !== g.toArray) {
                do g = f[d], void 0 !== g && (b.push(f.time), g.toArray(c, c.length)), f = a[e++]; while (void 0 !== f)
            } else do g = f[d], void 0 !== g && (b.push(f.time), c.push(g)), f = a[e++]; while (void 0 !== f)
        }
    }
},THREE.KeyframeTrack = function (a, b, c, d) {
    if (void 0 === a)throw new Error("track name is undefined");
    if (void 0 === b || 0 === b.length)throw new Error("no keyframes in track named " + a);
    this.name = a, this.times = THREE.AnimationUtils.convertArray(b, this.TimeBufferType), this.values = THREE.AnimationUtils.convertArray(c, this.ValueBufferType), this.setInterpolation(d || this.DefaultInterpolation), this.validate(), this.optimize()
},THREE.KeyframeTrack.prototype = {
    constructor: THREE.KeyframeTrack,
    TimeBufferType: Float32Array,
    ValueBufferType: Float32Array,
    DefaultInterpolation: THREE.InterpolateLinear,
    InterpolantFactoryMethodDiscrete: function (a) {
        return new THREE.DiscreteInterpolant(this.times, this.values, this.getValueSize(), a)
    },
    InterpolantFactoryMethodLinear: function (a) {
        return new THREE.LinearInterpolant(this.times, this.values, this.getValueSize(), a)
    },
    InterpolantFactoryMethodSmooth: function (a) {
        return new THREE.CubicInterpolant(this.times, this.values, this.getValueSize(), a)
    },
    setInterpolation: function (a) {
        var b;
        switch (a) {
            case THREE.InterpolateDiscrete:
                b = this.InterpolantFactoryMethodDiscrete;
                break;
            case THREE.InterpolateLinear:
                b = this.InterpolantFactoryMethodLinear;
                break;
            case THREE.InterpolateSmooth:
                b = this.InterpolantFactoryMethodSmooth
        }
        if (void 0 === b) {
            var c = "unsupported interpolation for " + this.ValueTypeName + " keyframe track named " + this.name;
            if (void 0 === this.createInterpolant) {
                if (a === this.DefaultInterpolation)throw new Error(c);
                this.setInterpolation(this.DefaultInterpolation)
            }
            return void console.warn(c)
        }
        this.createInterpolant = b
    },
    getInterpolation: function () {
        switch (this.createInterpolant) {
            case this.InterpolantFactoryMethodDiscrete:
                return THREE.InterpolateDiscrete;
            case this.InterpolantFactoryMethodLinear:
                return THREE.InterpolateLinear;
            case this.InterpolantFactoryMethodSmooth:
                return THREE.InterpolateSmooth
        }
    },
    getValueSize: function () {
        return this.values.length / this.times.length
    },
    shift: function (a) {
        if (0 !== a)for (var b = this.times, c = 0, d = b.length; c !== d; ++c)b[c] += a;
        return this
    },
    scale: function (a) {
        if (1 !== a)for (var b = this.times, c = 0, d = b.length; c !== d; ++c)b[c] *= a;
        return this
    },
    trim: function (a, b) {
        for (var c = this.times, d = c.length, e = 0, f = d - 1; e !== d && c[e] < a;)++e;
        for (; -1 !== f && c[f] > b;)--f;
        if (++f, 0 !== e || f !== d) {
            e >= f && (f = Math.max(f, 1), e = f - 1);
            var g = this.getValueSize();
            this.times = THREE.AnimationUtils.arraySlice(c, e, f), this.values = THREE.AnimationUtils.arraySlice(this.values, e * g, f * g)
        }
        return this
    },
    validate: function () {
        var a = !0, b = this.getValueSize();
        b - Math.floor(b) !== 0 && (console.error("invalid value size in track", this), a = !1);
        var c = this.times, d = this.values, e = c.length;
        0 === e && (console.error("track is empty", this), a = !1);
        for (var f = null, g = 0; g !== e; g++) {
            var h = c[g];
            if ("number" == typeof h && isNaN(h)) {
                console.error("time is not a valid number", this, g, h), a = !1;
                break
            }
            if (null !== f && f > h) {
                console.error("out of order keys", this, g, h, f), a = !1;
                break
            }
            f = h
        }
        if (void 0 !== d && THREE.AnimationUtils.isTypedArray(d))for (var g = 0, i = d.length; g !== i; ++g) {
            var j = d[g];
            if (isNaN(j)) {
                console.error("value is not a valid number", this, g, j), a = !1;
                break
            }
        }
        return a
    },
    optimize: function () {
        for (var a = this.times, b = this.values, c = this.getValueSize(), d = 1, e = 1, f = a.length - 1; f >= e; ++e) {
            var g = !1, h = a[e], i = a[e + 1];
            if (h !== i && (1 !== e || h !== h[0]))for (var j = e * c, k = j - c, l = j + c, m = 0; m !== c; ++m) {
                var n = b[j + m];
                if (n !== b[k + m] || n !== b[l + m]) {
                    g = !0;
                    break
                }
            }
            if (g) {
                if (e !== d) {
                    a[d] = a[e];
                    for (var o = e * c, p = d * c, m = 0; m !== c; ++m)b[p + m] = b[o + m]
                }
                ++d
            }
        }
        return d !== a.length && (this.times = THREE.AnimationUtils.arraySlice(a, 0, d), this.values = THREE.AnimationUtils.arraySlice(b, 0, d * c)), this
    }
},Object.assign(THREE.KeyframeTrack, {
    parse: function (a) {
        if (void 0 === a.type)throw new Error("track type undefined, can not parse");
        var b = THREE.KeyframeTrack._getTrackTypeForValueTypeName(a.type);
        if (void 0 === a.times) {
            var c = [], d = [];
            THREE.AnimationUtils.flattenJSON(a.keys, c, d, "value"), a.times = c, a.values = d
        }
        return void 0 !== b.parse ? b.parse(a) : new b(a.name, a.times, a.values, a.interpolation)
    }, toJSON: function (a) {
        var b, c = a.constructor;
        if (void 0 !== c.toJSON)b = c.toJSON(a); else {
            b = {
                name: a.name,
                times: THREE.AnimationUtils.convertArray(a.times, Array),
                values: THREE.AnimationUtils.convertArray(a.values, Array)
            };
            var d = a.getInterpolation();
            d !== a.DefaultInterpolation && (b.interpolation = d)
        }
        return b.type = a.ValueTypeName, b
    }, _getTrackTypeForValueTypeName: function (a) {
        switch (a.toLowerCase()) {
            case"scalar":
            case"double":
            case"float":
            case"number":
            case"integer":
                return THREE.NumberKeyframeTrack;
            case"vector":
            case"vector2":
            case"vector3":
            case"vector4":
                return THREE.VectorKeyframeTrack;
            case"color":
                return THREE.ColorKeyframeTrack;
            case"quaternion":
                return THREE.QuaternionKeyframeTrack;
            case"bool":
            case"boolean":
                return THREE.BooleanKeyframeTrack;
            case"string":
                return THREE.StringKeyframeTrack
        }
        throw new Error("Unsupported typeName: " + a)
    }
}),THREE.PropertyBinding = function (a, b, c) {
    this.path = b, this.parsedPath = c || THREE.PropertyBinding.parseTrackName(b), this.node = THREE.PropertyBinding.findNode(a, this.parsedPath.nodeName) || a, this.rootNode = a
},THREE.PropertyBinding.prototype = {
    constructor: THREE.PropertyBinding,
    getValue: function (a, b) {
        this.bind(), this.getValue(a, b)
    }, setValue: function (a, b) {
        this.bind(), this.setValue(a, b)
    }, bind: function () {
        var a = this.node, b = this.parsedPath, c = b.objectName, d = b.propertyName, e = b.propertyIndex;
        if (a || (a = THREE.PropertyBinding.findNode(this.rootNode, b.nodeName) || this.rootNode, this.node = a), this.getValue = this._getValue_unavailable, this.setValue = this._setValue_unavailable, !a)return void console.error("  trying to update node for track: " + this.path + " but it wasn't found.");
        if (c) {
            var f = b.objectIndex;
            switch (c) {
                case"materials":
                    if (!a.material)return void console.error("  can not bind to material as node does not have a material", this);
                    if (!a.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array", this);
                    a = a.material.materials;
                    break;
                case"bones":
                    if (!a.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton", this);
                    a = a.skeleton.bones;
                    for (var g = 0; g < a.length; g++)if (a[g].name === f) {
                        f = g;
                        break
                    }
                    break;
                default:
                    if (void 0 === a[c])return void console.error("  can not bind to objectName of node, undefined", this);
                    a = a[c]
            }
            if (void 0 !== f) {
                if (void 0 === a[f])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:", this, a);
                a = a[f]
            }
        }
        var h = a[d];
        if (void 0 === h) {
            var i = b.nodeName;
            return void console.error("  trying to update property for track: " + i + "." + d + " but it wasn't found.", a)
        }
        var j = this.Versioning.None;
        void 0 !== a.needsUpdate ? (j = this.Versioning.NeedsUpdate, this.targetObject = a) : void 0 !== a.matrixWorldNeedsUpdate && (j = this.Versioning.MatrixWorldNeedsUpdate, this.targetObject = a);
        var k = this.BindingType.Direct;
        if (void 0 !== e) {
            if ("morphTargetInfluences" === d) {
                if (!a.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry", this);
                if (!a.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets", this);
                for (var g = 0; g < this.node.geometry.morphTargets.length; g++)if (a.geometry.morphTargets[g].name === e) {
                    e = g;
                    break
                }
            }
            k = this.BindingType.ArrayElement, this.resolvedProperty = h, this.propertyIndex = e
        } else void 0 !== h.fromArray && void 0 !== h.toArray ? (k = this.BindingType.HasFromToArray, this.resolvedProperty = h) : void 0 !== h.length ? (k = this.BindingType.EntireArray, this.resolvedProperty = h) : this.propertyName = d;
        this.getValue = this.GetterByBindingType[k], this.setValue = this.SetterByBindingTypeAndVersioning[k][j]
    }, unbind: function () {
        this.node = null, this.getValue = this._getValue_unbound, this.setValue = this._setValue_unbound
    }
},Object.assign(THREE.PropertyBinding.prototype, {
    _getValue_unavailable: function () {
    },
    _setValue_unavailable: function () {
    },
    _getValue_unbound: THREE.PropertyBinding.prototype.getValue,
    _setValue_unbound: THREE.PropertyBinding.prototype.setValue,
    BindingType: {Direct: 0, EntireArray: 1, ArrayElement: 2, HasFromToArray: 3},
    Versioning: {None: 0, NeedsUpdate: 1, MatrixWorldNeedsUpdate: 2},
    GetterByBindingType: [function (a, b) {
        a[b] = this.node[this.propertyName]
    }, function (a, b) {
        for (var c = this.resolvedProperty, d = 0, e = c.length; d !== e; ++d)a[b++] = c[d]
    }, function (a, b) {
        a[b] = this.resolvedProperty[this.propertyIndex]
    }, function (a, b) {
        this.resolvedProperty.toArray(a, b)
    }],
    SetterByBindingTypeAndVersioning: [[function (a, b) {
        this.node[this.propertyName] = a[b]
    }, function (a, b) {
        this.node[this.propertyName] = a[b], this.targetObject.needsUpdate = !0
    }, function (a, b) {
        this.node[this.propertyName] = a[b], this.targetObject.matrixWorldNeedsUpdate = !0
    }], [function (a, b) {
        for (var c = this.resolvedProperty, d = 0, e = c.length; d !== e; ++d)c[d] = a[b++]
    }, function (a, b) {
        for (var c = this.resolvedProperty, d = 0, e = c.length; d !== e; ++d)c[d] = a[b++];
        this.targetObject.needsUpdate = !0
    }, function (a, b) {
        for (var c = this.resolvedProperty, d = 0, e = c.length; d !== e; ++d)c[d] = a[b++];
        this.targetObject.matrixWorldNeedsUpdate = !0
    }], [function (a, b) {
        this.resolvedProperty[this.propertyIndex] = a[b]
    }, function (a, b) {
        this.resolvedProperty[this.propertyIndex] = a[b], this.targetObject.needsUpdate = !0
    }, function (a, b) {
        this.resolvedProperty[this.propertyIndex] = a[b], this.targetObject.matrixWorldNeedsUpdate = !0
    }], [function (a, b) {
        this.resolvedProperty.fromArray(a, b)
    }, function (a, b) {
        this.resolvedProperty.fromArray(a, b), this.targetObject.needsUpdate = !0
    }, function (a, b) {
        this.resolvedProperty.fromArray(a, b), this.targetObject.matrixWorldNeedsUpdate = !0
    }]]
}),THREE.PropertyBinding.Composite = function (a, b, c) {
    var d = c || THREE.PropertyBinding.parseTrackName(b);
    this._targetGroup = a, this._bindings = a.subscribe_(b, d)
},THREE.PropertyBinding.Composite.prototype = {
    constructor: THREE.PropertyBinding.Composite, getValue: function (a, b) {
        this.bind();
        var c = this._targetGroup.nCachedObjects_, d = this._bindings[c];
        void 0 !== d && d.getValue(a, b)
    }, setValue: function (a, b) {
        for (var c = this._bindings, d = this._targetGroup.nCachedObjects_, e = c.length; d !== e; ++d)c[d].setValue(a, b)
    }, bind: function () {
        for (var a = this._bindings, b = this._targetGroup.nCachedObjects_, c = a.length; b !== c; ++b)a[b].bind()
    }, unbind: function () {
        for (var a = this._bindings, b = this._targetGroup.nCachedObjects_, c = a.length; b !== c; ++b)a[b].unbind()
    }
},THREE.PropertyBinding.create = function (a, b, c) {
    return a instanceof THREE.AnimationObjectGroup ? new THREE.PropertyBinding.Composite(a, b, c) : new THREE.PropertyBinding(a, b, c)
},THREE.PropertyBinding.parseTrackName = function (a) {
    var b = /^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/, c = b.exec(a);
    if (!c)throw new Error("cannot parse trackName at all: " + a);
    c.index === b.lastIndex && b.lastIndex++;
    var d = {nodeName: c[3], objectName: c[5], objectIndex: c[7], propertyName: c[9], propertyIndex: c[11]};
    if (null === d.propertyName || 0 === d.propertyName.length)throw new Error("can not parse propertyName from trackName: " + a);
    return d
},THREE.PropertyBinding.findNode = function (a, b) {
    if (!b || "" === b || "root" === b || "." === b || -1 === b || b === a.name || b === a.uuid)return a;
    if (a.skeleton) {
        var c = function (a) {
            for (var c = 0; c < a.bones.length; c++) {
                var d = a.bones[c];
                if (d.name === b)return d
            }
            return null
        }, d = c(a.skeleton);
        if (d)return d
    }
    if (a.children) {
        var e = function (a) {
            for (var c = 0; c < a.length; c++) {
                var d = a[c];
                if (d.name === b || d.uuid === b)return d;
                var f = e(d.children);
                if (f)return f
            }
            return null
        }, f = e(a.children);
        if (f)return f
    }
    return null
},THREE.PropertyMixer = function (a, b, c) {
    this.binding = a, this.valueSize = c;
    var d, e = Float64Array;
    switch (b) {
        case"quaternion":
            d = this._slerp;
            break;
        case"string":
        case"bool":
            e = Array, d = this._select;
            break;
        default:
            d = this._lerp
    }
    this.buffer = new e(4 * c), this._mixBufferRegion = d, this.cumulativeWeight = 0, this.useCount = 0, this.referenceCount = 0
},THREE.PropertyMixer.prototype = {
    constructor: THREE.PropertyMixer, accumulate: function (a, b) {
        var c = this.buffer, d = this.valueSize, e = a * d + d, f = this.cumulativeWeight;
        if (0 === f) {
            for (var g = 0; g !== d; ++g)c[e + g] = c[g];
            f = b
        } else {
            f += b;
            var h = b / f;
            this._mixBufferRegion(c, e, 0, h, d)
        }
        this.cumulativeWeight = f
    }, apply: function (a) {
        var b = this.valueSize, c = this.buffer, d = a * b + b, e = this.cumulativeWeight, f = this.binding;
        if (this.cumulativeWeight = 0, 1 > e) {
            var g = 3 * b;
            this._mixBufferRegion(c, d, g, 1 - e, b)
        }
        for (var h = b, i = b + b; h !== i; ++h)if (c[h] !== c[h + b]) {
            f.setValue(c, d);
            break
        }
    }, saveOriginalState: function () {
        var a = this.binding, b = this.buffer, c = this.valueSize, d = 3 * c;
        a.getValue(b, d);
        for (var e = c, f = d; e !== f; ++e)b[e] = b[d + e % c];
        this.cumulativeWeight = 0
    }, restoreOriginalState: function () {
        var a = 3 * this.valueSize;
        this.binding.setValue(this.buffer, a)
    }, _select: function (a, b, c, d, e) {
        if (d >= .5)for (var f = 0; f !== e; ++f)a[b + f] = a[c + f]
    }, _slerp: function (a, b, c, d, e) {
        THREE.Quaternion.slerpFlat(a, b, a, b, a, c, d)
    }, _lerp: function (a, b, c, d, e) {
        for (var f = 1 - d, g = 0; g !== e; ++g) {
            var h = b + g;
            a[h] = a[h] * f + a[c + g] * d
        }
    }
},THREE.BooleanKeyframeTrack = function (a, b, c) {
    THREE.KeyframeTrack.call(this, a, b, c)
},THREE.BooleanKeyframeTrack.prototype = Object.assign(Object.create(THREE.KeyframeTrack.prototype), {
    constructor: THREE.BooleanKeyframeTrack,
    ValueTypeName: "bool",
    ValueBufferType: Array,
    DefaultInterpolation: THREE.InterpolateDiscrete,
    InterpolantFactoryMethodLinear: void 0,
    InterpolantFactoryMethodSmooth: void 0
}),THREE.ColorKeyframeTrack = function (a, b, c, d) {
    THREE.KeyframeTrack.call(this, a, b, c, d)
},THREE.ColorKeyframeTrack.prototype = Object.assign(Object.create(THREE.KeyframeTrack.prototype), {
    constructor: THREE.ColorKeyframeTrack,
    ValueTypeName: "color"
}),THREE.NumberKeyframeTrack = function (a, b, c, d) {
    THREE.KeyframeTrack.call(this, a, b, c, d)
},THREE.NumberKeyframeTrack.prototype = Object.assign(Object.create(THREE.KeyframeTrack.prototype), {
    constructor: THREE.NumberKeyframeTrack,
    ValueTypeName: "number"
}),THREE.QuaternionKeyframeTrack = function (a, b, c, d) {
    THREE.KeyframeTrack.call(this, a, b, c, d)
},THREE.QuaternionKeyframeTrack.prototype = Object.assign(Object.create(THREE.KeyframeTrack.prototype), {
    constructor: THREE.QuaternionKeyframeTrack,
    ValueTypeName: "quaternion",
    DefaultInterpolation: THREE.InterpolateLinear,
    InterpolantFactoryMethodLinear: function (a) {
        return new THREE.QuaternionLinearInterpolant(this.times, this.values, this.getValueSize(), a)
    },
    InterpolantFactoryMethodSmooth: void 0
}),THREE.StringKeyframeTrack = function (a, b, c, d) {
    THREE.KeyframeTrack.call(this, a, b, c, d)
},THREE.StringKeyframeTrack.prototype = Object.assign(Object.create(THREE.KeyframeTrack.prototype), {
    constructor: THREE.StringKeyframeTrack,
    ValueTypeName: "string",
    ValueBufferType: Array,
    DefaultInterpolation: THREE.InterpolateDiscrete,
    InterpolantFactoryMethodLinear: void 0,
    InterpolantFactoryMethodSmooth: void 0
}),THREE.VectorKeyframeTrack = function (a, b, c, d) {
    THREE.KeyframeTrack.call(this, a, b, c, d)
},THREE.VectorKeyframeTrack.prototype = Object.assign(Object.create(THREE.KeyframeTrack.prototype), {
    constructor: THREE.VectorKeyframeTrack,
    ValueTypeName: "vector"
}),THREE.Audio = function (a) {
    THREE.Object3D.call(this), this.type = "Audio", this.context = a.context, this.source = this.context.createBufferSource(), this.source.onended = this.onEnded.bind(this), this.gain = this.context.createGain(), this.gain.connect(a.getInput()), this.autoplay = !1, this.startTime = 0, this.playbackRate = 1, this.isPlaying = !1, this.hasPlaybackControl = !0, this.sourceType = "empty", this.filters = []
},THREE.Audio.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Audio,
    getOutput: function () {
        return this.gain
    },
    setNodeSource: function (a) {
        return this.hasPlaybackControl = !1, this.sourceType = "audioNode", this.source = a, this.connect(), this
    },
    setBuffer: function (a) {
        return this.source.buffer = a, this.sourceType = "buffer", this.autoplay && this.play(), this
    },
    play: function () {
        if (this.isPlaying === !0)return void console.warn("THREE.Audio: Audio is already playing.");
        if (this.hasPlaybackControl === !1)return void console.warn("THREE.Audio: this Audio has no playback control.");
        var a = this.context.createBufferSource();
        return a.buffer = this.source.buffer, a.loop = this.source.loop, a.onended = this.source.onended, a.start(0, this.startTime), a.playbackRate.value = this.playbackRate, this.isPlaying = !0, this.source = a, this.connect()
    },
    pause: function () {
        return this.hasPlaybackControl === !1 ? void console.warn("THREE.Audio: this Audio has no playback control.") : (this.source.stop(), this.startTime = this.context.currentTime, this.isPlaying = !1, this)
    },
    stop: function () {
        return this.hasPlaybackControl === !1 ? void console.warn("THREE.Audio: this Audio has no playback control.") : (this.source.stop(), this.startTime = 0, this.isPlaying = !1, this)
    },
    connect: function () {
        if (this.filters.length > 0) {
            this.source.connect(this.filters[0]);
            for (var a = 1, b = this.filters.length; b > a; a++)this.filters[a - 1].connect(this.filters[a]);
            this.filters[this.filters.length - 1].connect(this.getOutput())
        } else this.source.connect(this.getOutput());
        return this
    },
    disconnect: function () {
        if (this.filters.length > 0) {
            this.source.disconnect(this.filters[0]);
            for (var a = 1, b = this.filters.length; b > a; a++)this.filters[a - 1].disconnect(this.filters[a]);
            this.filters[this.filters.length - 1].disconnect(this.getOutput())
        } else this.source.disconnect(this.getOutput());
        return this
    },
    getFilters: function () {
        return this.filters
    },
    setFilters: function (a) {
        return a || (a = []), this.isPlaying === !0 ? (this.disconnect(), this.filters = a, this.connect()) : this.filters = a, this
    },
    getFilter: function () {
        return this.getFilters()[0]
    },
    setFilter: function (a) {
        return this.setFilters(a ? [a] : [])
    },
    setPlaybackRate: function (a) {
        return this.hasPlaybackControl === !1 ? void console.warn("THREE.Audio: this Audio has no playback control.") : (this.playbackRate = a, this.isPlaying === !0 && (this.source.playbackRate.value = this.playbackRate), this)
    },
    getPlaybackRate: function () {
        return this.playbackRate
    },
    onEnded: function () {
        this.isPlaying = !1
    },
    getLoop: function () {
        return this.hasPlaybackControl === !1 ? (console.warn("THREE.Audio: this Audio has no playback control."), !1) : this.source.loop
    },
    setLoop: function (a) {
        return this.hasPlaybackControl === !1 ? void console.warn("THREE.Audio: this Audio has no playback control.") : void(this.source.loop = a)
    },
    getVolume: function () {
        return this.gain.gain.value
    },
    setVolume: function (a) {
        return this.gain.gain.value = a, this
    }
}),THREE.AudioAnalyser = function (a, b) {
    this.analyser = a.context.createAnalyser(), this.analyser.fftSize = void 0 !== b ? b : 2048, this.data = new Uint8Array(this.analyser.frequencyBinCount), a.getOutput().connect(this.analyser)
},Object.assign(THREE.AudioAnalyser.prototype, {
    getFrequencyData: function () {
        return this.analyser.getByteFrequencyData(this.data), this.data
    }, getAverageFrequency: function () {
        for (var a = 0, b = this.getFrequencyData(), c = 0; c < b.length; c++)a += b[c];
        return a / b.length
    }
}),Object.defineProperty(THREE, "AudioContext", {
    get: function () {
        var a;
        return function () {
            return void 0 === a && (a = new (window.AudioContext || window.webkitAudioContext)), a
        }
    }()
}),THREE.PositionalAudio = function (a) {
    THREE.Audio.call(this, a), this.panner = this.context.createPanner(), this.panner.connect(this.gain)
},THREE.PositionalAudio.prototype = Object.assign(Object.create(THREE.Audio.prototype), {
    constructor: THREE.PositionalAudio,
    getOutput: function () {
        return this.panner
    },
    getRefDistance: function () {
        return this.panner.refDistance
    },
    setRefDistance: function (a) {
        this.panner.refDistance = a
    },
    getRolloffFactor: function () {
        return this.panner.rolloffFactor
    },
    setRolloffFactor: function (a) {
        this.panner.rolloffFactor = a
    },
    getDistanceModel: function () {
        return this.panner.distanceModel
    },
    setDistanceModel: function (a) {
        this.panner.distanceModel = a
    },
    getMaxDistance: function () {
        return this.panner.maxDistance
    },
    setMaxDistance: function (a) {
        this.panner.maxDistance = a
    },
    updateMatrixWorld: function () {
        var a = new THREE.Vector3;
        return function (b) {
            THREE.Object3D.prototype.updateMatrixWorld.call(this, b), a.setFromMatrixPosition(this.matrixWorld), this.panner.setPosition(a.x, a.y, a.z)
        }
    }()
}),THREE.AudioListener = function () {
    THREE.Object3D.call(this), this.type = "AudioListener", this.context = THREE.AudioContext, this.gain = this.context.createGain(), this.gain.connect(this.context.destination), this.filter = null
},THREE.AudioListener.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.AudioListener,
    getInput: function () {
        return this.gain
    },
    removeFilter: function () {
        null !== this.filter && (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination), this.gain.connect(this.context.destination), this.filter = null)
    },
    getFilter: function () {
        return this.filter
    },
    setFilter: function (a) {
        null !== this.filter ? (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination)) : this.gain.disconnect(this.context.destination), this.filter = a, this.gain.connect(this.filter), this.filter.connect(this.context.destination)
    },
    getMasterVolume: function () {
        return this.gain.gain.value
    },
    setMasterVolume: function (a) {
        this.gain.gain.value = a
    },
    updateMatrixWorld: function () {
        var a = new THREE.Vector3, b = new THREE.Quaternion, c = new THREE.Vector3, d = new THREE.Vector3;
        return function (e) {
            THREE.Object3D.prototype.updateMatrixWorld.call(this, e);
            var f = this.context.listener, g = this.up;
            this.matrixWorld.decompose(a, b, c), d.set(0, 0, -1).applyQuaternion(b), f.setPosition(a.x, a.y, a.z), f.setOrientation(d.x, d.y, d.z, g.x, g.y, g.z)
        }
    }()
}),THREE.Camera = function () {
    THREE.Object3D.call(this), this.type = "Camera", this.matrixWorldInverse = new THREE.Matrix4, this.projectionMatrix = new THREE.Matrix4
},THREE.Camera.prototype = Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.constructor = THREE.Camera,THREE.Camera.prototype.getWorldDirection = function () {
    var a = new THREE.Quaternion;
    return function (b) {
        var c = b || new THREE.Vector3;
        return this.getWorldQuaternion(a), c.set(0, 0, -1).applyQuaternion(a)
    }
}(),THREE.Camera.prototype.lookAt = function () {
    var a = new THREE.Matrix4;
    return function (b) {
        a.lookAt(this.position, b, this.up), this.quaternion.setFromRotationMatrix(a)
    }
}(),THREE.Camera.prototype.clone = function () {
    return (new this.constructor).copy(this)
},THREE.Camera.prototype.copy = function (a) {
    return THREE.Object3D.prototype.copy.call(this, a), this.matrixWorldInverse.copy(a.matrixWorldInverse), this.projectionMatrix.copy(a.projectionMatrix), this
},THREE.CubeCamera = function (a, b, c) {
    THREE.Object3D.call(this), this.type = "CubeCamera";
    var d = 90, e = 1, f = new THREE.PerspectiveCamera(d, e, a, b);
    f.up.set(0, -1, 0), f.lookAt(new THREE.Vector3(1, 0, 0)), this.add(f);
    var g = new THREE.PerspectiveCamera(d, e, a, b);
    g.up.set(0, -1, 0), g.lookAt(new THREE.Vector3(-1, 0, 0)), this.add(g);
    var h = new THREE.PerspectiveCamera(d, e, a, b);
    h.up.set(0, 0, 1), h.lookAt(new THREE.Vector3(0, 1, 0)), this.add(h);
    var i = new THREE.PerspectiveCamera(d, e, a, b);
    i.up.set(0, 0, -1), i.lookAt(new THREE.Vector3(0, -1, 0)), this.add(i);
    var j = new THREE.PerspectiveCamera(d, e, a, b);
    j.up.set(0, -1, 0), j.lookAt(new THREE.Vector3(0, 0, 1)), this.add(j);
    var k = new THREE.PerspectiveCamera(d, e, a, b);
    k.up.set(0, -1, 0), k.lookAt(new THREE.Vector3(0, 0, -1)), this.add(k);
    var l = {format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter};
    this.renderTarget = new THREE.WebGLRenderTargetCube(c, c, l), this.updateCubeMap = function (a, b) {
        null === this.parent && this.updateMatrixWorld();
        var c = this.renderTarget, d = c.texture.generateMipmaps;
        c.texture.generateMipmaps = !1, c.activeCubeFace = 0, a.render(b, f, c), c.activeCubeFace = 1, a.render(b, g, c), c.activeCubeFace = 2, a.render(b, h, c), c.activeCubeFace = 3, a.render(b, i, c), c.activeCubeFace = 4, a.render(b, j, c), c.texture.generateMipmaps = d, c.activeCubeFace = 5, a.render(b, k, c), a.setRenderTarget(null)
    }
},THREE.CubeCamera.prototype = Object.create(THREE.Object3D.prototype),THREE.CubeCamera.prototype.constructor = THREE.CubeCamera,THREE.OrthographicCamera = function (a, b, c, d, e, f) {
    THREE.Camera.call(this), this.type = "OrthographicCamera", this.zoom = 1, this.view = null, this.left = a, this.right = b, this.top = c, this.bottom = d, this.near = void 0 !== e ? e : .1, this.far = void 0 !== f ? f : 2e3, this.updateProjectionMatrix()
},THREE.OrthographicCamera.prototype = Object.assign(Object.create(THREE.Camera.prototype), {
    constructor: THREE.OrthographicCamera,
    copy: function (a) {
        return THREE.Camera.prototype.copy.call(this, a), this.left = a.left, this.right = a.right, this.top = a.top, this.bottom = a.bottom, this.near = a.near, this.far = a.far, this.zoom = a.zoom, this.view = null === a.view ? null : Object.assign({}, a.view), this
    },
    setViewOffset: function (a, b, c, d, e, f) {
        this.view = {
            fullWidth: a,
            fullHeight: b,
            offsetX: c,
            offsetY: d,
            width: e,
            height: f
        }, this.updateProjectionMatrix()
    },
    clearViewOffset: function () {
        this.view = null, this.updateProjectionMatrix()
    },
    updateProjectionMatrix: function () {
        var a = (this.right - this.left) / (2 * this.zoom), b = (this.top - this.bottom) / (2 * this.zoom), c = (this.right + this.left) / 2, d = (this.top + this.bottom) / 2, e = c - a, f = c + a, g = d + b, h = d - b;
        if (null !== this.view) {
            var i = this.zoom / (this.view.width / this.view.fullWidth), j = this.zoom / (this.view.height / this.view.fullHeight), k = (this.right - this.left) / this.view.width, l = (this.top - this.bottom) / this.view.height;
            e += k * (this.view.offsetX / i), f = e + k * (this.view.width / i), g -= l * (this.view.offsetY / j), h = g - l * (this.view.height / j)
        }
        this.projectionMatrix.makeOrthographic(e, f, g, h, this.near, this.far)
    },
    toJSON: function (a) {
        var b = THREE.Object3D.prototype.toJSON.call(this, a);
        return b.object.zoom = this.zoom, b.object.left = this.left, b.object.right = this.right, b.object.top = this.top, b.object.bottom = this.bottom, b.object.near = this.near, b.object.far = this.far, null !== this.view && (b.object.view = Object.assign({}, this.view)), b
    }
}),THREE.PerspectiveCamera = function (a, b, c, d) {
    THREE.Camera.call(this), this.type = "PerspectiveCamera", this.fov = void 0 !== a ? a : 50, this.zoom = 1, this.near = void 0 !== c ? c : .1, this.far = void 0 !== d ? d : 2e3, this.focus = 10, this.aspect = void 0 !== b ? b : 1, this.view = null, this.filmGauge = 35, this.filmOffset = 0, this.updateProjectionMatrix()
},THREE.PerspectiveCamera.prototype = Object.assign(Object.create(THREE.Camera.prototype), {
    constructor: THREE.PerspectiveCamera,
    copy: function (a) {
        return THREE.Camera.prototype.copy.call(this, a), this.fov = a.fov, this.zoom = a.zoom, this.near = a.near, this.far = a.far, this.focus = a.focus, this.aspect = a.aspect, this.view = null === a.view ? null : Object.assign({}, a.view), this.filmGauge = a.filmGauge, this.filmOffset = a.filmOffset, this
    },
    setFocalLength: function (a) {
        var b = .5 * this.getFilmHeight() / a;
        this.fov = 2 * THREE.Math.RAD2DEG * Math.atan(b), this.updateProjectionMatrix()
    },
    getFocalLength: function () {
        var a = Math.tan(.5 * THREE.Math.DEG2RAD * this.fov);
        return .5 * this.getFilmHeight() / a
    },
    getEffectiveFOV: function () {
        return 2 * THREE.Math.RAD2DEG * Math.atan(Math.tan(.5 * THREE.Math.DEG2RAD * this.fov) / this.zoom)
    },
    getFilmWidth: function () {
        return this.filmGauge * Math.min(this.aspect, 1)
    },
    getFilmHeight: function () {
        return this.filmGauge / Math.max(this.aspect, 1)
    },
    setViewOffset: function (a, b, c, d, e, f) {
        this.aspect = a / b, this.view = {
            fullWidth: a,
            fullHeight: b,
            offsetX: c,
            offsetY: d,
            width: e,
            height: f
        }, this.updateProjectionMatrix()
    },
    clearViewOffset: function () {
        this.view = null, this.updateProjectionMatrix()
    },
    updateProjectionMatrix: function () {
        var a = this.near, b = a * Math.tan(.5 * THREE.Math.DEG2RAD * this.fov) / this.zoom, c = 2 * b, d = this.aspect * c, e = -.5 * d, f = this.view;
        if (null !== f) {
            var g = f.fullWidth, h = f.fullHeight;
            e += f.offsetX * d / g, b -= f.offsetY * c / h, d *= f.width / g, c *= f.height / h
        }
        var i = this.filmOffset;
        0 !== i && (e += a * i / this.getFilmWidth()), this.projectionMatrix.makeFrustum(e, e + d, b - c, b, a, this.far)
    },
    toJSON: function (a) {
        var b = THREE.Object3D.prototype.toJSON.call(this, a);
        return b.object.fov = this.fov, b.object.zoom = this.zoom, b.object.near = this.near, b.object.far = this.far, b.object.focus = this.focus, b.object.aspect = this.aspect, null !== this.view && (b.object.view = Object.assign({}, this.view)), b.object.filmGauge = this.filmGauge, b.object.filmOffset = this.filmOffset, b
    }
}),THREE.StereoCamera = function () {
    this.type = "StereoCamera", this.aspect = 1, this.cameraL = new THREE.PerspectiveCamera, this.cameraL.layers.enable(1), this.cameraL.matrixAutoUpdate = !1, this.cameraR = new THREE.PerspectiveCamera, this.cameraR.layers.enable(2), this.cameraR.matrixAutoUpdate = !1
},Object.assign(THREE.StereoCamera.prototype, {
    update: function () {
        var a, b, c, d, e, f = new THREE.Matrix4, g = new THREE.Matrix4;
        return function (h) {
            var i = a !== h.focus || b !== h.fov || c !== h.aspect * this.aspect || d !== h.near || e !== h.far;
            if (i) {
                a = h.focus, b = h.fov, c = h.aspect * this.aspect, d = h.near, e = h.far;
                var j, k, l = h.projectionMatrix.clone(), m = .032, n = m * d / a, o = d * Math.tan(THREE.Math.DEG2RAD * b * .5);
                g.elements[12] = -m, f.elements[12] = m, j = -o * c + n, k = o * c + n, l.elements[0] = 2 * d / (k - j), l.elements[8] = (k + j) / (k - j), this.cameraL.projectionMatrix.copy(l), j = -o * c - n, k = o * c - n, l.elements[0] = 2 * d / (k - j), l.elements[8] = (k + j) / (k - j), this.cameraR.projectionMatrix.copy(l)
            }
            this.cameraL.matrixWorld.copy(h.matrixWorld).multiply(g), this.cameraR.matrixWorld.copy(h.matrixWorld).multiply(f)
        }
    }()
}),THREE.Light = function (a, b) {
    THREE.Object3D.call(this), this.type = "Light", this.color = new THREE.Color(a), this.intensity = void 0 !== b ? b : 1, this.receiveShadow = void 0
},THREE.Light.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Light,
    copy: function (a) {
        return THREE.Object3D.prototype.copy.call(this, a), this.color.copy(a.color), this.intensity = a.intensity, this
    },
    toJSON: function (a) {
        var b = THREE.Object3D.prototype.toJSON.call(this, a);
        return b.object.color = this.color.getHex(), b.object.intensity = this.intensity, void 0 !== this.groundColor && (b.object.groundColor = this.groundColor.getHex()), void 0 !== this.distance && (b.object.distance = this.distance), void 0 !== this.angle && (b.object.angle = this.angle), void 0 !== this.decay && (b.object.decay = this.decay), void 0 !== this.penumbra && (b.object.penumbra = this.penumbra), b
    }
}),THREE.LightShadow = function (a) {
    this.camera = a, this.bias = 0, this.radius = 1, this.mapSize = new THREE.Vector2(512, 512), this.map = null, this.matrix = new THREE.Matrix4
},Object.assign(THREE.LightShadow.prototype, {
    copy: function (a) {
        return this.camera = a.camera.clone(), this.bias = a.bias, this.radius = a.radius, this.mapSize.copy(a.mapSize), this
    }, clone: function () {
        return (new this.constructor).copy(this)
    }
}),THREE.AmbientLight = function (a, b) {
    THREE.Light.call(this, a, b), this.type = "AmbientLight", this.castShadow = void 0
},THREE.AmbientLight.prototype = Object.assign(Object.create(THREE.Light.prototype), {constructor: THREE.AmbientLight}),THREE.DirectionalLight = function (a, b) {
    THREE.Light.call(this, a, b), this.type = "DirectionalLight", this.position.set(0, 1, 0), this.updateMatrix(), this.target = new THREE.Object3D, this.shadow = new THREE.DirectionalLightShadow
},THREE.DirectionalLight.prototype = Object.assign(Object.create(THREE.Light.prototype), {
    constructor: THREE.DirectionalLight,
    copy: function (a) {
        return THREE.Light.prototype.copy.call(this, a), this.target = a.target.clone(), this.shadow = a.shadow.clone(), this
    }
}),THREE.DirectionalLightShadow = function (a) {
    THREE.LightShadow.call(this, new THREE.OrthographicCamera(-5, 5, 5, -5, .5, 500))
},THREE.DirectionalLightShadow.prototype = Object.assign(Object.create(THREE.LightShadow.prototype), {constructor: THREE.DirectionalLightShadow}),THREE.HemisphereLight = function (a, b, c) {
    THREE.Light.call(this, a, c), this.type = "HemisphereLight", this.castShadow = void 0, this.position.set(0, 1, 0), this.updateMatrix(), this.groundColor = new THREE.Color(b)
},THREE.HemisphereLight.prototype = Object.assign(Object.create(THREE.Light.prototype), {
    constructor: THREE.HemisphereLight,
    copy: function (a) {
        return THREE.Light.prototype.copy.call(this, a), this.groundColor.copy(a.groundColor), this
    }
}),THREE.PointLight = function (a, b, c, d) {
    THREE.Light.call(this, a, b), this.type = "PointLight", Object.defineProperty(this, "power", {
        get: function () {
            return 4 * this.intensity * Math.PI
        }, set: function (a) {
            this.intensity = a / (4 * Math.PI)
        }
    }), this.distance = void 0 !== c ? c : 0, this.decay = void 0 !== d ? d : 1, this.shadow = new THREE.LightShadow(new THREE.PerspectiveCamera(90, 1, .5, 500))
},THREE.PointLight.prototype = Object.assign(Object.create(THREE.Light.prototype), {
    constructor: THREE.PointLight,
    copy: function (a) {
        return THREE.Light.prototype.copy.call(this, a), this.distance = a.distance, this.decay = a.decay, this.shadow = a.shadow.clone(), this
    }
}),THREE.SpotLight = function (a, b, c, d, e, f) {
    THREE.Light.call(this, a, b), this.type = "SpotLight", this.position.set(0, 1, 0), this.updateMatrix(), this.target = new THREE.Object3D, Object.defineProperty(this, "power", {
        get: function () {
            return this.intensity * Math.PI
        }, set: function (a) {
            this.intensity = a / Math.PI
        }
    }), this.distance = void 0 !== c ? c : 0, this.angle = void 0 !== d ? d : Math.PI / 3, this.penumbra = void 0 !== e ? e : 0, this.decay = void 0 !== f ? f : 1, this.shadow = new THREE.SpotLightShadow
},THREE.SpotLight.prototype = Object.assign(Object.create(THREE.Light.prototype), {
    constructor: THREE.SpotLight,
    copy: function (a) {
        return THREE.Light.prototype.copy.call(this, a), this.distance = a.distance, this.angle = a.angle, this.penumbra = a.penumbra, this.decay = a.decay, this.target = a.target.clone(), this.shadow = a.shadow.clone(), this
    }
}),THREE.SpotLightShadow = function () {
    THREE.LightShadow.call(this, new THREE.PerspectiveCamera(50, 1, .5, 500))
},THREE.SpotLightShadow.prototype = Object.assign(Object.create(THREE.LightShadow.prototype), {
    constructor: THREE.SpotLightShadow,
    update: function (a) {
        var b = 2 * THREE.Math.RAD2DEG * a.angle, c = this.mapSize.width / this.mapSize.height, d = a.distance || 500, e = this.camera;
        (b !== e.fov || c !== e.aspect || d !== e.far) && (e.fov = b, e.aspect = c, e.far = d, e.updateProjectionMatrix())
    }
}),THREE.AudioLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.AudioLoader.prototype, {
    load: function (a, b, c, d) {
        var e = new THREE.XHRLoader(this.manager);
        e.setResponseType("arraybuffer"), e.load(a, function (a) {
            var c = THREE.AudioContext;
            c.decodeAudioData(a, function (a) {
                b(a)
            })
        }, c, d)
    }
}),THREE.Cache = {
    enabled: !1, files: {}, add: function (a, b) {
        this.enabled !== !1 && (this.files[a] = b)
    }, get: function (a) {
        return this.enabled !== !1 ? this.files[a] : void 0
    }, remove: function (a) {
        delete this.files[a]
    }, clear: function () {
        this.files = {}
    }
},THREE.Loader = function () {
    this.onLoadStart = function () {
    }, this.onLoadProgress = function () {
    }, this.onLoadComplete = function () {
    }
},THREE.Loader.prototype = {
    constructor: THREE.Loader, crossOrigin: void 0, extractUrlBase: function (a) {
        var b = a.split("/");
        return 1 === b.length ? "./" : (b.pop(), b.join("/") + "/")
    }, initMaterials: function (a, b, c) {
        for (var d = [], e = 0; e < a.length; ++e)d[e] = this.createMaterial(a[e], b, c);
        return d
    }, createMaterial: function () {
        var a, b, c;
        return function (d, e, f) {
            function g(a, c, d, g, i) {
                var j, k = e + a, l = THREE.Loader.Handlers.get(k);
                null !== l ? j = l.load(k) : (b.setCrossOrigin(f), j = b.load(k)), void 0 !== c && (j.repeat.fromArray(c), 1 !== c[0] && (j.wrapS = THREE.RepeatWrapping), 1 !== c[1] && (j.wrapT = THREE.RepeatWrapping)), void 0 !== d && j.offset.fromArray(d), void 0 !== g && ("repeat" === g[0] && (j.wrapS = THREE.RepeatWrapping), "mirror" === g[0] && (j.wrapS = THREE.MirroredRepeatWrapping), "repeat" === g[1] && (j.wrapT = THREE.RepeatWrapping), "mirror" === g[1] && (j.wrapT = THREE.MirroredRepeatWrapping)), void 0 !== i && (j.anisotropy = i);
                var m = THREE.Math.generateUUID();
                return h[m] = j, m
            }

            void 0 === a && (a = new THREE.Color), void 0 === b && (b = new THREE.TextureLoader), void 0 === c && (c = new THREE.MaterialLoader);
            var h = {}, i = {uuid: THREE.Math.generateUUID(), type: "MeshLambertMaterial"};
            for (var j in d) {
                var k = d[j];
                switch (j) {
                    case"DbgColor":
                    case"DbgIndex":
                    case"opticalDensity":
                    case"illumination":
                        break;
                    case"DbgName":
                        i.name = k;
                        break;
                    case"blending":
                        i.blending = THREE[k];
                        break;
                    case"colorAmbient":
                    case"mapAmbient":
                        console.warn("THREE.Loader.createMaterial:", j, "is no longer supported.");
                        break;
                    case"colorDiffuse":
                        i.color = a.fromArray(k).getHex();
                        break;
                    case"colorSpecular":
                        i.specular = a.fromArray(k).getHex();
                        break;
                    case"colorEmissive":
                        i.emissive = a.fromArray(k).getHex();
                        break;
                    case"specularCoef":
                        i.shininess = k;
                        break;
                    case"shading":
                        "basic" === k.toLowerCase() && (i.type = "MeshBasicMaterial"), "phong" === k.toLowerCase() && (i.type = "MeshPhongMaterial"), "standard" === k.toLowerCase() && (i.type = "MeshStandardMaterial");
                        break;
                    case"mapDiffuse":
                        i.map = g(k, d.mapDiffuseRepeat, d.mapDiffuseOffset, d.mapDiffuseWrap, d.mapDiffuseAnisotropy);
                        break;
                    case"mapDiffuseRepeat":
                    case"mapDiffuseOffset":
                    case"mapDiffuseWrap":
                    case"mapDiffuseAnisotropy":
                        break;
                    case"mapEmissive":
                        i.emissiveMap = g(k, d.mapEmissiveRepeat, d.mapEmissiveOffset, d.mapEmissiveWrap, d.mapEmissiveAnisotropy);
                        break;
                    case"mapEmissiveRepeat":
                    case"mapEmissiveOffset":
                    case"mapEmissiveWrap":
                    case"mapEmissiveAnisotropy":
                        break;
                    case"mapLight":
                        i.lightMap = g(k, d.mapLightRepeat, d.mapLightOffset, d.mapLightWrap, d.mapLightAnisotropy);
                        break;
                    case"mapLightRepeat":
                    case"mapLightOffset":
                    case"mapLightWrap":
                    case"mapLightAnisotropy":
                        break;
                    case"mapAO":
                        i.aoMap = g(k, d.mapAORepeat, d.mapAOOffset, d.mapAOWrap, d.mapAOAnisotropy);
                        break;
                    case"mapAORepeat":
                    case"mapAOOffset":
                    case"mapAOWrap":
                    case"mapAOAnisotropy":
                        break;
                    case"mapBump":
                        i.bumpMap = g(k, d.mapBumpRepeat, d.mapBumpOffset, d.mapBumpWrap, d.mapBumpAnisotropy);
                        break;
                    case"mapBumpScale":
                        i.bumpScale = k;
                        break;
                    case"mapBumpRepeat":
                    case"mapBumpOffset":
                    case"mapBumpWrap":
                    case"mapBumpAnisotropy":
                        break;
                    case"mapNormal":
                        i.normalMap = g(k, d.mapNormalRepeat, d.mapNormalOffset, d.mapNormalWrap, d.mapNormalAnisotropy);
                        break;
                    case"mapNormalFactor":
                        i.normalScale = [k, k];
                        break;
                    case"mapNormalRepeat":
                    case"mapNormalOffset":
                    case"mapNormalWrap":
                    case"mapNormalAnisotropy":
                        break;
                    case"mapSpecular":
                        i.specularMap = g(k, d.mapSpecularRepeat, d.mapSpecularOffset, d.mapSpecularWrap, d.mapSpecularAnisotropy);
                        break;
                    case"mapSpecularRepeat":
                    case"mapSpecularOffset":
                    case"mapSpecularWrap":
                    case"mapSpecularAnisotropy":
                        break;
                    case"mapMetalness":
                        i.metalnessMap = g(k, d.mapMetalnessRepeat, d.mapMetalnessOffset, d.mapMetalnessWrap, d.mapMetalnessAnisotropy);
                        break;
                    case"mapMetalnessRepeat":
                    case"mapMetalnessOffset":
                    case"mapMetalnessWrap":
                    case"mapMetalnessAnisotropy":
                        break;
                    case"mapRoughness":
                        i.roughnessMap = g(k, d.mapRoughnessRepeat, d.mapRoughnessOffset, d.mapRoughnessWrap, d.mapRoughnessAnisotropy);
                        break;
                    case"mapRoughnessRepeat":
                    case"mapRoughnessOffset":
                    case"mapRoughnessWrap":
                    case"mapRoughnessAnisotropy":
                        break;
                    case"mapAlpha":
                        i.alphaMap = g(k, d.mapAlphaRepeat, d.mapAlphaOffset, d.mapAlphaWrap, d.mapAlphaAnisotropy);
                        break;
                    case"mapAlphaRepeat":
                    case"mapAlphaOffset":
                    case"mapAlphaWrap":
                    case"mapAlphaAnisotropy":
                        break;
                    case"flipSided":
                        i.side = THREE.BackSide;
                        break;
                    case"doubleSided":
                        i.side = THREE.DoubleSide;
                        break;
                    case"transparency":
                        console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"), i.opacity = k;
                        break;
                    case"depthTest":
                    case"depthWrite":
                    case"colorWrite":
                    case"opacity":
                    case"reflectivity":
                    case"transparent":
                    case"visible":
                    case"wireframe":
                        i[j] = k;
                        break;
                    case"vertexColors":
                        k === !0 && (i.vertexColors = THREE.VertexColors), "face" === k && (i.vertexColors = THREE.FaceColors);
                        break;
                    default:
                        console.error("THREE.Loader.createMaterial: Unsupported", j, k)
                }
            }
            return "MeshBasicMaterial" === i.type && delete i.emissive, "MeshPhongMaterial" !== i.type && delete i.specular, i.opacity < 1 && (i.transparent = !0), c.setTextures(h), c.parse(i)
        }
    }()
},THREE.Loader.Handlers = {
    handlers: [], add: function (a, b) {
        this.handlers.push(a, b)
    }, get: function (a) {
        for (var b = this.handlers, c = 0, d = b.length; d > c; c += 2) {
            var e = b[c], f = b[c + 1];
            if (e.test(a))return f
        }
        return null
    }
},THREE.XHRLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.XHRLoader.prototype, {
    load: function (a, b, c, d) {
        void 0 !== this.path && (a = this.path + a);
        var e = this, f = THREE.Cache.get(a);
        if (void 0 !== f)return b && setTimeout(function () {
            b(f)
        }, 0), f;
        var g = new XMLHttpRequest;
        return g.overrideMimeType("text/plain"), g.open("GET", a, !0), g.addEventListener("load", function (c) {
            var f = c.target.response;
            THREE.Cache.add(a, f), 200 === this.status ? (b && b(f), e.manager.itemEnd(a)) : 0 === this.status ? (console.warn("THREE.XHRLoader: HTTP Status 0 received."), b && b(f), e.manager.itemEnd(a)) : (d && d(c), e.manager.itemError(a))
        }, !1), void 0 !== c && g.addEventListener("progress", function (a) {
            c(a)
        }, !1), g.addEventListener("error", function (b) {
            d && d(b), e.manager.itemError(a)
        }, !1), void 0 !== this.responseType && (g.responseType = this.responseType), void 0 !== this.withCredentials && (g.withCredentials = this.withCredentials), g.send(null), e.manager.itemStart(a), g
    }, setPath: function (a) {
        return this.path = a, this
    }, setResponseType: function (a) {
        return this.responseType = a, this
    }, setWithCredentials: function (a) {
        return this.withCredentials = a, this
    }
}),THREE.FontLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.FontLoader.prototype, {
    load: function (a, b, c, d) {
        var e = this, f = new THREE.XHRLoader(this.manager);
        f.load(a, function (a) {
            var c;
            try {
                c = JSON.parse(a)
            } catch (d) {
                console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."), c = JSON.parse(a.substring(65, a.length - 2))
            }
            var f = e.parse(c);
            b && b(f)
        }, c, d)
    }, parse: function (a) {
        return new THREE.Font(a)
    }
}),THREE.ImageLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.ImageLoader.prototype, {
    load: function (a, b, c, d) {
        var e = document.createElementNS("http://www.w3.org/1999/xhtml", "img");
        if (e.onload = function () {
                URL.revokeObjectURL(e.src), b && b(e)
            }, 0 === a.indexOf("data:"))e.src = a; else {
            var f = new THREE.XHRLoader(this.manager);
            f.setPath(this.path), f.setResponseType("blob"), f.load(a, function (a) {
                e.src = URL.createObjectURL(a)
            }, c, d)
        }
        return e
    }, setCrossOrigin: function (a) {
        return this.crossOrigin = a, this
    }, setPath: function (a) {
        return this.path = a, this
    }
}),THREE.JSONLoader = function (a) {
    "boolean" == typeof a && (console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."), a = void 0), this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager, this.withCredentials = !1
},Object.assign(THREE.JSONLoader.prototype, {
    load: function (a, b, c, d) {
        var e = this, f = this.texturePath && "string" == typeof this.texturePath ? this.texturePath : THREE.Loader.prototype.extractUrlBase(a), g = new THREE.XHRLoader(this.manager);
        g.setWithCredentials(this.withCredentials), g.load(a, function (c) {
            var d = JSON.parse(c), g = d.metadata;
            if (void 0 !== g) {
                var h = g.type;
                if (void 0 !== h) {
                    if ("object" === h.toLowerCase())return void console.error("THREE.JSONLoader: " + a + " should be loaded with THREE.ObjectLoader instead.");
                    if ("scene" === h.toLowerCase())return void console.error("THREE.JSONLoader: " + a + " should be loaded with THREE.SceneLoader instead.")
                }
            }
            var i = e.parse(d, f);
            b(i.geometry, i.materials)
        }, c, d)
    }, setTexturePath: function (a) {
        this.texturePath = a
    }, parse: function (a, b) {
        function c(b) {
            function c(a, b) {
                return a & 1 << b
            }

            var d, e, f, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F = a.faces, G = a.vertices, H = a.normals, I = a.colors, J = 0;
            if (void 0 !== a.uvs) {
                for (d = 0; d < a.uvs.length; d++)a.uvs[d].length && J++;
                for (d = 0; J > d; d++)g.faceVertexUvs[d] = []
            }
            for (h = 0, i = G.length; i > h;)v = new THREE.Vector3, v.x = G[h++] * b, v.y = G[h++] * b, v.z = G[h++] * b, g.vertices.push(v);
            for (h = 0, i = F.length; i > h;)if (n = F[h++], o = c(n, 0), p = c(n, 1), q = c(n, 3), r = c(n, 4), s = c(n, 5), t = c(n, 6), u = c(n, 7), o) {
                if (x = new THREE.Face3, x.a = F[h], x.b = F[h + 1], x.c = F[h + 3], y = new THREE.Face3, y.a = F[h + 1], y.b = F[h + 2], y.c = F[h + 3], h += 4, p && (m = F[h++], x.materialIndex = m, y.materialIndex = m), f = g.faces.length, q)for (d = 0; J > d; d++)for (B = a.uvs[d], g.faceVertexUvs[d][f] = [], g.faceVertexUvs[d][f + 1] = [], e = 0; 4 > e; e++)l = F[h++], D = B[2 * l], E = B[2 * l + 1], C = new THREE.Vector2(D, E), 2 !== e && g.faceVertexUvs[d][f].push(C), 0 !== e && g.faceVertexUvs[d][f + 1].push(C);
                if (r && (k = 3 * F[h++], x.normal.set(H[k++], H[k++], H[k]), y.normal.copy(x.normal)), s)for (d = 0; 4 > d; d++)k = 3 * F[h++], A = new THREE.Vector3(H[k++], H[k++], H[k]), 2 !== d && x.vertexNormals.push(A), 0 !== d && y.vertexNormals.push(A);
                if (t && (j = F[h++], z = I[j], x.color.setHex(z), y.color.setHex(z)), u)for (d = 0; 4 > d; d++)j = F[h++], z = I[j], 2 !== d && x.vertexColors.push(new THREE.Color(z)), 0 !== d && y.vertexColors.push(new THREE.Color(z));
                g.faces.push(x), g.faces.push(y)
            } else {
                if (w = new THREE.Face3, w.a = F[h++], w.b = F[h++], w.c = F[h++], p && (m = F[h++], w.materialIndex = m), f = g.faces.length, q)for (d = 0; J > d; d++)for (B = a.uvs[d], g.faceVertexUvs[d][f] = [], e = 0; 3 > e; e++)l = F[h++], D = B[2 * l], E = B[2 * l + 1], C = new THREE.Vector2(D, E), g.faceVertexUvs[d][f].push(C);
                if (r && (k = 3 * F[h++], w.normal.set(H[k++], H[k++], H[k])), s)for (d = 0; 3 > d; d++)k = 3 * F[h++], A = new THREE.Vector3(H[k++], H[k++], H[k]), w.vertexNormals.push(A);
                if (t && (j = F[h++], w.color.setHex(I[j])), u)for (d = 0; 3 > d; d++)j = F[h++], w.vertexColors.push(new THREE.Color(I[j]));
                g.faces.push(w)
            }
        }

        function d() {
            var b = void 0 !== a.influencesPerVertex ? a.influencesPerVertex : 2;
            if (a.skinWeights)for (var c = 0, d = a.skinWeights.length; d > c; c += b) {
                var e = a.skinWeights[c], f = b > 1 ? a.skinWeights[c + 1] : 0, h = b > 2 ? a.skinWeights[c + 2] : 0, i = b > 3 ? a.skinWeights[c + 3] : 0;
                g.skinWeights.push(new THREE.Vector4(e, f, h, i))
            }
            if (a.skinIndices)for (var c = 0, d = a.skinIndices.length; d > c; c += b) {
                var j = a.skinIndices[c], k = b > 1 ? a.skinIndices[c + 1] : 0, l = b > 2 ? a.skinIndices[c + 2] : 0, m = b > 3 ? a.skinIndices[c + 3] : 0;
                g.skinIndices.push(new THREE.Vector4(j, k, l, m))
            }
            g.bones = a.bones, g.bones && g.bones.length > 0 && (g.skinWeights.length !== g.skinIndices.length || g.skinIndices.length !== g.vertices.length) && console.warn("When skinning, number of vertices (" + g.vertices.length + "), skinIndices (" + g.skinIndices.length + "), and skinWeights (" + g.skinWeights.length + ") should match.")
        }

        function e(b) {
            if (void 0 !== a.morphTargets)for (var c = 0, d = a.morphTargets.length; d > c; c++) {
                g.morphTargets[c] = {}, g.morphTargets[c].name = a.morphTargets[c].name, g.morphTargets[c].vertices = [];
                for (var e = g.morphTargets[c].vertices, f = a.morphTargets[c].vertices, h = 0, i = f.length; i > h; h += 3) {
                    var j = new THREE.Vector3;
                    j.x = f[h] * b, j.y = f[h + 1] * b, j.z = f[h + 2] * b, e.push(j)
                }
            }
            if (void 0 !== a.morphColors && a.morphColors.length > 0) {
                console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');
                for (var k = g.faces, l = a.morphColors[0].colors, c = 0, d = k.length; d > c; c++)k[c].color.fromArray(l, 3 * c)
            }
        }

        function f() {
            var b = [], c = [];
            void 0 !== a.animation && c.push(a.animation), void 0 !== a.animations && (a.animations.length ? c = c.concat(a.animations) : c.push(a.animations));
            for (var d = 0; d < c.length; d++) {
                var e = THREE.AnimationClip.parseAnimation(c[d], g.bones);
                e && b.push(e)
            }
            if (g.morphTargets) {
                var f = THREE.AnimationClip.CreateClipsFromMorphTargetSequences(g.morphTargets, 10);
                b = b.concat(f)
            }
            b.length > 0 && (g.animations = b)
        }

        var g = new THREE.Geometry, h = void 0 !== a.scale ? 1 / a.scale : 1;
        if (c(h), d(), e(h), f(), g.computeFaceNormals(), g.computeBoundingSphere(), void 0 === a.materials || 0 === a.materials.length)return {geometry: g};
        var i = THREE.Loader.prototype.initMaterials(a.materials, b, this.crossOrigin);
        return {geometry: g, materials: i}
    }
}),THREE.LoadingManager = function (a, b, c) {
    var d = this, e = !1, f = 0, g = 0;
    this.onStart = void 0, this.onLoad = a, this.onProgress = b, this.onError = c, this.itemStart = function (a) {
        g++, e === !1 && void 0 !== d.onStart && d.onStart(a, f, g), e = !0
    }, this.itemEnd = function (a) {
        f++, void 0 !== d.onProgress && d.onProgress(a, f, g), f === g && (e = !1, void 0 !== d.onLoad && d.onLoad())
    }, this.itemError = function (a) {
        void 0 !== d.onError && d.onError(a)
    }
},THREE.DefaultLoadingManager = new THREE.LoadingManager,THREE.BufferGeometryLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.BufferGeometryLoader.prototype, {
    load: function (a, b, c, d) {
        var e = this, f = new THREE.XHRLoader(e.manager);
        f.load(a, function (a) {
            b(e.parse(JSON.parse(a)))
        }, c, d)
    }, parse: function (a) {
        var b = new THREE.BufferGeometry, c = a.data.index, d = {
            Int8Array: Int8Array,
            Uint8Array: Uint8Array,
            Uint8ClampedArray: Uint8ClampedArray,
            Int16Array: Int16Array,
            Uint16Array: Uint16Array,
            Int32Array: Int32Array,
            Uint32Array: Uint32Array,
            Float32Array: Float32Array,
            Float64Array: Float64Array
        };
        if (void 0 !== c) {
            var e = new d[c.type](c.array);
            b.setIndex(new THREE.BufferAttribute(e, 1))
        }
        var f = a.data.attributes;
        for (var g in f) {
            var h = f[g], e = new d[h.type](h.array);
            b.addAttribute(g, new THREE.BufferAttribute(e, h.itemSize, h.normalized))
        }
        var i = a.data.groups || a.data.drawcalls || a.data.offsets;
        if (void 0 !== i)for (var j = 0, k = i.length; j !== k; ++j) {
            var l = i[j];
            b.addGroup(l.start, l.count, l.materialIndex)
        }
        var m = a.data.boundingSphere;
        if (void 0 !== m) {
            var n = new THREE.Vector3;
            void 0 !== m.center && n.fromArray(m.center), b.boundingSphere = new THREE.Sphere(n, m.radius)
        }
        return b
    }
}),THREE.MaterialLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager, this.textures = {}
},Object.assign(THREE.MaterialLoader.prototype, {
    load: function (a, b, c, d) {
        var e = this, f = new THREE.XHRLoader(e.manager);
        f.load(a, function (a) {
            b(e.parse(JSON.parse(a)))
        }, c, d)
    }, setTextures: function (a) {
        this.textures = a
    }, getTexture: function (a) {
        var b = this.textures;
        return void 0 === b[a] && console.warn("THREE.MaterialLoader: Undefined texture", a), b[a]
    }, parse: function (a) {
        var b = new THREE[a.type];
        if (void 0 !== a.uuid && (b.uuid = a.uuid), void 0 !== a.name && (b.name = a.name), void 0 !== a.color && b.color.setHex(a.color), void 0 !== a.roughness && (b.roughness = a.roughness), void 0 !== a.metalness && (b.metalness = a.metalness), void 0 !== a.emissive && b.emissive.setHex(a.emissive), void 0 !== a.specular && b.specular.setHex(a.specular), void 0 !== a.shininess && (b.shininess = a.shininess), void 0 !== a.uniforms && (b.uniforms = a.uniforms), void 0 !== a.vertexShader && (b.vertexShader = a.vertexShader), void 0 !== a.fragmentShader && (b.fragmentShader = a.fragmentShader), void 0 !== a.vertexColors && (b.vertexColors = a.vertexColors), void 0 !== a.shading && (b.shading = a.shading), void 0 !== a.blending && (b.blending = a.blending), void 0 !== a.side && (b.side = a.side), void 0 !== a.opacity && (b.opacity = a.opacity), void 0 !== a.transparent && (b.transparent = a.transparent), void 0 !== a.alphaTest && (b.alphaTest = a.alphaTest), void 0 !== a.depthTest && (b.depthTest = a.depthTest), void 0 !== a.depthWrite && (b.depthWrite = a.depthWrite), void 0 !== a.colorWrite && (b.colorWrite = a.colorWrite), void 0 !== a.wireframe && (b.wireframe = a.wireframe), void 0 !== a.wireframeLinewidth && (b.wireframeLinewidth = a.wireframeLinewidth), void 0 !== a.size && (b.size = a.size), void 0 !== a.sizeAttenuation && (b.sizeAttenuation = a.sizeAttenuation), void 0 !== a.map && (b.map = this.getTexture(a.map)), void 0 !== a.alphaMap && (b.alphaMap = this.getTexture(a.alphaMap), b.transparent = !0), void 0 !== a.bumpMap && (b.bumpMap = this.getTexture(a.bumpMap)), void 0 !== a.bumpScale && (b.bumpScale = a.bumpScale), void 0 !== a.normalMap && (b.normalMap = this.getTexture(a.normalMap)), void 0 !== a.normalScale) {
            var c = a.normalScale;
            Array.isArray(c) === !1 && (c = [c, c]), b.normalScale = (new THREE.Vector2).fromArray(c)
        }
        if (void 0 !== a.displacementMap && (b.displacementMap = this.getTexture(a.displacementMap)), void 0 !== a.displacementScale && (b.displacementScale = a.displacementScale), void 0 !== a.displacementBias && (b.displacementBias = a.displacementBias), void 0 !== a.roughnessMap && (b.roughnessMap = this.getTexture(a.roughnessMap)), void 0 !== a.metalnessMap && (b.metalnessMap = this.getTexture(a.metalnessMap)), void 0 !== a.emissiveMap && (b.emissiveMap = this.getTexture(a.emissiveMap)), void 0 !== a.emissiveIntensity && (b.emissiveIntensity = a.emissiveIntensity), void 0 !== a.specularMap && (b.specularMap = this.getTexture(a.specularMap)), void 0 !== a.envMap && (b.envMap = this.getTexture(a.envMap), b.combine = THREE.MultiplyOperation), void 0 !== a.reflectivity && (b.reflectivity = a.reflectivity), void 0 !== a.lightMap && (b.lightMap = this.getTexture(a.lightMap)), void 0 !== a.lightMapIntensity && (b.lightMapIntensity = a.lightMapIntensity), void 0 !== a.aoMap && (b.aoMap = this.getTexture(a.aoMap)), void 0 !== a.aoMapIntensity && (b.aoMapIntensity = a.aoMapIntensity), void 0 !== a.materials)for (var d = 0, e = a.materials.length; e > d; d++)b.materials.push(this.parse(a.materials[d]));
        return b
    }
}),THREE.ObjectLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager, this.texturePath = ""
},Object.assign(THREE.ObjectLoader.prototype, {
    load: function (a, b, c, d) {
        "" === this.texturePath && (this.texturePath = a.substring(0, a.lastIndexOf("/") + 1));
        var e = this, f = new THREE.XHRLoader(e.manager);
        f.load(a, function (a) {
            e.parse(JSON.parse(a), b)
        }, c, d)
    }, setTexturePath: function (a) {
        this.texturePath = a
    }, setCrossOrigin: function (a) {
        this.crossOrigin = a
    }, parse: function (a, b) {
        var c = this.parseGeometries(a.geometries), d = this.parseImages(a.images, function () {
            void 0 !== b && b(g)
        }), e = this.parseTextures(a.textures, d), f = this.parseMaterials(a.materials, e), g = this.parseObject(a.object, c, f);
        return a.animations && (g.animations = this.parseAnimations(a.animations)), (void 0 === a.images || 0 === a.images.length) && void 0 !== b && b(g), g
    }, parseGeometries: function (a) {
        var b = {};
        if (void 0 !== a)for (var c = new THREE.JSONLoader, d = new THREE.BufferGeometryLoader, e = 0, f = a.length; f > e; e++) {
            var g, h = a[e];
            switch (h.type) {
                case"PlaneGeometry":
                case"PlaneBufferGeometry":
                    g = new THREE[h.type](h.width, h.height, h.widthSegments, h.heightSegments);
                    break;
                case"BoxGeometry":
                case"BoxBufferGeometry":
                case"CubeGeometry":
                    g = new THREE[h.type](h.width, h.height, h.depth, h.widthSegments, h.heightSegments, h.depthSegments);
                    break;
                case"CircleGeometry":
                case"CircleBufferGeometry":
                    g = new THREE[h.type](h.radius, h.segments, h.thetaStart, h.thetaLength);
                    break;
                case"CylinderGeometry":
                case"CylinderBufferGeometry":
                    g = new THREE[h.type](h.radiusTop, h.radiusBottom, h.height, h.radialSegments, h.heightSegments, h.openEnded, h.thetaStart, h.thetaLength);
                    break;
                case"ConeGeometry":
                case"ConeBufferGeometry":
                    g = new THREE[h.type](h.radius, h.height, h.radialSegments, h.heightSegments, h.openEnded, h.thetaStart, h.thetaLength);
                    break;
                case"SphereGeometry":
                case"SphereBufferGeometry":
                    g = new THREE[h.type](h.radius, h.widthSegments, h.heightSegments, h.phiStart, h.phiLength, h.thetaStart, h.thetaLength);
                    break;
                case"DodecahedronGeometry":
                case"IcosahedronGeometry":
                case"OctahedronGeometry":
                case"TetrahedronGeometry":
                    g = new THREE[h.type](h.radius, h.detail);
                    break;
                case"RingGeometry":
                case"RingBufferGeometry":
                    g = new THREE[h.type](h.innerRadius, h.outerRadius, h.thetaSegments, h.phiSegments, h.thetaStart, h.thetaLength);
                    break;
                case"TorusGeometry":
                case"TorusBufferGeometry":
                    g = new THREE[h.type](h.radius, h.tube, h.radialSegments, h.tubularSegments, h.arc);
                    break;
                case"TorusKnotGeometry":
                case"TorusKnotBufferGeometry":
                    g = new THREE[h.type](h.radius, h.tube, h.tubularSegments, h.radialSegments, h.p, h.q);
                    break;
                case"LatheGeometry":
                case"LatheBufferGeometry":
                    g = new THREE[h.type](h.points, h.segments, h.phiStart, h.phiLength);
                    break;
                case"BufferGeometry":
                    g = d.parse(h);
                    break;
                case"Geometry":
                    g = c.parse(h.data, this.texturePath).geometry;
                    break;
                default:
                    console.warn('THREE.ObjectLoader: Unsupported geometry type "' + h.type + '"');
                    continue
            }
            g.uuid = h.uuid, void 0 !== h.name && (g.name = h.name), b[h.uuid] = g
        }
        return b
    }, parseMaterials: function (a, b) {
        var c = {};
        if (void 0 !== a) {
            var d = new THREE.MaterialLoader;
            d.setTextures(b);
            for (var e = 0, f = a.length; f > e; e++) {
                var g = d.parse(a[e]);
                c[g.uuid] = g
            }
        }
        return c
    }, parseAnimations: function (a) {
        for (var b = [], c = 0; c < a.length; c++) {
            var d = THREE.AnimationClip.parse(a[c]);
            b.push(d)
        }
        return b
    }, parseImages: function (a, b) {
        function c(a) {
            return d.manager.itemStart(a), g.load(a, function () {
                d.manager.itemEnd(a)
            })
        }

        var d = this, e = {};
        if (void 0 !== a && a.length > 0) {
            var f = new THREE.LoadingManager(b), g = new THREE.ImageLoader(f);
            g.setCrossOrigin(this.crossOrigin);
            for (var h = 0, i = a.length; i > h; h++) {
                var j = a[h], k = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(j.url) ? j.url : d.texturePath + j.url;
                e[j.uuid] = c(k)
            }
        }
        return e
    }, parseTextures: function (a, b) {
        function c(a) {
            return "number" == typeof a ? a : (console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.", a), THREE[a])
        }

        var d = {};
        if (void 0 !== a)for (var e = 0, f = a.length; f > e; e++) {
            var g = a[e];
            void 0 === g.image && console.warn('THREE.ObjectLoader: No "image" specified for', g.uuid), void 0 === b[g.image] && console.warn("THREE.ObjectLoader: Undefined image", g.image);
            var h = new THREE.Texture(b[g.image]);
            h.needsUpdate = !0, h.uuid = g.uuid, void 0 !== g.name && (h.name = g.name), void 0 !== g.mapping && (h.mapping = c(g.mapping)), void 0 !== g.offset && (h.offset = new THREE.Vector2(g.offset[0], g.offset[1])), void 0 !== g.repeat && (h.repeat = new THREE.Vector2(g.repeat[0], g.repeat[1])), void 0 !== g.minFilter && (h.minFilter = c(g.minFilter)), void 0 !== g.magFilter && (h.magFilter = c(g.magFilter)), void 0 !== g.anisotropy && (h.anisotropy = g.anisotropy), Array.isArray(g.wrap) && (h.wrapS = c(g.wrap[0]), h.wrapT = c(g.wrap[1])), d[g.uuid] = h
        }
        return d
    }, parseObject: function () {
        var a = new THREE.Matrix4;
        return function (b, c, d) {
            function e(a) {
                return void 0 === c[a] && console.warn("THREE.ObjectLoader: Undefined geometry", a), c[a]
            }

            function f(a) {
                return void 0 === a ? void 0 : (void 0 === d[a] && console.warn("THREE.ObjectLoader: Undefined material", a), d[a])
            }

            var g;
            switch (b.type) {
                case"Scene":
                    g = new THREE.Scene;
                    break;
                case"PerspectiveCamera":
                    g = new THREE.PerspectiveCamera(b.fov, b.aspect, b.near, b.far), void 0 !== b.focus && (g.focus = b.focus), void 0 !== b.zoom && (g.zoom = b.zoom), void 0 !== b.filmGauge && (g.filmGauge = b.filmGauge), void 0 !== b.filmOffset && (g.filmOffset = b.filmOffset), void 0 !== b.view && (g.view = Object.assign({}, b.view));
                    break;
                case"OrthographicCamera":
                    g = new THREE.OrthographicCamera(b.left, b.right, b.top, b.bottom, b.near, b.far);
                    break;
                case"AmbientLight":
                    g = new THREE.AmbientLight(b.color, b.intensity);
                    break;
                case"DirectionalLight":
                    g = new THREE.DirectionalLight(b.color, b.intensity);
                    break;
                case"PointLight":
                    g = new THREE.PointLight(b.color, b.intensity, b.distance, b.decay);
                    break;
                case"SpotLight":
                    g = new THREE.SpotLight(b.color, b.intensity, b.distance, b.angle, b.penumbra, b.decay);
                    break;
                case"HemisphereLight":
                    g = new THREE.HemisphereLight(b.color, b.groundColor, b.intensity);
                    break;
                case"Mesh":
                    var h = e(b.geometry), i = f(b.material);
                    g = h.bones && h.bones.length > 0 ? new THREE.SkinnedMesh(h, i) : new THREE.Mesh(h, i);
                    break;
                case"LOD":
                    g = new THREE.LOD;
                    break;
                case"Line":
                    g = new THREE.Line(e(b.geometry), f(b.material), b.mode);
                    break;
                case"PointCloud":
                case"Points":
                    g = new THREE.Points(e(b.geometry), f(b.material));
                    break;
                case"Sprite":
                    g = new THREE.Sprite(f(b.material));
                    break;
                case"Group":
                    g = new THREE.Group;
                    break;
                default:
                    g = new THREE.Object3D
            }
            if (g.uuid = b.uuid, void 0 !== b.name && (g.name = b.name), void 0 !== b.matrix ? (a.fromArray(b.matrix), a.decompose(g.position, g.quaternion, g.scale)) : (void 0 !== b.position && g.position.fromArray(b.position), void 0 !== b.rotation && g.rotation.fromArray(b.rotation), void 0 !== b.scale && g.scale.fromArray(b.scale)), void 0 !== b.castShadow && (g.castShadow = b.castShadow), void 0 !== b.receiveShadow && (g.receiveShadow = b.receiveShadow), void 0 !== b.visible && (g.visible = b.visible), void 0 !== b.userData && (g.userData = b.userData), void 0 !== b.children)for (var j in b.children)g.add(this.parseObject(b.children[j], c, d));
            if ("LOD" === b.type)for (var k = b.levels, l = 0; l < k.length; l++) {
                var m = k[l], j = g.getObjectByProperty("uuid", m.object);
                void 0 !== j && g.addLevel(j, m.distance)
            }
            return g
        }
    }()
}),THREE.TextureLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.TextureLoader.prototype, {
    load: function (a, b, c, d) {
        var e = new THREE.Texture, f = new THREE.ImageLoader(this.manager);
        return f.setCrossOrigin(this.crossOrigin), f.setPath(this.path), f.load(a, function (a) {
            e.image = a, e.needsUpdate = !0, void 0 !== b && b(e)
        }, c, d), e
    }, setCrossOrigin: function (a) {
        return this.crossOrigin = a, this
    }, setPath: function (a) {
        return this.path = a, this
    }
}),THREE.CubeTextureLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager
},Object.assign(THREE.CubeTextureLoader.prototype, {
    load: function (a, b, c, d) {
        function e(c) {
            g.load(a[c], function (a) {
                f.images[c] = a, h++, 6 === h && (f.needsUpdate = !0, b && b(f))
            }, void 0, d)
        }

        var f = new THREE.CubeTexture, g = new THREE.ImageLoader(this.manager);
        g.setCrossOrigin(this.crossOrigin), g.setPath(this.path);
        for (var h = 0, i = 0; i < a.length; ++i)e(i);
        return f
    }, setCrossOrigin: function (a) {
        return this.crossOrigin = a, this
    }, setPath: function (a) {
        return this.path = a, this
    }
}),THREE.DataTextureLoader = THREE.BinaryTextureLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager, this._parser = null
},Object.assign(THREE.BinaryTextureLoader.prototype, {
    load: function (a, b, c, d) {
        var e = this, f = new THREE.DataTexture, g = new THREE.XHRLoader(this.manager);
        return g.setResponseType("arraybuffer"), g.load(a, function (a) {
            var c = e._parser(a);
            c && (void 0 !== c.image ? f.image = c.image : void 0 !== c.data && (f.image.width = c.width, f.image.height = c.height, f.image.data = c.data), f.wrapS = void 0 !== c.wrapS ? c.wrapS : THREE.ClampToEdgeWrapping, f.wrapT = void 0 !== c.wrapT ? c.wrapT : THREE.ClampToEdgeWrapping, f.magFilter = void 0 !== c.magFilter ? c.magFilter : THREE.LinearFilter, f.minFilter = void 0 !== c.minFilter ? c.minFilter : THREE.LinearMipMapLinearFilter, f.anisotropy = void 0 !== c.anisotropy ? c.anisotropy : 1, void 0 !== c.format && (f.format = c.format), void 0 !== c.type && (f.type = c.type), void 0 !== c.mipmaps && (f.mipmaps = c.mipmaps), 1 === c.mipmapCount && (f.minFilter = THREE.LinearFilter), f.needsUpdate = !0, b && b(f, c))
        }, c, d), f
    }
}),THREE.CompressedTextureLoader = function (a) {
    this.manager = void 0 !== a ? a : THREE.DefaultLoadingManager, this._parser = null
},Object.assign(THREE.CompressedTextureLoader.prototype, {
    load: function (a, b, c, d) {
        function e(e) {
            i.load(a[e], function (a) {
                var c = f._parser(a, !0);
                g[e] = {
                    width: c.width,
                    height: c.height,
                    format: c.format,
                    mipmaps: c.mipmaps
                }, j += 1, 6 === j && (1 === c.mipmapCount && (h.minFilter = THREE.LinearFilter), h.format = c.format, h.needsUpdate = !0, b && b(h))
            }, c, d)
        }

        var f = this, g = [], h = new THREE.CompressedTexture;
        h.image = g;
        var i = new THREE.XHRLoader(this.manager);
        if (i.setPath(this.path), i.setResponseType("arraybuffer"), Array.isArray(a))for (var j = 0, k = 0, l = a.length; l > k; ++k)e(k); else i.load(a, function (a) {
            var c = f._parser(a, !0);
            if (c.isCubemap)for (var d = c.mipmaps.length / c.mipmapCount, e = 0; d > e; e++) {
                g[e] = {mipmaps: []};
                for (var i = 0; i < c.mipmapCount; i++)g[e].mipmaps.push(c.mipmaps[e * c.mipmapCount + i]), g[e].format = c.format, g[e].width = c.width, g[e].height = c.height
            } else h.image.width = c.width, h.image.height = c.height, h.mipmaps = c.mipmaps;
            1 === c.mipmapCount && (h.minFilter = THREE.LinearFilter), h.format = c.format, h.needsUpdate = !0, b && b(h)
        }, c, d);
        return h
    }, setPath: function (a) {
        return this.path = a, this
    }
}),THREE.Material = function () {
    Object.defineProperty(this, "id", {value: THREE.MaterialIdCount++}), this.uuid = THREE.Math.generateUUID(), this.name = "", this.type = "Material", this.fog = !0, this.lights = !0, this.blending = THREE.NormalBlending, this.side = THREE.FrontSide, this.shading = THREE.SmoothShading, this.vertexColors = THREE.NoColors, this.opacity = 1, this.transparent = !1, this.blendSrc = THREE.SrcAlphaFactor, this.blendDst = THREE.OneMinusSrcAlphaFactor, this.blendEquation = THREE.AddEquation, this.blendSrcAlpha = null, this.blendDstAlpha = null, this.blendEquationAlpha = null, this.depthFunc = THREE.LessEqualDepth, this.depthTest = !0, this.depthWrite = !0, this.clippingPlanes = null, this.clipShadows = !1, this.colorWrite = !0, this.precision = null, this.polygonOffset = !1, this.polygonOffsetFactor = 0, this.polygonOffsetUnits = 0, this.alphaTest = 0, this.premultipliedAlpha = !1, this.overdraw = 0, this.visible = !0, this._needsUpdate = !0
},THREE.Material.prototype = {
    constructor: THREE.Material, get needsUpdate() {
        return this._needsUpdate
    }, set needsUpdate(a) {
        a === !0 && this.update(), this._needsUpdate = a
    }, setValues: function (a) {
        if (void 0 !== a)for (var b in a) {
            var c = a[b];
            if (void 0 !== c) {
                var d = this[b];
                void 0 !== d ? d instanceof THREE.Color ? d.set(c) : d instanceof THREE.Vector3 && c instanceof THREE.Vector3 ? d.copy(c) : "overdraw" === b ? this[b] = Number(c) : this[b] = c : console.warn("THREE." + this.type + ": '" + b + "' is not a property of this material.")
            } else console.warn("THREE.Material: '" + b + "' parameter is undefined.")
        }
    }, toJSON: function (a) {
        function b(a) {
            var b = [];
            for (var c in a) {
                var d = a[c];
                delete d.metadata, b.push(d)
            }
            return b
        }

        var c = void 0 === a;
        c && (a = {textures: {}, images: {}});
        var d = {metadata: {version: 4.4, type: "Material", generator: "Material.toJSON"}};
        if (d.uuid = this.uuid, d.type = this.type, "" !== this.name && (d.name = this.name), this.color instanceof THREE.Color && (d.color = this.color.getHex()), void 0 !== this.roughness && (d.roughness = this.roughness), void 0 !== this.metalness && (d.metalness = this.metalness), this.emissive instanceof THREE.Color && (d.emissive = this.emissive.getHex()), this.specular instanceof THREE.Color && (d.specular = this.specular.getHex()), void 0 !== this.shininess && (d.shininess = this.shininess), this.map instanceof THREE.Texture && (d.map = this.map.toJSON(a).uuid), this.alphaMap instanceof THREE.Texture && (d.alphaMap = this.alphaMap.toJSON(a).uuid), this.lightMap instanceof THREE.Texture && (d.lightMap = this.lightMap.toJSON(a).uuid), this.bumpMap instanceof THREE.Texture && (d.bumpMap = this.bumpMap.toJSON(a).uuid, d.bumpScale = this.bumpScale), this.normalMap instanceof THREE.Texture && (d.normalMap = this.normalMap.toJSON(a).uuid, d.normalScale = this.normalScale.toArray()), this.displacementMap instanceof THREE.Texture && (d.displacementMap = this.displacementMap.toJSON(a).uuid, d.displacementScale = this.displacementScale, d.displacementBias = this.displacementBias), this.roughnessMap instanceof THREE.Texture && (d.roughnessMap = this.roughnessMap.toJSON(a).uuid), this.metalnessMap instanceof THREE.Texture && (d.metalnessMap = this.metalnessMap.toJSON(a).uuid), this.emissiveMap instanceof THREE.Texture && (d.emissiveMap = this.emissiveMap.toJSON(a).uuid), this.specularMap instanceof THREE.Texture && (d.specularMap = this.specularMap.toJSON(a).uuid), this.envMap instanceof THREE.Texture && (d.envMap = this.envMap.toJSON(a).uuid, d.reflectivity = this.reflectivity), void 0 !== this.size && (d.size = this.size), void 0 !== this.sizeAttenuation && (d.sizeAttenuation = this.sizeAttenuation), this.blending !== THREE.NormalBlending && (d.blending = this.blending), this.shading !== THREE.SmoothShading && (d.shading = this.shading), this.side !== THREE.FrontSide && (d.side = this.side), this.vertexColors !== THREE.NoColors && (d.vertexColors = this.vertexColors), this.opacity < 1 && (d.opacity = this.opacity), this.transparent === !0 && (d.transparent = this.transparent), this.alphaTest > 0 && (d.alphaTest = this.alphaTest), this.premultipliedAlpha === !0 && (d.premultipliedAlpha = this.premultipliedAlpha), this.wireframe === !0 && (d.wireframe = this.wireframe), this.wireframeLinewidth > 1 && (d.wireframeLinewidth = this.wireframeLinewidth), c) {
            var e = b(a.textures), f = b(a.images);
            e.length > 0 && (d.textures = e), f.length > 0 && (d.images = f)
        }
        return d
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        this.name = a.name, this.fog = a.fog, this.lights = a.lights, this.blending = a.blending, this.side = a.side, this.shading = a.shading, this.vertexColors = a.vertexColors, this.opacity = a.opacity, this.transparent = a.transparent, this.blendSrc = a.blendSrc, this.blendDst = a.blendDst, this.blendEquation = a.blendEquation, this.blendSrcAlpha = a.blendSrcAlpha, this.blendDstAlpha = a.blendDstAlpha, this.blendEquationAlpha = a.blendEquationAlpha, this.depthFunc = a.depthFunc, this.depthTest = a.depthTest, this.depthWrite = a.depthWrite, this.colorWrite = a.colorWrite, this.precision = a.precision, this.polygonOffset = a.polygonOffset, this.polygonOffsetFactor = a.polygonOffsetFactor, this.polygonOffsetUnits = a.polygonOffsetUnits, this.alphaTest = a.alphaTest, this.premultipliedAlpha = a.premultipliedAlpha, this.overdraw = a.overdraw, this.visible = a.visible, this.clipShadows = a.clipShadows;
        var b = a.clippingPlanes, c = null;
        if (null !== b) {
            var d = b.length;
            c = new Array(d);
            for (var e = 0; e !== d; ++e)c[e] = b[e].clone()
        }
        return this.clippingPlanes = c, this
    }, update: function () {
        this.dispatchEvent({type: "update"})
    }, dispose: function () {
        this.dispatchEvent({type: "dispose"})
    }
},Object.assign(THREE.Material.prototype, THREE.EventDispatcher.prototype),THREE.MaterialIdCount = 0,THREE.LineBasicMaterial = function (a) {
    THREE.Material.call(this), this.type = "LineBasicMaterial", this.color = new THREE.Color(16777215), this.linewidth = 1, this.linecap = "round", this.linejoin = "round", this.lights = !1, this.setValues(a)
},THREE.LineBasicMaterial.prototype = Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial,THREE.LineBasicMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.linewidth = a.linewidth, this.linecap = a.linecap, this.linejoin = a.linejoin, this
},THREE.LineDashedMaterial = function (a) {
    THREE.Material.call(this), this.type = "LineDashedMaterial", this.color = new THREE.Color(16777215), this.linewidth = 1, this.scale = 1, this.dashSize = 3, this.gapSize = 1, this.lights = !1, this.setValues(a)
},THREE.LineDashedMaterial.prototype = Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial,THREE.LineDashedMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.linewidth = a.linewidth, this.scale = a.scale, this.dashSize = a.dashSize, this.gapSize = a.gapSize, this
},THREE.MeshBasicMaterial = function (a) {
    THREE.Material.call(this), this.type = "MeshBasicMaterial", this.color = new THREE.Color(16777215), this.map = null, this.aoMap = null, this.aoMapIntensity = 1, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = THREE.MultiplyOperation, this.reflectivity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.lights = !1, this.setValues(a)
},THREE.MeshBasicMaterial.prototype = Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial,THREE.MeshBasicMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.map = a.map, this.aoMap = a.aoMap, this.aoMapIntensity = a.aoMapIntensity, this.specularMap = a.specularMap, this.alphaMap = a.alphaMap, this.envMap = a.envMap, this.combine = a.combine, this.reflectivity = a.reflectivity, this.refractionRatio = a.refractionRatio, this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this.wireframeLinecap = a.wireframeLinecap, this.wireframeLinejoin = a.wireframeLinejoin, this.skinning = a.skinning, this.morphTargets = a.morphTargets, this
},THREE.MeshDepthMaterial = function (a) {
    THREE.Material.call(this), this.type = "MeshDepthMaterial", this.depthPacking = THREE.BasicDepthPacking, this.skinning = !1, this.morphTargets = !1, this.map = null, this.alphaMap = null, this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.setValues(a)
},THREE.MeshDepthMaterial.prototype = Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial,THREE.MeshDepthMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.depthPacking = a.depthPacking, this.skinning = a.skinning, this.morphTargets = a.morphTargets, this.map = a.map, this.alphaMap = a.alphaMap, this.displacementMap = a.displacementMap, this.displacementScale = a.displacementScale, this.displacementBias = a.displacementBias, this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this
},THREE.MeshLambertMaterial = function (a) {
    THREE.Material.call(this), this.type = "MeshLambertMaterial", this.color = new THREE.Color(16777215), this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new THREE.Color(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = THREE.MultiplyOperation, this.reflectivity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(a)
},THREE.MeshLambertMaterial.prototype = Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial,
THREE.MeshLambertMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.map = a.map, this.lightMap = a.lightMap, this.lightMapIntensity = a.lightMapIntensity, this.aoMap = a.aoMap, this.aoMapIntensity = a.aoMapIntensity, this.emissive.copy(a.emissive), this.emissiveMap = a.emissiveMap, this.emissiveIntensity = a.emissiveIntensity, this.specularMap = a.specularMap, this.alphaMap = a.alphaMap, this.envMap = a.envMap, this.combine = a.combine, this.reflectivity = a.reflectivity, this.refractionRatio = a.refractionRatio, this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this.wireframeLinecap = a.wireframeLinecap, this.wireframeLinejoin = a.wireframeLinejoin, this.skinning = a.skinning, this.morphTargets = a.morphTargets, this.morphNormals = a.morphNormals, this
},THREE.MeshNormalMaterial = function (a) {
    THREE.Material.call(this, a), this.type = "MeshNormalMaterial", this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.morphTargets = !1, this.setValues(a)
},THREE.MeshNormalMaterial.prototype = Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial,THREE.MeshNormalMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this
},THREE.MeshPhongMaterial = function (a) {
    THREE.Material.call(this), this.type = "MeshPhongMaterial", this.color = new THREE.Color(16777215), this.specular = new THREE.Color(1118481), this.shininess = 30, this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new THREE.Color(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalScale = new THREE.Vector2(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.specularMap = null, this.alphaMap = null, this.envMap = null, this.combine = THREE.MultiplyOperation, this.reflectivity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(a)
},THREE.MeshPhongMaterial.prototype = Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial,THREE.MeshPhongMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.specular.copy(a.specular), this.shininess = a.shininess, this.map = a.map, this.lightMap = a.lightMap, this.lightMapIntensity = a.lightMapIntensity, this.aoMap = a.aoMap, this.aoMapIntensity = a.aoMapIntensity, this.emissive.copy(a.emissive), this.emissiveMap = a.emissiveMap, this.emissiveIntensity = a.emissiveIntensity, this.bumpMap = a.bumpMap, this.bumpScale = a.bumpScale, this.normalMap = a.normalMap, this.normalScale.copy(a.normalScale), this.displacementMap = a.displacementMap, this.displacementScale = a.displacementScale, this.displacementBias = a.displacementBias, this.specularMap = a.specularMap, this.alphaMap = a.alphaMap, this.envMap = a.envMap, this.combine = a.combine, this.reflectivity = a.reflectivity, this.refractionRatio = a.refractionRatio, this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this.wireframeLinecap = a.wireframeLinecap, this.wireframeLinejoin = a.wireframeLinejoin, this.skinning = a.skinning, this.morphTargets = a.morphTargets, this.morphNormals = a.morphNormals, this
},THREE.MeshStandardMaterial = function (a) {
    THREE.Material.call(this), this.defines = {STANDARD: ""}, this.type = "MeshStandardMaterial", this.color = new THREE.Color(16777215), this.roughness = .5, this.metalness = .5, this.map = null, this.lightMap = null, this.lightMapIntensity = 1, this.aoMap = null, this.aoMapIntensity = 1, this.emissive = new THREE.Color(0), this.emissiveIntensity = 1, this.emissiveMap = null, this.bumpMap = null, this.bumpScale = 1, this.normalMap = null, this.normalScale = new THREE.Vector2(1, 1), this.displacementMap = null, this.displacementScale = 1, this.displacementBias = 0, this.roughnessMap = null, this.metalnessMap = null, this.alphaMap = null, this.envMap = null, this.envMapIntensity = 1, this.refractionRatio = .98, this.wireframe = !1, this.wireframeLinewidth = 1, this.wireframeLinecap = "round", this.wireframeLinejoin = "round", this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.setValues(a)
},THREE.MeshStandardMaterial.prototype = Object.create(THREE.Material.prototype),THREE.MeshStandardMaterial.prototype.constructor = THREE.MeshStandardMaterial,THREE.MeshStandardMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.defines = {STANDARD: ""}, this.color.copy(a.color), this.roughness = a.roughness, this.metalness = a.metalness, this.map = a.map, this.lightMap = a.lightMap, this.lightMapIntensity = a.lightMapIntensity, this.aoMap = a.aoMap, this.aoMapIntensity = a.aoMapIntensity, this.emissive.copy(a.emissive), this.emissiveMap = a.emissiveMap, this.emissiveIntensity = a.emissiveIntensity, this.bumpMap = a.bumpMap, this.bumpScale = a.bumpScale, this.normalMap = a.normalMap, this.normalScale.copy(a.normalScale), this.displacementMap = a.displacementMap, this.displacementScale = a.displacementScale, this.displacementBias = a.displacementBias, this.roughnessMap = a.roughnessMap, this.metalnessMap = a.metalnessMap, this.alphaMap = a.alphaMap, this.envMap = a.envMap, this.envMapIntensity = a.envMapIntensity, this.refractionRatio = a.refractionRatio, this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this.wireframeLinecap = a.wireframeLinecap, this.wireframeLinejoin = a.wireframeLinejoin, this.skinning = a.skinning, this.morphTargets = a.morphTargets, this.morphNormals = a.morphNormals, this
},THREE.MeshPhysicalMaterial = function (a) {
    THREE.MeshStandardMaterial.call(this), this.defines = {PHYSICAL: ""}, this.type = "MeshPhysicalMaterial", this.reflectivity = .5, this.clearCoat = 0, this.clearCoatRoughness = 0, this.setValues(a)
},THREE.MeshPhysicalMaterial.prototype = Object.create(THREE.MeshStandardMaterial.prototype),THREE.MeshPhysicalMaterial.prototype.constructor = THREE.MeshPhysicalMaterial,THREE.MeshPhysicalMaterial.prototype.copy = function (a) {
    return THREE.MeshStandardMaterial.prototype.copy.call(this, a), this.defines = {PHYSICAL: ""}, this.reflectivity = a.reflectivity, this.clearCoat = a.clearCoat, this.clearCoatRoughness = a.clearCoatRoughness, this
},THREE.MultiMaterial = function (a) {
    this.uuid = THREE.Math.generateUUID(), this.type = "MultiMaterial", this.materials = a instanceof Array ? a : [], this.visible = !0
},THREE.MultiMaterial.prototype = {
    constructor: THREE.MultiMaterial, toJSON: function (a) {
        for (var b = {
            metadata: {version: 4.2, type: "material", generator: "MaterialExporter"},
            uuid: this.uuid,
            type: this.type,
            materials: []
        }, c = this.materials, d = 0, e = c.length; e > d; d++) {
            var f = c[d].toJSON(a);
            delete f.metadata, b.materials.push(f)
        }
        return b.visible = this.visible, b
    }, clone: function () {
        for (var a = new this.constructor, b = 0; b < this.materials.length; b++)a.materials.push(this.materials[b].clone());
        return a.visible = this.visible, a
    }
},THREE.PointsMaterial = function (a) {
    THREE.Material.call(this), this.type = "PointsMaterial", this.color = new THREE.Color(16777215), this.map = null, this.size = 1, this.sizeAttenuation = !0, this.lights = !1, this.setValues(a)
},THREE.PointsMaterial.prototype = Object.create(THREE.Material.prototype),THREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial,THREE.PointsMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.map = a.map, this.size = a.size, this.sizeAttenuation = a.sizeAttenuation, this
},THREE.ShaderMaterial = function (a) {
    THREE.Material.call(this), this.type = "ShaderMaterial", this.defines = {}, this.uniforms = {}, this.vertexShader = "void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}", this.fragmentShader = "void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}", this.linewidth = 1, this.wireframe = !1, this.wireframeLinewidth = 1, this.fog = !1, this.lights = !1, this.clipping = !1, this.skinning = !1, this.morphTargets = !1, this.morphNormals = !1, this.extensions = {
        derivatives: !1,
        fragDepth: !1,
        drawBuffers: !1,
        shaderTextureLOD: !1
    }, this.defaultAttributeValues = {
        color: [1, 1, 1],
        uv: [0, 0],
        uv2: [0, 0]
    }, this.index0AttributeName = void 0, void 0 !== a && (void 0 !== a.attributes && console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."), this.setValues(a))
},THREE.ShaderMaterial.prototype = Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial,THREE.ShaderMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.fragmentShader = a.fragmentShader, this.vertexShader = a.vertexShader, this.uniforms = THREE.UniformsUtils.clone(a.uniforms), this.defines = a.defines, this.wireframe = a.wireframe, this.wireframeLinewidth = a.wireframeLinewidth, this.lights = a.lights, this.clipping = a.clipping, this.skinning = a.skinning, this.morphTargets = a.morphTargets, this.morphNormals = a.morphNormals, this.extensions = a.extensions, this
},THREE.ShaderMaterial.prototype.toJSON = function (a) {
    var b = THREE.Material.prototype.toJSON.call(this, a);
    return b.uniforms = this.uniforms, b.vertexShader = this.vertexShader, b.fragmentShader = this.fragmentShader, b
},THREE.RawShaderMaterial = function (a) {
    THREE.ShaderMaterial.call(this, a), this.type = "RawShaderMaterial"
},THREE.RawShaderMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial,THREE.SpriteMaterial = function (a) {
    THREE.Material.call(this), this.type = "SpriteMaterial", this.color = new THREE.Color(16777215), this.map = null, this.rotation = 0, this.fog = !1, this.lights = !1, this.setValues(a)
},THREE.SpriteMaterial.prototype = Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial,THREE.SpriteMaterial.prototype.copy = function (a) {
    return THREE.Material.prototype.copy.call(this, a), this.color.copy(a.color), this.map = a.map, this.rotation = a.rotation, this
},THREE.ShadowMaterial = function () {
    THREE.ShaderMaterial.call(this, {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.lights, {opacity: {value: 1}}]),
        vertexShader: THREE.ShaderChunk.shadow_vert,
        fragmentShader: THREE.ShaderChunk.shadow_frag
    }), this.lights = !0, this.transparent = !0, Object.defineProperties(this, {
        opacity: {
            enumerable: !0,
            get: function () {
                return this.uniforms.opacity.value
            },
            set: function (a) {
                this.uniforms.opacity.value = a
            }
        }
    })
},THREE.ShadowMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype),THREE.ShadowMaterial.prototype.constructor = THREE.ShadowMaterial,THREE.Texture = function (a, b, c, d, e, f, g, h, i, j) {
    Object.defineProperty(this, "id", {value: THREE.TextureIdCount++}), this.uuid = THREE.Math.generateUUID(), this.name = "", this.sourceFile = "", this.image = void 0 !== a ? a : THREE.Texture.DEFAULT_IMAGE, this.mipmaps = [], this.mapping = void 0 !== b ? b : THREE.Texture.DEFAULT_MAPPING, this.wrapS = void 0 !== c ? c : THREE.ClampToEdgeWrapping, this.wrapT = void 0 !== d ? d : THREE.ClampToEdgeWrapping, this.magFilter = void 0 !== e ? e : THREE.LinearFilter, this.minFilter = void 0 !== f ? f : THREE.LinearMipMapLinearFilter, this.anisotropy = void 0 !== i ? i : 1, this.format = void 0 !== g ? g : THREE.RGBAFormat, this.type = void 0 !== h ? h : THREE.UnsignedByteType, this.offset = new THREE.Vector2(0, 0), this.repeat = new THREE.Vector2(1, 1), this.generateMipmaps = !0, this.premultiplyAlpha = !1, this.flipY = !0, this.unpackAlignment = 4, this.encoding = void 0 !== j ? j : THREE.LinearEncoding, this.version = 0, this.onUpdate = null
},THREE.Texture.DEFAULT_IMAGE = void 0,THREE.Texture.DEFAULT_MAPPING = THREE.UVMapping,THREE.Texture.prototype = {
    constructor: THREE.Texture,
    set needsUpdate(a) {
        a === !0 && this.version++
    },
    clone: function () {
        return (new this.constructor).copy(this)
    },
    copy: function (a) {
        return this.image = a.image, this.mipmaps = a.mipmaps.slice(0), this.mapping = a.mapping, this.wrapS = a.wrapS, this.wrapT = a.wrapT, this.magFilter = a.magFilter, this.minFilter = a.minFilter, this.anisotropy = a.anisotropy, this.format = a.format, this.type = a.type, this.offset.copy(a.offset), this.repeat.copy(a.repeat), this.generateMipmaps = a.generateMipmaps, this.premultiplyAlpha = a.premultiplyAlpha, this.flipY = a.flipY, this.unpackAlignment = a.unpackAlignment, this.encoding = a.encoding, this
    },
    toJSON: function (a) {
        function b(a) {
            var b;
            return void 0 !== a.toDataURL ? b = a : (b = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas"), b.width = a.width, b.height = a.height, b.getContext("2d").drawImage(a, 0, 0, a.width, a.height)), b.width > 2048 || b.height > 2048 ? b.toDataURL("image/jpeg", .6) : b.toDataURL("image/png")
        }

        if (void 0 !== a.textures[this.uuid])return a.textures[this.uuid];
        var c = {
            metadata: {version: 4.4, type: "Texture", generator: "Texture.toJSON"},
            uuid: this.uuid,
            name: this.name,
            mapping: this.mapping,
            repeat: [this.repeat.x, this.repeat.y],
            offset: [this.offset.x, this.offset.y],
            wrap: [this.wrapS, this.wrapT],
            minFilter: this.minFilter,
            magFilter: this.magFilter,
            anisotropy: this.anisotropy
        };
        if (void 0 !== this.image) {
            var d = this.image;
            void 0 === d.uuid && (d.uuid = THREE.Math.generateUUID()), void 0 === a.images[d.uuid] && (a.images[d.uuid] = {
                uuid: d.uuid,
                url: b(d)
            }), c.image = d.uuid
        }
        return a.textures[this.uuid] = c, c
    },
    dispose: function () {
        this.dispatchEvent({type: "dispose"})
    },
    transformUv: function (a) {
        if (this.mapping === THREE.UVMapping) {
            if (a.multiply(this.repeat), a.add(this.offset), a.x < 0 || a.x > 1)switch (this.wrapS) {
                case THREE.RepeatWrapping:
                    a.x = a.x - Math.floor(a.x);
                    break;
                case THREE.ClampToEdgeWrapping:
                    a.x = a.x < 0 ? 0 : 1;
                    break;
                case THREE.MirroredRepeatWrapping:
                    1 === Math.abs(Math.floor(a.x) % 2) ? a.x = Math.ceil(a.x) - a.x : a.x = a.x - Math.floor(a.x)
            }
            if (a.y < 0 || a.y > 1)switch (this.wrapT) {
                case THREE.RepeatWrapping:
                    a.y = a.y - Math.floor(a.y);
                    break;
                case THREE.ClampToEdgeWrapping:
                    a.y = a.y < 0 ? 0 : 1;
                    break;
                case THREE.MirroredRepeatWrapping:
                    1 === Math.abs(Math.floor(a.y) % 2) ? a.y = Math.ceil(a.y) - a.y : a.y = a.y - Math.floor(a.y)
            }
            this.flipY && (a.y = 1 - a.y)
        }
    }
},Object.assign(THREE.Texture.prototype, THREE.EventDispatcher.prototype),THREE.TextureIdCount = 0,THREE.DepthTexture = function (a, b, c, d, e, f, g, h, i) {
    THREE.Texture.call(this, null, d, e, f, g, h, THREE.DepthFormat, c, i), this.image = {
        width: a,
        height: b
    }, this.type = void 0 !== c ? c : THREE.UnsignedShortType, this.magFilter = void 0 !== g ? g : THREE.NearestFilter, this.minFilter = void 0 !== h ? h : THREE.NearestFilter, this.flipY = !1, this.generateMipmaps = !1
},THREE.DepthTexture.prototype = Object.create(THREE.Texture.prototype),THREE.DepthTexture.prototype.constructor = THREE.DepthTexture,THREE.CanvasTexture = function (a, b, c, d, e, f, g, h, i) {
    THREE.Texture.call(this, a, b, c, d, e, f, g, h, i), this.needsUpdate = !0
},THREE.CanvasTexture.prototype = Object.create(THREE.Texture.prototype),THREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture,THREE.CubeTexture = function (a, b, c, d, e, f, g, h, i, j) {
    a = void 0 !== a ? a : [], b = void 0 !== b ? b : THREE.CubeReflectionMapping, THREE.Texture.call(this, a, b, c, d, e, f, g, h, i, j), this.flipY = !1
},THREE.CubeTexture.prototype = Object.create(THREE.Texture.prototype),THREE.CubeTexture.prototype.constructor = THREE.CubeTexture,Object.defineProperty(THREE.CubeTexture.prototype, "images", {
    get: function () {
        return this.image
    }, set: function (a) {
        this.image = a
    }
}),THREE.CompressedTexture = function (a, b, c, d, e, f, g, h, i, j, k, l) {
    THREE.Texture.call(this, null, f, g, h, i, j, d, e, k, l), this.image = {
        width: b,
        height: c
    }, this.mipmaps = a, this.flipY = !1, this.generateMipmaps = !1
},THREE.CompressedTexture.prototype = Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture,THREE.DataTexture = function (a, b, c, d, e, f, g, h, i, j, k, l) {
    THREE.Texture.call(this, null, f, g, h, i, j, d, e, k, l), this.image = {
        data: a,
        width: b,
        height: c
    }, this.magFilter = void 0 !== i ? i : THREE.NearestFilter, this.minFilter = void 0 !== j ? j : THREE.NearestFilter, this.flipY = !1, this.generateMipmaps = !1
},THREE.DataTexture.prototype = Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.constructor = THREE.DataTexture,THREE.VideoTexture = function (a, b, c, d, e, f, g, h, i) {
    function j() {
        requestAnimationFrame(j), a.readyState >= a.HAVE_CURRENT_DATA && (k.needsUpdate = !0)
    }

    THREE.Texture.call(this, a, b, c, d, e, f, g, h, i), this.generateMipmaps = !1;
    var k = this;
    j()
},THREE.VideoTexture.prototype = Object.create(THREE.Texture.prototype),THREE.VideoTexture.prototype.constructor = THREE.VideoTexture,THREE.Group = function () {
    THREE.Object3D.call(this), this.type = "Group"
},THREE.Group.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {constructor: THREE.Group}),THREE.Points = function (a, b) {
    THREE.Object3D.call(this), this.type = "Points", this.geometry = void 0 !== a ? a : new THREE.BufferGeometry, this.material = void 0 !== b ? b : new THREE.PointsMaterial({color: 16777215 * Math.random()})
},THREE.Points.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Points,
    raycast: function () {
        var a = new THREE.Matrix4, b = new THREE.Ray, c = new THREE.Sphere;
        return function (d, e) {
            function f(a, c) {
                var f = b.distanceSqToPoint(a);
                if (l > f) {
                    var h = b.closestPointToPoint(a);
                    h.applyMatrix4(i);
                    var j = d.ray.origin.distanceTo(h);
                    if (j < d.near || j > d.far)return;
                    e.push({
                        distance: j,
                        distanceToRay: Math.sqrt(f),
                        point: h.clone(),
                        index: c,
                        face: null,
                        object: g
                    })
                }
            }

            var g = this, h = this.geometry, i = this.matrixWorld, j = d.params.Points.threshold;
            if (null === h.boundingSphere && h.computeBoundingSphere(), c.copy(h.boundingSphere), c.applyMatrix4(i), d.ray.intersectsSphere(c) !== !1) {
                a.getInverse(i), b.copy(d.ray).applyMatrix4(a);
                var k = j / ((this.scale.x + this.scale.y + this.scale.z) / 3), l = k * k, m = new THREE.Vector3;
                if (h instanceof THREE.BufferGeometry) {
                    var n = h.index, o = h.attributes, p = o.position.array;
                    if (null !== n)for (var q = n.array, r = 0, s = q.length; s > r; r++) {
                        var t = q[r];
                        m.fromArray(p, 3 * t), f(m, t)
                    } else for (var r = 0, u = p.length / 3; u > r; r++)m.fromArray(p, 3 * r), f(m, r)
                } else for (var v = h.vertices, r = 0, u = v.length; u > r; r++)f(v[r], r)
            }
        }
    }(),
    clone: function () {
        return new this.constructor(this.geometry, this.material).copy(this)
    }
}),THREE.Line = function (a, b, c) {
    return 1 === c ? (console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."), new THREE.LineSegments(a, b)) : (THREE.Object3D.call(this), this.type = "Line", this.geometry = void 0 !== a ? a : new THREE.BufferGeometry, void(this.material = void 0 !== b ? b : new THREE.LineBasicMaterial({color: 16777215 * Math.random()})))
},THREE.Line.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Line,
    raycast: function () {
        var a = new THREE.Matrix4, b = new THREE.Ray, c = new THREE.Sphere;
        return function (d, e) {
            var f = d.linePrecision, g = f * f, h = this.geometry, i = this.matrixWorld;
            if (null === h.boundingSphere && h.computeBoundingSphere(), c.copy(h.boundingSphere), c.applyMatrix4(i), d.ray.intersectsSphere(c) !== !1) {
                a.getInverse(i), b.copy(d.ray).applyMatrix4(a);
                var j = new THREE.Vector3, k = new THREE.Vector3, l = new THREE.Vector3, m = new THREE.Vector3, n = this instanceof THREE.LineSegments ? 2 : 1;
                if (h instanceof THREE.BufferGeometry) {
                    var o = h.index, p = h.attributes, q = p.position.array;
                    if (null !== o)for (var r = o.array, s = 0, t = r.length - 1; t > s; s += n) {
                        var u = r[s], v = r[s + 1];
                        j.fromArray(q, 3 * u), k.fromArray(q, 3 * v);
                        var w = b.distanceSqToSegment(j, k, m, l);
                        if (!(w > g)) {
                            m.applyMatrix4(this.matrixWorld);
                            var x = d.ray.origin.distanceTo(m);
                            x < d.near || x > d.far || e.push({
                                distance: x,
                                point: l.clone().applyMatrix4(this.matrixWorld),
                                index: s,
                                face: null,
                                faceIndex: null,
                                object: this
                            })
                        }
                    } else for (var s = 0, t = q.length / 3 - 1; t > s; s += n) {
                        j.fromArray(q, 3 * s), k.fromArray(q, 3 * s + 3);
                        var w = b.distanceSqToSegment(j, k, m, l);
                        if (!(w > g)) {
                            m.applyMatrix4(this.matrixWorld);
                            var x = d.ray.origin.distanceTo(m);
                            x < d.near || x > d.far || e.push({
                                distance: x,
                                point: l.clone().applyMatrix4(this.matrixWorld),
                                index: s,
                                face: null,
                                faceIndex: null,
                                object: this
                            })
                        }
                    }
                } else if (h instanceof THREE.Geometry)for (var y = h.vertices, z = y.length, s = 0; z - 1 > s; s += n) {
                    var w = b.distanceSqToSegment(y[s], y[s + 1], m, l);
                    if (!(w > g)) {
                        m.applyMatrix4(this.matrixWorld);
                        var x = d.ray.origin.distanceTo(m);
                        x < d.near || x > d.far || e.push({
                            distance: x,
                            point: l.clone().applyMatrix4(this.matrixWorld),
                            index: s,
                            face: null,
                            faceIndex: null,
                            object: this
                        })
                    }
                }
            }
        }
    }(),
    clone: function () {
        return new this.constructor(this.geometry, this.material).copy(this)
    }
}),THREE.LineSegments = function (a, b) {
    THREE.Line.call(this, a, b), this.type = "LineSegments"
},THREE.LineSegments.prototype = Object.assign(Object.create(THREE.Line.prototype), {constructor: THREE.LineSegments}),THREE.Mesh = function (a, b) {
    THREE.Object3D.call(this), this.type = "Mesh", this.geometry = void 0 !== a ? a : new THREE.BufferGeometry, this.material = void 0 !== b ? b : new THREE.MeshBasicMaterial({color: 16777215 * Math.random()}), this.drawMode = THREE.TrianglesDrawMode, this.updateMorphTargets()
},THREE.Mesh.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Mesh,
    setDrawMode: function (a) {
        this.drawMode = a
    },
    copy: function (a) {
        return THREE.Object3D.prototype.copy.call(this, a), this.drawMode = a.drawMode, this
    },
    updateMorphTargets: function () {
        if (void 0 !== this.geometry.morphTargets && this.geometry.morphTargets.length > 0) {
            this.morphTargetBase = -1, this.morphTargetInfluences = [], this.morphTargetDictionary = {};
            for (var a = 0, b = this.geometry.morphTargets.length; b > a; a++)this.morphTargetInfluences.push(0), this.morphTargetDictionary[this.geometry.morphTargets[a].name] = a
        }
    },
    getMorphTargetIndexByName: function (a) {
        return void 0 !== this.morphTargetDictionary[a] ? this.morphTargetDictionary[a] : (console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target " + a + " does not exist. Returning 0."), 0)
    },
    raycast: function () {
        function a(a, b, c, d, e, f, g) {
            return THREE.Triangle.barycoordFromPoint(a, b, c, d, p), e.multiplyScalar(p.x), f.multiplyScalar(p.y), g.multiplyScalar(p.z), e.add(f).add(g), e.clone()
        }

        function b(a, b, c, d, e, f, g) {
            var h, i = a.material;
            if (h = i.side === THREE.BackSide ? c.intersectTriangle(f, e, d, !0, g) : c.intersectTriangle(d, e, f, i.side !== THREE.DoubleSide, g), null === h)return null;
            r.copy(g), r.applyMatrix4(a.matrixWorld);
            var j = b.ray.origin.distanceTo(r);
            return j < b.near || j > b.far ? null : {distance: j, point: r.clone(), object: a}
        }

        function c(c, d, e, f, j, k, l, p) {
            g.fromArray(f, 3 * k), h.fromArray(f, 3 * l), i.fromArray(f, 3 * p);
            var r = b(c, d, e, g, h, i, q);
            return r && (j && (m.fromArray(j, 2 * k), n.fromArray(j, 2 * l), o.fromArray(j, 2 * p), r.uv = a(q, g, h, i, m, n, o)), r.face = new THREE.Face3(k, l, p, THREE.Triangle.normal(g, h, i)), r.faceIndex = k), r
        }

        var d = new THREE.Matrix4, e = new THREE.Ray, f = new THREE.Sphere, g = new THREE.Vector3, h = new THREE.Vector3, i = new THREE.Vector3, j = new THREE.Vector3, k = new THREE.Vector3, l = new THREE.Vector3, m = new THREE.Vector2, n = new THREE.Vector2, o = new THREE.Vector2, p = new THREE.Vector3, q = new THREE.Vector3, r = new THREE.Vector3;
        return function (p, r) {
            var s = this.geometry, t = this.material, u = this.matrixWorld;
            if (void 0 !== t && (null === s.boundingSphere && s.computeBoundingSphere(), f.copy(s.boundingSphere), f.applyMatrix4(u), p.ray.intersectsSphere(f) !== !1 && (d.getInverse(u), e.copy(p.ray).applyMatrix4(d), null === s.boundingBox || e.intersectsBox(s.boundingBox) !== !1))) {
                var v, w;
                if (s instanceof THREE.BufferGeometry) {
                    var x, y, z, A = s.index, B = s.attributes, C = B.position.array;
                    if (void 0 !== B.uv && (v = B.uv.array), null !== A)for (var D = A.array, E = 0, F = D.length; F > E; E += 3)x = D[E], y = D[E + 1], z = D[E + 2], w = c(this, p, e, C, v, x, y, z), w && (w.faceIndex = Math.floor(E / 3), r.push(w)); else for (var E = 0, F = C.length; F > E; E += 9)x = E / 3, y = x + 1, z = x + 2, w = c(this, p, e, C, v, x, y, z), w && (w.index = x, r.push(w))
                } else if (s instanceof THREE.Geometry) {
                    var G, H, I, J = t instanceof THREE.MultiMaterial, K = J === !0 ? t.materials : null, L = s.vertices, M = s.faces, N = s.faceVertexUvs[0];
                    N.length > 0 && (v = N);
                    for (var O = 0, P = M.length; P > O; O++) {
                        var Q = M[O], R = J === !0 ? K[Q.materialIndex] : t;
                        if (void 0 !== R) {
                            if (G = L[Q.a], H = L[Q.b], I = L[Q.c], R.morphTargets === !0) {
                                var S = s.morphTargets, T = this.morphTargetInfluences;
                                g.set(0, 0, 0), h.set(0, 0, 0), i.set(0, 0, 0);
                                for (var U = 0, V = S.length; V > U; U++) {
                                    var W = T[U];
                                    if (0 !== W) {
                                        var X = S[U].vertices;
                                        g.addScaledVector(j.subVectors(X[Q.a], G), W), h.addScaledVector(k.subVectors(X[Q.b], H), W), i.addScaledVector(l.subVectors(X[Q.c], I), W)
                                    }
                                }
                                g.add(G), h.add(H), i.add(I), G = g, H = h, I = i
                            }
                            if (w = b(this, p, e, G, H, I, q)) {
                                if (v) {
                                    var Y = v[O];
                                    m.copy(Y[0]), n.copy(Y[1]), o.copy(Y[2]), w.uv = a(q, G, H, I, m, n, o)
                                }
                                w.face = Q, w.faceIndex = O, r.push(w)
                            }
                        }
                    }
                }
            }
        }
    }(),
    clone: function () {
        return new this.constructor(this.geometry, this.material).copy(this)
    }
}),THREE.Bone = function (a) {
    THREE.Object3D.call(this), this.type = "Bone", this.skin = a
},THREE.Bone.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Bone,
    copy: function (a) {
        return THREE.Object3D.prototype.copy.call(this, a), this.skin = a.skin, this
    }
}),THREE.Skeleton = function (a, b, c) {
    if (this.useVertexTexture = void 0 !== c ? c : !0, this.identityMatrix = new THREE.Matrix4, a = a || [], this.bones = a.slice(0), this.useVertexTexture) {
        var d = Math.sqrt(4 * this.bones.length);
        d = THREE.Math.nextPowerOfTwo(Math.ceil(d)), d = Math.max(d, 4), this.boneTextureWidth = d, this.boneTextureHeight = d, this.boneMatrices = new Float32Array(this.boneTextureWidth * this.boneTextureHeight * 4), this.boneTexture = new THREE.DataTexture(this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType)
    } else this.boneMatrices = new Float32Array(16 * this.bones.length);
    if (void 0 === b)this.calculateInverses(); else if (this.bones.length === b.length)this.boneInverses = b.slice(0); else {
        console.warn("THREE.Skeleton bonInverses is the wrong length."), this.boneInverses = [];
        for (var e = 0, f = this.bones.length; f > e; e++)this.boneInverses.push(new THREE.Matrix4)
    }
},Object.assign(THREE.Skeleton.prototype, {
    calculateInverses: function () {
        this.boneInverses = [];
        for (var a = 0, b = this.bones.length; b > a; a++) {
            var c = new THREE.Matrix4;
            this.bones[a] && c.getInverse(this.bones[a].matrixWorld), this.boneInverses.push(c)
        }
    }, pose: function () {
        for (var a, b = 0, c = this.bones.length; c > b; b++)a = this.bones[b], a && a.matrixWorld.getInverse(this.boneInverses[b]);
        for (var b = 0, c = this.bones.length; c > b; b++)a = this.bones[b], a && (a.parent instanceof THREE.Bone ? (a.matrix.getInverse(a.parent.matrixWorld), a.matrix.multiply(a.matrixWorld)) : a.matrix.copy(a.matrixWorld), a.matrix.decompose(a.position, a.quaternion, a.scale))
    }, update: function () {
        var a = new THREE.Matrix4;
        return function () {
            for (var b = 0, c = this.bones.length; c > b; b++) {
                var d = this.bones[b] ? this.bones[b].matrixWorld : this.identityMatrix;
                a.multiplyMatrices(d, this.boneInverses[b]), a.toArray(this.boneMatrices, 16 * b)
            }
            this.useVertexTexture && (this.boneTexture.needsUpdate = !0)
        }
    }(), clone: function () {
        return new THREE.Skeleton(this.bones, this.boneInverses, this.useVertexTexture)
    }
}),THREE.SkinnedMesh = function (a, b, c) {
    THREE.Mesh.call(this, a, b), this.type = "SkinnedMesh", this.bindMode = "attached", this.bindMatrix = new THREE.Matrix4, this.bindMatrixInverse = new THREE.Matrix4;
    var d = [];
    if (this.geometry && void 0 !== this.geometry.bones) {
        for (var e, f, g = 0, h = this.geometry.bones.length; h > g; ++g)f = this.geometry.bones[g], e = new THREE.Bone(this), d.push(e), e.name = f.name, e.position.fromArray(f.pos), e.quaternion.fromArray(f.rotq), void 0 !== f.scl && e.scale.fromArray(f.scl);
        for (var g = 0, h = this.geometry.bones.length; h > g; ++g)f = this.geometry.bones[g], -1 !== f.parent && null !== f.parent && void 0 !== d[f.parent] ? d[f.parent].add(d[g]) : this.add(d[g])
    }
    this.normalizeSkinWeights(), this.updateMatrixWorld(!0), this.bind(new THREE.Skeleton(d, void 0, c), this.matrixWorld)
},THREE.SkinnedMesh.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {
    constructor: THREE.SkinnedMesh,
    bind: function (a, b) {
        this.skeleton = a, void 0 === b && (this.updateMatrixWorld(!0), this.skeleton.calculateInverses(), b = this.matrixWorld), this.bindMatrix.copy(b), this.bindMatrixInverse.getInverse(b)
    },
    pose: function () {
        this.skeleton.pose()
    },
    normalizeSkinWeights: function () {
        if (this.geometry instanceof THREE.Geometry)for (var a = 0; a < this.geometry.skinWeights.length; a++) {
            var b = this.geometry.skinWeights[a], c = 1 / b.lengthManhattan();
            c !== 1 / 0 ? b.multiplyScalar(c) : b.set(1, 0, 0, 0)
        } else if (this.geometry instanceof THREE.BufferGeometry)for (var d = new THREE.Vector4, e = this.geometry.attributes.skinWeight, a = 0; a < e.count; a++) {
            d.x = e.getX(a), d.y = e.getY(a), d.z = e.getZ(a), d.w = e.getW(a);
            var c = 1 / d.lengthManhattan();
            c !== 1 / 0 ? d.multiplyScalar(c) : d.set(1, 0, 0, 0), e.setXYZW(a, d.x, d.y, d.z, d.w)
        }
    },
    updateMatrixWorld: function (a) {
        THREE.Mesh.prototype.updateMatrixWorld.call(this, !0), "attached" === this.bindMode ? this.bindMatrixInverse.getInverse(this.matrixWorld) : "detached" === this.bindMode ? this.bindMatrixInverse.getInverse(this.bindMatrix) : console.warn("THREE.SkinnedMesh unrecognized bindMode: " + this.bindMode)
    },
    clone: function () {
        return new this.constructor(this.geometry, this.material, this.skeleton.useVertexTexture).copy(this)
    }
}),THREE.LOD = function () {
    THREE.Object3D.call(this), this.type = "LOD", Object.defineProperties(this, {levels: {enumerable: !0, value: []}})
},THREE.LOD.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.LOD,
    copy: function (a) {
        THREE.Object3D.prototype.copy.call(this, a, !1);
        for (var b = a.levels, c = 0, d = b.length; d > c; c++) {
            var e = b[c];
            this.addLevel(e.object.clone(), e.distance)
        }
        return this
    },
    addLevel: function (a, b) {
        void 0 === b && (b = 0), b = Math.abs(b);
        for (var c = this.levels, d = 0; d < c.length && !(b < c[d].distance); d++);
        c.splice(d, 0, {distance: b, object: a}), this.add(a)
    },
    getObjectForDistance: function (a) {
        for (var b = this.levels, c = 1, d = b.length; d > c && !(a < b[c].distance); c++);
        return b[c - 1].object
    },
    raycast: function () {
        var a = new THREE.Vector3;
        return function (b, c) {
            a.setFromMatrixPosition(this.matrixWorld);
            var d = b.ray.origin.distanceTo(a);
            this.getObjectForDistance(d).raycast(b, c)
        }
    }(),
    update: function () {
        var a = new THREE.Vector3, b = new THREE.Vector3;
        return function (c) {
            var d = this.levels;
            if (d.length > 1) {
                a.setFromMatrixPosition(c.matrixWorld), b.setFromMatrixPosition(this.matrixWorld);
                var e = a.distanceTo(b);
                d[0].object.visible = !0;
                for (var f = 1, g = d.length; g > f && e >= d[f].distance; f++)d[f - 1].object.visible = !1, d[f].object.visible = !0;
                for (; g > f; f++)d[f].object.visible = !1
            }
        }
    }(),
    toJSON: function (a) {
        var b = THREE.Object3D.prototype.toJSON.call(this, a);
        b.object.levels = [];
        for (var c = this.levels, d = 0, e = c.length; e > d; d++) {
            var f = c[d];
            b.object.levels.push({object: f.object.uuid, distance: f.distance})
        }
        return b
    }
}),THREE.Sprite = function (a) {
    THREE.Object3D.call(this), this.type = "Sprite", this.material = void 0 !== a ? a : new THREE.SpriteMaterial
},THREE.Sprite.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.Sprite,
    raycast: function () {
        var a = new THREE.Vector3;
        return function (b, c) {
            a.setFromMatrixPosition(this.matrixWorld);
            var d = b.ray.distanceSqToPoint(a), e = this.scale.x * this.scale.y / 4;
            d > e || c.push({distance: Math.sqrt(d), point: this.position, face: null, object: this})
        }
    }(),
    clone: function () {
        return new this.constructor(this.material).copy(this)
    }
}),THREE.LensFlare = function (a, b, c, d, e) {
    THREE.Object3D.call(this), this.lensFlares = [], this.positionScreen = new THREE.Vector3, this.customUpdateCallback = void 0, void 0 !== a && this.add(a, b, c, d, e)
},THREE.LensFlare.prototype = Object.assign(Object.create(THREE.Object3D.prototype), {
    constructor: THREE.LensFlare,
    copy: function (a) {
        THREE.Object3D.prototype.copy.call(this, a), this.positionScreen.copy(a.positionScreen), this.customUpdateCallback = a.customUpdateCallback;
        for (var b = 0, c = a.lensFlares.length; c > b; b++)this.lensFlares.push(a.lensFlares[b]);
        return this
    },
    add: function (a, b, c, d, e, f) {
        void 0 === b && (b = -1), void 0 === c && (c = 0), void 0 === f && (f = 1), void 0 === e && (e = new THREE.Color(16777215)), void 0 === d && (d = THREE.NormalBlending), c = Math.min(c, Math.max(0, c)), this.lensFlares.push({
            texture: a,
            size: b,
            distance: c,
            x: 0,
            y: 0,
            z: 0,
            scale: 1,
            rotation: 0,
            opacity: f,
            color: e,
            blending: d
        })
    },
    updateLensFlares: function () {
        var a, b, c = this.lensFlares.length, d = 2 * -this.positionScreen.x, e = 2 * -this.positionScreen.y;
        for (a = 0; c > a; a++)b = this.lensFlares[a], b.x = this.positionScreen.x + d * b.distance, b.y = this.positionScreen.y + e * b.distance, b.wantedRotation = b.x * Math.PI * .25, b.rotation += .25 * (b.wantedRotation - b.rotation)
    }
}),THREE.Scene = function () {
    THREE.Object3D.call(this), this.type = "Scene", this.background = null, this.fog = null, this.overrideMaterial = null, this.autoUpdate = !0
},THREE.Scene.prototype = Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.constructor = THREE.Scene,THREE.Scene.prototype.copy = function (a, b) {
    return THREE.Object3D.prototype.copy.call(this, a, b), null !== a.background && (this.background = a.background.clone()), null !== a.fog && (this.fog = a.fog.clone()), null !== a.overrideMaterial && (this.overrideMaterial = a.overrideMaterial.clone()), this.autoUpdate = a.autoUpdate, this.matrixAutoUpdate = a.matrixAutoUpdate, this
},THREE.Fog = function (a, b, c) {
    this.name = "", this.color = new THREE.Color(a), this.near = void 0 !== b ? b : 1, this.far = void 0 !== c ? c : 1e3
},THREE.Fog.prototype.clone = function () {
    return new THREE.Fog(this.color.getHex(), this.near, this.far)
},THREE.FogExp2 = function (a, b) {
    this.name = "", this.color = new THREE.Color(a), this.density = void 0 !== b ? b : 25e-5
},THREE.FogExp2.prototype.clone = function () {
    return new THREE.FogExp2(this.color.getHex(), this.density)
},THREE.ShaderChunk = {},THREE.ShaderChunk.alphamap_fragment = "#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",THREE.ShaderChunk.alphamap_pars_fragment = "#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif\n",
THREE.ShaderChunk.alphatest_fragment = "#ifdef ALPHATEST\n	if ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",THREE.ShaderChunk.aomap_fragment = "#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n	#endif\n#endif\n",THREE.ShaderChunk.aomap_pars_fragment = "#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",THREE.ShaderChunk.begin_vertex = "\nvec3 transformed = vec3( position );\n",THREE.ShaderChunk.beginnormal_vertex = "\nvec3 objectNormal = vec3( normal );\n",THREE.ShaderChunk.bsdfs = "bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n	return any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n		if( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n			float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n			float maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n			return distanceFalloff * maxDistanceCutoffFactor;\n#else\n			return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n		}\n		return 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	return 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n	float D = D_GGX( alpha, dotNH );\n	return F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n	return specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",THREE.ShaderChunk.bumpmap_pars_fragment = "#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 );\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif\n",THREE.ShaderChunk.clipping_planes_fragment = "#if NUM_CLIPPING_PLANES > 0\n	for ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n		vec4 plane = clippingPlanes[ i ];\n		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n	}\n#endif\n",THREE.ShaderChunk.clipping_planes_pars_fragment = "#if NUM_CLIPPING_PLANES > 0\n	#if ! defined( PHYSICAL ) && ! defined( PHONG )\n		varying vec3 vViewPosition;\n	#endif\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",THREE.ShaderChunk.clipping_planes_pars_vertex = "#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n	varying vec3 vViewPosition;\n#endif\n",THREE.ShaderChunk.clipping_planes_vertex = "#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n	vViewPosition = - mvPosition.xyz;\n#endif\n",THREE.ShaderChunk.color_fragment = "#ifdef USE_COLOR\n	diffuseColor.rgb *= vColor;\n#endif",THREE.ShaderChunk.color_pars_fragment = "#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif\n",THREE.ShaderChunk.color_pars_vertex = "#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif",THREE.ShaderChunk.color_vertex = "#ifdef USE_COLOR\n	vColor.xyz = color.xyz;\n#endif",THREE.ShaderChunk.common = "#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract(sin(sn) * c);\n}\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	float distance = dot( planeNormal, point - pointOnPlane );\n	return - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",THREE.ShaderChunk.cube_uv_reflection_fragment = "#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n	vec3 absDirection = abs(direction);\n	int face = -1;\n	if( absDirection.x > absDirection.z ) {\n		if(absDirection.x > absDirection.y )\n			face = direction.x > 0.0 ? 0 : 3;\n		else\n			face = direction.y > 0.0 ? 1 : 4;\n	}\n	else {\n		if(absDirection.z > absDirection.y )\n			face = direction.z > 0.0 ? 2 : 5;\n		else\n			face = direction.y > 0.0 ? 1 : 4;\n	}\n	return face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n	float scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n	float dxRoughness = dFdx(roughness);\n	float dyRoughness = dFdy(roughness);\n	vec3 dx = dFdx( vec * scale * dxRoughness );\n	vec3 dy = dFdy( vec * scale * dyRoughness );\n	float d = max( dot( dx, dx ), dot( dy, dy ) );\n	d = clamp(d, 1.0, cubeUV_rangeClamp);\n	float mipLevel = 0.5 * log2(d);\n	return vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n	mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n	float a = 16.0 * cubeUV_rcpTextureSize;\n	vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n	vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n	float powScale = exp2_packed.x * exp2_packed.y;\n	float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n	float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n	bool bRes = mipLevel == 0.0;\n	scale =  bRes && (scale < a) ? a : scale;\n	vec3 r;\n	vec2 offset;\n	int face = getFaceFromDirection(direction);\n	float rcpPowScale = 1.0 / powScale;\n	if( face == 0) {\n		r = vec3(direction.x, -direction.z, direction.y);\n		offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n	}\n	else if( face == 1) {\n		r = vec3(direction.y, direction.x, direction.z);\n		offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n	}\n	else if( face == 2) {\n		r = vec3(direction.z, direction.x, direction.y);\n		offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n	}\n	else if( face == 3) {\n		r = vec3(direction.x, direction.z, direction.y);\n		offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n	}\n	else if( face == 4) {\n		r = vec3(direction.y, direction.x, -direction.z);\n		offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n	}\n	else {\n		r = vec3(direction.z, -direction.x, direction.y);\n		offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n		offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n	}\n	r = normalize(r);\n	float texelOffset = 0.5 * cubeUV_rcpTextureSize;\n	vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n	vec2 base = offset + vec2( texelOffset );\n	return base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n	float roughnessVal = roughness* cubeUV_maxLods3;\n	float r1 = floor(roughnessVal);\n	float r2 = r1 + 1.0;\n	float t = fract(roughnessVal);\n	vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n	float s = mipInfo.y;\n	float level0 = mipInfo.x;\n	float level1 = level0 + 1.0;\n	level1 = level1 > 5.0 ? 5.0 : level1;\n	level0 += min( floor( s + 0.5 ), 5.0 );\n	vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n	vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n	vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n	vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n	vec4 result = mix(color10, color20, t);\n	return vec4(result.rgb, 1.0);\n}\n#endif\n",THREE.ShaderChunk.defaultnormal_vertex = "#ifdef FLIP_SIDED\n	objectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",THREE.ShaderChunk.displacementmap_vertex = "#ifdef USE_DISPLACEMENTMAP\n	transformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",THREE.ShaderChunk.displacementmap_pars_vertex = "#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif\n",THREE.ShaderChunk.emissivemap_fragment = "#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",THREE.ShaderChunk.emissivemap_pars_fragment = "#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif\n",THREE.ShaderChunk.encodings_pars_fragment = "\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",THREE.ShaderChunk.encodings_fragment = "  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",THREE.ShaderChunk.envmap_fragment = "#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#elif defined( ENVMAP_TYPE_EQUIREC )\n		vec2 sampleUV;\n		sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n		sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n		vec4 envColor = texture2D( envMap, sampleUV );\n	#elif defined( ENVMAP_TYPE_SPHERE )\n		vec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n	#endif\n	envColor = envMapTexelToLinear( envColor );\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_fragment = "#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n	uniform float reflectivity;\n	uniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n	#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n		varying vec3 vWorldPosition;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	uniform float flipEnvMap;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif\n",THREE.ShaderChunk.envmap_pars_vertex = "#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif\n",THREE.ShaderChunk.envmap_vertex = "#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif\n",THREE.ShaderChunk.fog_fragment = "#ifdef USE_FOG\n	#ifdef USE_LOGDEPTHBUF_EXT\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n	#else\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n	#endif\n	#ifdef FOG_EXP2\n		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",THREE.ShaderChunk.fog_pars_fragment = "#ifdef USE_FOG\n	uniform vec3 fogColor;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",THREE.ShaderChunk.lightmap_fragment = "#ifdef USE_LIGHTMAP\n	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",THREE.ShaderChunk.lightmap_pars_fragment = "#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",THREE.ShaderChunk.lights_lambert_vertex = "vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n	vLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_DIR_LIGHTS > 0\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n		vLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		#ifdef DOUBLE_SIDED\n			vLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n		#endif\n	}\n#endif\n",THREE.ShaderChunk.lights_pars = "uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	return irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		directLight.color = directionalLight.color;\n		directLight.direction = directionalLight.direction;\n		directLight.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = pointLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		if ( testLightInRange( lightDistance, pointLight.distance ) ) {\n			directLight.color = pointLight.color;\n			directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n		int shadow;\n		float shadowBias;\n		float shadowRadius;\n		vec2 shadowMapSize;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n		vec3 lVector = spotLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		float angleCos = dot( directLight.direction, spotLight.direction );\n		if ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n			directLight.color = spotLight.color;\n			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n		float dotNL = dot( geometry.normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			irradiance *= PI;\n		#endif\n		return irradiance;\n	}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n		#include <normal_flip>\n		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			vec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n		#else\n			vec4 envMapColor = vec4( 0.0 );\n		#endif\n		return PI * envMapColor.rgb * envMapIntensity;\n	}\n	float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n		float maxMIPLevelScalar = float( maxMIPLevel );\n		float desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n	}\n	vec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n		#else\n			vec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n		#endif\n		#include <normal_flip>\n		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n		float specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			vec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n		#elif defined( ENVMAP_TYPE_EQUIREC )\n			vec2 sampleUV;\n			sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n			sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n			#else\n				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_SPHERE )\n			vec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n			#else\n				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#endif\n		return envMapColor.rgb * envMapIntensity;\n	}\n#endif\n",THREE.ShaderChunk.lights_phong_fragment = "BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",THREE.ShaderChunk.lights_phong_pars_fragment = "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n	vec3	diffuseColor;\n	vec3	specularColor;\n	float	specularShininess;\n	float	specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )	(0)\n",THREE.ShaderChunk.lights_physical_fragment = "PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n	material.clearCoat = saturate( clearCoat );	material.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",THREE.ShaderChunk.lights_physical_pars_fragment = "struct PhysicalMaterial {\n	vec3	diffuseColor;\n	float	specularRoughness;\n	vec3	specularColor;\n	#ifndef STANDARD\n		float clearCoat;\n		float clearCoatRoughness;\n	#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	#ifndef STANDARD\n		reflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n	#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n	#ifndef STANDARD\n		reflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n	#endif\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
THREE.ShaderChunk.lights_template = "\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointDirectLightIrradiance( pointLight, geometry, directLight );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotDirectLightIrradiance( spotLight, geometry, directLight );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n		#ifdef USE_SHADOWMAP\n		directLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#ifdef USE_LIGHTMAP\n		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			lightMapIrradiance *= PI;\n		#endif\n		irradiance += lightMapIrradiance;\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		}\n	#endif\n	#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n	 	irradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n	#endif\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	vec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n	#ifndef STANDARD\n		vec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n	#else\n		vec3 clearCoatRadiance = vec3( 0.0 );\n	#endif\n		\n	RE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",THREE.ShaderChunk.logdepthbuf_fragment = "#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",THREE.ShaderChunk.logdepthbuf_pars_fragment = "#ifdef USE_LOGDEPTHBUF\n	uniform float logDepthBufFC;\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n	#endif\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_vertex = "#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n	#endif\n	uniform float logDepthBufFC;\n#endif",THREE.ShaderChunk.logdepthbuf_vertex = "#ifdef USE_LOGDEPTHBUF\n	gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n	#else\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n	#endif\n#endif\n",THREE.ShaderChunk.map_fragment = "#ifdef USE_MAP\n	vec4 texelColor = texture2D( map, vUv );\n	texelColor = mapTexelToLinear( texelColor );\n	diffuseColor *= texelColor;\n#endif\n",THREE.ShaderChunk.map_pars_fragment = "#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n",THREE.ShaderChunk.map_particle_fragment = "#ifdef USE_MAP\n	vec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n	diffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",THREE.ShaderChunk.map_particle_pars_fragment = "#ifdef USE_MAP\n	uniform vec4 offsetRepeat;\n	uniform sampler2D map;\n#endif\n",THREE.ShaderChunk.metalnessmap_fragment = "float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vUv );\n	metalnessFactor *= texelMetalness.r;\n#endif\n",THREE.ShaderChunk.metalnessmap_pars_fragment = "#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",THREE.ShaderChunk.morphnormal_vertex = "#ifdef USE_MORPHNORMALS\n	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",THREE.ShaderChunk.morphtarget_pars_vertex = "#ifdef USE_MORPHTARGETS\n	#ifndef USE_MORPHNORMALS\n	uniform float morphTargetInfluences[ 8 ];\n	#else\n	uniform float morphTargetInfluences[ 4 ];\n	#endif\n#endif",THREE.ShaderChunk.morphtarget_vertex = "#ifdef USE_MORPHTARGETS\n	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n	#ifndef USE_MORPHNORMALS\n	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n	#endif\n#endif\n",THREE.ShaderChunk.normal_flip = "#ifdef DOUBLE_SIDED\n	float flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n	float flipNormal = 1.0;\n#endif\n",THREE.ShaderChunk.normal_fragment = "#ifdef FLAT_SHADED\n	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",THREE.ShaderChunk.normalmap_pars_fragment = "#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n	}\n#endif\n",THREE.ShaderChunk.packing = "vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",THREE.ShaderChunk.premultiplied_alpha_fragment = "#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",THREE.ShaderChunk.project_vertex = "#ifdef USE_SKINNING\n	vec4 mvPosition = modelViewMatrix * skinned;\n#else\n	vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",THREE.ShaderChunk.roughnessmap_fragment = "float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vUv );\n	roughnessFactor *= texelRoughness.r;\n#endif\n",THREE.ShaderChunk.roughnessmap_pars_fragment = "#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",THREE.ShaderChunk.shadowmap_pars_fragment = "#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n		const vec2 offset = vec2( 0.0, 1.0 );\n		vec2 texelSize = vec2( 1.0 ) / size;\n		vec2 centroidUV = floor( uv * size + 0.5 ) / size;\n		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n		vec2 f = fract( uv * size + 0.5 );\n		float a = mix( lb, lt, f.y );\n		float b = mix( rb, rt, f.y );\n		float c = mix( a, b, f.x );\n		return c;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n		bool frustumTest = all( frustumTestVec );\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			return (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			return (\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return 1.0;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		vec3 bd3D = normalize( lightToPosition );\n		float dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif\n",THREE.ShaderChunk.shadowmap_pars_vertex = "#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n	#endif\n#endif\n",THREE.ShaderChunk.shadowmap_vertex = "#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n	}\n	#endif\n#endif\n",THREE.ShaderChunk.shadowmask_pars_fragment = "float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHTS > 0\n	DirectionalLight directionalLight;\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		shadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#if NUM_SPOT_LIGHTS > 0\n	SpotLight spotLight;\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		shadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#if NUM_POINT_LIGHTS > 0\n	PointLight pointLight;\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		shadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n	}\n	#endif\n	#endif\n	return shadow;\n}\n",THREE.ShaderChunk.skinbase_vertex = "#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",THREE.ShaderChunk.skinning_pars_vertex = "#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	#ifdef BONE_TEXTURE\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n		mat4 getBoneMatrix( const in float i ) {\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n			y = dy * ( y + 0.5 );\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n			mat4 bone = mat4( v1, v2, v3, v4 );\n			return bone;\n		}\n	#else\n		uniform mat4 boneMatrices[ MAX_BONES ];\n		mat4 getBoneMatrix( const in float i ) {\n			mat4 bone = boneMatrices[ int(i) ];\n			return bone;\n		}\n	#endif\n#endif\n",THREE.ShaderChunk.skinning_vertex = "#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n#endif\n",THREE.ShaderChunk.skinnormal_vertex = "#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",THREE.ShaderChunk.specularmap_fragment = "float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",THREE.ShaderChunk.specularmap_pars_fragment = "#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",THREE.ShaderChunk.tonemapping_fragment = "#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",THREE.ShaderChunk.tonemapping_pars_fragment = "#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",THREE.ShaderChunk.uv2_pars_fragment = "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	varying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_pars_vertex = "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n#endif",THREE.ShaderChunk.uv2_vertex = "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	vUv2 = uv2;\n#endif",THREE.ShaderChunk.uv_pars_fragment = "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	varying vec2 vUv;\n#endif",THREE.ShaderChunk.uv_pars_vertex = "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n#endif\n",THREE.ShaderChunk.uv_vertex = "#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",THREE.ShaderChunk.worldpos_vertex = "#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n	#ifdef USE_SKINNING\n		vec4 worldPosition = modelMatrix * skinned;\n	#else\n		vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n	#endif\n#endif\n",THREE.UniformsUtils = {
    merge: function (a) {
        for (var b = {}, c = 0; c < a.length; c++) {
            var d = this.clone(a[c]);
            for (var e in d)b[e] = d[e]
        }
        return b
    }, clone: function (a) {
        var b = {};
        for (var c in a) {
            b[c] = {};
            for (var d in a[c]) {
                var e = a[c][d];
                e instanceof THREE.Color || e instanceof THREE.Vector2 || e instanceof THREE.Vector3 || e instanceof THREE.Vector4 || e instanceof THREE.Matrix3 || e instanceof THREE.Matrix4 || e instanceof THREE.Texture ? b[c][d] = e.clone() : Array.isArray(e) ? b[c][d] = e.slice() : b[c][d] = e
            }
        }
        return b
    }
},THREE.UniformsLib = {
    common: {
        diffuse: {value: new THREE.Color(15658734)},
        opacity: {value: 1},
        map: {value: null},
        offsetRepeat: {value: new THREE.Vector4(0, 0, 1, 1)},
        specularMap: {value: null},
        alphaMap: {value: null},
        envMap: {value: null},
        flipEnvMap: {value: -1},
        reflectivity: {value: 1},
        refractionRatio: {value: .98}
    },
    aomap: {aoMap: {value: null}, aoMapIntensity: {value: 1}},
    lightmap: {lightMap: {value: null}, lightMapIntensity: {value: 1}},
    emissivemap: {emissiveMap: {value: null}},
    bumpmap: {bumpMap: {value: null}, bumpScale: {value: 1}},
    normalmap: {normalMap: {value: null}, normalScale: {value: new THREE.Vector2(1, 1)}},
    displacementmap: {displacementMap: {value: null}, displacementScale: {value: 1}, displacementBias: {value: 0}},
    roughnessmap: {roughnessMap: {value: null}},
    metalnessmap: {metalnessMap: {value: null}},
    fog: {
        fogDensity: {value: 25e-5},
        fogNear: {value: 1},
        fogFar: {value: 2e3},
        fogColor: {value: new THREE.Color(16777215)}
    },
    lights: {
        ambientLightColor: {value: []},
        directionalLights: {
            value: [],
            properties: {direction: {}, color: {}, shadow: {}, shadowBias: {}, shadowRadius: {}, shadowMapSize: {}}
        },
        directionalShadowMap: {value: []},
        directionalShadowMatrix: {value: []},
        spotLights: {
            value: [],
            properties: {
                color: {},
                position: {},
                direction: {},
                distance: {},
                coneCos: {},
                penumbraCos: {},
                decay: {},
                shadow: {},
                shadowBias: {},
                shadowRadius: {},
                shadowMapSize: {}
            }
        },
        spotShadowMap: {value: []},
        spotShadowMatrix: {value: []},
        pointLights: {
            value: [],
            properties: {
                color: {},
                position: {},
                decay: {},
                distance: {},
                shadow: {},
                shadowBias: {},
                shadowRadius: {},
                shadowMapSize: {}
            }
        },
        pointShadowMap: {value: []},
        pointShadowMatrix: {value: []},
        hemisphereLights: {value: [], properties: {direction: {}, skyColor: {}, groundColor: {}}}
    },
    points: {
        diffuse: {value: new THREE.Color(15658734)},
        opacity: {value: 1},
        size: {value: 1},
        scale: {value: 1},
        map: {value: null},
        offsetRepeat: {value: new THREE.Vector4(0, 0, 1, 1)}
    }
},THREE.ShaderChunk.cube_frag = "uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n	#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.cube_vert = "varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vWorldPosition = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.depth_frag = "#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <logdepthbuf_fragment>\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n	#endif\n}\n",THREE.ShaderChunk.depth_vert = "#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.distanceRGBA_frag = "uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	gl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",THREE.ShaderChunk.distanceRGBA_vert = "varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <skinbase_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition;\n}\n",THREE.ShaderChunk.equirect_frag = "uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 direction = normalize( vWorldPosition );\n	vec2 sampleUV;\n	sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.equirect_vert = "varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vWorldPosition = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.linedashed_frag = "uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",THREE.ShaderChunk.linedashed_vert = "uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	vLineDistance = scale * lineDistance;\n	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.meshbasic_frag = "uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight;\n	reflectedLight.directDiffuse = vec3( 0.0 );\n	reflectedLight.directSpecular = vec3( 0.0 );\n	reflectedLight.indirectDiffuse = diffuseColor.rgb;\n	reflectedLight.indirectSpecular = vec3( 0.0 );\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <normal_flip>\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",
THREE.ShaderChunk.meshbasic_vert = "#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_ENVMAP\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	#include <envmap_vertex>\n}\n",THREE.ShaderChunk.meshlambert_frag = "uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <emissivemap_fragment>\n	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n	#include <lightmap_fragment>\n	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n	#ifdef DOUBLE_SIDED\n		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n	#else\n		reflectedLight.directDiffuse = vLightFront;\n	#endif\n	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <normal_flip>\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshlambert_vert = "#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_lambert_vertex>\n	#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.meshphong_frag = "#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <normal_flip>\n	#include <normal_fragment>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_template>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshphong_vert = "#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.meshphysical_frag = "#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n	uniform float clearCoat;\n	uniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_flip>\n	#include <normal_fragment>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_template>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",THREE.ShaderChunk.meshphysical_vert = "#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <displacementmap_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.normal_frag = "uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	gl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n	#include <logdepthbuf_fragment>\n}\n",THREE.ShaderChunk.normal_vert = "varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vNormal = normalize( normalMatrix * normal );\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n}\n",THREE.ShaderChunk.points_frag = "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <premultiplied_alpha_fragment>\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}\n",THREE.ShaderChunk.points_vert = "uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <project_vertex>\n	#ifdef USE_SIZEATTENUATION\n		gl_PointSize = size * ( scale / - mvPosition.z );\n	#else\n		gl_PointSize = size;\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",THREE.ShaderChunk.shadow_frag = "uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	gl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",THREE.ShaderChunk.shadow_vert = "#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n}\n",THREE.ShaderLib = {
    basic: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.aomap, THREE.UniformsLib.fog]),
        vertexShader: THREE.ShaderChunk.meshbasic_vert,
        fragmentShader: THREE.ShaderChunk.meshbasic_frag
    },
    lambert: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.aomap, THREE.UniformsLib.lightmap, THREE.UniformsLib.emissivemap, THREE.UniformsLib.fog, THREE.UniformsLib.lights, {emissive: {value: new THREE.Color(0)}}]),
        vertexShader: THREE.ShaderChunk.meshlambert_vert,
        fragmentShader: THREE.ShaderChunk.meshlambert_frag
    },
    phong: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.aomap, THREE.UniformsLib.lightmap, THREE.UniformsLib.emissivemap, THREE.UniformsLib.bumpmap, THREE.UniformsLib.normalmap, THREE.UniformsLib.displacementmap, THREE.UniformsLib.fog, THREE.UniformsLib.lights, {
            emissive: {value: new THREE.Color(0)},
            specular: {value: new THREE.Color(1118481)},
            shininess: {value: 30}
        }]), vertexShader: THREE.ShaderChunk.meshphong_vert, fragmentShader: THREE.ShaderChunk.meshphong_frag
    },
    standard: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.aomap, THREE.UniformsLib.lightmap, THREE.UniformsLib.emissivemap, THREE.UniformsLib.bumpmap, THREE.UniformsLib.normalmap, THREE.UniformsLib.displacementmap, THREE.UniformsLib.roughnessmap, THREE.UniformsLib.metalnessmap, THREE.UniformsLib.fog, THREE.UniformsLib.lights, {
            emissive: {value: new THREE.Color(0)},
            roughness: {value: .5},
            metalness: {value: 0},
            envMapIntensity: {value: 1}
        }]), vertexShader: THREE.ShaderChunk.meshphysical_vert, fragmentShader: THREE.ShaderChunk.meshphysical_frag
    },
    points: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.points, THREE.UniformsLib.fog]),
        vertexShader: THREE.ShaderChunk.points_vert,
        fragmentShader: THREE.ShaderChunk.points_frag
    },
    dashed: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.fog, {
            scale: {value: 1},
            dashSize: {value: 1},
            totalSize: {value: 2}
        }]), vertexShader: THREE.ShaderChunk.linedashed_vert, fragmentShader: THREE.ShaderChunk.linedashed_frag
    },
    depth: {
        uniforms: THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.displacementmap]),
        vertexShader: THREE.ShaderChunk.depth_vert,
        fragmentShader: THREE.ShaderChunk.depth_frag
    },
    normal: {
        uniforms: {opacity: {value: 1}},
        vertexShader: THREE.ShaderChunk.normal_vert,
        fragmentShader: THREE.ShaderChunk.normal_frag
    },
    cube: {
        uniforms: {tCube: {value: null}, tFlip: {value: -1}},
        vertexShader: THREE.ShaderChunk.cube_vert,
        fragmentShader: THREE.ShaderChunk.cube_frag
    },
    equirect: {
        uniforms: {tEquirect: {value: null}, tFlip: {value: -1}},
        vertexShader: THREE.ShaderChunk.equirect_vert,
        fragmentShader: THREE.ShaderChunk.equirect_frag
    },
    distanceRGBA: {
        uniforms: {lightPos: {value: new THREE.Vector3}},
        vertexShader: THREE.ShaderChunk.distanceRGBA_vert,
        fragmentShader: THREE.ShaderChunk.distanceRGBA_frag
    }
},THREE.ShaderLib.physical = {
    uniforms: THREE.UniformsUtils.merge([THREE.ShaderLib.standard.uniforms, {
        clearCoat: {value: 0},
        clearCoatRoughness: {value: 0}
    }]), vertexShader: THREE.ShaderChunk.meshphysical_vert, fragmentShader: THREE.ShaderChunk.meshphysical_frag
},THREE.WebGLRenderer = function (a) {
    function b() {
        return null === aa ? na : 1
    }

    function c(a, b, c, d) {
        Q === !0 && (a *= d, b *= d, c *= d), Fa.clearColor(a, b, c, d)
    }

    function d() {
        Fa.init(), Fa.scissor(fa.copy(oa).multiplyScalar(na)), Fa.viewport(ha.copy(qa).multiplyScalar(na)), c(ja.r, ja.g, ja.b, ka)
    }

    function e() {
        _ = null, ea = null, da = "", ca = -1, Fa.reset()
    }

    function f(a) {
        a.preventDefault(), e(), d(), Ga.clear()
    }

    function g(a) {
        var b = a.target;
        b.removeEventListener("dispose", g), h(b)
    }

    function h(a) {
        i(a), Ga["delete"](a)
    }

    function i(a) {
        var b = Ga.get(a).program;
        a.program = void 0, void 0 !== b && Ja.releaseProgram(b)
    }

    function j(a, b, c, d) {
        var e;
        if (c instanceof THREE.InstancedBufferGeometry && (e = Da.get("ANGLE_instanced_arrays"), null === e))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
        void 0 === d && (d = 0), Fa.initAttributes();
        var f = c.attributes, g = b.getAttributes(), h = a.defaultAttributeValues;
        for (var i in g) {
            var j = g[i];
            if (j >= 0) {
                var k = f[i];
                if (void 0 !== k) {
                    var l = Aa.FLOAT, m = k.array, n = k.normalized;
                    m instanceof Float32Array ? l = Aa.FLOAT : m instanceof Float64Array ? console.warn("Unsupported data buffer format: Float64Array") : m instanceof Uint16Array ? l = Aa.UNSIGNED_SHORT : m instanceof Int16Array ? l = Aa.SHORT : m instanceof Uint32Array ? l = Aa.UNSIGNED_INT : m instanceof Int32Array ? l = Aa.INT : m instanceof Int8Array ? l = Aa.BYTE : m instanceof Uint8Array && (l = Aa.UNSIGNED_BYTE);
                    var o = k.itemSize, p = Ia.getAttributeBuffer(k);
                    if (k instanceof THREE.InterleavedBufferAttribute) {
                        var q = k.data, r = q.stride, s = k.offset;
                        q instanceof THREE.InstancedInterleavedBuffer ? (Fa.enableAttributeAndDivisor(j, q.meshPerAttribute, e), void 0 === c.maxInstancedCount && (c.maxInstancedCount = q.meshPerAttribute * q.count)) : Fa.enableAttribute(j), Aa.bindBuffer(Aa.ARRAY_BUFFER, p), Aa.vertexAttribPointer(j, o, l, n, r * q.array.BYTES_PER_ELEMENT, (d * r + s) * q.array.BYTES_PER_ELEMENT)
                    } else k instanceof THREE.InstancedBufferAttribute ? (Fa.enableAttributeAndDivisor(j, k.meshPerAttribute, e), void 0 === c.maxInstancedCount && (c.maxInstancedCount = k.meshPerAttribute * k.count)) : Fa.enableAttribute(j), Aa.bindBuffer(Aa.ARRAY_BUFFER, p), Aa.vertexAttribPointer(j, o, l, n, 0, d * o * k.array.BYTES_PER_ELEMENT)
                } else if (void 0 !== h) {
                    var t = h[i];
                    if (void 0 !== t)switch (t.length) {
                        case 2:
                            Aa.vertexAttrib2fv(j, t);
                            break;
                        case 3:
                            Aa.vertexAttrib3fv(j, t);
                            break;
                        case 4:
                            Aa.vertexAttrib4fv(j, t);
                            break;
                        default:
                            Aa.vertexAttrib1fv(j, t)
                    }
                }
            }
        }
        Fa.disableUnusedAttributes()
    }

    function k(a, b) {
        return Math.abs(b[0]) - Math.abs(a[0])
    }

    function l(a, b) {
        return a.object.renderOrder !== b.object.renderOrder ? a.object.renderOrder - b.object.renderOrder : a.material.id !== b.material.id ? a.material.id - b.material.id : a.z !== b.z ? a.z - b.z : a.id - b.id
    }

    function m(a, b) {
        return a.object.renderOrder !== b.object.renderOrder ? a.object.renderOrder - b.object.renderOrder : a.z !== b.z ? b.z - a.z : a.id - b.id
    }

    function n(a, b, c, d, e) {
        var f, g;
        c.transparent ? (f = V, g = ++W) : (f = T, g = ++U);
        var h = f[g];
        void 0 !== h ? (h.id = a.id, h.object = a, h.geometry = b, h.material = c, h.z = xa.z, h.group = e) : (h = {
            id: a.id,
            object: a,
            geometry: b,
            material: c,
            z: xa.z,
            group: e
        }, f.push(h))
    }

    function o(a) {
        var b = a.geometry;
        return null === b.boundingSphere && b.computeBoundingSphere(), va.copy(b.boundingSphere).applyMatrix4(a.matrixWorld), q(va)
    }

    function p(a) {
        return va.center.set(0, 0, 0), va.radius = .7071067811865476, va.applyMatrix4(a.matrixWorld), q(va)
    }

    function q(a) {
        if (!ra.intersectsSphere(a))return !1;
        var b = sa.numPlanes;
        if (0 === b)return !0;
        var c = $.clippingPlanes, d = a.center, e = -a.radius, f = 0;
        do if (c[f].distanceToPoint(d) < e)return !1; while (++f !== b);
        return !0
    }

    function r(a, b) {
        if (a.visible !== !1) {
            if (a.layers.test(b.layers))if (a instanceof THREE.Light)S.push(a); else if (a instanceof THREE.Sprite)(a.frustumCulled === !1 || p(a) === !0) && Y.push(a); else if (a instanceof THREE.LensFlare)Z.push(a); else if (a instanceof THREE.ImmediateRenderObject)$.sortObjects === !0 && (xa.setFromMatrixPosition(a.matrixWorld), xa.applyProjection(wa)), n(a, null, a.material, xa.z, null); else if ((a instanceof THREE.Mesh || a instanceof THREE.Line || a instanceof THREE.Points) && (a instanceof THREE.SkinnedMesh && a.skeleton.update(), a.frustumCulled === !1 || o(a) === !0)) {
                var c = a.material;
                if (c.visible === !0) {
                    $.sortObjects === !0 && (xa.setFromMatrixPosition(a.matrixWorld), xa.applyProjection(wa));
                    var d = Ia.update(a);
                    if (c instanceof THREE.MultiMaterial)for (var e = d.groups, f = c.materials, g = 0, h = e.length; h > g; g++) {
                        var i = e[g], j = f[i.materialIndex];
                        j.visible === !0 && n(a, d, j, xa.z, i)
                    } else n(a, d, c, xa.z, null)
                }
            }
            for (var k = a.children, g = 0, h = k.length; h > g; g++)r(k[g], b)
        }
    }

    function s(a, b, c, d) {
        for (var e = 0, f = a.length; f > e; e++) {
            var g = a[e], h = g.object, i = g.geometry, j = void 0 === d ? g.material : d, k = g.group;
            if (h.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse, h.matrixWorld), h.normalMatrix.getNormalMatrix(h.modelViewMatrix), h instanceof THREE.ImmediateRenderObject) {
                u(j);
                var l = v(b, c, j, h);
                da = "", h.render(function (a) {
                    $.renderBufferImmediate(a, l, j)
                })
            } else $.renderBufferDirect(b, c, i, j, h, k)
        }
    }

    function t(a, b, c) {
        var d = Ga.get(a), e = Ja.getParameters(a, ya, b, sa.numPlanes, c), f = Ja.getProgramCode(a, e), h = d.program, j = !0;
        if (void 0 === h)a.addEventListener("dispose", g); else if (h.code !== f)i(a); else {
            if (void 0 !== e.shaderID)return;
            j = !1
        }
        if (j) {
            if (e.shaderID) {
                var k = THREE.ShaderLib[e.shaderID];
                d.__webglShader = {
                    name: a.type,
                    uniforms: THREE.UniformsUtils.clone(k.uniforms),
                    vertexShader: k.vertexShader,
                    fragmentShader: k.fragmentShader
                }
            } else d.__webglShader = {
                name: a.type,
                uniforms: a.uniforms,
                vertexShader: a.vertexShader,
                fragmentShader: a.fragmentShader
            };
            a.__webglShader = d.__webglShader, h = Ja.acquireProgram(a, e, f), d.program = h, a.program = h
        }
        var l = h.getAttributes();
        if (a.morphTargets) {
            a.numSupportedMorphTargets = 0;
            for (var m = 0; m < $.maxMorphTargets; m++)l["morphTarget" + m] >= 0 && a.numSupportedMorphTargets++
        }
        if (a.morphNormals) {
            a.numSupportedMorphNormals = 0;
            for (var m = 0; m < $.maxMorphNormals; m++)l["morphNormal" + m] >= 0 && a.numSupportedMorphNormals++
        }
        var n = d.__webglShader.uniforms;
        (a instanceof THREE.ShaderMaterial || a instanceof THREE.RawShaderMaterial) && a.clipping !== !0 || (d.numClippingPlanes = sa.numPlanes, n.clippingPlanes = sa.uniform), a.lights && (d.lightsHash = ya.hash, n.ambientLightColor.value = ya.ambient, n.directionalLights.value = ya.directional, n.spotLights.value = ya.spot, n.pointLights.value = ya.point, n.hemisphereLights.value = ya.hemi, n.directionalShadowMap.value = ya.directionalShadowMap, n.directionalShadowMatrix.value = ya.directionalShadowMatrix, n.spotShadowMap.value = ya.spotShadowMap, n.spotShadowMatrix.value = ya.spotShadowMatrix, n.pointShadowMap.value = ya.pointShadowMap, n.pointShadowMatrix.value = ya.pointShadowMatrix);
        var o = d.program.getUniforms(), p = THREE.WebGLUniforms.seqWithValue(o.seq, n);
        d.uniformsList = p, d.dynamicUniforms = THREE.WebGLUniforms.splitDynamic(p, n)
    }

    function u(a) {
        a.side !== THREE.DoubleSide ? Fa.enable(Aa.CULL_FACE) : Fa.disable(Aa.CULL_FACE), Fa.setFlipSided(a.side === THREE.BackSide), a.transparent === !0 ? Fa.setBlending(a.blending, a.blendEquation, a.blendSrc, a.blendDst, a.blendEquationAlpha, a.blendSrcAlpha, a.blendDstAlpha, a.premultipliedAlpha) : Fa.setBlending(THREE.NoBlending), Fa.setDepthFunc(a.depthFunc), Fa.setDepthTest(a.depthTest), Fa.setDepthWrite(a.depthWrite), Fa.setColorWrite(a.colorWrite), Fa.setPolygonOffset(a.polygonOffset, a.polygonOffsetFactor, a.polygonOffsetUnits)
    }

    function v(a, b, c, d) {
        ia = 0;
        var e = Ga.get(c);
        if (ta) {
            if (ua || a !== ea) {
                var f = a === ea && c.id === ca;
                sa.setState(c.clippingPlanes, c.clipShadows, a, e, f)
            }
            void 0 !== e.numClippingPlanes && e.numClippingPlanes !== sa.numPlanes && (c.needsUpdate = !0)
        }
        void 0 === e.program && (c.needsUpdate = !0), void 0 !== e.lightsHash && e.lightsHash !== ya.hash && (c.needsUpdate = !0), c.needsUpdate && (t(c, b, d), c.needsUpdate = !1);
        var g = !1, h = !1, i = !1, j = e.program, k = j.getUniforms(), l = e.__webglShader.uniforms;
        if (j.id !== _ && (Aa.useProgram(j.program), _ = j.id, g = !0, h = !0, i = !0), c.id !== ca && (ca = c.id, h = !0), g || a !== ea) {
            if (k.set(Aa, a, "projectionMatrix"), Ea.logarithmicDepthBuffer && k.setValue(Aa, "logDepthBufFC", 2 / (Math.log(a.far + 1) / Math.LN2)), a !== ea && (ea = a, h = !0, i = !0), c instanceof THREE.ShaderMaterial || c instanceof THREE.MeshPhongMaterial || c instanceof THREE.MeshStandardMaterial || c.envMap) {
                var m = k.map.cameraPosition;
                void 0 !== m && m.setValue(Aa, xa.setFromMatrixPosition(a.matrixWorld))
            }
            (c instanceof THREE.MeshPhongMaterial || c instanceof THREE.MeshLambertMaterial || c instanceof THREE.MeshBasicMaterial || c instanceof THREE.MeshStandardMaterial || c instanceof THREE.ShaderMaterial || c.skinning) && k.setValue(Aa, "viewMatrix", a.matrixWorldInverse), k.set(Aa, $, "toneMappingExposure"), k.set(Aa, $, "toneMappingWhitePoint")
        }
        if (c.skinning) {
            k.setOptional(Aa, d, "bindMatrix"), k.setOptional(Aa, d, "bindMatrixInverse");
            var n = d.skeleton;
            n && (Ea.floatVertexTextures && n.useVertexTexture ? (k.set(Aa, n, "boneTexture"), k.set(Aa, n, "boneTextureWidth"), k.set(Aa, n, "boneTextureHeight")) : k.setOptional(Aa, n, "boneMatrices"))
        }
        h && (c.lights && F(l, i), b && c.fog && A(l, b), (c instanceof THREE.MeshBasicMaterial || c instanceof THREE.MeshLambertMaterial || c instanceof THREE.MeshPhongMaterial || c instanceof THREE.MeshStandardMaterial || c instanceof THREE.MeshDepthMaterial) && w(l, c), c instanceof THREE.LineBasicMaterial ? x(l, c) : c instanceof THREE.LineDashedMaterial ? (x(l, c), y(l, c)) : c instanceof THREE.PointsMaterial ? z(l, c) : c instanceof THREE.MeshLambertMaterial ? B(l, c) : c instanceof THREE.MeshPhongMaterial ? C(l, c) : c instanceof THREE.MeshPhysicalMaterial ? E(l, c) : c instanceof THREE.MeshStandardMaterial ? D(l, c) : c instanceof THREE.MeshDepthMaterial ? c.displacementMap && (l.displacementMap.value = c.displacementMap, l.displacementScale.value = c.displacementScale, l.displacementBias.value = c.displacementBias) : c instanceof THREE.MeshNormalMaterial && (l.opacity.value = c.opacity), THREE.WebGLUniforms.upload(Aa, e.uniformsList, l, $)), k.set(Aa, d, "modelViewMatrix"), k.set(Aa, d, "normalMatrix"), k.setValue(Aa, "modelMatrix", d.matrixWorld);
        var o = e.dynamicUniforms;
        return null !== o && (THREE.WebGLUniforms.evalDynamic(o, l, d, a), THREE.WebGLUniforms.upload(Aa, o, l, $)), j
    }

    function w(a, b) {
        a.opacity.value = b.opacity, a.diffuse.value = b.color, b.emissive && a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity), a.map.value = b.map, a.specularMap.value = b.specularMap, a.alphaMap.value = b.alphaMap, b.aoMap && (a.aoMap.value = b.aoMap, a.aoMapIntensity.value = b.aoMapIntensity);
        var c;
        if (b.map ? c = b.map : b.specularMap ? c = b.specularMap : b.displacementMap ? c = b.displacementMap : b.normalMap ? c = b.normalMap : b.bumpMap ? c = b.bumpMap : b.roughnessMap ? c = b.roughnessMap : b.metalnessMap ? c = b.metalnessMap : b.alphaMap ? c = b.alphaMap : b.emissiveMap && (c = b.emissiveMap), void 0 !== c) {
            c instanceof THREE.WebGLRenderTarget && (c = c.texture);
            var d = c.offset, e = c.repeat;
            a.offsetRepeat.value.set(d.x, d.y, e.x, e.y)
        }
        a.envMap.value = b.envMap, a.flipEnvMap.value = b.envMap instanceof THREE.CubeTexture ? -1 : 1, a.reflectivity.value = b.reflectivity, a.refractionRatio.value = b.refractionRatio
    }

    function x(a, b) {
        a.diffuse.value = b.color, a.opacity.value = b.opacity
    }

    function y(a, b) {
        a.dashSize.value = b.dashSize, a.totalSize.value = b.dashSize + b.gapSize, a.scale.value = b.scale
    }

    function z(a, b) {
        if (a.diffuse.value = b.color, a.opacity.value = b.opacity, a.size.value = b.size * na, a.scale.value = .5 * K.clientHeight, a.map.value = b.map, null !== b.map) {
            var c = b.map.offset, d = b.map.repeat;
            a.offsetRepeat.value.set(c.x, c.y, d.x, d.y)
        }
    }

    function A(a, b) {
        a.fogColor.value = b.color, b instanceof THREE.Fog ? (a.fogNear.value = b.near, a.fogFar.value = b.far) : b instanceof THREE.FogExp2 && (a.fogDensity.value = b.density)
    }

    function B(a, b) {
        b.lightMap && (a.lightMap.value = b.lightMap, a.lightMapIntensity.value = b.lightMapIntensity), b.emissiveMap && (a.emissiveMap.value = b.emissiveMap)
    }

    function C(a, b) {
        a.specular.value = b.specular, a.shininess.value = Math.max(b.shininess, 1e-4), b.lightMap && (a.lightMap.value = b.lightMap, a.lightMapIntensity.value = b.lightMapIntensity), b.emissiveMap && (a.emissiveMap.value = b.emissiveMap), b.bumpMap && (a.bumpMap.value = b.bumpMap, a.bumpScale.value = b.bumpScale), b.normalMap && (a.normalMap.value = b.normalMap, a.normalScale.value.copy(b.normalScale)), b.displacementMap && (a.displacementMap.value = b.displacementMap, a.displacementScale.value = b.displacementScale, a.displacementBias.value = b.displacementBias)
    }

    function D(a, b) {
        a.roughness.value = b.roughness, a.metalness.value = b.metalness, b.roughnessMap && (a.roughnessMap.value = b.roughnessMap), b.metalnessMap && (a.metalnessMap.value = b.metalnessMap), b.lightMap && (a.lightMap.value = b.lightMap, a.lightMapIntensity.value = b.lightMapIntensity), b.emissiveMap && (a.emissiveMap.value = b.emissiveMap), b.bumpMap && (a.bumpMap.value = b.bumpMap, a.bumpScale.value = b.bumpScale), b.normalMap && (a.normalMap.value = b.normalMap, a.normalScale.value.copy(b.normalScale)), b.displacementMap && (a.displacementMap.value = b.displacementMap, a.displacementScale.value = b.displacementScale, a.displacementBias.value = b.displacementBias), b.envMap && (a.envMapIntensity.value = b.envMapIntensity)
    }

    function E(a, b) {
        a.clearCoat.value = b.clearCoat, a.clearCoatRoughness.value = b.clearCoatRoughness, D(a, b)
    }

    function F(a, b) {
        a.ambientLightColor.needsUpdate = b, a.directionalLights.needsUpdate = b, a.pointLights.needsUpdate = b, a.spotLights.needsUpdate = b, a.hemisphereLights.needsUpdate = b
    }

    function G(a) {
        for (var b = 0, c = 0, d = a.length; d > c; c++) {
            var e = a[c];
            e.castShadow && (ya.shadows[b++] = e)
        }
        ya.shadows.length = b
    }

    function H(a, b) {
        var c, d, e, f, g, h, i, j = 0, k = 0, l = 0, m = b.matrixWorldInverse, n = 0, o = 0, p = 0, q = 0;
        for (c = 0, d = a.length; d > c; c++)if (e = a[c], f = e.color, g = e.intensity, h = e.distance, i = e.shadow && e.shadow.map ? e.shadow.map.texture : null, e instanceof THREE.AmbientLight)j += f.r * g, k += f.g * g, l += f.b * g; else if (e instanceof THREE.DirectionalLight) {
            var r = Ka.get(e);
            r.color.copy(e.color).multiplyScalar(e.intensity), r.direction.setFromMatrixPosition(e.matrixWorld), xa.setFromMatrixPosition(e.target.matrixWorld), r.direction.sub(xa), r.direction.transformDirection(m), r.shadow = e.castShadow, e.castShadow && (r.shadowBias = e.shadow.bias, r.shadowRadius = e.shadow.radius, r.shadowMapSize = e.shadow.mapSize), ya.directionalShadowMap[n] = i, ya.directionalShadowMatrix[n] = e.shadow.matrix, ya.directional[n++] = r
        } else if (e instanceof THREE.SpotLight) {
            var r = Ka.get(e);
            r.position.setFromMatrixPosition(e.matrixWorld), r.position.applyMatrix4(m), r.color.copy(f).multiplyScalar(g), r.distance = h, r.direction.setFromMatrixPosition(e.matrixWorld), xa.setFromMatrixPosition(e.target.matrixWorld), r.direction.sub(xa), r.direction.transformDirection(m), r.coneCos = Math.cos(e.angle), r.penumbraCos = Math.cos(e.angle * (1 - e.penumbra)), r.decay = 0 === e.distance ? 0 : e.decay, r.shadow = e.castShadow, e.castShadow && (r.shadowBias = e.shadow.bias, r.shadowRadius = e.shadow.radius, r.shadowMapSize = e.shadow.mapSize), ya.spotShadowMap[p] = i, ya.spotShadowMatrix[p] = e.shadow.matrix, ya.spot[p++] = r
        } else if (e instanceof THREE.PointLight) {
            var r = Ka.get(e);
            r.position.setFromMatrixPosition(e.matrixWorld), r.position.applyMatrix4(m), r.color.copy(e.color).multiplyScalar(e.intensity), r.distance = e.distance, r.decay = 0 === e.distance ? 0 : e.decay, r.shadow = e.castShadow, e.castShadow && (r.shadowBias = e.shadow.bias, r.shadowRadius = e.shadow.radius, r.shadowMapSize = e.shadow.mapSize), ya.pointShadowMap[o] = i, void 0 === ya.pointShadowMatrix[o] && (ya.pointShadowMatrix[o] = new THREE.Matrix4), xa.setFromMatrixPosition(e.matrixWorld).negate(), ya.pointShadowMatrix[o].identity().setPosition(xa), ya.point[o++] = r
        } else if (e instanceof THREE.HemisphereLight) {
            var r = Ka.get(e);
            r.direction.setFromMatrixPosition(e.matrixWorld), r.direction.transformDirection(m), r.direction.normalize(), r.skyColor.copy(e.color).multiplyScalar(g), r.groundColor.copy(e.groundColor).multiplyScalar(g), ya.hemi[q++] = r
        }
        ya.ambient[0] = j, ya.ambient[1] = k, ya.ambient[2] = l, ya.directional.length = n, ya.spot.length = p, ya.point.length = o, ya.hemi.length = q, ya.hash = n + "," + o + "," + p + "," + q + "," + ya.shadows.length
    }

    function I() {
        var a = ia;
        return a >= Ea.maxTextures && console.warn("WebGLRenderer: trying to use " + a + " texture units while this GPU supports only " + Ea.maxTextures), ia += 1, a
    }

    function J(a) {
        var b;
        if (a === THREE.RepeatWrapping)return Aa.REPEAT;
        if (a === THREE.ClampToEdgeWrapping)return Aa.CLAMP_TO_EDGE;
        if (a === THREE.MirroredRepeatWrapping)return Aa.MIRRORED_REPEAT;
        if (a === THREE.NearestFilter)return Aa.NEAREST;
        if (a === THREE.NearestMipMapNearestFilter)return Aa.NEAREST_MIPMAP_NEAREST;
        if (a === THREE.NearestMipMapLinearFilter)return Aa.NEAREST_MIPMAP_LINEAR;
        if (a === THREE.LinearFilter)return Aa.LINEAR;
        if (a === THREE.LinearMipMapNearestFilter)return Aa.LINEAR_MIPMAP_NEAREST;
        if (a === THREE.LinearMipMapLinearFilter)return Aa.LINEAR_MIPMAP_LINEAR;
        if (a === THREE.UnsignedByteType)return Aa.UNSIGNED_BYTE;
        if (a === THREE.UnsignedShort4444Type)return Aa.UNSIGNED_SHORT_4_4_4_4;
        if (a === THREE.UnsignedShort5551Type)return Aa.UNSIGNED_SHORT_5_5_5_1;
        if (a === THREE.UnsignedShort565Type)return Aa.UNSIGNED_SHORT_5_6_5;
        if (a === THREE.ByteType)return Aa.BYTE;
        if (a === THREE.ShortType)return Aa.SHORT;
        if (a === THREE.UnsignedShortType)return Aa.UNSIGNED_SHORT;
        if (a === THREE.IntType)return Aa.INT;
        if (a === THREE.UnsignedIntType)return Aa.UNSIGNED_INT;
        if (a === THREE.FloatType)return Aa.FLOAT;
        if (b = Da.get("OES_texture_half_float"), null !== b && a === THREE.HalfFloatType)return b.HALF_FLOAT_OES;
        if (a === THREE.AlphaFormat)return Aa.ALPHA;
        if (a === THREE.RGBFormat)return Aa.RGB;
        if (a === THREE.RGBAFormat)return Aa.RGBA;
        if (a === THREE.LuminanceFormat)return Aa.LUMINANCE;
        if (a === THREE.LuminanceAlphaFormat)return Aa.LUMINANCE_ALPHA;
        if (a === THREE.DepthFormat)return Aa.DEPTH_COMPONENT;
        if (a === THREE.AddEquation)return Aa.FUNC_ADD;
        if (a === THREE.SubtractEquation)return Aa.FUNC_SUBTRACT;
        if (a === THREE.ReverseSubtractEquation)return Aa.FUNC_REVERSE_SUBTRACT;
        if (a === THREE.ZeroFactor)return Aa.ZERO;
        if (a === THREE.OneFactor)return Aa.ONE;
        if (a === THREE.SrcColorFactor)return Aa.SRC_COLOR;
        if (a === THREE.OneMinusSrcColorFactor)return Aa.ONE_MINUS_SRC_COLOR;
        if (a === THREE.SrcAlphaFactor)return Aa.SRC_ALPHA;
        if (a === THREE.OneMinusSrcAlphaFactor)return Aa.ONE_MINUS_SRC_ALPHA;
        if (a === THREE.DstAlphaFactor)return Aa.DST_ALPHA;
        if (a === THREE.OneMinusDstAlphaFactor)return Aa.ONE_MINUS_DST_ALPHA;
        if (a === THREE.DstColorFactor)return Aa.DST_COLOR;
        if (a === THREE.OneMinusDstColorFactor)return Aa.ONE_MINUS_DST_COLOR;
        if (a === THREE.SrcAlphaSaturateFactor)return Aa.SRC_ALPHA_SATURATE;
        if (b = Da.get("WEBGL_compressed_texture_s3tc"), null !== b) {
            if (a === THREE.RGB_S3TC_DXT1_Format)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;
            if (a === THREE.RGBA_S3TC_DXT1_Format)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;
            if (a === THREE.RGBA_S3TC_DXT3_Format)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;
            if (a === THREE.RGBA_S3TC_DXT5_Format)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT
        }
        if (b = Da.get("WEBGL_compressed_texture_pvrtc"), null !== b) {
            if (a === THREE.RGB_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
            if (a === THREE.RGB_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
            if (a === THREE.RGBA_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
            if (a === THREE.RGBA_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG
        }
        if (b = Da.get("WEBGL_compressed_texture_etc1"), null !== b && a === THREE.RGB_ETC1_Format)return b.COMPRESSED_RGB_ETC1_WEBGL;
        if (b = Da.get("EXT_blend_minmax"), null !== b) {
            if (a === THREE.MinEquation)return b.MIN_EXT;
            if (a === THREE.MaxEquation)return b.MAX_EXT
        }
        return 0
    }

    console.log("THREE.WebGLRenderer", THREE.REVISION), a = a || {};
    var K = void 0 !== a.canvas ? a.canvas : document.createElementNS("http://www.w3.org/1999/xhtml", "canvas"), L = void 0 !== a.context ? a.context : null, M = void 0 !== a.alpha ? a.alpha : !1, N = void 0 !== a.depth ? a.depth : !0, O = void 0 !== a.stencil ? a.stencil : !0, P = void 0 !== a.antialias ? a.antialias : !1, Q = void 0 !== a.premultipliedAlpha ? a.premultipliedAlpha : !0, R = void 0 !== a.preserveDrawingBuffer ? a.preserveDrawingBuffer : !1, S = [], T = [], U = -1, V = [], W = -1, X = new Float32Array(8), Y = [], Z = [];
    this.domElement = K, this.context = null, this.autoClear = !0, this.autoClearColor = !0, this.autoClearDepth = !0, this.autoClearStencil = !0, this.sortObjects = !0, this.clippingPlanes = [], this.localClippingEnabled = !1, this.gammaFactor = 2, this.gammaInput = !1, this.gammaOutput = !1, this.physicallyCorrectLights = !1, this.toneMapping = THREE.LinearToneMapping, this.toneMappingExposure = 1, this.toneMappingWhitePoint = 1, this.maxMorphTargets = 8, this.maxMorphNormals = 4;
    var $ = this, _ = null, aa = null, ba = null, ca = -1, da = "", ea = null, fa = new THREE.Vector4, ga = null, ha = new THREE.Vector4, ia = 0, ja = new THREE.Color(0), ka = 0, la = K.width, ma = K.height, na = 1, oa = new THREE.Vector4(0, 0, la, ma), pa = !1, qa = new THREE.Vector4(0, 0, la, ma), ra = new THREE.Frustum, sa = new THREE.WebGLClipping, ta = !1, ua = !1, va = new THREE.Sphere, wa = new THREE.Matrix4, xa = new THREE.Vector3, ya = {
        hash: "",
        ambient: [0, 0, 0],
        directional: [],
        directionalShadowMap: [],
        directionalShadowMatrix: [],
        spot: [],
        spotShadowMap: [],
        spotShadowMatrix: [],
        point: [],
        pointShadowMap: [],
        pointShadowMatrix: [],
        hemi: [],
        shadows: []
    }, za = {calls: 0, vertices: 0, faces: 0, points: 0};
    this.info = {render: za, memory: {geometries: 0, textures: 0}, programs: null};
    var Aa;
    try {
        var Ba = {alpha: M, depth: N, stencil: O, antialias: P, premultipliedAlpha: Q, preserveDrawingBuffer: R};
        if (Aa = L || K.getContext("webgl", Ba) || K.getContext("experimental-webgl", Ba), null === Aa)throw null !== K.getContext("webgl") ? "Error creating WebGL context with your selected attributes." : "Error creating WebGL context.";
        void 0 === Aa.getShaderPrecisionFormat && (Aa.getShaderPrecisionFormat = function () {
            return {rangeMin: 1, rangeMax: 1, precision: 1}
        }), K.addEventListener("webglcontextlost", f, !1)
    } catch (Ca) {
        console.error("THREE.WebGLRenderer: " + Ca)
    }
    var Da = new THREE.WebGLExtensions(Aa);
    Da.get("WEBGL_depth_texture"), Da.get("OES_texture_float"), Da.get("OES_texture_float_linear"), Da.get("OES_texture_half_float"), Da.get("OES_texture_half_float_linear"), Da.get("OES_standard_derivatives"), Da.get("ANGLE_instanced_arrays"), Da.get("OES_element_index_uint") && (THREE.BufferGeometry.MaxIndex = 4294967296);
    var Ea = new THREE.WebGLCapabilities(Aa, Da, a), Fa = new THREE.WebGLState(Aa, Da, J), Ga = new THREE.WebGLProperties, Ha = new THREE.WebGLTextures(Aa, Da, Fa, Ga, Ea, J, this.info), Ia = new THREE.WebGLObjects(Aa, Ga, this.info), Ja = new THREE.WebGLPrograms(this, Ea), Ka = new THREE.WebGLLights;
    this.info.programs = Ja.programs;
    var La = new THREE.WebGLBufferRenderer(Aa, Da, za), Ma = new THREE.WebGLIndexedBufferRenderer(Aa, Da, za), Na = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1), Oa = new THREE.PerspectiveCamera, Pa = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), new THREE.MeshBasicMaterial({
        depthTest: !1,
        depthWrite: !1
    })), Qa = THREE.ShaderLib.cube, Ra = new THREE.Mesh(new THREE.BoxBufferGeometry(5, 5, 5), new THREE.ShaderMaterial({
        uniforms: Qa.uniforms,
        vertexShader: Qa.vertexShader,
        fragmentShader: Qa.fragmentShader,
        depthTest: !1,
        depthWrite: !1,
        side: THREE.BackSide
    }));
    Ia.update(Pa), Ia.update(Ra), d(), this.context = Aa, this.capabilities = Ea, this.extensions = Da, this.properties = Ga, this.state = Fa;
    var Sa = new THREE.WebGLShadowMap(this, ya, Ia);
    this.shadowMap = Sa;
    var Ta = new THREE.SpritePlugin(this, Y), Ua = new THREE.LensFlarePlugin(this, Z);
    this.getContext = function () {
        return Aa
    }, this.getContextAttributes = function () {
        return Aa.getContextAttributes()
    }, this.forceContextLoss = function () {
        Da.get("WEBGL_lose_context").loseContext()
    }, this.getMaxAnisotropy = function () {
        return Ea.getMaxAnisotropy()
    }, this.getPrecision = function () {
        return Ea.precision
    }, this.getPixelRatio = function () {
        return na
    }, this.setPixelRatio = function (a) {
        void 0 !== a && (na = a, this.setSize(qa.z, qa.w, !1))
    }, this.getSize = function () {
        return {width: la, height: ma}
    }, this.setSize = function (a, b, c) {
        la = a, ma = b, K.width = a * na, K.height = b * na, c !== !1 && (K.style.width = a + "px", K.style.height = b + "px"), this.setViewport(0, 0, a, b)
    }, this.setViewport = function (a, b, c, d) {
        Fa.viewport(qa.set(a, b, c, d))
    }, this.setScissor = function (a, b, c, d) {
        Fa.scissor(oa.set(a, b, c, d))
    }, this.setScissorTest = function (a) {
        Fa.setScissorTest(pa = a)
    }, this.getClearColor = function () {
        return ja
    }, this.setClearColor = function (a, b) {
        ja.set(a), ka = void 0 !== b ? b : 1, c(ja.r, ja.g, ja.b, ka)
    }, this.getClearAlpha = function () {
        return ka
    }, this.setClearAlpha = function (a) {
        ka = a, c(ja.r, ja.g, ja.b, ka)
    }, this.clear = function (a, b, c) {
        var d = 0;
        (void 0 === a || a) && (d |= Aa.COLOR_BUFFER_BIT), (void 0 === b || b) && (d |= Aa.DEPTH_BUFFER_BIT), (void 0 === c || c) && (d |= Aa.STENCIL_BUFFER_BIT), Aa.clear(d)
    }, this.clearColor = function () {
        this.clear(!0, !1, !1)
    }, this.clearDepth = function () {
        this.clear(!1, !0, !1)
    }, this.clearStencil = function () {
        this.clear(!1, !1, !0)
    }, this.clearTarget = function (a, b, c, d) {
        this.setRenderTarget(a), this.clear(b, c, d)
    }, this.resetGLState = e, this.dispose = function () {
        V = [], W = -1, T = [], U = -1, K.removeEventListener("webglcontextlost", f, !1)
    }, this.renderBufferImmediate = function (a, b, c) {
        Fa.initAttributes();
        var d = Ga.get(a);
        a.hasPositions && !d.position && (d.position = Aa.createBuffer()), a.hasNormals && !d.normal && (d.normal = Aa.createBuffer()), a.hasUvs && !d.uv && (d.uv = Aa.createBuffer()), a.hasColors && !d.color && (d.color = Aa.createBuffer());
        var e = b.getAttributes();
        if (a.hasPositions && (Aa.bindBuffer(Aa.ARRAY_BUFFER, d.position), Aa.bufferData(Aa.ARRAY_BUFFER, a.positionArray, Aa.DYNAMIC_DRAW), Fa.enableAttribute(e.position), Aa.vertexAttribPointer(e.position, 3, Aa.FLOAT, !1, 0, 0)), a.hasNormals) {
            if (Aa.bindBuffer(Aa.ARRAY_BUFFER, d.normal), "MeshPhongMaterial" !== c.type && "MeshStandardMaterial" !== c.type && "MeshPhysicalMaterial" !== c.type && c.shading === THREE.FlatShading)for (var f = 0, g = 3 * a.count; g > f; f += 9) {
                var h = a.normalArray, i = (h[f + 0] + h[f + 3] + h[f + 6]) / 3, j = (h[f + 1] + h[f + 4] + h[f + 7]) / 3, k = (h[f + 2] + h[f + 5] + h[f + 8]) / 3;
                h[f + 0] = i, h[f + 1] = j, h[f + 2] = k, h[f + 3] = i, h[f + 4] = j, h[f + 5] = k, h[f + 6] = i, h[f + 7] = j, h[f + 8] = k
            }
            Aa.bufferData(Aa.ARRAY_BUFFER, a.normalArray, Aa.DYNAMIC_DRAW), Fa.enableAttribute(e.normal), Aa.vertexAttribPointer(e.normal, 3, Aa.FLOAT, !1, 0, 0)
        }
        a.hasUvs && c.map && (Aa.bindBuffer(Aa.ARRAY_BUFFER, d.uv), Aa.bufferData(Aa.ARRAY_BUFFER, a.uvArray, Aa.DYNAMIC_DRAW), Fa.enableAttribute(e.uv), Aa.vertexAttribPointer(e.uv, 2, Aa.FLOAT, !1, 0, 0)), a.hasColors && c.vertexColors !== THREE.NoColors && (Aa.bindBuffer(Aa.ARRAY_BUFFER, d.color), Aa.bufferData(Aa.ARRAY_BUFFER, a.colorArray, Aa.DYNAMIC_DRAW), Fa.enableAttribute(e.color), Aa.vertexAttribPointer(e.color, 3, Aa.FLOAT, !1, 0, 0)), Fa.disableUnusedAttributes(), Aa.drawArrays(Aa.TRIANGLES, 0, a.count), a.count = 0
    }, this.renderBufferDirect = function (a, c, d, e, f, g) {
        u(e);
        var h = v(a, c, e, f), i = !1, l = d.id + "_" + h.id + "_" + e.wireframe;
        l !== da && (da = l, i = !0);
        var m = f.morphTargetInfluences;
        if (void 0 !== m) {
            for (var n = [], o = 0, p = m.length; p > o; o++) {
                var q = m[o];
                n.push([q, o])
            }
            n.sort(k), n.length > 8 && (n.length = 8);
            for (var r = d.morphAttributes, o = 0, p = n.length; p > o; o++) {
                var q = n[o];
                if (X[o] = q[0], 0 !== q[0]) {
                    var s = q[1];
                    e.morphTargets === !0 && r.position && d.addAttribute("morphTarget" + o, r.position[s]), e.morphNormals === !0 && r.normal && d.addAttribute("morphNormal" + o, r.normal[s])
                } else e.morphTargets === !0 && d.removeAttribute("morphTarget" + o), e.morphNormals === !0 && d.removeAttribute("morphNormal" + o)
            }
            h.getUniforms().setValue(Aa, "morphTargetInfluences", X), i = !0
        }
        var s = d.index, t = d.attributes.position;
        e.wireframe === !0 && (s = Ia.getWireframeAttribute(d));
        var w;
        null !== s ? (w = Ma, w.setIndex(s)) : w = La, i && (j(e, h, d), null !== s && Aa.bindBuffer(Aa.ELEMENT_ARRAY_BUFFER, Ia.getAttributeBuffer(s)));
        var x = 0, y = 1 / 0;
        null !== s ? y = s.count : void 0 !== t && (y = t.count);
        var z = d.drawRange.start, A = d.drawRange.count, B = null !== g ? g.start : 0, C = null !== g ? g.count : 1 / 0, D = Math.max(x, z, B), E = Math.min(x + y, z + A, B + C) - 1, F = Math.max(0, E - D + 1);
        if (f instanceof THREE.Mesh)if (e.wireframe === !0)Fa.setLineWidth(e.wireframeLinewidth * b()), w.setMode(Aa.LINES); else switch (f.drawMode) {
            case THREE.TrianglesDrawMode:
                w.setMode(Aa.TRIANGLES);
                break;
            case THREE.TriangleStripDrawMode:
                w.setMode(Aa.TRIANGLE_STRIP);
                break;
            case THREE.TriangleFanDrawMode:
                w.setMode(Aa.TRIANGLE_FAN)
        } else if (f instanceof THREE.Line) {
            var G = e.linewidth;
            void 0 === G && (G = 1), Fa.setLineWidth(G * b()), f instanceof THREE.LineSegments ? w.setMode(Aa.LINES) : w.setMode(Aa.LINE_STRIP)
        } else f instanceof THREE.Points && w.setMode(Aa.POINTS);
        d instanceof THREE.InstancedBufferGeometry ? d.maxInstancedCount > 0 && w.renderInstances(d, D, F) : w.render(D, F)
    }, this.render = function (a, b, d, e) {
        if (b instanceof THREE.Camera == !1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
        var f = a.fog;
        da = "", ca = -1, ea = null, a.autoUpdate === !0 && a.updateMatrixWorld(), null === b.parent && b.updateMatrixWorld(), b.matrixWorldInverse.getInverse(b.matrixWorld), wa.multiplyMatrices(b.projectionMatrix, b.matrixWorldInverse), ra.setFromMatrix(wa), S.length = 0, U = -1, W = -1, Y.length = 0, Z.length = 0, ua = this.localClippingEnabled, ta = sa.init(this.clippingPlanes, ua, b), r(a, b), T.length = U + 1, V.length = W + 1, $.sortObjects === !0 && (T.sort(l), V.sort(m)), ta && sa.beginShadows(), G(S), Sa.render(a, b), H(S, b), ta && sa.endShadows(), za.calls = 0, za.vertices = 0, za.faces = 0, za.points = 0, void 0 === d && (d = null), this.setRenderTarget(d);
        var g = a.background;
        if (null === g ? c(ja.r, ja.g, ja.b, ka) : g instanceof THREE.Color && c(g.r, g.g, g.b, 1), (this.autoClear || e) && this.clear(this.autoClearColor, this.autoClearDepth, this.autoClearStencil), g instanceof THREE.CubeTexture ? (Oa.projectionMatrix.copy(b.projectionMatrix), Oa.matrixWorld.extractRotation(b.matrixWorld), Oa.matrixWorldInverse.getInverse(Oa.matrixWorld), Ra.material.uniforms.tCube.value = g, Ra.modelViewMatrix.multiplyMatrices(Oa.matrixWorldInverse, Ra.matrixWorld), $.renderBufferDirect(Oa, null, Ra.geometry, Ra.material, Ra, null)) : g instanceof THREE.Texture && (Pa.material.map = g, $.renderBufferDirect(Na, null, Pa.geometry, Pa.material, Pa, null)), a.overrideMaterial) {
            var h = a.overrideMaterial;
            s(T, b, f, h), s(V, b, f, h)
        } else Fa.setBlending(THREE.NoBlending), s(T, b, f), s(V, b, f);
        Ta.render(a, b), Ua.render(a, b, ha), d && Ha.updateRenderTargetMipmap(d), Fa.setDepthTest(!0), Fa.setDepthWrite(!0), Fa.setColorWrite(!0)
    }, this.setFaceCulling = function (a, b) {
        Fa.setCullFace(a), Fa.setFlipSided(b === THREE.FrontFaceDirectionCW)
    }, this.allocTextureUnit = I, this.setTexture2D = function () {
        var a = !1;
        return function (b, c) {
            b instanceof THREE.WebGLRenderTarget && (a || (console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."), a = !0), b = b.texture), Ha.setTexture2D(b, c)
        }
    }(), this.setTexture = function () {
        var a = !1;
        return function (b, c) {
            a || (console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."), a = !0), Ha.setTexture2D(b, c)
        }
    }(), this.setTextureCube = function () {
        var a = !1;
        return function (b, c) {
            b instanceof THREE.WebGLRenderTargetCube && (a || (console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."), a = !0), b = b.texture), b instanceof THREE.CubeTexture || Array.isArray(b.image) && 6 === b.image.length ? Ha.setTextureCube(b, c) : Ha.setTextureCubeDynamic(b, c)
        }
    }(), this.getCurrentRenderTarget = function () {
        return aa
    }, this.setRenderTarget = function (a) {
        aa = a, a && void 0 === Ga.get(a).__webglFramebuffer && Ha.setupRenderTarget(a);
        var b, c = a instanceof THREE.WebGLRenderTargetCube;
        if (a) {
            var d = Ga.get(a);
            b = c ? d.__webglFramebuffer[a.activeCubeFace] : d.__webglFramebuffer, fa.copy(a.scissor), ga = a.scissorTest, ha.copy(a.viewport)
        } else b = null, fa.copy(oa).multiplyScalar(na), ga = pa, ha.copy(qa).multiplyScalar(na);
        if (ba !== b && (Aa.bindFramebuffer(Aa.FRAMEBUFFER, b), ba = b), Fa.scissor(fa), Fa.setScissorTest(ga), Fa.viewport(ha), c) {
            var e = Ga.get(a.texture);
            Aa.framebufferTexture2D(Aa.FRAMEBUFFER, Aa.COLOR_ATTACHMENT0, Aa.TEXTURE_CUBE_MAP_POSITIVE_X + a.activeCubeFace, e.__webglTexture, a.activeMipMapLevel)
        }
    }, this.readRenderTargetPixels = function (a, b, c, d, e, f) {
        if (a instanceof THREE.WebGLRenderTarget == !1)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");
        var g = Ga.get(a).__webglFramebuffer;
        if (g) {
            var h = !1;
            g !== ba && (Aa.bindFramebuffer(Aa.FRAMEBUFFER, g), h = !0);
            try {
                var i = a.texture;
                if (i.format !== THREE.RGBAFormat && J(i.format) !== Aa.getParameter(Aa.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");
                if (!(i.type === THREE.UnsignedByteType || J(i.type) === Aa.getParameter(Aa.IMPLEMENTATION_COLOR_READ_TYPE) || i.type === THREE.FloatType && Da.get("WEBGL_color_buffer_float") || i.type === THREE.HalfFloatType && Da.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");
                Aa.checkFramebufferStatus(Aa.FRAMEBUFFER) === Aa.FRAMEBUFFER_COMPLETE ? b >= 0 && b <= a.width - d && c >= 0 && c <= a.height - e && Aa.readPixels(b, c, d, e, J(i.format), J(i.type), f) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")
            } finally {
                h && Aa.bindFramebuffer(Aa.FRAMEBUFFER, ba)
            }
        }
    }
},THREE.WebGLRenderTarget = function (a, b, c) {
    this.uuid = THREE.Math.generateUUID(), this.width = a, this.height = b, this.scissor = new THREE.Vector4(0, 0, a, b), this.scissorTest = !1, this.viewport = new THREE.Vector4(0, 0, a, b), c = c || {}, void 0 === c.minFilter && (c.minFilter = THREE.LinearFilter), this.texture = new THREE.Texture(void 0, void 0, c.wrapS, c.wrapT, c.magFilter, c.minFilter, c.format, c.type, c.anisotropy, c.encoding), this.depthBuffer = void 0 !== c.depthBuffer ? c.depthBuffer : !0, this.stencilBuffer = void 0 !== c.stencilBuffer ? c.stencilBuffer : !0, this.depthTexture = null
},Object.assign(THREE.WebGLRenderTarget.prototype, THREE.EventDispatcher.prototype, {
    setSize: function (a, b) {
        (this.width !== a || this.height !== b) && (this.width = a, this.height = b, this.dispose()), this.viewport.set(0, 0, a, b), this.scissor.set(0, 0, a, b)
    }, clone: function () {
        return (new this.constructor).copy(this)
    }, copy: function (a) {
        return this.width = a.width, this.height = a.height, this.viewport.copy(a.viewport), this.texture = a.texture.clone(), this.depthBuffer = a.depthBuffer, this.stencilBuffer = a.stencilBuffer, this.depthTexture = a.depthTexture, this
    }, dispose: function () {
        this.dispatchEvent({type: "dispose"})
    }
}),THREE.WebGLRenderTargetCube = function (a, b, c) {
    THREE.WebGLRenderTarget.call(this, a, b, c), this.activeCubeFace = 0, this.activeMipMapLevel = 0
},THREE.WebGLRenderTargetCube.prototype = Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube,THREE.WebGLBufferRenderer = function (a, b, c) {
    function d(a) {
        g = a
    }

    function e(b, d) {
        a.drawArrays(g, b, d), c.calls++, c.vertices += d, g === a.TRIANGLES && (c.faces += d / 3)
    }

    function f(d) {
        var e = b.get("ANGLE_instanced_arrays");
        if (null === e)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
        var f = d.attributes.position, h = 0;
        f instanceof THREE.InterleavedBufferAttribute ? (h = f.data.count, e.drawArraysInstancedANGLE(g, 0, h, d.maxInstancedCount)) : (h = f.count, e.drawArraysInstancedANGLE(g, 0, h, d.maxInstancedCount)), c.calls++, c.vertices += h * d.maxInstancedCount, g === a.TRIANGLES && (c.faces += d.maxInstancedCount * h / 3)
    }

    var g;
    this.setMode = d, this.render = e, this.renderInstances = f
},THREE.WebGLClipping = function () {
    function a() {
        j.value !== d && (j.value = d, j.needsUpdate = e > 0), c.numPlanes = e
    }

    function b(a, b, d, e) {
        var f = null !== a ? a.length : 0, g = null;
        if (0 !== f) {
            if (g = j.value, e !== !0 || null === g) {
                var k = d + 4 * f, l = b.matrixWorldInverse;
                i.getNormalMatrix(l), (null === g || g.length < k) && (g = new Float32Array(k));
                for (var m = 0, n = d; m !== f; ++m, n += 4)h.copy(a[m]).applyMatrix4(l, i), h.normal.toArray(g, n), g[n + 3] = h.constant
            }
            j.value = g, j.needsUpdate = !0
        }
        return c.numPlanes = f, g
    }

    var c = this, d = null, e = 0, f = !1, g = !1, h = new THREE.Plane, i = new THREE.Matrix3, j = {
        value: null,
        needsUpdate: !1
    };
    this.uniform = j, this.numPlanes = 0, this.init = function (a, c, g) {
        var h = 0 !== a.length || c || 0 !== e || f;
        return f = c, d = b(a, g, 0), e = a.length, h
    }, this.beginShadows = function () {
        g = !0, b(null)
    }, this.endShadows = function () {
        g = !1, a()
    }, this.setState = function (c, h, i, k, l) {
        if (!f || null === c || 0 === c.length || g && !h)g ? b(null) : a(); else {
            var m = g ? 0 : e, n = 4 * m, o = k.clippingState || null;
            j.value = o, o = b(c, i, n, l);
            for (var p = 0; p !== n; ++p)o[p] = d[p];
            k.clippingState = o, this.numPlanes += m
        }
    }
},THREE.WebGLIndexedBufferRenderer = function (a, b, c) {
    function d(a) {
        h = a
    }

    function e(c) {
        c.array instanceof Uint32Array && b.get("OES_element_index_uint") ? (i = a.UNSIGNED_INT, j = 4) : (i = a.UNSIGNED_SHORT, j = 2)
    }

    function f(b, d) {
        a.drawElements(h, d, i, b * j), c.calls++, c.vertices += d, h === a.TRIANGLES && (c.faces += d / 3)
    }

    function g(d, e, f) {
        var g = b.get("ANGLE_instanced_arrays");
        return null === g ? void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.") : (g.drawElementsInstancedANGLE(h, f, i, e * j, d.maxInstancedCount), c.calls++, c.vertices += f * d.maxInstancedCount, void(h === a.TRIANGLES && (c.faces += d.maxInstancedCount * f / 3)))
    }

    var h, i, j;
    this.setMode = d, this.setIndex = e, this.render = f, this.renderInstances = g
},THREE.WebGLExtensions = function (a) {
    var b = {};
    this.get = function (c) {
        if (void 0 !== b[c])return b[c];
        var d;
        switch (c) {
            case"WEBGL_depth_texture":
                d = a.getExtension("WEBGL_depth_texture") || a.getExtension("MOZ_WEBGL_depth_texture") || a.getExtension("WEBKIT_WEBGL_depth_texture");
                break;
            case"EXT_texture_filter_anisotropic":
                d = a.getExtension("EXT_texture_filter_anisotropic") || a.getExtension("MOZ_EXT_texture_filter_anisotropic") || a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
                break;
            case"WEBGL_compressed_texture_s3tc":
                d = a.getExtension("WEBGL_compressed_texture_s3tc") || a.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
                break;
            case"WEBGL_compressed_texture_pvrtc":
                d = a.getExtension("WEBGL_compressed_texture_pvrtc") || a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
                break;
            case"WEBGL_compressed_texture_etc1":
                d = a.getExtension("WEBGL_compressed_texture_etc1");
                break;
            default:
                d = a.getExtension(c)
        }
        return null === d && console.warn("THREE.WebGLRenderer: " + c + " extension not supported."), b[c] = d, d
    }
},THREE.WebGLCapabilities = function (a, b, c) {
    function d() {
        if (void 0 !== f)return f;
        var c = b.get("EXT_texture_filter_anisotropic");
        return f = null !== c ? a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 0
    }

    function e(b) {
        if ("highp" === b) {
            if (a.getShaderPrecisionFormat(a.VERTEX_SHADER, a.HIGH_FLOAT).precision > 0 && a.getShaderPrecisionFormat(a.FRAGMENT_SHADER, a.HIGH_FLOAT).precision > 0)return "highp";
            b = "mediump"
        }
        return "mediump" === b && a.getShaderPrecisionFormat(a.VERTEX_SHADER, a.MEDIUM_FLOAT).precision > 0 && a.getShaderPrecisionFormat(a.FRAGMENT_SHADER, a.MEDIUM_FLOAT).precision > 0 ? "mediump" : "lowp"
    }

    var f;
    this.getMaxAnisotropy = d, this.getMaxPrecision = e, this.precision = void 0 !== c.precision ? c.precision : "highp", this.logarithmicDepthBuffer = void 0 !== c.logarithmicDepthBuffer ? c.logarithmicDepthBuffer : !1, this.maxTextures = a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS), this.maxVertexTextures = a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS), this.maxTextureSize = a.getParameter(a.MAX_TEXTURE_SIZE), this.maxCubemapSize = a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE), this.maxAttributes = a.getParameter(a.MAX_VERTEX_ATTRIBS), this.maxVertexUniforms = a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS), this.maxVaryings = a.getParameter(a.MAX_VARYING_VECTORS), this.maxFragmentUniforms = a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS), this.vertexTextures = this.maxVertexTextures > 0, this.floatFragmentTextures = !!b.get("OES_texture_float"), this.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;
    var g = e(this.precision);
    g !== this.precision && (console.warn("THREE.WebGLRenderer:", this.precision, "not supported, using", g, "instead."), this.precision = g), this.logarithmicDepthBuffer && (this.logarithmicDepthBuffer = !!b.get("EXT_frag_depth"))
},THREE.WebGLGeometries = function (a, b, c) {
    function d(a) {
        var b = a.geometry;
        if (void 0 !== j[b.id])return j[b.id];
        b.addEventListener("dispose", e);
        var d;
        return b instanceof THREE.BufferGeometry ? d = b : b instanceof THREE.Geometry && (void 0 === b._bufferGeometry && (b._bufferGeometry = (new THREE.BufferGeometry).setFromObject(a)), d = b._bufferGeometry), j[b.id] = d, c.memory.geometries++, d
    }

    function e(a) {
        var d = a.target, f = j[d.id];
        null !== f.index && g(f.index), h(f.attributes), d.removeEventListener("dispose", e), delete j[d.id];
        var i = b.get(d);
        i.wireframe && g(i.wireframe), b["delete"](d);
        var k = b.get(f);
        k.wireframe && g(k.wireframe), b["delete"](f), c.memory.geometries--
    }

    function f(a) {
        return a instanceof THREE.InterleavedBufferAttribute ? b.get(a.data).__webglBuffer : b.get(a).__webglBuffer
    }

    function g(b) {
        var c = f(b);
        void 0 !== c && (a.deleteBuffer(c), i(b))
    }

    function h(a) {
        for (var b in a)g(a[b])
    }

    function i(a) {
        a instanceof THREE.InterleavedBufferAttribute ? b["delete"](a.data) : b["delete"](a)
    }

    var j = {};
    this.get = d
},THREE.WebGLLights = function () {
    var a = {};
    this.get = function (b) {
        if (void 0 !== a[b.id])return a[b.id];
        var c;
        switch (b.type) {
            case"DirectionalLight":
                c = {
                    direction: new THREE.Vector3,
                    color: new THREE.Color,
                    shadow: !1,
                    shadowBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new THREE.Vector2
                };
                break;
            case"SpotLight":
                c = {
                    position: new THREE.Vector3,
                    direction: new THREE.Vector3,
                    color: new THREE.Color,
                    distance: 0,
                    coneCos: 0,
                    penumbraCos: 0,
                    decay: 0,
                    shadow: !1,
                    shadowBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new THREE.Vector2
                };
                break;
            case"PointLight":
                c = {
                    position: new THREE.Vector3,
                    color: new THREE.Color,
                    distance: 0,
                    decay: 0,
                    shadow: !1,
                    shadowBias: 0,
                    shadowRadius: 1,
                    shadowMapSize: new THREE.Vector2
                };
                break;
            case"HemisphereLight":
                c = {direction: new THREE.Vector3, skyColor: new THREE.Color, groundColor: new THREE.Color}
        }
        return a[b.id] = c, c
    }
},THREE.WebGLObjects = function (a, b, c) {
    function d(b) {
        var c = k.get(b);
        b.geometry instanceof THREE.Geometry && c.updateFromObject(b);
        var d = c.index, f = c.attributes;
        null !== d && e(d, a.ELEMENT_ARRAY_BUFFER);
        for (var g in f)e(f[g], a.ARRAY_BUFFER);
        var h = c.morphAttributes;
        for (var g in h)for (var i = h[g], j = 0, l = i.length; l > j; j++)e(i[j], a.ARRAY_BUFFER);
        return c
    }

    function e(a, c) {
        var d = a instanceof THREE.InterleavedBufferAttribute ? a.data : a, e = b.get(d);
        void 0 === e.__webglBuffer ? f(e, d, c) : e.version !== d.version && g(e, d, c)
    }

    function f(b, c, d) {
        b.__webglBuffer = a.createBuffer(), a.bindBuffer(d, b.__webglBuffer);
        var e = c.dynamic ? a.DYNAMIC_DRAW : a.STATIC_DRAW;
        a.bufferData(d, c.array, e), b.version = c.version
    }

    function g(b, c, d) {
        a.bindBuffer(d, b.__webglBuffer), c.dynamic === !1 || -1 === c.updateRange.count ? a.bufferSubData(d, 0, c.array) : 0 === c.updateRange.count ? console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.") : (a.bufferSubData(d, c.updateRange.offset * c.array.BYTES_PER_ELEMENT, c.array.subarray(c.updateRange.offset, c.updateRange.offset + c.updateRange.count)), c.updateRange.count = 0), b.version = c.version
    }

    function h(a) {
        return a instanceof THREE.InterleavedBufferAttribute ? b.get(a.data).__webglBuffer : b.get(a).__webglBuffer
    }

    function i(c) {
        var d = b.get(c);
        if (void 0 !== d.wireframe)return d.wireframe;
        var f = [], g = c.index, h = c.attributes, i = h.position;
        if (null !== g)for (var k = {}, l = g.array, m = 0, n = l.length; n > m; m += 3) {
            var o = l[m + 0], p = l[m + 1], q = l[m + 2];
            j(k, o, p) && f.push(o, p), j(k, p, q) && f.push(p, q), j(k, q, o) && f.push(q, o)
        } else for (var l = h.position.array, m = 0, n = l.length / 3 - 1; n > m; m += 3) {
            var o = m + 0, p = m + 1, q = m + 2;
            f.push(o, p, p, q, q, o)
        }
        var r = i.count > 65535 ? Uint32Array : Uint16Array, s = new THREE.BufferAttribute(new r(f), 1);
        return e(s, a.ELEMENT_ARRAY_BUFFER), d.wireframe = s, s
    }

    function j(a, b, c) {
        if (b > c) {
            var d = b;
            b = c, c = d
        }
        var e = a[b];
        return void 0 === e ? (a[b] = [c], !0) : -1 === e.indexOf(c) ? (e.push(c), !0) : !1
    }

    var k = new THREE.WebGLGeometries(a, b, c);
    this.getAttributeBuffer = h, this.getWireframeAttribute = i, this.update = d
},THREE.WebGLProgram = function () {
    function a(a) {
        switch (a) {
            case THREE.LinearEncoding:
                return ["Linear", "( value )"];
            case THREE.sRGBEncoding:
                return ["sRGB", "( value )"];
            case THREE.RGBEEncoding:
                return ["RGBE", "( value )"];
            case THREE.RGBM7Encoding:
                return ["RGBM", "( value, 7.0 )"];
            case THREE.RGBM16Encoding:
                return ["RGBM", "( value, 16.0 )"];
            case THREE.RGBDEncoding:
                return ["RGBD", "( value, 256.0 )"];
            case THREE.GammaEncoding:
                return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];
            default:
                throw new Error("unsupported encoding: " + a)
        }
    }

    function b(b, c) {
        var d = a(c);
        return "vec4 " + b + "( vec4 value ) { return " + d[0] + "ToLinear" + d[1] + "; }"
    }

    function c(b, c) {
        var d = a(c);
        return "vec4 " + b + "( vec4 value ) { return LinearTo" + d[0] + d[1] + "; }"
    }

    function d(a, b) {
        var c;
        switch (b) {
            case THREE.LinearToneMapping:
                c = "Linear";
                break;
            case THREE.ReinhardToneMapping:
                c = "Reinhard";
                break;
            case THREE.Uncharted2ToneMapping:
                c = "Uncharted2";
                break;
            case THREE.CineonToneMapping:
                c = "OptimizedCineon";
                break;
            default:
                throw new Error("unsupported toneMapping: " + b)
        }
        return "vec3 " + a + "( vec3 color ) { return " + c + "ToneMapping( color ); }"
    }

    function e(a, b, c) {
        a = a || {};
        var d = [a.derivatives || b.envMapCubeUV || b.bumpMap || b.normalMap || b.flatShading ? "#extension GL_OES_standard_derivatives : enable" : "", (a.fragDepth || b.logarithmicDepthBuffer) && c.get("EXT_frag_depth") ? "#extension GL_EXT_frag_depth : enable" : "", a.drawBuffers && c.get("WEBGL_draw_buffers") ? "#extension GL_EXT_draw_buffers : require" : "", (a.shaderTextureLOD || b.envMap) && c.get("EXT_shader_texture_lod") ? "#extension GL_EXT_shader_texture_lod : enable" : ""];
        return d.filter(h).join("\n")
    }

    function f(a) {
        var b = [];
        for (var c in a) {
            var d = a[c];
            d !== !1 && b.push("#define " + c + " " + d)
        }
        return b.join("\n")
    }

    function g(a, b, c) {
        for (var d = {}, e = a.getProgramParameter(b, a.ACTIVE_ATTRIBUTES), f = 0; e > f; f++) {
            var g = a.getActiveAttrib(b, f), h = g.name;
            d[h] = a.getAttribLocation(b, h)
        }
        return d
    }

    function h(a) {
        return "" !== a
    }

    function i(a, b) {
        return a.replace(/NUM_DIR_LIGHTS/g, b.numDirLights).replace(/NUM_SPOT_LIGHTS/g, b.numSpotLights).replace(/NUM_POINT_LIGHTS/g, b.numPointLights).replace(/NUM_HEMI_LIGHTS/g, b.numHemiLights)
    }

    function j(a) {
        function b(a, b) {
            var c = THREE.ShaderChunk[b];
            if (void 0 === c)throw new Error("Can not resolve #include <" + b + ">");
            return j(c)
        }

        var c = /#include +<([\w\d.]+)>/g;
        return a.replace(c, b)
    }

    function k(a) {
        function b(a, b, c, d) {
            for (var e = "", f = parseInt(b); f < parseInt(c); f++)e += d.replace(/\[ i \]/g, "[ " + f + " ]");
            return e
        }

        var c = /for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;
        return a.replace(c, b)
    }

    var l = 0;
    return function (a, m, n, o) {
        var p = a.context, q = n.extensions, r = n.defines, s = n.__webglShader.vertexShader, t = n.__webglShader.fragmentShader, u = "SHADOWMAP_TYPE_BASIC";
        o.shadowMapType === THREE.PCFShadowMap ? u = "SHADOWMAP_TYPE_PCF" : o.shadowMapType === THREE.PCFSoftShadowMap && (u = "SHADOWMAP_TYPE_PCF_SOFT");
        var v = "ENVMAP_TYPE_CUBE", w = "ENVMAP_MODE_REFLECTION", x = "ENVMAP_BLENDING_MULTIPLY";
        if (o.envMap) {
            switch (n.envMap.mapping) {
                case THREE.CubeReflectionMapping:
                case THREE.CubeRefractionMapping:
                    v = "ENVMAP_TYPE_CUBE";
                    break;
                case THREE.CubeUVReflectionMapping:
                case THREE.CubeUVRefractionMapping:
                    v = "ENVMAP_TYPE_CUBE_UV";
                    break;
                case THREE.EquirectangularReflectionMapping:
                case THREE.EquirectangularRefractionMapping:
                    v = "ENVMAP_TYPE_EQUIREC";
                    break;
                case THREE.SphericalReflectionMapping:
                    v = "ENVMAP_TYPE_SPHERE"
            }
            switch (n.envMap.mapping) {
                case THREE.CubeRefractionMapping:
                case THREE.EquirectangularRefractionMapping:
                    w = "ENVMAP_MODE_REFRACTION"
            }
            switch (n.combine) {
                case THREE.MultiplyOperation:
                    x = "ENVMAP_BLENDING_MULTIPLY";
                    break;
                case THREE.MixOperation:
                    x = "ENVMAP_BLENDING_MIX";
                    break;
                case THREE.AddOperation:
                    x = "ENVMAP_BLENDING_ADD"
            }
        }
        var y, z, A = a.gammaFactor > 0 ? a.gammaFactor : 1, B = e(q, o, a.extensions), C = f(r), D = p.createProgram();
        n instanceof THREE.RawShaderMaterial ? (y = [C].filter(h).join("\n"), z = [C].filter(h).join("\n")) : (y = ["precision " + o.precision + " float;", "precision " + o.precision + " int;", "#define SHADER_NAME " + n.__webglShader.name, C, o.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "", "#define GAMMA_FACTOR " + A, "#define MAX_BONES " + o.maxBones, o.map ? "#define USE_MAP" : "", o.envMap ? "#define USE_ENVMAP" : "", o.envMap ? "#define " + w : "", o.lightMap ? "#define USE_LIGHTMAP" : "", o.aoMap ? "#define USE_AOMAP" : "", o.emissiveMap ? "#define USE_EMISSIVEMAP" : "", o.bumpMap ? "#define USE_BUMPMAP" : "", o.normalMap ? "#define USE_NORMALMAP" : "", o.displacementMap && o.supportsVertexTextures ? "#define USE_DISPLACEMENTMAP" : "", o.specularMap ? "#define USE_SPECULARMAP" : "", o.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", o.metalnessMap ? "#define USE_METALNESSMAP" : "", o.alphaMap ? "#define USE_ALPHAMAP" : "", o.vertexColors ? "#define USE_COLOR" : "", o.flatShading ? "#define FLAT_SHADED" : "", o.skinning ? "#define USE_SKINNING" : "", o.useVertexTexture ? "#define BONE_TEXTURE" : "", o.morphTargets ? "#define USE_MORPHTARGETS" : "", o.morphNormals && o.flatShading === !1 ? "#define USE_MORPHNORMALS" : "", o.doubleSided ? "#define DOUBLE_SIDED" : "", o.flipSided ? "#define FLIP_SIDED" : "", "#define NUM_CLIPPING_PLANES " + o.numClippingPlanes, o.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", o.shadowMapEnabled ? "#define " + u : "", o.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "", o.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", o.logarithmicDepthBuffer && a.extensions.get("EXT_frag_depth") ? "#define USE_LOGDEPTHBUF_EXT" : "", "uniform mat4 modelMatrix;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform mat4 viewMatrix;", "uniform mat3 normalMatrix;", "uniform vec3 cameraPosition;", "attribute vec3 position;", "attribute vec3 normal;", "attribute vec2 uv;", "#ifdef USE_COLOR", "	attribute vec3 color;", "#endif", "#ifdef USE_MORPHTARGETS", "	attribute vec3 morphTarget0;", "	attribute vec3 morphTarget1;", "	attribute vec3 morphTarget2;", "	attribute vec3 morphTarget3;", "	#ifdef USE_MORPHNORMALS", "		attribute vec3 morphNormal0;", "		attribute vec3 morphNormal1;", "		attribute vec3 morphNormal2;", "		attribute vec3 morphNormal3;", "	#else", "		attribute vec3 morphTarget4;", "		attribute vec3 morphTarget5;", "		attribute vec3 morphTarget6;", "		attribute vec3 morphTarget7;", "	#endif", "#endif", "#ifdef USE_SKINNING", "	attribute vec4 skinIndex;", "	attribute vec4 skinWeight;", "#endif", "\n"].filter(h).join("\n"),
            z = [B, "precision " + o.precision + " float;", "precision " + o.precision + " int;", "#define SHADER_NAME " + n.__webglShader.name, C, o.alphaTest ? "#define ALPHATEST " + o.alphaTest : "", "#define GAMMA_FACTOR " + A, o.useFog && o.fog ? "#define USE_FOG" : "", o.useFog && o.fogExp ? "#define FOG_EXP2" : "", o.map ? "#define USE_MAP" : "", o.envMap ? "#define USE_ENVMAP" : "", o.envMap ? "#define " + v : "", o.envMap ? "#define " + w : "", o.envMap ? "#define " + x : "", o.lightMap ? "#define USE_LIGHTMAP" : "", o.aoMap ? "#define USE_AOMAP" : "", o.emissiveMap ? "#define USE_EMISSIVEMAP" : "", o.bumpMap ? "#define USE_BUMPMAP" : "", o.normalMap ? "#define USE_NORMALMAP" : "", o.specularMap ? "#define USE_SPECULARMAP" : "", o.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", o.metalnessMap ? "#define USE_METALNESSMAP" : "", o.alphaMap ? "#define USE_ALPHAMAP" : "", o.vertexColors ? "#define USE_COLOR" : "", o.flatShading ? "#define FLAT_SHADED" : "", o.doubleSided ? "#define DOUBLE_SIDED" : "", o.flipSided ? "#define FLIP_SIDED" : "", "#define NUM_CLIPPING_PLANES " + o.numClippingPlanes, o.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", o.shadowMapEnabled ? "#define " + u : "", o.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "", o.physicallyCorrectLights ? "#define PHYSICALLY_CORRECT_LIGHTS" : "", o.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", o.logarithmicDepthBuffer && a.extensions.get("EXT_frag_depth") ? "#define USE_LOGDEPTHBUF_EXT" : "", o.envMap && a.extensions.get("EXT_shader_texture_lod") ? "#define TEXTURE_LOD_EXT" : "", "uniform mat4 viewMatrix;", "uniform vec3 cameraPosition;", o.toneMapping !== THREE.NoToneMapping ? "#define TONE_MAPPING" : "", o.toneMapping !== THREE.NoToneMapping ? THREE.ShaderChunk.tonemapping_pars_fragment : "", o.toneMapping !== THREE.NoToneMapping ? d("toneMapping", o.toneMapping) : "", o.outputEncoding || o.mapEncoding || o.envMapEncoding || o.emissiveMapEncoding ? THREE.ShaderChunk.encodings_pars_fragment : "", o.mapEncoding ? b("mapTexelToLinear", o.mapEncoding) : "", o.envMapEncoding ? b("envMapTexelToLinear", o.envMapEncoding) : "", o.emissiveMapEncoding ? b("emissiveMapTexelToLinear", o.emissiveMapEncoding) : "", o.outputEncoding ? c("linearToOutputTexel", o.outputEncoding) : "", o.depthPacking ? "#define DEPTH_PACKING " + n.depthPacking : "", "\n"].filter(h).join("\n")), s = j(s, o), s = i(s, o), t = j(t, o), t = i(t, o), n instanceof THREE.ShaderMaterial == !1 && (s = k(s), t = k(t));
        var E = y + s, F = z + t, G = THREE.WebGLShader(p, p.VERTEX_SHADER, E), H = THREE.WebGLShader(p, p.FRAGMENT_SHADER, F);
        p.attachShader(D, G), p.attachShader(D, H), void 0 !== n.index0AttributeName ? p.bindAttribLocation(D, 0, n.index0AttributeName) : o.morphTargets === !0 && p.bindAttribLocation(D, 0, "position"), p.linkProgram(D);
        var I = p.getProgramInfoLog(D), J = p.getShaderInfoLog(G), K = p.getShaderInfoLog(H), L = !0, M = !0;
        p.getProgramParameter(D, p.LINK_STATUS) === !1 ? (L = !1, console.error("THREE.WebGLProgram: shader error: ", p.getError(), "gl.VALIDATE_STATUS", p.getProgramParameter(D, p.VALIDATE_STATUS), "gl.getProgramInfoLog", I, J, K)) : "" !== I ? console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()", I) : ("" === J || "" === K) && (M = !1), M && (this.diagnostics = {
            runnable: L,
            material: n,
            programLog: I,
            vertexShader: {log: J, prefix: y},
            fragmentShader: {log: K, prefix: z}
        }), p.deleteShader(G), p.deleteShader(H);
        var N;
        this.getUniforms = function () {
            return void 0 === N && (N = new THREE.WebGLUniforms(p, D, a)), N
        };
        var O;
        return this.getAttributes = function () {
            return void 0 === O && (O = g(p, D)), O
        }, this.destroy = function () {
            p.deleteProgram(D), this.program = void 0
        }, Object.defineProperties(this, {
            uniforms: {
                get: function () {
                    return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."), this.getUniforms()
                }
            }, attributes: {
                get: function () {
                    return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."), this.getAttributes()
                }
            }
        }), this.id = l++, this.code = m, this.usedTimes = 1, this.program = D, this.vertexShader = G, this.fragmentShader = H, this
    }
}(),THREE.WebGLPrograms = function (a, b) {
    function c(a) {
        if (b.floatVertexTextures && a && a.skeleton && a.skeleton.useVertexTexture)return 1024;
        var c = b.maxVertexUniforms, d = Math.floor((c - 20) / 4), e = d;
        return void 0 !== a && a instanceof THREE.SkinnedMesh && (e = Math.min(a.skeleton.bones.length, e), e < a.skeleton.bones.length && console.warn("WebGLRenderer: too many bones - " + a.skeleton.bones.length + ", this GPU supports just " + e + " (try OpenGL instead of ANGLE)")), e
    }

    function d(a, b) {
        var c;
        return a ? a instanceof THREE.Texture ? c = a.encoding : a instanceof THREE.WebGLRenderTarget && (console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."), c = a.texture.encoding) : c = THREE.LinearEncoding, c === THREE.LinearEncoding && b && (c = THREE.GammaEncoding), c
    }

    var e = [], f = {
        MeshDepthMaterial: "depth",
        MeshNormalMaterial: "normal",
        MeshBasicMaterial: "basic",
        MeshLambertMaterial: "lambert",
        MeshPhongMaterial: "phong",
        MeshStandardMaterial: "physical",
        MeshPhysicalMaterial: "physical",
        LineBasicMaterial: "basic",
        LineDashedMaterial: "dashed",
        PointsMaterial: "points"
    }, g = ["precision", "supportsVertexTextures", "map", "mapEncoding", "envMap", "envMapMode", "envMapEncoding", "lightMap", "aoMap", "emissiveMap", "emissiveMapEncoding", "bumpMap", "normalMap", "displacementMap", "specularMap", "roughnessMap", "metalnessMap", "alphaMap", "combine", "vertexColors", "fog", "useFog", "fogExp", "flatShading", "sizeAttenuation", "logarithmicDepthBuffer", "skinning", "maxBones", "useVertexTexture", "morphTargets", "morphNormals", "maxMorphTargets", "maxMorphNormals", "premultipliedAlpha", "numDirLights", "numPointLights", "numSpotLights", "numHemiLights", "shadowMapEnabled", "shadowMapType", "toneMapping", "physicallyCorrectLights", "alphaTest", "doubleSided", "flipSided", "numClippingPlanes", "depthPacking"];
    this.getParameters = function (e, g, h, i, j) {
        var k = f[e.type], l = c(j), m = a.getPrecision();
        null !== e.precision && (m = b.getMaxPrecision(e.precision), m !== e.precision && console.warn("THREE.WebGLProgram.getParameters:", e.precision, "not supported, using", m, "instead."));
        var n = a.getCurrentRenderTarget(), o = {
            shaderID: k,
            precision: m,
            supportsVertexTextures: b.vertexTextures,
            outputEncoding: d(n ? n.texture : null, a.gammaOutput),
            map: !!e.map,
            mapEncoding: d(e.map, a.gammaInput),
            envMap: !!e.envMap,
            envMapMode: e.envMap && e.envMap.mapping,
            envMapEncoding: d(e.envMap, a.gammaInput),
            envMapCubeUV: !!e.envMap && (e.envMap.mapping === THREE.CubeUVReflectionMapping || e.envMap.mapping === THREE.CubeUVRefractionMapping),
            lightMap: !!e.lightMap,
            aoMap: !!e.aoMap,
            emissiveMap: !!e.emissiveMap,
            emissiveMapEncoding: d(e.emissiveMap, a.gammaInput),
            bumpMap: !!e.bumpMap,
            normalMap: !!e.normalMap,
            displacementMap: !!e.displacementMap,
            roughnessMap: !!e.roughnessMap,
            metalnessMap: !!e.metalnessMap,
            specularMap: !!e.specularMap,
            alphaMap: !!e.alphaMap,
            combine: e.combine,
            vertexColors: e.vertexColors,
            fog: h,
            useFog: e.fog,
            fogExp: h instanceof THREE.FogExp2,
            flatShading: e.shading === THREE.FlatShading,
            sizeAttenuation: e.sizeAttenuation,
            logarithmicDepthBuffer: b.logarithmicDepthBuffer,
            skinning: e.skinning,
            maxBones: l,
            useVertexTexture: b.floatVertexTextures && j && j.skeleton && j.skeleton.useVertexTexture,
            morphTargets: e.morphTargets,
            morphNormals: e.morphNormals,
            maxMorphTargets: a.maxMorphTargets,
            maxMorphNormals: a.maxMorphNormals,
            numDirLights: g.directional.length,
            numPointLights: g.point.length,
            numSpotLights: g.spot.length,
            numHemiLights: g.hemi.length,
            numClippingPlanes: i,
            shadowMapEnabled: a.shadowMap.enabled && j.receiveShadow && g.shadows.length > 0,
            shadowMapType: a.shadowMap.type,
            toneMapping: a.toneMapping,
            physicallyCorrectLights: a.physicallyCorrectLights,
            premultipliedAlpha: e.premultipliedAlpha,
            alphaTest: e.alphaTest,
            doubleSided: e.side === THREE.DoubleSide,
            flipSided: e.side === THREE.BackSide,
            depthPacking: void 0 !== e.depthPacking ? e.depthPacking : !1
        };
        return o
    }, this.getProgramCode = function (a, b) {
        var c = [];
        if (b.shaderID ? c.push(b.shaderID) : (c.push(a.fragmentShader), c.push(a.vertexShader)), void 0 !== a.defines)for (var d in a.defines)c.push(d), c.push(a.defines[d]);
        for (var e = 0; e < g.length; e++)c.push(b[g[e]]);
        return c.join()
    }, this.acquireProgram = function (b, c, d) {
        for (var f, g = 0, h = e.length; h > g; g++) {
            var i = e[g];
            if (i.code === d) {
                f = i, ++f.usedTimes;
                break
            }
        }
        return void 0 === f && (f = new THREE.WebGLProgram(a, d, b, c), e.push(f)), f
    }, this.releaseProgram = function (a) {
        if (0 === --a.usedTimes) {
            var b = e.indexOf(a);
            e[b] = e[e.length - 1], e.pop(), a.destroy()
        }
    }, this.programs = e
},THREE.WebGLProperties = function () {
    var a = {};
    this.get = function (b) {
        var c = b.uuid, d = a[c];
        return void 0 === d && (d = {}, a[c] = d), d
    }, this["delete"] = function (b) {
        delete a[b.uuid]
    }, this.clear = function () {
        a = {}
    }
},THREE.WebGLShader = function () {
    function a(a) {
        for (var b = a.split("\n"), c = 0; c < b.length; c++)b[c] = c + 1 + ": " + b[c];
        return b.join("\n")
    }

    return function (b, c, d) {
        var e = b.createShader(c);
        return b.shaderSource(e, d), b.compileShader(e), b.getShaderParameter(e, b.COMPILE_STATUS) === !1 && console.error("THREE.WebGLShader: Shader couldn't compile."), "" !== b.getShaderInfoLog(e) && console.warn("THREE.WebGLShader: gl.getShaderInfoLog()", c === b.VERTEX_SHADER ? "vertex" : "fragment", b.getShaderInfoLog(e), a(d)), e
    }
}(),THREE.WebGLShadowMap = function (a, b, c) {
    function d(b, c, d, e) {
        var f = b.geometry, g = null, h = r, i = b.customDepthMaterial;
        if (d && (h = s, i = b.customDistanceMaterial), i)g = i; else {
            var j = void 0 !== f.morphTargets && f.morphTargets.length > 0 && c.morphTargets, k = b instanceof THREE.SkinnedMesh && c.skinning, l = 0;
            j && (l |= o), k && (l |= p), g = h[l]
        }
        if (a.localClippingEnabled && c.clipShadows === !0 && 0 !== c.clippingPlanes.length) {
            var m = g.uuid, n = c.uuid, q = t[m];
            void 0 === q && (q = {}, t[m] = q);
            var u = q[n];
            void 0 === u && (u = g.clone(), q[n] = u), g = u
        }
        g.visible = c.visible, g.wireframe = c.wireframe;
        var v = c.side;
        return F.renderSingleSided && v == THREE.DoubleSide && (v = THREE.FrontSide), F.renderReverseSided && (v === THREE.FrontSide ? v = THREE.BackSide : v === THREE.BackSide && (v = THREE.FrontSide)), g.side = v, g.clipShadows = c.clipShadows, g.clippingPlanes = c.clippingPlanes, g.wireframeLinewidth = c.wireframeLinewidth, g.linewidth = c.linewidth, d && void 0 !== g.uniforms.lightPos && g.uniforms.lightPos.value.copy(e), g
    }

    function e(a, b, c) {
        if (a.visible !== !1) {
            if (a.layers.test(b.layers) && (a instanceof THREE.Mesh || a instanceof THREE.Line || a instanceof THREE.Points) && a.castShadow && (a.frustumCulled === !1 || h.intersectsObject(a) === !0)) {
                var d = a.material;
                d.visible === !0 && (a.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse, a.matrixWorld), n.push(a))
            }
            for (var f = a.children, g = 0, i = f.length; i > g; g++)e(f[g], b, c)
        }
    }

    var f = a.context, g = a.state, h = new THREE.Frustum, i = new THREE.Matrix4, j = b.shadows, k = new THREE.Vector2, l = new THREE.Vector3, m = new THREE.Vector3, n = [], o = 1, p = 2, q = (o | p) + 1, r = new Array(q), s = new Array(q), t = {}, u = [new THREE.Vector3(1, 0, 0), new THREE.Vector3(-1, 0, 0), new THREE.Vector3(0, 0, 1), new THREE.Vector3(0, 0, -1), new THREE.Vector3(0, 1, 0), new THREE.Vector3(0, -1, 0)], v = [new THREE.Vector3(0, 1, 0), new THREE.Vector3(0, 1, 0), new THREE.Vector3(0, 1, 0), new THREE.Vector3(0, 1, 0), new THREE.Vector3(0, 0, 1), new THREE.Vector3(0, 0, -1)], w = [new THREE.Vector4, new THREE.Vector4, new THREE.Vector4, new THREE.Vector4, new THREE.Vector4, new THREE.Vector4], x = new THREE.MeshDepthMaterial;
    x.depthPacking = THREE.RGBADepthPacking, x.clipping = !0;
    for (var y = THREE.ShaderLib.distanceRGBA, z = THREE.UniformsUtils.clone(y.uniforms), A = 0; A !== q; ++A) {
        var B = 0 !== (A & o), C = 0 !== (A & p), D = x.clone();
        D.morphTargets = B, D.skinning = C, r[A] = D;
        var E = new THREE.ShaderMaterial({
            defines: {USE_SHADOWMAP: ""},
            uniforms: z,
            vertexShader: y.vertexShader,
            fragmentShader: y.fragmentShader,
            morphTargets: B,
            skinning: C,
            clipping: !0
        });
        s[A] = E
    }
    var F = this;
    this.enabled = !1, this.autoUpdate = !0, this.needsUpdate = !1, this.type = THREE.PCFShadowMap, this.renderReverseSided = !0, this.renderSingleSided = !0, this.render = function (b, o) {
        if (F.enabled !== !1 && (F.autoUpdate !== !1 || F.needsUpdate !== !1) && 0 !== j.length) {
            g.clearColor(1, 1, 1, 1), g.disable(f.BLEND), g.setDepthTest(!0), g.setScissorTest(!1);
            for (var p, q, r = 0, s = j.length; s > r; r++) {
                var t = j[r], x = t.shadow;
                if (void 0 !== x) {
                    var y = x.camera;
                    if (k.copy(x.mapSize), t instanceof THREE.PointLight) {
                        p = 6, q = !0;
                        var z = k.x, A = k.y;
                        w[0].set(2 * z, A, z, A), w[1].set(0, A, z, A), w[2].set(3 * z, A, z, A), w[3].set(z, A, z, A), w[4].set(3 * z, 0, z, A), w[5].set(z, 0, z, A), k.x *= 4, k.y *= 2
                    } else p = 1, q = !1;
                    if (null === x.map) {
                        var B = {
                            minFilter: THREE.NearestFilter,
                            magFilter: THREE.NearestFilter,
                            format: THREE.RGBAFormat
                        };
                        x.map = new THREE.WebGLRenderTarget(k.x, k.y, B), y.updateProjectionMatrix()
                    }
                    x instanceof THREE.SpotLightShadow && x.update(t);
                    var C = x.map, D = x.matrix;
                    m.setFromMatrixPosition(t.matrixWorld), y.position.copy(m), a.setRenderTarget(C), a.clear();
                    for (var E = 0; p > E; E++) {
                        if (q) {
                            l.copy(y.position), l.add(u[E]), y.up.copy(v[E]), y.lookAt(l);
                            var G = w[E];
                            g.viewport(G)
                        } else l.setFromMatrixPosition(t.target.matrixWorld), y.lookAt(l);
                        y.updateMatrixWorld(), y.matrixWorldInverse.getInverse(y.matrixWorld), D.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), D.multiply(y.projectionMatrix), D.multiply(y.matrixWorldInverse), i.multiplyMatrices(y.projectionMatrix, y.matrixWorldInverse), h.setFromMatrix(i), n.length = 0, e(b, o, y);
                        for (var H = 0, I = n.length; I > H; H++) {
                            var J = n[H], K = c.update(J), L = J.material;
                            if (L instanceof THREE.MultiMaterial)for (var M = K.groups, N = L.materials, O = 0, P = M.length; P > O; O++) {
                                var Q = M[O], R = N[Q.materialIndex];
                                if (R.visible === !0) {
                                    var S = d(J, R, q, m);
                                    a.renderBufferDirect(y, null, K, S, J, Q)
                                }
                            } else {
                                var S = d(J, L, q, m);
                                a.renderBufferDirect(y, null, K, S, J, null)
                            }
                        }
                    }
                } else console.warn("THREE.WebGLShadowMap:", t, "has no shadow.")
            }
            var T = a.getClearColor(), U = a.getClearAlpha();
            a.setClearColor(T, U), F.needsUpdate = !1
        }
    }
},THREE.WebGLState = function (a, b, c) {
    function d(b, c, d) {
        var e = new Uint8Array(4), f = a.createTexture();
        a.bindTexture(b, f), a.texParameteri(b, a.TEXTURE_MIN_FILTER, a.NEAREST), a.texParameteri(b, a.TEXTURE_MAG_FILTER, a.NEAREST);
        for (var g = 0; d > g; g++)a.texImage2D(c + g, 0, a.RGBA, 1, 1, 0, a.RGBA, a.UNSIGNED_BYTE, e);
        return f
    }

    var e = this;
    this.buffers = {
        color: new THREE.WebGLColorBuffer(a, this),
        depth: new THREE.WebGLDepthBuffer(a, this),
        stencil: new THREE.WebGLStencilBuffer(a, this)
    };
    var f = a.getParameter(a.MAX_VERTEX_ATTRIBS), g = new Uint8Array(f), h = new Uint8Array(f), i = new Uint8Array(f), j = {}, k = null, l = null, m = null, n = null, o = null, p = null, q = null, r = null, s = !1, t = null, u = null, v = null, w = null, x = null, y = null, z = a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS), A = null, B = {}, C = new THREE.Vector4, D = new THREE.Vector4, E = {};
    E[a.TEXTURE_2D] = d(a.TEXTURE_2D, a.TEXTURE_2D, 1), E[a.TEXTURE_CUBE_MAP] = d(a.TEXTURE_CUBE_MAP, a.TEXTURE_CUBE_MAP_POSITIVE_X, 6), this.init = function () {
        this.clearColor(0, 0, 0, 1), this.clearDepth(1), this.clearStencil(0), this.enable(a.DEPTH_TEST), this.setDepthFunc(THREE.LessEqualDepth), this.setFlipSided(!1), this.setCullFace(THREE.CullFaceBack), this.enable(a.CULL_FACE), this.enable(a.BLEND), this.setBlending(THREE.NormalBlending)
    }, this.initAttributes = function () {
        for (var a = 0, b = g.length; b > a; a++)g[a] = 0
    }, this.enableAttribute = function (c) {
        if (g[c] = 1, 0 === h[c] && (a.enableVertexAttribArray(c), h[c] = 1), 0 !== i[c]) {
            var d = b.get("ANGLE_instanced_arrays");
            d.vertexAttribDivisorANGLE(c, 0), i[c] = 0
        }
    }, this.enableAttributeAndDivisor = function (b, c, d) {
        g[b] = 1, 0 === h[b] && (a.enableVertexAttribArray(b), h[b] = 1), i[b] !== c && (d.vertexAttribDivisorANGLE(b, c), i[b] = c)
    }, this.disableUnusedAttributes = function () {
        for (var b = 0, c = h.length; b !== c; ++b)h[b] !== g[b] && (a.disableVertexAttribArray(b), h[b] = 0)
    }, this.enable = function (b) {
        j[b] !== !0 && (a.enable(b), j[b] = !0)
    }, this.disable = function (b) {
        j[b] !== !1 && (a.disable(b), j[b] = !1)
    }, this.getCompressedTextureFormats = function () {
        if (null === k && (k = [], b.get("WEBGL_compressed_texture_pvrtc") || b.get("WEBGL_compressed_texture_s3tc") || b.get("WEBGL_compressed_texture_etc1")))for (var c = a.getParameter(a.COMPRESSED_TEXTURE_FORMATS), d = 0; d < c.length; d++)k.push(c[d]);
        return k
    }, this.setBlending = function (b, d, e, f, g, h, i, j) {
        return b === THREE.NoBlending ? (this.disable(a.BLEND), void(l = b)) : (this.enable(a.BLEND), (b !== l || j !== s) && (b === THREE.AdditiveBlending ? j ? (a.blendEquationSeparate(a.FUNC_ADD, a.FUNC_ADD), a.blendFuncSeparate(a.ONE, a.ONE, a.ONE, a.ONE)) : (a.blendEquation(a.FUNC_ADD), a.blendFunc(a.SRC_ALPHA, a.ONE)) : b === THREE.SubtractiveBlending ? j ? (a.blendEquationSeparate(a.FUNC_ADD, a.FUNC_ADD), a.blendFuncSeparate(a.ZERO, a.ZERO, a.ONE_MINUS_SRC_COLOR, a.ONE_MINUS_SRC_ALPHA)) : (a.blendEquation(a.FUNC_ADD), a.blendFunc(a.ZERO, a.ONE_MINUS_SRC_COLOR)) : b === THREE.MultiplyBlending ? j ? (a.blendEquationSeparate(a.FUNC_ADD, a.FUNC_ADD), a.blendFuncSeparate(a.ZERO, a.SRC_COLOR, a.ZERO, a.SRC_ALPHA)) : (a.blendEquation(a.FUNC_ADD), a.blendFunc(a.ZERO, a.SRC_COLOR)) : j ? (a.blendEquationSeparate(a.FUNC_ADD, a.FUNC_ADD), a.blendFuncSeparate(a.ONE, a.ONE_MINUS_SRC_ALPHA, a.ONE, a.ONE_MINUS_SRC_ALPHA)) : (a.blendEquationSeparate(a.FUNC_ADD, a.FUNC_ADD), a.blendFuncSeparate(a.SRC_ALPHA, a.ONE_MINUS_SRC_ALPHA, a.ONE, a.ONE_MINUS_SRC_ALPHA)), l = b, s = j), void(b === THREE.CustomBlending ? (g = g || d, h = h || e, i = i || f, (d !== m || g !== p) && (a.blendEquationSeparate(c(d), c(g)), m = d, p = g), (e !== n || f !== o || h !== q || i !== r) && (a.blendFuncSeparate(c(e), c(f), c(h), c(i)), n = e, o = f, q = h, r = i)) : (m = null, n = null, o = null, p = null, q = null, r = null)))
    }, this.setColorWrite = function (a) {
        this.buffers.color.setMask(a)
    }, this.setDepthTest = function (a) {
        this.buffers.depth.setTest(a)
    }, this.setDepthWrite = function (a) {
        this.buffers.depth.setMask(a)
    }, this.setDepthFunc = function (a) {
        this.buffers.depth.setFunc(a)
    }, this.setStencilTest = function (a) {
        this.buffers.stencil.setTest(a)
    }, this.setStencilWrite = function (a) {
        this.buffers.stencil.setMask(a)
    }, this.setStencilFunc = function (a, b, c) {
        this.buffers.stencil.setFunc(a, b, c)
    }, this.setStencilOp = function (a, b, c) {
        this.buffers.stencil.setOp(a, b, c)
    }, this.setFlipSided = function (b) {
        t !== b && (b ? a.frontFace(a.CW) : a.frontFace(a.CCW), t = b)
    }, this.setCullFace = function (b) {
        b !== THREE.CullFaceNone ? (this.enable(a.CULL_FACE), b !== u && (b === THREE.CullFaceBack ? a.cullFace(a.BACK) : b === THREE.CullFaceFront ? a.cullFace(a.FRONT) : a.cullFace(a.FRONT_AND_BACK))) : this.disable(a.CULL_FACE), u = b
    }, this.setLineWidth = function (b) {
        b !== v && (a.lineWidth(b), v = b)
    }, this.setPolygonOffset = function (b, c, d) {
        b ? (this.enable(a.POLYGON_OFFSET_FILL), (w !== c || x !== d) && (a.polygonOffset(c, d), w = c, x = d)) : this.disable(a.POLYGON_OFFSET_FILL)
    }, this.getScissorTest = function () {
        return y
    }, this.setScissorTest = function (b) {
        y = b, b ? this.enable(a.SCISSOR_TEST) : this.disable(a.SCISSOR_TEST)
    }, this.activeTexture = function (b) {
        void 0 === b && (b = a.TEXTURE0 + z - 1), A !== b && (a.activeTexture(b), A = b)
    }, this.bindTexture = function (b, c) {
        null === A && e.activeTexture();
        var d = B[A];
        void 0 === d && (d = {
            type: void 0,
            texture: void 0
        }, B[A] = d), (d.type !== b || d.texture !== c) && (a.bindTexture(b, c || E[b]), d.type = b, d.texture = c)
    }, this.compressedTexImage2D = function () {
        try {
            a.compressedTexImage2D.apply(a, arguments)
        } catch (b) {
            console.error(b)
        }
    }, this.texImage2D = function () {
        try {
            a.texImage2D.apply(a, arguments)
        } catch (b) {
            console.error(b)
        }
    }, this.clearColor = function (a, b, c, d) {
        this.buffers.color.setClear(a, b, c, d)
    }, this.clearDepth = function (a) {
        this.buffers.depth.setClear(a)
    }, this.clearStencil = function (a) {
        this.buffers.stencil.setClear(a)
    }, this.scissor = function (b) {
        C.equals(b) === !1 && (a.scissor(b.x, b.y, b.z, b.w), C.copy(b))
    }, this.viewport = function (b) {
        D.equals(b) === !1 && (a.viewport(b.x, b.y, b.z, b.w), D.copy(b))
    }, this.reset = function () {
        for (var b = 0; b < h.length; b++)1 === h[b] && (a.disableVertexAttribArray(b), h[b] = 0);
        j = {}, k = null, A = null, B = {}, l = null, t = null, u = null, this.buffers.color.reset(), this.buffers.depth.reset(), this.buffers.stencil.reset()
    }
},THREE.WebGLColorBuffer = function (a, b) {
    var c = !1, d = new THREE.Vector4, e = null, f = new THREE.Vector4;
    this.setMask = function (b) {
        e === b || c || (a.colorMask(b, b, b, b), e = b)
    }, this.setLocked = function (a) {
        c = a
    }, this.setClear = function (b, c, e, g) {
        d.set(b, c, e, g), f.equals(d) === !1 && (a.clearColor(b, c, e, g), f.copy(d))
    }, this.reset = function () {
        c = !1, e = null, f = new THREE.Vector4
    }
},THREE.WebGLDepthBuffer = function (a, b) {
    var c = !1, d = null, e = null, f = null;
    this.setTest = function (c) {
        c ? b.enable(a.DEPTH_TEST) : b.disable(a.DEPTH_TEST)
    }, this.setMask = function (b) {
        d === b || c || (a.depthMask(b), d = b)
    }, this.setFunc = function (b) {
        if (e !== b) {
            if (b)switch (b) {
                case THREE.NeverDepth:
                    a.depthFunc(a.NEVER);
                    break;
                case THREE.AlwaysDepth:
                    a.depthFunc(a.ALWAYS);
                    break;
                case THREE.LessDepth:
                    a.depthFunc(a.LESS);
                    break;
                case THREE.LessEqualDepth:
                    a.depthFunc(a.LEQUAL);
                    break;
                case THREE.EqualDepth:
                    a.depthFunc(a.EQUAL);
                    break;
                case THREE.GreaterEqualDepth:
                    a.depthFunc(a.GEQUAL);
                    break;
                case THREE.GreaterDepth:
                    a.depthFunc(a.GREATER);
                    break;
                case THREE.NotEqualDepth:
                    a.depthFunc(a.NOTEQUAL);
                    break;
                default:
                    a.depthFunc(a.LEQUAL)
            } else a.depthFunc(a.LEQUAL);
            e = b
        }
    }, this.setLocked = function (a) {
        c = a
    }, this.setClear = function (b) {
        f !== b && (a.clearDepth(b), f = b)
    }, this.reset = function () {
        c = !1, d = null, e = null, f = null
    }
},THREE.WebGLStencilBuffer = function (a, b) {
    var c = !1, d = null, e = null, f = null, g = null, h = null, i = null, j = null, k = null;
    this.setTest = function (c) {
        c ? b.enable(a.STENCIL_TEST) : b.disable(a.STENCIL_TEST)
    }, this.setMask = function (b) {
        d === b || c || (a.stencilMask(b), d = b)
    }, this.setFunc = function (b, c, d) {
        (e !== b || f !== c || g !== d) && (a.stencilFunc(b, c, d), e = b, f = c, g = d)
    }, this.setOp = function (b, c, d) {
        (h !== b || i !== c || j !== d) && (a.stencilOp(b, c, d), h = b, i = c, j = d)
    }, this.setLocked = function (a) {
        c = a
    }, this.setClear = function (b) {
        k !== b && (a.clearStencil(b), k = b)
    }, this.reset = function () {
        c = !1, d = null, e = null, f = null, g = null, h = null, i = null, j = null, k = null
    }
},THREE.WebGLTextures = function (a, b, c, d, e, f, g) {
    function h(a, b) {
        if (a.width > b || a.height > b) {
            var c = b / Math.max(a.width, a.height), d = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas");
            d.width = Math.floor(a.width * c), d.height = Math.floor(a.height * c);
            var e = d.getContext("2d");
            return e.drawImage(a, 0, 0, a.width, a.height, 0, 0, d.width, d.height), console.warn("THREE.WebGLRenderer: image is too big (" + a.width + "x" + a.height + "). Resized to " + d.width + "x" + d.height, a), d
        }
        return a
    }

    function i(a) {
        return THREE.Math.isPowerOfTwo(a.width) && THREE.Math.isPowerOfTwo(a.height)
    }

    function j(a) {
        if (a instanceof HTMLImageElement || a instanceof HTMLCanvasElement) {
            var b = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas");
            b.width = THREE.Math.nearestPowerOfTwo(a.width), b.height = THREE.Math.nearestPowerOfTwo(a.height);
            var c = b.getContext("2d");
            return c.drawImage(a, 0, 0, b.width, b.height), console.warn("THREE.WebGLRenderer: image is not power of two (" + a.width + "x" + a.height + "). Resized to " + b.width + "x" + b.height, a), b
        }
        return a
    }

    function k(a) {
        return a.wrapS !== THREE.ClampToEdgeWrapping || a.wrapT !== THREE.ClampToEdgeWrapping ? !0 : a.minFilter !== THREE.NearestFilter && a.minFilter !== THREE.LinearFilter ? !0 : !1
    }

    function l(b) {
        return b === THREE.NearestFilter || b === THREE.NearestMipMapNearestFilter || b === THREE.NearestMipMapLinearFilter ? a.NEAREST : a.LINEAR
    }

    function m(a) {
        var b = a.target;
        b.removeEventListener("dispose", m), o(b), B.textures--
    }

    function n(a) {
        var b = a.target;
        b.removeEventListener("dispose", n), p(b), B.textures--
    }

    function o(b) {
        var c = d.get(b);
        if (b.image && c.__image__webglTextureCube)a.deleteTexture(c.__image__webglTextureCube); else {
            if (void 0 === c.__webglInit)return;
            a.deleteTexture(c.__webglTexture)
        }
        d["delete"](b)
    }

    function p(b) {
        var c = d.get(b), e = d.get(b.texture);
        if (b) {
            if (void 0 !== e.__webglTexture && a.deleteTexture(e.__webglTexture), b.depthTexture && b.depthTexture.dispose(), b instanceof THREE.WebGLRenderTargetCube)for (var f = 0; 6 > f; f++)a.deleteFramebuffer(c.__webglFramebuffer[f]), c.__webglDepthbuffer && a.deleteRenderbuffer(c.__webglDepthbuffer[f]); else a.deleteFramebuffer(c.__webglFramebuffer), c.__webglDepthbuffer && a.deleteRenderbuffer(c.__webglDepthbuffer);
            d["delete"](b.texture), d["delete"](b)
        }
    }

    function q(b, e) {
        var f = d.get(b);
        if (b.version > 0 && f.__version !== b.version) {
            var g = b.image;
            if (void 0 === g)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined", b); else {
                if (g.complete !== !1)return void u(f, b, e);
                console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete", b)
            }
        }
        c.activeTexture(a.TEXTURE0 + e), c.bindTexture(a.TEXTURE_2D, f.__webglTexture)
    }

    function r(b, g) {
        var j = d.get(b);
        if (6 === b.image.length)if (b.version > 0 && j.__version !== b.version) {
            j.__image__webglTextureCube || (b.addEventListener("dispose", m), j.__image__webglTextureCube = a.createTexture(), B.textures++), c.activeTexture(a.TEXTURE0 + g), c.bindTexture(a.TEXTURE_CUBE_MAP, j.__image__webglTextureCube), a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL, b.flipY);
            for (var k = b instanceof THREE.CompressedTexture, l = b.image[0] instanceof THREE.DataTexture, n = [], o = 0; 6 > o; o++)k || l ? n[o] = l ? b.image[o].image : b.image[o] : n[o] = h(b.image[o], e.maxCubemapSize);
            var p = n[0], q = i(p), r = f(b.format), s = f(b.type);
            t(a.TEXTURE_CUBE_MAP, b, q);
            for (var o = 0; 6 > o; o++)if (k)for (var u, v = n[o].mipmaps, w = 0, x = v.length; x > w; w++)u = v[w], b.format !== THREE.RGBAFormat && b.format !== THREE.RGBFormat ? c.getCompressedTextureFormats().indexOf(r) > -1 ? c.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X + o, w, r, u.width, u.height, 0, u.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()") : c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X + o, w, r, u.width, u.height, 0, r, s, u.data); else l ? c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X + o, 0, r, n[o].width, n[o].height, 0, r, s, n[o].data) : c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X + o, 0, r, r, s, n[o]);
            b.generateMipmaps && q && a.generateMipmap(a.TEXTURE_CUBE_MAP), j.__version = b.version, b.onUpdate && b.onUpdate(b)
        } else c.activeTexture(a.TEXTURE0 + g), c.bindTexture(a.TEXTURE_CUBE_MAP, j.__image__webglTextureCube)
    }

    function s(b, e) {
        c.activeTexture(a.TEXTURE0 + e), c.bindTexture(a.TEXTURE_CUBE_MAP, d.get(b).__webglTexture)
    }

    function t(c, g, h) {
        var i;
        if (h ? (a.texParameteri(c, a.TEXTURE_WRAP_S, f(g.wrapS)), a.texParameteri(c, a.TEXTURE_WRAP_T, f(g.wrapT)), a.texParameteri(c, a.TEXTURE_MAG_FILTER, f(g.magFilter)), a.texParameteri(c, a.TEXTURE_MIN_FILTER, f(g.minFilter))) : (a.texParameteri(c, a.TEXTURE_WRAP_S, a.CLAMP_TO_EDGE), a.texParameteri(c, a.TEXTURE_WRAP_T, a.CLAMP_TO_EDGE), (g.wrapS !== THREE.ClampToEdgeWrapping || g.wrapT !== THREE.ClampToEdgeWrapping) && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.", g), a.texParameteri(c, a.TEXTURE_MAG_FILTER, l(g.magFilter)), a.texParameteri(c, a.TEXTURE_MIN_FILTER, l(g.minFilter)), g.minFilter !== THREE.NearestFilter && g.minFilter !== THREE.LinearFilter && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.", g)), i = b.get("EXT_texture_filter_anisotropic")) {
            if (g.type === THREE.FloatType && null === b.get("OES_texture_float_linear"))return;
            if (g.type === THREE.HalfFloatType && null === b.get("OES_texture_half_float_linear"))return;
            (g.anisotropy > 1 || d.get(g).__currentAnisotropy) && (a.texParameterf(c, i.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(g.anisotropy, e.getMaxAnisotropy())), d.get(g).__currentAnisotropy = g.anisotropy)
        }
    }

    function u(b, d, g) {
        void 0 === b.__webglInit && (b.__webglInit = !0, d.addEventListener("dispose", m), b.__webglTexture = a.createTexture(), B.textures++), c.activeTexture(a.TEXTURE0 + g), c.bindTexture(a.TEXTURE_2D, b.__webglTexture), a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL, d.flipY), a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL, d.premultiplyAlpha), a.pixelStorei(a.UNPACK_ALIGNMENT, d.unpackAlignment);
        var l = h(d.image, e.maxTextureSize);
        k(d) && i(l) === !1 && (l = j(l));
        var n = i(l), o = f(d.format), p = f(d.type);
        t(a.TEXTURE_2D, d, n);
        var q, r = d.mipmaps;
        if (d instanceof THREE.DepthTexture) {
            var s = a.DEPTH_COMPONENT;
            if (d.type === THREE.FloatType) {
                if (!C)throw new Error("Float Depth Texture only supported in WebGL2.0");
                s = a.DEPTH_COMPONENT32F
            } else C && (s = a.DEPTH_COMPONENT16);
            c.texImage2D(a.TEXTURE_2D, 0, s, l.width, l.height, 0, o, p, null)
        } else if (d instanceof THREE.DataTexture)if (r.length > 0 && n) {
            for (var u = 0, v = r.length; v > u; u++)q = r[u], c.texImage2D(a.TEXTURE_2D, u, o, q.width, q.height, 0, o, p, q.data);
            d.generateMipmaps = !1
        } else c.texImage2D(a.TEXTURE_2D, 0, o, l.width, l.height, 0, o, p, l.data); else if (d instanceof THREE.CompressedTexture)for (var u = 0, v = r.length; v > u; u++)q = r[u], d.format !== THREE.RGBAFormat && d.format !== THREE.RGBFormat ? c.getCompressedTextureFormats().indexOf(o) > -1 ? c.compressedTexImage2D(a.TEXTURE_2D, u, o, q.width, q.height, 0, q.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : c.texImage2D(a.TEXTURE_2D, u, o, q.width, q.height, 0, o, p, q.data); else if (r.length > 0 && n) {
            for (var u = 0, v = r.length; v > u; u++)q = r[u], c.texImage2D(a.TEXTURE_2D, u, o, o, p, q);
            d.generateMipmaps = !1
        } else c.texImage2D(a.TEXTURE_2D, 0, o, o, p, l);
        d.generateMipmaps && n && a.generateMipmap(a.TEXTURE_2D), b.__version = d.version, d.onUpdate && d.onUpdate(d)
    }

    function v(b, e, g, h) {
        var i = f(e.texture.format), j = f(e.texture.type);
        c.texImage2D(h, 0, i, e.width, e.height, 0, i, j, null), a.bindFramebuffer(a.FRAMEBUFFER, b), a.framebufferTexture2D(a.FRAMEBUFFER, g, h, d.get(e.texture).__webglTexture, 0), a.bindFramebuffer(a.FRAMEBUFFER, null)
    }

    function w(b, c) {
        a.bindRenderbuffer(a.RENDERBUFFER, b), c.depthBuffer && !c.stencilBuffer ? (a.renderbufferStorage(a.RENDERBUFFER, a.DEPTH_COMPONENT16, c.width, c.height), a.framebufferRenderbuffer(a.FRAMEBUFFER, a.DEPTH_ATTACHMENT, a.RENDERBUFFER, b)) : c.depthBuffer && c.stencilBuffer ? (a.renderbufferStorage(a.RENDERBUFFER, a.DEPTH_STENCIL, c.width, c.height), a.framebufferRenderbuffer(a.FRAMEBUFFER, a.DEPTH_STENCIL_ATTACHMENT, a.RENDERBUFFER, b)) : a.renderbufferStorage(a.RENDERBUFFER, a.RGBA4, c.width, c.height), a.bindRenderbuffer(a.RENDERBUFFER, null)
    }

    function x(b, c) {
        var e = c instanceof THREE.WebGLRenderTargetCube;
        if (e)throw new Error("Depth Texture with cube render targets is not supported!");
        if (a.bindFramebuffer(a.FRAMEBUFFER, b), !(c.depthTexture instanceof THREE.DepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
        d.get(c.depthTexture).__webglTexture && c.depthTexture.image.width === c.width && c.depthTexture.image.height === c.height || (c.depthTexture.image.width = c.width, c.depthTexture.image.height = c.height, c.depthTexture.needsUpdate = !0), q(c.depthTexture, 0);
        var f = d.get(c.depthTexture).__webglTexture;
        a.framebufferTexture2D(a.FRAMEBUFFER, a.DEPTH_ATTACHMENT, a.TEXTURE_2D, f, 0)
    }

    function y(b) {
        var c = d.get(b), e = b instanceof THREE.WebGLRenderTargetCube;
        if (b.depthTexture) {
            if (e)throw new Error("target.depthTexture not supported in Cube render targets");
            x(c.__webglFramebuffer, b)
        } else if (e) {
            c.__webglDepthbuffer = [];
            for (var f = 0; 6 > f; f++)a.bindFramebuffer(a.FRAMEBUFFER, c.__webglFramebuffer[f]), c.__webglDepthbuffer[f] = a.createRenderbuffer(), w(c.__webglDepthbuffer[f], b)
        } else a.bindFramebuffer(a.FRAMEBUFFER, c.__webglFramebuffer), c.__webglDepthbuffer = a.createRenderbuffer(), w(c.__webglDepthbuffer, b);
        a.bindFramebuffer(a.FRAMEBUFFER, null)
    }

    function z(b) {
        var e = d.get(b), f = d.get(b.texture);
        b.addEventListener("dispose", n), f.__webglTexture = a.createTexture(), B.textures++;
        var g = b instanceof THREE.WebGLRenderTargetCube, h = i(b);
        if (g) {
            e.__webglFramebuffer = [];
            for (var j = 0; 6 > j; j++)e.__webglFramebuffer[j] = a.createFramebuffer()
        } else e.__webglFramebuffer = a.createFramebuffer();
        if (g) {
            c.bindTexture(a.TEXTURE_CUBE_MAP, f.__webglTexture), t(a.TEXTURE_CUBE_MAP, b.texture, h);
            for (var j = 0; 6 > j; j++)v(e.__webglFramebuffer[j], b, a.COLOR_ATTACHMENT0, a.TEXTURE_CUBE_MAP_POSITIVE_X + j);
            b.texture.generateMipmaps && h && a.generateMipmap(a.TEXTURE_CUBE_MAP), c.bindTexture(a.TEXTURE_CUBE_MAP, null)
        } else c.bindTexture(a.TEXTURE_2D, f.__webglTexture), t(a.TEXTURE_2D, b.texture, h), v(e.__webglFramebuffer, b, a.COLOR_ATTACHMENT0, a.TEXTURE_2D), b.texture.generateMipmaps && h && a.generateMipmap(a.TEXTURE_2D), c.bindTexture(a.TEXTURE_2D, null);
        b.depthBuffer && y(b)
    }

    function A(b) {
        var e = b.texture;
        if (e.generateMipmaps && i(b) && e.minFilter !== THREE.NearestFilter && e.minFilter !== THREE.LinearFilter) {
            var f = b instanceof THREE.WebGLRenderTargetCube ? a.TEXTURE_CUBE_MAP : a.TEXTURE_2D, g = d.get(e).__webglTexture;
            c.bindTexture(f, g), a.generateMipmap(f), c.bindTexture(f, null)
        }
    }

    var B = g.memory, C = "undefined" != typeof WebGL2RenderingContext && a instanceof WebGL2RenderingContext;
    this.setTexture2D = q, this.setTextureCube = r, this.setTextureCubeDynamic = s, this.setupRenderTarget = z, this.updateRenderTargetMipmap = A
},THREE.WebGLUniforms = function () {
    var a = new THREE.Texture, b = new THREE.CubeTexture, c = function () {
        this.seq = [], this.map = {}
    }, d = [], e = [], f = function (a, b, c) {
        var e = a[0];
        if (0 >= e || e > 0)return a;
        var f = b * c, g = d[f];
        if (void 0 === g && (g = new Float32Array(f), d[f] = g), 0 !== b) {
            e.toArray(g, 0);
            for (var h = 1, i = 0; h !== b; ++h)i += c, a[h].toArray(g, i)
        }
        return g
    }, g = function (a, b) {
        var c = e[b];
        void 0 === c && (c = new Int32Array(b), e[b] = c);
        for (var d = 0; d !== b; ++d)c[d] = a.allocTextureUnit();
        return c
    }, h = function (a, b) {
        a.uniform1f(this.addr, b)
    }, i = function (a, b) {
        a.uniform1i(this.addr, b)
    }, j = function (a, b) {
        void 0 === b.x ? a.uniform2fv(this.addr, b) : a.uniform2f(this.addr, b.x, b.y)
    }, k = function (a, b) {
        void 0 !== b.x ? a.uniform3f(this.addr, b.x, b.y, b.z) : void 0 !== b.r ? a.uniform3f(this.addr, b.r, b.g, b.b) : a.uniform3fv(this.addr, b)
    }, l = function (a, b) {
        void 0 === b.x ? a.uniform4fv(this.addr, b) : a.uniform4f(this.addr, b.x, b.y, b.z, b.w)
    }, m = function (a, b) {
        a.uniformMatrix2fv(this.addr, !1, b.elements || b)
    }, n = function (a, b) {
        a.uniformMatrix3fv(this.addr, !1, b.elements || b)
    }, o = function (a, b) {
        a.uniformMatrix4fv(this.addr, !1, b.elements || b)
    }, p = function (b, c, d) {
        var e = d.allocTextureUnit();
        b.uniform1i(this.addr, e),
            d.setTexture2D(c || a, e)
    }, q = function (a, c, d) {
        var e = d.allocTextureUnit();
        a.uniform1i(this.addr, e), d.setTextureCube(c || b, e)
    }, r = function (a, b) {
        a.uniform2iv(this.addr, b)
    }, s = function (a, b) {
        a.uniform3iv(this.addr, b)
    }, t = function (a, b) {
        a.uniform4iv(this.addr, b)
    }, u = function (a) {
        switch (a) {
            case 5126:
                return h;
            case 35664:
                return j;
            case 35665:
                return k;
            case 35666:
                return l;
            case 35674:
                return m;
            case 35675:
                return n;
            case 35676:
                return o;
            case 35678:
                return p;
            case 35680:
                return q;
            case 5124:
            case 35670:
                return i;
            case 35667:
            case 35671:
                return r;
            case 35668:
            case 35672:
                return s;
            case 35669:
            case 35673:
                return t
        }
    }, v = function (a, b) {
        a.uniform1fv(this.addr, b)
    }, w = function (a, b) {
        a.uniform1iv(this.addr, b)
    }, x = function (a, b) {
        a.uniform2fv(this.addr, f(b, this.size, 2))
    }, y = function (a, b) {
        a.uniform3fv(this.addr, f(b, this.size, 3))
    }, z = function (a, b) {
        a.uniform4fv(this.addr, f(b, this.size, 4))
    }, A = function (a, b) {
        a.uniformMatrix2fv(this.addr, !1, f(b, this.size, 4))
    }, B = function (a, b) {
        a.uniformMatrix3fv(this.addr, !1, f(b, this.size, 9))
    }, C = function (a, b) {
        a.uniformMatrix4fv(this.addr, !1, f(b, this.size, 16))
    }, D = function (b, c, d) {
        var e = c.length, f = g(d, e);
        b.uniform1iv(this.addr, f);
        for (var h = 0; h !== e; ++h)d.setTexture2D(c[h] || a, f[h])
    }, E = function (a, c, d) {
        var e = c.length, f = g(d, e);
        a.uniform1iv(this.addr, f);
        for (var h = 0; h !== e; ++h)d.setTextureCube(c[h] || b, f[h])
    }, F = function (a) {
        switch (a) {
            case 5126:
                return v;
            case 35664:
                return x;
            case 35665:
                return y;
            case 35666:
                return z;
            case 35674:
                return A;
            case 35675:
                return B;
            case 35676:
                return C;
            case 35678:
                return D;
            case 35680:
                return E;
            case 5124:
            case 35670:
                return w;
            case 35667:
            case 35671:
                return r;
            case 35668:
            case 35672:
                return s;
            case 35669:
            case 35673:
                return t
        }
    }, G = function (a, b, c) {
        this.id = a, this.addr = c, this.setValue = u(b.type)
    }, H = function (a, b, c) {
        this.id = a, this.addr = c, this.size = b.size, this.setValue = F(b.type)
    }, I = function (a) {
        this.id = a, c.call(this)
    };
    I.prototype.setValue = function (a, b) {
        for (var c = this.seq, d = 0, e = c.length; d !== e; ++d) {
            var f = c[d];
            f.setValue(a, b[f.id])
        }
    };
    var J = /([\w\d_]+)(\])?(\[|\.)?/g, K = function (a, b) {
        a.seq.push(b), a.map[b.id] = b
    }, L = function (a, b, c) {
        var d = a.name, e = d.length;
        for (J.lastIndex = 0; ;) {
            var f = J.exec(d), g = J.lastIndex, h = f[1], i = "]" === f[2], j = f[3];
            if (i && (h = 0 | h), void 0 === j || "[" === j && g + 2 === e) {
                K(c, void 0 === j ? new G(h, a, b) : new H(h, a, b));
                break
            }
            var k = c.map, l = k[h];
            void 0 === l && (l = new I(h), K(c, l)), c = l
        }
    }, M = function (a, b, d) {
        c.call(this), this.renderer = d;
        for (var e = a.getProgramParameter(b, a.ACTIVE_UNIFORMS), f = 0; f !== e; ++f) {
            var g = a.getActiveUniform(b, f), h = g.name, i = a.getUniformLocation(b, h);
            L(g, i, this)
        }
    };
    return M.prototype.setValue = function (a, b, c) {
        var d = this.map[b];
        void 0 !== d && d.setValue(a, c, this.renderer)
    }, M.prototype.set = function (a, b, c) {
        var d = this.map[c];
        void 0 !== d && d.setValue(a, b[c], this.renderer)
    }, M.prototype.setOptional = function (a, b, c) {
        var d = b[c];
        void 0 !== d && this.setValue(a, c, d)
    }, M.upload = function (a, b, c, d) {
        for (var e = 0, f = b.length; e !== f; ++e) {
            var g = b[e], h = c[g.id];
            h.needsUpdate !== !1 && g.setValue(a, h.value, d)
        }
    }, M.seqWithValue = function (a, b) {
        for (var c = [], d = 0, e = a.length; d !== e; ++d) {
            var f = a[d];
            f.id in b && c.push(f)
        }
        return c
    }, M.splitDynamic = function (a, b) {
        for (var c = null, d = a.length, e = 0, f = 0; f !== d; ++f) {
            var g = a[f], h = b[g.id];
            h && h.dynamic === !0 ? (null === c && (c = []), c.push(g)) : (f > e && (a[e] = g), ++e)
        }
        return d > e && (a.length = e), c
    }, M.evalDynamic = function (a, b, c, d) {
        for (var e = 0, f = a.length; e !== f; ++e) {
            var g = b[a[e].id], h = g.onUpdateCallback;
            void 0 !== h && h.call(g, c, d)
        }
    }, M
}(),THREE.LensFlarePlugin = function (a, b) {
    function c() {
        var a = new Float32Array([-1, -1, 0, 0, 1, -1, 1, 0, 1, 1, 1, 1, -1, 1, 0, 1]), b = new Uint16Array([0, 1, 2, 0, 2, 3]);
        e = m.createBuffer(), f = m.createBuffer(), m.bindBuffer(m.ARRAY_BUFFER, e), m.bufferData(m.ARRAY_BUFFER, a, m.STATIC_DRAW), m.bindBuffer(m.ELEMENT_ARRAY_BUFFER, f), m.bufferData(m.ELEMENT_ARRAY_BUFFER, b, m.STATIC_DRAW), k = m.createTexture(), l = m.createTexture(), n.bindTexture(m.TEXTURE_2D, k), m.texImage2D(m.TEXTURE_2D, 0, m.RGB, 16, 16, 0, m.RGB, m.UNSIGNED_BYTE, null), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_WRAP_S, m.CLAMP_TO_EDGE), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_WRAP_T, m.CLAMP_TO_EDGE), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_MAG_FILTER, m.NEAREST), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_MIN_FILTER, m.NEAREST), n.bindTexture(m.TEXTURE_2D, l), m.texImage2D(m.TEXTURE_2D, 0, m.RGBA, 16, 16, 0, m.RGBA, m.UNSIGNED_BYTE, null), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_WRAP_S, m.CLAMP_TO_EDGE), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_WRAP_T, m.CLAMP_TO_EDGE), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_MAG_FILTER, m.NEAREST), m.texParameteri(m.TEXTURE_2D, m.TEXTURE_MIN_FILTER, m.NEAREST), g = {
            vertexShader: ["uniform lowp int renderType;", "uniform vec3 screenPosition;", "uniform vec2 scale;", "uniform float rotation;", "uniform sampler2D occlusionMap;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "varying float vVisibility;", "void main() {", "vUV = uv;", "vec2 pos = position;", "if ( renderType == 2 ) {", "vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );", "visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );", "visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );", "visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );", "visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );", "vVisibility =        visibility.r / 9.0;", "vVisibility *= 1.0 - visibility.g / 9.0;", "vVisibility *=       visibility.b / 9.0;", "vVisibility *= 1.0 - visibility.a / 9.0;", "pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;", "pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;", "}", "gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );", "}"].join("\n"),
            fragmentShader: ["uniform lowp int renderType;", "uniform sampler2D map;", "uniform float opacity;", "uniform vec3 color;", "varying vec2 vUV;", "varying float vVisibility;", "void main() {", "if ( renderType == 0 ) {", "gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );", "} else if ( renderType == 1 ) {", "gl_FragColor = texture2D( map, vUV );", "} else {", "vec4 texture = texture2D( map, vUV );", "texture.a *= opacity * vVisibility;", "gl_FragColor = texture;", "gl_FragColor.rgb *= color;", "}", "}"].join("\n")
        }, h = d(g), i = {
            vertex: m.getAttribLocation(h, "position"),
            uv: m.getAttribLocation(h, "uv")
        }, j = {
            renderType: m.getUniformLocation(h, "renderType"),
            map: m.getUniformLocation(h, "map"),
            occlusionMap: m.getUniformLocation(h, "occlusionMap"),
            opacity: m.getUniformLocation(h, "opacity"),
            color: m.getUniformLocation(h, "color"),
            scale: m.getUniformLocation(h, "scale"),
            rotation: m.getUniformLocation(h, "rotation"),
            screenPosition: m.getUniformLocation(h, "screenPosition")
        }
    }

    function d(b) {
        var c = m.createProgram(), d = m.createShader(m.FRAGMENT_SHADER), e = m.createShader(m.VERTEX_SHADER), f = "precision " + a.getPrecision() + " float;\n";
        return m.shaderSource(d, f + b.fragmentShader), m.shaderSource(e, f + b.vertexShader), m.compileShader(d), m.compileShader(e), m.attachShader(c, d), m.attachShader(c, e), m.linkProgram(c), c
    }

    var e, f, g, h, i, j, k, l, m = a.context, n = a.state;
    this.render = function (d, g, o) {
        if (0 !== b.length) {
            var p = new THREE.Vector3, q = o.w / o.z, r = .5 * o.z, s = .5 * o.w, t = 16 / o.w, u = new THREE.Vector2(t * q, t), v = new THREE.Vector3(1, 1, 0), w = new THREE.Vector2(1, 1), x = new THREE.Box2;
            x.min.set(0, 0), x.max.set(o.z - 16, o.w - 16), void 0 === h && c(), m.useProgram(h), n.initAttributes(), n.enableAttribute(i.vertex), n.enableAttribute(i.uv), n.disableUnusedAttributes(), m.uniform1i(j.occlusionMap, 0), m.uniform1i(j.map, 1), m.bindBuffer(m.ARRAY_BUFFER, e), m.vertexAttribPointer(i.vertex, 2, m.FLOAT, !1, 16, 0), m.vertexAttribPointer(i.uv, 2, m.FLOAT, !1, 16, 8), m.bindBuffer(m.ELEMENT_ARRAY_BUFFER, f), n.disable(m.CULL_FACE), n.setDepthWrite(!1);
            for (var y = 0, z = b.length; z > y; y++) {
                t = 16 / o.w, u.set(t * q, t);
                var A = b[y];
                if (p.set(A.matrixWorld.elements[12], A.matrixWorld.elements[13], A.matrixWorld.elements[14]), p.applyMatrix4(g.matrixWorldInverse), p.applyProjection(g.projectionMatrix), v.copy(p), w.x = o.x + v.x * r + r - 8, w.y = o.y + v.y * s + s - 8, x.containsPoint(w) === !0) {
                    n.activeTexture(m.TEXTURE0), n.bindTexture(m.TEXTURE_2D, null), n.activeTexture(m.TEXTURE1), n.bindTexture(m.TEXTURE_2D, k), m.copyTexImage2D(m.TEXTURE_2D, 0, m.RGB, w.x, w.y, 16, 16, 0), m.uniform1i(j.renderType, 0), m.uniform2f(j.scale, u.x, u.y), m.uniform3f(j.screenPosition, v.x, v.y, v.z), n.disable(m.BLEND), n.enable(m.DEPTH_TEST), m.drawElements(m.TRIANGLES, 6, m.UNSIGNED_SHORT, 0), n.activeTexture(m.TEXTURE0), n.bindTexture(m.TEXTURE_2D, l), m.copyTexImage2D(m.TEXTURE_2D, 0, m.RGBA, w.x, w.y, 16, 16, 0), m.uniform1i(j.renderType, 1), n.disable(m.DEPTH_TEST), n.activeTexture(m.TEXTURE1), n.bindTexture(m.TEXTURE_2D, k), m.drawElements(m.TRIANGLES, 6, m.UNSIGNED_SHORT, 0), A.positionScreen.copy(v), A.customUpdateCallback ? A.customUpdateCallback(A) : A.updateLensFlares(), m.uniform1i(j.renderType, 2), n.enable(m.BLEND);
                    for (var B = 0, C = A.lensFlares.length; C > B; B++) {
                        var D = A.lensFlares[B];
                        D.opacity > .001 && D.scale > .001 && (v.x = D.x, v.y = D.y, v.z = D.z, t = D.size * D.scale / o.w, u.x = t * q, u.y = t, m.uniform3f(j.screenPosition, v.x, v.y, v.z), m.uniform2f(j.scale, u.x, u.y), m.uniform1f(j.rotation, D.rotation), m.uniform1f(j.opacity, D.opacity), m.uniform3f(j.color, D.color.r, D.color.g, D.color.b), n.setBlending(D.blending, D.blendEquation, D.blendSrc, D.blendDst), a.setTexture2D(D.texture, 1), m.drawElements(m.TRIANGLES, 6, m.UNSIGNED_SHORT, 0))
                    }
                }
            }
            n.enable(m.CULL_FACE), n.enable(m.DEPTH_TEST), n.setDepthWrite(!0), a.resetGLState()
        }
    }
},THREE.SpritePlugin = function (a, b) {
    function c() {
        var a = new Float32Array([-.5, -.5, 0, 0, .5, -.5, 1, 0, .5, .5, 1, 1, -.5, .5, 0, 1]), b = new Uint16Array([0, 1, 2, 0, 2, 3]);
        f = l.createBuffer(), g = l.createBuffer(), l.bindBuffer(l.ARRAY_BUFFER, f), l.bufferData(l.ARRAY_BUFFER, a, l.STATIC_DRAW), l.bindBuffer(l.ELEMENT_ARRAY_BUFFER, g), l.bufferData(l.ELEMENT_ARRAY_BUFFER, b, l.STATIC_DRAW), h = d(), i = {
            position: l.getAttribLocation(h, "position"),
            uv: l.getAttribLocation(h, "uv")
        }, j = {
            uvOffset: l.getUniformLocation(h, "uvOffset"),
            uvScale: l.getUniformLocation(h, "uvScale"),
            rotation: l.getUniformLocation(h, "rotation"),
            scale: l.getUniformLocation(h, "scale"),
            color: l.getUniformLocation(h, "color"),
            map: l.getUniformLocation(h, "map"),
            opacity: l.getUniformLocation(h, "opacity"),
            modelViewMatrix: l.getUniformLocation(h, "modelViewMatrix"),
            projectionMatrix: l.getUniformLocation(h, "projectionMatrix"),
            fogType: l.getUniformLocation(h, "fogType"),
            fogDensity: l.getUniformLocation(h, "fogDensity"),
            fogNear: l.getUniformLocation(h, "fogNear"),
            fogFar: l.getUniformLocation(h, "fogFar"),
            fogColor: l.getUniformLocation(h, "fogColor"),
            alphaTest: l.getUniformLocation(h, "alphaTest")
        };
        var c = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas");
        c.width = 8, c.height = 8;
        var e = c.getContext("2d");
        e.fillStyle = "white", e.fillRect(0, 0, 8, 8), k = new THREE.Texture(c), k.needsUpdate = !0
    }

    function d() {
        var b = l.createProgram(), c = l.createShader(l.VERTEX_SHADER), d = l.createShader(l.FRAGMENT_SHADER);
        return l.shaderSource(c, ["precision " + a.getPrecision() + " float;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform float rotation;", "uniform vec2 scale;", "uniform vec2 uvOffset;", "uniform vec2 uvScale;", "attribute vec2 position;", "attribute vec2 uv;", "varying vec2 vUV;", "void main() {", "vUV = uvOffset + uv * uvScale;", "vec2 alignedPosition = position * scale;", "vec2 rotatedPosition;", "rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;", "rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;", "vec4 finalPosition;", "finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );", "finalPosition.xy += rotatedPosition;", "finalPosition = projectionMatrix * finalPosition;", "gl_Position = finalPosition;", "}"].join("\n")), l.shaderSource(d, ["precision " + a.getPrecision() + " float;", "uniform vec3 color;", "uniform sampler2D map;", "uniform float opacity;", "uniform int fogType;", "uniform vec3 fogColor;", "uniform float fogDensity;", "uniform float fogNear;", "uniform float fogFar;", "uniform float alphaTest;", "varying vec2 vUV;", "void main() {", "vec4 texture = texture2D( map, vUV );", "if ( texture.a < alphaTest ) discard;", "gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );", "if ( fogType > 0 ) {", "float depth = gl_FragCoord.z / gl_FragCoord.w;", "float fogFactor = 0.0;", "if ( fogType == 1 ) {", "fogFactor = smoothstep( fogNear, fogFar, depth );", "} else {", "const float LOG2 = 1.442695;", "fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );", "fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );", "}", "gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );", "}", "}"].join("\n")), l.compileShader(c), l.compileShader(d), l.attachShader(b, c), l.attachShader(b, d), l.linkProgram(b), b
    }

    function e(a, b) {
        return a.renderOrder !== b.renderOrder ? a.renderOrder - b.renderOrder : a.z !== b.z ? b.z - a.z : b.id - a.id
    }

    var f, g, h, i, j, k, l = a.context, m = a.state, n = new THREE.Vector3, o = new THREE.Quaternion, p = new THREE.Vector3;
    this.render = function (d, q) {
        if (0 !== b.length) {
            void 0 === h && c(), l.useProgram(h), m.initAttributes(), m.enableAttribute(i.position), m.enableAttribute(i.uv), m.disableUnusedAttributes(), m.disable(l.CULL_FACE), m.enable(l.BLEND), l.bindBuffer(l.ARRAY_BUFFER, f), l.vertexAttribPointer(i.position, 2, l.FLOAT, !1, 16, 0), l.vertexAttribPointer(i.uv, 2, l.FLOAT, !1, 16, 8), l.bindBuffer(l.ELEMENT_ARRAY_BUFFER, g), l.uniformMatrix4fv(j.projectionMatrix, !1, q.projectionMatrix.elements), m.activeTexture(l.TEXTURE0), l.uniform1i(j.map, 0);
            var r = 0, s = 0, t = d.fog;
            t ? (l.uniform3f(j.fogColor, t.color.r, t.color.g, t.color.b), t instanceof THREE.Fog ? (l.uniform1f(j.fogNear, t.near), l.uniform1f(j.fogFar, t.far), l.uniform1i(j.fogType, 1), r = 1, s = 1) : t instanceof THREE.FogExp2 && (l.uniform1f(j.fogDensity, t.density), l.uniform1i(j.fogType, 2), r = 2, s = 2)) : (l.uniform1i(j.fogType, 0), r = 0, s = 0);
            for (var u = 0, v = b.length; v > u; u++) {
                var w = b[u];
                w.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse, w.matrixWorld), w.z = -w.modelViewMatrix.elements[14]
            }
            b.sort(e);
            for (var x = [], u = 0, v = b.length; v > u; u++) {
                var w = b[u], y = w.material;
                l.uniform1f(j.alphaTest, y.alphaTest), l.uniformMatrix4fv(j.modelViewMatrix, !1, w.modelViewMatrix.elements), w.matrixWorld.decompose(n, o, p), x[0] = p.x, x[1] = p.y;
                var z = 0;
                d.fog && y.fog && (z = s), r !== z && (l.uniform1i(j.fogType, z), r = z), null !== y.map ? (l.uniform2f(j.uvOffset, y.map.offset.x, y.map.offset.y), l.uniform2f(j.uvScale, y.map.repeat.x, y.map.repeat.y)) : (l.uniform2f(j.uvOffset, 0, 0), l.uniform2f(j.uvScale, 1, 1)), l.uniform1f(j.opacity, y.opacity), l.uniform3f(j.color, y.color.r, y.color.g, y.color.b), l.uniform1f(j.rotation, y.rotation), l.uniform2fv(j.scale, x), m.setBlending(y.blending, y.blendEquation, y.blendSrc, y.blendDst), m.setDepthTest(y.depthTest), m.setDepthWrite(y.depthWrite), y.map ? a.setTexture2D(y.map, 0) : a.setTexture2D(k, 0), l.drawElements(l.TRIANGLES, 6, l.UNSIGNED_SHORT, 0)
            }
            m.enable(l.CULL_FACE), a.resetGLState()
        }
    }
},Object.assign(THREE, {
    Face4: function (a, b, c, d, e, f, g) {
        return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."), new THREE.Face3(a, b, c, e, f, g)
    }, LineStrip: 0, LinePieces: 1, MeshFaceMaterial: THREE.MultiMaterial, PointCloud: function (a, b) {
        return console.warn("THREE.PointCloud has been renamed to THREE.Points."), new THREE.Points(a, b)
    }, Particle: THREE.Sprite, ParticleSystem: function (a, b) {
        return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."), new THREE.Points(a, b)
    }, PointCloudMaterial: function (a) {
        return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."), new THREE.PointsMaterial(a)
    }, ParticleBasicMaterial: function (a) {
        return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."), new THREE.PointsMaterial(a)
    }, ParticleSystemMaterial: function (a) {
        return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."), new THREE.PointsMaterial(a)
    }, Vertex: function (a, b, c) {
        return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."), new THREE.Vector3(a, b, c)
    }
}),Object.assign(THREE.Box2.prototype, {
    empty: function () {
        return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."), this.isEmpty()
    }, isIntersectionBox: function (a) {
        return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(a)
    }
}),Object.assign(THREE.Box3.prototype, {
    empty: function () {
        return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."), this.isEmpty()
    }, isIntersectionBox: function (a) {
        return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(a)
    }, isIntersectionSphere: function (a) {
        return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(a)
    }
}),Object.assign(THREE.Matrix3.prototype, {
    multiplyVector3: function (a) {
        return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."), a.applyMatrix3(this)
    }, multiplyVector3Array: function (a) {
        return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."), this.applyToVector3Array(a)
    }
}),Object.assign(THREE.Matrix4.prototype, {
    extractPosition: function (a) {
        return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."), this.copyPosition(a)
    }, setRotationFromQuaternion: function (a) {
        return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."), this.makeRotationFromQuaternion(a)
    }, multiplyVector3: function (a) {
        return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."), a.applyProjection(this)
    }, multiplyVector4: function (a) {
        return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."), a.applyMatrix4(this)
    }, multiplyVector3Array: function (a) {
        return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."), this.applyToVector3Array(a)
    }, rotateAxis: function (a) {
        console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."), a.transformDirection(this)
    }, crossVector: function (a) {
        return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."), a.applyMatrix4(this)
    }, translate: function (a) {
        console.error("THREE.Matrix4: .translate() has been removed.")
    }, rotateX: function (a) {
        console.error("THREE.Matrix4: .rotateX() has been removed.")
    }, rotateY: function (a) {
        console.error("THREE.Matrix4: .rotateY() has been removed.")
    }, rotateZ: function (a) {
        console.error("THREE.Matrix4: .rotateZ() has been removed.")
    }, rotateByAxis: function (a, b) {
        console.error("THREE.Matrix4: .rotateByAxis() has been removed.")
    }
}),Object.assign(THREE.Plane.prototype, {
    isIntersectionLine: function (a) {
        return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."), this.intersectsLine(a)
    }
}),Object.assign(THREE.Quaternion.prototype, {
    multiplyVector3: function (a) {
        return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."), a.applyQuaternion(this)
    }
}),Object.assign(THREE.Ray.prototype, {
    isIntersectionBox: function (a) {
        return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(a)
    }, isIntersectionPlane: function (a) {
        return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."), this.intersectsPlane(a)
    }, isIntersectionSphere: function (a) {
        return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(a)
    }
}),Object.assign(THREE.Vector3.prototype, {
    setEulerFromRotationMatrix: function () {
        console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")
    }, setEulerFromQuaternion: function () {
        console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")
    }, getPositionFromMatrix: function (a) {
        return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."), this.setFromMatrixPosition(a)
    }, getScaleFromMatrix: function (a) {
        return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."), this.setFromMatrixScale(a)
    }, getColumnFromMatrix: function (a, b) {
        return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."), this.setFromMatrixColumn(b, a)
    }
}),Object.assign(THREE.Object3D.prototype, {
    getChildByName: function (a) {
        return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."), this.getObjectByName(a)
    }, renderDepth: function (a) {
        console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")
    }, translate: function (a, b) {
        return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."), this.translateOnAxis(b, a)
    }
}),Object.defineProperties(THREE.Object3D.prototype, {
    eulerOrder: {
        get: function () {
            return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order
        }, set: function (a) {
            console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order = a
        }
    }, useQuaternion: {
        get: function () {
            console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
        }, set: function (a) {
            console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")
        }
    }
}),Object.defineProperties(THREE.LOD.prototype, {
    objects: {
        get: function () {
            return console.warn("THREE.LOD: .objects has been renamed to .levels."), this.levels
        }
    }
}),THREE.PerspectiveCamera.prototype.setLens = function (a, b) {
    console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."), void 0 !== b && (this.filmGauge = b), this.setFocalLength(a)
},Object.defineProperties(THREE.Light.prototype, {
    onlyShadow: {
        set: function (a) {
            console.warn("THREE.Light: .onlyShadow has been removed.")
        }
    }, shadowCameraFov: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."), this.shadow.camera.fov = a
        }
    }, shadowCameraLeft: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."), this.shadow.camera.left = a
        }
    }, shadowCameraRight: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."), this.shadow.camera.right = a
        }
    }, shadowCameraTop: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."), this.shadow.camera.top = a
        }
    }, shadowCameraBottom: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."), this.shadow.camera.bottom = a
        }
    }, shadowCameraNear: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."), this.shadow.camera.near = a
        }
    }, shadowCameraFar: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."), this.shadow.camera.far = a
        }
    }, shadowCameraVisible: {
        set: function (a) {
            console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")
        }
    }, shadowBias: {
        set: function (a) {
            console.warn("THREE.Light: .shadowBias is now .shadow.bias."), this.shadow.bias = a
        }
    }, shadowDarkness: {
        set: function (a) {
            console.warn("THREE.Light: .shadowDarkness has been removed.")
        }
    }, shadowMapWidth: {
        set: function (a) {
            console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."), this.shadow.mapSize.width = a
        }
    }, shadowMapHeight: {
        set: function (a) {
            console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."), this.shadow.mapSize.height = a
        }
    }
}),Object.defineProperties(THREE.BufferAttribute.prototype, {
    length: {
        get: function () {
            return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."), this.array.length
        }
    }
}),Object.assign(THREE.BufferGeometry.prototype, {
    addIndex: function (a) {
        console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."), this.setIndex(a)
    }, addDrawCall: function (a, b, c) {
        void 0 !== c && console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."), console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."), this.addGroup(a, b)
    }, clearDrawCalls: function () {
        console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."), this.clearGroups()
    }, computeTangents: function () {
        console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")
    }, computeOffsets: function () {
        console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")
    }
}),Object.defineProperties(THREE.BufferGeometry.prototype, {
    drawcalls: {
        get: function () {
            return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."), this.groups
        }
    }, offsets: {
        get: function () {
            return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."), this.groups
        }
    }
}),Object.defineProperties(THREE.Material.prototype, {
    wrapAround: {
        get: function () {
            console.warn("THREE." + this.type + ": .wrapAround has been removed.")
        }, set: function (a) {
            console.warn("THREE." + this.type + ": .wrapAround has been removed.")
        }
    }, wrapRGB: {
        get: function () {
            return console.warn("THREE." + this.type + ": .wrapRGB has been removed."), new THREE.Color
        }
    }
}),Object.defineProperties(THREE.MeshPhongMaterial.prototype, {
    metal: {
        get: function () {
            return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."), !1
        }, set: function (a) {
            console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")
        }
    }
}),Object.defineProperties(THREE.ShaderMaterial.prototype, {
    derivatives: {
        get: function () {
            return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives
        }, set: function (a) {
            console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives = a
        }
    }
}),THREE.EventDispatcher.prototype = Object.assign(Object.create({
    constructor: THREE.EventDispatcher,
    apply: function (a) {
        console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."), Object.assign(a, this)
    }
}), THREE.EventDispatcher.prototype),Object.assign(THREE.WebGLRenderer.prototype, {
    supportsFloatTextures: function () {
        return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."), this.extensions.get("OES_texture_float")
    }, supportsHalfFloatTextures: function () {
        return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."), this.extensions.get("OES_texture_half_float")
    }, supportsStandardDerivatives: function () {
        return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."), this.extensions.get("OES_standard_derivatives")
    }, supportsCompressedTextureS3TC: function () {
        return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."), this.extensions.get("WEBGL_compressed_texture_s3tc")
    }, supportsCompressedTexturePVRTC: function () {
        return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."), this.extensions.get("WEBGL_compressed_texture_pvrtc")
    }, supportsBlendMinMax: function () {
        return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."), this.extensions.get("EXT_blend_minmax")
    }, supportsVertexTextures: function () {
        return this.capabilities.vertexTextures
    }, supportsInstancedArrays: function () {
        return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."), this.extensions.get("ANGLE_instanced_arrays")
    }, enableScissorTest: function (a) {
        console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."), this.setScissorTest(a)
    }, initMaterial: function () {
        console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")
    }, addPrePlugin: function () {
        console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")
    }, addPostPlugin: function () {
        console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")
    }, updateShadowMap: function () {
        console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")
    }
}),Object.defineProperties(THREE.WebGLRenderer.prototype, {
    shadowMapEnabled: {
        get: function () {
            return this.shadowMap.enabled
        }, set: function (a) {
            console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."), this.shadowMap.enabled = a
        }
    }, shadowMapType: {
        get: function () {
            return this.shadowMap.type
        }, set: function (a) {
            console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."), this.shadowMap.type = a
        }
    }, shadowMapCullFace: {
        get: function () {
            return this.shadowMap.cullFace
        }, set: function (a) {
            console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."), this.shadowMap.cullFace = a
        }
    }
}),Object.defineProperties(THREE.WebGLShadowMap.prototype, {
    cullFace: {
        get: function () {
            return this.renderReverseSided ? THREE.CullFaceFront : THREE.CullFaceBack
        }, set: function (a) {
            var b = a !== THREE.CullFaceBack;
            console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to " + b + "."), this.renderReverseSided = b
        }
    }
}),Object.defineProperties(THREE.WebGLRenderTarget.prototype, {
    wrapS: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS = a
        }
    }, wrapT: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT = a
        }
    }, magFilter: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter = a
        }
    }, minFilter: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter = a
        }
    }, anisotropy: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy = a
        }
    }, offset: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset = a
        }
    }, repeat: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat = a
        }
    }, format: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format = a
        }
    }, type: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type = a
        }
    }, generateMipmaps: {
        get: function () {
            return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps
        }, set: function (a) {
            console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps = a
        }
    }
}),Object.assign(THREE.Audio.prototype, {
    load: function (a) {
        console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");
        var b = this, c = new THREE.AudioLoader;
        return c.load(a, function (a) {
            b.setBuffer(a)
        }), this
    }
}),Object.assign(THREE.AudioAnalyser.prototype, {
    getData: function (a) {
        return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),
            this.getFrequencyData()
    }
}),THREE.GeometryUtils = {
    merge: function (a, b, c) {
        console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");
        var d;
        b instanceof THREE.Mesh && (b.matrixAutoUpdate && b.updateMatrix(), d = b.matrix, b = b.geometry), a.merge(b, d, c)
    }, center: function (a) {
        return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."), a.center()
    }
},THREE.ImageUtils = {
    crossOrigin: void 0, loadTexture: function (a, b, c, d) {
        console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
        var e = new THREE.TextureLoader;
        e.setCrossOrigin(this.crossOrigin);
        var f = e.load(a, c, void 0, d);
        return b && (f.mapping = b), f
    }, loadTextureCube: function (a, b, c, d) {
        console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
        var e = new THREE.CubeTextureLoader;
        e.setCrossOrigin(this.crossOrigin);
        var f = e.load(a, c, void 0, d);
        return b && (f.mapping = b), f
    }, loadCompressedTexture: function () {
        console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")
    }, loadCompressedTextureCube: function () {
        console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")
    }
},THREE.Projector = function () {
    console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."), this.projectVector = function (a, b) {
        console.warn("THREE.Projector: .projectVector() is now vector.project()."), a.project(b)
    }, this.unprojectVector = function (a, b) {
        console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."), a.unproject(b)
    }, this.pickingRay = function (a, b) {
        console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")
    }
},THREE.CanvasRenderer = function () {
    console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"), this.domElement = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas"), this.clear = function () {
    }, this.render = function () {
    }, this.setClearColor = function () {
    }, this.setSize = function () {
    }
},THREE.CurveUtils = {
    tangentQuadraticBezier: function (a, b, c, d) {
        return 2 * (1 - a) * (c - b) + 2 * a * (d - c)
    }, tangentCubicBezier: function (a, b, c, d, e) {
        return -3 * b * (1 - a) * (1 - a) + 3 * c * (1 - a) * (1 - a) - 6 * a * c * (1 - a) + 6 * a * d * (1 - a) - 3 * a * a * d + 3 * a * a * e
    }, tangentSpline: function (a, b, c, d, e) {
        var f = 6 * a * a - 6 * a, g = 3 * a * a - 4 * a + 1, h = -6 * a * a + 6 * a, i = 3 * a * a - 2 * a;
        return f + g + h + i
    }, interpolate: function (a, b, c, d, e) {
        var f = .5 * (c - a), g = .5 * (d - b), h = e * e, i = e * h;
        return (2 * b - 2 * c + f + g) * i + (-3 * b + 3 * c - 2 * f - g) * h + f * e + b
    }
},THREE.SceneUtils = {
    createMultiMaterialObject: function (a, b) {
        for (var c = new THREE.Group, d = 0, e = b.length; e > d; d++)c.add(new THREE.Mesh(a, b[d]));
        return c
    }, detach: function (a, b, c) {
        a.applyMatrix(b.matrixWorld), b.remove(a), c.add(a)
    }, attach: function (a, b, c) {
        var d = new THREE.Matrix4;
        d.getInverse(c.matrixWorld), a.applyMatrix(d), b.remove(a), c.add(a)
    }
},THREE.ShapeUtils = {
    area: function (a) {
        for (var b = a.length, c = 0, d = b - 1, e = 0; b > e; d = e++)c += a[d].x * a[e].y - a[e].x * a[d].y;
        return .5 * c
    }, triangulate: function () {
        function a(a, b, c, d, e, f) {
            var g, h, i, j, k, l, m, n, o;
            if (h = a[f[b]].x, i = a[f[b]].y, j = a[f[c]].x, k = a[f[c]].y, l = a[f[d]].x, m = a[f[d]].y, Number.EPSILON > (j - h) * (m - i) - (k - i) * (l - h))return !1;
            var p, q, r, s, t, u, v, w, x, y, z, A, B, C, D;
            for (p = l - j, q = m - k, r = h - l, s = i - m, t = j - h, u = k - i, g = 0; e > g; g++)if (n = a[f[g]].x, o = a[f[g]].y, !(n === h && o === i || n === j && o === k || n === l && o === m) && (v = n - h, w = o - i, x = n - j, y = o - k, z = n - l, A = o - m, D = p * y - q * x, B = t * w - u * v, C = r * A - s * z, D >= -Number.EPSILON && C >= -Number.EPSILON && B >= -Number.EPSILON))return !1;
            return !0
        }

        return function (b, c) {
            var d = b.length;
            if (3 > d)return null;
            var e, f, g, h = [], i = [], j = [];
            if (THREE.ShapeUtils.area(b) > 0)for (f = 0; d > f; f++)i[f] = f; else for (f = 0; d > f; f++)i[f] = d - 1 - f;
            var k = d, l = 2 * k;
            for (f = k - 1; k > 2;) {
                if (l-- <= 0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"), c ? j : h;
                if (e = f, e >= k && (e = 0), f = e + 1, f >= k && (f = 0), g = f + 1, g >= k && (g = 0), a(b, e, f, g, k, i)) {
                    var m, n, o, p, q;
                    for (m = i[e], n = i[f], o = i[g], h.push([b[m], b[n], b[o]]), j.push([i[e], i[f], i[g]]), p = f, q = f + 1; k > q; p++, q++)i[p] = i[q];
                    k--, l = 2 * k
                }
            }
            return c ? j : h
        }
    }(), triangulateShape: function (a, b) {
        function c(a, b, c) {
            return a.x !== b.x ? a.x < b.x ? a.x <= c.x && c.x <= b.x : b.x <= c.x && c.x <= a.x : a.y < b.y ? a.y <= c.y && c.y <= b.y : b.y <= c.y && c.y <= a.y
        }

        function d(a, b, d, e, f) {
            var g = b.x - a.x, h = b.y - a.y, i = e.x - d.x, j = e.y - d.y, k = a.x - d.x, l = a.y - d.y, m = h * i - g * j, n = h * k - g * l;
            if (Math.abs(m) > Number.EPSILON) {
                var o;
                if (m > 0) {
                    if (0 > n || n > m)return [];
                    if (o = j * k - i * l, 0 > o || o > m)return []
                } else {
                    if (n > 0 || m > n)return [];
                    if (o = j * k - i * l, o > 0 || m > o)return []
                }
                if (0 === o)return !f || 0 !== n && n !== m ? [a] : [];
                if (o === m)return !f || 0 !== n && n !== m ? [b] : [];
                if (0 === n)return [d];
                if (n === m)return [e];
                var p = o / m;
                return [{x: a.x + p * g, y: a.y + p * h}]
            }
            if (0 !== n || j * k !== i * l)return [];
            var q = 0 === g && 0 === h, r = 0 === i && 0 === j;
            if (q && r)return a.x !== d.x || a.y !== d.y ? [] : [a];
            if (q)return c(d, e, a) ? [a] : [];
            if (r)return c(a, b, d) ? [d] : [];
            var s, t, u, v, w, x, y, z;
            return 0 !== g ? (a.x < b.x ? (s = a, u = a.x, t = b, v = b.x) : (s = b, u = b.x, t = a, v = a.x), d.x < e.x ? (w = d, y = d.x, x = e, z = e.x) : (w = e, y = e.x, x = d, z = d.x)) : (a.y < b.y ? (s = a, u = a.y, t = b, v = b.y) : (s = b, u = b.y, t = a, v = a.y), d.y < e.y ? (w = d, y = d.y, x = e, z = e.y) : (w = e, y = e.y, x = d, z = d.y)), y >= u ? y > v ? [] : v === y ? f ? [] : [w] : z >= v ? [w, t] : [w, x] : u > z ? [] : u === z ? f ? [] : [s] : z >= v ? [s, t] : [s, x]
        }

        function e(a, b, c, d) {
            var e = b.x - a.x, f = b.y - a.y, g = c.x - a.x, h = c.y - a.y, i = d.x - a.x, j = d.y - a.y, k = e * h - f * g, l = e * j - f * i;
            if (Math.abs(k) > Number.EPSILON) {
                var m = i * h - j * g;
                return k > 0 ? l >= 0 && m >= 0 : l >= 0 || m >= 0
            }
            return l > 0
        }

        function f(a, b) {
            function c(a, b) {
                var c = s.length - 1, d = a - 1;
                0 > d && (d = c);
                var f = a + 1;
                f > c && (f = 0);
                var g = e(s[a], s[d], s[f], h[b]);
                if (!g)return !1;
                var i = h.length - 1, j = b - 1;
                0 > j && (j = i);
                var k = b + 1;
                return k > i && (k = 0), g = e(h[b], h[j], h[k], s[a]), g ? !0 : !1
            }

            function f(a, b) {
                var c, e, f;
                for (c = 0; c < s.length; c++)if (e = c + 1, e %= s.length, f = d(a, b, s[c], s[e], !0), f.length > 0)return !0;
                return !1
            }

            function g(a, c) {
                var e, f, g, h, i;
                for (e = 0; e < t.length; e++)for (f = b[t[e]], g = 0; g < f.length; g++)if (h = g + 1, h %= f.length, i = d(a, c, f[g], f[h], !0), i.length > 0)return !0;
                return !1
            }

            for (var h, i, j, k, l, m, n, o, p, q, r, s = a.concat(), t = [], u = [], v = 0, w = b.length; w > v; v++)t.push(v);
            for (var x = 0, y = 2 * t.length; t.length > 0;) {
                if (y--, 0 > y) {
                    console.log("Infinite Loop! Holes left:" + t.length + ", Probably Hole outside Shape!");
                    break
                }
                for (j = x; j < s.length; j++) {
                    k = s[j], i = -1;
                    for (var v = 0; v < t.length; v++)if (m = t[v], n = k.x + ":" + k.y + ":" + m, void 0 === u[n]) {
                        h = b[m];
                        for (var z = 0; z < h.length; z++)if (l = h[z], c(j, z) && !f(k, l) && !g(k, l)) {
                            i = z, t.splice(v, 1), o = s.slice(0, j + 1), p = s.slice(j), q = h.slice(i), r = h.slice(0, i + 1), s = o.concat(q).concat(r).concat(p), x = j;
                            break
                        }
                        if (i >= 0)break;
                        u[n] = !0
                    }
                    if (i >= 0)break
                }
            }
            return s
        }

        for (var g, h, i, j, k, l, m = {}, n = a.concat(), o = 0, p = b.length; p > o; o++)Array.prototype.push.apply(n, b[o]);
        for (g = 0, h = n.length; h > g; g++)k = n[g].x + ":" + n[g].y, void 0 !== m[k] && console.warn("THREE.Shape: Duplicate point", k), m[k] = g;
        var q = f(a, b), r = THREE.ShapeUtils.triangulate(q, !1);
        for (g = 0, h = r.length; h > g; g++)for (j = r[g], i = 0; 3 > i; i++)k = j[i].x + ":" + j[i].y, l = m[k], void 0 !== l && (j[i] = l);
        return r.concat()
    }, isClockWise: function (a) {
        return THREE.ShapeUtils.area(a) < 0
    }, b2: function () {
        function a(a, b) {
            var c = 1 - a;
            return c * c * b
        }

        function b(a, b) {
            return 2 * (1 - a) * a * b
        }

        function c(a, b) {
            return a * a * b
        }

        return function (d, e, f, g) {
            return a(d, e) + b(d, f) + c(d, g)
        }
    }(), b3: function () {
        function a(a, b) {
            var c = 1 - a;
            return c * c * c * b
        }

        function b(a, b) {
            var c = 1 - a;
            return 3 * c * c * a * b
        }

        function c(a, b) {
            var c = 1 - a;
            return 3 * c * a * a * b
        }

        function d(a, b) {
            return a * a * a * b
        }

        return function (e, f, g, h, i) {
            return a(e, f) + b(e, g) + c(e, h) + d(e, i)
        }
    }()
},THREE.Curve = function () {
},THREE.Curve.prototype = {
    constructor: THREE.Curve, getPoint: function (a) {
        return console.warn("THREE.Curve: Warning, getPoint() not implemented!"), null
    }, getPointAt: function (a) {
        var b = this.getUtoTmapping(a);
        return this.getPoint(b)
    }, getPoints: function (a) {
        a || (a = 5);
        var b, c = [];
        for (b = 0; a >= b; b++)c.push(this.getPoint(b / a));
        return c
    }, getSpacedPoints: function (a) {
        a || (a = 5);
        var b, c = [];
        for (b = 0; a >= b; b++)c.push(this.getPointAt(b / a));
        return c
    }, getLength: function () {
        var a = this.getLengths();
        return a[a.length - 1]
    }, getLengths: function (a) {
        if (a || (a = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200), this.cacheArcLengths && this.cacheArcLengths.length === a + 1 && !this.needsUpdate)return this.cacheArcLengths;
        this.needsUpdate = !1;
        var b, c, d = [], e = this.getPoint(0), f = 0;
        for (d.push(0), c = 1; a >= c; c++)b = this.getPoint(c / a), f += b.distanceTo(e), d.push(f), e = b;
        return this.cacheArcLengths = d, d
    }, updateArcLengths: function () {
        this.needsUpdate = !0, this.getLengths()
    }, getUtoTmapping: function (a, b) {
        var c, d = this.getLengths(), e = 0, f = d.length;
        c = b ? b : a * d[f - 1];
        for (var g, h = 0, i = f - 1; i >= h;)if (e = Math.floor(h + (i - h) / 2), g = d[e] - c, 0 > g)h = e + 1; else {
            if (!(g > 0)) {
                i = e;
                break
            }
            i = e - 1
        }
        if (e = i, d[e] === c) {
            var j = e / (f - 1);
            return j
        }
        var k = d[e], l = d[e + 1], m = l - k, n = (c - k) / m, j = (e + n) / (f - 1);
        return j
    }, getTangent: function (a) {
        var b = 1e-4, c = a - b, d = a + b;
        0 > c && (c = 0), d > 1 && (d = 1);
        var e = this.getPoint(c), f = this.getPoint(d), g = f.clone().sub(e);
        return g.normalize()
    }, getTangentAt: function (a) {
        var b = this.getUtoTmapping(a);
        return this.getTangent(b)
    }
},THREE.Curve.create = function (a, b) {
    return a.prototype = Object.create(THREE.Curve.prototype), a.prototype.constructor = a, a.prototype.getPoint = b, a
},THREE.CurvePath = function () {
    this.curves = [], this.autoClose = !1
},THREE.CurvePath.prototype = Object.assign(Object.create(THREE.Curve.prototype), {
    constructor: THREE.CurvePath,
    add: function (a) {
        this.curves.push(a)
    },
    closePath: function () {
        var a = this.curves[0].getPoint(0), b = this.curves[this.curves.length - 1].getPoint(1);
        a.equals(b) || this.curves.push(new THREE.LineCurve(b, a))
    },
    getPoint: function (a) {
        for (var b = a * this.getLength(), c = this.getCurveLengths(), d = 0; d < c.length;) {
            if (c[d] >= b) {
                var e = c[d] - b, f = this.curves[d], g = 1 - e / f.getLength();
                return f.getPointAt(g)
            }
            d++
        }
        return null
    },
    getLength: function () {
        var a = this.getCurveLengths();
        return a[a.length - 1]
    },
    updateArcLengths: function () {
        this.needsUpdate = !0, this.cacheLengths = null, this.getLengths()
    },
    getCurveLengths: function () {
        if (this.cacheLengths && this.cacheLengths.length === this.curves.length)return this.cacheLengths;
        for (var a = [], b = 0, c = 0, d = this.curves.length; d > c; c++)b += this.curves[c].getLength(), a.push(b);
        return this.cacheLengths = a, a
    },
    createPointsGeometry: function (a) {
        var b = this.getPoints(a);
        return this.createGeometry(b)
    },
    createSpacedPointsGeometry: function (a) {
        var b = this.getSpacedPoints(a);
        return this.createGeometry(b)
    },
    createGeometry: function (a) {
        for (var b = new THREE.Geometry, c = 0, d = a.length; d > c; c++) {
            var e = a[c];
            b.vertices.push(new THREE.Vector3(e.x, e.y, e.z || 0))
        }
        return b
    }
}),THREE.Font = function (a) {
    this.data = a
},Object.assign(THREE.Font.prototype, {
    generateShapes: function (a, b, c) {
        function d(a) {
            for (var c = String(a).split(""), d = b / f.resolution, g = 0, h = [], i = 0; i < c.length; i++) {
                var j = e(c[i], d, g);
                g += j.offset, h.push(j.path)
            }
            return h
        }

        function e(a, b, d) {
            var e = f.glyphs[a] || f.glyphs["?"];
            if (e) {
                var g, h, i, j, k, l, m, n, o, p, q, r = new THREE.Path, s = [], t = THREE.ShapeUtils.b2, u = THREE.ShapeUtils.b3;
                if (e.o)for (var v = e._cachedOutline || (e._cachedOutline = e.o.split(" ")), w = 0, x = v.length; x > w;) {
                    var y = v[w++];
                    switch (y) {
                        case"m":
                            g = v[w++] * b + d, h = v[w++] * b, r.moveTo(g, h);
                            break;
                        case"l":
                            g = v[w++] * b + d, h = v[w++] * b, r.lineTo(g, h);
                            break;
                        case"q":
                            if (i = v[w++] * b + d, j = v[w++] * b, m = v[w++] * b + d, n = v[w++] * b, r.quadraticCurveTo(m, n, i, j), q = s[s.length - 1]) {
                                k = q.x, l = q.y;
                                for (var z = 1; c >= z; z++) {
                                    var A = z / c;
                                    t(A, k, m, i), t(A, l, n, j)
                                }
                            }
                            break;
                        case"b":
                            if (i = v[w++] * b + d, j = v[w++] * b, m = v[w++] * b + d, n = v[w++] * b, o = v[w++] * b + d, p = v[w++] * b, r.bezierCurveTo(m, n, o, p, i, j), q = s[s.length - 1]) {
                                k = q.x, l = q.y;
                                for (var z = 1; c >= z; z++) {
                                    var A = z / c;
                                    u(A, k, m, o, i), u(A, l, n, p, j)
                                }
                            }
                    }
                }
                return {offset: e.ha * b, path: r}
            }
        }

        void 0 === b && (b = 100), void 0 === c && (c = 4);
        for (var f = this.data, g = d(a), h = [], i = 0, j = g.length; j > i; i++)Array.prototype.push.apply(h, g[i].toShapes());
        return h
    }
}),THREE.Path = function (a) {
    THREE.CurvePath.call(this), this.actions = [], a && this.fromPoints(a)
},THREE.Path.prototype = Object.assign(Object.create(THREE.CurvePath.prototype), {
    constructor: THREE.Path,
    fromPoints: function (a) {
        this.moveTo(a[0].x, a[0].y);
        for (var b = 1, c = a.length; c > b; b++)this.lineTo(a[b].x, a[b].y)
    },
    moveTo: function (a, b) {
        this.actions.push({action: "moveTo", args: [a, b]})
    },
    lineTo: function (a, b) {
        var c = this.actions[this.actions.length - 1].args, d = c[c.length - 2], e = c[c.length - 1], f = new THREE.LineCurve(new THREE.Vector2(d, e), new THREE.Vector2(a, b));
        this.curves.push(f), this.actions.push({action: "lineTo", args: [a, b]})
    },
    quadraticCurveTo: function (a, b, c, d) {
        var e = this.actions[this.actions.length - 1].args, f = e[e.length - 2], g = e[e.length - 1], h = new THREE.QuadraticBezierCurve(new THREE.Vector2(f, g), new THREE.Vector2(a, b), new THREE.Vector2(c, d));
        this.curves.push(h), this.actions.push({action: "quadraticCurveTo", args: [a, b, c, d]})
    },
    bezierCurveTo: function (a, b, c, d, e, f) {
        var g = this.actions[this.actions.length - 1].args, h = g[g.length - 2], i = g[g.length - 1], j = new THREE.CubicBezierCurve(new THREE.Vector2(h, i), new THREE.Vector2(a, b), new THREE.Vector2(c, d), new THREE.Vector2(e, f));
        this.curves.push(j), this.actions.push({action: "bezierCurveTo", args: [a, b, c, d, e, f]})
    },
    splineThru: function (a) {
        var b = Array.prototype.slice.call(arguments), c = this.actions[this.actions.length - 1].args, d = c[c.length - 2], e = c[c.length - 1], f = [new THREE.Vector2(d, e)];
        Array.prototype.push.apply(f, a);
        var g = new THREE.SplineCurve(f);
        this.curves.push(g);
        var h = a[a.length - 1];
        b.push(h.x), b.push(h.y), this.actions.push({action: "splineThru", args: b})
    },
    arc: function (a, b, c, d, e, f) {
        var g = this.actions[this.actions.length - 1].args, h = g[g.length - 2], i = g[g.length - 1];
        this.absarc(a + h, b + i, c, d, e, f)
    },
    absarc: function (a, b, c, d, e, f) {
        this.absellipse(a, b, c, c, d, e, f)
    },
    ellipse: function (a, b, c, d, e, f, g, h) {
        var i = this.actions[this.actions.length - 1].args, j = i[i.length - 2], k = i[i.length - 1];
        this.absellipse(a + j, b + k, c, d, e, f, g, h)
    },
    absellipse: function (a, b, c, d, e, f, g, h) {
        var i = [a, b, c, d, e, f, g, h || 0], j = new THREE.EllipseCurve(a, b, c, d, e, f, g, h);
        this.curves.push(j);
        var k = j.getPoint(1);
        i.push(k.x), i.push(k.y), this.actions.push({action: "ellipse", args: i})
    },
    getSpacedPoints: function (a) {
        a || (a = 40);
        for (var b = [], c = 0; a > c; c++)b.push(this.getPoint(c / a));
        return this.autoClose && b.push(b[0]), b
    },
    getPoints: function (a) {
        a = a || 12;
        for (var b, c, d, e, f, g, h, i, j, k, l, m = THREE.ShapeUtils.b2, n = THREE.ShapeUtils.b3, o = [], p = 0, q = this.actions.length; q > p; p++) {
            var r = this.actions[p], s = r.action, t = r.args;
            switch (s) {
                case"moveTo":
                    o.push(new THREE.Vector2(t[0], t[1]));
                    break;
                case"lineTo":
                    o.push(new THREE.Vector2(t[0], t[1]));
                    break;
                case"quadraticCurveTo":
                    b = t[2], c = t[3], f = t[0], g = t[1], o.length > 0 ? (j = o[o.length - 1], h = j.x, i = j.y) : (j = this.actions[p - 1].args, h = j[j.length - 2], i = j[j.length - 1]);
                    for (var u = 1; a >= u; u++) {
                        var v = u / a;
                        k = m(v, h, f, b), l = m(v, i, g, c), o.push(new THREE.Vector2(k, l))
                    }
                    break;
                case"bezierCurveTo":
                    b = t[4], c = t[5], f = t[0], g = t[1], d = t[2], e = t[3], o.length > 0 ? (j = o[o.length - 1], h = j.x, i = j.y) : (j = this.actions[p - 1].args, h = j[j.length - 2], i = j[j.length - 1]);
                    for (var u = 1; a >= u; u++) {
                        var v = u / a;
                        k = n(v, h, f, d, b), l = n(v, i, g, e, c), o.push(new THREE.Vector2(k, l))
                    }
                    break;
                case"splineThru":
                    j = this.actions[p - 1].args;
                    var w = new THREE.Vector2(j[j.length - 2], j[j.length - 1]), x = [w], y = a * t[0].length;
                    x = x.concat(t[0]);
                    for (var z = new THREE.SplineCurve(x), u = 1; y >= u; u++)o.push(z.getPointAt(u / y));
                    break;
                case"arc":
                    for (var A, B = t[0], C = t[1], D = t[2], E = t[3], F = t[4], G = !!t[5], H = F - E, I = 2 * a, u = 1; I >= u; u++) {
                        var v = u / I;
                        G || (v = 1 - v), A = E + v * H, k = B + D * Math.cos(A), l = C + D * Math.sin(A), o.push(new THREE.Vector2(k, l))
                    }
                    break;
                case"ellipse":
                    var A, J, K, B = t[0], C = t[1], L = t[2], M = t[3], E = t[4], F = t[5], G = !!t[6], N = t[7], H = F - E, I = 2 * a;
                    0 !== N && (J = Math.cos(N), K = Math.sin(N));
                    for (var u = 1; I >= u; u++) {
                        var v = u / I;
                        if (G || (v = 1 - v), A = E + v * H, k = B + L * Math.cos(A), l = C + M * Math.sin(A), 0 !== N) {
                            var O = k, P = l;
                            k = (O - B) * J - (P - C) * K + B, l = (O - B) * K + (P - C) * J + C
                        }
                        o.push(new THREE.Vector2(k, l))
                    }
            }
        }
        var Q = o[o.length - 1];
        return Math.abs(Q.x - o[0].x) < Number.EPSILON && Math.abs(Q.y - o[0].y) < Number.EPSILON && o.splice(o.length - 1, 1), this.autoClose && o.push(o[0]), o
    },
    toShapes: function (a, b) {
        function c(a) {
            for (var b = [], c = new THREE.Path, d = 0, e = a.length; e > d; d++) {
                var f = a[d], g = f.args, h = f.action;
                "moveTo" === h && 0 !== c.actions.length && (b.push(c), c = new THREE.Path), c[h].apply(c, g)
            }
            return 0 !== c.actions.length && b.push(c), b
        }

        function d(a) {
            for (var b = [], c = 0, d = a.length; d > c; c++) {
                var e = a[c], f = new THREE.Shape;
                f.actions = e.actions, f.curves = e.curves, b.push(f)
            }
            return b
        }

        function e(a, b) {
            for (var c = b.length, d = !1, e = c - 1, f = 0; c > f; e = f++) {
                var g = b[e], h = b[f], i = h.x - g.x, j = h.y - g.y;
                if (Math.abs(j) > Number.EPSILON) {
                    if (0 > j && (g = b[f], i = -i, h = b[e], j = -j), a.y < g.y || a.y > h.y)continue;
                    if (a.y === g.y) {
                        if (a.x === g.x)return !0
                    } else {
                        var k = j * (a.x - g.x) - i * (a.y - g.y);
                        if (0 === k)return !0;
                        if (0 > k)continue;
                        d = !d
                    }
                } else {
                    if (a.y !== g.y)continue;
                    if (h.x <= a.x && a.x <= g.x || g.x <= a.x && a.x <= h.x)return !0
                }
            }
            return d
        }

        var f = THREE.ShapeUtils.isClockWise, g = c(this.actions);
        if (0 === g.length)return [];
        if (b === !0)return d(g);
        var h, i, j, k = [];
        if (1 === g.length)return i = g[0], j = new THREE.Shape, j.actions = i.actions, j.curves = i.curves, k.push(j), k;
        var l = !f(g[0].getPoints());
        l = a ? !l : l;
        var m, n = [], o = [], p = [], q = 0;
        o[q] = void 0, p[q] = [];
        for (var r = 0, s = g.length; s > r; r++)i = g[r], m = i.getPoints(), h = f(m), h = a ? !h : h, h ? (!l && o[q] && q++, o[q] = {
            s: new THREE.Shape,
            p: m
        }, o[q].s.actions = i.actions, o[q].s.curves = i.curves, l && q++, p[q] = []) : p[q].push({h: i, p: m[0]});
        if (!o[0])return d(g);
        if (o.length > 1) {
            for (var t = !1, u = [], v = 0, w = o.length; w > v; v++)n[v] = [];
            for (var v = 0, w = o.length; w > v; v++)for (var x = p[v], y = 0; y < x.length; y++) {
                for (var z = x[y], A = !0, B = 0; B < o.length; B++)e(z.p, o[B].p) && (v !== B && u.push({
                    froms: v,
                    tos: B,
                    hole: y
                }), A ? (A = !1, n[B].push(z)) : t = !0);
                A && n[v].push(z)
            }
            u.length > 0 && (t || (p = n))
        }
        for (var C, r = 0, D = o.length; D > r; r++) {
            j = o[r].s, k.push(j), C = p[r];
            for (var E = 0, F = C.length; F > E; E++)j.holes.push(C[E].h)
        }
        return k
    }
}),THREE.Shape = function () {
    THREE.Path.apply(this, arguments), this.holes = []
},THREE.Shape.prototype = Object.assign(Object.create(THREE.Path.prototype), {
    constructor: THREE.Shape,
    extrude: function (a) {
        return new THREE.ExtrudeGeometry(this, a)
    },
    makeGeometry: function (a) {
        return new THREE.ShapeGeometry(this, a)
    },
    getPointsHoles: function (a) {
        for (var b = [], c = 0, d = this.holes.length; d > c; c++)b[c] = this.holes[c].getPoints(a);
        return b
    },
    extractAllPoints: function (a) {
        return {shape: this.getPoints(a), holes: this.getPointsHoles(a)}
    },
    extractPoints: function (a) {
        return this.extractAllPoints(a)
    }
}),THREE.LineCurve = function (a, b) {
    this.v1 = a, this.v2 = b
},THREE.LineCurve.prototype = Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.constructor = THREE.LineCurve,THREE.LineCurve.prototype.getPoint = function (a) {
    var b = this.v2.clone().sub(this.v1);
    return b.multiplyScalar(a).add(this.v1), b
},THREE.LineCurve.prototype.getPointAt = function (a) {
    return this.getPoint(a)
},THREE.LineCurve.prototype.getTangent = function (a) {
    var b = this.v2.clone().sub(this.v1);
    return b.normalize()
},THREE.QuadraticBezierCurve = function (a, b, c) {
    this.v0 = a, this.v1 = b, this.v2 = c
},THREE.QuadraticBezierCurve.prototype = Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve,THREE.QuadraticBezierCurve.prototype.getPoint = function (a) {
    var b = THREE.ShapeUtils.b2;
    return new THREE.Vector2(b(a, this.v0.x, this.v1.x, this.v2.x), b(a, this.v0.y, this.v1.y, this.v2.y))
},THREE.QuadraticBezierCurve.prototype.getTangent = function (a) {
    var b = THREE.CurveUtils.tangentQuadraticBezier;
    return new THREE.Vector2(b(a, this.v0.x, this.v1.x, this.v2.x), b(a, this.v0.y, this.v1.y, this.v2.y)).normalize()
},THREE.CubicBezierCurve = function (a, b, c, d) {
    this.v0 = a, this.v1 = b, this.v2 = c, this.v3 = d
},THREE.CubicBezierCurve.prototype = Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve,THREE.CubicBezierCurve.prototype.getPoint = function (a) {
    var b = THREE.ShapeUtils.b3;
    return new THREE.Vector2(b(a, this.v0.x, this.v1.x, this.v2.x, this.v3.x), b(a, this.v0.y, this.v1.y, this.v2.y, this.v3.y))
},THREE.CubicBezierCurve.prototype.getTangent = function (a) {
    var b = THREE.CurveUtils.tangentCubicBezier;
    return new THREE.Vector2(b(a, this.v0.x, this.v1.x, this.v2.x, this.v3.x), b(a, this.v0.y, this.v1.y, this.v2.y, this.v3.y)).normalize()
},THREE.SplineCurve = function (a) {
    this.points = void 0 == a ? [] : a
},THREE.SplineCurve.prototype = Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.constructor = THREE.SplineCurve,THREE.SplineCurve.prototype.getPoint = function (a) {
    var b = this.points, c = (b.length - 1) * a, d = Math.floor(c), e = c - d, f = b[0 === d ? d : d - 1], g = b[d], h = b[d > b.length - 2 ? b.length - 1 : d + 1], i = b[d > b.length - 3 ? b.length - 1 : d + 2], j = THREE.CurveUtils.interpolate;
    return new THREE.Vector2(j(f.x, g.x, h.x, i.x, e), j(f.y, g.y, h.y, i.y, e))
},THREE.EllipseCurve = function (a, b, c, d, e, f, g, h) {
    this.aX = a, this.aY = b, this.xRadius = c, this.yRadius = d, this.aStartAngle = e, this.aEndAngle = f, this.aClockwise = g, this.aRotation = h || 0
},THREE.EllipseCurve.prototype = Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve,THREE.EllipseCurve.prototype.getPoint = function (a) {
    var b = this.aEndAngle - this.aStartAngle;
    0 > b && (b += 2 * Math.PI), b > 2 * Math.PI && (b -= 2 * Math.PI);
    var c;
    c = this.aClockwise === !0 ? this.aEndAngle + (1 - a) * (2 * Math.PI - b) : this.aStartAngle + a * b;
    var d = this.aX + this.xRadius * Math.cos(c), e = this.aY + this.yRadius * Math.sin(c);
    if (0 !== this.aRotation) {
        var f = Math.cos(this.aRotation), g = Math.sin(this.aRotation), h = d, i = e;
        d = (h - this.aX) * f - (i - this.aY) * g + this.aX, e = (h - this.aX) * g + (i - this.aY) * f + this.aY
    }
    return new THREE.Vector2(d, e)
},THREE.ArcCurve = function (a, b, c, d, e, f) {
    THREE.EllipseCurve.call(this, a, b, c, c, d, e, f)
},THREE.ArcCurve.prototype = Object.create(THREE.EllipseCurve.prototype),THREE.ArcCurve.prototype.constructor = THREE.ArcCurve,THREE.LineCurve3 = THREE.Curve.create(function (a, b) {
    this.v1 = a, this.v2 = b
}, function (a) {
    var b = new THREE.Vector3;
    return b.subVectors(this.v2, this.v1), b.multiplyScalar(a), b.add(this.v1), b
}),THREE.QuadraticBezierCurve3 = THREE.Curve.create(function (a, b, c) {
    this.v0 = a, this.v1 = b, this.v2 = c
}, function (a) {
    var b = THREE.ShapeUtils.b2;
    return new THREE.Vector3(b(a, this.v0.x, this.v1.x, this.v2.x), b(a, this.v0.y, this.v1.y, this.v2.y), b(a, this.v0.z, this.v1.z, this.v2.z))
}),THREE.CubicBezierCurve3 = THREE.Curve.create(function (a, b, c, d) {
    this.v0 = a, this.v1 = b, this.v2 = c, this.v3 = d
}, function (a) {
    var b = THREE.ShapeUtils.b3;
    return new THREE.Vector3(b(a, this.v0.x, this.v1.x, this.v2.x, this.v3.x), b(a, this.v0.y, this.v1.y, this.v2.y, this.v3.y), b(a, this.v0.z, this.v1.z, this.v2.z, this.v3.z))
}),THREE.SplineCurve3 = THREE.Curve.create(function (a) {
    console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"), this.points = void 0 == a ? [] : a
}, function (a) {
    var b = this.points, c = (b.length - 1) * a, d = Math.floor(c), e = c - d, f = b[0 == d ? d : d - 1], g = b[d], h = b[d > b.length - 2 ? b.length - 1 : d + 1], i = b[d > b.length - 3 ? b.length - 1 : d + 2], j = THREE.CurveUtils.interpolate;
    return new THREE.Vector3(j(f.x, g.x, h.x, i.x, e), j(f.y, g.y, h.y, i.y, e), j(f.z, g.z, h.z, i.z, e))
}),THREE.CatmullRomCurve3 = function () {
    function a() {
    }

    var b = new THREE.Vector3, c = new a, d = new a, e = new a;
    return a.prototype.init = function (a, b, c, d) {
        this.c0 = a, this.c1 = c, this.c2 = -3 * a + 3 * b - 2 * c - d, this.c3 = 2 * a - 2 * b + c + d
    }, a.prototype.initNonuniformCatmullRom = function (a, b, c, d, e, f, g) {
        var h = (b - a) / e - (c - a) / (e + f) + (c - b) / f, i = (c - b) / f - (d - b) / (f + g) + (d - c) / g;
        h *= f, i *= f, this.init(b, c, h, i)
    }, a.prototype.initCatmullRom = function (a, b, c, d, e) {
        this.init(b, c, e * (c - a), e * (d - b))
    }, a.prototype.calc = function (a) {
        var b = a * a, c = b * a;
        return this.c0 + this.c1 * a + this.c2 * b + this.c3 * c
    }, THREE.Curve.create(function (a) {
        this.points = a || [], this.closed = !1
    }, function (a) {
        var f, g, h, i, j = this.points;
        i = j.length, 2 > i && console.log("duh, you need at least 2 points"), f = (i - (this.closed ? 0 : 1)) * a, g = Math.floor(f), h = f - g, this.closed ? g += g > 0 ? 0 : (Math.floor(Math.abs(g) / j.length) + 1) * j.length : 0 === h && g === i - 1 && (g = i - 2, h = 1);
        var k, l, m, n;
        if (this.closed || g > 0 ? k = j[(g - 1) % i] : (b.subVectors(j[0], j[1]).add(j[0]), k = b), l = j[g % i], m = j[(g + 1) % i], this.closed || i > g + 2 ? n = j[(g + 2) % i] : (b.subVectors(j[i - 1], j[i - 2]).add(j[i - 1]), n = b), void 0 === this.type || "centripetal" === this.type || "chordal" === this.type) {
            var o = "chordal" === this.type ? .5 : .25, p = Math.pow(k.distanceToSquared(l), o), q = Math.pow(l.distanceToSquared(m), o), r = Math.pow(m.distanceToSquared(n), o);
            1e-4 > q && (q = 1), 1e-4 > p && (p = q), 1e-4 > r && (r = q), c.initNonuniformCatmullRom(k.x, l.x, m.x, n.x, p, q, r), d.initNonuniformCatmullRom(k.y, l.y, m.y, n.y, p, q, r), e.initNonuniformCatmullRom(k.z, l.z, m.z, n.z, p, q, r)
        } else if ("catmullrom" === this.type) {
            var s = void 0 !== this.tension ? this.tension : .5;
            c.initCatmullRom(k.x, l.x, m.x, n.x, s), d.initCatmullRom(k.y, l.y, m.y, n.y, s), e.initCatmullRom(k.z, l.z, m.z, n.z, s)
        }
        var t = new THREE.Vector3(c.calc(h), d.calc(h), e.calc(h));
        return t
    })
}(),THREE.ClosedSplineCurve3 = function (a) {
    console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."), THREE.CatmullRomCurve3.call(this, a), this.type = "catmullrom", this.closed = !0
},THREE.ClosedSplineCurve3.prototype = Object.create(THREE.CatmullRomCurve3.prototype),THREE.BoxGeometry = function (a, b, c, d, e, f) {
    THREE.Geometry.call(this), this.type = "BoxGeometry", this.parameters = {
        width: a,
        height: b,
        depth: c,
        widthSegments: d,
        heightSegments: e,
        depthSegments: f
    }, this.fromBufferGeometry(new THREE.BoxBufferGeometry(a, b, c, d, e, f)), this.mergeVertices()
},THREE.BoxGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry,THREE.CubeGeometry = THREE.BoxGeometry,THREE.BoxBufferGeometry = function (a, b, c, d, e, f) {
    function g(a, b, c) {
        var d = 0;
        return d += (a + 1) * (b + 1) * 2, d += (a + 1) * (c + 1) * 2, d += (c + 1) * (b + 1) * 2
    }

    function h(a, b, c) {
        var d = 0;
        return d += a * b * 2, d += a * c * 2, d += c * b * 2, 6 * d
    }

    function i(a, b, c, d, e, f, g, h, i, k, l) {
        for (var v = f / i, w = g / k, x = f / 2, y = g / 2, z = h / 2, A = i + 1, B = k + 1, C = 0, D = 0, E = new THREE.Vector3, F = 0; B > F; F++)for (var G = F * w - y, H = 0; A > H; H++) {
            var I = H * v - x;
            E[a] = I * d, E[b] = G * e, E[c] = z, n[q] = E.x, n[q + 1] = E.y, n[q + 2] = E.z, E[a] = 0, E[b] = 0, E[c] = h > 0 ? 1 : -1, o[q] = E.x, o[q + 1] = E.y, o[q + 2] = E.z, p[r] = H / i, p[r + 1] = 1 - F / k, q += 3, r += 2, C += 1
        }
        for (F = 0; k > F; F++)for (H = 0; i > H; H++) {
            var J = t + H + A * F, K = t + H + A * (F + 1), L = t + (H + 1) + A * (F + 1), M = t + (H + 1) + A * F;
            m[s] = J, m[s + 1] = K, m[s + 2] = M, m[s + 3] = K, m[s + 4] = L, m[s + 5] = M, s += 6, D += 6
        }
        j.addGroup(u, D, l), u += D, t += C
    }

    THREE.BufferGeometry.call(this), this.type = "BoxBufferGeometry", this.parameters = {
        width: a,
        height: b,
        depth: c,
        widthSegments: d,
        heightSegments: e,
        depthSegments: f
    };
    var j = this;
    d = Math.floor(d) || 1, e = Math.floor(e) || 1, f = Math.floor(f) || 1;
    var k = g(d, e, f), l = h(d, e, f), m = new (l > 65535 ? Uint32Array : Uint16Array)(l), n = new Float32Array(3 * k), o = new Float32Array(3 * k), p = new Float32Array(2 * k), q = 0, r = 0, s = 0, t = 0, u = 0;
    i("z", "y", "x", -1, -1, c, b, a, f, e, 0), i("z", "y", "x", 1, -1, c, b, -a, f, e, 1), i("x", "z", "y", 1, 1, a, c, b, d, f, 2), i("x", "z", "y", 1, -1, a, c, -b, d, f, 3), i("x", "y", "z", 1, -1, a, b, c, d, e, 4), i("x", "y", "z", -1, -1, a, b, -c, d, e, 5), this.setIndex(new THREE.BufferAttribute(m, 1)), this.addAttribute("position", new THREE.BufferAttribute(n, 3)), this.addAttribute("normal", new THREE.BufferAttribute(o, 3)), this.addAttribute("uv", new THREE.BufferAttribute(p, 2))
},THREE.BoxBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.BoxBufferGeometry.prototype.constructor = THREE.BoxBufferGeometry,THREE.CircleGeometry = function (a, b, c, d) {
    THREE.Geometry.call(this), this.type = "CircleGeometry", this.parameters = {
        radius: a,
        segments: b,
        thetaStart: c,
        thetaLength: d
    }, this.fromBufferGeometry(new THREE.CircleBufferGeometry(a, b, c, d))
},THREE.CircleGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry,THREE.CircleBufferGeometry = function (a, b, c, d) {
    THREE.BufferGeometry.call(this), this.type = "CircleBufferGeometry", this.parameters = {
        radius: a,
        segments: b,
        thetaStart: c,
        thetaLength: d
    }, a = a || 50, b = void 0 !== b ? Math.max(3, b) : 8, c = void 0 !== c ? c : 0, d = void 0 !== d ? d : 2 * Math.PI;
    var e = b + 2, f = new Float32Array(3 * e), g = new Float32Array(3 * e), h = new Float32Array(2 * e);
    g[2] = 1, h[0] = .5, h[1] = .5;
    for (var i = 0, j = 3, k = 2; b >= i; i++, j += 3, k += 2) {
        var l = c + i / b * d;
        f[j] = a * Math.cos(l), f[j + 1] = a * Math.sin(l), g[j + 2] = 1, h[k] = (f[j] / a + 1) / 2, h[k + 1] = (f[j + 1] / a + 1) / 2
    }
    for (var m = [], j = 1; b >= j; j++)m.push(j, j + 1, 0);
    this.setIndex(new THREE.BufferAttribute(new Uint16Array(m), 1)), this.addAttribute("position", new THREE.BufferAttribute(f, 3)), this.addAttribute("normal", new THREE.BufferAttribute(g, 3)), this.addAttribute("uv", new THREE.BufferAttribute(h, 2)), this.boundingSphere = new THREE.Sphere(new THREE.Vector3, a)
},THREE.CircleBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry,THREE.CylinderBufferGeometry = function (a, b, c, d, e, f, g, h) {
    function i() {
        var a = (d + 1) * (e + 1);
        return f === !1 && (a += (d + 1) * n + d * n), a
    }

    function j() {
        var a = d * e * 2 * 3;
        return f === !1 && (a += d * n * 3), a
    }

    function k() {
        var f, i, j = new THREE.Vector3, k = new THREE.Vector3, l = 0, n = (b - a) / c;
        for (i = 0; e >= i; i++) {
            var o = [], p = i / e, z = p * (b - a) + a;
            for (f = 0; d >= f; f++) {
                var A = f / d;
                k.x = z * Math.sin(A * h + g), k.y = -p * c + x, k.z = z * Math.cos(A * h + g), r.setXYZ(u, k.x, k.y, k.z), j.copy(k), (0 === a && 0 === i || 0 === b && i === e) && (j.x = Math.sin(A * h + g), j.z = Math.cos(A * h + g)), j.setY(Math.sqrt(j.x * j.x + j.z * j.z) * n).normalize(), s.setXYZ(u, j.x, j.y, j.z), t.setXY(u, A, 1 - p), o.push(u), u++
            }
            w.push(o)
        }
        for (f = 0; d > f; f++)for (i = 0; e > i; i++) {
            var B = w[i][f], C = w[i + 1][f], D = w[i + 1][f + 1], E = w[i][f + 1];
            q.setX(v, B), v++, q.setX(v, C), v++, q.setX(v, E), v++, q.setX(v, C), v++, q.setX(v, D), v++, q.setX(v, E), v++, l += 6
        }
        m.addGroup(y, l, 0), y += l
    }

    function l(c) {
        var e, f, i, j = new THREE.Vector2, k = new THREE.Vector3, l = 0, n = c === !0 ? a : b, o = c === !0 ? 1 : -1;
        for (f = u, e = 1; d >= e; e++)r.setXYZ(u, 0, x * o, 0), s.setXYZ(u, 0, o, 0), j.x = .5, j.y = .5, t.setXY(u, j.x, j.y), u++;
        for (i = u, e = 0; d >= e; e++) {
            var p = e / d, w = p * h + g, z = Math.cos(w), A = Math.sin(w);
            k.x = n * A, k.y = x * o, k.z = n * z, r.setXYZ(u, k.x, k.y, k.z), s.setXYZ(u, 0, o, 0), j.x = .5 * z + .5, j.y = .5 * A * o + .5, t.setXY(u, j.x, j.y), u++
        }
        for (e = 0; d > e; e++) {
            var B = f + e, C = i + e;
            c === !0 ? (q.setX(v, C), v++, q.setX(v, C + 1), v++, q.setX(v, B), v++) : (q.setX(v, C + 1), v++, q.setX(v, C), v++, q.setX(v, B), v++), l += 3
        }
        m.addGroup(y, l, c === !0 ? 1 : 2), y += l
    }

    THREE.BufferGeometry.call(this), this.type = "CylinderBufferGeometry", this.parameters = {
        radiusTop: a,
        radiusBottom: b,
        height: c,
        radialSegments: d,
        heightSegments: e,
        openEnded: f,
        thetaStart: g,
        thetaLength: h
    };
    var m = this;
    a = void 0 !== a ? a : 20, b = void 0 !== b ? b : 20, c = void 0 !== c ? c : 100, d = Math.floor(d) || 8, e = Math.floor(e) || 1, f = void 0 !== f ? f : !1, g = void 0 !== g ? g : 0, h = void 0 !== h ? h : 2 * Math.PI;
    var n = 0;
    f === !1 && (a > 0 && n++, b > 0 && n++);
    var o = i(), p = j(), q = new THREE.BufferAttribute(new (p > 65535 ? Uint32Array : Uint16Array)(p), 1), r = new THREE.BufferAttribute(new Float32Array(3 * o), 3), s = new THREE.BufferAttribute(new Float32Array(3 * o), 3), t = new THREE.BufferAttribute(new Float32Array(2 * o), 2), u = 0, v = 0, w = [], x = c / 2, y = 0;
    k(), f === !1 && (a > 0 && l(!0), b > 0 && l(!1)), this.setIndex(q), this.addAttribute("position", r), this.addAttribute("normal", s), this.addAttribute("uv", t)
},THREE.CylinderBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.CylinderBufferGeometry.prototype.constructor = THREE.CylinderBufferGeometry,THREE.CylinderGeometry = function (a, b, c, d, e, f, g, h) {
    THREE.Geometry.call(this), this.type = "CylinderGeometry", this.parameters = {
        radiusTop: a,
        radiusBottom: b,
        height: c,
        radialSegments: d,
        heightSegments: e,
        openEnded: f,
        thetaStart: g,
        thetaLength: h
    }, this.fromBufferGeometry(new THREE.CylinderBufferGeometry(a, b, c, d, e, f, g, h)), this.mergeVertices()
},THREE.CylinderGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry,THREE.ConeBufferGeometry = function (a, b, c, d, e, f, g) {
    THREE.CylinderBufferGeometry.call(this, 0, a, b, c, d, e, f, g), this.type = "ConeBufferGeometry", this.parameters = {
        radius: a,
        height: b,
        radialSegments: c,
        heightSegments: d,
        thetaStart: f,
        thetaLength: g
    }
},THREE.ConeBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.ConeBufferGeometry.prototype.constructor = THREE.ConeBufferGeometry,THREE.ConeGeometry = function (a, b, c, d, e, f, g) {
    THREE.CylinderGeometry.call(this, 0, a, b, c, d, e, f, g), this.type = "ConeGeometry", this.parameters = {
        radius: a,
        height: b,
        radialSegments: c,
        heightSegments: d,
        openEnded: e,
        thetaStart: f,
        thetaLength: g
    }
},THREE.ConeGeometry.prototype = Object.create(THREE.CylinderGeometry.prototype),THREE.ConeGeometry.prototype.constructor = THREE.ConeGeometry,THREE.EdgesGeometry = function (a, b) {
    function c(a, b) {
        return a - b
    }

    THREE.BufferGeometry.call(this), b = void 0 !== b ? b : 1;
    var d, e = Math.cos(THREE.Math.DEG2RAD * b), f = [0, 0], g = {}, h = ["a", "b", "c"];
    a instanceof THREE.BufferGeometry ? (d = new THREE.Geometry, d.fromBufferGeometry(a)) : d = a.clone(), d.mergeVertices(), d.computeFaceNormals();
    for (var i = d.vertices, j = d.faces, k = 0, l = j.length; l > k; k++)for (var m = j[k], n = 0; 3 > n; n++) {
        f[0] = m[h[n]], f[1] = m[h[(n + 1) % 3]], f.sort(c);
        var o = f.toString();
        void 0 === g[o] ? g[o] = {vert1: f[0], vert2: f[1], face1: k, face2: void 0} : g[o].face2 = k
    }
    var p = [];
    for (var o in g) {
        var q = g[o];
        if (void 0 === q.face2 || j[q.face1].normal.dot(j[q.face2].normal) <= e) {
            var r = i[q.vert1];
            p.push(r.x), p.push(r.y), p.push(r.z), r = i[q.vert2], p.push(r.x), p.push(r.y), p.push(r.z)
        }
    }
    this.addAttribute("position", new THREE.BufferAttribute(new Float32Array(p), 3))
},THREE.EdgesGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry,THREE.ExtrudeGeometry = function (a, b) {
    return "undefined" == typeof a ? void(a = []) : (THREE.Geometry.call(this), this.type = "ExtrudeGeometry", a = Array.isArray(a) ? a : [a], this.addShapeList(a, b), void this.computeFaceNormals());
},THREE.ExtrudeGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry,THREE.ExtrudeGeometry.prototype.addShapeList = function (a, b) {
    for (var c = a.length, d = 0; c > d; d++) {
        var e = a[d];
        this.addShape(e, b)
    }
},THREE.ExtrudeGeometry.prototype.addShape = function (a, b) {
    function c(a, b, c) {
        return b || console.error("THREE.ExtrudeGeometry: vec does not exist"), b.clone().multiplyScalar(c).add(a)
    }

    function d(a, b, c) {
        var d, e, f = 1, g = a.x - b.x, h = a.y - b.y, i = c.x - a.x, j = c.y - a.y, k = g * g + h * h, l = g * j - h * i;
        if (Math.abs(l) > Number.EPSILON) {
            var m = Math.sqrt(k), n = Math.sqrt(i * i + j * j), o = b.x - h / m, p = b.y + g / m, q = c.x - j / n, r = c.y + i / n, s = ((q - o) * j - (r - p) * i) / (g * j - h * i);
            d = o + g * s - a.x, e = p + h * s - a.y;
            var t = d * d + e * e;
            if (2 >= t)return new THREE.Vector2(d, e);
            f = Math.sqrt(t / 2)
        } else {
            var u = !1;
            g > Number.EPSILON ? i > Number.EPSILON && (u = !0) : g < -Number.EPSILON ? i < -Number.EPSILON && (u = !0) : Math.sign(h) === Math.sign(j) && (u = !0), u ? (d = -h, e = g, f = Math.sqrt(k)) : (d = g, e = h, f = Math.sqrt(k / 2))
        }
        return new THREE.Vector2(d / f, e / f)
    }

    function e() {
        if (t) {
            var a = 0, b = Q * a;
            for (T = 0; R > T; T++)P = I[T], i(P[2] + b, P[1] + b, P[0] + b);
            for (a = v + 2 * s, b = Q * a, T = 0; R > T; T++)P = I[T], i(P[0] + b, P[1] + b, P[2] + b)
        } else {
            for (T = 0; R > T; T++)P = I[T], i(P[2], P[1], P[0]);
            for (T = 0; R > T; T++)P = I[T], i(P[0] + Q * v, P[1] + Q * v, P[2] + Q * v)
        }
    }

    function f() {
        var a = 0;
        for (g(J, a), a += J.length, A = 0, B = G.length; B > A; A++)z = G[A], g(z, a), a += z.length
    }

    function g(a, b) {
        var c, d;
        for (T = a.length; --T >= 0;) {
            c = T, d = T - 1, 0 > d && (d = a.length - 1);
            var e = 0, f = v + 2 * s;
            for (e = 0; f > e; e++) {
                var g = Q * e, h = Q * (e + 1), i = b + c + g, k = b + d + g, l = b + d + h, m = b + c + h;
                j(i, k, l, m, a, e, f, c, d)
            }
        }
    }

    function h(a, b, c) {
        C.vertices.push(new THREE.Vector3(a, b, c))
    }

    function i(a, b, c) {
        a += D, b += D, c += D, C.faces.push(new THREE.Face3(a, b, c, null, null, 0));
        var d = y.generateTopUV(C, a, b, c);
        C.faceVertexUvs[0].push(d)
    }

    function j(a, b, c, d, e, f, g, h, i) {
        a += D, b += D, c += D, d += D, C.faces.push(new THREE.Face3(a, b, d, null, null, 1)), C.faces.push(new THREE.Face3(b, c, d, null, null, 1));
        var j = y.generateSideWallUV(C, a, b, c, d);
        C.faceVertexUvs[0].push([j[0], j[1], j[3]]), C.faceVertexUvs[0].push([j[1], j[2], j[3]])
    }

    var k, l, m, n, o, p = void 0 !== b.amount ? b.amount : 100, q = void 0 !== b.bevelThickness ? b.bevelThickness : 6, r = void 0 !== b.bevelSize ? b.bevelSize : q - 2, s = void 0 !== b.bevelSegments ? b.bevelSegments : 3, t = void 0 !== b.bevelEnabled ? b.bevelEnabled : !0, u = void 0 !== b.curveSegments ? b.curveSegments : 12, v = void 0 !== b.steps ? b.steps : 1, w = b.extrudePath, x = !1, y = void 0 !== b.UVGenerator ? b.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;
    w && (k = w.getSpacedPoints(v), x = !0, t = !1, l = void 0 !== b.frames ? b.frames : new THREE.TubeGeometry.FrenetFrames(w, v, !1), m = new THREE.Vector3, n = new THREE.Vector3, o = new THREE.Vector3), t || (s = 0, q = 0, r = 0);
    var z, A, B, C = this, D = this.vertices.length, E = a.extractPoints(u), F = E.shape, G = E.holes, H = !THREE.ShapeUtils.isClockWise(F);
    if (H) {
        for (F = F.reverse(), A = 0, B = G.length; B > A; A++)z = G[A], THREE.ShapeUtils.isClockWise(z) && (G[A] = z.reverse());
        H = !1
    }
    var I = THREE.ShapeUtils.triangulateShape(F, G), J = F;
    for (A = 0, B = G.length; B > A; A++)z = G[A], F = F.concat(z);
    for (var K, L, M, N, O, P, Q = F.length, R = I.length, S = [], T = 0, U = J.length, V = U - 1, W = T + 1; U > T; T++, V++, W++)V === U && (V = 0), W === U && (W = 0), S[T] = d(J[T], J[V], J[W]);
    var X, Y = [], Z = S.concat();
    for (A = 0, B = G.length; B > A; A++) {
        for (z = G[A], X = [], T = 0, U = z.length, V = U - 1, W = T + 1; U > T; T++, V++, W++)V === U && (V = 0), W === U && (W = 0), X[T] = d(z[T], z[V], z[W]);
        Y.push(X), Z = Z.concat(X)
    }
    for (K = 0; s > K; K++) {
        for (M = K / s, N = q * (1 - M), L = r * Math.sin(M * Math.PI / 2), T = 0, U = J.length; U > T; T++)O = c(J[T], S[T], L), h(O.x, O.y, -N);
        for (A = 0, B = G.length; B > A; A++)for (z = G[A], X = Y[A], T = 0, U = z.length; U > T; T++)O = c(z[T], X[T], L), h(O.x, O.y, -N)
    }
    for (L = r, T = 0; Q > T; T++)O = t ? c(F[T], Z[T], L) : F[T], x ? (n.copy(l.normals[0]).multiplyScalar(O.x), m.copy(l.binormals[0]).multiplyScalar(O.y), o.copy(k[0]).add(n).add(m), h(o.x, o.y, o.z)) : h(O.x, O.y, 0);
    var $;
    for ($ = 1; v >= $; $++)for (T = 0; Q > T; T++)O = t ? c(F[T], Z[T], L) : F[T], x ? (n.copy(l.normals[$]).multiplyScalar(O.x), m.copy(l.binormals[$]).multiplyScalar(O.y), o.copy(k[$]).add(n).add(m), h(o.x, o.y, o.z)) : h(O.x, O.y, p / v * $);
    for (K = s - 1; K >= 0; K--) {
        for (M = K / s, N = q * (1 - M), L = r * Math.sin(M * Math.PI / 2), T = 0, U = J.length; U > T; T++)O = c(J[T], S[T], L), h(O.x, O.y, p + N);
        for (A = 0, B = G.length; B > A; A++)for (z = G[A], X = Y[A], T = 0, U = z.length; U > T; T++)O = c(z[T], X[T], L), x ? h(O.x, O.y + k[v - 1].y, k[v - 1].x + N) : h(O.x, O.y, p + N)
    }
    e(), f()
},THREE.ExtrudeGeometry.WorldUVGenerator = {
    generateTopUV: function (a, b, c, d) {
        var e = a.vertices, f = e[b], g = e[c], h = e[d];
        return [new THREE.Vector2(f.x, f.y), new THREE.Vector2(g.x, g.y), new THREE.Vector2(h.x, h.y)]
    }, generateSideWallUV: function (a, b, c, d, e) {
        var f = a.vertices, g = f[b], h = f[c], i = f[d], j = f[e];
        return Math.abs(g.y - h.y) < .01 ? [new THREE.Vector2(g.x, 1 - g.z), new THREE.Vector2(h.x, 1 - h.z), new THREE.Vector2(i.x, 1 - i.z), new THREE.Vector2(j.x, 1 - j.z)] : [new THREE.Vector2(g.y, 1 - g.z), new THREE.Vector2(h.y, 1 - h.z), new THREE.Vector2(i.y, 1 - i.z), new THREE.Vector2(j.y, 1 - j.z)]
    }
},THREE.ShapeGeometry = function (a, b) {
    THREE.Geometry.call(this), this.type = "ShapeGeometry", Array.isArray(a) === !1 && (a = [a]), this.addShapeList(a, b), this.computeFaceNormals()
},THREE.ShapeGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry,THREE.ShapeGeometry.prototype.addShapeList = function (a, b) {
    for (var c = 0, d = a.length; d > c; c++)this.addShape(a[c], b);
    return this
},THREE.ShapeGeometry.prototype.addShape = function (a, b) {
    void 0 === b && (b = {});
    var c, d, e, f = void 0 !== b.curveSegments ? b.curveSegments : 12, g = b.material, h = void 0 === b.UVGenerator ? THREE.ExtrudeGeometry.WorldUVGenerator : b.UVGenerator, i = this.vertices.length, j = a.extractPoints(f), k = j.shape, l = j.holes, m = !THREE.ShapeUtils.isClockWise(k);
    if (m) {
        for (k = k.reverse(), c = 0, d = l.length; d > c; c++)e = l[c], THREE.ShapeUtils.isClockWise(e) && (l[c] = e.reverse());
        m = !1
    }
    var n = THREE.ShapeUtils.triangulateShape(k, l);
    for (c = 0, d = l.length; d > c; c++)e = l[c], k = k.concat(e);
    var o, p, q = k.length, r = n.length;
    for (c = 0; q > c; c++)o = k[c], this.vertices.push(new THREE.Vector3(o.x, o.y, 0));
    for (c = 0; r > c; c++) {
        p = n[c];
        var s = p[0] + i, t = p[1] + i, u = p[2] + i;
        this.faces.push(new THREE.Face3(s, t, u, null, null, g)), this.faceVertexUvs[0].push(h.generateTopUV(this, s, t, u))
    }
},THREE.LatheBufferGeometry = function (a, b, c, d) {
    THREE.BufferGeometry.call(this), this.type = "LatheBufferGeometry", this.parameters = {
        points: a,
        segments: b,
        phiStart: c,
        phiLength: d
    }, b = Math.floor(b) || 12, c = c || 0, d = d || 2 * Math.PI, d = THREE.Math.clamp(d, 0, 2 * Math.PI);
    var e, f, g, h = (b + 1) * a.length, i = b * a.length * 2 * 3, j = new THREE.BufferAttribute(new (i > 65535 ? Uint32Array : Uint16Array)(i), 1), k = new THREE.BufferAttribute(new Float32Array(3 * h), 3), l = new THREE.BufferAttribute(new Float32Array(2 * h), 2), m = 0, n = 0, o = (1 / (a.length - 1), 1 / b), p = new THREE.Vector3, q = new THREE.Vector2;
    for (f = 0; b >= f; f++) {
        var r = c + f * o * d, s = Math.sin(r), t = Math.cos(r);
        for (g = 0; g <= a.length - 1; g++)p.x = a[g].x * s, p.y = a[g].y, p.z = a[g].x * t, k.setXYZ(m, p.x, p.y, p.z), q.x = f / b, q.y = g / (a.length - 1), l.setXY(m, q.x, q.y), m++
    }
    for (f = 0; b > f; f++)for (g = 0; g < a.length - 1; g++) {
        e = g + f * a.length;
        var u = e, v = e + a.length, w = e + a.length + 1, x = e + 1;
        j.setX(n, u), n++, j.setX(n, v), n++, j.setX(n, x), n++, j.setX(n, v), n++, j.setX(n, w), n++, j.setX(n, x), n++
    }
    if (this.setIndex(j), this.addAttribute("position", k), this.addAttribute("uv", l), this.computeVertexNormals(), d === 2 * Math.PI) {
        var y = this.attributes.normal.array, z = new THREE.Vector3, A = new THREE.Vector3, B = new THREE.Vector3;
        for (e = b * a.length * 3, f = 0, g = 0; f < a.length; f++, g += 3)z.x = y[g + 0], z.y = y[g + 1], z.z = y[g + 2], A.x = y[e + g + 0], A.y = y[e + g + 1], A.z = y[e + g + 2], B.addVectors(z, A).normalize(), y[g + 0] = y[e + g + 0] = B.x, y[g + 1] = y[e + g + 1] = B.y, y[g + 2] = y[e + g + 2] = B.z
    }
},THREE.LatheBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.LatheBufferGeometry.prototype.constructor = THREE.LatheBufferGeometry,THREE.LatheGeometry = function (a, b, c, d) {
    THREE.Geometry.call(this), this.type = "LatheGeometry", this.parameters = {
        points: a,
        segments: b,
        phiStart: c,
        phiLength: d
    }, this.fromBufferGeometry(new THREE.LatheBufferGeometry(a, b, c, d)), this.mergeVertices()
},THREE.LatheGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry,THREE.PlaneGeometry = function (a, b, c, d) {
    THREE.Geometry.call(this), this.type = "PlaneGeometry", this.parameters = {
        width: a,
        height: b,
        widthSegments: c,
        heightSegments: d
    }, this.fromBufferGeometry(new THREE.PlaneBufferGeometry(a, b, c, d))
},THREE.PlaneGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry,THREE.PlaneBufferGeometry = function (a, b, c, d) {
    THREE.BufferGeometry.call(this), this.type = "PlaneBufferGeometry", this.parameters = {
        width: a,
        height: b,
        widthSegments: c,
        heightSegments: d
    };
    for (var e = a / 2, f = b / 2, g = Math.floor(c) || 1, h = Math.floor(d) || 1, i = g + 1, j = h + 1, k = a / g, l = b / h, m = new Float32Array(i * j * 3), n = new Float32Array(i * j * 3), o = new Float32Array(i * j * 2), p = 0, q = 0, r = 0; j > r; r++)for (var s = r * l - f, t = 0; i > t; t++) {
        var u = t * k - e;
        m[p] = u, m[p + 1] = -s, n[p + 2] = 1, o[q] = t / g, o[q + 1] = 1 - r / h, p += 3, q += 2
    }
    p = 0;
    for (var v = new (m.length / 3 > 65535 ? Uint32Array : Uint16Array)(g * h * 6), r = 0; h > r; r++)for (var t = 0; g > t; t++) {
        var w = t + i * r, x = t + i * (r + 1), y = t + 1 + i * (r + 1), z = t + 1 + i * r;
        v[p] = w, v[p + 1] = x, v[p + 2] = z, v[p + 3] = x, v[p + 4] = y, v[p + 5] = z, p += 6
    }
    this.setIndex(new THREE.BufferAttribute(v, 1)), this.addAttribute("position", new THREE.BufferAttribute(m, 3)), this.addAttribute("normal", new THREE.BufferAttribute(n, 3)), this.addAttribute("uv", new THREE.BufferAttribute(o, 2))
},THREE.PlaneBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry,THREE.RingBufferGeometry = function (a, b, c, d, e, f) {
    THREE.BufferGeometry.call(this), this.type = "RingBufferGeometry", this.parameters = {
        innerRadius: a,
        outerRadius: b,
        thetaSegments: c,
        phiSegments: d,
        thetaStart: e,
        thetaLength: f
    }, a = a || 20, b = b || 50, e = void 0 !== e ? e : 0, f = void 0 !== f ? f : 2 * Math.PI, c = void 0 !== c ? Math.max(3, c) : 8, d = void 0 !== d ? Math.max(1, d) : 1;
    var g, h, i, j = (c + 1) * (d + 1), k = c * d * 2 * 3, l = new THREE.BufferAttribute(new (k > 65535 ? Uint32Array : Uint16Array)(k), 1), m = new THREE.BufferAttribute(new Float32Array(3 * j), 3), n = new THREE.BufferAttribute(new Float32Array(3 * j), 3), o = new THREE.BufferAttribute(new Float32Array(2 * j), 2), p = 0, q = 0, r = a, s = (b - a) / d, t = new THREE.Vector3, u = new THREE.Vector2;
    for (h = 0; d >= h; h++) {
        for (i = 0; c >= i; i++)g = e + i / c * f, t.x = r * Math.cos(g), t.y = r * Math.sin(g), m.setXYZ(p, t.x, t.y, t.z), n.setXYZ(p, 0, 0, 1), u.x = (t.x / b + 1) / 2, u.y = (t.y / b + 1) / 2, o.setXY(p, u.x, u.y), p++;
        r += s
    }
    for (h = 0; d > h; h++) {
        var v = h * (c + 1);
        for (i = 0; c > i; i++) {
            g = i + v;
            var w = g, x = g + c + 1, y = g + c + 2, z = g + 1;
            l.setX(q, w), q++, l.setX(q, x), q++, l.setX(q, y), q++, l.setX(q, w), q++, l.setX(q, y), q++, l.setX(q, z), q++
        }
    }
    this.setIndex(l), this.addAttribute("position", m), this.addAttribute("normal", n), this.addAttribute("uv", o)
},THREE.RingBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.RingBufferGeometry.prototype.constructor = THREE.RingBufferGeometry,THREE.RingGeometry = function (a, b, c, d, e, f) {
    THREE.Geometry.call(this), this.type = "RingGeometry", this.parameters = {
        innerRadius: a,
        outerRadius: b,
        thetaSegments: c,
        phiSegments: d,
        thetaStart: e,
        thetaLength: f
    }, this.fromBufferGeometry(new THREE.RingBufferGeometry(a, b, c, d, e, f))
},THREE.RingGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.RingGeometry.prototype.constructor = THREE.RingGeometry,THREE.SphereGeometry = function (a, b, c, d, e, f, g) {
    THREE.Geometry.call(this), this.type = "SphereGeometry", this.parameters = {
        radius: a,
        widthSegments: b,
        heightSegments: c,
        phiStart: d,
        phiLength: e,
        thetaStart: f,
        thetaLength: g
    }, this.fromBufferGeometry(new THREE.SphereBufferGeometry(a, b, c, d, e, f, g))
},THREE.SphereGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry,THREE.SphereBufferGeometry = function (a, b, c, d, e, f, g) {
    THREE.BufferGeometry.call(this), this.type = "SphereBufferGeometry", this.parameters = {
        radius: a,
        widthSegments: b,
        heightSegments: c,
        phiStart: d,
        phiLength: e,
        thetaStart: f,
        thetaLength: g
    }, a = a || 50, b = Math.max(3, Math.floor(b) || 8), c = Math.max(2, Math.floor(c) || 6), d = void 0 !== d ? d : 0, e = void 0 !== e ? e : 2 * Math.PI, f = void 0 !== f ? f : 0, g = void 0 !== g ? g : Math.PI;
    for (var h = f + g, i = (b + 1) * (c + 1), j = new THREE.BufferAttribute(new Float32Array(3 * i), 3), k = new THREE.BufferAttribute(new Float32Array(3 * i), 3), l = new THREE.BufferAttribute(new Float32Array(2 * i), 2), m = 0, n = [], o = new THREE.Vector3, p = 0; c >= p; p++) {
        for (var q = [], r = p / c, s = 0; b >= s; s++) {
            var t = s / b, u = -a * Math.cos(d + t * e) * Math.sin(f + r * g), v = a * Math.cos(f + r * g), w = a * Math.sin(d + t * e) * Math.sin(f + r * g);
            o.set(u, v, w).normalize(), j.setXYZ(m, u, v, w), k.setXYZ(m, o.x, o.y, o.z), l.setXY(m, t, 1 - r), q.push(m), m++
        }
        n.push(q)
    }
    for (var x = [], p = 0; c > p; p++)for (var s = 0; b > s; s++) {
        var y = n[p][s + 1], z = n[p][s], A = n[p + 1][s], B = n[p + 1][s + 1];
        (0 !== p || f > 0) && x.push(y, z, B), (p !== c - 1 || h < Math.PI) && x.push(z, A, B)
    }
    this.setIndex(new (j.count > 65535 ? THREE.Uint32Attribute : THREE.Uint16Attribute)(x, 1)), this.addAttribute("position", j), this.addAttribute("normal", k), this.addAttribute("uv", l), this.boundingSphere = new THREE.Sphere(new THREE.Vector3, a)
},THREE.SphereBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry,THREE.TextGeometry = function (a, b) {
    b = b || {};
    var c = b.font;
    if (c instanceof THREE.Font == !1)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."), new THREE.Geometry;
    var d = c.generateShapes(a, b.size, b.curveSegments);
    b.amount = void 0 !== b.height ? b.height : 50, void 0 === b.bevelThickness && (b.bevelThickness = 10), void 0 === b.bevelSize && (b.bevelSize = 8), void 0 === b.bevelEnabled && (b.bevelEnabled = !1), THREE.ExtrudeGeometry.call(this, d, b), this.type = "TextGeometry"
},THREE.TextGeometry.prototype = Object.create(THREE.ExtrudeGeometry.prototype),THREE.TextGeometry.prototype.constructor = THREE.TextGeometry,THREE.TorusBufferGeometry = function (a, b, c, d, e) {
    THREE.BufferGeometry.call(this), this.type = "TorusBufferGeometry", this.parameters = {
        radius: a,
        tube: b,
        radialSegments: c,
        tubularSegments: d,
        arc: e
    }, a = a || 100, b = b || 40, c = Math.floor(c) || 8, d = Math.floor(d) || 6, e = e || 2 * Math.PI;
    var f, g, h = (c + 1) * (d + 1), i = c * d * 2 * 3, j = new (i > 65535 ? Uint32Array : Uint16Array)(i), k = new Float32Array(3 * h), l = new Float32Array(3 * h), m = new Float32Array(2 * h), n = 0, o = 0, p = 0, q = new THREE.Vector3, r = new THREE.Vector3, s = new THREE.Vector3;
    for (f = 0; c >= f; f++)for (g = 0; d >= g; g++) {
        var t = g / d * e, u = f / c * Math.PI * 2;
        r.x = (a + b * Math.cos(u)) * Math.cos(t), r.y = (a + b * Math.cos(u)) * Math.sin(t), r.z = b * Math.sin(u), k[n] = r.x, k[n + 1] = r.y, k[n + 2] = r.z, q.x = a * Math.cos(t), q.y = a * Math.sin(t), s.subVectors(r, q).normalize(), l[n] = s.x, l[n + 1] = s.y, l[n + 2] = s.z, m[o] = g / d, m[o + 1] = f / c, n += 3, o += 2
    }
    for (f = 1; c >= f; f++)for (g = 1; d >= g; g++) {
        var v = (d + 1) * f + g - 1, w = (d + 1) * (f - 1) + g - 1, x = (d + 1) * (f - 1) + g, y = (d + 1) * f + g;
        j[p] = v, j[p + 1] = w, j[p + 2] = y, j[p + 3] = w, j[p + 4] = x, j[p + 5] = y, p += 6
    }
    this.setIndex(new THREE.BufferAttribute(j, 1)), this.addAttribute("position", new THREE.BufferAttribute(k, 3)), this.addAttribute("normal", new THREE.BufferAttribute(l, 3)), this.addAttribute("uv", new THREE.BufferAttribute(m, 2))
},THREE.TorusBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.TorusBufferGeometry.prototype.constructor = THREE.TorusBufferGeometry,THREE.TorusGeometry = function (a, b, c, d, e) {
    THREE.Geometry.call(this), this.type = "TorusGeometry", this.parameters = {
        radius: a,
        tube: b,
        radialSegments: c,
        tubularSegments: d,
        arc: e
    }, this.fromBufferGeometry(new THREE.TorusBufferGeometry(a, b, c, d, e))
},THREE.TorusGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry,THREE.TorusKnotBufferGeometry = function (a, b, c, d, e, f) {
    function g(a, b, c, d, e) {
        var f = Math.cos(a), g = Math.sin(a), h = c / b * a, i = Math.cos(h);
        e.x = d * (2 + i) * .5 * f, e.y = d * (2 + i) * g * .5, e.z = d * Math.sin(h) * .5
    }

    THREE.BufferGeometry.call(this), this.type = "TorusKnotBufferGeometry", this.parameters = {
        radius: a,
        tube: b,
        tubularSegments: c,
        radialSegments: d,
        p: e,
        q: f
    }, a = a || 100, b = b || 40, c = Math.floor(c) || 64, d = Math.floor(d) || 8, e = e || 2, f = f || 3;
    var h, i, j = (d + 1) * (c + 1), k = d * c * 2 * 3, l = new THREE.BufferAttribute(new (k > 65535 ? Uint32Array : Uint16Array)(k), 1), m = new THREE.BufferAttribute(new Float32Array(3 * j), 3), n = new THREE.BufferAttribute(new Float32Array(3 * j), 3), o = new THREE.BufferAttribute(new Float32Array(2 * j), 2), p = 0, q = 0, r = new THREE.Vector3, s = new THREE.Vector3, t = new THREE.Vector2, u = new THREE.Vector3, v = new THREE.Vector3, w = new THREE.Vector3, x = new THREE.Vector3, y = new THREE.Vector3;
    for (h = 0; c >= h; ++h) {
        var z = h / c * e * Math.PI * 2;
        for (g(z, e, f, a, u), g(z + .01, e, f, a, v), x.subVectors(v, u), y.addVectors(v, u), w.crossVectors(x, y), y.crossVectors(w, x), w.normalize(), y.normalize(), i = 0; d >= i; ++i) {
            var A = i / d * Math.PI * 2, B = -b * Math.cos(A), C = b * Math.sin(A);
            r.x = u.x + (B * y.x + C * w.x), r.y = u.y + (B * y.y + C * w.y), r.z = u.z + (B * y.z + C * w.z), m.setXYZ(p, r.x, r.y, r.z), s.subVectors(r, u).normalize(), n.setXYZ(p, s.x, s.y, s.z), t.x = h / c, t.y = i / d, o.setXY(p, t.x, t.y), p++
        }
    }
    for (i = 1; c >= i; i++)for (h = 1; d >= h; h++) {
        var D = (d + 1) * (i - 1) + (h - 1), E = (d + 1) * i + (h - 1), F = (d + 1) * i + h, G = (d + 1) * (i - 1) + h;
        l.setX(q, D), q++, l.setX(q, E), q++, l.setX(q, G), q++, l.setX(q, E), q++, l.setX(q, F), q++, l.setX(q, G), q++
    }
    this.setIndex(l), this.addAttribute("position", m), this.addAttribute("normal", n), this.addAttribute("uv", o)
},THREE.TorusKnotBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.TorusKnotBufferGeometry.prototype.constructor = THREE.TorusKnotBufferGeometry,THREE.TorusKnotGeometry = function (a, b, c, d, e, f, g) {
    THREE.Geometry.call(this), this.type = "TorusKnotGeometry", this.parameters = {
        radius: a,
        tube: b,
        tubularSegments: c,
        radialSegments: d,
        p: e,
        q: f
    }, void 0 !== g && console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."), this.fromBufferGeometry(new THREE.TorusKnotBufferGeometry(a, b, c, d, e, f)), this.mergeVertices()
},THREE.TorusKnotGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry,THREE.TubeGeometry = function (a, b, c, d, e, f) {
    function g(a, b, c) {
        return D.vertices.push(new THREE.Vector3(a, b, c)) - 1
    }

    THREE.Geometry.call(this), this.type = "TubeGeometry", this.parameters = {
        path: a,
        segments: b,
        radius: c,
        radialSegments: d,
        closed: e,
        taper: f
    }, b = b || 64, c = c || 1, d = d || 8, e = e || !1, f = f || THREE.TubeGeometry.NoTaper;
    var h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C = [], D = this, E = b + 1, F = new THREE.Vector3, G = new THREE.TubeGeometry.FrenetFrames(a, b, e), H = G.tangents, I = G.normals, J = G.binormals;
    for (this.tangents = H, this.normals = I, this.binormals = J, q = 0; E > q; q++)for (C[q] = [], k = q / (E - 1), p = a.getPointAt(k), h = H[q], i = I[q], j = J[q], m = c * f(k), r = 0; d > r; r++)l = r / d * 2 * Math.PI, n = -m * Math.cos(l), o = m * Math.sin(l), F.copy(p), F.x += n * i.x + o * j.x, F.y += n * i.y + o * j.y, F.z += n * i.z + o * j.z, C[q][r] = g(F.x, F.y, F.z);
    for (q = 0; b > q; q++)for (r = 0; d > r; r++)s = e ? (q + 1) % b : q + 1, t = (r + 1) % d, u = C[q][r], v = C[s][r], w = C[s][t], x = C[q][t], y = new THREE.Vector2(q / b, r / d), z = new THREE.Vector2((q + 1) / b, r / d), A = new THREE.Vector2((q + 1) / b, (r + 1) / d), B = new THREE.Vector2(q / b, (r + 1) / d), this.faces.push(new THREE.Face3(u, v, x)), this.faceVertexUvs[0].push([y, z, B]), this.faces.push(new THREE.Face3(v, w, x)), this.faceVertexUvs[0].push([z.clone(), A, B.clone()]);
    this.computeFaceNormals(), this.computeVertexNormals()
},THREE.TubeGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry,THREE.TubeGeometry.NoTaper = function (a) {
    return 1
},THREE.TubeGeometry.SinusoidalTaper = function (a) {
    return Math.sin(Math.PI * a)
},THREE.TubeGeometry.FrenetFrames = function (a, b, c) {
    function d() {
        n[0] = new THREE.Vector3, o[0] = new THREE.Vector3, f = Number.MAX_VALUE, g = Math.abs(m[0].x), h = Math.abs(m[0].y), i = Math.abs(m[0].z), f >= g && (f = g, l.set(1, 0, 0)), f >= h && (f = h, l.set(0, 1, 0)), f >= i && l.set(0, 0, 1), p.crossVectors(m[0], l).normalize(), n[0].crossVectors(m[0], p), o[0].crossVectors(m[0], n[0])
    }

    var e, f, g, h, i, j, k, l = new THREE.Vector3, m = [], n = [], o = [], p = new THREE.Vector3, q = new THREE.Matrix4, r = b + 1;
    for (this.tangents = m, this.normals = n, this.binormals = o, j = 0; r > j; j++)k = j / (r - 1), m[j] = a.getTangentAt(k), m[j].normalize();
    for (d(), j = 1; r > j; j++)n[j] = n[j - 1].clone(), o[j] = o[j - 1].clone(), p.crossVectors(m[j - 1], m[j]), p.length() > Number.EPSILON && (p.normalize(), e = Math.acos(THREE.Math.clamp(m[j - 1].dot(m[j]), -1, 1)), n[j].applyMatrix4(q.makeRotationAxis(p, e))), o[j].crossVectors(m[j], n[j]);
    if (c)for (e = Math.acos(THREE.Math.clamp(n[0].dot(n[r - 1]), -1, 1)), e /= r - 1, m[0].dot(p.crossVectors(n[0], n[r - 1])) > 0 && (e = -e), j = 1; r > j; j++)n[j].applyMatrix4(q.makeRotationAxis(m[j], e * j)), o[j].crossVectors(m[j], n[j])
},THREE.PolyhedronGeometry = function (a, b, c, d) {
    function e(a) {
        var b = a.normalize().clone();
        b.index = k.vertices.push(b) - 1;
        var c = h(a) / 2 / Math.PI + .5, d = i(a) / Math.PI + .5;
        return b.uv = new THREE.Vector2(c, 1 - d), b
    }

    function f(a, b, c) {
        var d = new THREE.Face3(a.index, b.index, c.index, [a.clone(), b.clone(), c.clone()]);
        k.faces.push(d), t.copy(a).add(b).add(c).divideScalar(3);
        var e = h(t);
        k.faceVertexUvs[0].push([j(a.uv, a, e), j(b.uv, b, e), j(c.uv, c, e)])
    }

    function g(a, b) {
        for (var c = Math.pow(2, b), d = e(k.vertices[a.a]), g = e(k.vertices[a.b]), h = e(k.vertices[a.c]), i = [], j = 0; c >= j; j++) {
            i[j] = [];
            for (var l = e(d.clone().lerp(h, j / c)), m = e(g.clone().lerp(h, j / c)), n = c - j, o = 0; n >= o; o++)0 === o && j === c ? i[j][o] = l : i[j][o] = e(l.clone().lerp(m, o / n))
        }
        for (var j = 0; c > j; j++)for (var o = 0; 2 * (c - j) - 1 > o; o++) {
            var p = Math.floor(o / 2);
            o % 2 === 0 ? f(i[j][p + 1], i[j + 1][p], i[j][p]) : f(i[j][p + 1], i[j + 1][p + 1], i[j + 1][p])
        }
    }

    function h(a) {
        return Math.atan2(a.z, -a.x)
    }

    function i(a) {
        return Math.atan2(-a.y, Math.sqrt(a.x * a.x + a.z * a.z))
    }

    function j(a, b, c) {
        return 0 > c && 1 === a.x && (a = new THREE.Vector2(a.x - 1, a.y)), 0 === b.x && 0 === b.z && (a = new THREE.Vector2(c / 2 / Math.PI + .5, a.y)), a.clone()
    }

    THREE.Geometry.call(this), this.type = "PolyhedronGeometry", this.parameters = {
        vertices: a,
        indices: b,
        radius: c,
        detail: d
    }, c = c || 1, d = d || 0;
    for (var k = this, l = 0, m = a.length; m > l; l += 3)e(new THREE.Vector3(a[l], a[l + 1], a[l + 2]));
    for (var n = this.vertices, o = [], l = 0, p = 0, m = b.length; m > l; l += 3, p++) {
        var q = n[b[l]], r = n[b[l + 1]], s = n[b[l + 2]];
        o[p] = new THREE.Face3(q.index, r.index, s.index, [q.clone(), r.clone(), s.clone()])
    }
    for (var t = new THREE.Vector3, l = 0, m = o.length; m > l; l++)g(o[l], d);
    for (var l = 0, m = this.faceVertexUvs[0].length; m > l; l++) {
        var u = this.faceVertexUvs[0][l], v = u[0].x, w = u[1].x, x = u[2].x, y = Math.max(v, w, x), z = Math.min(v, w, x);
        y > .9 && .1 > z && (.2 > v && (u[0].x += 1), .2 > w && (u[1].x += 1), .2 > x && (u[2].x += 1))
    }
    for (var l = 0, m = this.vertices.length; m > l; l++)this.vertices[l].multiplyScalar(c);
    this.mergeVertices(), this.computeFaceNormals(), this.boundingSphere = new THREE.Sphere(new THREE.Vector3, c)
},THREE.PolyhedronGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry,THREE.DodecahedronGeometry = function (a, b) {
    var c = (1 + Math.sqrt(5)) / 2, d = 1 / c, e = [-1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 0, -d, -c, 0, -d, c, 0, d, -c, 0, d, c, -d, -c, 0, -d, c, 0, d, -c, 0, d, c, 0, -c, 0, -d, c, 0, -d, -c, 0, d, c, 0, d], f = [3, 11, 7, 3, 7, 15, 3, 15, 13, 7, 19, 17, 7, 17, 6, 7, 6, 15, 17, 4, 8, 17, 8, 10, 17, 10, 6, 8, 0, 16, 8, 16, 2, 8, 2, 10, 0, 12, 1, 0, 1, 18, 0, 18, 16, 6, 10, 2, 6, 2, 13, 6, 13, 15, 2, 16, 18, 2, 18, 3, 2, 3, 13, 18, 1, 9, 18, 9, 11, 18, 11, 3, 4, 14, 12, 4, 12, 0, 4, 0, 8, 11, 9, 5, 11, 5, 19, 11, 19, 7, 19, 5, 14, 19, 14, 4, 19, 4, 17, 1, 12, 14, 1, 14, 5, 1, 5, 9];
    THREE.PolyhedronGeometry.call(this, e, f, a, b), this.type = "DodecahedronGeometry", this.parameters = {
        radius: a,
        detail: b
    }
},THREE.DodecahedronGeometry.prototype = Object.create(THREE.PolyhedronGeometry.prototype),THREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry,THREE.IcosahedronGeometry = function (a, b) {
    var c = (1 + Math.sqrt(5)) / 2, d = [-1, c, 0, 1, c, 0, -1, -c, 0, 1, -c, 0, 0, -1, c, 0, 1, c, 0, -1, -c, 0, 1, -c, c, 0, -1, c, 0, 1, -c, 0, -1, -c, 0, 1], e = [0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11, 1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8, 3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9, 4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1];
    THREE.PolyhedronGeometry.call(this, d, e, a, b), this.type = "IcosahedronGeometry", this.parameters = {
        radius: a,
        detail: b
    }
},THREE.IcosahedronGeometry.prototype = Object.create(THREE.PolyhedronGeometry.prototype),THREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry,THREE.OctahedronGeometry = function (a, b) {
    var c = [1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1], d = [0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2];
    THREE.PolyhedronGeometry.call(this, c, d, a, b), this.type = "OctahedronGeometry", this.parameters = {
        radius: a,
        detail: b
    }
},THREE.OctahedronGeometry.prototype = Object.create(THREE.PolyhedronGeometry.prototype),THREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry,THREE.TetrahedronGeometry = function (a, b) {
    var c = [1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1], d = [2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1];
    THREE.PolyhedronGeometry.call(this, c, d, a, b), this.type = "TetrahedronGeometry", this.parameters = {
        radius: a,
        detail: b
    }
},THREE.TetrahedronGeometry.prototype = Object.create(THREE.PolyhedronGeometry.prototype),THREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry,THREE.ParametricGeometry = function (a, b, c) {
    THREE.Geometry.call(this), this.type = "ParametricGeometry", this.parameters = {func: a, slices: b, stacks: c};
    var d, e, f, g, h, i = this.vertices, j = this.faces, k = this.faceVertexUvs[0], l = b + 1;
    for (d = 0; c >= d; d++)for (h = d / c, e = 0; b >= e; e++)g = e / b, f = a(g, h), i.push(f);
    var m, n, o, p, q, r, s, t;
    for (d = 0; c > d; d++)for (e = 0; b > e; e++)m = d * l + e, n = d * l + e + 1, o = (d + 1) * l + e + 1, p = (d + 1) * l + e, q = new THREE.Vector2(e / b, d / c), r = new THREE.Vector2((e + 1) / b, d / c), s = new THREE.Vector2((e + 1) / b, (d + 1) / c), t = new THREE.Vector2(e / b, (d + 1) / c), j.push(new THREE.Face3(m, n, p)), k.push([q, r, t]), j.push(new THREE.Face3(n, o, p)), k.push([r.clone(), s, t.clone()]);
    this.computeFaceNormals(), this.computeVertexNormals()
},THREE.ParametricGeometry.prototype = Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry,THREE.WireframeGeometry = function (a) {
    function b(a, b) {
        return a - b
    }

    THREE.BufferGeometry.call(this);
    var c = [0, 0], d = {}, e = ["a", "b", "c"];
    if (a instanceof THREE.Geometry) {
        for (var f = a.vertices, g = a.faces, h = 0, i = new Uint32Array(6 * g.length), j = 0, k = g.length; k > j; j++)for (var l = g[j], m = 0; 3 > m; m++) {
            c[0] = l[e[m]], c[1] = l[e[(m + 1) % 3]], c.sort(b);
            var n = c.toString();
            void 0 === d[n] && (i[2 * h] = c[0], i[2 * h + 1] = c[1], d[n] = !0, h++)
        }
        for (var o = new Float32Array(2 * h * 3), j = 0, k = h; k > j; j++)for (var m = 0; 2 > m; m++) {
            var p = f[i[2 * j + m]], q = 6 * j + 3 * m;
            o[q + 0] = p.x, o[q + 1] = p.y, o[q + 2] = p.z
        }
        this.addAttribute("position", new THREE.BufferAttribute(o, 3))
    } else if (a instanceof THREE.BufferGeometry)if (null !== a.index) {
        var r = a.index.array, f = a.attributes.position, s = a.groups, h = 0;
        0 === s.length && a.addGroup(0, r.length);
        for (var i = new Uint32Array(2 * r.length), t = 0, u = s.length; u > t; ++t)for (var v = s[t], w = v.start, x = v.count, j = w, y = w + x; y > j; j += 3)for (var m = 0; 3 > m; m++) {
            c[0] = r[j + m], c[1] = r[j + (m + 1) % 3], c.sort(b);
            var n = c.toString();
            void 0 === d[n] && (i[2 * h] = c[0], i[2 * h + 1] = c[1], d[n] = !0, h++)
        }
        for (var o = new Float32Array(2 * h * 3), j = 0, k = h; k > j; j++)for (var m = 0; 2 > m; m++) {
            var q = 6 * j + 3 * m, z = i[2 * j + m];
            o[q + 0] = f.getX(z), o[q + 1] = f.getY(z), o[q + 2] = f.getZ(z)
        }
        this.addAttribute("position", new THREE.BufferAttribute(o, 3))
    } else {
        for (var f = a.attributes.position.array, h = f.length / 3, A = h / 3, o = new Float32Array(2 * h * 3), j = 0, k = A; k > j; j++)for (var m = 0; 3 > m; m++) {
            var q = 18 * j + 6 * m, B = 9 * j + 3 * m;
            o[q + 0] = f[B], o[q + 1] = f[B + 1], o[q + 2] = f[B + 2];
            var z = 9 * j + 3 * ((m + 1) % 3);
            o[q + 3] = f[z], o[q + 4] = f[z + 1], o[q + 5] = f[z + 2]
        }
        this.addAttribute("position", new THREE.BufferAttribute(o, 3))
    }
},THREE.WireframeGeometry.prototype = Object.create(THREE.BufferGeometry.prototype),THREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry,THREE.AxisHelper = function (a) {
    a = a || 1;
    var b = new Float32Array([0, 0, 0, a, 0, 0, 0, 0, 0, 0, a, 0, 0, 0, 0, 0, 0, a]), c = new Float32Array([1, 0, 0, 1, .6, 0, 0, 1, 0, .6, 1, 0, 0, 0, 1, 0, .6, 1]), d = new THREE.BufferGeometry;
    d.addAttribute("position", new THREE.BufferAttribute(b, 3)), d.addAttribute("color", new THREE.BufferAttribute(c, 3));
    var e = new THREE.LineBasicMaterial({vertexColors: THREE.VertexColors});
    THREE.LineSegments.call(this, d, e)
},THREE.AxisHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.AxisHelper.prototype.constructor = THREE.AxisHelper,THREE.ArrowHelper = function () {
    var a = new THREE.BufferGeometry;
    a.addAttribute("position", new THREE.Float32Attribute([0, 0, 0, 0, 1, 0], 3));
    var b = new THREE.CylinderBufferGeometry(0, .5, 1, 5, 1);
    return b.translate(0, -.5, 0), function (c, d, e, f, g, h) {
        THREE.Object3D.call(this), void 0 === f && (f = 16776960), void 0 === e && (e = 1), void 0 === g && (g = .2 * e), void 0 === h && (h = .2 * g), this.position.copy(d), this.line = new THREE.Line(a, new THREE.LineBasicMaterial({color: f})), this.line.matrixAutoUpdate = !1, this.add(this.line), this.cone = new THREE.Mesh(b, new THREE.MeshBasicMaterial({color: f})), this.cone.matrixAutoUpdate = !1, this.add(this.cone), this.setDirection(c), this.setLength(e, g, h)
    }
}(),THREE.ArrowHelper.prototype = Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper,THREE.ArrowHelper.prototype.setDirection = function () {
    var a, b = new THREE.Vector3;
    return function (c) {
        c.y > .99999 ? this.quaternion.set(0, 0, 0, 1) : c.y < -.99999 ? this.quaternion.set(1, 0, 0, 0) : (b.set(c.z, 0, -c.x).normalize(), a = Math.acos(c.y), this.quaternion.setFromAxisAngle(b, a))
    }
}(),THREE.ArrowHelper.prototype.setLength = function (a, b, c) {
    void 0 === b && (b = .2 * a), void 0 === c && (c = .2 * b), this.line.scale.set(1, Math.max(0, a - b), 1), this.line.updateMatrix(), this.cone.scale.set(c, b, c), this.cone.position.y = a, this.cone.updateMatrix()
},THREE.ArrowHelper.prototype.setColor = function (a) {
    this.line.material.color.copy(a), this.cone.material.color.copy(a)
},THREE.BoxHelper = function (a, b) {
    void 0 === b && (b = 16776960);
    var c = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]), d = new Float32Array(24), e = new THREE.BufferGeometry;
    e.setIndex(new THREE.BufferAttribute(c, 1)), e.addAttribute("position", new THREE.BufferAttribute(d, 3)), THREE.LineSegments.call(this, e, new THREE.LineBasicMaterial({color: b})), void 0 !== a && this.update(a)
},THREE.BoxHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.BoxHelper.prototype.constructor = THREE.BoxHelper,THREE.BoxHelper.prototype.update = function () {
    var a = new THREE.Box3;
    return function (b) {
        if (b instanceof THREE.Box3 ? a.copy(b) : a.setFromObject(b), !a.isEmpty()) {
            var c = a.min, d = a.max, e = this.geometry.attributes.position, f = e.array;
            f[0] = d.x, f[1] = d.y, f[2] = d.z, f[3] = c.x, f[4] = d.y, f[5] = d.z, f[6] = c.x, f[7] = c.y, f[8] = d.z, f[9] = d.x, f[10] = c.y, f[11] = d.z, f[12] = d.x, f[13] = d.y, f[14] = c.z, f[15] = c.x, f[16] = d.y, f[17] = c.z, f[18] = c.x, f[19] = c.y, f[20] = c.z, f[21] = d.x, f[22] = c.y, f[23] = c.z, e.needsUpdate = !0, this.geometry.computeBoundingSphere()
        }
    }
}(),THREE.BoundingBoxHelper = function (a, b) {
    var c = void 0 !== b ? b : 8947848;
    this.object = a, this.box = new THREE.Box3, THREE.Mesh.call(this, new THREE.BoxGeometry(1, 1, 1), new THREE.MeshBasicMaterial({
        color: c,
        wireframe: !0
    }))
},THREE.BoundingBoxHelper.prototype = Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper,THREE.BoundingBoxHelper.prototype.update = function () {
    this.box.setFromObject(this.object), this.box.size(this.scale), this.box.center(this.position)
},THREE.CameraHelper = function (a) {
    function b(a, b, d) {
        c(a, d), c(b, d)
    }

    function c(a, b) {
        d.vertices.push(new THREE.Vector3), d.colors.push(new THREE.Color(b)), void 0 === f[a] && (f[a] = []), f[a].push(d.vertices.length - 1)
    }

    var d = new THREE.Geometry, e = new THREE.LineBasicMaterial({
        color: 16777215,
        vertexColors: THREE.FaceColors
    }), f = {}, g = 16755200, h = 16711680, i = 43775, j = 16777215, k = 3355443;
    b("n1", "n2", g), b("n2", "n4", g), b("n4", "n3", g), b("n3", "n1", g), b("f1", "f2", g), b("f2", "f4", g), b("f4", "f3", g), b("f3", "f1", g), b("n1", "f1", g), b("n2", "f2", g), b("n3", "f3", g), b("n4", "f4", g), b("p", "n1", h), b("p", "n2", h), b("p", "n3", h), b("p", "n4", h), b("u1", "u2", i), b("u2", "u3", i), b("u3", "u1", i), b("c", "t", j), b("p", "c", k), b("cn1", "cn2", k), b("cn3", "cn4", k), b("cf1", "cf2", k), b("cf3", "cf4", k), THREE.LineSegments.call(this, d, e), this.camera = a, this.camera.updateProjectionMatrix && this.camera.updateProjectionMatrix(), this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1, this.pointMap = f, this.update()
},THREE.CameraHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.CameraHelper.prototype.constructor = THREE.CameraHelper,THREE.CameraHelper.prototype.update = function () {
    function a(a, f, g, h) {
        d.set(f, g, h).unproject(e);
        var i = c[a];
        if (void 0 !== i)for (var j = 0, k = i.length; k > j; j++)b.vertices[i[j]].copy(d)
    }

    var b, c, d = new THREE.Vector3, e = new THREE.Camera;
    return function () {
        b = this.geometry, c = this.pointMap;
        var d = 1, f = 1;
        e.projectionMatrix.copy(this.camera.projectionMatrix), a("c", 0, 0, -1), a("t", 0, 0, 1), a("n1", -d, -f, -1), a("n2", d, -f, -1), a("n3", -d, f, -1), a("n4", d, f, -1), a("f1", -d, -f, 1), a("f2", d, -f, 1), a("f3", -d, f, 1), a("f4", d, f, 1), a("u1", .7 * d, 1.1 * f, -1), a("u2", .7 * -d, 1.1 * f, -1), a("u3", 0, 2 * f, -1), a("cf1", -d, 0, 1), a("cf2", d, 0, 1), a("cf3", 0, -f, 1), a("cf4", 0, f, 1), a("cn1", -d, 0, -1), a("cn2", d, 0, -1), a("cn3", 0, -f, -1), a("cn4", 0, f, -1), b.verticesNeedUpdate = !0
    }
}(),THREE.DirectionalLightHelper = function (a, b) {
    THREE.Object3D.call(this), this.light = a, this.light.updateMatrixWorld(), this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1, void 0 === b && (b = 1);
    var c = new THREE.BufferGeometry;
    c.addAttribute("position", new THREE.Float32Attribute([-b, b, 0, b, b, 0, b, -b, 0, -b, -b, 0, -b, b, 0], 3));
    var d = new THREE.LineBasicMaterial({fog: !1});
    this.add(new THREE.Line(c, d)), c = new THREE.BufferGeometry, c.addAttribute("position", new THREE.Float32Attribute([0, 0, 0, 0, 0, 1], 3)),
        this.add(new THREE.Line(c, d)), this.update()
},THREE.DirectionalLightHelper.prototype = Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper,THREE.DirectionalLightHelper.prototype.dispose = function () {
    var a = this.children[0], b = this.children[1];
    a.geometry.dispose(), a.material.dispose(), b.geometry.dispose(), b.material.dispose()
},THREE.DirectionalLightHelper.prototype.update = function () {
    var a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Vector3;
    return function () {
        a.setFromMatrixPosition(this.light.matrixWorld), b.setFromMatrixPosition(this.light.target.matrixWorld), c.subVectors(b, a);
        var d = this.children[0], e = this.children[1];
        d.lookAt(c), d.material.color.copy(this.light.color).multiplyScalar(this.light.intensity), e.lookAt(c), e.scale.z = c.length()
    }
}(),THREE.EdgesHelper = function (a, b, c) {
    var d = void 0 !== b ? b : 16777215;
    THREE.LineSegments.call(this, new THREE.EdgesGeometry(a.geometry, c), new THREE.LineBasicMaterial({color: d})), this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1
},THREE.EdgesHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper,THREE.FaceNormalsHelper = function (a, b, c, d) {
    this.object = a, this.size = void 0 !== b ? b : 1;
    var e = void 0 !== c ? c : 16776960, f = void 0 !== d ? d : 1, g = 0, h = this.object.geometry;
    h instanceof THREE.Geometry ? g = h.faces.length : console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");
    var i = new THREE.BufferGeometry, j = new THREE.Float32Attribute(2 * g * 3, 3);
    i.addAttribute("position", j), THREE.LineSegments.call(this, i, new THREE.LineBasicMaterial({
        color: e,
        linewidth: f
    })), this.matrixAutoUpdate = !1, this.update()
},THREE.FaceNormalsHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper,THREE.FaceNormalsHelper.prototype.update = function () {
    var a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Matrix3;
    return function () {
        this.object.updateMatrixWorld(!0), c.getNormalMatrix(this.object.matrixWorld);
        for (var d = this.object.matrixWorld, e = this.geometry.attributes.position, f = this.object.geometry, g = f.vertices, h = f.faces, i = 0, j = 0, k = h.length; k > j; j++) {
            var l = h[j], m = l.normal;
            a.copy(g[l.a]).add(g[l.b]).add(g[l.c]).divideScalar(3).applyMatrix4(d), b.copy(m).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a), e.setXYZ(i, a.x, a.y, a.z), i += 1, e.setXYZ(i, b.x, b.y, b.z), i += 1
        }
        return e.needsUpdate = !0, this
    }
}(),THREE.GridHelper = function (a, b, c, d) {
    c = new THREE.Color(void 0 !== c ? c : 4473924), d = new THREE.Color(void 0 !== d ? d : 8947848);
    for (var e = [], f = [], g = -a, h = 0; a >= g; g += b) {
        e.push(-a, 0, g, a, 0, g), e.push(g, 0, -a, g, 0, a);
        var i = 0 === g ? c : d;
        i.toArray(f, h), h += 3, i.toArray(f, h), h += 3, i.toArray(f, h), h += 3, i.toArray(f, h), h += 3
    }
    var j = new THREE.BufferGeometry;
    j.addAttribute("position", new THREE.Float32Attribute(e, 3)), j.addAttribute("color", new THREE.Float32Attribute(f, 3));
    var k = new THREE.LineBasicMaterial({vertexColors: THREE.VertexColors});
    THREE.LineSegments.call(this, j, k)
},THREE.GridHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.GridHelper.prototype.constructor = THREE.GridHelper,THREE.GridHelper.prototype.setColors = function () {
    console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")
},THREE.HemisphereLightHelper = function (a, b) {
    THREE.Object3D.call(this), this.light = a, this.light.updateMatrixWorld(), this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1, this.colors = [new THREE.Color, new THREE.Color];
    var c = new THREE.SphereGeometry(b, 4, 2);
    c.rotateX(-Math.PI / 2);
    for (var d = 0, e = 8; e > d; d++)c.faces[d].color = this.colors[4 > d ? 0 : 1];
    var f = new THREE.MeshBasicMaterial({vertexColors: THREE.FaceColors, wireframe: !0});
    this.lightSphere = new THREE.Mesh(c, f), this.add(this.lightSphere), this.update()
},THREE.HemisphereLightHelper.prototype = Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper,THREE.HemisphereLightHelper.prototype.dispose = function () {
    this.lightSphere.geometry.dispose(), this.lightSphere.material.dispose()
},THREE.HemisphereLightHelper.prototype.update = function () {
    var a = new THREE.Vector3;
    return function () {
        this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity), this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity), this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate()), this.lightSphere.geometry.colorsNeedUpdate = !0
    }
}(),THREE.PointLightHelper = function (a, b) {
    this.light = a, this.light.updateMatrixWorld();
    var c = new THREE.SphereBufferGeometry(b, 4, 2), d = new THREE.MeshBasicMaterial({wireframe: !0, fog: !1});
    d.color.copy(this.light.color).multiplyScalar(this.light.intensity), THREE.Mesh.call(this, c, d), this.matrix = this.light.matrixWorld, this.matrixAutoUpdate = !1
},THREE.PointLightHelper.prototype = Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper,THREE.PointLightHelper.prototype.dispose = function () {
    this.geometry.dispose(), this.material.dispose()
},THREE.PointLightHelper.prototype.update = function () {
    this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)
},THREE.SkeletonHelper = function (a) {
    this.bones = this.getBoneList(a);
    for (var b = new THREE.Geometry, c = 0; c < this.bones.length; c++) {
        var d = this.bones[c];
        d.parent instanceof THREE.Bone && (b.vertices.push(new THREE.Vector3), b.vertices.push(new THREE.Vector3), b.colors.push(new THREE.Color(0, 0, 1)), b.colors.push(new THREE.Color(0, 1, 0)))
    }
    b.dynamic = !0;
    var e = new THREE.LineBasicMaterial({
        vertexColors: THREE.VertexColors,
        depthTest: !1,
        depthWrite: !1,
        transparent: !0
    });
    THREE.LineSegments.call(this, b, e), this.root = a, this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1, this.update()
},THREE.SkeletonHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper,THREE.SkeletonHelper.prototype.getBoneList = function (a) {
    var b = [];
    a instanceof THREE.Bone && b.push(a);
    for (var c = 0; c < a.children.length; c++)b.push.apply(b, this.getBoneList(a.children[c]));
    return b
},THREE.SkeletonHelper.prototype.update = function () {
    for (var a = this.geometry, b = (new THREE.Matrix4).getInverse(this.root.matrixWorld), c = new THREE.Matrix4, d = 0, e = 0; e < this.bones.length; e++) {
        var f = this.bones[e];
        f.parent instanceof THREE.Bone && (c.multiplyMatrices(b, f.matrixWorld), a.vertices[d].setFromMatrixPosition(c), c.multiplyMatrices(b, f.parent.matrixWorld), a.vertices[d + 1].setFromMatrixPosition(c), d += 2)
    }
    a.verticesNeedUpdate = !0, a.computeBoundingSphere()
},THREE.SpotLightHelper = function (a) {
    THREE.Object3D.call(this), this.light = a, this.light.updateMatrixWorld(), this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1;
    for (var b = new THREE.BufferGeometry, c = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, -1, 1], d = 0, e = 1, f = 32; f > d; d++, e++) {
        var g = d / f * Math.PI * 2, h = e / f * Math.PI * 2;
        c.push(Math.cos(g), Math.sin(g), 1, Math.cos(h), Math.sin(h), 1)
    }
    b.addAttribute("position", new THREE.Float32Attribute(c, 3));
    var i = new THREE.LineBasicMaterial({fog: !1});
    this.cone = new THREE.LineSegments(b, i), this.add(this.cone), this.update()
},THREE.SpotLightHelper.prototype = Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper,THREE.SpotLightHelper.prototype.dispose = function () {
    this.cone.geometry.dispose(), this.cone.material.dispose()
},THREE.SpotLightHelper.prototype.update = function () {
    var a = new THREE.Vector3, b = new THREE.Vector3;
    return function () {
        var c = this.light.distance ? this.light.distance : 1e3, d = c * Math.tan(this.light.angle);
        this.cone.scale.set(d, d, c), a.setFromMatrixPosition(this.light.matrixWorld), b.setFromMatrixPosition(this.light.target.matrixWorld), this.cone.lookAt(b.sub(a)), this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)
    }
}(),THREE.VertexNormalsHelper = function (a, b, c, d) {
    this.object = a, this.size = void 0 !== b ? b : 1;
    var e = void 0 !== c ? c : 16711680, f = void 0 !== d ? d : 1, g = 0, h = this.object.geometry;
    h instanceof THREE.Geometry ? g = 3 * h.faces.length : h instanceof THREE.BufferGeometry && (g = h.attributes.normal.count);
    var i = new THREE.BufferGeometry, j = new THREE.Float32Attribute(2 * g * 3, 3);
    i.addAttribute("position", j), THREE.LineSegments.call(this, i, new THREE.LineBasicMaterial({
        color: e,
        linewidth: f
    })), this.matrixAutoUpdate = !1, this.update()
},THREE.VertexNormalsHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper,THREE.VertexNormalsHelper.prototype.update = function () {
    var a = new THREE.Vector3, b = new THREE.Vector3, c = new THREE.Matrix3;
    return function () {
        var d = ["a", "b", "c"];
        this.object.updateMatrixWorld(!0), c.getNormalMatrix(this.object.matrixWorld);
        var e = this.object.matrixWorld, f = this.geometry.attributes.position, g = this.object.geometry;
        if (g instanceof THREE.Geometry)for (var h = g.vertices, i = g.faces, j = 0, k = 0, l = i.length; l > k; k++)for (var m = i[k], n = 0, o = m.vertexNormals.length; o > n; n++) {
            var p = h[m[d[n]]], q = m.vertexNormals[n];
            a.copy(p).applyMatrix4(e), b.copy(q).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a), f.setXYZ(j, a.x, a.y, a.z), j += 1, f.setXYZ(j, b.x, b.y, b.z), j += 1
        } else if (g instanceof THREE.BufferGeometry)for (var r = g.attributes.position, s = g.attributes.normal, j = 0, n = 0, o = r.count; o > n; n++)a.set(r.getX(n), r.getY(n), r.getZ(n)).applyMatrix4(e), b.set(s.getX(n), s.getY(n), s.getZ(n)), b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a), f.setXYZ(j, a.x, a.y, a.z), j += 1, f.setXYZ(j, b.x, b.y, b.z), j += 1;
        return f.needsUpdate = !0, this
    }
}(),THREE.WireframeHelper = function (a, b) {
    var c = void 0 !== b ? b : 16777215;
    THREE.LineSegments.call(this, new THREE.WireframeGeometry(a.geometry), new THREE.LineBasicMaterial({color: c})), this.matrix = a.matrixWorld, this.matrixAutoUpdate = !1
},THREE.WireframeHelper.prototype = Object.create(THREE.LineSegments.prototype),THREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper,THREE.ImmediateRenderObject = function (a) {
    THREE.Object3D.call(this), this.material = a, this.render = function (a) {
    }
},THREE.ImmediateRenderObject.prototype = Object.create(THREE.Object3D.prototype),THREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject,THREE.MorphBlendMesh = function (a, b) {
    THREE.Mesh.call(this, a, b), this.animationsMap = {}, this.animationsList = [];
    var c = this.geometry.morphTargets.length, d = "__default", e = 0, f = c - 1, g = c / 1;
    this.createAnimation(d, e, f, g), this.setAnimationWeight(d, 1)
},THREE.MorphBlendMesh.prototype = Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh,THREE.MorphBlendMesh.prototype.createAnimation = function (a, b, c, d) {
    var e = {
        start: b,
        end: c,
        length: c - b + 1,
        fps: d,
        duration: (c - b) / d,
        lastFrame: 0,
        currentFrame: 0,
        active: !1,
        time: 0,
        direction: 1,
        weight: 1,
        directionBackwards: !1,
        mirroredLoop: !1
    };
    this.animationsMap[a] = e, this.animationsList.push(e)
},THREE.MorphBlendMesh.prototype.autoCreateAnimations = function (a) {
    for (var b, c = /([a-z]+)_?(\d+)/i, d = {}, e = this.geometry, f = 0, g = e.morphTargets.length; g > f; f++) {
        var h = e.morphTargets[f], i = h.name.match(c);
        if (i && i.length > 1) {
            var j = i[1];
            d[j] || (d[j] = {start: 1 / 0, end: -(1 / 0)});
            var k = d[j];
            f < k.start && (k.start = f), f > k.end && (k.end = f), b || (b = j)
        }
    }
    for (var j in d) {
        var k = d[j];
        this.createAnimation(j, k.start, k.end, a)
    }
    this.firstAnimation = b
},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function (a) {
    var b = this.animationsMap[a];
    b && (b.direction = 1, b.directionBackwards = !1)
},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function (a) {
    var b = this.animationsMap[a];
    b && (b.direction = -1, b.directionBackwards = !0)
},THREE.MorphBlendMesh.prototype.setAnimationFPS = function (a, b) {
    var c = this.animationsMap[a];
    c && (c.fps = b, c.duration = (c.end - c.start) / c.fps)
},THREE.MorphBlendMesh.prototype.setAnimationDuration = function (a, b) {
    var c = this.animationsMap[a];
    c && (c.duration = b, c.fps = (c.end - c.start) / c.duration)
},THREE.MorphBlendMesh.prototype.setAnimationWeight = function (a, b) {
    var c = this.animationsMap[a];
    c && (c.weight = b)
},THREE.MorphBlendMesh.prototype.setAnimationTime = function (a, b) {
    var c = this.animationsMap[a];
    c && (c.time = b)
},THREE.MorphBlendMesh.prototype.getAnimationTime = function (a) {
    var b = 0, c = this.animationsMap[a];
    return c && (b = c.time), b
},THREE.MorphBlendMesh.prototype.getAnimationDuration = function (a) {
    var b = -1, c = this.animationsMap[a];
    return c && (b = c.duration), b
},THREE.MorphBlendMesh.prototype.playAnimation = function (a) {
    var b = this.animationsMap[a];
    b ? (b.time = 0, b.active = !0) : console.warn("THREE.MorphBlendMesh: animation[" + a + "] undefined in .playAnimation()")
},THREE.MorphBlendMesh.prototype.stopAnimation = function (a) {
    var b = this.animationsMap[a];
    b && (b.active = !1)
},THREE.MorphBlendMesh.prototype.update = function (a) {
    for (var b = 0, c = this.animationsList.length; c > b; b++) {
        var d = this.animationsList[b];
        if (d.active) {
            var e = d.duration / d.length;
            d.time += d.direction * a, d.mirroredLoop ? (d.time > d.duration || d.time < 0) && (d.direction *= -1, d.time > d.duration && (d.time = d.duration, d.directionBackwards = !0), d.time < 0 && (d.time = 0, d.directionBackwards = !1)) : (d.time = d.time % d.duration, d.time < 0 && (d.time += d.duration));
            var f = d.start + THREE.Math.clamp(Math.floor(d.time / e), 0, d.length - 1), g = d.weight;
            f !== d.currentFrame && (this.morphTargetInfluences[d.lastFrame] = 0, this.morphTargetInfluences[d.currentFrame] = 1 * g, this.morphTargetInfluences[f] = 0, d.lastFrame = d.currentFrame, d.currentFrame = f);
            var h = d.time % e / e;
            d.directionBackwards && (h = 1 - h), d.currentFrame !== d.lastFrame ? (this.morphTargetInfluences[d.currentFrame] = h * g, this.morphTargetInfluences[d.lastFrame] = (1 - h) * g) : this.morphTargetInfluences[d.currentFrame] = g
        }
    }
},!function (a) {
    if ("object" == typeof exports && "undefined" != typeof module)module.exports = a(); else if ("function" == typeof define && define.amd)define("phaser.debug", [], a); else {
        var b;
        "undefined" != typeof window ? b = window : "undefined" != typeof global ? b = global : "undefined" != typeof self && (b = self);
        var c = b;
        c = c.Phaser || (c.Phaser = {}), c = c.Plugin || (c.Plugin = {}), c.Debug = a()
    }
}(function () {
    return function a(b, c, d) {
        function e(g, h) {
            if (!c[g]) {
                if (!b[g]) {
                    var i = "function" == typeof requirejs && requirejs;
                    if (!h && i)return i(g, !0);
                    if (f)return f(g, !0);
                    var j = new Error("Cannot find module '" + g + "'");
                    throw j.code = "MODULE_NOT_FOUND", j
                }
                var k = c[g] = {exports: {}};
                b[g][0].call(k.exports, function (a) {
                    var c = b[g][1][a];
                    return e(c ? c : a)
                }, k, k.exports, a, b, c, d)
            }
            return c[g].exports
        }

        for (var f = "function" == typeof requirejs && requirejs, g = 0; g < d.length; g++)e(d[g]);
        return e
    }({
        1: [function (a, b, c) {
            function d(a, b) {
                Phaser.Plugin.call(this, a, b), this.panels = {
                    performance: null,
                    scene: null
                }, this.tickTimings = {lastStart: 0, start: 0, ms: 0}, this.timings = {
                    preUpdate: {
                        physics: 0,
                        state: 0,
                        plugins: 0,
                        stage: 0
                    },
                    update: {state: 0, stage: 0, tweens: 0, sound: 0, input: 0, physics: 0, particles: 0, plugins: 0},
                    postUpdate: {stage: 0, plugins: 0},
                    preRender: {state: 0},
                    render: {renderer: 0, plugins: 0, state: 0},
                    postRender: {plugins: 0}
                }, this._container = null, this._bar = null, this._stats = {
                    ms: null,
                    fps: null,
                    dpf: null,
                    ent: null
                }, this.timer = window.performance ? window.performance : Date
            }

            var e = a("./util/ui"), f = a("./styles/main.less"), g = a("./panels/Performance"), h = a("./panels/Scene");
            d.prototype = Object.create(Phaser.Plugin.prototype), d.prototype.constructor = d, d.PKG = a("../package.json"), d.VERSION = d.PKG.version, b.exports = d, d.prototype.init = function () {
                this.panels.performance = new g(this.game, this), this.panels.scene = new h(this.game, this), e.addCss(f), document.body.appendChild(this._createElement()), this._bindEvents();
                for (var a in this.timings)for (var b in this.timings[a])this._wrap(this.game, b, a, b);
                this._wrap(this, "game", "update");
                for (var c in this.panels)this.panels[c].init && this.panels[c].init.apply(this.panels[c], arguments)
            }, d.prototype.postUpdate = function () {
                for (var a in this.panels)this.panels[a].update && this.panels[a].active && this.panels[a].update();
                var b = Math.round(1e3 / (this.tickTimings.start - this.tickTimings.lastStart)), c = this.game.renderer.renderSession.drawCount;
                b = b > 60 ? 60 : b, e.setText(this._stats.dpf.firstElementChild, void 0 === c ? "(N/A)" : c, 3), e.setText(this._stats.ms.firstElementChild, Math.round(this.tickTimings.ms), 4), e.setText(this._stats.fps.firstElementChild, Math.round(b), 2)
            }, d.prototype.mark = function (a) {
                this.panels.performance && this.panels.performance.mark(a)
            }, d.prototype.destroy = function () {
                Phaser.Plugin.prototype.destroy.call(this);
                for (var a in this.panels)this.panels[a].destroy();
                this.panels = null, this.tickTimings = null, this.timings = null, this._container = null, this._bar = null, this._stats = null, this.timer = null
            }, d.prototype._wrap = function (a, b, c, d) {
                a[b] && a[b][c] && (a[b][c] = function (a, b, c, d, e) {
                    var f = 0, g = 0;
                    return "game" !== b || "update" !== c || d ? function () {
                        f = a.timer.now(), e.apply(this, arguments), g = a.timer.now(), a.timings[c][d] = g - f
                    } : function () {
                        f = a.timer.now(), a.tickTimings.lastStart = a.tickTimings.start, a.tickTimings.start = f, e.apply(this, arguments), g = a.timer.now(), a.tickTimings.ms = g - f
                    }
                }(this, b, c, d, a[b][c]))
            }, d.prototype._bindEvents = function () {
                var a, b = this;
                e.on(this._bar, "click", ".pdebug-menu-item", function (c) {
                    c.preventDefault();
                    var d = b.panels[c.target.getAttribute("href").replace("#", "")];
                    if (d) {
                        if (a && (a.toggle(), e.removeClass(a._menuItem, "active"), a.name === d.name))return void(a = null);
                        e.addClass(c.target, "active"), d.toggle(), a = d
                    }
                })
            }, d.prototype._createElement = function () {
                var a = this._container = document.createElement("div"), b = this._bar = document.createElement("div");
                e.addClass(a, "pdebug"), a.appendChild(b), e.addClass(b, "pdebug-menu"), b.appendChild(this._createMenuHead()), b.appendChild(this._createMenuStats());
                for (var c in this.panels)b.appendChild(this.panels[c].createMenuElement()), a.appendChild(this.panels[c].createPanelElement());
                return a
            }, d.prototype._createMenuHead = function () {
                var a = document.createElement("span"), b = this.game.renderType, c = b === Phaser.WEBGL ? "WebGL" : b === Phaser.HEADLESS ? "Headless" : "Canvas";
                return e.addClass(a, "pdebug-head"), e.setText(a, "Phaser Debug (" + c + "):"), a
            }, d.prototype._createMenuStats = function () {
                var a = document.createElement("div");
                return e.addClass(a, "pdebug-stats"), this._stats.ms = document.createElement("span"), this._stats.fps = document.createElement("span"), this._stats.dpf = document.createElement("span"), e.addClass(this._stats.ms, "pdebug-stats-item ms"), e.setHtml(this._stats.ms, "<span>0</span> ms"), a.appendChild(this._stats.ms), e.addClass(this._stats.fps, "pdebug-stats-item fps"), e.setHtml(this._stats.fps, "<span>0</span> fps"), a.appendChild(this._stats.fps), e.addClass(this._stats.dpf, "pdebug-stats-item dpf"), e.setHtml(this._stats.dpf, "<span>0</span> draws"), a.appendChild(this._stats.dpf), a
            }
        }, {
            "../package.json": 10,
            "./panels/Performance": 15,
            "./panels/Scene": 16,
            "./styles/main.less": 17,
            "./util/ui": 19
        }], 2: [function (a, b, c) {
            "use strict";
            var d = a("./handlebars/base"), e = a("./handlebars/safe-string")["default"], f = a("./handlebars/exception")["default"], g = a("./handlebars/utils"), h = a("./handlebars/runtime"), i = function () {
                var a = new d.HandlebarsEnvironment;
                return g.extend(a, d), a.SafeString = e, a.Exception = f, a.Utils = g, a.escapeExpression = g.escapeExpression, a.VM = h, a.template = function (b) {
                    return h.template(b, a)
                }, a
            }, j = i();
            j.create = i, j["default"] = j, c["default"] = j
        }, {
            "./handlebars/base": 3,
            "./handlebars/exception": 4,
            "./handlebars/runtime": 5,
            "./handlebars/safe-string": 6,
            "./handlebars/utils": 7
        }], 3: [function (a, b, c) {
            "use strict";
            function d(a, b) {
                this.helpers = a || {}, this.partials = b || {}, e(this)
            }

            function e(a) {
                a.registerHelper("helperMissing", function () {
                    if (1 === arguments.length)return void 0;
                    throw new g("Missing helper: '" + arguments[arguments.length - 1].name + "'")
                }), a.registerHelper("blockHelperMissing", function (b, c) {
                    var d = c.inverse, e = c.fn;
                    if (b === !0)return e(this);
                    if (b === !1 || null == b)return d(this);
                    if (k(b))return b.length > 0 ? (c.ids && (c.ids = [c.name]), a.helpers.each(b, c)) : d(this);
                    if (c.data && c.ids) {
                        var g = q(c.data);
                        g.contextPath = f.appendContextPath(c.data.contextPath, c.name), c = {data: g}
                    }
                    return e(b, c)
                }), a.registerHelper("each", function (a, b) {
                    if (!b)throw new g("Must pass iterator to #each");
                    var c, d, e = b.fn, h = b.inverse, i = 0, j = "";
                    if (b.data && b.ids && (d = f.appendContextPath(b.data.contextPath, b.ids[0]) + "."), l(a) && (a = a.call(this)), b.data && (c = q(b.data)), a && "object" == typeof a)if (k(a))for (var m = a.length; m > i; i++)c && (c.index = i, c.first = 0 === i, c.last = i === a.length - 1, d && (c.contextPath = d + i)), j += e(a[i], {data: c}); else for (var n in a)a.hasOwnProperty(n) && (c && (c.key = n, c.index = i, c.first = 0 === i, d && (c.contextPath = d + n)), j += e(a[n], {data: c}), i++);
                    return 0 === i && (j = h(this)), j
                }), a.registerHelper("if", function (a, b) {
                    return l(a) && (a = a.call(this)), !b.hash.includeZero && !a || f.isEmpty(a) ? b.inverse(this) : b.fn(this)
                }), a.registerHelper("unless", function (b, c) {
                    return a.helpers["if"].call(this, b, {fn: c.inverse, inverse: c.fn, hash: c.hash})
                }), a.registerHelper("with", function (a, b) {
                    l(a) && (a = a.call(this));
                    var c = b.fn;
                    if (f.isEmpty(a))return b.inverse(this);
                    if (b.data && b.ids) {
                        var d = q(b.data);
                        d.contextPath = f.appendContextPath(b.data.contextPath, b.ids[0]), b = {data: d}
                    }
                    return c(a, b)
                }), a.registerHelper("log", function (b, c) {
                    var d = c.data && null != c.data.level ? parseInt(c.data.level, 10) : 1;
                    a.log(d, b)
                }), a.registerHelper("lookup", function (a, b) {
                    return a && a[b]
                })
            }

            var f = a("./utils"), g = a("./exception")["default"], h = "2.0.0";
            c.VERSION = h;
            var i = 6;
            c.COMPILER_REVISION = i;
            var j = {
                1: "<= 1.0.rc.2",
                2: "== 1.0.0-rc.3",
                3: "== 1.0.0-rc.4",
                4: "== 1.x.x",
                5: "== 2.0.0-alpha.x",
                6: ">= 2.0.0-beta.1"
            };
            c.REVISION_CHANGES = j;
            var k = f.isArray, l = f.isFunction, m = f.toString, n = "[object Object]";
            c.HandlebarsEnvironment = d, d.prototype = {
                constructor: d,
                logger: o,
                log: p,
                registerHelper: function (a, b) {
                    if (m.call(a) === n) {
                        if (b)throw new g("Arg not supported with multiple helpers");
                        f.extend(this.helpers, a)
                    } else this.helpers[a] = b
                },
                unregisterHelper: function (a) {
                    delete this.helpers[a]
                },
                registerPartial: function (a, b) {
                    m.call(a) === n ? f.extend(this.partials, a) : this.partials[a] = b
                },
                unregisterPartial: function (a) {
                    delete this.partials[a]
                }
            };
            var o = {
                methodMap: {0: "debug", 1: "info", 2: "warn", 3: "error"},
                DEBUG: 0,
                INFO: 1,
                WARN: 2,
                ERROR: 3,
                level: 3,
                log: function (a, b) {
                    if (o.level <= a) {
                        var c = o.methodMap[a];
                        "undefined" != typeof console && console[c] && console[c].call(console, b)
                    }
                }
            };
            c.logger = o;
            var p = o.log;
            c.log = p;
            var q = function (a) {
                var b = f.extend({}, a);
                return b._parent = a, b
            };
            c.createFrame = q
        }, {"./exception": 4, "./utils": 7}], 4: [function (a, b, c) {
            "use strict";
            function d(a, b) {
                var c;
                b && b.firstLine && (c = b.firstLine, a += " - " + c + ":" + b.firstColumn);
                for (var d = Error.prototype.constructor.call(this, a), f = 0; f < e.length; f++)this[e[f]] = d[e[f]];
                c && (this.lineNumber = c, this.column = b.firstColumn)
            }

            var e = ["description", "fileName", "lineNumber", "message", "name", "number", "stack"];
            d.prototype = new Error, c["default"] = d
        }, {}], 5: [function (a, b, c) {
            "use strict";
            function d(a) {
                var b = a && a[0] || 1, c = l;
                if (b !== c) {
                    if (c > b) {
                        var d = m[c], e = m[b];
                        throw new k("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version (" + d + ") or downgrade your runtime to an older version (" + e + ").")
                    }
                    throw new k("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version (" + a[1] + ").")
                }
            }

            function e(a, b) {
                if (!b)throw new k("No environment passed to template");
                if (!a || !a.main)throw new k("Unknown template object: " + typeof a);
                b.VM.checkRevision(a.compiler);
                var c = function (c, d, e, f, g, h, i, l, m) {
                    g && (f = j.extend({}, f, g));
                    var n = b.VM.invokePartial.call(this, c, e, f, h, i, l, m);
                    if (null == n && b.compile) {
                        var o = {helpers: h, partials: i, data: l, depths: m};
                        i[e] = b.compile(c, {data: void 0 !== l, compat: a.compat}, b), n = i[e](f, o)
                    }
                    if (null != n) {
                        if (d) {
                            for (var p = n.split("\n"), q = 0, r = p.length; r > q && (p[q] || q + 1 !== r); q++)p[q] = d + p[q];
                            n = p.join("\n")
                        }
                        return n
                    }
                    throw new k("The partial " + e + " could not be compiled when running in runtime-only mode")
                }, d = {
                    lookup: function (a, b) {
                        for (var c = a.length, d = 0; c > d; d++)if (a[d] && null != a[d][b])return a[d][b]
                    }, lambda: function (a, b) {
                        return "function" == typeof a ? a.call(b) : a
                    }, escapeExpression: j.escapeExpression, invokePartial: c, fn: function (b) {
                        return a[b]
                    }, programs: [], program: function (a, b, c) {
                        var d = this.programs[a], e = this.fn(a);
                        return b || c ? d = f(this, a, e, b, c) : d || (d = this.programs[a] = f(this, a, e)), d
                    }, data: function (a, b) {
                        for (; a && b--;)a = a._parent;
                        return a
                    }, merge: function (a, b) {
                        var c = a || b;
                        return a && b && a !== b && (c = j.extend({}, b, a)), c
                    }, noop: b.VM.noop, compilerInfo: a.compiler
                }, e = function (b, c) {
                    c = c || {};
                    var f = c.data;
                    e._setup(c), !c.partial && a.useData && (f = i(b, f));
                    var g;
                    return a.useDepths && (g = c.depths ? [b].concat(c.depths) : [b]), a.main.call(d, b, d.helpers, d.partials, f, g)
                };
                return e.isTop = !0, e._setup = function (c) {
                    c.partial ? (d.helpers = c.helpers, d.partials = c.partials) : (d.helpers = d.merge(c.helpers, b.helpers), a.usePartial && (d.partials = d.merge(c.partials, b.partials)))
                }, e._child = function (b, c, e) {
                    if (a.useDepths && !e)throw new k("must pass parent depths");
                    return f(d, b, a[b], c, e)
                }, e
            }

            function f(a, b, c, d, e) {
                var f = function (b, f) {
                    return f = f || {}, c.call(a, b, a.helpers, a.partials, f.data || d, e && [b].concat(e))
                };
                return f.program = b, f.depth = e ? e.length : 0, f
            }

            function g(a, b, c, d, e, f, g) {
                var h = {partial: !0, helpers: d, partials: e, data: f, depths: g};
                if (void 0 === a)throw new k("The partial " + b + " could not be found");
                return a instanceof Function ? a(c, h) : void 0
            }

            function h() {
                return ""
            }

            function i(a, b) {
                return b && "root" in b || (b = b ? n(b) : {}, b.root = a), b
            }

            var j = a("./utils"), k = a("./exception")["default"], l = a("./base").COMPILER_REVISION, m = a("./base").REVISION_CHANGES, n = a("./base").createFrame;
            c.checkRevision = d, c.template = e, c.program = f, c.invokePartial = g, c.noop = h
        }, {"./base": 3, "./exception": 4, "./utils": 7}], 6: [function (a, b, c) {
            "use strict";
            function d(a) {
                this.string = a
            }

            d.prototype.toString = function () {
                return "" + this.string
            }, c["default"] = d
        }, {}], 7: [function (a, b, c) {
            "use strict";
            function d(a) {
                return j[a]
            }

            function e(a) {
                for (var b = 1; b < arguments.length; b++)for (var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b], c) && (a[c] = arguments[b][c]);
                return a
            }

            function f(a) {
                return a instanceof i ? a.toString() : null == a ? "" : a ? (a = "" + a, l.test(a) ? a.replace(k, d) : a) : a + ""
            }

            function g(a) {
                return a || 0 === a ? o(a) && 0 === a.length ? !0 : !1 : !0
            }

            function h(a, b) {
                return (a ? a + "." : "") + b
            }

            var i = a("./safe-string")["default"], j = {
                "&": "&amp;",
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "'": "&#x27;",
                "`": "&#x60;"
            }, k = /[&<>"'`]/g, l = /[&<>"'`]/;
            c.extend = e;
            var m = Object.prototype.toString;
            c.toString = m;
            var n = function (a) {
                return "function" == typeof a
            };
            n(/x/) && (n = function (a) {
                return "function" == typeof a && "[object Function]" === m.call(a)
            });
            var n;
            c.isFunction = n;
            var o = Array.isArray || function (a) {
                    return a && "object" == typeof a ? "[object Array]" === m.call(a) : !1
                };
            c.isArray = o, c.escapeExpression = f, c.isEmpty = g, c.appendContextPath = h
        }, {"./safe-string": 6}], 8: [function (a, b, c) {
            b.exports = a("./dist/cjs/handlebars.runtime")
        }, {"./dist/cjs/handlebars.runtime": 2}], 9: [function (a, b, c) {
            b.exports = a("handlebars/runtime")["default"]
        }, {"handlebars/runtime": 8}], 10: [function (a, b, c) {
            b.exports = {
                name: "phaser-debug",
                version: "1.1.2",
                description: "Simple debug module for phaser",
                author: "Chad Engler <chad@pantherdev.com>",
                license: "MIT",
                homepage: "https://github.com/englercj/phaser-debug",
                repository: {type: "git", url: "https://github.com/englercj/phaser-debug.git"},
                bugs: {url: "https://github.com/englercj/phaser-debug/issues"},
                keywords: ["phaser", "debug", "html5", "game", "engine"],
                dependencies: {handlebars: "^2.0.0", "node-lessify": "0.0.4", hbsfy: "^2.1.0"},
                devDependencies: {
                    browserify: "^5.11.1",
                    "event-stream": "^3.1.7",
                    gulp: "^3.8.8",
                    "gulp-bump": "^0.1.11",
                    "gulp-git": "^0.5.3",
                    "gulp-jshint": "^1.8.4",
                    "gulp-util": "^3.0.1",
                    "jshint-summary": "^0.4.0",
                    "vinyl-source-stream": "^0.1.1",
                    watchify: "^1.0.2"
                },
                browser: "./src/index.js",
                browserify: {transform: ["hbsfy", "node-lessify"], "transform-options": {"node-lessify": "textMode"}}
            }
        }, {}], 11: [function (a, b, c) {
            var d = a("hbsfy/runtime");
            b.exports = d.template({
                1: function (a, b, c, d) {
                    var e, f = this.lambda, g = this.escapeExpression;
                    return "    <label>Children:</label>\n    <strong>" + g(f(null != (e = null != a ? a.children : a) ? e.length : e, a)) + "</strong>\n    <br/>\n"
                }, 3: function (a, b, c, d) {
                    var e, f = "    <label>Texture:</label>\n";
                    return e = b["if"].call(a, null != (e = null != (e = null != (e = null != a ? a.texture : a) ? e.baseTexture : e) ? e.source : e) ? e.src : e, {
                        name: "if",
                        hash: {},
                        fn: this.program(4, d),
                        inverse: this.program(6, d),
                        data: d
                    }), null != e && (f += e), f + "    <br/>\n"
                }, 4: function (a, b, c, d) {
                    var e, f = this.lambda, g = this.escapeExpression;
                    return '        <a href="' + g(f(null != (e = null != (e = null != (e = null != a ? a.texture : a) ? e.baseTexture : e) ? e.source : e) ? e.src : e, a)) + '" target="_blank">' + g(f(null != (e = null != (e = null != (e = null != a ? a.texture : a) ? e.baseTexture : e) ? e.source : e) ? e.src : e, a)) + "</a>\n"
                }, 6: function (a, b, c, d) {
                    var e, f = this.lambda, g = this.escapeExpression;
                    return "        <strong>" + g(f(null != (e = null != (e = null != a ? a.texture : a) ? e.baseTexture : e) ? e.source : e, a)) + "</strong>\n"
                }, compiler: [6, ">= 2.0.0-beta.1"], main: function (a, b, c, d) {
                    var e, f, g = "function", h = b.helperMissing, i = this.escapeExpression, j = this.lambda, k = "<br/><br/>\n\n<label>Name:</label>\n<strong>" + i((f = null != (f = b.name || (null != a ? a.name : a)) ? f : h, typeof f === g ? f.call(a, {
                            name: "name",
                            hash: {},
                            data: d
                        }) : f)) + "</strong>\n<br/>\n\n<label>Type:</label>\n<strong>" + i((f = null != (f = b.typeString || (null != a ? a.typeString : a)) ? f : h, typeof f === g ? f.call(a, {
                            name: "typeString",
                            hash: {},
                            data: d
                        }) : f)) + "</strong>\n<br/>\n\n<label>Position:</label>\n<strong>" + i(j(null != (e = null != a ? a.position : a) ? e.x : e, a)) + "</strong> x <strong>" + i(j(null != (e = null != a ? a.position : a) ? e.y : e, a)) + "</strong>\n<br/>\n\n";
                    return e = b["if"].call(a, null != a ? a.children : a, {
                        name: "if",
                        hash: {},
                        fn: this.program(1, d),
                        inverse: this.noop,
                        data: d
                    }), null != e && (k += e), k += "\n", e = b["if"].call(a, null != a ? a.texture : a, {
                        name: "if",
                        hash: {},
                        fn: this.program(3, d),
                        inverse: this.noop,
                        data: d
                    }), null != e && (k += e), k
                }, useData: !0
            })
        }, {"hbsfy/runtime": 9}], 12: [function (a, b, c) {
            var d = a("hbsfy/runtime");
            b.exports = d.template({
                compiler: [6, ">= 2.0.0-beta.1"], main: function (a, b, c, d) {
                    return '<ul class="sidebar">\n</ul>\n\n<a href="#" class="refresh">refresh</a>\n<div class="details">\n</div>\n'
                }, useData: !0
            })
        }, {"hbsfy/runtime": 9}], 13: [function (a, b, c) {
            var d = a("hbsfy/runtime");
            b.exports = d.template({
                1: function (a, b, c, d) {
                    var e, f = "function", g = b.helperMissing, h = this.escapeExpression;
                    return '        <span class="weak">(' + h((e = null != (e = b.name || (null != a ? a.name : a)) ? e : g, typeof e === f ? e.call(a, {
                            name: "name",
                            hash: {},
                            data: d
                        }) : e)) + ")</span>\n"
                }, 3: function (a, b, c, d) {
                    var e, f = "        <ul>\n";
                    return e = b.each.call(a, null != a ? a.children : a, {
                        name: "each",
                        hash: {},
                        fn: this.program(4, d),
                        inverse: this.noop,
                        data: d
                    }), null != e && (f += e), f + "        </ul>\n"
                }, 4: function (a, b, c, d) {
                    var e, f = "";
                    return e = this.invokePartial(c.sceneTree, "                ", "sceneTree", a, void 0, b, c, d), null != e && (f += e), f
                }, compiler: [6, ">= 2.0.0-beta.1"], main: function (a, b, c, d) {
                    var e, f, g = "function", h = b.helperMissing, i = this.escapeExpression, j = i((f = null != (f = b.listItemOpen || (null != a ? a.listItemOpen : a)) ? f : h, typeof f === g ? f.call(a, {
                            name: "listItemOpen",
                            hash: {},
                            data: d
                        }) : f)) + "\n    " + i((f = null != (f = b.typeString || (null != a ? a.typeString : a)) ? f : h, typeof f === g ? f.call(a, {
                            name: "typeString",
                            hash: {},
                            data: d
                        }) : f)) + "\n\n";
                    return e = b["if"].call(a, null != a ? a.name : a, {
                        name: "if",
                        hash: {},
                        fn: this.program(1, d),
                        inverse: this.noop,
                        data: d
                    }), null != e && (j += e), j += "\n", e = b["if"].call(a, null != a ? a.children : a, {
                        name: "if",
                        hash: {},
                        fn: this.program(3, d),
                        inverse: this.noop,
                        data: d
                    }), null != e && (j += e), j + "</li>\n"
                }, usePartial: !0, useData: !0
            })
        }, {"hbsfy/runtime": 9}], 14: [function (a, b, c) {
            function d(a, b) {
                this.game = a, this.parent = b, this.name = "", this.title = "", this.active = !1, this._panel = null
            }

            var e = a("../util/ui");
            d.prototype.constructor = d, b.exports = d, d.prototype.createPanelElement = function () {
                var a = this._panel = document.createElement("div");
                return e.addClass(a, "pdebug-panel " + this.name), a
            }, d.prototype.createMenuElement = function () {
                var a = this._menuItem = document.createElement("a");
                return a.href = "#" + this.name, e.addClass(a, "pdebug-menu-item " + this.name), e.setText(a, this.title), a
            }, d.prototype.toggle = function () {
                this.active ? this.hide() : this.show()
            }, d.prototype.show = function () {
                this.active = !0, e.setStyle(this._panel, "display", "block")
            }, d.prototype.hide = function () {
                this.active = !1, e.setStyle(this._panel, "display", "none")
            }, d.prototype.destroy = function () {
                this.game = null, this.parent = null, this.name = null, this.title = null, this.active = null, this._panel = null
            }
        }, {"../util/ui": 19}], 15: [function (a, b, c) {
            function d(a, b) {
                e.call(this, a, b), this.name = "performance", this.title = "Performance", this.eventQueue = [], this.graph = null, this.colorPalettes = {_default: ["#058DC7", "#50B432", "#ED561B", "#DDDF00", "#24CBE5", "#64E572", "#FF9655", "#FFF263", "#6AF9C4", "#2b908f", "#90ee7e", "#f45b5b", "#7798BF", "#aaeeee", "#ff0066", "#eeaaee", "#55BF3B", "#DF5353", "#7798BF", "#aaeeee"]}
            }

            var e = a("./Panel"), f = a("../util/Graph");
            d.prototype = Object.create(e.prototype), d.prototype.constructor = d, b.exports = d, d.prototype.createPanelElement = function () {
                var a = e.prototype.createPanelElement.call(this);
                return this.graph = new f(a, window.innerWidth - 20, 256, this.colorPalettes._default), a
            }, d.prototype.update = function () {
                this.graph.addData(this.parent.timings)
            }, d.prototype.mark = function (a) {
                this.eventQueue.push(a)
            }, d.prototype.destroy = function () {
                e.prototype.destroy.call(this), this.graph.destroy(), this.eventQueue = null, this.graph = null, this.colorPalettes = null
            }
        }, {"../util/Graph": 18, "./Panel": 14}], 16: [function (a, b, c) {
            function d(a, b) {
                g.call(this, a, b), this.name = "scene", this.title = "Scene Tree", this._tree = null, this.tree = null, this.details = null, this.refresh = null, this.selected = null
            }

            function e() {
                return m[++n] = this, new i.SafeString("<li " + (this.children && this.children.length ? 'class="has-children" ' : "") + 'data-id="' + n + '">')
            }

            function f() {
                var a = this;
                if (void 0 === a.type)return a instanceof PIXI.Stage ? "PIXI Stage" : a instanceof PIXI.Sprite ? "PIXI Sprite" : a instanceof PIXI.DisplayObjectContainer ? "PIXI DisplayObjectContainer" : a instanceof PIXI.DisplayObject ? "PIXI DisplayObject" : "Unknown";
                switch (a.type) {
                    case Phaser.SPRITE:
                        return "Sprite";
                    case Phaser.BUTTON:
                        return "Button";
                    case Phaser.IMAGE:
                        return "Image";
                    case Phaser.GRAPHICS:
                        return "Graphics";
                    case Phaser.TEXT:
                        return "Text";
                    case Phaser.TILESPRITE:
                        return "Tile Sprite";
                    case Phaser.BITMAPTEXT:
                        return "Bitmap Text";
                    case Phaser.GROUP:
                        return "Group";
                    case Phaser.RENDERTEXTURE:
                        return "Render Texture";
                    case Phaser.TILEMAP:
                        return "Tilemap";
                    case Phaser.TILEMAPLAYER:
                        return "Tilemap Layer";
                    case Phaser.EMITTER:
                        return "Emitter";
                    case Phaser.POLYGON:
                        return "Polygon";
                    case Phaser.BITMAPDATA:
                        return "Bitmap Data";
                    case Phaser.CANVAS_FILTER:
                        return "Canvas Filter";
                    case Phaser.WEBGL_FILTER:
                        return "WebGL Filter";
                    case Phaser.ELLIPSE:
                        return "Ellipse";
                    case Phaser.SPRITEBATCH:
                        return "Sprite Batch";
                    case Phaser.RETROFONT:
                        return "Retro Font";
                    case Phaser.POINTER:
                        return "Pointer";
                    case Phaser.ROPE:
                        return "Rope";
                    default:
                        return "Unknown"
                }
            }

            var g = a("./Panel"), h = a("../util/ui"), i = a("hbsfy/runtime"), j = a("../hbs/scene/panel.hbs"), k = a("../hbs/scene/details.hbs"), l = a("../hbs/scene/tree.hbs"), m = {}, n = 0;
            i.registerPartial("sceneDetails", k), i.registerPartial("sceneTree", l), i.registerHelper("typeString", f), i.registerHelper("listItemOpen", e), d.prototype = Object.create(g.prototype), d.prototype.constructor = d, b.exports = d, d.prototype.createPanelElement = function () {
                return g.prototype.createPanelElement.call(this), this._panel.innerHTML = j(this.game.stage), this.tree = this._panel.querySelector(".sidebar"), this.details = this._panel.querySelector(".details"), this.refresh = this._panel.querySelector(".refresh"), h.on(this.tree, "click", "li", this._onLiClick.bind(this)), h.on(this.refresh, "click", this._onRefreshClick.bind(this)), this._panel
            }, d.prototype.rebuildTree = function () {
                h.empty(this.tree), m = {}, this.tree.innerHTML = l(this.game.stage), this.select(this.tree.querySelector("li:first-child")), h.addClass(this.selected, "expanded"), this.reloadDetails()
            }, d.prototype.reloadDetails = function () {
                var a = this.selected.dataset.id;
                this.details.innerHTML = k(m[a])
            }, d.prototype.select = function (a) {
                this.selected && h.removeClass(this.selected, "selected"), this.selected = a, h.addClass(this.selected, "selected")
            }, d.prototype.show = function () {
                this.rebuildTree(), g.prototype.show.call(this)
            }, d.prototype.destroy = function () {
                g.prototype.destroy.call(this), this.tree = null, this.details = null, this.refresh = null
            }, d.prototype._onLiClick = function (a) {
                a.stopPropagation(), this.select(a.delegateTarget), h.toggleClass(a.delegateTarget, "expanded"), this.reloadDetails()
            }, d.prototype._onRefreshClick = function (a) {
                a.preventDefault(), a.stopPropagation(), this.rebuildTree()
            }
        }, {
            "../hbs/scene/details.hbs": 11,
            "../hbs/scene/panel.hbs": 12,
            "../hbs/scene/tree.hbs": 13,
            "../util/ui": 19,
            "./Panel": 14,
            "hbsfy/runtime": 9
        }], 17: [function (a, b, c) {
            b.exports = ".pdebug{font-size:14px;position:fixed;bottom:0;width:100%;color:#aaa;background:#333;border-top:3px solid #00bf00}.pdebug a{color:#00bf00}.pdebug label{display:inline-block;width:60px}.pdebug strong{font-weight:400;color:#fff}.pdebug .weak{color:#aaa}.pdebug .pdebug-menu{height:32px;padding:0 15px;text-shadow:1px 1px 0 #111;background:#333}.pdebug .pdebug-menu span{display:inline-block;height:32px;line-height:32px}.pdebug .pdebug-menu .pdebug-head{padding-right:25px;border-right:1px solid #666}.pdebug .pdebug-menu .pdebug-stats{float:right;padding:0 0 0 10px}.pdebug .pdebug-menu .pdebug-stats .pdebug-stats-item{display:inline-block;width:100px;text-align:right}.pdebug .pdebug-menu .pdebug-stats .pdebug-stats-item>span{color:#fff}.pdebug .pdebug-menu .pdebug-stats .pdebug-stats-item.obj{width:100px;border:0}.pdebug .pdebug-menu .pdebug-menu-item{color:#fff;display:inline-block;text-decoration:none;padding:0 10px;height:32px;line-height:32px;border-right:1px solid #666}.pdebug .pdebug-menu .pdebug-menu-item.active{color:#00bf00;background:#111}.pdebug .pdebug-panel{display:none;height:265px;overflow:auto;font-size:12px;background:#111}.pdebug .pdebug-panel.scene .sidebar{float:left;height:100%;min-width:175px;max-width:500px;resize:horizontal;overflow:auto}.pdebug .pdebug-panel.scene .details{float:left;height:100%}.pdebug .pdebug-panel.scene .refresh{position:absolute}.pdebug .pdebug-panel.scene>ul{padding:0;margin:0;border-right:solid 1px #aaa;margin-right:10px}.pdebug .pdebug-panel.scene>ul li{color:#fff;list-style:none;cursor:pointer}.pdebug .pdebug-panel.scene>ul li.expanded>ul{display:block}.pdebug .pdebug-panel.scene>ul li.selected{color:#00bf00}.pdebug .pdebug-panel.scene>ul li::before{content:'-';display:inline-block;width:12px;height:1px;color:#aaa}.pdebug .pdebug-panel.scene>ul li.has-children::before{content:'';display:inline-block;width:0;height:0;margin:0 6px 0 0;border-top:6px solid transparent;border-bottom:6px solid transparent;border-right:0;border-left:6px solid rgba(255,255,255,.3)}.pdebug .pdebug-panel.scene>ul li.has-children.expanded::before{margin:0 4px 0 -4px;border-top:6px solid rgba(255,255,255,.3);border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:0}.pdebug .pdebug-panel.scene>ul li>ul{display:none;padding:0 0 0 10px}input[type=checkbox]{visibility:hidden}.checkbox{width:75px;height:26px;background:#333;position:relative;line-height:normal;-webkit-border-radius:50px;-moz-border-radius:50px;border-radius:50px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.5),0 1px 0 rgba(255,255,255,.2);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,.5),0 1px 0 rgba(255,255,255,.2);-o-box-shadow:inset 0 1px 1px rgba(0,0,0,.5),0 1px 0 rgba(255,255,255,.2);-ms-box-shadow:inset 0 1px 1px rgba(0,0,0,.5),0 1px 0 rgba(255,255,255,.2);box-shadow:inset 0 1px 1px rgba(0,0,0,.5),0 1px 0 rgba(255,255,255,.2)}.checkbox:after{content:'OFF';font:12px/26px Arial,sans-serif;color:#000;position:absolute;right:10px;z-index:0;font-weight:700;text-shadow:1px 1px 0 rgba(255,255,255,.15)}.checkbox:before{content:'ON';font:12px/26px Arial,sans-serif;color:#00bf00;position:absolute;left:10px;z-index:0;font-weight:700}.checkbox+span{position:relative;display:block;top:-25px;left:90px;width:200px;color:#fcfff4;font-size:1.1em}.checkbox input[type=checkbox]:checked+label{left:38px}.checkbox label{display:block;width:34px;height:20px;-webkit-border-radius:50px;-moz-border-radius:50px;border-radius:50px;-webkit-transition:all .4s ease;-moz-transition:all .4s ease;-o-transition:all .4s ease;-ms-transition:all .4s ease;transition:all .4s ease;cursor:pointer;position:absolute;top:3px;left:3px;z-index:1;background:#fcfff4;background:-webkit-linear-gradient(top,#fcfff4 0,#dfe5d7 40%,#b3bead 100%);background:-moz-linear-gradient(top,#fcfff4 0,#dfe5d7 40%,#b3bead 100%);background:-o-linear-gradient(top,#fcfff4 0,#dfe5d7 40%,#b3bead 100%);background:-ms-linear-gradient(top,#fcfff4 0,#dfe5d7 40%,#b3bead 100%);background:linear-gradient(top,#fcfff4 0,#dfe5d7 40%,#b3bead 100%);-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.3);-moz-box-shadow:0 2px 5px 0 rgba(0,0,0,.3);box-shadow:0 2px 5px 0 rgba(0,0,0,.3)}"
        }, {}], 18: [function (a, b, c) {
            function d(a, b, c, d, e) {
                e = e || {}, this.canvas = document.createElement("canvas"), this.canvas.width = b, this.canvas.height = c, a.appendChild(this.canvas), this.ctx = this.canvas.getContext("2d"), this.labelStyle = "rgba(200, 200, 200, 0.6)", this.maxValue = e.maxValue || 50, this.padding = e.labelPadding || 5, this.dataLineWidth = e.lineWidth || 1, this.legendWidth = 230, this.legendBoxSize = 10, this.legendIndent = 5, this.colors = d, this.dataCanvas = document.createElement("canvas"), this.dataCanvas.width = b - this.legendWidth, this.dataCanvas.height = c, this.dctx = this.dataCanvas.getContext("2d"), this.dataCanvasBuffer = document.createElement("canvas"), this.dataCanvasBuffer.width = this.dataCanvas.width - this.dataLineWidth, this.dataCanvasBuffer.height = this.dataCanvas.height, this.bctx = this.dataCanvasBuffer.getContext("2d")
            }

            d.prototype.constructor = d, b.exports = d, d.prototype.addData = function (a) {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height), this.drawBg(), this.drawLegend(a), this.drawData(a)
            }, d.prototype.drawBg = function () {
                var a = Math.floor(this.canvas.height - this.canvas.height * (16 / this.maxValue)) + .5, b = Math.floor(this.canvas.height - this.canvas.height * (33 / this.maxValue)) + .5;
                this.ctx.strokeStyle = this.ctx.fillStyle = this.labelStyle, this.ctx.lineWidth = 1, this.ctx.beginPath(), this.ctx.moveTo(this.legendWidth, a), this.ctx.lineTo(this.canvas.width, a), this.ctx.stroke(), this.ctx.fillText("16ms (60 fps)", this.legendWidth + this.padding, a - this.padding), this.ctx.beginPath(), this.ctx.moveTo(this.legendWidth, b), this.ctx.lineTo(this.canvas.width, b), this.ctx.stroke(), this.ctx.fillText("33ms (30 fps)", this.legendWidth + this.padding, b - this.padding), this.ctx.beginPath(), this.ctx.moveTo(this.legendWidth, this.canvas.height - .5), this.ctx.lineTo(this.canvas.width, this.canvas.height - .5), this.ctx.stroke()
            }, d.prototype.drawLegend = function (a) {
                var b = 0, c = 0, d = this.padding, e = 0;
                for (var f in a) {
                    e = c * this.legendBoxSize + this.padding * (c + 1) + this.padding, this.ctx.fillStyle = this.labelStyle, this.ctx.fillText(f, d, e), ++c;
                    for (var g in a[f])e = c * this.legendBoxSize + this.padding * c, this.ctx.fillStyle = this.colors[b++ % this.colors.length], this.ctx.fillRect(d + this.legendIndent, e, this.legendBoxSize, this.legendBoxSize), this.ctx.fillStyle = this.labelStyle, this.ctx.fillText(Math.round(a[f][g]) + "ms - " + g, d + this.legendIndent + this.legendBoxSize + this.padding, e + this.legendBoxSize), ++c, c > 16 && (d += this.legendWidth / 2, c = 0)
                }
            }, d.prototype.drawData = function (a) {
                var b = this.dataCanvas.width - this.dataLineWidth + .5, c = this.dataCanvas.height - .5;
                this.bctx.clearRect(0, 0, this.dataCanvasBuffer.width, this.dataCanvasBuffer.height), this.bctx.drawImage(this.dataCanvas, this.dataLineWidth, 0, b, c, 0, 0, b, c), this.dctx.clearRect(0, 0, this.dataCanvas.width, this.dataCanvas.height), this.dctx.drawImage(this.dataCanvasBuffer, 0, 0);
                var d = 0, e = 0;
                for (var f in a)for (var g in a[f])this.dctx.beginPath(), this.dctx.strokeStyle = this.dctx.fillStyle = this.colors[d++ % this.colors.length], this.dctx.lineWidth = this.dataLineWidth, e = a[f][g] / this.maxValue * this.dataCanvas.height, e = 0 > e ? 0 : e, this.dctx.moveTo(b, c), this.dctx.lineTo(b, c -= e), this.dctx.stroke();
                this.ctx.drawImage(this.dataCanvas, this.legendWidth, 0)
            }, d.prototype.destroy = function () {
                this.canvas = null, this.ctx = null, this.labelStyle = null, this.maxValue = null, this.padding = null, this.dataLineWidth = null, this.legendWidth = null, this.legendBoxSize = null, this.legendIndent = null, this.colors = null, this.dataCanvas = null, this.dctx = null, this.dataCanvasBuffer = null, this.bctx = null
            }
        }, {}], 19: [function (a, b, c) {
            var d = {
                delegate: function (a, b, c, d) {
                    a.addEventListener(b, function (a) {
                        window.target = a.target, a.target && a.target.matches(c) ? (a.delegateTarget = a.target, d && d(a)) : a.target.parentElement && a.target.parentElement.matches(c) && (a.delegateTarget = a.target.parentElement, d && d(a))
                    })
                }, on: function (a, b, c, e) {
                    return "function" == typeof c && (e = c, c = null), c ? d.delegate(a, b, c, e) : void a.addEventListener(b, e)
                }, removeClass: function (a, b) {
                    var c = a.className.split(" "), d = c.indexOf(b);
                    -1 !== d && (c.splice(d, 1), a.className = c.join(" ").trim())
                }, addClass: function (a, b) {
                    var c = a.className.split(" ");
                    c.push(b), a.className = c.join(" ").trim()
                }, hasClass: function (a, b) {
                    return -1 !== a.className.split(" ").indexOf(b)
                }, toggleClass: function (a, b) {
                    d.hasClass(a, b) ? d.removeClass(a, b) : d.addClass(a, b)
                }, setText: function (a, b) {
                    a.textContent = b
                }, setHtml: function (a, b) {
                    a.innerHTML = b
                }, setStyle: function (a, b, c) {
                    if ("string" == typeof b)a.style[b] = c; else for (var d in b)a.style[d] = b[d]
                }, empty: function (a) {
                    for (; a.firstChild;)a.removeChild(a.firstChild)
                }, show: function (a) {
                    d.setStyle(a, "display", "block")
                }, hide: function (a) {
                    d.setStyle(a, "display", "none")
                }, clear: function () {
                    var a = document.createElement("br");
                    return d.setStyle(a, "clear", "both"), a
                }, addCss: function (a) {
                    var b = document.createElement("style");
                    b.type = "text/css", b.styleSheet ? b.styleSheet.cssText = a : b.appendChild(document.createTextNode(a)), document.head.appendChild(b)
                }
            };
            if (b.exports = d, !HTMLElement.prototype.matches) {
                var e = HTMLElement.prototype;
                e.matches = e.matches || e.webkitMatchesSelector || e.mozMatchesSelector || e.msMatchesSelector || e.oMatchesSelector || function (a) {
                        for (var b, c = this.parentElement.querySelectorAll(a), d = 0; b = c[d++];)if (b === this)return !0;
                        return !1
                    }
            }
        }, {}]
    }, {}, [1])(1)
}),define("KME/utils/ItemSpriteAtlas", [], function () {
    KME.ItemSpriteAtlas = function (a) {
        this.game = a, this._atlas = {
            UnknownItem: {image: "itemIcons", frame: 49},
            Hands: {image: "itemIcons", frame: 0},
            Poles: {image: "itemIcons200", frame: 114},
            Lime: {image: "itemIcons200", frame: 157},
            CopperNails: {image: "itemIcons200", frame: 141},
            CopperKnife: {image: "itemIcons200", frame: 118, equip: {modelName: "copperKnife"}},
            CopperArrowheads: {image: "itemIcons200", frame: 142},
            CopperArrows: {image: "itemIcons200", frame: 150},
            CopperAxe: {image: "itemIcons200", frame: 117, equip: {modelName: "copperAxe"}},
            CopperSickle: {image: "itemIcons200", frame: 119, equip: {modelName: "copperSickle"}},
            CopperBucket: {image: "itemIcons200", frame: 116, equip: {modelName: "copperBucket"}},
            CopperSaw: {image: "itemIcons200", frame: 85, equip: {modelName: "copperSaw"}},
            CopperSword: {image: "itemIcons200", frame: 83, equip: {modelName: "copperSword"}},
            CopperScissors: {image: "itemIcons200", frame: 86, equip: {modelName: "copperScissors"}},
            CopperScalyArmor: {image: "itemIcons200", frame: 84, equip: {modelName: "copperBody"}},
            ClayMold: {image: "itemIcons200", frame: 156},
            BronzeHammer: {image: "itemIcons200", frame: 97, equip: {modelName: "bronzeHammer"}},
            BronzeNails: {image: "itemIcons200", frame: 140},
            BronzeArrowheads: {image: "itemIcons200", frame: 143},
            BronzeArrows: {image: "itemIcons200", frame: 151},
            BronzeStaples: {image: "itemIcons200", frame: 109},
            BronzeKnife: {image: "itemIcons200", frame: 108, equip: {modelName: "bronzeKnife"}},
            BronzeSpear: {image: "itemIcons200", frame: 107, equip: {modelName: "bronzeSpear"}},
            BronzeRoundShield: {image: "itemIcons200", frame: 100, equip: {modelName: "bronzeRoundShield"}},
            BronzeAxe: {image: "itemIcons200", frame: 99, equip: {modelName: "bronzeAxe"}},
            BronzeHelmet: {image: "itemIcons200", frame: 103, equip: {modelName: "bronzeHead", hairChange: "none"}},
            BronzeBracers: {image: "itemIcons200", frame: 104, equip: {modelName: "bronzeHands"}},
            BronzePickaxe: {image: "itemIcons200", frame: 98, equip: {modelName: "bronzePick"}},
            BronzeLeggins: {image: "itemIcons200", frame: 115, equip: {modelName: "bronzeLegs"}},
            BronzeGreaves: {image: "itemIcons200", frame: 105, equip: {modelName: "bronzeFoots"}},
            BronzeLargeShield: {image: "itemIcons200", frame: 101, equip: {modelName: "bronzeLargeShield"}},
            BronzeSword: {image: "itemIcons200", frame: 106, equip: {modelName: "bronzeSword"}},
            BronzeBreastplate: {image: "itemIcons200", frame: 102, equip: {modelName: "bronzeBody"}},
            IronArrowheads: {image: "itemIcons200", frame: 145},
            IronCorners: {image: "itemIcons200", frame: 148},
            IronPlates: {image: "itemIcons200", frame: 155},
            IronStrips: {image: "itemIcons200", frame: 153},
            SteelRivets: {image: "itemIcons200", frame: 147},
            SteelCorners: {image: "itemIcons200", frame: 149},
            SteelPlates: {image: "itemIcons200", frame: 154},
            SteelStrips: {image: "itemIcons200", frame: 152},
            SteelArrowheads: {image: "itemIcons200", frame: 146},
            CopperOre: {image: "itemIcons200", frame: 90},
            CopperIngot: {image: "itemIcons200", frame: 87},
            TinOre: {image: "itemIcons200", frame: 91},
            TinOreWithCharcoal: {image: "itemIcons200", frame: 92},
            TinIngot: {image: "itemIcons200", frame: 89},
            BronzeIngot: {image: "itemIcons200", frame: 88},
            IronBloom: {image: "itemIcons200", frame: 94},
            Coal: {image: "itemIcons200", frame: 96},
            IronWithCharcoal: {image: "itemIcons200", frame: 95},
            CrudePlanks: {image: "itemIcons200", frame: 110},
            Staves: {image: "itemIcons200", frame: 111},
            Balk: {image: "itemIcons200", frame: 112},
            Branches: {image: "itemIcons200", frame: 113},
            PandaMount: {image: "itemIcons200", frame: 49},
            PlagueMask: {image: "itemIcons200", frame: 79, equip: {modelName: "plagueMask", hairChange: "none"}},
            DarkBurgonet: {image: "itemIcons200", frame: 71, equip: {modelName: "darkBurgonet", hairChange: "none"}},
            LightGreatHelm: {
                image: "itemIcons200",
                frame: 82,
                equip: {modelName: "lightGreatHelm", hairChange: "none"}
            },
            DarkGreatHelm: {image: "itemIcons200", frame: 81, equip: {modelName: "darkGreatHelm", hairChange: "none"}},
            LightBarbute: {image: "itemIcons200", frame: 76, equip: {modelName: "lightBarbute", hairChange: "none"}},
            DarkBarbute: {image: "itemIcons200", frame: 75, equip: {modelName: "darkBarbute", hairChange: "none"}},
            SpanishHorseHelmet: {
                image: "itemIcons200",
                frame: 73,
                equip: {modelName: "spanishHorseHelmet", hairChange: "none"}
            },
            GrandSpanishHorseHelmet: {
                image: "itemIcons200",
                frame: 74,
                equip: {modelName: "grandSpanishHorseHelmet", hairChange: "none"}
            },
            HornedHelmet: {image: "itemIcons200", frame: 80, equip: {modelName: "hornedHelmet", hairChange: "none"}},
            ForestDefenderHelmet: {
                image: "itemIcons200",
                frame: 78,
                equip: {modelName: "forestDefenderHelmet", hairChange: "none"}
            },
            VikingHelmet: {image: "itemIcons200", frame: 77, equip: {modelName: "vikingHelmet", hairChange: "none"}},
            SteelAngelBarbute: {
                image: "itemIcons200",
                frame: 72,
                equip: {modelName: "steelAngelBarbute", hairChange: "none"}
            },
            WoolenCloak: {image: "itemIcons200", frame: 56, equip: {modelName: "woolenCloak"}},
            WhiteWoolenCloak: {image: "itemIcons200", frame: 53, equip: {modelName: "woolenWhiteCloak"}},
            GreyWoolenCloak: {image: "itemIcons200", frame: 50, equip: {modelName: "woolenGreyCloak"}},
            RedWoolenCloak: {image: "itemIcons200", frame: 52, equip: {modelName: "woolenRedCloak"}},
            YellowWoolenCloak: {image: "itemIcons200", frame: 55, equip: {modelName: "woolenYellowCloak"}},
            GreenWoolenCloak: {image: "itemIcons200", frame: 54, equip: {modelName: "woolenGreenCloak"}},
            BlueWoolenCloak: {image: "itemIcons200", frame: 57, equip: {modelName: "woolenBlueCloak"}},
            VioletWoolenCloak: {image: "itemIcons200", frame: 58, equip: {modelName: "woolenVioletCloak"}},
            BrownWoolenCloak: {image: "itemIcons200", frame: 51, equip: {modelName: "woolenBrownCloak"}},
            ZebraMount: {image: "itemIcons200", frame: 68},
            WhiteHorseMount: {image: "itemIcons200", frame: 62},
            BlackHorseMount: {image: "itemIcons200", frame: 63},
            GreyHorseMount: {image: "itemIcons200", frame: 65},
            PintobayHorseMount: {image: "itemIcons200", frame: 64},
            SpottedHorseMount: {image: "itemIcons200", frame: 66},
            KaurHorseMount: {image: "itemIcons200", frame: 67},
            DunHorseMount: {image: "itemIcons200", frame: 61},
            BayHorseMount: {image: "itemIcons200", frame: 60},
            BrownBearMount: {image: "itemIcons200", frame: 45},
            WhiteBearMount: {image: "itemIcons200", frame: 48},
            BlackBearMount: {image: "itemIcons200", frame: 47},
            BlackDust: {image: "itemIcons200", frame: 9},
            DismountAction: {image: "itemIcons200", frame: 33},
            DeerMount: {image: "itemIcons200", frame: 42},
            WolfMount: {image: "itemIcons200", frame: 43},
            HorseMount: {image: "itemIcons200", frame: 63},
            BearMount: {image: "itemIcons200", frame: 47},
            BoarMount: {image: "itemIcons200", frame: 46},
            BearSnare: {image: "itemIcons200", frame: 40, equip: {modelName: "steelLariat"}},
            WolfSnare: {image: "itemIcons200", frame: 38, equip: {modelName: "ironLariat"}},
            BoarSnare: {image: "itemIcons200", frame: 35, equip: {modelName: "linenLariat"}},
            DeerSnare: {image: "itemIcons200", frame: 37, equip: {modelName: "linenLariat"}},
            HorseSnare: {image: "itemIcons200", frame: 36, equip: {modelName: "linenLariat"}},
            AdminSnare: {image: "itemIcons200", frame: 41, equip: {modelName: "steelLariat"}},
            ChristmasDecorations: {image: "itemIcons200", frame: 17},
            ChristmasSnowflake: {image: "itemIcons200", frame: 19},
            firBranches: {image: "itemIcons", frame: 177},
            firCone: {image: "itemIcons", frame: 175},
            MistletoeBranches: {image: "itemIcons", frame: 179},
            MadderRoot: {image: "itemIcons", frame: 176},
            MadderDye: {image: "itemIcons", frame: 169},
            Wool: {image: "itemIcons200", frame: 2},
            WoolenThreads: {image: "itemIcons200", frame: 3},
            WoolenCloth: {image: "itemIcons200", frame: 4},
            RedWoolenCloth: {image: "itemIcons200", frame: 5},
            RedLinen: {image: "itemIcons200", frame: 6},
            RedTapes: {image: "itemIcons200", frame: 7},
            ChristmasCandy: {image: "itemIcons200", frame: 10},
            ChristmasBiscuit: {image: "itemIcons200", frame: 12},
            IronScissors: {image: "itemIcons200", frame: 1, equip: {modelName: "ironScissors"}},
            SteelScissors: {image: "itemIcons200", frame: 0, equip: {modelName: "steelScissors"}},
            NeedleBone: {image: "itemIcons", frame: 46},
            NeedleIron: {image: "itemIcons", frame: 47},
            NeedleSteel: {image: "itemIcons", frame: 48},
            Snow: {image: "itemIcons200", frame: 29},
            SmallSnowball: {image: "itemIcons200", frame: 27},
            LargeSnowball: {image: "itemIcons200", frame: 28},
            ChristmasBell: {image: "itemIcons200", frame: 26, equip: {modelName: "FChrBell"}},
            ChristmasBag: {image: "itemIcons200", frame: 24, equip: {modelName: "FChrBag"}},
            ChristmasStaff: {image: "itemIcons200", frame: 25, equip: {modelName: "FChrStaff"}},
            ChristmasCloak: {image: "itemIcons200", frame: 20, equip: {modelName: "FChrCloak"}},
            ChristmasHat: {image: "itemIcons200", frame: 21, equip: {modelName: "FChrHat"}},
            ChristmasBoots: {image: "itemIcons200", frame: 23, equip: {modelName: "FChrFoot"}},
            ChristmasMittens: {image: "itemIcons200", frame: 22, equip: {modelName: "FChrHand"}},
            LinenCloak: {image: "itemIcons", frame: 98, equip: {modelName: "linenCloak"}},
            StrawHat: {
                image: "itemIcons",
                frame: 119,
                equip: {modelName: "farmerHat", visualPosition: "hat", hairChange: "hatHair"}
            },
            WoodenShield: {image: "itemIcons", frame: 139, equip: {modelName: "woodenShield"}},
            WitchHat: {
                image: "itemIcons",
                frame: 107,
                equip: {modelName: "witchHat", visualPosition: "hat", hairChange: "hatHair"}
            },
            WitchCloak: {image: "itemIcons", frame: 109, equip: {modelName: "witchCloak"}},
            PumpkinHelmet: {image: "itemIcons", frame: 108, equip: {modelName: "FJackMask"}},
            HalloweenJacket: {image: "itemIcons", frame: 103, equip: {modelName: "FBLeatherBody"}},
            HalloweenPants: {image: "itemIcons", frame: 104, equip: {modelName: "FBLeatherLegs"}},
            HalloweenBoots: {image: "itemIcons", frame: 105, equip: {modelName: "FBLeatherFoot"}},
            HalloweenGloves: {image: "itemIcons", frame: 106, equip: {modelName: "FBLeatherHand"}},
            HalloweenSpider: {image: "itemIcons", frame: 168},
            JackLamp: {image: "itemIcons", frame: 167},
            VictoryFlag: {image: "itemIcons", frame: 118},
            PumpkinSeeds: {image: "itemIcons", frame: 159},
            GrapesSeeds: {image: "itemIcons", frame: 195},
            Pumpkin: {image: "itemIcons", frame: 189},
            PumpkinPieces: {image: "itemIcons", frame: 194},
            Grapes: {image: "itemIcons", frame: 196},
            Raisins: {image: "itemIcons", frame: 197},
            Bones: {image: "itemIcons", frame: 198},
            BoneMeal: {image: "itemIcons", frame: 199},
            Glue: {image: "itemIcons", frame: 86},
            GluedLeather: {image: "itemIcons", frame: 87},
            HardenedLeather: {image: "itemIcons", frame: 138},
            FlaxCloth: {image: "itemIcons", frame: 128},
            FlaxThreads: {image: "itemIcons", frame: 127},
            Ropes: {image: "itemIcons", frame: 126},
            Handles: {image: "itemIcons", frame: 137},
            Skulls: {image: "itemIcons", frame: 190},
            Veins: {image: "itemIcons", frame: 192},
            StrangeSkull: {image: "itemIcons", frame: 191},
            cepRawMushrooms: {image: "itemIcons", frame: 180},
            BakedCeps: {image: "itemIcons", frame: 181},
            chanterelleRawMushrooms: {image: "itemIcons", frame: 182},
            BakedChanterelles: {image: "itemIcons", frame: 183},
            RawVegetableStew: {image: "itemIcons", frame: 165},
            VegetableStew: {image: "itemIcons", frame: 166},
            Planks: {image: "itemIcons", frame: 155},
            UnfiredBricks: {image: "itemIcons", frame: 156},
            Bricks: {image: "itemIcons", frame: 157},
            Cement: {image: "itemIcons", frame: 136},
            Nails: {image: "itemIcons", frame: 129},
            Seeds: {image: "itemIcons", frame: 184},
            FlaxSeeds: {image: "itemIcons", frame: 185},
            RawFlax: {image: "itemIcons", frame: 186},
            DriedFlax: {image: "itemIcons", frame: 187},
            FlaxFibres: {image: "itemIcons", frame: 188},
            Hay: {image: "itemIcons", frame: 158},
            Clay: {image: "itemIcons", frame: 153},
            Bark: {image: "itemIcons", frame: 154},
            Leather: {image: "itemIcons", frame: 124},
            BigLeather: {image: "itemIcons", frame: 125},
            UnfiredClayPot: {image: "itemIcons", frame: 160},
            ClayPot: {image: "itemIcons", frame: 161},
            TanningLiquor: {image: "itemIcons", frame: 163},
            RawMeatCarrotPottage: {image: "itemIcons", frame: 164},
            MeatCarrotPottage: {image: "itemIcons", frame: 162},
            SteelKnife: {image: "itemIcons", frame: 141, equip: {modelName: "steelKnife"}},
            SteelAxe: {image: "itemIcons", frame: 142, equip: {modelName: "steelAxe"}},
            SteelHammer: {image: "itemIcons", frame: 143, equip: {modelName: "steelHammer"}},
            SteelTippedArrow: {image: "itemIcons", frame: 144},
            SteelSaw: {image: "itemIcons", frame: 146, equip: {modelName: "steelSaw"}},
            SteelSickle: {image: "itemIcons", frame: 147, equip: {modelName: "steelSickle"}},
            CastIronAmmo: {image: "itemIcons", frame: 148},
            SteelShield: {image: "itemIcons", frame: 149, equip: {modelName: "steelShield"}},
            SteelIngot: {image: "itemIcons", frame: 150},
            CastIronIngot: {image: "itemIcons", frame: 151},
            CharCoal: {image: "itemIcons", frame: 152},
            StoneAmmo: {image: "itemIcons", frame: 140},
            SteelCuirass: {image: "itemIcons", frame: 130, equip: {modelName: "steelBody"}},
            SteelLeggings: {image: "itemIcons", frame: 131, equip: {modelName: "steelLegs"}},
            SteelGreaves: {image: "itemIcons", frame: 132, equip: {modelName: "steelFoots"}},
            SteelHelmet: {image: "itemIcons", frame: 133, equip: {modelName: "steelHead", hairChange: "none"}},
            SteelGloves: {image: "itemIcons", frame: 134, equip: {modelName: "steelHands"}},
            BearHideCloak: {image: "itemIcons", frame: 135, equip: {modelName: "bearCloak"}},
            BearHead: {image: "itemIcons", frame: 59},
            BearHeadHelmet: {image: "itemIcons", frame: 69, equip: {modelName: "bearHat", hairChange: "none"}},
            BearHide: {image: "itemIcons", frame: 120},
            BearRawHide: {image: "itemIcons", frame: 121},
            BigHide: {image: "itemIcons", frame: 122},
            BigRawHide: {image: "itemIcons", frame: 123},
            PremiumCuirass: {image: "itemIcons", frame: 110, equip: {modelName: "nobleBody"}},
            PremiumLeggings: {image: "itemIcons", frame: 111, equip: {modelName: "nobleLegs"}},
            PremiumGreaves: {image: "itemIcons", frame: 112, equip: {modelName: "nobleFoots"}},
            PremiumGloves: {image: "itemIcons", frame: 114, equip: {modelName: "nobleHands"}},
            PremiumSword: {image: "itemIcons", frame: 116, equip: {modelName: "nobleSword"}},
            PremiumShield: {image: "itemIcons", frame: 115, equip: {modelName: "nobleShield"}},
            PremiumCloak: {image: "itemIcons", frame: 117, equip: {modelName: "nobleCloak"}},
            FindDrawing: {image: "itemIcons", frame: 96},
            FindBook: {image: "itemIcons", frame: 97},
            AppleTreeSeedling: {image: "itemIcons", frame: 94},
            SteelSword: {image: "itemIcons", frame: 101, equip: {modelName: "steelSword"}},
            SteelPickaxe: {image: "itemIcons", frame: 100, equip: {modelName: "steelPick"}},
            CompositeBow: {
                image: "itemIcons",
                frame: 102,
                equip: {modelName: "compositeBow", visualPosition: "leftHand"}
            },
            Apple: {image: "itemIcons", frame: 95},
            AdminBow: {image: "itemIcons", frame: 45, equip: {modelName: "adminBow", visualPosition: "leftHand"}},
            HuntingSling: {image: "itemIcons", frame: 91, equip: {modelName: "hunterSling"}},
            ShortBow: {image: "itemIcons", frame: 90, equip: {modelName: "shortBow", visualPosition: "leftHand"}},
            ForgedBucket: {image: "itemIcons", frame: 82, equip: {modelName: "ironBucket"}},
            WoodenSnare: {image: "itemIcons", frame: 84},
            IronTippedArrow: {image: "itemIcons", frame: 92},
            Feathers: {image: "itemIcons", frame: 18},
            HenInCage: {image: "itemIcons", frame: 85},
            Eggs: {image: "itemIcons", frame: 9},
            ShirredEggs: {image: "itemIcons", frame: 19},
            Stone: {image: "itemIcons", frame: 0},
            Wood: {image: "itemIcons", frame: 1},
            RawHide: {image: "itemIcons", frame: 2},
            Meat: {image: "itemIcons", frame: 3},
            IronOre: {image: "itemIcons", frame: 4},
            GrainWheat: {image: "itemIcons", frame: 5},
            Carrot: {image: "itemIcons", frame: 6},
            ashTreeSeedling: {image: "itemIcons", frame: 75},
            alderTreeSeedling: {image: "itemIcons", frame: 89},
            pineTreeSeedling: {image: "itemIcons", frame: 77},
            willowTreeSeedling: {image: "itemIcons", frame: 93},
            mapleTreeSeedling: {image: "itemIcons", frame: 76},
            aspenTreeSeedling: {image: "itemIcons", frame: 79},
            firTreeSeedling: {image: "itemIcons", frame: 78},
            birchTreeSeedling: {image: "itemIcons", frame: 88},
            Boulder: {image: "itemIcons", frame: 7},
            Log: {image: "itemIcons", frame: 8},
            WoodenBucketWater: {image: "itemIcons", frame: 10, equip: {modelName: "waterBucket"}},
            Bannock: {image: "itemIcons", frame: 11},
            Hide: {image: "itemIcons", frame: 12},
            RoastMeat: {image: "itemIcons", frame: 13},
            IronIngot: {image: "itemIcons", frame: 14},
            Flour: {image: "itemIcons", frame: 15},
            Dough: {image: "itemIcons", frame: 16},
            Bandage: {image: "itemIcons", frame: 17},
            WomanCutHead: {image: "itemIcons", frame: 80},
            ManCutHead: {image: "itemIcons", frame: 81},
            HareHead: {image: "itemIcons", frame: 55},
            DeerHead: {image: "itemIcons", frame: 56},
            BoarHead: {image: "itemIcons", frame: 57},
            WolfHead: {image: "itemIcons", frame: 58},
            StoneKnife: {image: "itemIcons", frame: 20, equip: {modelName: "stoneKnife"}},
            StoneAxe: {image: "itemIcons", frame: 21, equip: {modelName: "stoneAxe"}},
            StoneHammer: {image: "itemIcons", frame: 22, equip: {modelName: "stoneHammer"}},
            StonePick: {image: "itemIcons", frame: 29, equip: {modelName: "stonePick"}},
            WoodenShovel: {image: "itemIcons", frame: 23, equip: {modelName: "woodenShovel"}},
            Torch: {image: "itemIcons", frame: 24, equip: {modelName: "torch"}},
            HideSling: {image: "itemIcons", frame: 25, equip: {modelName: "simpleSling"}},
            Bow: {image: "itemIcons", frame: 26, equip: {modelName: "woodenBow", visualPosition: "leftHand"}},
            StoneTippedArrow: {image: "itemIcons", frame: 27},
            WoodenSpear: {image: "itemIcons", frame: 28, equip: {modelName: "woodenSpear"}},
            IronKnife: {image: "itemIcons", frame: 30, equip: {modelName: "ironKnife"}},
            IronAxe: {image: "itemIcons", frame: 31, equip: {modelName: "ironAxe"}},
            IronHammer: {image: "itemIcons", frame: 32, equip: {modelName: "ironHammer"}},
            IronShovel: {image: "itemIcons", frame: 33, equip: {modelName: "ironShovel"}},
            IronPickaxe: {image: "itemIcons", frame: 34, equip: {modelName: "ironPick"}},
            IronSaw: {image: "itemIcons", frame: 35, equip: {modelName: "ironSaw"}},
            IronSword: {image: "itemIcons", frame: 36, equip: {modelName: "ironSword"}},
            IronShield: {image: "itemIcons", frame: 37, equip: {modelName: "ironShield"}},
            IronSickle: {image: "itemIcons", frame: 38, equip: {modelName: "ironSickle"}},
            HuntingBow: {image: "itemIcons", frame: 39, equip: {modelName: "hunterBow", visualPosition: "leftHand"}},
            ClothVest: {image: "itemIcons", frame: 40},
            ClothTrousers: {image: "itemIcons", frame: 41},
            ClothSandals: {image: "itemIcons", frame: 42},
            ClothCap: {image: "itemIcons", frame: 43},
            AdminVest: {image: "itemIcons", frame: 40},
            AdminTrousers: {image: "itemIcons", frame: 41},
            AdminSandals: {image: "itemIcons", frame: 42},
            AdminTiara: {image: "itemIcons", frame: 43},
            LightSaber: {image: "itemIcons", frame: 44, equip: {modelName: "adminSword"}},
            RawHideVest: {image: "itemIcons", frame: 50, equip: {modelName: "rawHideBody"}},
            RawHideLoincloth: {image: "itemIcons", frame: 51, equip: {modelName: "rawHideLegs"}},
            RawHideBoots: {image: "itemIcons", frame: 52, equip: {modelName: "rawHideFoots"}},
            RawHideCap: {image: "itemIcons", frame: 53, equip: {modelName: "rawHideHead"}},
            RawHideGloves: {image: "itemIcons", frame: 54, equip: {modelName: "rawHideHands"}},
            HideJacket: {image: "itemIcons", frame: 60, equip: {modelName: "hideBody"}},
            HidePants: {image: "itemIcons", frame: 61, equip: {modelName: "hideLegs"}},
            HideBoots: {image: "itemIcons", frame: 62, equip: {modelName: "hideFoots"}},
            HideHelmet: {image: "itemIcons", frame: 63, equip: {modelName: "hideHead", hairChange: "hatHair"}},
            HideGloves: {image: "itemIcons", frame: 64, equip: {modelName: "hideHands"}},
            HareHeadHelmet: {image: "itemIcons", frame: 65, equip: {modelName: "hareHat", hairChange: "none"}},
            DeerHeadHelmet: {image: "itemIcons", frame: 66, equip: {modelName: "deerHat", hairChange: "none"}},
            BoarHeadHelmet: {image: "itemIcons", frame: 67, equip: {modelName: "boarHat", hairChange: "none"}},
            WolfHeadHelmet: {image: "itemIcons", frame: 68, equip: {modelName: "wolfHat", hairChange: "none"}},
            LeatherJacket: {image: "itemIcons", frame: 170, equip: {modelName: "leatherBody"}},
            LeatherPants: {image: "itemIcons", frame: 171, equip: {modelName: "leatherLegs"}},
            LeatherBoots: {image: "itemIcons", frame: 172, equip: {modelName: "leatherFoots"}},
            LeatherHelmet: {image: "itemIcons", frame: 173, equip: {modelName: "leatherHead", hairChange: "none"}},
            LeatherGloves: {image: "itemIcons", frame: 174, equip: {modelName: "leatherHands"}},
            IronCuirass: {image: "itemIcons", frame: 70, equip: {modelName: "ironBody"}},
            IronLeggings: {image: "itemIcons", frame: 71, equip: {modelName: "ironLegs"}},
            IronGreaves: {image: "itemIcons", frame: 72, equip: {modelName: "ironFoots"}},
            IronHelmet: {image: "itemIcons", frame: 73, equip: {modelName: "ironHead", hairChange: "none"}},
            IronGloves: {image: "itemIcons", frame: 74, equip: {modelName: "ironHands"}}
        };
        var b = this;
        Object.keys(b._atlas).forEach(function (c) {
            var d = b._atlas[c], e = a.cache.getImage(d.image), f = a.cache.getFrameByIndex(d.image, d.frame), g = document.createElement("canvas");
            g.width = f.width, g.height = f.height;
            var h = g.getContext("2d");
            h.drawImage(e, f.x, f.y, f.width, f.height, 0, 0, f.width, f.height), d.src = g.toDataURL()
        })
    }, KME.ItemSpriteAtlas.prototype.getImageSource = function (a) {
        return this._atlas[a] ? this._atlas[a].src : (console.warn("No icon for typeName:", a), this._atlas.UnknownItem.src)
    }, KME.ItemSpriteAtlas.prototype.getVisualEquip = function (a) {
        return this._atlas[a] ? this._atlas[a].equip : null
    }, KME.ItemSpriteAtlas.prototype.getVisualType = function (a) {
        return this._atlas[a] ? this._atlas[a].visualType : null
    }
}),define("KME/utils/WorldSpriteAtlas", ["async"], function (a) {
    KME.WorldSpriteAtlas = function (b) {
        this.game = b, this.tileIndexes = {
            tallObjects: {from: 1131, to: 1161, anchorX: .4, anchorY: .85},
            mountains: {from: 1023, to: 1031, anchorX: .5, anchorY: .8},
            bushesGrass: {from: 21, to: 31, anchorX: .5, anchorY: .7},
            bushesSoil: {from: 31, to: 41, anchorX: .5, anchorY: .7}
        }, this.satStartLevel = -.2, this.lStartLevel = -.1, this.darkLevel = -.05, this.effects = {
            hitBlood: {
                image: "hitBlood",
                anchorX: .5,
                anchorY: .5,
                frameRate: 12
            },
            balExpl: {image: "balExpl", anchorX: .5, anchorY: .6, frameRate: 12, shake: !0, sound: "ballistaHit"},
            snowballHit: {image: "snowballHit", anchorX: .5, anchorY: 1.2, frameRate: 30},
            collapse: {image: "collapse", anchorX: .5, anchorY: .7, frameRate: 12},
            hitStructure: {image: "hitStructure", anchorX: .5, anchorY: .5, frameRate: 15}
        }, this._atlas = {
            UnknownObject: {image: "droppedItems", frame: 49, anchorX: .5, anchorY: .6},
            ArrowProjectile: {
                image: "projectileArrow",
                frame: 0,
                anchorX: .5,
                anchorY: 1,
                rotate: !0,
                shadow: {offsetX: 0, offsetY: 60}
            },
            StoneProjectile: {
                image: "projectileStone",
                frame: 0,
                anchorX: .5,
                anchorY: 7,
                rotate: !1,
                shadow: {offsetX: 0, offsetY: 64}
            },
            SnowballProjectile: {
                image: "projectileSnowball",
                frame: 0,
                anchorX: .5,
                anchorY: 6,
                rotate: !1,
                shadow: {offsetX: 0, offsetY: 64}
            },
            SpearProjectile: {
                image: "projectileSpear",
                frame: 0,
                anchorX: .5,
                anchorY: .9,
                rotate: !0,
                shadow: {offsetX: 0, offsetY: 74}
            },
            BronzeSpearProjectile: {
                image: "projectileBronzeSpear",
                frame: 0,
                anchorX: .5,
                anchorY: .9,
                rotate: !0,
                shadow: {offsetX: 0, offsetY: 74}
            },
            BigStoneProjectile: {image: "projectileBigStone", frame: 0, anchorX: .3, anchorY: .8, rotate: !1},
            Player: {
                mask: {width: 40, height: 100, anchorX: .5, anchorY: .95},
                render: {renderType: "male", aniAnchorX: .5, aniAnchorY: .75}
            },
            Admin: {
                mask: {width: 40, height: 100, anchorX: .5, anchorY: .95},
                render: {aniAnchorX: .5, aniAnchorY: .75}
            },
            Raven: {
                mask: {width: 50, height: 50, anchorX: .5, anchorY: .8},
                render: {renderType: "raven", aniAnchorX: .5, aniAnchorY: .75}
            },
            Hen: {
                mask: {width: 50, height: 50, anchorX: .5, anchorY: .8},
                render: {renderType: "hen", aniAnchorX: .5, aniAnchorY: .75}
            },
            Fox: {
                mask: {width: 70, height: 70, anchorX: .5, anchorY: .8},
                render: {renderType: "fox", aniAnchorX: .5, aniAnchorY: .75}
            },
            Ferret: {
                mask: {width: 50, height: 50, anchorX: .5, anchorY: .8},
                render: {renderType: "ferret", aniAnchorX: .5, aniAnchorY: .75}
            },
            Hare: {
                mask: {width: 50, height: 50, anchorX: .5, anchorY: .8},
                render: {renderType: "hare", aniAnchorX: .5, aniAnchorY: .75}
            },
            Deer: {
                mask: {width: 110, height: 110, anchorX: .5, anchorY: .8},
                render: {renderType: "deer", aniAnchorX: .5, aniAnchorY: .75}
            },
            Wolf: {
                mask: {width: 90, height: 80, anchorX: .5, anchorY: .8},
                render: {renderType: "wolf", aniAnchorX: .5, aniAnchorY: .75}
            },
            Bear: {
                mask: {width: 110, height: 110, anchorX: .5, anchorY: .8},
                render: {renderType: "bear", aniAnchorX: .5, aniAnchorY: .75}
            },
            WildBoar: {
                mask: {width: 90, height: 90, anchorX: .5, anchorY: .8},
                render: {renderType: "boar", aniAnchorX: .5, aniAnchorY: .75}
            },
            Horse: {
                mask: {width: 110, height: 110, anchorX: .5, anchorY: .8},
                render: {renderType: "horse", aniAnchorX: .5, aniAnchorY: .75}
            },
            BearCorpse: {
                image: "bearCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            brownBearCorpse: {
                image: "bearCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            WolfCorpse: {
                image: "wolfCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            WildBoarCorpse: {
                image: "boarCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            DeerCorpse: {
                image: "deerCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            FoxCorpse: {
                image: "foxCorpse",
                anchorX: .5,
                anchorY: .5,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            FerretCorpse: {
                image: "ferretCorpse",
                anchorX: .5,
                anchorY: .5,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            HareCorpse: {
                image: "hareCorpse",
                anchorX: .5,
                anchorY: .5,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            HenCorpse: {
                image: "henCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            RavenCorpse: {
                image: "ravenCorpse",
                anchorX: .5,
                anchorY: .5,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            HorseCorpse: {
                image: "bayHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            bayHorseCorpse: {
                image: "bayHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            blackHorseCorpse: {
                image: "blackHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            dunHorseCorpse: {
                image: "dunHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            greyHorseCorpse: {
                image: "greyHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            kaurHorseCorpse: {
                image: "kaurHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            pintobayHorseCorpse: {
                image: "pintobayHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            spottedHorseCorpse: {
                image: "spottedHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            whiteHorseCorpse: {
                image: "whiteHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            zebraHorseCorpse: {
                image: "zebraHorseCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            maleCorpse: {
                image: "maleCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            femaleCorpse: {
                image: "femaleCorpse",
                anchorX: .5,
                anchorY: .6,
                layouts: {
                    right: {frame: 0},
                    rightdown: {frame: 1},
                    down: {frame: 2},
                    downleft: {frame: 3},
                    left: {frame: 4},
                    leftup: {frame: 5},
                    up: {frame: 6},
                    upright: {frame: 7}
                }
            },
            PotterWheel: {iconFrame: 131, image: "potterWheel", frame: 0, anchorX: .45, anchorY: .75},
            Snowdrift: {image: "snowdrift", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .65},
            Madder: {
                mask: {width: 30, height: 50, anchorX: .5, anchorY: .8},
                image: "madder",
                frame: 0,
                rndFrames: 3,
                anchorX: .5,
                anchorY: .85
            },
            ChristmasTree: {
                iconFrame: 126,
                layouts: {
                    big: {image: "christmasTreeBig", frame: 0, anchorX: .5, anchorY: .9},
                    small: {image: "christmasTreeSmall", frame: 0, anchorX: .5, anchorY: .87}
                }
            },
            WreathMistletoe: {
                iconFrame: 127,
                image: "wreathMistletoe",
                anchorY: 1.1,
                layouts: {
                    leftOne: {frame: 0, anchorX: .85},
                    rightOne: {frame: 1, anchorX: .15},
                    leftTwo: {frame: 2, anchorX: .85},
                    rightTwo: {frame: 3, anchorX: .15},
                    leftThree: {frame: 4, anchorX: .85},
                    rightThree: {frame: 5, anchorX: .15}
                }
            },
            Snowman: {
                iconFrame: 128,
                image: "snowman",
                anchorY: .8,
                anchorX: .45,
                layouts: {
                    leftOne: {frame: 0},
                    rightOne: {frame: 1},
                    leftTwo: {frame: 2},
                    rightTwo: {frame: 3},
                    leftThree: {frame: 4},
                    rightThree: {frame: 5}
                }
            },
            ChristmasSocks: {
                iconFrame: 129,
                image: "christmasSocks",
                anchorY: 1.1,
                layouts: {
                    leftOne: {frame: 0, anchorX: 1.2},
                    rightOne: {frame: 3, anchorX: -.6},
                    leftTwo: {frame: 1, anchorX: 1.2},
                    rightTwo: {frame: 2, anchorX: -.6}
                }
            },
            ChristmasGift: {
                iconFrame: 130,
                image: "christmasGift",
                anchorX: .45,
                anchorY: .75,
                layouts: {one: {frame: 0}, two: {frame: 1}, three: {frame: 2}}
            },
            Poles: {image: "droppedItems200", frame: 114, anchorX: .5, anchorY: .6, sortPatch: -25},
            Lime: {image: "droppedItems200", frame: 157, anchorX: .5, anchorY: .6},
            CopperNails: {image: "droppedItems200", frame: 141, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperKnife: {image: "droppedItems200", frame: 118, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperArrowheads: {image: "droppedItems200", frame: 142, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperArrows: {image: "droppedItems200", frame: 150, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperAxe: {image: "droppedItems200", frame: 117, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperSickle: {image: "droppedItems200", frame: 119, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperBucket: {image: "droppedItems200", frame: 116, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperSaw: {image: "droppedItems200", frame: 85, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperSword: {image: "droppedItems200", frame: 83, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperScissors: {image: "droppedItems200", frame: 86, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperScalyArmor: {image: "droppedItems200", frame: 84, anchorX: .5, anchorY: .6, sortPatch: -25},
            ClayMold: {image: "droppedItems200", frame: 156, anchorX: .5, anchorY: .6},
            BronzeHammer: {image: "droppedItems200", frame: 97, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeNails: {image: "droppedItems200", frame: 140, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeArrowheads: {image: "droppedItems200", frame: 143, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeArrows: {image: "droppedItems200", frame: 151, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeStaples: {image: "droppedItems200", frame: 109, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeKnife: {image: "droppedItems200", frame: 108, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeSpear: {image: "droppedItems200", frame: 107, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeRoundShield: {image: "droppedItems200", frame: 100, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeAxe: {image: "droppedItems200", frame: 99, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeHelmet: {image: "droppedItems200", frame: 103, anchorX: .5, anchorY: .6},
            BronzeBracers: {image: "droppedItems200", frame: 104, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzePickaxe: {image: "droppedItems200", frame: 98, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeLeggins: {image: "droppedItems200", frame: 115, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeGreaves: {image: "droppedItems200", frame: 105, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeLargeShield: {image: "droppedItems200", frame: 101, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeSword: {image: "droppedItems200", frame: 106, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeBreastplate: {image: "droppedItems200", frame: 102, anchorX: .5, anchorY: .6},
            IronArrowheads: {image: "droppedItems200", frame: 145, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronCorners: {image: "droppedItems200", frame: 148, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronPlates: {image: "droppedItems200", frame: 155, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronStrips: {image: "droppedItems200", frame: 153, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelRivets: {image: "droppedItems200", frame: 147, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelCorners: {image: "droppedItems200", frame: 149, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelPlates: {image: "droppedItems200", frame: 154, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelStrips: {image: "droppedItems200", frame: 152, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelArrowheads: {image: "droppedItems200", frame: 146, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperOre: {image: "droppedItems200", frame: 90, anchorX: .5, anchorY: .6, sortPatch: -25},
            CopperIngot: {image: "droppedItems200", frame: 87, anchorX: .5, anchorY: .6, sortPatch: -25},
            TinOre: {image: "droppedItems200", frame: 91, anchorX: .5, anchorY: .6},
            TinOreWithCharcoal: {image: "droppedItems200", frame: 92, anchorX: .5, anchorY: .6},
            TinIngot: {image: "droppedItems200", frame: 89, anchorX: .5, anchorY: .6, sortPatch: -25},
            BronzeIngot: {image: "droppedItems200", frame: 88, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronBloom: {image: "droppedItems200", frame: 94, anchorX: .5, anchorY: .6},
            Coal: {image: "droppedItems200", frame: 96, anchorX: .5, anchorY: .6},
            IronWithCharcoal: {image: "droppedItems200", frame: 95, anchorX: .5, anchorY: .6},
            CrudePlanks: {image: "droppedItems200", frame: 110, anchorX: .5, anchorY: .6, sortPatch: -25},
            Staves: {image: "droppedItems200", frame: 111, anchorX: .5, anchorY: .6, sortPatch: -25},
            Balk: {image: "droppedItems200", frame: 112, anchorX: .5, anchorY: .6},
            Branches: {image: "droppedItems200", frame: 113, anchorX: .5, anchorY: .6, sortPatch: -25},
            PlagueMask: {image: "droppedItems200", frame: 79, anchorX: .5, anchorY: .6},
            DarkBurgonet: {image: "droppedItems200", frame: 71, anchorX: .5, anchorY: .6},
            LightGreatHelm: {image: "droppedItems200", frame: 82, anchorX: .5, anchorY: .6},
            DarkGreatHelm: {image: "droppedItems200", frame: 81, anchorX: .5, anchorY: .6},
            LightBarbute: {image: "droppedItems200", frame: 76, anchorX: .5, anchorY: .6},
            DarkBarbute: {image: "droppedItems200", frame: 75, anchorX: .5, anchorY: .6},
            SpanishHorseHelmet: {image: "droppedItems200", frame: 73, anchorX: .5, anchorY: .6},
            GrandSpanishHorseHelmet: {image: "droppedItems200", frame: 74, anchorX: .5, anchorY: .6},
            HornedHelmet: {image: "droppedItems200", frame: 80, anchorX: .5, anchorY: .6},
            ForestDefenderHelmet: {image: "droppedItems200", frame: 78, anchorX: .5, anchorY: .6},
            VikingHelmet: {image: "droppedItems200", frame: 77, anchorX: .5, anchorY: .6},
            SteelAngelBarbute: {image: "droppedItems200", frame: 72, anchorX: .5, anchorY: .6},
            BearSnare: {image: "droppedItems200", frame: 40, anchorX: .5, anchorY: .6, sortPatch: -25},
            WolfSnare: {image: "droppedItems200", frame: 38, anchorX: .5, anchorY: .6, sortPatch: -25},
            BoarSnare: {image: "droppedItems200", frame: 35, anchorX: .5, anchorY: .6, sortPatch: -25},
            DeerSnare: {image: "droppedItems200", frame: 37, anchorX: .5, anchorY: .6, sortPatch: -25},
            HorseSnare: {image: "droppedItems200", frame: 36, anchorX: .5, anchorY: .6, sortPatch: -25},
            WoolenCloak: {image: "droppedItems200", frame: 56, anchorX: .5, anchorY: .6, sortPatch: -25},
            WhiteWoolenCloak: {image: "droppedItems200", frame: 53, anchorX: .5, anchorY: .6, sortPatch: -25},
            GreyWoolenCloak: {image: "droppedItems200", frame: 50, anchorX: .5, anchorY: .6, sortPatch: -25},
            RedWoolenCloak: {image: "droppedItems200", frame: 52, anchorX: .5, anchorY: .6, sortPatch: -25},
            YellowWoolenCloak: {image: "droppedItems200", frame: 55, anchorX: .5, anchorY: .6, sortPatch: -25},
            GreenWoolenCloak: {image: "droppedItems200", frame: 54, anchorX: .5, anchorY: .6, sortPatch: -25},
            BlueWoolenCloak: {image: "droppedItems200", frame: 57, anchorX: .5, anchorY: .6, sortPatch: -25},
            VioletWoolenCloak: {image: "droppedItems200", frame: 58, anchorX: .5, anchorY: .6, sortPatch: -25},
            BrownWoolenCloak: {image: "droppedItems200", frame: 51, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasDecorations: {image: "droppedItems200", frame: 17, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasSnowflake: {image: "droppedItems200", frame: 19, anchorX: .5, anchorY: .6, sortPatch: -25},
            firBranches: {image: "droppedItems", frame: 177, anchorX: .5, anchorY: .6, sortPatch: -25},
            firCone: {image: "droppedItems", frame: 175, anchorX: .5, anchorY: .6, sortPatch: -25},
            MistletoeBranches: {image: "droppedItems", frame: 179, anchorX: .5, anchorY: .6, sortPatch: -25},
            MadderRoot: {image: "droppedItems", frame: 176, anchorX: .5, anchorY: .6, sortPatch: -25},
            MadderDye: {image: "droppedItems", frame: 169, anchorX: .5, anchorY: .6},
            Wool: {image: "droppedItems200", frame: 2, anchorX: .5, anchorY: .6, sortPatch: -25},
            WoolenThreads: {image: "droppedItems200", frame: 3, anchorX: .5, anchorY: .6},
            WoolenCloth: {image: "droppedItems200", frame: 4, anchorX: .5, anchorY: .6, sortPatch: -25},
            RedWoolenCloth: {image: "droppedItems200", frame: 5, anchorX: .5, anchorY: .6, sortPatch: -25},
            RedLinen: {image: "droppedItems200", frame: 6, anchorX: .5, anchorY: .6, sortPatch: -25},
            RedTapes: {image: "droppedItems200", frame: 7, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasCandy: {image: "droppedItems200", frame: 10, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasBiscuit: {image: "droppedItems200", frame: 12, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronScissors: {image: "droppedItems200", frame: 1, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelScissors: {image: "droppedItems200", frame: 0, anchorX: .5, anchorY: .6, sortPatch: -25},
            NeedleBone: {image: "droppedItems", frame: 46, anchorX: .5, anchorY: .6, sortPatch: -25},
            NeedleIron: {image: "droppedItems", frame: 47, anchorX: .5, anchorY: .6, sortPatch: -25},
            NeedleSteel: {image: "droppedItems", frame: 48, anchorX: .5, anchorY: .6, sortPatch: -25},
            Snow: {image: "droppedItems200", frame: 29, anchorX: .5, anchorY: .6},
            SmallSnowball: {image: "droppedItems200", frame: 27, anchorX: .5, anchorY: .6},
            LargeSnowball: {image: "droppedItems200", frame: 28, anchorX: .5, anchorY: .6},
            ChristmasBell: {image: "droppedItems200", frame: 26, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasBag: {image: "droppedItems200", frame: 24, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasStaff: {image: "droppedItems200", frame: 25, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasCloak: {image: "droppedItems200", frame: 20, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasHat: {image: "droppedItems200", frame: 21, anchorX: .5, anchorY: .6},
            ChristmasBoots: {image: "droppedItems200", frame: 23, anchorX: .5, anchorY: .6, sortPatch: -25},
            ChristmasMittens: {image: "droppedItems200", frame: 22, anchorX: .5, anchorY: .6, sortPatch: -25},
            LinenCloak: {image: "droppedItems", frame: 98, anchorX: .5, anchorY: .6, sortPatch: -25},
            StrawHat: {image: "droppedItems", frame: 119, anchorX: .5, anchorY: .6},
            WoodenShield: {image: "droppedItems", frame: 139, anchorX: .5, anchorY: .6, sortPatch: -25},
            WitchHat: {image: "droppedItems", frame: 107, anchorX: .5, anchorY: .6},
            WitchCloak: {image: "droppedItems", frame: 109, anchorX: .5, anchorY: .6, sortPatch: -25},
            PumpkinHelmet: {image: "droppedItems", frame: 108, anchorX: .5, anchorY: .6},
            HalloweenJacket: {image: "droppedItems", frame: 103, anchorX: .5, anchorY: .6, sortPatch: -25},
            HalloweenPants: {image: "droppedItems", frame: 104, anchorX: .5, anchorY: .6, sortPatch: -25},
            HalloweenBoots: {image: "droppedItems", frame: 105, anchorX: .5, anchorY: .6, sortPatch: -25},
            HalloweenGloves: {image: "droppedItems", frame: 106, anchorX: .5, anchorY: .6, sortPatch: -25},
            HalloweenSpider: {image: "droppedItems", frame: 168, anchorX: .5, anchorY: .6, sortPatch: -25},
            JackLamp: {image: "droppedItems", frame: 167, anchorX: .5, anchorY: .6},
            VictoryFlag: {
                image: "victoryFlag",
                frame: 0,
                anchorX: .4,
                anchorY: .9,
                animation: {name: "flag", frameRate: 10}
            },
            PumpkinSeeds: {image: "droppedItems", frame: 184, anchorX: .5, anchorY: .6, sortPatch: -25},
            GrapesSeeds: {image: "droppedItems", frame: 184, anchorX: .5, anchorY: .6, sortPatch: -25},
            Pumpkin: {image: "droppedItems", frame: 189, anchorX: .5, anchorY: .6},
            PumpkinPieces: {image: "droppedItems", frame: 194, anchorX: .5, anchorY: .6, sortPatch: -25},
            Grapes: {image: "droppedItems", frame: 196, anchorX: .5, anchorY: .6, sortPatch: -25},
            Raisins: {image: "droppedItems", frame: 197, anchorX: .5, anchorY: .6, sortPatch: -25},
            Bones: {image: "droppedItems", frame: 198, anchorX: .5, anchorY: .6, sortPatch: -25},
            BoneMeal: {image: "droppedItems", frame: 199, anchorX: .5, anchorY: .6, sortPatch: -25},
            Glue: {image: "droppedItems", frame: 86, anchorX: .5, anchorY: .6},
            GluedLeather: {image: "droppedItems", frame: 87, anchorX: .5, anchorY: .6},
            HardenedLeather: {image: "droppedItems", frame: 138, anchorX: .5, anchorY: .6, sortPatch: -25},
            FlaxCloth: {image: "droppedItems", frame: 128, anchorX: .5, anchorY: .6, sortPatch: -25},
            FlaxThreads: {image: "droppedItems", frame: 127, anchorX: .5, anchorY: .6},
            Ropes: {image: "droppedItems", frame: 126, anchorX: .5, anchorY: .6},
            Handles: {image: "droppedItems", frame: 137, anchorX: .5, anchorY: .6, sortPatch: -25},
            Skulls: {image: "droppedItems", frame: 190, anchorX: .5, anchorY: .6},
            Veins: {image: "droppedItems", frame: 192, anchorX: .5, anchorY: .6, sortPatch: -25},
            StrangeSkull: {image: "strangeSkull", frame: 0, anchorX: .5, anchorY: .8},
            cepRawMushrooms: {image: "droppedItems", frame: 180, anchorX: .5, anchorY: .6, sortPatch: -25},
            BakedCeps: {image: "droppedItems", frame: 181, anchorX: .5, anchorY: .6, sortPatch: -25},
            chanterelleRawMushrooms: {image: "droppedItems", frame: 182, anchorX: .5, anchorY: .6, sortPatch: -25},
            BakedChanterelles: {image: "droppedItems", frame: 183, anchorX: .5, anchorY: .6, sortPatch: -25},
            RawVegetableStew: {image: "droppedItems", frame: 165, anchorX: .5, anchorY: .6, sortPatch: -25},
            VegetableStew: {image: "droppedItems", frame: 166, anchorX: .5, anchorY: .6, sortPatch: -25},
            Planks: {image: "droppedItems", frame: 155, anchorX: .5, anchorY: .6, sortPatch: -25},
            UnfiredBricks: {image: "droppedItems", frame: 156, anchorX: .5, anchorY: .6, sortPatch: -25},
            Bricks: {image: "droppedItems", frame: 157, anchorX: .5, anchorY: .6, sortPatch: -25},
            Cement: {image: "droppedItems", frame: 136, anchorX: .5, anchorY: .6, sortPatch: -25},
            Nails: {image: "droppedItems", frame: 129, anchorX: .5, anchorY: .6, sortPatch: -25},
            Seeds: {image: "droppedItems", frame: 184, anchorX: .5, anchorY: .6, sortPatch: -25},
            FlaxSeeds: {image: "droppedItems", frame: 184, anchorX: .5, anchorY: .6, sortPatch: -25},
            RawFlax: {image: "droppedItems", frame: 186, anchorX: .5, anchorY: .6, sortPatch: -25},
            DriedFlax: {image: "droppedItems", frame: 187, anchorX: .5, anchorY: .6, sortPatch: -25},
            FlaxFibres: {image: "droppedItems", frame: 188, anchorX: .5, anchorY: .6, sortPatch: -25},
            Hay: {image: "droppedItems", frame: 158, anchorX: .5, anchorY: .6, sortPatch: -25},
            Clay: {image: "droppedItems", frame: 153, anchorX: .5, anchorY: .6},
            Bark: {image: "droppedItems", frame: 154, anchorX: .5, anchorY: .6, sortPatch: -25},
            Leather: {image: "droppedItems", frame: 124, anchorX: .5, anchorY: .6, sortPatch: -25},
            BigLeather: {image: "droppedItems", frame: 125, anchorX: .5, anchorY: .6, sortPatch: -25},
            UnfiredClayPot: {image: "droppedItems", frame: 160, anchorX: .5, anchorY: .6},
            ClayPot: {image: "droppedItems", frame: 161, anchorX: .5, anchorY: .6},
            TanningLiquor: {image: "droppedItems", frame: 163, anchorX: .5, anchorY: .6},
            RawMeatCarrotPottage: {image: "droppedItems", frame: 164, anchorX: .5, anchorY: .6},
            MeatCarrotPottage: {image: "droppedItems", frame: 162, anchorX: .5, anchorY: .6},
            SteelKnife: {image: "droppedItems", frame: 141, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelAxe: {image: "droppedItems", frame: 142, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelHammer: {image: "droppedItems", frame: 143, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelTippedArrow: {image: "droppedItems", frame: 144, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelSaw: {image: "droppedItems", frame: 146, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelSickle: {image: "droppedItems", frame: 147, anchorX: .5, anchorY: .6, sortPatch: -25},
            CastIronAmmo: {image: "droppedItems", frame: 148, anchorX: .5, anchorY: .6},
            SteelShield: {image: "droppedItems", frame: 149, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelIngot: {image: "droppedItems", frame: 150, anchorX: .5, anchorY: .6},
            CastIronIngot: {image: "droppedItems", frame: 151, anchorX: .5, anchorY: .6},
            CharCoal: {image: "droppedItems", frame: 152, anchorX: .5, anchorY: .6},
            StoneAmmo: {image: "droppedItems", frame: 140, anchorX: .5, anchorY: .6},
            SteelCuirass: {image: "droppedItems", frame: 130, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelLeggings: {image: "droppedItems", frame: 131, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelGreaves: {image: "droppedItems", frame: 132, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelHelmet: {image: "droppedItems", frame: 133, anchorX: .5, anchorY: .6},
            SteelGloves: {image: "droppedItems", frame: 134, anchorX: .5, anchorY: .6, sortPatch: -25},
            BearHideCloak: {image: "droppedItems", frame: 135, anchorX: .5, anchorY: .6, sortPatch: -25},
            BearHead: {image: "droppedItems", frame: 59, anchorX: .5, anchorY: .6, sortPatch: -25},
            BearHeadHelmet: {image: "droppedItems", frame: 69, anchorX: .5, anchorY: .7},
            BearHide: {image: "droppedItems", frame: 120, anchorX: .5, anchorY: .6, sortPatch: -25},
            BearRawHide: {image: "droppedItems", frame: 121, anchorX: .5, anchorY: .6, sortPatch: -25},
            BigHide: {image: "droppedItems", frame: 122, anchorX: .5, anchorY: .6, sortPatch: -25},
            BigRawHide: {image: "droppedItems", frame: 123, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumCuirass: {image: "droppedItems", frame: 110, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumLeggings: {image: "droppedItems", frame: 111, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumGreaves: {image: "droppedItems", frame: 112, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumGloves: {image: "droppedItems", frame: 114, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumSword: {image: "droppedItems", frame: 116, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumShield: {image: "droppedItems", frame: 115, anchorX: .5, anchorY: .6, sortPatch: -25},
            PremiumCloak: {image: "droppedItems", frame: 117, anchorX: .5, anchorY: .6, sortPatch: -25},
            AppleTreeSeedling: {image: "droppedItems", frame: 94, anchorX: .5, anchorY: .6},
            SteelSword: {image: "droppedItems", frame: 101, anchorX: .5, anchorY: .6, sortPatch: -25},
            SteelPickaxe: {image: "droppedItems", frame: 100, anchorX: .5, anchorY: .6, sortPatch: -25},
            CompositeBow: {image: "droppedItems", frame: 102, anchorX: .5, anchorY: .6, sortPatch: -25},
            Apple: {image: "droppedItems", frame: 95, anchorX: .5, anchorY: .6},
            AdminBow: {image: "droppedItems", frame: 45, anchorX: .5, anchorY: .6, sortPatch: -25},
            HuntingSling: {image: "droppedItems", frame: 91, anchorX: .5, anchorY: .6, sortPatch: -25},
            ShortBow: {image: "droppedItems", frame: 90, anchorX: .5, anchorY: .6, sortPatch: -25},
            ForgedBucket: {image: "droppedItems", frame: 82, anchorX: .5, anchorY: .6, sortPatch: -25},
            WoodenSnare: {image: "droppedItems", frame: 84, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronTippedArrow: {image: "droppedItems", frame: 92, anchorX: .5, anchorY: .6, sortPatch: -25},
            Feathers: {image: "droppedItems", frame: 18, anchorX: .5, anchorY: .6},
            HenInCage: {image: "droppedItems", frame: 85, anchorX: .5, anchorY: .6},
            Eggs: {image: "droppedItems", frame: 9, anchorX: .5, anchorY: .6},
            ShirredEggs: {image: "droppedItems", frame: 19, anchorX: .5, anchorY: .6},
            ashTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            alderTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            pineTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            willowTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            mapleTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            aspenTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            firTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            birchTreeSeedling: {image: "droppedItems", frame: 93, anchorX: .5, anchorY: .6},
            StoneKnife: {image: "droppedItems", frame: 20, anchorX: .5, anchorY: .6, sortPatch: -25},
            StoneAxe: {image: "droppedItems", frame: 21, anchorX: .5, anchorY: .6, sortPatch: -25},
            StoneHammer: {image: "droppedItems", frame: 22, anchorX: .5, anchorY: .5},
            WoodenShovel: {image: "droppedItems", frame: 23, anchorX: .5, anchorY: .6, sortPatch: -25},
            Torch: {image: "droppedItems", frame: 24, anchorX: .5, anchorY: .6, sortPatch: -25},
            HideSling: {image: "droppedItems", frame: 25, anchorX: .5, anchorY: .6, sortPatch: -25},
            Bow: {image: "droppedItems", frame: 26, anchorX: .5, anchorY: .6, sortPatch: -25},
            StoneTippedArrow: {image: "droppedItems", frame: 27, anchorX: .5, anchorY: .6, sortPatch: -25},
            WoodenSpear: {image: "droppedItems", frame: 28, anchorX: .5, anchorY: .6, sortPatch: -25},
            StonePick: {image: "droppedItems", frame: 29, anchorX: .5, anchorY: .5},
            IronKnife: {image: "droppedItems", frame: 30, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronAxe: {image: "droppedItems", frame: 31, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronHammer: {image: "droppedItems", frame: 32, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronShovel: {image: "droppedItems", frame: 33, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronPickaxe: {image: "droppedItems", frame: 34, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronSaw: {image: "droppedItems", frame: 35, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronSword: {image: "droppedItems", frame: 36, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronShield: {image: "droppedItems", frame: 37, anchorX: .5, anchorY: .6, sortPatch: -25},
            IronSickle: {image: "droppedItems", frame: 38, anchorX: .5, anchorY: .6, sortPatch: -25},
            HuntingBow: {image: "droppedItems", frame: 39, anchorX: .5, anchorY: .6, sortPatch: -25},
            ClothVest: {image: "droppedItems", frame: 40, anchorX: .5, anchorY: .5, sortPatch: -25},
            ClothTrousers: {image: "droppedItems", frame: 41, anchorX: .5, anchorY: .5, sortPatch: -25},
            ClothSandals: {image: "droppedItems", frame: 42, anchorX: .5, anchorY: .5, sortPatch: -25},
            ClothCap: {image: "droppedItems", frame: 43, anchorX: .5, anchorY: .5},
            AdminVest: {image: "droppedItems", frame: 40, anchorX: .5, anchorY: .5, sortPatch: -25},
            AdminTrousers: {image: "droppedItems", frame: 41, anchorX: .5, anchorY: .5, sortPatch: -25},
            AdminSandals: {image: "droppedItems", frame: 42, anchorX: .5, anchorY: .5, sortPatch: -25},
            AdminTiara: {image: "droppedItems", frame: 43, anchorX: .5, anchorY: .5},
            LightSaber: {image: "droppedItems", frame: 44, anchorX: .5, anchorY: .5, sortPatch: -25},
            RawHideVest: {image: "droppedItems", frame: 50, anchorX: .5, anchorY: .5, sortPatch: -25},
            RawHideLoincloth: {image: "droppedItems", frame: 51, anchorX: .5, anchorY: .5, sortPatch: -25},
            RawHideBoots: {image: "droppedItems", frame: 52, anchorX: .5, anchorY: .5, sortPatch: -25},
            RawHideCap: {image: "droppedItems", frame: 53, anchorX: .5, anchorY: .5},
            RawHideGloves: {image: "droppedItems", frame: 54, anchorX: .5, anchorY: .5, sortPatch: -25},
            HideJacket: {image: "droppedItems", frame: 60, anchorX: .5, anchorY: .5, sortPatch: -25},
            HidePants: {image: "droppedItems", frame: 61, anchorX: .5, anchorY: .5, sortPatch: -25},
            HideBoots: {image: "droppedItems", frame: 62, anchorX: .5, anchorY: .5, sortPatch: -25},
            HideHelmet: {image: "droppedItems", frame: 63, anchorX: .5, anchorY: .5},
            HideGloves: {image: "droppedItems", frame: 64, anchorX: .5, anchorY: .5, sortPatch: -25},
            HareHeadHelmet: {image: "droppedItems", frame: 65, anchorX: .5, anchorY: .7},
            DeerHeadHelmet: {image: "droppedItems", frame: 66, anchorX: .5, anchorY: .8},
            BoarHeadHelmet: {image: "droppedItems", frame: 67, anchorX: .5, anchorY: .7},
            WolfHeadHelmet: {image: "droppedItems", frame: 68, anchorX: .5, anchorY: .7},
            LeatherJacket: {image: "droppedItems", frame: 170, anchorX: .5, anchorY: .5, sortPatch: -25},
            LeatherPants: {image: "droppedItems", frame: 171, anchorX: .5, anchorY: .5, sortPatch: -25},
            LeatherBoots: {image: "droppedItems", frame: 172, anchorX: .5, anchorY: .5, sortPatch: -25},
            LeatherHelmet: {image: "droppedItems", frame: 173, anchorX: .5, anchorY: .5},
            LeatherGloves: {image: "droppedItems", frame: 174, anchorX: .5, anchorY: .5, sortPatch: -25},
            IronCuirass: {image: "droppedItems", frame: 70, anchorX: .5, anchorY: .5, sortPatch: -25},
            IronLeggings: {image: "droppedItems", frame: 71, anchorX: .5, anchorY: .5, sortPatch: -25},
            IronGreaves: {image: "droppedItems", frame: 72, anchorX: .5, anchorY: .5, sortPatch: -25},
            IronHelmet: {image: "droppedItems", frame: 73, anchorX: .5, anchorY: .5},
            IronGloves: {image: "droppedItems", frame: 74, anchorX: .5, anchorY: .5, sortPatch: -25},
            Stone: {image: "droppedItems", frame: 0, anchorX: .5, anchorY: .6, sortPatch: -5},
            Wood: {image: "droppedItems", frame: 1, anchorX: .5, anchorY: .6, sortPatch: -5},
            RawHide: {image: "droppedItems", frame: 2, anchorX: .5, anchorY: .6, sortPatch: -25},
            Meat: {image: "droppedItems", frame: 3, anchorX: .5, anchorY: .6, sortPatch: -5},
            IronOre: {image: "droppedItems", frame: 4, anchorX: .5, anchorY: .6, sortPatch: -5},
            GrainWheat: {image: "droppedItems", frame: 5, anchorX: .5, anchorY: .6, sortPatch: -25},
            Carrot: {image: "droppedItems", frame: 6, anchorX: .5, anchorY: .6, sortPatch: -25},
            Boulder: {image: "droppedItems", frame: 7, anchorX: .5, anchorY: .6, sortPatch: -5},
            Log: {image: "droppedItems", frame: 8, anchorX: .5, anchorY: .6, sortPatch: -5},
            WoodenBucketWater: {image: "droppedItems", frame: 10, anchorX: .5, anchorY: .6, sortPatch: -5},
            Bannock: {image: "droppedItems", frame: 11, anchorX: .5, anchorY: .6, sortPatch: -25},
            Hide: {image: "droppedItems", frame: 12, anchorX: .5, anchorY: .6, sortPatch: -25},
            RoastMeat: {image: "droppedItems", frame: 13, anchorX: .5, anchorY: .6, sortPatch: -5},
            IronIngot: {image: "droppedItems", frame: 14, anchorX: .5, anchorY: .6, sortPatch: -5},
            Flour: {image: "droppedItems", frame: 15, anchorX: .5, anchorY: .6, sortPatch: -5},
            Dough: {image: "droppedItems", frame: 16, anchorX: .5, anchorY: .6, sortPatch: -5},
            Bandage: {image: "droppedItems", frame: 17, anchorX: .5, anchorY: .6, sortPatch: -25},
            WomanCutHead: {image: "droppedItems", frame: 80, anchorX: .5, anchorY: .6, sortPatch: -5},
            ManCutHead: {image: "droppedItems", frame: 81, anchorX: .5, anchorY: .6, sortPatch: -5},
            HareHead: {image: "droppedItems", frame: 55, anchorX: .5, anchorY: .5, sortPatch: -5},
            DeerHead: {image: "droppedItems", frame: 56, anchorX: .5, anchorY: .5, sortPatch: -5},
            BoarHead: {image: "droppedItems", frame: 57, anchorX: .5, anchorY: .5, sortPatch: -5},
            WolfHead: {
                image: "droppedItems", frame: 58, anchorX: .5,
                anchorY: .5, sortPatch: -5
            },
            BattleDebugChest: {image: "steelChest", frame: 0, rndFrames: 2, anchorX: .5, anchorY: .6},
            DebugChest: {iconFrame: 29, image: "steelChest", frame: 0, rndFrames: 2, anchorX: .45, anchorY: .7},
            BattleChest: {iconFrame: 29, image: "steelChest", frame: 0, rndFrames: 2, anchorX: .45, anchorY: .7},
            FindChest: {
                image: "rareFinds",
                layouts: {
                    skeleton: {frame: 0, anchorX: .5, anchorY: .5, sortPatch: -30},
                    corpse: {frame: 1, anchorX: .5, anchorY: .5, sortPatch: -25},
                    waggon: {frame: 2, anchorX: .5, anchorY: .6}
                }
            },
            Tree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                layouts: {
                    ash: {image: "treeOak", frame: 0, anchorX: .44, anchorY: .89},
                    alder: {image: "treeLinden", frame: 0, anchorX: .43, anchorY: .87},
                    pine: {image: "treePine", frame: 0, anchorX: .445, anchorY: .96},
                    willow: {image: "treeWhiteFir", frame: 0, anchorX: .46, anchorY: .93},
                    maple: {image: "treeMaple", frame: 0, anchorX: .45, anchorY: .87},
                    aspen: {image: "treeAspen", frame: 0, anchorX: .4, anchorY: .96},
                    fir: {image: "treeFir", frame: 0, anchorX: .47, anchorY: .91},
                    birch: {image: "treeBirch", frame: 0, anchorX: .4, anchorY: .96}
                }
            },
            Rock: {image: "resRock", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .85},
            ClayPit: {image: "clayPit", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .55},
            Cliff: {
                mask: {bodyType: 1},
                states: {
                    Normal: {image: "cliffs", frame: 0, rndFrames: 8, anchorX: .5, anchorY: .85},
                    Depleted: {image: "cliffs", frame: 8, rndFrames: 2, anchorX: .5, anchorY: .85}
                }
            },
            staticCliff: {image: "cliffs", frame: 0, rndFrames: 8, anchorX: .5, anchorY: .85},
            staticWaggon: {image: "staticWaggon", frame: 0, anchorX: .5, anchorY: .5},
            StonePile: {image: "smallResources", frame: 3, rndFrames: 3, anchorX: .5, anchorY: .6},
            Nest: {image: "smallResources", frame: 6, rndFrames: 3, anchorX: .4, anchorY: .6},
            WoodPile: {image: "smallResources", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .6},
            CopperDeposit: {image: "copperDeposit", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .78},
            TinDeposit: {image: "tinDeposit", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .78},
            CoalDeposit: {image: "coalDeposit", frame: 0, rndFrames: 3, anchorX: .5, anchorY: .78},
            IronRock: {image: "resRock", frame: 3, rndFrames: 3, anchorX: .5, anchorY: .78},
            Mushrooms: {
                mask: {width: 20, height: 20, anchorX: .5, anchorY: .7},
                image: "mushrooms",
                anchorX: .5,
                anchorY: .7,
                layouts: {cep: {frame: 0, rndFrames: 3}, chanterelle: {frame: 3, rndFrames: 3}}
            },
            WildWeeds: {
                mask: {width: 40, height: 40, anchorX: .5, anchorY: .8},
                image: "wildWeeds",
                frame: 0,
                rndFrames: 5,
                anchorX: .5,
                anchorY: .8
            },
            WildCarrot: {
                mask: {width: 30, height: 40, anchorX: .5, anchorY: .7},
                image: "smallResources",
                frame: 9,
                rndFrames: 3,
                anchorX: .5,
                anchorY: .9
            },
            PavedGround: {iconFrame: 46, image: "terraForm", frame: 0, anchorX: .5, anchorY: .5},
            GrassedGround: {iconFrame: 48, image: "terraForm", frame: 2, anchorX: .5, anchorY: .5},
            SoiledGround: {iconFrame: 50, image: "terraForm", frame: 1, anchorX: .5, anchorY: .5},
            PloughedGround: {
                iconFrame: 44,
                mask: {width: 100, height: 50, anchorX: .5, anchorY: .5},
                image: "seedBed",
                frame: 0,
                rndFrames: 4,
                anchorX: .5,
                anchorY: .5
            },
            PloughedGround3x3: {iconFrame: 45},
            PavedGround3x3: {iconFrame: 47},
            GrassedGround3x3: {iconFrame: 49},
            SoiledGround3x3: {iconFrame: 51},
            CropTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                layouts: {
                    ash: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeOak", frame: 0, anchorX: .44, anchorY: .89}
                        }
                    },
                    alder: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeLinden", frame: 0, anchorX: .43, anchorY: .87}
                        }
                    },
                    pine: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treePine", frame: 0, anchorX: .445, anchorY: .96}
                        }
                    },
                    willow: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeWhiteFir", frame: 0, anchorX: .46, anchorY: .93}
                        }
                    },
                    maple: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeMaple", frame: 0, anchorX: .45, anchorY: .87}
                        }
                    },
                    aspen: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeAspen", frame: 0, anchorX: .4, anchorY: .96}
                        }
                    },
                    fir: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeFir", frame: 0, anchorX: .47, anchorY: .91}
                        }
                    },
                    birch: {
                        states: {
                            Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                            Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                            Ripe: {image: "treeBirch", frame: 0, anchorX: .4, anchorY: .96}
                        }
                    }
                }
            },
            AppleTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Normal: {image: "treeApple", frame: 0, anchorX: .44, anchorY: .87},
                    Depleted: {image: "treeApple", frame: 1, anchorX: .44, anchorY: .87}
                }
            },
            CropAppleTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeApple", frame: 0, anchorX: .44, anchorY: .87},
                    Depleted: {image: "treeApple", frame: 1, anchorX: .44, anchorY: .87}
                }
            },
            BirchTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeBirch",
                frame: 0,
                anchorX: .4,
                anchorY: .96
            },
            CropBirchTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeBirch", frame: 0, anchorX: .4, anchorY: .96}
                }
            },
            AspenTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeAspen",
                frame: 0,
                anchorX: .4,
                anchorY: .96
            },
            CropAspenTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeAspen", frame: 0, anchorX: .4, anchorY: .96}
                }
            },
            MapleTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeMaple",
                frame: 0,
                anchorX: .45,
                anchorY: .87
            },
            CropMapleTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeMaple", frame: 0, anchorX: .45, anchorY: .87}
                }
            },
            LindenTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeLinden",
                frame: 0,
                anchorX: .43,
                anchorY: .87
            },
            CropLindenTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeLinden", frame: 0, anchorX: .43, anchorY: .87}
                }
            },
            WhiteFirTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeWhiteFir",
                frame: 0,
                anchorX: .47,
                anchorY: .93
            },
            CropWhiteFirTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeWhiteFir", frame: 0, anchorX: .47, anchorY: .93}
                }
            },
            PineTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treePine",
                frame: 0,
                anchorX: .445,
                anchorY: .96
            },
            CropPineTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treePine", frame: 0, anchorX: .445, anchorY: .96}
                }
            },
            FirTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeFir",
                frame: 0,
                anchorX: .47,
                anchorY: .91
            },
            CropFirTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeFir", frame: 0, anchorX: .47, anchorY: .91}
                }
            },
            OakTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                image: "treeOak",
                frame: 0,
                anchorX: .44,
                anchorY: .89
            },
            CropOakTree: {
                mask: {width: 20, height: 100, anchorX: .5, anchorY: .92},
                states: {
                    Seeded: {image: "cropTreeOne", frame: 0, anchorX: .4, anchorY: .9},
                    Grow: {image: "cropTreeTwo", frame: 0, anchorX: .35, anchorY: .93},
                    Ripe: {image: "treeOak", frame: 0, anchorX: .44, anchorY: .89}
                }
            },
            CropWeeds: {
                mask: {width: 100, height: 50, anchorX: .5, anchorY: .5},
                states: {
                    Seeded: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "crops",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "crops",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Grow: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "crops",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "crops",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Ripe: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "crops",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "crops",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    }
                }
            },
            CropVine: {
                mask: {width: 50, height: 70, anchorX: .5, anchorY: .5},
                states: {
                    Seeded: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "cropVine",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .4,
                            anchorY: .92,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }]
                    },
                    Grow: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "cropVine",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .4,
                            anchorY: .92,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }]
                    },
                    Ripe: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "cropVine",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .4,
                            anchorY: .92,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }]
                    }
                }
            },
            CropPumpkin: {
                mask: {width: 100, height: 50, anchorX: .5, anchorY: .5},
                states: {
                    Seeded: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "cropPumpkin",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }]
                    },
                    Grow: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "cropPumpkin",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }]
                    },
                    Ripe: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "cropPumpkin",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }]
                    }
                }
            },
            CropFlax: {
                mask: {width: 100, height: 50, anchorX: .5, anchorY: .5},
                states: {
                    Seeded: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "crops",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "crops",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Grow: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "crops",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "crops",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Ripe: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "crops",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "crops",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "crops",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    }
                }
            },
            CropWheat: {
                mask: {width: 100, height: 50, anchorX: .5, anchorY: .5},
                states: {
                    Seeded: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "fields",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "fields",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 4,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Grow: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "fields",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "fields",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 8,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Ripe: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "fields",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "fields",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 12,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    }
                }
            },
            CropCarrot: {
                mask: {width: 100, height: 50, anchorX: .5, anchorY: .5},
                states: {
                    Seeded: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "fields",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .75,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "fields",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .75,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .75,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 16,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .75,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Grow: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "fields",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .75,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "fields",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 20,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    },
                    Ripe: {
                        parts: [{
                            image: "seedBed",
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .5,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: -40
                        }, {
                            image: "fields",
                            frame: 24,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: -.25
                        }, {
                            image: "fields",
                            frame: 24,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: -.25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 24,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: .25,
                            tileAnchorY: 0
                        }, {
                            image: "fields",
                            frame: 24,
                            rndFrames: 4,
                            anchorX: .5,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: .25
                        }]
                    }
                }
            },
            FlaxStack: {
                iconFrame: 109,
                states: {
                    Grow: {image: "flaxStack", frame: 0, anchorX: .5, anchorY: .7},
                    Ripe: {image: "flaxStack", frame: 1, anchorX: .5, anchorY: .7}
                }
            },
            fieldGrassTile: {
                parts: [{
                    image: "fields",
                    frame: 0,
                    rndFrames: 4,
                    anchorX: .5,
                    anchorY: .8,
                    tileAnchorX: 0,
                    tileAnchorY: -.25
                }, {
                    image: "fields",
                    frame: 0,
                    rndFrames: 4,
                    anchorX: .5,
                    anchorY: .8,
                    tileAnchorX: -.25,
                    tileAnchorY: 0
                }, {
                    image: "fields",
                    frame: 0,
                    rndFrames: 4,
                    anchorX: .5,
                    anchorY: .8,
                    tileAnchorX: .25,
                    tileAnchorY: 0
                }, {
                    image: "fields",
                    frame: 0,
                    rndFrames: 4,
                    anchorX: .5,
                    anchorY: .8,
                    tileAnchorX: 0,
                    tileAnchorY: .25
                }]
            },
            WoodenDoor: {
                iconFrame: 71,
                image: "allDoors",
                layouts: {
                    left: {
                        states: {
                            ClosedDoor: {frame: 1, anchorX: 0, anchorY: .73},
                            OpenDoor: {frame: 3, anchorX: .55, anchorY: .73}
                        }
                    },
                    right: {
                        states: {
                            ClosedDoor: {frame: 0, anchorX: .72, anchorY: .73},
                            OpenDoor: {frame: 2, anchorX: .15, anchorY: .73}
                        }
                    }
                }
            },
            RobustDoor: {
                iconFrame: 114,
                image: "allDoors",
                layouts: {
                    left: {
                        states: {
                            ClosedDoor: {frame: 5, anchorX: 0, anchorY: .73},
                            OpenDoor: {frame: 7, anchorX: .55, anchorY: .73}
                        }
                    },
                    right: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .72, anchorY: .73},
                            OpenDoor: {frame: 6, anchorX: .15, anchorY: .73}
                        }
                    }
                }
            },
            WoodenIronedDoor: {
                iconFrame: 72,
                image: "allDoors",
                layouts: {
                    left: {
                        states: {
                            ClosedDoor: {frame: 9, anchorX: 0, anchorY: .73},
                            OpenDoor: {frame: 11, anchorX: .55, anchorY: .73}
                        }
                    },
                    right: {
                        states: {
                            ClosedDoor: {frame: 8, anchorX: .72, anchorY: .73},
                            OpenDoor: {frame: 10, anchorX: .15, anchorY: .73}
                        }
                    }
                }
            },
            IronDoor: {
                iconFrame: 73,
                image: "allDoors",
                layouts: {
                    left: {
                        states: {
                            ClosedDoor: {frame: 13, anchorX: 0, anchorY: .73},
                            OpenDoor: {frame: 15, anchorX: .55, anchorY: .73}
                        }
                    },
                    right: {
                        states: {
                            ClosedDoor: {frame: 12, anchorX: .72, anchorY: .73},
                            OpenDoor: {frame: 14, anchorX: .15, anchorY: .73}
                        }
                    }
                }
            },
            BranchCabinComplex: {iconFrame: 3},
            BranchWall: {
                iconFrame: 6,
                image: "branchWalls",
                layouts: {
                    left: {frame: 1, anchorX: .66, anchorY: .97, sortPatch: -1},
                    right: {frame: 0, anchorX: .05, anchorY: .97}
                }
            },
            BranchDoorway: {
                iconFrame: 7,
                image: "branchWalls",
                layouts: {
                    left: {frame: 3, anchorX: .66, anchorY: .97, sortPatch: -1},
                    right: {frame: 2, anchorX: .05, anchorY: .97}
                }
            },
            BranchWindow: {
                iconFrame: 8,
                image: "branchWalls",
                layouts: {
                    left: {frame: 5, anchorX: .66, anchorY: .97, sortPatch: -1},
                    right: {frame: 4, anchorX: .05, anchorY: .97}
                }
            },
            BranchRoof713: {
                iconFrame: 9,
                image: "branchRoofs",
                anchorX: .5,
                anchorY: 1.9,
                layouts: {left: {frame: 0}, right: {frame: 1}}
            },
            BranchDoor: {
                iconFrame: 4,
                image: "branchDoors",
                layouts: {
                    left: {
                        states: {
                            ClosedDoor: {frame: 1, anchorX: 0, anchorY: .82},
                            OpenDoor: {frame: 3, anchorX: .55, anchorY: .82}
                        }
                    },
                    right: {
                        states: {
                            ClosedDoor: {frame: 0, anchorX: .72, anchorY: .82},
                            OpenDoor: {frame: 2, anchorX: .15, anchorY: .82}
                        }
                    }
                }
            },
            BranchFence: {
                iconFrame: 10,
                image: "branchFenceWalls",
                layouts: {
                    left: {frame: 3, rndFrames: 3, anchorX: .76, anchorY: .97, sortPatch: -1},
                    right: {frame: 0, rndFrames: 3, anchorX: .16, anchorY: .97}
                }
            },
            BranchFenceGate: {
                iconFrame: 11,
                image: "branchFenceGates",
                layouts: {
                    leftUp: {
                        states: {
                            ClosedDoor: {frame: 1, anchorX: .16, anchorY: .74},
                            OpenDoor: {frame: 3, anchorX: .76, anchorY: .74}
                        }
                    },
                    leftDown: {
                        states: {
                            ClosedDoor: {frame: 5, anchorX: .16, anchorY: .74},
                            OpenDoor: {frame: 7, anchorX: .16, anchorY: .52, sortPatch: 64}
                        }
                    },
                    rightUp: {
                        states: {
                            ClosedDoor: {frame: 0, anchorX: .76, anchorY: .74},
                            OpenDoor: {frame: 2, anchorX: .16, anchorY: .74}
                        }
                    },
                    rightDown: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .76, anchorY: .74},
                            OpenDoor: {frame: 6, anchorX: .76, anchorY: .52, sortPatch: 63}
                        }
                    }
                }
            },
            HTFoundation: {iconFrame: 63, image: "htFloors", frame: 0, rndFrames: 4, anchorX: .5, anchorY: .5},
            HTWall: {
                iconFrame: 64,
                image: "htWalls",
                layouts: {
                    left: {frame: 7, rndFrames: 4, anchorX: .65, anchorY: .95, sortPatch: -1},
                    right: {frame: 0, rndFrames: 4, anchorX: .1, anchorY: .95}
                }
            },
            HTDoorway: {
                iconFrame: 65,
                image: "htWalls",
                layouts: {
                    left: {frame: 12, anchorX: .65, anchorY: .95, sortPatch: -1},
                    right: {frame: 5, anchorX: .1, anchorY: .95}
                }
            },
            HTWindow: {
                iconFrame: 66,
                image: "htWalls",
                layouts: {
                    left: {frame: 11, anchorX: .65, anchorY: .95, sortPatch: -1},
                    right: {frame: 4, anchorX: .1, anchorY: .95}
                }
            },
            HTPillar: {iconFrame: 133, image: "htWalls", frame: 13, anchorX: .15, anchorY: .97},
            HTRoof: {
                iconFrame: 0,
                image: "htRoofs",
                layouts: {
                    leftNearLow: {frame: 0, anchorX: .51, anchorY: 1.31},
                    leftDistantLow: {frame: 1, anchorX: .48, anchorY: 1.32},
                    leftNearHigh: {frame: 8, anchorX: .5, anchorY: 1.32},
                    leftDistantHigh: {frame: 9, anchorX: .47, anchorY: 1.33}
                }
            },
            HTRoofFlat: {
                iconFrame: 132,
                image: "htFlatRoofs",
                layouts: {
                    ceiling: {frame: 0, rndFrames: 4, anchorX: .5, anchorY: 2.35},
                    low: {frame: 0, rndFrames: 4, anchorX: .5, anchorY: 3.15},
                    high: {frame: 0, rndFrames: 4, anchorX: .5, anchorY: 3.92}
                }
            },
            HTRoofSlope: {
                iconFrame: 67,
                image: "htRoofs",
                layouts: {
                    leftNearLow: {frame: 0, anchorX: .51, anchorY: 1.31},
                    leftDistantLow: {frame: 1, anchorX: .48, anchorY: 1.32},
                    rightNearLow: {frame: 2, anchorX: .5, anchorY: 1.31},
                    rightDistantLow: {frame: 3, anchorX: .55, anchorY: 1.33}
                }
            },
            HTRoofSlopeHigh: {
                iconFrame: 68,
                image: "htRoofs",
                layouts: {
                    leftNearHigh: {frame: 8, anchorX: .5, anchorY: 1.32},
                    leftDistantHigh: {frame: 9, anchorX: .47, anchorY: 1.33},
                    rightNearHigh: {frame: 10, anchorX: .49, anchorY: 1.32},
                    rightDistantHigh: {frame: 11, anchorX: .54, anchorY: 1.34}
                }
            },
            HTRoofCorner: {
                iconFrame: 69,
                image: "htRoofs",
                layouts: {
                    leftNearLow: {frame: 4, anchorX: .55, anchorY: 1.32},
                    leftDistantLow: {frame: 5, anchorX: .53, anchorY: 1.33},
                    rightNearLow: {frame: 6, anchorX: .55, anchorY: 1.29},
                    rightDistantLow: {frame: 7, anchorX: .5, anchorY: 1.31},
                    vLeftNearLow: {frame: 16, anchorX: .54, anchorY: 1.323},
                    vLeftDistantLow: {frame: 17, anchorX: .525, anchorY: 1.327},
                    vRightNearLow: {frame: 18, anchorX: .54, anchorY: 1.3},
                    vRightDistantLow: {frame: 19, anchorX: .51, anchorY: 1.31}
                }
            },
            HTRoofCornerHigh: {
                iconFrame: 70,
                image: "htRoofs",
                layouts: {
                    leftNearHigh: {frame: 12, anchorX: .5, anchorY: 1.32},
                    leftDistantHigh: {frame: 13, anchorX: .52, anchorY: 1.33},
                    rightNearHigh: {frame: 14, anchorX: .53, anchorY: 1.333},
                    rightDistantHigh: {frame: 15, anchorX: .56, anchorY: 1.32},
                    vLeftNearHigh: {frame: 20, anchorX: .5, anchorY: 1.323},
                    vLeftDistantHigh: {frame: 21, anchorX: .525, anchorY: 1.327},
                    vRightNearHigh: {frame: 22, anchorX: .54, anchorY: 1.33},
                    vRightDistantHigh: {frame: 23, anchorX: .56, anchorY: 1.328}
                }
            },
            LogFoundation: {iconFrame: 52, image: "logFloors", frame: 0, rndFrames: 4, anchorX: .5, anchorY: .5},
            LogCeiling: {image: "logCeiling", frame: 1, anchorX: .5, anchorY: 2.55},
            LogRoofFlat: {
                iconFrame: 62,
                image: "logCeiling",
                layouts: {
                    ceiling: {frame: 0, rndFrames: 4, anchorX: .5, anchorY: 2.4},
                    low: {frame: 0, rndFrames: 4, anchorX: .5, anchorY: 3.4},
                    high: {frame: 0, rndFrames: 4, anchorX: .5, anchorY: 4.2}
                }
            },
            LogRoofSlope: {
                iconFrame: 58,
                image: "logRoofs",
                layouts: {
                    leftNearLow: {frame: 0, anchorX: .48, anchorY: 1.32},
                    leftDistantLow: {frame: 1, anchorX: .45, anchorY: 1.33},
                    rightNearLow: {frame: 2, anchorX: .47, anchorY: 1.32},
                    rightDistantLow: {frame: 3, anchorX: .52, anchorY: 1.34}
                }
            },
            LogRoofSlopeHigh: {
                iconFrame: 59,
                image: "logRoofs",
                layouts: {
                    leftNearHigh: {frame: 8, anchorX: .47, anchorY: 1.33},
                    leftDistantHigh: {frame: 9, anchorX: .44, anchorY: 1.34},
                    rightNearHigh: {frame: 10, anchorX: .46, anchorY: 1.33},
                    rightDistantHigh: {frame: 11, anchorX: .51, anchorY: 1.35}
                }
            },
            LogRoofCorner: {
                iconFrame: 60,
                image: "logRoofs",
                layouts: {
                    leftNearLow: {frame: 4, anchorX: .52, anchorY: 1.33},
                    leftDistantLow: {frame: 5, anchorX: .5, anchorY: 1.34},
                    rightNearLow: {frame: 6, anchorX: .52, anchorY: 1.3},
                    rightDistantLow: {frame: 7, anchorX: .47, anchorY: 1.32},
                    vLeftNearLow: {frame: 16, anchorX: .52, anchorY: 1.33},
                    vLeftDistantLow: {frame: 17, anchorX: .5, anchorY: 1.34},
                    vRightNearLow: {frame: 18, anchorX: .52, anchorY: 1.3},
                    vRightDistantLow: {frame: 19, anchorX: .47, anchorY: 1.32}
                }
            },
            LogRoofCornerHigh: {
                iconFrame: 61,
                image: "logRoofs",
                layouts: {
                    leftNearHigh: {frame: 12, anchorX: .47, anchorY: 1.33},
                    leftDistantHigh: {frame: 13, anchorX: .49, anchorY: 1.34},
                    rightNearHigh: {frame: 14, anchorX: .5, anchorY: 1.343},
                    rightDistantHigh: {frame: 15, anchorX: .51, anchorY: 1.33},
                    vLeftNearHigh: {frame: 20, anchorX: .47, anchorY: 1.33},
                    vLeftDistantHigh: {frame: 21, anchorX: .49, anchorY: 1.34},
                    vRightNearHigh: {frame: 22, anchorX: .5, anchorY: 1.343},
                    vRightDistantHigh: {frame: 23, anchorX: .51, anchorY: 1.33}
                }
            },
            LogPillar: {iconFrame: 57, image: "logWalls", frame: 18, anchorX: .07, anchorY: .97},
            LogWall: {
                iconFrame: 53,
                image: "logWalls",
                layouts: {
                    left: {frame: 5, rndFrames: 5, anchorX: .6, anchorY: .97, sortPatch: -1},
                    right: {frame: 0, rndFrames: 5, anchorX: .05, anchorY: .97}
                }
            },
            LogWallCorner: {
                iconFrame: 54,
                image: "logWalls",
                layouts: {
                    leftD: {frame: 12, anchorX: .6, anchorY: .955, sortPatch: -1},
                    rightD: {frame: 10, anchorX: .105, anchorY: .955},
                    leftU: {frame: 13, anchorX: .65, anchorY: .98, sortPatch: -1},
                    rightU: {frame: 11, anchorX: .05, anchorY: .97}
                }
            },
            LogDoorway: {
                iconFrame: 55,
                image: "logWalls",
                layouts: {
                    left: {frame: 15, anchorX: .6, anchorY: .97, sortPatch: -1},
                    right: {frame: 14, anchorX: .05, anchorY: .97}
                }
            },
            LogWindow: {
                iconFrame: 56,
                image: "logWalls",
                layouts: {
                    left: {frame: 17, anchorX: .6, anchorY: .97, sortPatch: -1},
                    right: {frame: 16, anchorX: .05, anchorY: .97}
                }
            },
            WoodenFence: {
                iconFrame: 75,
                image: "cityFence",
                layouts: {
                    left: {frame: 1, anchorX: .7, anchorY: .95, sortPatch: -1},
                    right: {frame: 0, anchorX: .1, anchorY: .95},
                    leftIn: {frame: 3, anchorX: .7, anchorY: .95, sortPatch: -1},
                    rightIn: {frame: 2, anchorX: .1, anchorY: .95},
                    convexLeft: {frame: 9, anchorX: .7, anchorY: .95, sortPatch: -1},
                    convexRight: {frame: 8, anchorX: .1, anchorY: .95},
                    convexLeftIn: {frame: 11, anchorX: .7, anchorY: .95, sortPatch: -1},
                    convexRightIn: {frame: 10, anchorX: .1, anchorY: .95}
                }
            },
            WoodenFenceSection: {iconFrame: 76},
            FenceGate: {
                iconFrame: 77,
                image: "cityFence",
                layouts: {
                    leftUp: {
                        states: {
                            ClosedDoor: {frame: 7, anchorX: .1, anchorY: .64},
                            OpenDoor: {frame: 6, anchorX: .7, anchorY: .64}
                        }
                    },
                    convexLeftUp: {
                        states: {
                            ClosedDoor: {frame: 15, anchorX: .1, anchorY: .64},
                            OpenDoor: {frame: 14, anchorX: .7, anchorY: .64}
                        }
                    },
                    leftDown: {
                        states: {
                            ClosedDoor: {frame: 7, anchorX: .1, anchorY: .64},
                            OpenDoor: {frame: 4, anchorX: .12, anchorY: .36, sortPatch: 64}
                        }
                    },
                    convexLeftDown: {
                        states: {
                            ClosedDoor: {frame: 15, anchorX: .1, anchorY: .64},
                            OpenDoor: {frame: 12, anchorX: .12, anchorY: .36, sortPatch: 64}
                        }
                    },
                    rightUp: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .77, anchorY: .64},
                            OpenDoor: {frame: 7, anchorX: .12, anchorY: .64}
                        }
                    },
                    convexRightUp: {
                        states: {
                            ClosedDoor: {frame: 12, anchorX: .77, anchorY: .64},
                            OpenDoor: {frame: 15, anchorX: .12, anchorY: .64}
                        }
                    },
                    rightDown: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .77, anchorY: .64},
                            OpenDoor: {frame: 7, anchorX: .77, anchorY: .36, sortPatch: 63}
                        }
                    },
                    convexRightDown: {
                        states: {
                            ClosedDoor: {frame: 12, anchorX: .77, anchorY: .64},
                            OpenDoor: {frame: 15, anchorX: .77, anchorY: .36, sortPatch: 63}
                        }
                    }
                }
            },
            FenceGateSection: {iconFrame: 78},
            Palisade: {
                iconFrame: 79,
                image: "palisadeWalls",
                layouts: {
                    left: {frame: 3, rndFrames: 3, anchorX: .56, anchorY: .95, sortPatch: -1},
                    right: {frame: 0, rndFrames: 3, anchorX: .11, anchorY: .95}
                }
            },
            PalisadeSection: {iconFrame: 80},
            StoneFence: {
                iconFrame: 83,
                image: "stoneFences",
                layouts: {
                    left: {frame: 2, rndFrames: 2, anchorX: .66, anchorY: .945, sortPatch: -1},
                    right: {frame: 0, rndFrames: 2, anchorX: .2, anchorY: .945}
                }
            },
            StoneSlit: {
                iconFrame: 84,
                image: "stoneFences",
                layouts: {
                    left: {frame: 6, rndFrames: 2, anchorX: .7, anchorY: .96, sortPatch: -1},
                    right: {frame: 4, rndFrames: 2, anchorX: .23, anchorY: .95}
                }
            },
            StoneBlock: {
                iconFrame: 89,
                mask: {bodyType: 1},
                image: "stoneBlocks",
                layouts: {
                    left: {
                        parts: [{
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .43,
                            anchorY: .79,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }, {
                            image: "stoneMerlons",
                            frame: 0,
                            rndFrames: 2,
                            anchorX: .465,
                            anchorY: 2.05,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: 1
                        }]
                    },
                    right: {
                        parts: [{
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .43,
                            anchorY: .79,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }, {
                            image: "stoneMerlons",
                            frame: 2,
                            rndFrames: 2,
                            anchorX: .465,
                            anchorY: 2.05,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: 1
                        }]
                    },
                    empty: {frame: 0, rndFrames: 4, anchorX: .43, anchorY: .79}
                }
            },
            StoneSlope: {
                iconFrame: 90,
                mask: {bodyType: 1},
                image: "stoneBlocks",
                layouts: {
                    left: {frame: 6, rndFrames: 2, anchorX: .435, anchorY: .81},
                    right: {frame: 4, rndFrames: 2, anchorX: .435, anchorY: .81}
                }
            },
            StoneArch: {
                image: "stoneArches",
                layouts: {
                    left: {frame: 1, anchorX: .388, anchorY: .985},
                    right: {frame: 0, anchorX: .543, anchorY: .985}
                }
            },
            StoneArchComplex: {iconFrame: 91},
            StoneTower: {
                iconFrame: 134,
                mask: {bodyType: 1},
                image: "stoneTower",
                parts: [{frame: 2, anchorX: .52, anchorY: .83}, {
                    frame: 0,
                    anchorX: 1.02,
                    anchorY: .761,
                    tileAnchorX: -.5,
                    tileAnchorY: -.5
                }, {frame: 1, anchorX: .02, anchorY: .761, tileAnchorX: .5, tileAnchorY: -.5}]
            },
            StoneBarbicanTower: {
                iconFrame: 135,
                mask: {bodyType: 1},
                image: "slicedStoneBarbakan",
                layouts: {
                    leftUp: {
                        parts: [{frame: 3, anchorX: .53, anchorY: .82}, {
                            frame: 4,
                            anchorX: -.07,
                            anchorY: .82,
                            tileAnchorX: .5,
                            tileAnchorY: -.5
                        }]
                    },
                    leftDown: {
                        parts: [{frame: 0, anchorX: .9, anchorY: .82}, {
                            frame: 1,
                            anchorX: .695,
                            anchorY: .878,
                            tileAnchorX: 1,
                            tileAnchorY: 0,
                            softPatch: -32
                        }, {frame: 2, anchorX: -.115, anchorY: .82, tileAnchorX: 1, tileAnchorY: -1}]
                    },
                    rightUp: {
                        parts: [{frame: 6, anchorX: .39, anchorY: .77}, {
                            frame: 5,
                            anchorX: .99,
                            anchorY: .77,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }]
                    },
                    rightDown: {
                        parts: [{frame: 9, anchorX: .09, anchorY: .828}, {
                            frame: 8,
                            anchorX: .288,
                            anchorY: .887,
                            tileAnchorX: -1,
                            tileAnchorY: 0,
                            softPatch: -32
                        }, {frame: 7, anchorX: .385, anchorY: .828, tileAnchorX: -1, tileAnchorY: -1}]
                    }
                }
            },
            BrickBlock: {
                iconFrame: 101,
                mask: {bodyType: 1},
                image: "brickBlocks",
                layouts: {
                    left: {
                        parts: [{
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .44,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }, {
                            image: "brickMerlons",
                            frame: 0,
                            rndFrames: 2,
                            anchorX: .48,
                            anchorY: 2.1,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: 1
                        }]
                    },
                    right: {
                        parts: [{
                            frame: 0,
                            rndFrames: 4,
                            anchorX: .44,
                            anchorY: .8,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }, {
                            image: "brickMerlons",
                            frame: 2,
                            rndFrames: 2,
                            anchorX: .48,
                            anchorY: 2.1,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: 1
                        }]
                    },
                    empty: {frame: 0, rndFrames: 4, anchorX: .44, anchorY: .8}
                }
            },
            BrickTower: {
                iconFrame: 104,
                mask: {bodyType: 1},
                image: "brickTower",
                layouts: {
                    full: {
                        parts: [{
                            frame: 1,
                            anchorX: .5,
                            anchorY: .9,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }, {frame: 0, anchorX: .5, anchorY: 1.42, tileAnchorX: 0, tileAnchorY: 0, sortPatch: 1}]
                    }, empty: {frame: 1, anchorX: .5, anchorY: .9}
                }
            },
            BrickSlope: {
                iconFrame: 100,
                mask: {bodyType: 1},
                image: "brickBlocks",
                layouts: {
                    left: {frame: 6, rndFrames: 2, anchorX: .44, anchorY: .8},
                    right: {frame: 4, rndFrames: 2, anchorX: .44, anchorY: .8}
                }
            },
            BarbicanTower: {
                iconFrame: 99,
                mask: {bodyType: 1},
                image: "slicedBarbakan",
                layouts: {
                    leftUp: {
                        parts: [{frame: 3, anchorX: .55, anchorY: .8}, {
                            frame: 4,
                            anchorX: .41,
                            anchorY: .8,
                            tileAnchorX: .5,
                            tileAnchorY: -.5
                        }]
                    },
                    leftDown: {
                        parts: [{frame: 0, anchorX: .55, anchorY: .86}, {
                            frame: 1,
                            anchorX: .83,
                            anchorY: .922,
                            tileAnchorX: 1,
                            tileAnchorY: 0,
                            softPatch: -32
                        }, {frame: 2, anchorX: .27, anchorY: .86, tileAnchorX: 1, tileAnchorY: -1}]
                    },
                    rightUp: {
                        parts: [{frame: 6, anchorX: .45, anchorY: .8}, {
                            frame: 5,
                            anchorX: .59,
                            anchorY: .8,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }]
                    },
                    rightDown: {
                        parts: [{frame: 9, anchorX: .44, anchorY: .86}, {
                            frame: 8,
                            anchorX: .16,
                            anchorY: .92,
                            tileAnchorX: -1,
                            tileAnchorY: 0,
                            softPatch: -32
                        }, {frame: 7, anchorX: .73, anchorY: .859, tileAnchorX: -1, tileAnchorY: -1}]
                    }
                }
            },
            BarbicanComplex: {iconFrame: 99},
            PalisadeGate: {
                iconFrame: 81,
                image: "palisadeGates",
                layouts: {
                    leftUp: {
                        states: {
                            ClosedDoor: {frame: 1, anchorX: .15, anchorY: .81},
                            OpenDoor: {frame: 3, anchorX: .58, anchorY: .81}
                        }
                    },
                    leftDown: {
                        states: {
                            ClosedDoor: {frame: 5, anchorX: .18, anchorY: .81},
                            OpenDoor: {frame: 7, anchorX: .15, anchorY: .67, sortPatch: 64}
                        }
                    },
                    rightUp: {
                        states: {
                            ClosedDoor: {frame: 0, anchorX: .52, anchorY: .81},
                            OpenDoor: {frame: 2, anchorX: .15, anchorY: .81}
                        }
                    },
                    rightDown: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .55, anchorY: .81},
                            OpenDoor: {frame: 6, anchorX: .6, anchorY: .67, sortPatch: 63}
                        }
                    }
                }
            },
            PalisadeGateSection: {iconFrame: 82},
            IronedGate: {
                iconFrame: 85,
                image: "fencesAndGates",
                layouts: {
                    leftUp: {
                        states: {
                            ClosedDoor: {frame: 1, anchorX: .15, anchorY: .81},
                            OpenDoor: {frame: 3, anchorX: .58, anchorY: .81}
                        }
                    },
                    leftDown: {
                        states: {
                            ClosedDoor: {frame: 5, anchorX: .18, anchorY: .81},
                            OpenDoor: {frame: 7, anchorX: .15, anchorY: .67, sortPatch: 64}
                        }
                    },
                    rightUp: {
                        states: {
                            ClosedDoor: {frame: 0, anchorX: .52, anchorY: .81},
                            OpenDoor: {frame: 2, anchorX: .15, anchorY: .81}
                        }
                    },
                    rightDown: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .55, anchorY: .81},
                            OpenDoor: {frame: 6, anchorX: .6, anchorY: .67, sortPatch: 63}
                        }
                    }
                }
            },
            IronedGateSection: {iconFrame: 86},
            FullIronGate: {
                iconFrame: 87,
                image: "fencesAndGates",
                layouts: {
                    leftUp: {
                        states: {
                            ClosedDoor: {frame: 9, anchorX: .15, anchorY: .81},
                            OpenDoor: {frame: 11, anchorX: .58, anchorY: .81}
                        }
                    },
                    leftDown: {
                        states: {
                            ClosedDoor: {frame: 13, anchorX: .18, anchorY: .81},
                            OpenDoor: {frame: 15, anchorX: .15, anchorY: .67, sortPatch: 64}
                        }
                    },
                    rightUp: {
                        states: {
                            ClosedDoor: {frame: 8, anchorX: .52, anchorY: .81},
                            OpenDoor: {frame: 10, anchorX: .15, anchorY: .81}
                        }
                    },
                    rightDown: {
                        states: {
                            ClosedDoor: {frame: 12, anchorX: .55, anchorY: .81},
                            OpenDoor: {frame: 14, anchorX: .6, anchorY: .67, sortPatch: 63}
                        }
                    }
                }
            },
            FullIronGateSection: {iconFrame: 88},
            SteelGate: {
                iconFrame: 92,
                image: "steelGates",
                layouts: {
                    leftUp: {
                        states: {
                            ClosedDoor: {frame: 1, anchorX: .15, anchorY: .81},
                            OpenDoor: {frame: 3, anchorX: .58, anchorY: .81}
                        }
                    },
                    leftDown: {
                        states: {
                            ClosedDoor: {frame: 5, anchorX: .18, anchorY: .81},
                            OpenDoor: {frame: 7, anchorX: .15, anchorY: .67, sortPatch: 64}
                        }
                    },
                    rightUp: {
                        states: {
                            ClosedDoor: {frame: 0, anchorX: .52, anchorY: .81},
                            OpenDoor: {frame: 2, anchorX: .15, anchorY: .81}
                        }
                    },
                    rightDown: {
                        states: {
                            ClosedDoor: {frame: 4, anchorX: .55, anchorY: .81},
                            OpenDoor: {frame: 6, anchorX: .6, anchorY: .67, sortPatch: 63}
                        }
                    }
                }
            },
            SteelGateSection: {iconFrame: 93},
            IronGrate: {
                iconFrame: 103,
                image: "ironGrate",
                layouts: {
                    left: {
                        states: {
                            ClosedDoor: {
                                parts: [{
                                    frame: 1,
                                    anchorX: -.4,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {frame: 0, anchorX: -.4, anchorY: .82, tileAnchorX: -.5, tileAnchorY: .5}]
                            },
                            OpenDoor: {
                                parts: [{
                                    frame: 3,
                                    anchorX: -.4,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {frame: 2, anchorX: -.4, anchorY: .82, tileAnchorX: -.5, tileAnchorY: .5}]
                            }
                        }
                    },
                    right: {
                        states: {
                            ClosedDoor: {
                                parts: [{
                                    frame: 4,
                                    anchorX: 1.12,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {frame: 5, anchorX: 1.12, anchorY: .82, tileAnchorX: .5, tileAnchorY: .5}]
                            },
                            OpenDoor: {
                                parts: [{
                                    frame: 6,
                                    anchorX: 1.12,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {frame: 7, anchorX: 1.12, anchorY: .82, tileAnchorX: .5, tileAnchorY: .5}]
                            }
                        }
                    }
                }
            },
            Drawbridge: {
                iconFrame: 105, image: "slicedDrawbridge", layouts: {
                    leftOne: {
                        states: {
                            ClosedDoor: {
                                parts: [{
                                    frame: 7, anchorX: -.27,
                                    anchorY: .75, tileAnchorX: 0, tileAnchorY: 0, sortPatch: 1
                                }, {
                                    frame: 6,
                                    anchorX: -.27,
                                    anchorY: .75,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }]
                            },
                            OpenDoor: {
                                parts: [{
                                    frame: 11,
                                    anchorX: -.5,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 10,
                                    anchorX: 0,
                                    anchorY: .75,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }, {
                                    image: "downDrawbridge",
                                    frame: 1,
                                    anchorX: -.02,
                                    anchorY: -.3,
                                    tileAnchorX: 0,
                                    tileAnchorY: -1
                                }]
                            }
                        }
                    },
                    leftTwo: {
                        states: {
                            ClosedDoor: {
                                parts: [{
                                    frame: 9,
                                    anchorX: -.27,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 8,
                                    anchorX: -.27,
                                    anchorY: .75,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }]
                            },
                            OpenDoor: {
                                parts: [{
                                    frame: 11,
                                    anchorX: -.5,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 10,
                                    anchorX: 0,
                                    anchorY: .75,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }, {
                                    image: "downDrawbridge",
                                    frame: 1,
                                    anchorX: -.02,
                                    anchorY: -.3,
                                    tileAnchorX: 0,
                                    tileAnchorY: -1
                                }]
                            }
                        }
                    },
                    rightOne: {
                        states: {
                            ClosedDoor: {
                                parts: [{
                                    frame: 0,
                                    anchorX: 1.25,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 1,
                                    anchorX: 1.25,
                                    anchorY: .75,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }]
                            },
                            OpenDoor: {
                                parts: [{
                                    frame: 4,
                                    anchorX: 1.48,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 5,
                                    anchorX: 1.02,
                                    anchorY: .75,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }, {
                                    image: "downDrawbridge",
                                    frame: 0,
                                    anchorX: 1.02,
                                    anchorY: -.3,
                                    tileAnchorX: 0,
                                    tileAnchorY: -1
                                }]
                            }
                        }
                    },
                    rightTwo: {
                        states: {
                            ClosedDoor: {
                                parts: [{
                                    frame: 2,
                                    anchorX: 1.25,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 3,
                                    anchorX: 1.25,
                                    anchorY: .75,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }]
                            },
                            OpenDoor: {
                                parts: [{
                                    frame: 4,
                                    anchorX: 1.48,
                                    anchorY: .75,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1
                                }, {
                                    frame: 5,
                                    anchorX: 1.02,
                                    anchorY: .75,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5,
                                    sortPatch: 1
                                }, {
                                    image: "downDrawbridge",
                                    frame: 0,
                                    anchorX: 1.02,
                                    anchorY: -.3,
                                    tileAnchorX: 0,
                                    tileAnchorY: -1
                                }]
                            }
                        }
                    }
                }
            },
            Roost: {
                iconFrame: 21,
                mask: {bodyType: 1},
                image: "smallAviary",
                anchorX: .5,
                anchorY: .65,
                layouts: {
                    left: {states: {Normal: {frame: 2}, Production: {frame: 3}}},
                    right: {states: {Normal: {frame: 0}, Production: {frame: 1}}}
                }
            },
            HenHouse712: {
                iconFrame: 36,
                mask: {bodyType: 1},
                image: "henHouse",
                anchorX: .5,
                anchorY: .65,
                layouts: {
                    left: {
                        states: {
                            Normal: {
                                parts: [{frame: 8, anchorX: .5, anchorY: .65}, {
                                    frame: 6,
                                    anchorX: 1,
                                    anchorY: .49,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {frame: 7, anchorX: 0, anchorY: .49, tileAnchorX: .5, tileAnchorY: -.5}]
                            },
                            Production: {
                                parts: [{frame: 11, anchorX: .5, anchorY: .65}, {
                                    frame: 9,
                                    anchorX: 1,
                                    anchorY: .49,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {frame: 10, anchorX: 0, anchorY: .49, tileAnchorX: .5, tileAnchorY: -.5}]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {
                                parts: [{frame: 2, anchorX: .5, anchorY: .65}, {
                                    frame: 0,
                                    anchorX: 1,
                                    anchorY: .49,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {frame: 1, anchorX: 0, anchorY: .49, tileAnchorX: .5, tileAnchorY: -.5}]
                            },
                            Production: {
                                parts: [{frame: 5, anchorX: .5, anchorY: .65}, {
                                    frame: 3,
                                    anchorX: 1,
                                    anchorY: .49,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {frame: 4, anchorX: 0, anchorY: .49, tileAnchorX: .5, tileAnchorY: -.5}]
                            }
                        }
                    }
                }
            },
            LogMill: {
                iconFrame: 143,
                mask: {bodyType: 1},
                image: "logMill",
                layouts: {
                    left: {
                        states: {
                            Normal: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .44,
                                    anchorY: .8,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {
                                    image: "logMillFansLeft",
                                    frame: 0,
                                    anchorX: .44,
                                    anchorY: .9,
                                    noColorize: !0,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5,
                                    sortPatch: -64
                                }]
                            },
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .44,
                                    anchorY: .8,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {
                                    image: "logMillFansLeft",
                                    frame: 0,
                                    anchorX: .44,
                                    anchorY: .9,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5,
                                    sortPatch: -64,
                                    noColorize: !0,
                                    animation: {name: "work", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .46,
                                    anchorY: .8,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {
                                    image: "logMillFansRight",
                                    frame: 0,
                                    anchorX: .4,
                                    anchorY: .92,
                                    noColorize: !0,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5,
                                    sortPatch: -64
                                }]
                            },
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .46,
                                    anchorY: .8,
                                    tileAnchorX: -.5,
                                    tileAnchorY: -.5
                                }, {
                                    image: "logMillFansRight",
                                    frame: 0,
                                    anchorX: .4,
                                    anchorY: .92,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5,
                                    sortPatch: -64,
                                    noColorize: !0,
                                    animation: {name: "work", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            HTMill: {
                iconFrame: 34,
                mask: {bodyType: 1},
                image: "slicedTallStructures",
                states: {
                    Normal: {
                        parts: [{frame: 2, anchorX: .5, anchorY: .77}, {
                            frame: 0,
                            anchorX: .48,
                            anchorY: .77,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {
                            frame: 1,
                            anchorX: 0,
                            anchorY: .77,
                            tileAnchorX: .5,
                            tileAnchorY: -.5
                        }, {
                            image: "htMillFans",
                            frame: 0,
                            anchorX: .54,
                            anchorY: .905,
                            noColorize: !0,
                            tileAnchorX: .5,
                            tileAnchorY: .5,
                            sortPatch: -64
                        }]
                    },
                    Production: {
                        parts: [{frame: 2, anchorX: .5, anchorY: .77}, {
                            frame: 0,
                            anchorX: .48,
                            anchorY: .77,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {
                            frame: 1,
                            anchorX: 0,
                            anchorY: .77,
                            tileAnchorX: .5,
                            tileAnchorY: -.5
                        }, {
                            image: "htMillFans",
                            frame: 0,
                            anchorX: .54,
                            anchorY: .905,
                            tileAnchorX: .5,
                            tileAnchorY: .5,
                            sortPatch: -64,
                            noColorize: !0,
                            animation: {name: "work", frameRate: 10}
                        }]
                    }
                }
            },
            Campfire: {
                iconFrame: 74,
                mask: {width: 60, height: 50, anchorX: .5, anchorY: .6},
                image: "campfire",
                states: {
                    Normal: {parts: [{frame: 0, anchorX: .5, anchorY: .55, tileAnchorX: 0, tileAnchorY: 0}]},
                    Production: {
                        parts: [{
                            frame: 0,
                            anchorX: .5,
                            anchorY: .55,
                            tileAnchorX: 0,
                            tileAnchorY: 0
                        }, {
                            image: "fireSmall",
                            frame: 0,
                            anchorX: .5,
                            anchorY: .91,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: 1,
                            noColorize: !0,
                            animation: {name: "fire", frameRate: 10}
                        }]
                    }
                }
            },
            SmallWoodenBasket: {iconFrame: 5, image: "smallStructures", frame: 0, anchorX: .5, anchorY: .75},
            LargeWoodenBox: {
                iconFrame: 26,
                image: "woodenBox",
                anchorX: .5,
                anchorY: .6,
                layouts: {left: {frame: 0}, right: {frame: 1}}
            },
            WoodenShed: {
                iconFrame: 30,
                mask: {bodyType: 1},
                image: "woodenShed",
                anchorY: .8,
                layouts: {
                    left: {
                        anchorX: .47,
                        parts: [{frame: 0, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 1,
                            tileAnchorX: -.5,
                            tileAnchorY: .5
                        }]
                    },
                    right: {
                        anchorX: .47,
                        parts: [{frame: 2, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 3,
                            tileAnchorX: .5,
                            tileAnchorY: .5
                        }]
                    }
                }
            },
            LogShed: {
                iconFrame: 31,
                mask: {bodyType: 1},
                image: "logShed",
                layouts: {
                    left: {
                        parts: [{frame: 2, anchorX: .5, anchorY: .76}, {
                            frame: 0,
                            anchorX: 1,
                            anchorY: .64,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {frame: 1, anchorX: 0, anchorY: .64, tileAnchorX: .5, tileAnchorY: -.5}]
                    },
                    right: {
                        parts: [{frame: 5, anchorX: .5, anchorY: .76}, {
                            frame: 3,
                            anchorX: 1,
                            anchorY: .64,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {frame: 4, anchorX: 0, anchorY: .64, tileAnchorX: .5, tileAnchorY: -.5}]
                    }
                }
            },
            StoneShed: {
                iconFrame: 32,
                mask: {bodyType: 1},
                image: "stoneShed",
                anchorY: .8,
                layouts: {
                    left: {
                        parts: [{frame: 2, anchorX: .5, anchorY: .8}, {
                            frame: 0,
                            anchorX: 1,
                            anchorY: .71,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {frame: 1, anchorX: 0, anchorY: .71, tileAnchorX: .5, tileAnchorY: -.5}]
                    },
                    right: {
                        parts: [{frame: 5, anchorX: .5, anchorY: .8}, {
                            frame: 3,
                            anchorX: 1,
                            anchorY: .71,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {frame: 4, anchorX: 0, anchorY: .71, tileAnchorX: .5, tileAnchorY: -.5}]
                    }
                }
            },
            HunterBed: {
                iconFrame: 102,
                image: "slicedMediumStructures",
                anchorY: .5,
                layouts: {
                    left: {
                        anchorX: .65,
                        parts: [{frame: 14, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 15,
                            tileAnchorX: .5,
                            tileAnchorY: .5
                        }]
                    },
                    right: {
                        anchorX: .4,
                        parts: [{frame: 12, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 13,
                            tileAnchorX: -.5,
                            tileAnchorY: .5
                        }]
                    }
                }
            },
            Bed: {
                iconFrame: 41,
                image: "slicedMediumStructures",
                anchorY: .5,
                layouts: {
                    left: {
                        anchorX: .65,
                        parts: [{frame: 6, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 7,
                            tileAnchorX: .5,
                            tileAnchorY: .5
                        }]
                    },
                    right: {
                        anchorX: .4,
                        parts: [{frame: 4, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 5,
                            tileAnchorX: -.5,
                            tileAnchorY: .5
                        }]
                    }
                }
            },
            Scarecrow: {
                iconFrame: 22,
                image: "scarecrow",
                anchorY: .93,
                anchorX: .43,
                layouts: {left: {frame: 0}, right: {frame: 1}, up: {frame: 2}, down: {frame: 3}}
            },
            PumpkinScarecrow: {
                iconFrame: 98,
                image: "pumpkinScarecrow",
                anchorX: .5,
                anchorY: .85,
                layouts: {left: {frame: 0}, right: {frame: 1}}
            },
            HalloweenTree: {iconFrame: 122, image: "halloweenTree", frame: 0, anchorX: .49, anchorY: .91},
            KnightStatue: {
                iconFrame: 123,
                image: "knightStatue",
                anchorY: .88,
                anchorX: .41,
                layouts: {
                    one: {frame: 0},
                    two: {frame: 1},
                    three: {frame: 2},
                    four: {frame: 3},
                    five: {frame: 4},
                    six: {frame: 5},
                    seven: {frame: 6},
                    eight: {frame: 7}
                }
            },
            SkullStick: {
                iconFrame: 110,
                image: "skullStick",
                anchorY: .97,
                anchorX: .4,
                layouts: {
                    one: {frame: 0},
                    two: {frame: 1},
                    three: {frame: 2},
                    four: {frame: 3},
                    five: {frame: 4},
                    six: {frame: 5}
                }
            },
            SkullHump: {iconFrame: 111, image: "skullPiles", frame: 0, anchorY: .6, anchorX: .5},
            SkullPile: {iconFrame: 112, image: "skullPiles", frame: 1, anchorY: .6, anchorX: .5},
            Gobelin: {
                iconFrame: 113,
                image: "gobelins",
                anchorY: 1.1,
                layouts: {
                    leftOne: {frame: 0, anchorX: .85},
                    rightOne: {frame: 4, anchorX: .15},
                    leftTwo: {frame: 1, anchorX: .85},
                    rightTwo: {frame: 5, anchorX: .15},
                    leftThree: {frame: 2, anchorX: .85},
                    rightThree: {frame: 6, anchorX: .15},
                    leftFour: {frame: 3, anchorX: .85},
                    rightFour: {frame: 7, anchorX: .15}
                }
            },
            Scaffold: {
                iconFrame: 138,
                mask: {bodyType: 1},
                image: "scaffold",
                layouts: {
                    left: {
                        parts: [{frame: 2, anchorX: .5, anchorY: .6}, {
                            frame: 0,
                            anchorX: 1,
                            anchorY: .405,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {frame: 1, anchorX: 0, anchorY: .405, tileAnchorX: .5, tileAnchorY: -.5}, {
                            image: "gibbet",
                            frame: 2,
                            anchorX: .3,
                            anchorY: 1.05,
                            tileAnchorX: 0,
                            tileAnchorY: -.5
                        }, {
                            image: "pillory",
                            frame: 0,
                            anchorX: 1.2,
                            anchorY: 1.5,
                            tileAnchorX: 0,
                            tileAnchorY: .5,
                            softPatch: 64
                        }, {
                            image: "executionersBlock",
                            frame: 0,
                            anchorX: .2,
                            anchorY: 1.5,
                            tileAnchorX: 0,
                            tileAnchorY: .5,
                            softPatch: 64
                        }]
                    },
                    right: {
                        parts: [{frame: 5, anchorX: .5, anchorY: .6}, {
                            frame: 3,
                            anchorX: 1,
                            anchorY: .405,
                            tileAnchorX: -.5,
                            tileAnchorY: -.5
                        }, {frame: 4, anchorX: 0, anchorY: .405, tileAnchorX: .5, tileAnchorY: -.5}, {
                            image: "gibbet",
                            frame: 1,
                            anchorX: .5,
                            anchorY: 1.05,
                            tileAnchorX: 0,
                            tileAnchorY: -.5
                        }, {
                            image: "pillory",
                            frame: 1,
                            anchorX: -.3,
                            anchorY: 1.5,
                            tileAnchorX: 0,
                            tileAnchorY: .5,
                            softPatch: 64
                        }, {
                            image: "executionersBlock",
                            frame: 1,
                            anchorX: .6,
                            anchorY: 1.5,
                            tileAnchorX: 0,
                            tileAnchorY: .5,
                            softPatch: 64
                        }]
                    }
                }
            },
            Gibbet: {
                iconFrame: 136,
                image: "gibbet",
                anchorY: .94,
                layouts: {
                    left: {frame: 0, anchorX: .25},
                    right: {frame: 1, anchorX: .25},
                    up: {frame: 2, anchorX: .55},
                    down: {frame: 3, anchorX: .6}
                }
            },
            ExecutionersBlock: {
                iconFrame: 139,
                image: "executionersBlock",
                anchorY: .87,
                layouts: {left: {frame: 0, anchorX: .65}, right: {frame: 1, anchorX: .2}}
            },
            Pillory: {
                iconFrame: 137,
                image: "pillory",
                anchorY: .9,
                anchorX: .4,
                layouts: {left: {frame: 0}, right: {frame: 1}}
            },
            StoneStatueGargoyle: {
                iconFrame: 95,
                image: "statuesStructures",
                anchorY: .7,
                anchorX: .4,
                layouts: {left: {frame: 0}, right: {frame: 1}, up: {frame: 2}, down: {frame: 3}}
            },
            StoneStatueChimera: {
                iconFrame: 96,
                image: "statuesStructures",
                anchorY: .7,
                anchorX: .4,
                layouts: {left: {frame: 4}, right: {frame: 5}, up: {frame: 6}, down: {frame: 7}}
            },
            StoneStatueLion: {
                iconFrame: 97,
                image: "statuesStructures",
                anchorY: .7,
                anchorX: .4,
                layouts: {left: {frame: 8}, right: {frame: 9}, up: {frame: 10}, down: {frame: 11}}
            },
            Ballista: {
                iconFrame: 94,
                image: "ballista",
                placeState: "Disarmed",
                layouts: {
                    leftup: {
                        anchorX: .45,
                        anchorY: .48,
                        states: {Laid: {frame: 0}, Disarmed: {frame: 1}, Armed: {frame: 2}}
                    },
                    upright: {
                        anchorX: .55,
                        anchorY: .48,
                        states: {Laid: {frame: 3}, Disarmed: {frame: 4}, Armed: {frame: 5}}
                    },
                    rightdown: {
                        anchorX: .5,
                        anchorY: .56,
                        states: {Laid: {frame: 9}, Disarmed: {frame: 10}, Armed: {frame: 11}}
                    },
                    downleft: {
                        anchorX: .5,
                        anchorY: .56,
                        states: {Laid: {frame: 6}, Disarmed: {frame: 7}, Armed: {frame: 8}}
                    }
                }
            },
            BatteringRam: {
                iconFrame: 118,
                image: "batteringRam",
                placeState: "Armed",
                layouts: {
                    leftup: {
                        states: {
                            Laid: {
                                parts: [{frame: 0, anchorX: .8, anchorY: .7}, {
                                    frame: 1,
                                    anchorX: .26,
                                    anchorY: .7,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5
                                }]
                            },
                            Armed: {
                                parts: [{frame: 4, anchorX: .8, anchorY: .7}, {
                                    frame: 5,
                                    anchorX: .26,
                                    anchorY: .7,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5
                                }]
                            }
                        }
                    },
                    upright: {
                        states: {
                            Laid: {
                                parts: [{frame: 3, anchorX: .26, anchorY: .7}, {
                                    frame: 2,
                                    anchorX: .8,
                                    anchorY: .7,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5
                                }]
                            },
                            Armed: {
                                parts: [{frame: 7, anchorX: .26, anchorY: .7}, {
                                    frame: 6,
                                    anchorX: .8,
                                    anchorY: .7,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5
                                }]
                            }
                        }
                    },
                    rightdown: {
                        states: {
                            Laid: {
                                parts: [{frame: 0, anchorX: .8, anchorY: .7}, {
                                    frame: 1,
                                    anchorX: .26,
                                    anchorY: .7,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5
                                }]
                            },
                            Armed: {
                                parts: [{frame: 8, anchorX: .8, anchorY: .7}, {
                                    frame: 9,
                                    anchorX: .26,
                                    anchorY: .7,
                                    tileAnchorX: .5,
                                    tileAnchorY: .5
                                }]
                            }
                        }
                    },
                    downleft: {
                        states: {
                            Laid: {
                                parts: [{frame: 3, anchorX: .26, anchorY: .7}, {
                                    frame: 2,
                                    anchorX: .8,
                                    anchorY: .7,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5
                                }]
                            },
                            Armed: {
                                parts: [{frame: 11, anchorX: .26, anchorY: .7}, {
                                    frame: 10,
                                    anchorX: .8,
                                    anchorY: .7,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5
                                }]
                            }
                        }
                    }
                }
            },
            Cupboard: {
                iconFrame: 27,
                image: "cupboard",
                anchorY: .66,
                layouts: {left: {frame: 1, anchorX: .25}, right: {frame: 0, anchorX: .58}}
            },
            FlaxBreak: {
                iconFrame: 106,
                image: "flaxBreak",
                layouts: {left: {frame: 1, anchorX: .25, anchorY: .5}, right: {frame: 0, anchorX: .58, anchorY: .55}}
            },
            SpinningWheel: {
                iconFrame: 107,
                image: "spinningWheel",
                anchorX: .5,
                anchorY: .8,
                layouts: {left: {frame: 1}, right: {frame: 0}}
            },
            Loom: {
                iconFrame: 108,
                mask: {bodyType: 1},
                image: "loom",
                anchorY: .5,
                layouts: {left: {frame: 0, anchorX: .35}, right: {frame: 1, anchorX: .58}}
            },
            SmallDryingFrame: {
                iconFrame: 144,
                mask: {bodyType: 1},
                image: "smallDryingFrame",
                layouts: {
                    left: {anchorX: .3, anchorY: .45, states: {Normal: {frame: 1}, Production: {frame: 3}}},
                    right: {anchorX: .7, anchorY: .48, states: {Normal: {frame: 0}, Production: {frame: 2}}}
                }
            },
            DryingFrame: {
                iconFrame: 13,
                mask: {bodyType: 1},
                image: "dryingFrame",
                layouts: {
                    left: {anchorX: .4, anchorY: .6, states: {Normal: {frame: 1}, Production: {frame: 3}}},
                    right: {anchorX: .6, anchorY: .63, states: {Normal: {frame: 0}, Production: {frame: 2}}}
                }
            },
            ClayTanning: {
                iconFrame: 19,
                image: "clayTanning",
                layouts: {
                    left: {anchorX: .52, anchorY: .63, states: {Normal: {frame: 1}, Production: {frame: 2}}},
                    right: {anchorX: .45, anchorY: .63, states: {Normal: {frame: 0}, Production: {frame: 3}}}
                }
            },
            WoodenTanning: {
                iconFrame: 37,
                image: "woodTanning",
                layouts: {
                    left: {anchorX: .55, anchorY: .65, states: {Normal: {frame: 1}, Production: {frame: 3}}},
                    right: {anchorX: .4, anchorY: .65, states: {Normal: {frame: 0}, Production: {frame: 2}}}
                }
            },
            ClayBoiler: {
                iconFrame: 116,
                image: "clayBoiler",
                states: {
                    Normal: {frame: 0, anchorX: .45, anchorY: .75},
                    Production: {
                        parts: [{frame: 1, anchorX: .45, anchorY: .75}, {
                            image: "fireSmall",
                            frame: 0,
                            anchorX: .5,
                            anchorY: .85,
                            tileAnchorX: 0,
                            tileAnchorY: 0,
                            sortPatch: 1,
                            noColorize: !0,
                            animation: {name: "fire", frameRate: 10}
                        }]
                    }
                }
            },
            Well: {
                iconFrame: 17,
                image: "basicWell",
                anchorX: .4,
                anchorY: .8,
                layouts: {left: {frame: 0}, right: {frame: 1}}
            },
            TownFountain: {
                iconFrame: 119,
                image: "townFountain",
                anchorX: .5,
                anchorY: .75,
                layouts: {left: {frame: 0}, right: {frame: 1}}
            },
            Oven711: {
                iconFrame: 18,
                mask: {bodyType: 1},
                image: "oven",
                layouts: {
                    left: {
                        states: {
                            Normal: {frame: 0, anchorX: .5, anchorY: .82, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .5,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .75,
                                    anchorY: 2.3,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .5, anchorY: .82, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .5,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .2,
                                    anchorY: 2.3,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            BrickOven: {
                iconFrame: 115,
                mask: {bodyType: 1},
                image: "brickOven",
                layouts: {
                    left: {
                        states: {
                            Normal: {
                                frame: 0,
                                anchorX: .47,
                                anchorY: .77,
                                tileAnchorX: 0,
                                tileAnchorY: 0
                            },
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .47,
                                    anchorY: .77,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .55,
                                    anchorY: 2,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .47, anchorY: .77, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .47,
                                    anchorY: .77,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .4,
                                    anchorY: 2,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            ClayMeltingPot: {
                iconFrame: 140,
                mask: {bodyType: 1},
                image: "clayMeltingPot",
                layouts: {
                    left: {
                        states: {
                            Normal: {
                                frame: 0,
                                anchorX: .65,
                                anchorY: .55,
                                tileAnchorX: 0,
                                tileAnchorY: 0,
                                sortPatch: 20
                            },
                            Production: {
                                frame: 2,
                                anchorX: .65,
                                anchorY: .55,
                                tileAnchorX: 0,
                                tileAnchorY: 0,
                                sortPatch: 20
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {
                                frame: 1,
                                anchorX: .33,
                                anchorY: .55,
                                tileAnchorX: 0,
                                tileAnchorY: 0,
                                sortPatch: 20
                            },
                            Production: {
                                frame: 3,
                                anchorX: .33,
                                anchorY: .55,
                                tileAnchorX: 0,
                                tileAnchorY: 0,
                                sortPatch: 20
                            }
                        }
                    }
                }
            },
            Smelter711: {
                iconFrame: 14,
                mask: {bodyType: 1},
                image: "smallFurnace",
                layouts: {
                    left: {
                        states: {
                            Normal: {frame: 0, anchorX: .4, anchorY: .55, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .4,
                                    anchorY: .55,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .6,
                                    anchorY: 1.5,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .6, anchorY: .6, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .6,
                                    anchorY: .6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .4,
                                    anchorY: 1.55,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            RoastFurnace: {
                iconFrame: 20,
                mask: {bodyType: 1},
                image: "roastFurnace",
                layouts: {
                    left: {
                        states: {
                            Normal: {frame: 0, anchorX: .45, anchorY: .6, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .45,
                                    anchorY: .6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .57,
                                    anchorY: 1.6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .5, anchorY: .6, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .5,
                                    anchorY: .6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .43,
                                    anchorY: 1.6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            BrickKiln: {
                iconFrame: 120,
                mask: {bodyType: 1},
                image: "brickKiln",
                layouts: {
                    left: {
                        states: {
                            Normal: {frame: 0, anchorX: .51, anchorY: .6, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .51,
                                    anchorY: .6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .48,
                                    anchorY: 1.7,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .49, anchorY: .6, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .49,
                                    anchorY: .6,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .49,
                                    anchorY: 1.7,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            BigSmelter: {
                iconFrame: 35,
                mask: {bodyType: 1},
                image: "bigFurnace",
                layouts: {
                    left: {
                        states: {
                            Normal: {frame: 0, anchorX: .5, anchorY: .82, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .5,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .9,
                                    anchorY: 3.1,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .5, anchorY: .82, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .5,
                                    anchorY: .82,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .15,
                                    anchorY: 3.1,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            BrickSmelter: {
                iconFrame: 121,
                mask: {bodyType: 1},
                image: "brickSmelter",
                layouts: {
                    left: {
                        states: {
                            Normal: {
                                frame: 0,
                                anchorX: .51,
                                anchorY: .72,
                                tileAnchorX: 0,
                                tileAnchorY: 0
                            },
                            Production: {
                                parts: [{
                                    frame: 0,
                                    anchorX: .51,
                                    anchorY: .72,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .15,
                                    anchorY: 2.55,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {frame: 1, anchorX: .5, anchorY: .72, tileAnchorX: 0, tileAnchorY: 0},
                            Production: {
                                parts: [{
                                    frame: 1,
                                    anchorX: .5,
                                    anchorY: .72,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0
                                }, {
                                    image: "smokeSmall",
                                    frame: 0,
                                    anchorX: .7,
                                    anchorY: 2.55,
                                    tileAnchorX: 0,
                                    tileAnchorY: 0,
                                    sortPatch: 1,
                                    noColorize: !0,
                                    animation: {name: "smoke", frameRate: 10}
                                }]
                            }
                        }
                    }
                }
            },
            CrucibleShop: {
                iconFrame: 38,
                mask: {bodyType: 1},
                image: "crucibleShop",
                layouts: {
                    left: {
                        states: {
                            Normal: {
                                parts: [{frame: 1, anchorY: .75, anchorX: .5}, {
                                    frame: 0,
                                    anchorY: .75,
                                    anchorX: 1,
                                    tileAnchorX: -.5,
                                    tileAnchorY: 0
                                }, {frame: 2, anchorY: .75, anchorX: .5, tileAnchorX: .5, tileAnchorY: .5}, {
                                    frame: 3,
                                    anchorY: .75,
                                    anchorX: 0,
                                    tileAnchorX: 1,
                                    tileAnchorY: .5
                                }]
                            },
                            Production: {
                                parts: [{frame: 5, anchorY: .75, anchorX: .5}, {
                                    frame: 4,
                                    anchorY: .75,
                                    anchorX: 1,
                                    tileAnchorX: -.5,
                                    tileAnchorY: 0
                                }, {frame: 6, anchorY: .75, anchorX: .5, tileAnchorX: .5, tileAnchorY: .5}, {
                                    frame: 7,
                                    anchorY: .75,
                                    anchorX: 0,
                                    tileAnchorX: 1,
                                    tileAnchorY: .5
                                }]
                            }
                        }
                    },
                    right: {
                        states: {
                            Normal: {
                                parts: [{frame: 10, anchorY: .75, anchorX: .5}, {
                                    frame: 11,
                                    anchorY: .75,
                                    anchorX: 0,
                                    tileAnchorX: .5,
                                    tileAnchorY: 0
                                }, {frame: 9, anchorY: .75, anchorX: .5, tileAnchorX: -.5, tileAnchorY: .5}, {
                                    frame: 8,
                                    anchorY: .75,
                                    anchorX: 1,
                                    tileAnchorX: -1,
                                    tileAnchorY: .5
                                }]
                            },
                            Production: {
                                parts: [{frame: 14, anchorY: .75, anchorX: .5}, {
                                    frame: 15,
                                    anchorY: .75,
                                    anchorX: 0,
                                    tileAnchorX: .5,
                                    tileAnchorY: 0
                                }, {
                                    frame: 13,
                                    anchorY: .75,
                                    anchorX: .5,
                                    tileAnchorX: -.5,
                                    tileAnchorY: .5
                                }, {frame: 12, anchorY: .75, anchorX: 1, tileAnchorX: -1, tileAnchorY: .5}]
                            }
                        }
                    }
                }
            },
            LargeChest: {
                iconFrame: 28,
                image: "ironChest",
                layouts: {left: {frame: 1, anchorX: .35, anchorY: .4}, right: {frame: 0, anchorX: .65, anchorY: .4}}
            },
            SteelChest: {
                iconFrame: 29,
                image: "steelChest",
                layouts: {left: {frame: 1, anchorX: .41, anchorY: .78}, right: {frame: 0, anchorX: .49, anchorY: .78}}
            },
            ClaimMarker: {
                image: "claimMarkers",
                layouts: {
                    up: {frame: 0, anchorX: .5, anchorY: 1, sortPatch: 64},
                    left: {frame: 1, anchorX: .14, anchorY: .89, sortPatch: 64},
                    down: {frame: 2, anchorX: .5, anchorY: .78, sortPatch: 64},
                    right: {frame: 3, anchorX: .86, anchorY: .89, sortPatch: 64}
                }
            },
            DominiumBasic: {iconFrame: 2, image: "domMicro", frame: 0, anchorX: .5, anchorY: .77},
            DominiumSmall: {iconFrame: 23, image: "domSmall", frame: 0, anchorX: .5, anchorY: .77},
            DominiumMedium: {iconFrame: 24, image: "domMedium", frame: 0, anchorX: .5, anchorY: .8},
            DominiumLarge: {iconFrame: 25, image: "domLarge", frame: 0, anchorX: .5, anchorY: .89},
            DominiumNoble: {iconFrame: 117, image: "domNoble", frame: 0, anchorX: .48, anchorY: .895},
            BoughBed: {
                iconFrame: 1,
                image: "boughBed",
                layouts: {
                    left: {frame: 0, anchorX: .5, anchorY: .5, sortPatch: -60},
                    right: {frame: 1, anchorX: .5, anchorY: .5, sortPatch: -60}
                }
            },
            KipBench: {
                iconFrame: 40,
                image: "kipBench",
                layouts: {
                    left: {frame: 1, anchorX: .5, anchorY: .55, sortPatch: -60},
                    right: {frame: 0, anchorX: .5, anchorY: .55, sortPatch: -60}
                }
            },
            WorkBench: {
                iconFrame: 12,
                image: "slicedMediumStructures",
                layouts: {
                    left: {
                        anchorX: .5,
                        anchorY: .57,
                        parts: [{frame: 2, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 3,
                            tileAnchorX: .5,
                            tileAnchorY: .5
                        }]
                    },
                    right: {
                        anchorX: .5,
                        anchorY: .55,
                        parts: [{frame: 0, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 1,
                            tileAnchorX: -.5,
                            tileAnchorY: .5
                        }]
                    }
                }
            },
            StoneAnvil: {iconFrame: 15, image: "anvils", frame: 0, anchorX: .5, anchorY: .8},
            Millstones: {iconFrame: 16, image: "millstone", frame: 0, anchorX: .5, anchorY: .6},
            IronAnvil: {iconFrame: 33, image: "anvils", frame: 1, anchorX: .5, anchorY: .8},
            SteelAnvil: {iconFrame: 39, image: "anvils", frame: 2, anchorX: .5, anchorY: .8},
            WoodenChair: {
                iconFrame: 43,
                image: "smallStructures",
                anchorX: .35,
                anchorY: .85,
                layouts: {left: {frame: 3}, right: {frame: 2}}
            },
            NobleTable: {
                iconFrame: 124,
                image: "nobleTable",
                layouts: {
                    left: {
                        anchorX: .4,
                        anchorY: .6,
                        parts: [{frame: 5, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 4,
                            tileAnchorX: -.5,
                            tileAnchorY: .5,
                            anchorX: .62
                        }]
                    },
                    leftFull: {
                        anchorX: .4,
                        anchorY: .6,
                        parts: [{frame: 7, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 6,
                            tileAnchorX: -.5,
                            tileAnchorY: .5,
                            anchorX: .62
                        }]
                    },
                    right: {
                        anchorX: .6,
                        anchorY: .625,
                        parts: [{frame: 0, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 1,
                            tileAnchorX: .5,
                            tileAnchorY: .5,
                            anchorX: .38
                        }]
                    },
                    rightFull: {
                        anchorX: .6,
                        anchorY: .625,
                        parts: [{frame: 2, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 3,
                            tileAnchorX: .5,
                            tileAnchorY: .5,
                            anchorX: .38
                        }]
                    }
                }
            },
            NobleBench: {
                iconFrame: 125,
                image: "nobleBench",
                layouts: {
                    left: {
                        anchorX: .5,
                        anchorY: .7,
                        parts: [{frame: 3, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 2,
                            tileAnchorX: -.5,
                            tileAnchorY: .5,
                            anchorX: .64
                        }]
                    },
                    right: {
                        anchorX: .5,
                        anchorY: .7,
                        parts: [{frame: 0, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 1,
                            tileAnchorX: .5,
                            tileAnchorY: .5,
                            anchorX: .34
                        }]
                    },
                    leftDrop: {
                        anchorX: .4,
                        anchorY: .55,
                        parts: [{frame: 7, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 6,
                            tileAnchorX: -.5,
                            tileAnchorY: .5,
                            anchorX: .68
                        }]
                    },
                    rightDrop: {
                        anchorX: .6,
                        anchorY: .6,
                        parts: [{frame: 4, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 5,
                            tileAnchorX: .5,
                            tileAnchorY: .5,
                            anchorX: .55
                        }]
                    }
                }
            },
            WoodenTable: {
                iconFrame: 42,
                image: "slicedMediumStructures",
                layouts: {
                    left: {
                        anchorX: .4,
                        anchorY: .6,
                        parts: [{frame: 10, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 11,
                            tileAnchorX: .5,
                            tileAnchorY: .5
                        }]
                    },
                    right: {
                        anchorX: .6,
                        anchorY: .57,
                        parts: [{frame: 8, tileAnchorX: 0, tileAnchorY: 0}, {
                            frame: 9,
                            tileAnchorX: -.5,
                            tileAnchorY: .5
                        }]
                    }
                }
            }
        }, this.getType = function (a) {
            return this._atlas[a] ? this._atlas[a] : (console.warn("Atlas not exist for object", a), this._atlas.UnknownObject)
        }, this.getImageSource = function (a) {
            return this._atlas[a] ? this._atlas[a].src : (console.warn("Atlas not exist for object", a), this._atlas.UnknownObject.src)
        }, this._getAllPartsOrSections = function (a, b, c) {
            var d, e, f, g, h = [], i = {}, j = this._atlas[a];
            if (j) {
                i.imageName = j.image, i.frameIndex = j.frame, i.anchorX = j.anchorX, i.anchorY = j.anchorY, i.shadow = j.shadow;
                var k, l, m;
                if ("undefined" != typeof j.rndFrames && (i.frameIndex += Math.floor(Math.random() * j.rndFrames)), i.shadow = j.shadow, j.layouts && ("undefined" != typeof b ? m = j.layouts[b] : (f = Object.keys(j.layouts), m = j.layouts[f[0]])), m ? (m.image && (i.imageName = m.image), "undefined" != typeof m.frame && (i.frameIndex = m.frame, "undefined" != typeof m.rndFrames && (i.frameIndex += Math.floor(Math.random() * m.rndFrames))), "undefined" != typeof m.anchorX && (i.anchorX = m.anchorX), "undefined" != typeof m.anchorY && (i.anchorY = m.anchorY), m.parts && (k = m.parts), m.states && ("undefined" != typeof c ? l = m.states[c] : (g = Object.keys(m.states), l = m.states[g[0]]))) : j.states ? "undefined" != typeof c ? l = j.states[c] : (g = Object.keys(j.states), l = j.states[g[0]]) : j.parts && (k = j.parts), l && (l.image && (i.imageName = l.image), "undefined" != typeof l.frame && (i.frameIndex = l.frame, "undefined" != typeof l.rndFrames && (i.frameIndex += Math.floor(Math.random() * l.rndFrames))), "undefined" != typeof l.anchorX && (i.anchorX = l.anchorX), "undefined" != typeof l.anchorY && (i.anchorY = l.anchorY), l.parts && (k = l.parts)), k)for (d = 0, e = k.length; e > d; d++) {
                    var n = k[d];
                    if (n.image && (i.imageName = n.image), "undefined" != typeof n.frame && (i.frameIndex = n.frame, "undefined" != typeof n.rndFrames && (i.frameIndex += Math.floor(Math.random() * n.rndFrames))), "undefined" != typeof n.anchorX && (i.anchorX = n.anchorX), "undefined" != typeof n.anchorY && (i.anchorY = n.anchorY), "undefined" != typeof n.tileAnchorX && (i.tileAnchorX = n.tileAnchorX), "undefined" != typeof n.tileAnchorY && (i.tileAnchorY = n.tileAnchorY), h.push(i), e > d) {
                        var o = {};
                        i.imageName && (o.imageName = i.imageName), "undefined" != typeof i.frameIndex && (o.frameIndex = i.frameIndex), "undefined" != typeof i.anchorX && (o.anchorX = i.anchorX), "undefined" != typeof i.anchorY && (o.anchorY = i.anchorY), "undefined" != typeof i.tileAnchorX && (o.tileAnchorX = i.tileAnchorX), "undefined" != typeof i.tileAnchorY && (o.tileAnchorY = i.tileAnchorY), i.shadow && (o.shadow = i.shadow), i = o
                    }
                } else h.push(i)
            } else {
                var p = KME.types.worldTypes[a];
                if (!p)return console.error("No world type in WorldAtlas._getAllPartsOrSections", a, b, c), null;
                var q, r;
                if (p.layouts && ("undefined" != typeof b ? r = p.layouts[b] : (f = Object.keys(p.layouts), r = p.layouts[f[0]])), q = r ? r.section : p.section, !q)return console.error("No sections in WorldAtlas._getAllPartsOrSections", a, b, c), null;
                for (d = 0, e = q.length; e > d; d++) {
                    var s = q[d], t = this._getAllPartsOrSections(s.typeName, s.layout);
                    if (t) {
                        for (var u = 0, v = t.length; v > u; u++) {
                            var w = t[u];
                            "undefined" != typeof s.anchorX && ("undefined" == typeof w.tileAnchorX && (w.tileAnchorX = 0), w.tileAnchorX += s.anchorX), "undefined" != typeof s.anchorY && ("undefined" == typeof w.tileAnchorY && (w.tileAnchorY = 0), w.tileAnchorY += s.anchorY)
                        }
                        h = h.concat(t)
                    }
                }
            }
            return h
        }, this._createIconImageSource = function (a) {
            var c = this._atlas[a], d = c.iconFrame ? c.iconFrame : 0, e = b.cache.getImage("buildIcons"), f = b.cache.getFrameByIndex("buildIcons", d), g = document.createElement("canvas");
            g.width = f.width, g.height = f.height;
            var h = g.getContext("2d");
            return h.drawImage(e, f.x, f.y, f.width, f.height, 0, 0, f.width, f.height), g.toDataURL()
        }, this._treeBuildItemParse = function (a, b) {
            var c = this;
            Object.keys(a).forEach(function (d) {
                var e = a[d];
                "undefined" != typeof e.typeName && (e.imageSource = c._createIconImageSource(e.typeName), b[e.typeName].imageSource = e.imageSource), "undefined" != typeof e.children && c._treeBuildItemParse(e.children, b)
            })
        }, this.createBuildImageSources = function (a) {
            this._treeBuildItemParse(a.tree, a.buildTypes)
        }, this._getHLS = function (a, c, d, e, f) {
            var g, h, i, j = a + "_" + c + "_" + d + "_" + e + "_" + f;
            return this.game.cache.checkBitmapDataKey(j) ? g = this.game.cache.getBitmapData(j) : (h = this.game.cache.getImage(a), i = this.game.cache.getFrameByIndex(a, c), g = new Phaser.BitmapData(b, null, i.width, i.height), g.context.drawImage(h, i.x, i.y, i.width, i.height, 0, 0, i.width, i.height), g.update(), g.shiftHSL(d, e, f), this.game.cache.addBitmapData(j, g)), g
        }, this._createSprite = function (a, c, d, e) {
            var f = new Phaser.Sprite(b, 0, 0, a, c);
            return f.anchor.x = d, f.anchor.y = e, f
        }, this.createOrLoadSprite = function (a, b, c, d, e) {
            var f = this.game.cache._cache.image[a];
            if (f)e(this._createSprite(a, b, c, d)); else {
                var g = this;
                KME.utils.assets.loadDynamicImage(a, function () {
                    e(g._createSprite(a, b, c, d))
                })
            }
        }, this.createEffect = function (a, b, c, d) {
            this.createOrLoadSprite(a.image, 0, a.anchorX, a.anchorY, function (e) {
                e.x = b, e.y = c, e.animations.add(a.image), e.animations.play(a.image, a.frameRate, !1), e.events.onAnimationComplete.add(function () {
                    e.destroy()
                }, this), d(e)
            })
        }, this.createWorldSprite = function (a, b, c, d, e, f, g) {
            var h = this.game.cache._cache.image[a];
            if (h)g(this._createOrUpdateSprite(null, a, b, c, d, e, f)); else {
                var i = this;
                KME.utils.assets.loadDynamicImage(a, function () {
                    g(i._createOrUpdateSprite(null, a, b, c, d, e, f))
                })
            }
        }, this._createOrUpdateSprite = function (a, b, c, d, e, f, g) {
            var h, i, j;
            return f ? (i = this.game.cache.getImage(b), j = this.game.cache.getFrameByIndex(b, c), h = new Phaser.BitmapData(this.game, null, j.width + f.offsetX, j.height + f.offsetY), h.context.shadowBlur = 0, h.context.shadowOffsetX = f.offsetX, h.context.shadowOffsetY = f.offsetY, h.context.shadowColor = "rgba(0,0,0,0.6)", h.context.drawImage(i, j.x, j.y, j.width, j.height, 0, 0, j.width, j.height), d = d * j.width / (j.width + f.offsetX), e = e * j.height / (j.height + f.offsetY)) : g && (g.markerEnemy ? h = this._getHLS(b, c, -.35, null, null) : g.markerPlace ? h = this._getHLS(b, c, -.17, null, null) : g.abandoned ? h = this._getHLS(b, c, null, g.darkLevel * this.darkLevel + this.satStartLevel, g.darkLevel * this.darkLevel + this.lStartLevel) : g.darkLevel && (h = this._getHLS(b, c, null, g.darkLevel * this.darkLevel, g.darkLevel * this.darkLevel))), a ? h ? a.loadTexture(h) : a.loadTexture(b, c) : a = h ? new Phaser.Sprite(this.game, 0, 0, h) : new Phaser.Sprite(this.game, 0, 0, b, c), a.anchor.x = d, a.anchor.y = e, a.imageName = b, a
        }, this.createWorldAngleSprite = function (a, b, c, d) {
            var e = this._atlas[a], f = e.image, g = e.frame, h = e.anchorX, i = e.anchorY;
            "undefined" != typeof e.rndFrames && (g += Math.floor(Math.random() * e.rndFrames));
            var j = e.shadow;
            if ("undefined" != typeof b) {
                var k = e.layouts[b];
                k.image && (f = k.image), "undefined" != typeof k.frame && (g = k.frame), "undefined" != typeof k.anchorX && (h = k.anchorX), "undefined" != typeof k.anchorY && (i = k.anchorY)
            }
            var l = this.game.cache._cache.image[f];
            if (l)d(this._createOrUpdateAngleSprite(null, f, g, h, i, j, c)); else {
                var m = this._createVoidWorldSprite(f, h, i), n = this;
                d(m), KME.utils.assets.loadDynamicImage(f, function () {
                    n._createOrUpdateAngleSprite(m, f, g, h, i, j, c)
                })
            }
        }, this._createOrUpdateAngleSprite = function (a, b, c, d, e, f, g) {
            var h, i = this.game.cache.getImage(b), j = this.game.cache.getFrameByIndex(b, c);
            return f ? (h = new Phaser.BitmapData(this.game, null, 2 * j.width + f.offsetX, 2 * j.width + f.offsetY), h.context.translate(j.width, j.width), h.context.rotate(g), h.context.shadowOffsetX = f.offsetX, h.context.shadowOffsetY = f.offsetY, h.context.shadowColor = "rgba(0,0,0,0.6)", h.context.drawImage(i, j.x, j.y, j.width, j.height, 0, -j.height / 2, j.width, j.height), d = d * j.width * 2 / (2 * j.width + f.offsetX), e = e * j.width * 2 / (2 * j.width + f.offsetY)) : (h = new Phaser.BitmapData(this.game, null, 2 * j.width, 2 * j.width), h.context.translate(j.width, j.width), h.context.rotate(g), h.context.drawImage(i, j.x, j.y, j.width, j.height, 0, -j.height / 2, j.width, j.height)), a ? a.loadTexture(h) : a = new Phaser.Sprite(this.game, 0, 0, h), a.anchor.x = d, a.anchor.y = e, a.imageName = b, a
        }, this.getAnimation = function (a, b, c) {
            var d, e = this._atlas[a], f = e.animation;
            if ("undefined" != typeof b) {
                var g = e.layouts[b];
                g.animation && (f = g.animation), g.states && "undefined" != typeof c && (d = g.states[c])
            } else e.states && "undefined" != typeof c && (d = e.states[c]);
            return d && d.animation && (f = d.animation), f
        }, this.createSpriteByType = function (b, c, d, e, f) {
            var g = this._atlas[b];
            ("undefined" == typeof g || g.render) && (console.warn("No image for object", b), c = void 0, d = void 0, g = this._atlas.UnknownObject);
            var h, i = g.image, j = g.frame, k = g.anchorX, l = g.anchorY, m = g.sortPatch, n = g.animation;
            "undefined" != typeof g.rndFrames && (j += Math.floor(Math.random() * g.rndFrames));
            var o, p, q = g.shadow;
            if ("undefined" != typeof c) {
                var r = g.layouts[c];
                r.image && (i = r.image), "undefined" != typeof r.frame && (j = r.frame, "undefined" != typeof r.rndFrames && (j += Math.floor(Math.random() * r.rndFrames))), "undefined" != typeof r.anchorX && (k = r.anchorX), "undefined" != typeof r.anchorY && (l = r.anchorY), "undefined" != typeof r.animation && (n = r.animation), r.parts && (h = r.parts), m = r.sortPatch, r.states && ("undefined" != typeof d ? o = r.states[d] : (p = Object.keys(r.states), o = r.states[p[0]]))
            } else g.states ? "undefined" != typeof d ? o = g.states[d] : (p = Object.keys(g.states), o = g.states[p[0]]) : g.parts && (h = g.parts);
            if (o && (o.image && (i = o.image), "undefined" != typeof o.frame && (j = o.frame, "undefined" != typeof o.rndFrames && (j += Math.floor(Math.random() * o.rndFrames))), "undefined" != typeof o.anchorX && (k = o.anchorX), "undefined" != typeof o.anchorY && (l = o.anchorY), o.parts && (h = o.parts), m = o.sortPatch), h) {
                var s = this;
                a.mapSeries(h, function (a, b) {
                    a.image && (i = a.image), "undefined" != typeof a.frame && (j = a.frame),
                    "undefined" != typeof a.rndFrames && (j += Math.floor(Math.random() * a.rndFrames)), "undefined" != typeof a.anchorX && (k = a.anchorX), "undefined" != typeof a.anchorY && (l = a.anchorY), m = a.sortPatch, s.createWorldSprite(i, j, k, l, q, a.noColorize ? null : e, function (a) {
                        a.sortPatch = m, b(null, a)
                    })
                }, function (a, b) {
                    f(b)
                })
            } else this.createWorldSprite(i, j, k, l, q, e, function (a) {
                a.sortPatch = m, n && (a.animations.add(n.name), a.animations.play(n.name, n.frameRate, !0)), f(a)
            })
        }, this.getPartsArray = function (a, b, c) {
            var d, e, f = this._atlas[a], g = f.parts;
            if ("undefined" != typeof b) {
                var h = f.layouts[b];
                h.parts && (g = h.parts), h.states && ("undefined" != typeof c ? d = h.states[c] : (e = Object.keys(h.states), d = h.states[e[0]]))
            } else f.states && ("undefined" != typeof c ? d = f.states[c] : (e = Object.keys(f.states), d = f.states[e[0]]));
            return d && d.parts && (g = d.parts), g
        }
    }
}),define("KME/data/world/WorldObject", ["phaser", "jquery", "i18next"], function () {
    function a(a) {
        var e = Math.floor(a / d);
        return b > e && (e = b), e > c && (e = c), e
    }

    var b = 50, c = 100, d = 150, e = 3, f = {
        font: "14px Arial",
        fill: "#FFFFFF",
        stroke: "black",
        strokeThickness: 1,
        align: "center"
    }, g = {font: "bold 12px Arial", fill: "#FFFFFF", stroke: "black", strokeThickness: 1, align: "center"};
    KME.world.WorldObject = function (a, b, c, d, e, f) {
        this.KMEGame = a, this.game = b, this.autoCull = !0, this.normalPoint = a.map.getNormalFromWorld(c, d), "undefined" == typeof f && (f = 1), this.floorIndex = f, Phaser.Group.call(this, b, KME.world.map.objectGroups.getOrCreateTileGroup(f, this.normalPoint)), this.name = e, this.sortPatch = 0, this.x = c, this.y = d, this.checkCollide = !1, this.isMovedNeedCheck = !0
    }, KME.world.WorldObject.prototype = Object.create(Phaser.Group.prototype), KME.world.WorldObject.prototype.constructor = KME.world.WorldObject, KME.world.WorldObject.prototype.getName = function (a) {
        return KME.types.itemTypes[a] ? $.t("objects:items." + a) : $.t("objects:world." + a)
    }, KME.world.WorldObject.prototype.getType = function (a) {
        return KME.types.worldTypes[a]
    }, KME.world.WorldObject.prototype.isPathFindNotWalkable = function () {
        return this.body && this.body.moveBlock || this.partMoveBlock
    }, KME.world.WorldObject.prototype.isRotating = function (a) {
        return "undefined" != typeof a.layouts
    }, KME.world.WorldObject.prototype.objectRotate = function (a) {
        var b = KME.types.worldTypes[a.typeName], c = b.layouts[a.layout];
        if (c.rotateTo)a.layout = c.rotateTo; else {
            var d = Object.keys(b.layouts), e = d.indexOf(a.layout);
            e++, e === d.length && (e = 0), a.layout = d[e]
        }
    }, KME.world.WorldObject.prototype.getSectionArray = function (a) {
        return "undefined" != typeof a.layout && KME.types.worldTypes[a.typeName].layouts ? KME.types.worldTypes[a.typeName].layouts[a.layout].section : KME.types.worldTypes[a.typeName].section
    }, KME.world.WorldObject.prototype.setLayoutAndStateIfNeeded = function (a) {
        var b = KME.types.worldTypes[a.typeName];
        if (b.defaults && (b.defaults.state && "undefined" == typeof a.currentState && (a.currentState = b.defaults.state), b.defaults.layout && "undefined" == typeof a.layout)) {
            var c = b.defaults.layout;
            if ("random" === c) {
                var d = [];
                Object.keys(b.layouts).forEach(function (a) {
                    d.push(a)
                }), a.layout = d[Math.floor(d.length * Math.random())]
            } else c instanceof Array ? a.layout = void 0 : a.layout = c
        }
    }, KME.world.WorldObject.prototype._getBodyFields = function (a, b) {
        return b && ("undefined" == typeof a && (a = {}), Object.keys(b).forEach(function (c) {
            a[c] = b[c]
        })), a
    }, KME.world.WorldObject.prototype.getBody = function (a, b, c) {
        var d, e, f, g = KME.types.worldTypes[a];
        return d = this._getBodyFields(d, g.body), g.border && (d.wallShape = !0), "undefined" != typeof b ? g.layouts && (d = this._getBodyFields(d, g.layouts[b].body), e = g.layouts[b].states) : g.layouts ? e = g.layouts.states : g.states && (e = g.states), e && ("undefined" != typeof c ? d = this._getBodyFields(d, e[c].body) : (f = Object.keys(e), d = this._getBodyFields(d, e[f[0]].body))), "undefined" == typeof d ? null : d
    }, KME.world.WorldObject.prototype.bodyInit = function (a) {
        this.bodyRemove(), this.body = new Phaser.BodyIsometric(this.game, this, a), this.KMEGame.map.addCollisionObject(this);
        var b, c, d;
        if (this.partsObjects)for (b = 0, c = this.partsObjects.length; c > b; b++)d = this.partsObjects[b], d.partMoveBlock && this.KMEGame.map.addCollisionObject(d);
        this.bodySprite && (this.bodySprite.destroy(), this.bodySprite = null), this.anchorSprite && (this.anchorSprite.destroy(), this.anchorSprite = null), this.bodyShowCheck(), this.anchorShowCheck()
    }, KME.world.WorldObject.prototype.bodyRemove = function () {
        (this.body || this.partMoveBlock) && this.KMEGame.map.removeCollisionObject(this)
    }, KME.world.WorldObject.prototype.anchorShowCheck = function () {
        if (this.KMEGame.anchorDebug)if (this.anchorSprite)this.anchorSprite.visible = !0; else {
            this.createInterfaceElements();
            var a = 0;
            this.sortPatch && (a += this.sortPatch), this.anchorSprite = this.interfaceElements.add(new Phaser.Graphics(this.game, 0, a)), this.anchorSprite.lineStyle(1, 16777215, 1), this.anchorSprite.drawRect(-1, -1, 3, 3)
        } else this.anchorSprite && (this.anchorSprite.visible = !1)
    }, KME.world.WorldObject.prototype.interfaceShowCheck = function () {
        this.KMEGame.interfaceShow ? this.objectTypeName === KME.types.worldTypes.markerTypeName ? this.visible = !0 : this.interfaceElements && (this.interfaceElements.visible = !0) : this.objectTypeName === KME.types.worldTypes.markerTypeName ? this.visible = !1 : this.interfaceElements && (this.interfaceElements.visible = !1)
    }, KME.world.WorldObject.prototype.bodyShowCheck = function () {
        this.body && (this.KMEGame.collisionDebug ? this.bodySprite ? this.bodySprite.visible = !0 : (this.createInterfaceElements(), this.bodySprite = this.interfaceElements.add(new Phaser.Sprite(this.game, 0, 0, this.body.shape)), this.bodySprite.anchor = this.body.anchor, this.bodySprite.alpha = .4) : this.bodySprite && (this.bodySprite.visible = !1))
    }, KME.world.WorldObject.prototype.isBuilt = function () {
        return this.objectTypeName ? "undefined" != typeof KME.types.buildTypes.buildTypes[this.objectTypeName] : !1
    }, KME.world.WorldObject.prototype.createTileIndexObject = function (a) {
        var b, c, d, e;
        if (a.tileIndex >= KME.utils.worldatlas.tileIndexes.tallObjects.from && a.tileIndex < KME.utils.worldatlas.tileIndexes.tallObjects.to)b = "tallObjects", c = a.tileIndex - KME.utils.worldatlas.tileIndexes.tallObjects.from, d = KME.utils.worldatlas.tileIndexes.tallObjects.anchorX, e = KME.utils.worldatlas.tileIndexes.tallObjects.anchorY; else if (a.tileIndex >= KME.utils.worldatlas.tileIndexes.mountains.from && a.tileIndex < KME.utils.worldatlas.tileIndexes.mountains.to)b = "mountains", c = a.tileIndex - KME.utils.worldatlas.tileIndexes.mountains.from, d = KME.utils.worldatlas.tileIndexes.mountains.anchorX, e = KME.utils.worldatlas.tileIndexes.mountains.anchorY, this.canOpacity = !0; else if (a.tileIndex >= KME.utils.worldatlas.tileIndexes.bushesGrass.from && a.tileIndex < KME.utils.worldatlas.tileIndexes.bushesGrass.to)b = "bushesGrass", c = a.tileIndex - KME.utils.worldatlas.tileIndexes.bushesGrass.from, d = KME.utils.worldatlas.tileIndexes.bushesGrass.anchorX, e = KME.utils.worldatlas.tileIndexes.bushesGrass.anchorY; else {
            if (!(a.tileIndex >= KME.utils.worldatlas.tileIndexes.bushesSoil.from && a.tileIndex < KME.utils.worldatlas.tileIndexes.bushesSoil.to))return void console.error("createTileIndexObject unknown index", a.tileIndex);
            b = "bushesSoil", c = a.tileIndex - KME.utils.worldatlas.tileIndexes.bushesSoil.from, d = KME.utils.worldatlas.tileIndexes.bushesSoil.anchorX, e = KME.utils.worldatlas.tileIndexes.bushesSoil.anchorY
        }
        this.tileIndex = a.tileIndex;
        var f = this;
        KME.utils.worldatlas.createWorldSprite(b, c, d, e, null, null, function (a) {
            f.sprite = a, f.add(f.sprite)
        })
    }, KME.world.WorldObject.prototype.spriteConfigUpdate = function (b) {
        var c = !1;
        if (this.objectType.hitPoints && b.health) {
            var d;
            this.spriteConfigData || (this.spriteConfigData = {}), c = b.abandoned !== this.spriteConfigData.abandoned, b.abandoned ? (this.spriteConfigData.abandoned = !0, d = a(this.objectType.hitPoints)) : (this.spriteConfigData.abandoned = !1, d = this.objectType.hitPoints);
            var f = b.health / d, g = 3 - Math.floor(f * (e + .99));
            g > 3 && (g = 3), 0 > g && (g = 0), this.spriteConfigData.darkLevel !== g && (this.spriteConfigData.darkLevel = g, c = !0)
        }
        return c
    }, KME.world.WorldObject.prototype.createInterfaceElements = function () {
        this.interfaceElements || (this.interfaceElements = new Phaser.Group(this.game, KME.world.map.interfaceGroup), this.interfaceElementsUpdate())
    }, KME.world.WorldObject.prototype.interfaceElementsUpdate = function () {
        this.interfaceElements.x = this.x, this.interfaceElements.y = this.y
    }, KME.world.WorldObject.prototype.startHitEffect = function () {
        if (!(this instanceof KME.Character)) {
            var a, b;
            this.label ? (a = this.label.x, b = -40) : this.body ? (a = Math.floor(this.body.width / 2 - this.body.anchor.x * this.body.width), b = Math.floor(this.body.height / 2 - this.body.anchor.y * this.body.height) - 45) : (a = 0, b = -45);
            var c = this;
            KME.utils.worldatlas.createEffect(KME.utils.worldatlas.effects.hitStructure, a, b, function (a) {
                c.add(a)
            })
        }
    }, KME.world.WorldObject.prototype.getHitByExplosion = function (a) {
        var b = {
            shape: a.shape.name,
            moveBlock: !1,
            viewBlock: !1,
            doAction: !1,
            anchorX: a.shape.anchorX,
            anchorY: a.shape.anchorY
        };
        a.shape.rotate && (b.angle = this.body.newAngle);
        var c = new Phaser.BodyIsometric(this.game, this, b);
        if (c.setCollideExcludeObject(this), c.oldPos.x = c.newPos.x = this.x, c.oldPos.y = c.newPos.y = this.y, this.KMEGame.hitAreaDebug) {
            var d;
            d = new KME.world.WorldEffect(this.KMEGame, this.game, null, c.x, c.y, c.shape)
        }
        var e = KME.world.map.collisionLayer.getCollideObjects(c);
        return e.length > 1 && (e = KME.world.map.collisionLayer.hitLineSightCheck(this, e, !0)), e
    }, KME.world.WorldObject.prototype.maskAndLabelInit = function (a, b) {
        if ("undefined" == typeof b && (b = !1), this.createInterfaceElements(), !(this instanceof KME.MainPlayer)) {
            this.maskSprite && this.maskSprite.destroy(), this.label && this.label.destroy(), this.subLabel && this.subLabel.destroy();
            var c, d, e, h, i = 0;
            if (a.mask && b === !1)a.mask.bodyType ? this.body ? (d = this.body.shape, c = new Phaser.Sprite(this.game, 0, 0, d), this.maskSprite = this.add(c), this.maskSprite.anchor.x = this.body.anchor.x, this.maskSprite.anchor.y = this.body.anchor.y, this.maskSprite.inputEnabled = !0, this.maskSprite.input.pixelPerfectClick = !0, this.maskSprite.input.pixelPerfectOver = !0, this.maskSprite.input.pixelPerfectAlpha = 200) : console.error("Mask error - no body -", this.objectTypeName) : (e = "mask" + a.mask.width + "x" + a.mask.height, this.game.cache.checkBitmapDataKey(e) ? d = this.game.cache.getBitmapData(e) : (d = new Phaser.BitmapData(this.game, null, a.mask.width, a.mask.height), d.context.fillStyle = "rgba(0,255,0,1)", d.context.fillRect(0, 0, a.mask.width, a.mask.height), this.game.cache.addBitmapData(e, d)), c = new Phaser.Sprite(this.game, 0, 0, d), this.maskSprite = this.add(c), this.maskSprite.anchor.x = a.mask.anchorX, this.maskSprite.anchor.y = a.mask.anchorY, this.maskSprite.inputEnabled = !0), h = -Math.floor(this.maskSprite.height * this.maskSprite.anchor.y); else {
                var j = this.sprite.width, k = this.sprite.height, l = this.sprite.anchor.x, m = this.sprite.anchor.y;
                this.sprite.maskAddX = 0, this.sprite.maskAddY = 0;
                var n, o, p, q;
                if (this.partsObjects) {
                    var r = this.sprite.x - j * l, s = this.sprite.y - k * m, t = r + j, u = s + k;
                    for (n = 0, o = this.partsObjects.length; o > n; n++)if (q = this.partsObjects[n], p = q.sprite, !p.animations.currentAnim || !p.animations.currentAnim.isPlaying) {
                        var v = q.x - this.x + p.x - p.width * p.anchor.x, w = q.y - this.y + p.y - p.height * p.anchor.y, x = v + p.width, y = w + p.height;
                        r > v && (this.sprite.maskAddX += r - v, r = v), s > w && (this.sprite.maskAddY += s - w, s = w), x > t && (t = x), y > u && (u = y), p.maskAddX = v - r, p.maskAddY = w - s
                    }
                    j = t - r, k = u - s, l = -r / j, m = -s / k
                }
                if (e = "string" == typeof this.sprite.key ? "mask" + this.objectTypeName + "_" + this.sprite.key + "_" + this.sprite.texture.frame.x + "_" + this.sprite.texture.frame.y : "mask" + this.objectTypeName + "_" + this.currentStateName + "_" + this.currentLayout, this.game.cache.checkBitmapDataKey(e))d = this.game.cache.getBitmapData(e); else {
                    if (d = new Phaser.BitmapData(this.game, null, j, k), d.context.globalAlpha = 1, d.context.drawImage(this.sprite.texture.baseTexture.source, this.sprite.texture.frame.x, this.sprite.texture.frame.y, this.sprite.width, this.sprite.height, this.sprite.maskAddX, this.sprite.maskAddY, this.sprite.width, this.sprite.height), this.partsObjects)for (n = 0, o = this.partsObjects.length; o > n; n++)q = this.partsObjects[n], p = q.sprite, p.animations.currentAnim && p.animations.currentAnim.isPlaying || d.context.drawImage(p.texture.baseTexture.source, p.texture.frame.x, p.texture.frame.y, p.width, p.height, p.maskAddX, p.maskAddY, p.width, p.height);
                    d.context.globalCompositeOperation = "source-atop", d.context.globalAlpha = 1, d.context.fillStyle = "rgba(0,255,0, 1)", d.context.fillRect(0, 0, j, k), this.game.cache.addBitmapData(e, d)
                }
                c = new Phaser.Sprite(this.game, 0, 0, d), this.maskSprite = this.add(c), this.maskSprite.anchor = {
                    x: l,
                    y: m
                }, this.maskSprite.inputEnabled = !0, this.maskSprite.input.pixelPerfectClick = !0, this.maskSprite.input.pixelPerfectOver = !0, this.maskSprite.input.pixelPerfectAlpha = 200, h = -Math.floor(this.maskSprite.height * this.maskSprite.anchor.y * .5)
            }
            this.KMEGame.maskDebug ? this.maskSprite.alpha = .2 : this.maskSprite.alpha = 0, this.maskSprite.events.onInputDown.add(this.onClick, this), this.maskSprite.events.onInputOver.add(this.onOver, this), this.maskSprite.events.onInputOut.add(this.onOut, this), c.playerShouldMove = !0, this.body && (i = Math.floor(this.body.width / 2 - this.body.anchor.x * this.body.width)), this.label = this.interfaceElements.add(new Phaser.Text(this.game, i, h, this.name, f)), this.label.anchor.x = .5, this.label.anchor.y = 1, this.label.setShadow(0, 0, "rgb(0,0,0)", 3, !0), this.subName && (this.subLabel = this.interfaceElements.add(new Phaser.Text(this.game, i, h + 13, this.subName, g)), this.subLabel.anchor.x = .5, this.subLabel.anchor.y = 1, this.subLabel.setShadow(0, 0, "rgb(0,0,0)", 2, !0)), this.isHidingLabel() && (this.label.alpha = 0, this.subLabel && (this.subLabel.alpha = 0))
        }
    }, KME.world.WorldObject.prototype.isHidingLabel = function () {
        return !(this instanceof KME.Player)
    }, KME.world.WorldObject.prototype.onClick = function () {
        this.waitOnOverCounter = 10, this.onOut()
    }, KME.world.WorldObject.prototype.onOver = function () {
        this.game && (this.KMEGame.storeOverId(this.id), this.isHidingLabel() && (this.tween = this.game.add.tween(this.label).to({alpha: 1}, 200, Phaser.Easing.Linear.None, !0, 0, 0, !1), this.subLabel && (this.subTween = this.game.add.tween(this.subLabel).to({alpha: 1}, 200, Phaser.Easing.Linear.None, !0, 0, 0, !1))))
    }, KME.world.WorldObject.prototype.onOut = function () {
        this.game && (this.KMEGame.storeOverId(null), this.isHidingLabel() && (this.tween = this.game.add.tween(this.label).to({alpha: 0}, 200, Phaser.Easing.Linear.None, !0, 0, 0, !1), this.subLabel && (this.subTween = this.game.add.tween(this.subLabel).to({alpha: 0}, 200, Phaser.Easing.Linear.None, !0, 0, 0, !1))))
    }, KME.world.WorldObject.prototype.doAction = function (a) {
        a ? console.log(this.name + " collides with " + a.name) : console.log(this.name + " collides with block")
    }, KME.world.WorldObject.prototype.preUpdate = function () {
        this.waitOnOverCounter && this.waitOnOverCounter--, "undefined" != typeof this.body && (this.body.preUpdate(), this.checkCollide && this.body.isPositionChanged() && KME.world.map.collisionLayer.objectCollisionCheck(this)), Phaser.Group.prototype.preUpdate.apply(this, arguments)
    }, KME.world.WorldObject.prototype.postUpdate = function () {
        if ("undefined" != typeof this.body && this.body.postUpdate(), Phaser.Group.prototype.postUpdate.apply(this, arguments), "undefined" != typeof this.body && this.body.moved() || this.isMovedNeedCheck) {
            this.interfaceElements && this.interfaceElementsUpdate(), this.isMovedNeedCheck = !1;
            var a = this.KMEGame.map.getNormalFromWorld(this.x, this.y);
            a.nX !== this.normalPoint.nX || a.nY !== this.normalPoint.nY ? this.onTileChanged(a) : KME.world.map.objectGroups.needSort(this, a)
        }
    }, KME.world.WorldObject.prototype.onTileChanged = function (a) {
        this.body && this.KMEGame.map.collisionChangeTile(this, a), KME.world.map.objectGroups.changeTile(this, a), this.normalPoint = a
    }, KME.world.WorldObject.prototype.getSpeed = function () {
        return this.speed
    }, KME.world.WorldObject.prototype.destroy = function () {
        this.bodyRemove();
        var a, b;
        if ("undefined" != typeof this.partsObjects) {
            for (a = 0, b = this.partsObjects.length; b > a; a++)this.partsObjects[a].destroy();
            delete this.partsObjects
        }
        this.destroySprite(), this.interfaceElements && this.interfaceElements.destroy(), Phaser.Group.prototype.destroy.call(this)
    }, KME.world.WorldObject.prototype.destroySprite = function () {
        this.sprite && this.sprite.destroy()
    }, KME.world.WorldObject.prototype.distanceToXY = function (a, b) {
        var c = this.body.x - a, d = this.body.y - b;
        return Math.sqrt(c * c + d * d)
    }, KME.world.WorldObject.prototype.distanceTo = function (a) {
        return Math.sqrt(this.body.x - a.body.x ^ 2 + (this.body.y - a.body.y) / 2 ^ 2)
    }, KME.world.WorldObject.prototype.onSightLine = function (a) {
        return a ? !0 : !1
    }
}),function (a) {
    "function" == typeof define && define.amd ? define("jqueryui", ["jquery"], a) : a(jQuery)
}(function (a) {
    function b(b, d) {
        var e, f, g, h = b.nodeName.toLowerCase();
        return "area" === h ? (e = b.parentNode, f = e.name, b.href && f && "map" === e.nodeName.toLowerCase() ? (g = a("img[usemap='#" + f + "']")[0], !!g && c(g)) : !1) : (/input|select|textarea|button|object/.test(h) ? !b.disabled : "a" === h ? b.href || d : d) && c(b)
    }

    function c(b) {
        return a.expr.filters.visible(b) && !a(b).parents().addBack().filter(function () {
                return "hidden" === a.css(this, "visibility")
            }).length
    }

    a.ui = a.ui || {}, a.extend(a.ui, {
        version: "1.11.2",
        keyCode: {
            BACKSPACE: 8,
            COMMA: 188,
            DELETE: 46,
            DOWN: 40,
            END: 35,
            ENTER: 13,
            ESCAPE: 27,
            HOME: 36,
            LEFT: 37,
            PAGE_DOWN: 34,
            PAGE_UP: 33,
            PERIOD: 190,
            RIGHT: 39,
            SPACE: 32,
            TAB: 9,
            UP: 38
        }
    }), a.fn.extend({
        scrollParent: function (b) {
            var c = this.css("position"), d = "absolute" === c, e = b ? /(auto|scroll|hidden)/ : /(auto|scroll)/, f = this.parents().filter(function () {
                var b = a(this);
                return d && "static" === b.css("position") ? !1 : e.test(b.css("overflow") + b.css("overflow-y") + b.css("overflow-x"))
            }).eq(0);
            return "fixed" !== c && f.length ? f : a(this[0].ownerDocument || document)
        }, uniqueId: function () {
            var a = 0;
            return function () {
                return this.each(function () {
                    this.id || (this.id = "ui-id-" + ++a)
                })
            }
        }(), removeUniqueId: function () {
            return this.each(function () {
                /^ui-id-\d+$/.test(this.id) && a(this).removeAttr("id")
            })
        }
    }), a.extend(a.expr[":"], {
        data: a.expr.createPseudo ? a.expr.createPseudo(function (b) {
            return function (c) {
                return !!a.data(c, b)
            }
        }) : function (b, c, d) {
            return !!a.data(b, d[3])
        }, focusable: function (c) {
            return b(c, !isNaN(a.attr(c, "tabindex")))
        }, tabbable: function (c) {
            var d = a.attr(c, "tabindex"), e = isNaN(d);
            return (e || d >= 0) && b(c, !e)
        }
    }), a("<a>").outerWidth(1).jquery || a.each(["Width", "Height"], function (b, c) {
        function d(b, c, d, f) {
            return a.each(e, function () {
                c -= parseFloat(a.css(b, "padding" + this)) || 0, d && (c -= parseFloat(a.css(b, "border" + this + "Width")) || 0), f && (c -= parseFloat(a.css(b, "margin" + this)) || 0)
            }), c
        }

        var e = "Width" === c ? ["Left", "Right"] : ["Top", "Bottom"], f = c.toLowerCase(), g = {
            innerWidth: a.fn.innerWidth,
            innerHeight: a.fn.innerHeight,
            outerWidth: a.fn.outerWidth,
            outerHeight: a.fn.outerHeight
        };
        a.fn["inner" + c] = function (b) {
            return void 0 === b ? g["inner" + c].call(this) : this.each(function () {
                a(this).css(f, d(this, b) + "px")
            })
        }, a.fn["outer" + c] = function (b, e) {
            return "number" != typeof b ? g["outer" + c].call(this, b) : this.each(function () {
                a(this).css(f, d(this, b, !0, e) + "px")
            })
        }
    }), a.fn.addBack || (a.fn.addBack = function (a) {
        return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
    }), a("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (a.fn.removeData = function (b) {
        return function (c) {
            return arguments.length ? b.call(this, a.camelCase(c)) : b.call(this)
        }
    }(a.fn.removeData)), a.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), a.fn.extend({
        focus: function (b) {
            return function (c, d) {
                return "number" == typeof c ? this.each(function () {
                    var b = this;
                    setTimeout(function () {
                        a(b).focus(), d && d.call(b)
                    }, c)
                }) : b.apply(this, arguments)
            }
        }(a.fn.focus), disableSelection: function () {
            var a = "onselectstart" in document.createElement("div") ? "selectstart" : "mousedown";
            return function () {
                return this.bind(a + ".ui-disableSelection", function (a) {
                    a.preventDefault()
                })
            }
        }(), enableSelection: function () {
            return this.unbind(".ui-disableSelection")
        }, zIndex: function (b) {
            if (void 0 !== b)return this.css("zIndex", b);
            if (this.length)for (var c, d, e = a(this[0]); e.length && e[0] !== document;) {
                if (c = e.css("position"), ("absolute" === c || "relative" === c || "fixed" === c) && (d = parseInt(e.css("zIndex"), 10), !isNaN(d) && 0 !== d))return d;
                e = e.parent()
            }
            return 0
        }
    }), a.ui.plugin = {
        add: function (b, c, d) {
            var e, f = a.ui[b].prototype;
            for (e in d)f.plugins[e] = f.plugins[e] || [], f.plugins[e].push([c, d[e]])
        }, call: function (a, b, c, d) {
            var e, f = a.plugins[b];
            if (f && (d || a.element[0].parentNode && 11 !== a.element[0].parentNode.nodeType))for (e = 0; e < f.length; e++)a.options[f[e][0]] && f[e][1].apply(a.element, c)
        }
    };
    var d = 0, e = Array.prototype.slice;
    a.cleanData = function (b) {
        return function (c) {
            var d, e, f;
            for (f = 0; null != (e = c[f]); f++)try {
                d = a._data(e, "events"), d && d.remove && a(e).triggerHandler("remove")
            } catch (g) {
            }
            b(c)
        }
    }(a.cleanData), a.widget = function (b, c, d) {
        var e, f, g, h, i = {}, j = b.split(".")[0];
        return b = b.split(".")[1], e = j + "-" + b, d || (d = c, c = a.Widget), a.expr[":"][e.toLowerCase()] = function (b) {
            return !!a.data(b, e)
        }, a[j] = a[j] || {}, f = a[j][b], g = a[j][b] = function (a, b) {
            return this._createWidget ? void(arguments.length && this._createWidget(a, b)) : new g(a, b)
        }, a.extend(g, f, {
            version: d.version,
            _proto: a.extend({}, d),
            _childConstructors: []
        }), h = new c, h.options = a.widget.extend({}, h.options), a.each(d, function (b, d) {
            return a.isFunction(d) ? void(i[b] = function () {
                var a = function () {
                    return c.prototype[b].apply(this, arguments)
                }, e = function (a) {
                    return c.prototype[b].apply(this, a)
                };
                return function () {
                    var b, c = this._super, f = this._superApply;
                    return this._super = a, this._superApply = e, b = d.apply(this, arguments), this._super = c, this._superApply = f, b
                }
            }()) : void(i[b] = d)
        }), g.prototype = a.widget.extend(h, {widgetEventPrefix: f ? h.widgetEventPrefix || b : b}, i, {
            constructor: g,
            namespace: j,
            widgetName: b,
            widgetFullName: e
        }), f ? (a.each(f._childConstructors, function (b, c) {
            var d = c.prototype;
            a.widget(d.namespace + "." + d.widgetName, g, c._proto)
        }), delete f._childConstructors) : c._childConstructors.push(g), a.widget.bridge(b, g), g
    }, a.widget.extend = function (b) {
        for (var c, d, f = e.call(arguments, 1), g = 0, h = f.length; h > g; g++)for (c in f[g])d = f[g][c], f[g].hasOwnProperty(c) && void 0 !== d && (a.isPlainObject(d) ? b[c] = a.isPlainObject(b[c]) ? a.widget.extend({}, b[c], d) : a.widget.extend({}, d) : b[c] = d);
        return b
    }, a.widget.bridge = function (b, c) {
        var d = c.prototype.widgetFullName || b;
        a.fn[b] = function (f) {
            var g = "string" == typeof f, h = e.call(arguments, 1), i = this;
            return f = !g && h.length ? a.widget.extend.apply(null, [f].concat(h)) : f, g ? this.each(function () {
                var c, e = a.data(this, d);
                return "instance" === f ? (i = e, !1) : e ? a.isFunction(e[f]) && "_" !== f.charAt(0) ? (c = e[f].apply(e, h), c !== e && void 0 !== c ? (i = c && c.jquery ? i.pushStack(c.get()) : c, !1) : void 0) : a.error("no such method '" + f + "' for " + b + " widget instance") : a.error("cannot call methods on " + b + " prior to initialization; attempted to call method '" + f + "'")
            }) : this.each(function () {
                var b = a.data(this, d);
                b ? (b.option(f || {}), b._init && b._init()) : a.data(this, d, new c(f, this))
            }), i
        }
    }, a.Widget = function () {
    }, a.Widget._childConstructors = [], a.Widget.prototype = {
        widgetName: "widget",
        widgetEventPrefix: "",
        defaultElement: "<div>",
        options: {disabled: !1, create: null},
        _createWidget: function (b, c) {
            c = a(c || this.defaultElement || this)[0], this.element = a(c), this.uuid = d++, this.eventNamespace = "." + this.widgetName + this.uuid, this.bindings = a(), this.hoverable = a(), this.focusable = a(), c !== this && (a.data(c, this.widgetFullName, this), this._on(!0, this.element, {
                remove: function (a) {
                    a.target === c && this.destroy()
                }
            }), this.document = a(c.style ? c.ownerDocument : c.document || c), this.window = a(this.document[0].defaultView || this.document[0].parentWindow)), this.options = a.widget.extend({}, this.options, this._getCreateOptions(), b), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
        },
        _getCreateOptions: a.noop,
        _getCreateEventData: a.noop,
        _create: a.noop,
        _init: a.noop,
        destroy: function () {
            this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
        },
        _destroy: a.noop,
        widget: function () {
            return this.element
        },
        option: function (b, c) {
            var d, e, f, g = b;
            if (0 === arguments.length)return a.widget.extend({}, this.options);
            if ("string" == typeof b)if (g = {}, d = b.split("."), b = d.shift(), d.length) {
                for (e = g[b] = a.widget.extend({}, this.options[b]), f = 0; f < d.length - 1; f++)e[d[f]] = e[d[f]] || {}, e = e[d[f]];
                if (b = d.pop(), 1 === arguments.length)return void 0 === e[b] ? null : e[b];
                e[b] = c
            } else {
                if (1 === arguments.length)return void 0 === this.options[b] ? null : this.options[b];
                g[b] = c
            }
            return this._setOptions(g), this
        },
        _setOptions: function (a) {
            var b;
            for (b in a)this._setOption(b, a[b]);
            return this
        },
        _setOption: function (a, b) {
            return this.options[a] = b, "disabled" === a && (this.widget().toggleClass(this.widgetFullName + "-disabled", !!b), b && (this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus"))), this
        },
        enable: function () {
            return this._setOptions({disabled: !1})
        },
        disable: function () {
            return this._setOptions({disabled: !0})
        },
        _on: function (b, c, d) {
            var e, f = this;
            "boolean" != typeof b && (d = c, c = b, b = !1), d ? (c = e = a(c), this.bindings = this.bindings.add(c)) : (d = c, c = this.element, e = this.widget()), a.each(d, function (d, g) {
                function h() {
                    return b || f.options.disabled !== !0 && !a(this).hasClass("ui-state-disabled") ? ("string" == typeof g ? f[g] : g).apply(f, arguments) : void 0
                }

                "string" != typeof g && (h.guid = g.guid = g.guid || h.guid || a.guid++);
                var i = d.match(/^([\w:-]*)\s*(.*)$/), j = i[1] + f.eventNamespace, k = i[2];
                k ? e.delegate(k, j, h) : c.bind(j, h)
            })
        },
        _off: function (b, c) {
            c = (c || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, b.unbind(c).undelegate(c), this.bindings = a(this.bindings.not(b).get()), this.focusable = a(this.focusable.not(b).get()), this.hoverable = a(this.hoverable.not(b).get())
        },
        _delay: function (a, b) {
            function c() {
                return ("string" == typeof a ? d[a] : a).apply(d, arguments)
            }

            var d = this;
            return setTimeout(c, b || 0)
        },
        _hoverable: function (b) {
            this.hoverable = this.hoverable.add(b), this._on(b, {
                mouseenter: function (b) {
                    a(b.currentTarget).addClass("ui-state-hover")
                }, mouseleave: function (b) {
                    a(b.currentTarget).removeClass("ui-state-hover")
                }
            })
        },
        _focusable: function (b) {
            this.focusable = this.focusable.add(b), this._on(b, {
                focusin: function (b) {
                    a(b.currentTarget).addClass("ui-state-focus")
                }, focusout: function (b) {
                    a(b.currentTarget).removeClass("ui-state-focus")
                }
            })
        },
        _trigger: function (b, c, d) {
            var e, f, g = this.options[b];
            if (d = d || {}, c = a.Event(c), c.type = (b === this.widgetEventPrefix ? b : this.widgetEventPrefix + b).toLowerCase(), c.target = this.element[0], f = c.originalEvent)for (e in f)e in c || (c[e] = f[e]);
            return this.element.trigger(c, d), !(a.isFunction(g) && g.apply(this.element[0], [c].concat(d)) === !1 || c.isDefaultPrevented())
        }
    }, a.each({show: "fadeIn", hide: "fadeOut"}, function (b, c) {
        a.Widget.prototype["_" + b] = function (d, e, f) {
            "string" == typeof e && (e = {effect: e});
            var g, h = e ? e === !0 || "number" == typeof e ? c : e.effect || c : b;
            e = e || {}, "number" == typeof e && (e = {duration: e}), g = !a.isEmptyObject(e), e.complete = f, e.delay && d.delay(e.delay), g && a.effects && a.effects.effect[h] ? d[b](e) : h !== b && d[h] ? d[h](e.duration, e.easing, f) : d.queue(function (c) {
                a(this)[b](), f && f.call(d[0]), c()
            })
        }
    });
    var f = (a.widget, !1);
    a(document).mouseup(function () {
        f = !1
    });
    a.widget("ui.mouse", {
        version: "1.11.2",
        options: {cancel: "input,textarea,button,select,option", distance: 1, delay: 0},
        _mouseInit: function () {
            var b = this;
            this.element.bind("mousedown." + this.widgetName, function (a) {
                return b._mouseDown(a)
            }).bind("click." + this.widgetName, function (c) {
                return !0 === a.data(c.target, b.widgetName + ".preventClickEvent") ? (a.removeData(c.target, b.widgetName + ".preventClickEvent"), c.stopImmediatePropagation(), !1) : void 0
            }), this.started = !1
        },
        _mouseDestroy: function () {
            this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && this.document.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
        },
        _mouseDown: function (b) {
            if (!f) {
                this._mouseMoved = !1, this._mouseStarted && this._mouseUp(b), this._mouseDownEvent = b;
                var c = this, d = 1 === b.which, e = "string" == typeof this.options.cancel && b.target.nodeName ? a(b.target).closest(this.options.cancel).length : !1;
                return d && !e && this._mouseCapture(b) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
                    c.mouseDelayMet = !0
                }, this.options.delay)), this._mouseDistanceMet(b) && this._mouseDelayMet(b) && (this._mouseStarted = this._mouseStart(b) !== !1, !this._mouseStarted) ? (b.preventDefault(), !0) : (!0 === a.data(b.target, this.widgetName + ".preventClickEvent") && a.removeData(b.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (a) {
                    return c._mouseMove(a)
                }, this._mouseUpDelegate = function (a) {
                    return c._mouseUp(a)
                }, this.document.bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), b.preventDefault(), f = !0, !0)) : !0
            }
        },
        _mouseMove: function (b) {
            if (this._mouseMoved) {
                if (a.ui.ie && (!document.documentMode || document.documentMode < 9) && !b.button)return this._mouseUp(b);
                if (!b.which)return this._mouseUp(b)
            }
            return (b.which || b.button) && (this._mouseMoved = !0), this._mouseStarted ? (this._mouseDrag(b), b.preventDefault()) : (this._mouseDistanceMet(b) && this._mouseDelayMet(b) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, b) !== !1, this._mouseStarted ? this._mouseDrag(b) : this._mouseUp(b)), !this._mouseStarted)
        },
        _mouseUp: function (b) {
            return this.document.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, b.target === this._mouseDownEvent.target && a.data(b.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(b)), f = !1, !1
        },
        _mouseDistanceMet: function (a) {
            return Math.max(Math.abs(this._mouseDownEvent.pageX - a.pageX), Math.abs(this._mouseDownEvent.pageY - a.pageY)) >= this.options.distance
        },
        _mouseDelayMet: function () {
            return this.mouseDelayMet
        },
        _mouseStart: function () {
        },
        _mouseDrag: function () {
        },
        _mouseStop: function () {
        },
        _mouseCapture: function () {
            return !0
        }
    });
    !function () {
        function b(a, b, c) {
            return [parseFloat(a[0]) * (n.test(a[0]) ? b / 100 : 1), parseFloat(a[1]) * (n.test(a[1]) ? c / 100 : 1)]
        }

        function c(b, c) {
            return parseInt(a.css(b, c), 10) || 0
        }

        function d(b) {
            var c = b[0];
            return 9 === c.nodeType ? {
                width: b.width(),
                height: b.height(),
                offset: {top: 0, left: 0}
            } : a.isWindow(c) ? {
                width: b.width(),
                height: b.height(),
                offset: {top: b.scrollTop(), left: b.scrollLeft()}
            } : c.preventDefault ? {
                width: 0,
                height: 0,
                offset: {top: c.pageY, left: c.pageX}
            } : {width: b.outerWidth(), height: b.outerHeight(), offset: b.offset()}
        }

        a.ui = a.ui || {};
        var e, f, g = Math.max, h = Math.abs, i = Math.round, j = /left|center|right/, k = /top|center|bottom/, l = /[\+\-]\d+(\.[\d]+)?%?/, m = /^\w+/, n = /%$/, o = a.fn.position;
        a.position = {
            scrollbarWidth: function () {
                if (void 0 !== e)return e;
                var b, c, d = a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"), f = d.children()[0];
                return a("body").append(d), b = f.offsetWidth, d.css("overflow", "scroll"), c = f.offsetWidth, b === c && (c = d[0].clientWidth), d.remove(), e = b - c
            }, getScrollInfo: function (b) {
                var c = b.isWindow || b.isDocument ? "" : b.element.css("overflow-x"), d = b.isWindow || b.isDocument ? "" : b.element.css("overflow-y"), e = "scroll" === c || "auto" === c && b.width < b.element[0].scrollWidth, f = "scroll" === d || "auto" === d && b.height < b.element[0].scrollHeight;
                return {width: f ? a.position.scrollbarWidth() : 0, height: e ? a.position.scrollbarWidth() : 0}
            }, getWithinInfo: function (b) {
                var c = a(b || window), d = a.isWindow(c[0]), e = !!c[0] && 9 === c[0].nodeType;
                return {
                    element: c,
                    isWindow: d,
                    isDocument: e,
                    offset: c.offset() || {left: 0, top: 0},
                    scrollLeft: c.scrollLeft(),
                    scrollTop: c.scrollTop(),
                    width: d || e ? c.width() : c.outerWidth(),
                    height: d || e ? c.height() : c.outerHeight()
                }
            }
        }, a.fn.position = function (e) {
            if (!e || !e.of)return o.apply(this, arguments);
            e = a.extend({}, e);
            var n, p, q, r, s, t, u = a(e.of), v = a.position.getWithinInfo(e.within), w = a.position.getScrollInfo(v), x = (e.collision || "flip").split(" "), y = {};
            return t = d(u), u[0].preventDefault && (e.at = "left top"), p = t.width, q = t.height, r = t.offset, s = a.extend({}, r), a.each(["my", "at"], function () {
                var a, b, c = (e[this] || "").split(" ");
                1 === c.length && (c = j.test(c[0]) ? c.concat(["center"]) : k.test(c[0]) ? ["center"].concat(c) : ["center", "center"]), c[0] = j.test(c[0]) ? c[0] : "center", c[1] = k.test(c[1]) ? c[1] : "center", a = l.exec(c[0]), b = l.exec(c[1]), y[this] = [a ? a[0] : 0, b ? b[0] : 0], e[this] = [m.exec(c[0])[0], m.exec(c[1])[0]]
            }), 1 === x.length && (x[1] = x[0]), "right" === e.at[0] ? s.left += p : "center" === e.at[0] && (s.left += p / 2), "bottom" === e.at[1] ? s.top += q : "center" === e.at[1] && (s.top += q / 2), n = b(y.at, p, q), s.left += n[0], s.top += n[1], this.each(function () {
                var d, j, k = a(this), l = k.outerWidth(), m = k.outerHeight(), o = c(this, "marginLeft"), t = c(this, "marginTop"), z = l + o + c(this, "marginRight") + w.width, A = m + t + c(this, "marginBottom") + w.height, B = a.extend({}, s), C = b(y.my, k.outerWidth(), k.outerHeight());
                "right" === e.my[0] ? B.left -= l : "center" === e.my[0] && (B.left -= l / 2),
                    "bottom" === e.my[1] ? B.top -= m : "center" === e.my[1] && (B.top -= m / 2), B.left += C[0], B.top += C[1], f || (B.left = i(B.left), B.top = i(B.top)), d = {
                    marginLeft: o,
                    marginTop: t
                }, a.each(["left", "top"], function (b, c) {
                    a.ui.position[x[b]] && a.ui.position[x[b]][c](B, {
                        targetWidth: p,
                        targetHeight: q,
                        elemWidth: l,
                        elemHeight: m,
                        collisionPosition: d,
                        collisionWidth: z,
                        collisionHeight: A,
                        offset: [n[0] + C[0], n[1] + C[1]],
                        my: e.my,
                        at: e.at,
                        within: v,
                        elem: k
                    })
                }), e.using && (j = function (a) {
                    var b = r.left - B.left, c = b + p - l, d = r.top - B.top, f = d + q - m, i = {
                        target: {
                            element: u,
                            left: r.left,
                            top: r.top,
                            width: p,
                            height: q
                        },
                        element: {element: k, left: B.left, top: B.top, width: l, height: m},
                        horizontal: 0 > c ? "left" : b > 0 ? "right" : "center",
                        vertical: 0 > f ? "top" : d > 0 ? "bottom" : "middle"
                    };
                    l > p && h(b + c) < p && (i.horizontal = "center"), m > q && h(d + f) < q && (i.vertical = "middle"), g(h(b), h(c)) > g(h(d), h(f)) ? i.important = "horizontal" : i.important = "vertical", e.using.call(this, a, i)
                }), k.offset(a.extend(B, {using: j}))
            })
        }, a.ui.position = {
            fit: {
                left: function (a, b) {
                    var c, d = b.within, e = d.isWindow ? d.scrollLeft : d.offset.left, f = d.width, h = a.left - b.collisionPosition.marginLeft, i = e - h, j = h + b.collisionWidth - f - e;
                    b.collisionWidth > f ? i > 0 && 0 >= j ? (c = a.left + i + b.collisionWidth - f - e, a.left += i - c) : j > 0 && 0 >= i ? a.left = e : i > j ? a.left = e + f - b.collisionWidth : a.left = e : i > 0 ? a.left += i : j > 0 ? a.left -= j : a.left = g(a.left - h, a.left)
                }, top: function (a, b) {
                    var c, d = b.within, e = d.isWindow ? d.scrollTop : d.offset.top, f = b.within.height, h = a.top - b.collisionPosition.marginTop, i = e - h, j = h + b.collisionHeight - f - e;
                    b.collisionHeight > f ? i > 0 && 0 >= j ? (c = a.top + i + b.collisionHeight - f - e, a.top += i - c) : j > 0 && 0 >= i ? a.top = e : i > j ? a.top = e + f - b.collisionHeight : a.top = e : i > 0 ? a.top += i : j > 0 ? a.top -= j : a.top = g(a.top - h, a.top)
                }
            }, flip: {
                left: function (a, b) {
                    var c, d, e = b.within, f = e.offset.left + e.scrollLeft, g = e.width, i = e.isWindow ? e.scrollLeft : e.offset.left, j = a.left - b.collisionPosition.marginLeft, k = j - i, l = j + b.collisionWidth - g - i, m = "left" === b.my[0] ? -b.elemWidth : "right" === b.my[0] ? b.elemWidth : 0, n = "left" === b.at[0] ? b.targetWidth : "right" === b.at[0] ? -b.targetWidth : 0, o = -2 * b.offset[0];
                    0 > k ? (c = a.left + m + n + o + b.collisionWidth - g - f, (0 > c || c < h(k)) && (a.left += m + n + o)) : l > 0 && (d = a.left - b.collisionPosition.marginLeft + m + n + o - i, (d > 0 || h(d) < l) && (a.left += m + n + o))
                }, top: function (a, b) {
                    var c, d, e = b.within, f = e.offset.top + e.scrollTop, g = e.height, i = e.isWindow ? e.scrollTop : e.offset.top, j = a.top - b.collisionPosition.marginTop, k = j - i, l = j + b.collisionHeight - g - i, m = "top" === b.my[1], n = m ? -b.elemHeight : "bottom" === b.my[1] ? b.elemHeight : 0, o = "top" === b.at[1] ? b.targetHeight : "bottom" === b.at[1] ? -b.targetHeight : 0, p = -2 * b.offset[1];
                    0 > k ? (d = a.top + n + o + p + b.collisionHeight - g - f, a.top + n + o + p > k && (0 > d || d < h(k)) && (a.top += n + o + p)) : l > 0 && (c = a.top - b.collisionPosition.marginTop + n + o + p - i, a.top + n + o + p > l && (c > 0 || h(c) < l) && (a.top += n + o + p))
                }
            }, flipfit: {
                left: function () {
                    a.ui.position.flip.left.apply(this, arguments), a.ui.position.fit.left.apply(this, arguments)
                }, top: function () {
                    a.ui.position.flip.top.apply(this, arguments), a.ui.position.fit.top.apply(this, arguments)
                }
            }
        }, function () {
            var b, c, d, e, g, h = document.getElementsByTagName("body")[0], i = document.createElement("div");
            b = document.createElement(h ? "div" : "body"), d = {
                visibility: "hidden",
                width: 0,
                height: 0,
                border: 0,
                margin: 0,
                background: "none"
            }, h && a.extend(d, {position: "absolute", left: "-1000px", top: "-1000px"});
            for (g in d)b.style[g] = d[g];
            b.appendChild(i), c = h || document.documentElement, c.insertBefore(b, c.firstChild), i.style.cssText = "position: absolute; left: 10.7432222px;", e = a(i).offset().left, f = e > 10 && 11 > e, b.innerHTML = "", c.removeChild(b)
        }()
    }();
    a.ui.position;
    a.widget("ui.draggable", a.ui.mouse, {
        version: "1.11.2",
        widgetEventPrefix: "drag",
        options: {
            addClasses: !0,
            appendTo: "parent",
            axis: !1,
            connectToSortable: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            iframeFix: !1,
            opacity: !1,
            refreshPositions: !1,
            revert: !1,
            revertDuration: 500,
            scope: "default",
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            snap: !1,
            snapMode: "both",
            snapTolerance: 20,
            stack: !1,
            zIndex: !1,
            drag: null,
            start: null,
            stop: null
        },
        _create: function () {
            "original" === this.options.helper && this._setPositionRelative(), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._setHandleClassName(), this._mouseInit()
        },
        _setOption: function (a, b) {
            this._super(a, b), "handle" === a && (this._removeHandleClassName(), this._setHandleClassName())
        },
        _destroy: function () {
            return (this.helper || this.element).is(".ui-draggable-dragging") ? void(this.destroyOnClear = !0) : (this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._removeHandleClassName(), void this._mouseDestroy())
        },
        _mouseCapture: function (b) {
            var c = this.options;
            return this._blurActiveElement(b), this.helper || c.disabled || a(b.target).closest(".ui-resizable-handle").length > 0 ? !1 : (this.handle = this._getHandle(b), this.handle ? (this._blockFrames(c.iframeFix === !0 ? "iframe" : c.iframeFix), !0) : !1)
        },
        _blockFrames: function (b) {
            this.iframeBlocks = this.document.find(b).map(function () {
                var b = a(this);
                return a("<div>").css("position", "absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]
            })
        },
        _unblockFrames: function () {
            this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks)
        },
        _blurActiveElement: function (b) {
            var c = this.document[0];
            if (this.handleElement.is(b.target))try {
                c.activeElement && "body" !== c.activeElement.nodeName.toLowerCase() && a(c.activeElement).blur()
            } catch (d) {
            }
        },
        _mouseStart: function (b) {
            var c = this.options;
            return this.helper = this._createHelper(b), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), a.ui.ddmanager && (a.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(!0), this.offsetParent = this.helper.offsetParent(), this.hasFixedAncestor = this.helper.parents().filter(function () {
                    return "fixed" === a(this).css("position")
                }).length > 0, this.positionAbs = this.element.offset(), this._refreshOffsets(b), this.originalPosition = this.position = this._generatePosition(b, !1), this.originalPageX = b.pageX, this.originalPageY = b.pageY, c.cursorAt && this._adjustOffsetFromHelper(c.cursorAt), this._setContainment(), this._trigger("start", b) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), a.ui.ddmanager && !c.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b), this._normalizeRightBottom(), this._mouseDrag(b, !0), a.ui.ddmanager && a.ui.ddmanager.dragStart(this, b), !0)
        },
        _refreshOffsets: function (a) {
            this.offset = {
                top: this.positionAbs.top - this.margins.top,
                left: this.positionAbs.left - this.margins.left,
                scroll: !1,
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }, this.offset.click = {left: a.pageX - this.offset.left, top: a.pageY - this.offset.top}
        },
        _mouseDrag: function (b, c) {
            if (this.hasFixedAncestor && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(b, !0), this.positionAbs = this._convertPositionTo("absolute"), !c) {
                var d = this._uiHash();
                if (this._trigger("drag", b, d) === !1)return this._mouseUp({}), !1;
                this.position = d.position
            }
            return this.helper[0].style.left = this.position.left + "px", this.helper[0].style.top = this.position.top + "px", a.ui.ddmanager && a.ui.ddmanager.drag(this, b), !1
        },
        _mouseStop: function (b) {
            var c = this, d = !1;
            return a.ui.ddmanager && !this.options.dropBehaviour && (d = a.ui.ddmanager.drop(this, b)), this.dropped && (d = this.dropped, this.dropped = !1), "invalid" === this.options.revert && !d || "valid" === this.options.revert && d || this.options.revert === !0 || a.isFunction(this.options.revert) && this.options.revert.call(this.element, d) ? a(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {
                c._trigger("stop", b) !== !1 && c._clear()
            }) : this._trigger("stop", b) !== !1 && this._clear(), !1
        },
        _mouseUp: function (b) {
            return this._unblockFrames(), a.ui.ddmanager && a.ui.ddmanager.dragStop(this, b), this.handleElement.is(b.target) && this.element.focus(), a.ui.mouse.prototype._mouseUp.call(this, b)
        },
        cancel: function () {
            return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
        },
        _getHandle: function (b) {
            return this.options.handle ? !!a(b.target).closest(this.element.find(this.options.handle)).length : !0
        },
        _setHandleClassName: function () {
            this.handleElement = this.options.handle ? this.element.find(this.options.handle) : this.element, this.handleElement.addClass("ui-draggable-handle")
        },
        _removeHandleClassName: function () {
            this.handleElement.removeClass("ui-draggable-handle")
        },
        _createHelper: function (b) {
            var c = this.options, d = a.isFunction(c.helper), e = d ? a(c.helper.apply(this.element[0], [b])) : "clone" === c.helper ? this.element.clone().removeAttr("id") : this.element;
            return e.parents("body").length || e.appendTo("parent" === c.appendTo ? this.element[0].parentNode : c.appendTo), d && e[0] === this.element[0] && this._setPositionRelative(), e[0] === this.element[0] || /(fixed|absolute)/.test(e.css("position")) || e.css("position", "absolute"), e
        },
        _setPositionRelative: function () {
            /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative")
        },
        _adjustOffsetFromHelper: function (b) {
            "string" == typeof b && (b = b.split(" ")), a.isArray(b) && (b = {
                left: +b[0],
                top: +b[1] || 0
            }), "left" in b && (this.offset.click.left = b.left + this.margins.left), "right" in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left), "top" in b && (this.offset.click.top = b.top + this.margins.top), "bottom" in b && (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
        },
        _isRootNode: function (a) {
            return /(html|body)/i.test(a.tagName) || a === this.document[0]
        },
        _getParentOffset: function () {
            var b = this.offsetParent.offset(), c = this.document[0];
            return "absolute" === this.cssPosition && this.scrollParent[0] !== c && a.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop()), this._isRootNode(this.offsetParent[0]) && (b = {
                top: 0,
                left: 0
            }), {
                top: b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function () {
            if ("relative" !== this.cssPosition)return {top: 0, left: 0};
            var a = this.element.position(), b = this._isRootNode(this.scrollParent[0]);
            return {
                top: a.top - (parseInt(this.helper.css("top"), 10) || 0) + (b ? 0 : this.scrollParent.scrollTop()),
                left: a.left - (parseInt(this.helper.css("left"), 10) || 0) + (b ? 0 : this.scrollParent.scrollLeft())
            }
        },
        _cacheMargins: function () {
            this.margins = {
                left: parseInt(this.element.css("marginLeft"), 10) || 0,
                top: parseInt(this.element.css("marginTop"), 10) || 0,
                right: parseInt(this.element.css("marginRight"), 10) || 0,
                bottom: parseInt(this.element.css("marginBottom"), 10) || 0
            }
        },
        _cacheHelperProportions: function () {
            this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
        },
        _setContainment: function () {
            var b, c, d, e = this.options, f = this.document[0];
            return this.relativeContainer = null, e.containment ? "window" === e.containment ? void(this.containment = [a(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, a(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, a(window).scrollLeft() + a(window).width() - this.helperProportions.width - this.margins.left, a(window).scrollTop() + (a(window).height() || f.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]) : "document" === e.containment ? void(this.containment = [0, 0, a(f).width() - this.helperProportions.width - this.margins.left, (a(f).height() || f.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]) : e.containment.constructor === Array ? void(this.containment = e.containment) : ("parent" === e.containment && (e.containment = this.helper[0].parentNode), c = a(e.containment), d = c[0], void(d && (b = /(scroll|auto)/.test(c.css("overflow")), this.containment = [(parseInt(c.css("borderLeftWidth"), 10) || 0) + (parseInt(c.css("paddingLeft"), 10) || 0), (parseInt(c.css("borderTopWidth"), 10) || 0) + (parseInt(c.css("paddingTop"), 10) || 0), (b ? Math.max(d.scrollWidth, d.offsetWidth) : d.offsetWidth) - (parseInt(c.css("borderRightWidth"), 10) || 0) - (parseInt(c.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (b ? Math.max(d.scrollHeight, d.offsetHeight) : d.offsetHeight) - (parseInt(c.css("borderBottomWidth"), 10) || 0) - (parseInt(c.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relativeContainer = c))) : void(this.containment = null)
        },
        _convertPositionTo: function (a, b) {
            b || (b = this.position);
            var c = "absolute" === a ? 1 : -1, d = this._isRootNode(this.scrollParent[0]);
            return {
                top: b.top + this.offset.relative.top * c + this.offset.parent.top * c - ("fixed" === this.cssPosition ? -this.offset.scroll.top : d ? 0 : this.offset.scroll.top) * c,
                left: b.left + this.offset.relative.left * c + this.offset.parent.left * c - ("fixed" === this.cssPosition ? -this.offset.scroll.left : d ? 0 : this.offset.scroll.left) * c
            }
        },
        _generatePosition: function (a, b) {
            var c, d, e, f, g = this.options, h = this._isRootNode(this.scrollParent[0]), i = a.pageX, j = a.pageY;
            return h && this.offset.scroll || (this.offset.scroll = {
                top: this.scrollParent.scrollTop(),
                left: this.scrollParent.scrollLeft()
            }), b && (this.containment && (this.relativeContainer ? (d = this.relativeContainer.offset(), c = [this.containment[0] + d.left, this.containment[1] + d.top, this.containment[2] + d.left, this.containment[3] + d.top]) : c = this.containment, a.pageX - this.offset.click.left < c[0] && (i = c[0] + this.offset.click.left), a.pageY - this.offset.click.top < c[1] && (j = c[1] + this.offset.click.top), a.pageX - this.offset.click.left > c[2] && (i = c[2] + this.offset.click.left), a.pageY - this.offset.click.top > c[3] && (j = c[3] + this.offset.click.top)), g.grid && (e = g.grid[1] ? this.originalPageY + Math.round((j - this.originalPageY) / g.grid[1]) * g.grid[1] : this.originalPageY, j = c ? e - this.offset.click.top >= c[1] || e - this.offset.click.top > c[3] ? e : e - this.offset.click.top >= c[1] ? e - g.grid[1] : e + g.grid[1] : e, f = g.grid[0] ? this.originalPageX + Math.round((i - this.originalPageX) / g.grid[0]) * g.grid[0] : this.originalPageX, i = c ? f - this.offset.click.left >= c[0] || f - this.offset.click.left > c[2] ? f : f - this.offset.click.left >= c[0] ? f - g.grid[0] : f + g.grid[0] : f), "y" === g.axis && (i = this.originalPageX), "x" === g.axis && (j = this.originalPageY)), {
                top: j - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.offset.scroll.top : h ? 0 : this.offset.scroll.top),
                left: i - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.offset.scroll.left : h ? 0 : this.offset.scroll.left)
            }
        },
        _clear: function () {
            this.helper.removeClass("ui-draggable-dragging"), this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1, this.destroyOnClear && this.destroy()
        },
        _normalizeRightBottom: function () {
            "y" !== this.options.axis && "auto" !== this.helper.css("right") && (this.helper.width(this.helper.width()), this.helper.css("right", "auto")), "x" !== this.options.axis && "auto" !== this.helper.css("bottom") && (this.helper.height(this.helper.height()), this.helper.css("bottom", "auto"))
        },
        _trigger: function (b, c, d) {
            return d = d || this._uiHash(), a.ui.plugin.call(this, b, [c, d, this], !0), /^(drag|start|stop)/.test(b) && (this.positionAbs = this._convertPositionTo("absolute"), d.offset = this.positionAbs), a.Widget.prototype._trigger.call(this, b, c, d)
        },
        plugins: {},
        _uiHash: function () {
            return {
                helper: this.helper,
                position: this.position,
                originalPosition: this.originalPosition,
                offset: this.positionAbs
            }
        }
    }), a.ui.plugin.add("draggable", "connectToSortable", {
        start: function (b, c, d) {
            var e = a.extend({}, c, {item: d.element});
            d.sortables = [], a(d.options.connectToSortable).each(function () {
                var c = a(this).sortable("instance");
                c && !c.options.disabled && (d.sortables.push(c), c.refreshPositions(), c._trigger("activate", b, e))
            })
        }, stop: function (b, c, d) {
            var e = a.extend({}, c, {item: d.element});
            d.cancelHelperRemoval = !1, a.each(d.sortables, function () {
                var a = this;
                a.isOver ? (a.isOver = 0, d.cancelHelperRemoval = !0, a.cancelHelperRemoval = !1, a._storedCSS = {
                    position: a.placeholder.css("position"),
                    top: a.placeholder.css("top"),
                    left: a.placeholder.css("left")
                }, a._mouseStop(b), a.options.helper = a.options._helper) : (a.cancelHelperRemoval = !0, a._trigger("deactivate", b, e))
            })
        }, drag: function (b, c, d) {
            a.each(d.sortables, function () {
                var e = !1, f = this;
                f.positionAbs = d.positionAbs, f.helperProportions = d.helperProportions, f.offset.click = d.offset.click, f._intersectsWith(f.containerCache) && (e = !0, a.each(d.sortables, function () {
                    return this.positionAbs = d.positionAbs, this.helperProportions = d.helperProportions, this.offset.click = d.offset.click, this !== f && this._intersectsWith(this.containerCache) && a.contains(f.element[0], this.element[0]) && (e = !1), e
                })), e ? (f.isOver || (f.isOver = 1, f.currentItem = c.helper.appendTo(f.element).data("ui-sortable-item", !0), f.options._helper = f.options.helper, f.options.helper = function () {
                    return c.helper[0]
                }, b.target = f.currentItem[0], f._mouseCapture(b, !0), f._mouseStart(b, !0, !0), f.offset.click.top = d.offset.click.top, f.offset.click.left = d.offset.click.left, f.offset.parent.left -= d.offset.parent.left - f.offset.parent.left, f.offset.parent.top -= d.offset.parent.top - f.offset.parent.top, d._trigger("toSortable", b), d.dropped = f.element, a.each(d.sortables, function () {
                    this.refreshPositions()
                }), d.currentItem = d.element, f.fromOutside = d), f.currentItem && (f._mouseDrag(b), c.position = f.position)) : f.isOver && (f.isOver = 0, f.cancelHelperRemoval = !0, f.options._revert = f.options.revert, f.options.revert = !1, f._trigger("out", b, f._uiHash(f)), f._mouseStop(b, !0), f.options.revert = f.options._revert, f.options.helper = f.options._helper, f.placeholder && f.placeholder.remove(), d._refreshOffsets(b), c.position = d._generatePosition(b, !0), d._trigger("fromSortable", b), d.dropped = !1, a.each(d.sortables, function () {
                    this.refreshPositions()
                }))
            })
        }
    }), a.ui.plugin.add("draggable", "cursor", {
        start: function (b, c, d) {
            var e = a("body"), f = d.options;
            e.css("cursor") && (f._cursor = e.css("cursor")), e.css("cursor", f.cursor)
        }, stop: function (b, c, d) {
            var e = d.options;
            e._cursor && a("body").css("cursor", e._cursor)
        }
    }), a.ui.plugin.add("draggable", "opacity", {
        start: function (b, c, d) {
            var e = a(c.helper), f = d.options;
            e.css("opacity") && (f._opacity = e.css("opacity")), e.css("opacity", f.opacity)
        }, stop: function (b, c, d) {
            var e = d.options;
            e._opacity && a(c.helper).css("opacity", e._opacity)
        }
    }), a.ui.plugin.add("draggable", "scroll", {
        start: function (a, b, c) {
            c.scrollParentNotHidden || (c.scrollParentNotHidden = c.helper.scrollParent(!1)), c.scrollParentNotHidden[0] !== c.document[0] && "HTML" !== c.scrollParentNotHidden[0].tagName && (c.overflowOffset = c.scrollParentNotHidden.offset())
        }, drag: function (b, c, d) {
            var e = d.options, f = !1, g = d.scrollParentNotHidden[0], h = d.document[0];
            g !== h && "HTML" !== g.tagName ? (e.axis && "x" === e.axis || (d.overflowOffset.top + g.offsetHeight - b.pageY < e.scrollSensitivity ? g.scrollTop = f = g.scrollTop + e.scrollSpeed : b.pageY - d.overflowOffset.top < e.scrollSensitivity && (g.scrollTop = f = g.scrollTop - e.scrollSpeed)), e.axis && "y" === e.axis || (d.overflowOffset.left + g.offsetWidth - b.pageX < e.scrollSensitivity ? g.scrollLeft = f = g.scrollLeft + e.scrollSpeed : b.pageX - d.overflowOffset.left < e.scrollSensitivity && (g.scrollLeft = f = g.scrollLeft - e.scrollSpeed))) : (e.axis && "x" === e.axis || (b.pageY - a(h).scrollTop() < e.scrollSensitivity ? f = a(h).scrollTop(a(h).scrollTop() - e.scrollSpeed) : a(window).height() - (b.pageY - a(h).scrollTop()) < e.scrollSensitivity && (f = a(h).scrollTop(a(h).scrollTop() + e.scrollSpeed))), e.axis && "y" === e.axis || (b.pageX - a(h).scrollLeft() < e.scrollSensitivity ? f = a(h).scrollLeft(a(h).scrollLeft() - e.scrollSpeed) : a(window).width() - (b.pageX - a(h).scrollLeft()) < e.scrollSensitivity && (f = a(h).scrollLeft(a(h).scrollLeft() + e.scrollSpeed)))), f !== !1 && a.ui.ddmanager && !e.dropBehaviour && a.ui.ddmanager.prepareOffsets(d, b)
        }
    }), a.ui.plugin.add("draggable", "snap", {
        start: function (b, c, d) {
            var e = d.options;
            d.snapElements = [], a(e.snap.constructor !== String ? e.snap.items || ":data(ui-draggable)" : e.snap).each(function () {
                var b = a(this), c = b.offset();
                this !== d.element[0] && d.snapElements.push({
                    item: this,
                    width: b.outerWidth(),
                    height: b.outerHeight(),
                    top: c.top,
                    left: c.left
                })
            })
        }, drag: function (b, c, d) {
            var e, f, g, h, i, j, k, l, m, n, o = d.options, p = o.snapTolerance, q = c.offset.left, r = q + d.helperProportions.width, s = c.offset.top, t = s + d.helperProportions.height;
            for (m = d.snapElements.length - 1; m >= 0; m--)i = d.snapElements[m].left - d.margins.left, j = i + d.snapElements[m].width, k = d.snapElements[m].top - d.margins.top, l = k + d.snapElements[m].height, i - p > r || q > j + p || k - p > t || s > l + p || !a.contains(d.snapElements[m].item.ownerDocument, d.snapElements[m].item) ? (d.snapElements[m].snapping && d.options.snap.release && d.options.snap.release.call(d.element, b, a.extend(d._uiHash(), {snapItem: d.snapElements[m].item})), d.snapElements[m].snapping = !1) : ("inner" !== o.snapMode && (e = Math.abs(k - t) <= p, f = Math.abs(l - s) <= p, g = Math.abs(i - r) <= p, h = Math.abs(j - q) <= p, e && (c.position.top = d._convertPositionTo("relative", {
                top: k - d.helperProportions.height,
                left: 0
            }).top), f && (c.position.top = d._convertPositionTo("relative", {
                top: l,
                left: 0
            }).top), g && (c.position.left = d._convertPositionTo("relative", {
                top: 0,
                left: i - d.helperProportions.width
            }).left), h && (c.position.left = d._convertPositionTo("relative", {
                top: 0,
                left: j
            }).left)), n = e || f || g || h, "outer" !== o.snapMode && (e = Math.abs(k - s) <= p, f = Math.abs(l - t) <= p, g = Math.abs(i - q) <= p, h = Math.abs(j - r) <= p, e && (c.position.top = d._convertPositionTo("relative", {
                top: k,
                left: 0
            }).top), f && (c.position.top = d._convertPositionTo("relative", {
                top: l - d.helperProportions.height,
                left: 0
            }).top), g && (c.position.left = d._convertPositionTo("relative", {
                top: 0,
                left: i
            }).left), h && (c.position.left = d._convertPositionTo("relative", {
                top: 0,
                left: j - d.helperProportions.width
            }).left)), !d.snapElements[m].snapping && (e || f || g || h || n) && d.options.snap.snap && d.options.snap.snap.call(d.element, b, a.extend(d._uiHash(), {snapItem: d.snapElements[m].item})), d.snapElements[m].snapping = e || f || g || h || n)
        }
    }), a.ui.plugin.add("draggable", "stack", {
        start: function (b, c, d) {
            var e, f = d.options, g = a.makeArray(a(f.stack)).sort(function (b, c) {
                return (parseInt(a(b).css("zIndex"), 10) || 0) - (parseInt(a(c).css("zIndex"), 10) || 0)
            });
            g.length && (e = parseInt(a(g[0]).css("zIndex"), 10) || 0, a(g).each(function (b) {
                a(this).css("zIndex", e + b)
            }), this.css("zIndex", e + g.length))
        }
    }), a.ui.plugin.add("draggable", "zIndex", {
        start: function (b, c, d) {
            var e = a(c.helper), f = d.options;
            e.css("zIndex") && (f._zIndex = e.css("zIndex")), e.css("zIndex", f.zIndex)
        }, stop: function (b, c, d) {
            var e = d.options;
            e._zIndex && a(c.helper).css("zIndex", e._zIndex)
        }
    });
    a.ui.draggable;
    a.widget("ui.droppable", {
        version: "1.11.2",
        widgetEventPrefix: "drop",
        options: {
            accept: "*",
            activeClass: !1,
            addClasses: !0,
            greedy: !1,
            hoverClass: !1,
            scope: "default",
            tolerance: "intersect",
            activate: null,
            deactivate: null,
            drop: null,
            out: null,
            over: null
        },
        _create: function () {
            var b, c = this.options, d = c.accept;
            this.isover = !1, this.isout = !0, this.accept = a.isFunction(d) ? d : function (a) {
                return a.is(d)
            }, this.proportions = function () {
                return arguments.length ? void(b = arguments[0]) : b ? b : b = {
                    width: this.element[0].offsetWidth,
                    height: this.element[0].offsetHeight
                }
            }, this._addToManager(c.scope), c.addClasses && this.element.addClass("ui-droppable")
        },
        _addToManager: function (b) {
            a.ui.ddmanager.droppables[b] = a.ui.ddmanager.droppables[b] || [], a.ui.ddmanager.droppables[b].push(this)
        },
        _splice: function (a) {
            for (var b = 0; b < a.length; b++)a[b] === this && a.splice(b, 1)
        },
        _destroy: function () {
            var b = a.ui.ddmanager.droppables[this.options.scope];
            this._splice(b), this.element.removeClass("ui-droppable ui-droppable-disabled")
        },
        _setOption: function (b, c) {
            if ("accept" === b)this.accept = a.isFunction(c) ? c : function (a) {
                return a.is(c)
            }; else if ("scope" === b) {
                var d = a.ui.ddmanager.droppables[this.options.scope];
                this._splice(d), this._addToManager(c)
            }
            this._super(b, c)
        },
        _activate: function (b) {
            var c = a.ui.ddmanager.current;
            this.options.activeClass && this.element.addClass(this.options.activeClass), c && this._trigger("activate", b, this.ui(c))
        },
        _deactivate: function (b) {
            var c = a.ui.ddmanager.current;
            this.options.activeClass && this.element.removeClass(this.options.activeClass), c && this._trigger("deactivate", b, this.ui(c))
        },
        _over: function (b) {
            var c = a.ui.ddmanager.current;
            c && (c.currentItem || c.element)[0] !== this.element[0] && this.accept.call(this.element[0], c.currentItem || c.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", b, this.ui(c)))
        },
        _out: function (b) {
            var c = a.ui.ddmanager.current;
            c && (c.currentItem || c.element)[0] !== this.element[0] && this.accept.call(this.element[0], c.currentItem || c.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", b, this.ui(c)))
        },
        _drop: function (b, c) {
            var d = c || a.ui.ddmanager.current, e = !1;
            return d && (d.currentItem || d.element)[0] !== this.element[0] ? (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function () {
                var c = a(this).droppable("instance");
                return c.options.greedy && !c.options.disabled && c.options.scope === d.options.scope && c.accept.call(c.element[0], d.currentItem || d.element) && a.ui.intersect(d, a.extend(c, {offset: c.element.offset()}), c.options.tolerance, b) ? (e = !0, !1) : void 0
            }), e ? !1 : this.accept.call(this.element[0], d.currentItem || d.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", b, this.ui(d)), this.element) : !1) : !1
        },
        ui: function (a) {
            return {
                draggable: a.currentItem || a.element,
                helper: a.helper,
                position: a.position,
                offset: a.positionAbs
            }
        }
    }), a.ui.intersect = function () {
        function a(a, b, c) {
            return a >= b && b + c > a
        }

        return function (b, c, d, e) {
            if (!c.offset)return !1;
            var f = (b.positionAbs || b.position.absolute).left + b.margins.left, g = (b.positionAbs || b.position.absolute).top + b.margins.top, h = f + b.helperProportions.width, i = g + b.helperProportions.height, j = c.offset.left, k = c.offset.top, l = j + c.proportions().width, m = k + c.proportions().height;
            switch (d) {
                case"fit":
                    return f >= j && l >= h && g >= k && m >= i;
                case"intersect":
                    return j < f + b.helperProportions.width / 2 && h - b.helperProportions.width / 2 < l && k < g + b.helperProportions.height / 2 && i - b.helperProportions.height / 2 < m;
                case"pointer":
                    return a(e.pageY, k, c.proportions().height) && a(e.pageX, j, c.proportions().width);
                case"touch":
                    return (g >= k && m >= g || i >= k && m >= i || k > g && i > m) && (f >= j && l >= f || h >= j && l >= h || j > f && h > l);
                default:
                    return !1
            }
        }
    }(), a.ui.ddmanager = {
        current: null, droppables: {"default": []}, prepareOffsets: function (b, c) {
            var d, e, f = a.ui.ddmanager.droppables[b.options.scope] || [], g = c ? c.type : null, h = (b.currentItem || b.element).find(":data(ui-droppable)").addBack();
            a:for (d = 0; d < f.length; d++)if (!(f[d].options.disabled || b && !f[d].accept.call(f[d].element[0], b.currentItem || b.element))) {
                for (e = 0; e < h.length; e++)if (h[e] === f[d].element[0]) {
                    f[d].proportions().height = 0;
                    continue a
                }
                f[d].visible = "none" !== f[d].element.css("display"), f[d].visible && ("mousedown" === g && f[d]._activate.call(f[d], c), f[d].offset = f[d].element.offset(), f[d].proportions({
                    width: f[d].element[0].offsetWidth,
                    height: f[d].element[0].offsetHeight
                }))
            }
        }, drop: function (b, c) {
            var d = !1;
            return a.each((a.ui.ddmanager.droppables[b.options.scope] || []).slice(), function () {
                this.options && (!this.options.disabled && this.visible && a.ui.intersect(b, this, this.options.tolerance, c) && (d = this._drop.call(this, c) || d), !this.options.disabled && this.visible && this.accept.call(this.element[0], b.currentItem || b.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, c)))
            }), d
        }, dragStart: function (b, c) {
            b.element.parentsUntil("body").bind("scroll.droppable", function () {
                b.options.refreshPositions || a.ui.ddmanager.prepareOffsets(b, c)
            })
        }, drag: function (b, c) {
            b.options.refreshPositions && a.ui.ddmanager.prepareOffsets(b, c), a.each(a.ui.ddmanager.droppables[b.options.scope] || [], function () {
                if (!this.options.disabled && !this.greedyChild && this.visible) {
                    var d, e, f, g = a.ui.intersect(b, this, this.options.tolerance, c), h = !g && this.isover ? "isout" : g && !this.isover ? "isover" : null;
                    h && (this.options.greedy && (e = this.options.scope, f = this.element.parents(":data(ui-droppable)").filter(function () {
                        return a(this).droppable("instance").options.scope === e
                    }), f.length && (d = a(f[0]).droppable("instance"), d.greedyChild = "isover" === h)), d && "isover" === h && (d.isover = !1, d.isout = !0, d._out.call(d, c)), this[h] = !0, this["isout" === h ? "isover" : "isout"] = !1, this["isover" === h ? "_over" : "_out"].call(this, c), d && "isout" === h && (d.isout = !1, d.isover = !0, d._over.call(d, c)))
                }
            })
        }, dragStop: function (b, c) {
            b.element.parentsUntil("body").unbind("scroll.droppable"), b.options.refreshPositions || a.ui.ddmanager.prepareOffsets(b, c)
        }
    };
    a.ui.droppable;
    a.widget("ui.resizable", a.ui.mouse, {
        version: "1.11.2",
        widgetEventPrefix: "resize",
        options: {
            alsoResize: !1,
            animate: !1,
            animateDuration: "slow",
            animateEasing: "swing",
            aspectRatio: !1,
            autoHide: !1,
            containment: !1,
            ghost: !1,
            grid: !1,
            handles: "e,s,se",
            helper: !1,
            maxHeight: null,
            maxWidth: null,
            minHeight: 10,
            minWidth: 10,
            zIndex: 90,
            resize: null,
            start: null,
            stop: null
        },
        _num: function (a) {
            return parseInt(a, 10) || 0
        },
        _isNumber: function (a) {
            return !isNaN(parseInt(a, 10))
        },
        _hasScroll: function (b, c) {
            if ("hidden" === a(b).css("overflow"))return !1;
            var d = c && "left" === c ? "scrollLeft" : "scrollTop", e = !1;
            return b[d] > 0 ? !0 : (b[d] = 1, e = b[d] > 0, b[d] = 0, e)
        },
        _create: function () {
            var b, c, d, e, f, g = this, h = this.options;
            if (this.element.addClass("ui-resizable"), a.extend(this, {
                    _aspectRatio: !!h.aspectRatio,
                    aspectRatio: h.aspectRatio,
                    originalElement: this.element,
                    _proportionallyResizeElements: [],
                    _helper: h.helper || h.ghost || h.animate ? h.helper || "ui-resizable-helper" : null
                }), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
                    position: this.element.css("position"),
                    width: this.element.outerWidth(),
                    height: this.element.outerHeight(),
                    top: this.element.css("top"),
                    left: this.element.css("left")
                })), this.element = this.element.parent().data("ui-resizable", this.element.resizable("instance")), this.elementIsWrapper = !0, this.element.css({
                    marginLeft: this.originalElement.css("marginLeft"),
                    marginTop: this.originalElement.css("marginTop"),
                    marginRight: this.originalElement.css("marginRight"),
                    marginBottom: this.originalElement.css("marginBottom")
                }), this.originalElement.css({
                    marginLeft: 0,
                    marginTop: 0,
                    marginRight: 0,
                    marginBottom: 0
                }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
                    position: "static",
                    zoom: 1,
                    display: "block"
                })), this.originalElement.css({margin: this.originalElement.css("margin")}), this._proportionallyResize()), this.handles = h.handles || (a(".ui-resizable-handle", this.element).length ? {
                        n: ".ui-resizable-n",
                        e: ".ui-resizable-e",
                        s: ".ui-resizable-s",
                        w: ".ui-resizable-w",
                        se: ".ui-resizable-se",
                        sw: ".ui-resizable-sw",
                        ne: ".ui-resizable-ne",
                        nw: ".ui-resizable-nw"
                    } : "e,s,se"), this.handles.constructor === String)for ("all" === this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), b = this.handles.split(","), this.handles = {}, c = 0; c < b.length; c++)d = a.trim(b[c]), f = "ui-resizable-" + d, e = a("<div class='ui-resizable-handle " + f + "'></div>"), e.css({zIndex: h.zIndex}), "se" === d && e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[d] = ".ui-resizable-" + d, this.element.append(e);
            this._renderAxis = function (b) {
                var c, d, e, f;
                b = b || this.element;
                for (c in this.handles)this.handles[c].constructor === String && (this.handles[c] = this.element.children(this.handles[c]).first().show()), this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i) && (d = a(this.handles[c], this.element), f = /sw|ne|nw|se|n|s/.test(c) ? d.outerHeight() : d.outerWidth(), e = ["padding", /ne|nw|n/.test(c) ? "Top" : /se|sw|s/.test(c) ? "Bottom" : /^e$/.test(c) ? "Right" : "Left"].join(""), b.css(e, f), this._proportionallyResize()), a(this.handles[c]).length
            }, this._renderAxis(this.element), this._handles = a(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function () {
                g.resizing || (this.className && (e = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), g.axis = e && e[1] ? e[1] : "se")
            }), h.autoHide && (this._handles.hide(), a(this.element).addClass("ui-resizable-autohide").mouseenter(function () {
                h.disabled || (a(this).removeClass("ui-resizable-autohide"), g._handles.show())
            }).mouseleave(function () {
                h.disabled || g.resizing || (a(this).addClass("ui-resizable-autohide"), g._handles.hide())
            })), this._mouseInit()
        },
        _destroy: function () {
            this._mouseDestroy();
            var b, c = function (b) {
                a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
            };
            return this.elementIsWrapper && (c(this.element), b = this.element, this.originalElement.css({
                position: b.css("position"),
                width: b.outerWidth(),
                height: b.outerHeight(),
                top: b.css("top"),
                left: b.css("left")
            }).insertAfter(b), b.remove()), this.originalElement.css("resize", this.originalResizeStyle),
                c(this.originalElement), this
        },
        _mouseCapture: function (b) {
            var c, d, e = !1;
            for (c in this.handles)d = a(this.handles[c])[0], (d === b.target || a.contains(d, b.target)) && (e = !0);
            return !this.options.disabled && e
        },
        _mouseStart: function (b) {
            var c, d, e, f = this.options, g = this.element;
            return this.resizing = !0, this._renderProxy(), c = this._num(this.helper.css("left")), d = this._num(this.helper.css("top")), f.containment && (c += a(f.containment).scrollLeft() || 0, d += a(f.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {
                left: c,
                top: d
            }, this.size = this._helper ? {
                width: this.helper.width(),
                height: this.helper.height()
            } : {width: g.width(), height: g.height()}, this.originalSize = this._helper ? {
                width: g.outerWidth(),
                height: g.outerHeight()
            } : {width: g.width(), height: g.height()}, this.sizeDiff = {
                width: g.outerWidth() - g.width(),
                height: g.outerHeight() - g.height()
            }, this.originalPosition = {left: c, top: d}, this.originalMousePosition = {
                left: b.pageX,
                top: b.pageY
            }, this.aspectRatio = "number" == typeof f.aspectRatio ? f.aspectRatio : this.originalSize.width / this.originalSize.height || 1, e = a(".ui-resizable-" + this.axis).css("cursor"), a("body").css("cursor", "auto" === e ? this.axis + "-resize" : e), g.addClass("ui-resizable-resizing"), this._propagate("start", b), !0
        },
        _mouseDrag: function (b) {
            var c, d, e = this.originalMousePosition, f = this.axis, g = b.pageX - e.left || 0, h = b.pageY - e.top || 0, i = this._change[f];
            return this._updatePrevProperties(), i ? (c = i.apply(this, [b, g, h]), this._updateVirtualBoundaries(b.shiftKey), (this._aspectRatio || b.shiftKey) && (c = this._updateRatio(c, b)), c = this._respectSize(c, b), this._updateCache(c), this._propagate("resize", b), d = this._applyChanges(), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), a.isEmptyObject(d) || (this._updatePrevProperties(), this._trigger("resize", b, this.ui()), this._applyChanges()), !1) : !1
        },
        _mouseStop: function (b) {
            this.resizing = !1;
            var c, d, e, f, g, h, i, j = this.options, k = this;
            return this._helper && (c = this._proportionallyResizeElements, d = c.length && /textarea/i.test(c[0].nodeName), e = d && this._hasScroll(c[0], "left") ? 0 : k.sizeDiff.height, f = d ? 0 : k.sizeDiff.width, g = {
                width: k.helper.width() - f,
                height: k.helper.height() - e
            }, h = parseInt(k.element.css("left"), 10) + (k.position.left - k.originalPosition.left) || null, i = parseInt(k.element.css("top"), 10) + (k.position.top - k.originalPosition.top) || null, j.animate || this.element.css(a.extend(g, {
                top: i,
                left: h
            })), k.helper.height(k.size.height), k.helper.width(k.size.width), this._helper && !j.animate && this._proportionallyResize()), a("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", b), this._helper && this.helper.remove(), !1
        },
        _updatePrevProperties: function () {
            this.prevPosition = {
                top: this.position.top,
                left: this.position.left
            }, this.prevSize = {width: this.size.width, height: this.size.height}
        },
        _applyChanges: function () {
            var a = {};
            return this.position.top !== this.prevPosition.top && (a.top = this.position.top + "px"), this.position.left !== this.prevPosition.left && (a.left = this.position.left + "px"), this.size.width !== this.prevSize.width && (a.width = this.size.width + "px"), this.size.height !== this.prevSize.height && (a.height = this.size.height + "px"), this.helper.css(a), a
        },
        _updateVirtualBoundaries: function (a) {
            var b, c, d, e, f, g = this.options;
            f = {
                minWidth: this._isNumber(g.minWidth) ? g.minWidth : 0,
                maxWidth: this._isNumber(g.maxWidth) ? g.maxWidth : 1 / 0,
                minHeight: this._isNumber(g.minHeight) ? g.minHeight : 0,
                maxHeight: this._isNumber(g.maxHeight) ? g.maxHeight : 1 / 0
            }, (this._aspectRatio || a) && (b = f.minHeight * this.aspectRatio, d = f.minWidth / this.aspectRatio, c = f.maxHeight * this.aspectRatio, e = f.maxWidth / this.aspectRatio, b > f.minWidth && (f.minWidth = b), d > f.minHeight && (f.minHeight = d), c < f.maxWidth && (f.maxWidth = c), e < f.maxHeight && (f.maxHeight = e)), this._vBoundaries = f
        },
        _updateCache: function (a) {
            this.offset = this.helper.offset(), this._isNumber(a.left) && (this.position.left = a.left), this._isNumber(a.top) && (this.position.top = a.top), this._isNumber(a.height) && (this.size.height = a.height), this._isNumber(a.width) && (this.size.width = a.width)
        },
        _updateRatio: function (a) {
            var b = this.position, c = this.size, d = this.axis;
            return this._isNumber(a.height) ? a.width = a.height * this.aspectRatio : this._isNumber(a.width) && (a.height = a.width / this.aspectRatio), "sw" === d && (a.left = b.left + (c.width - a.width), a.top = null), "nw" === d && (a.top = b.top + (c.height - a.height), a.left = b.left + (c.width - a.width)), a
        },
        _respectSize: function (a) {
            var b = this._vBoundaries, c = this.axis, d = this._isNumber(a.width) && b.maxWidth && b.maxWidth < a.width, e = this._isNumber(a.height) && b.maxHeight && b.maxHeight < a.height, f = this._isNumber(a.width) && b.minWidth && b.minWidth > a.width, g = this._isNumber(a.height) && b.minHeight && b.minHeight > a.height, h = this.originalPosition.left + this.originalSize.width, i = this.position.top + this.size.height, j = /sw|nw|w/.test(c), k = /nw|ne|n/.test(c);
            return f && (a.width = b.minWidth), g && (a.height = b.minHeight), d && (a.width = b.maxWidth), e && (a.height = b.maxHeight), f && j && (a.left = h - b.minWidth), d && j && (a.left = h - b.maxWidth), g && k && (a.top = i - b.minHeight), e && k && (a.top = i - b.maxHeight), a.width || a.height || a.left || !a.top ? a.width || a.height || a.top || !a.left || (a.left = null) : a.top = null, a
        },
        _getPaddingPlusBorderDimensions: function (a) {
            for (var b = 0, c = [], d = [a.css("borderTopWidth"), a.css("borderRightWidth"), a.css("borderBottomWidth"), a.css("borderLeftWidth")], e = [a.css("paddingTop"), a.css("paddingRight"), a.css("paddingBottom"), a.css("paddingLeft")]; 4 > b; b++)c[b] = parseInt(d[b], 10) || 0, c[b] += parseInt(e[b], 10) || 0;
            return {height: c[0] + c[2], width: c[1] + c[3]}
        },
        _proportionallyResize: function () {
            if (this._proportionallyResizeElements.length)for (var a, b = 0, c = this.helper || this.element; b < this._proportionallyResizeElements.length; b++)a = this._proportionallyResizeElements[b], this.outerDimensions || (this.outerDimensions = this._getPaddingPlusBorderDimensions(a)), a.css({
                height: c.height() - this.outerDimensions.height || 0,
                width: c.width() - this.outerDimensions.width || 0
            })
        },
        _renderProxy: function () {
            var b = this.element, c = this.options;
            this.elementOffset = b.offset(), this._helper ? (this.helper = this.helper || a("<div style='overflow:hidden;'></div>"), this.helper.addClass(this._helper).css({
                width: this.element.outerWidth() - 1,
                height: this.element.outerHeight() - 1,
                position: "absolute",
                left: this.elementOffset.left + "px",
                top: this.elementOffset.top + "px",
                zIndex: ++c.zIndex
            }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element
        },
        _change: {
            e: function (a, b) {
                return {width: this.originalSize.width + b}
            }, w: function (a, b) {
                var c = this.originalSize, d = this.originalPosition;
                return {left: d.left + b, width: c.width - b}
            }, n: function (a, b, c) {
                var d = this.originalSize, e = this.originalPosition;
                return {top: e.top + c, height: d.height - c}
            }, s: function (a, b, c) {
                return {height: this.originalSize.height + c}
            }, se: function (b, c, d) {
                return a.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [b, c, d]))
            }, sw: function (b, c, d) {
                return a.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [b, c, d]))
            }, ne: function (b, c, d) {
                return a.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [b, c, d]))
            }, nw: function (b, c, d) {
                return a.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [b, c, d]))
            }
        },
        _propagate: function (b, c) {
            a.ui.plugin.call(this, b, [c, this.ui()]), "resize" !== b && this._trigger(b, c, this.ui())
        },
        plugins: {},
        ui: function () {
            return {
                originalElement: this.originalElement,
                element: this.element,
                helper: this.helper,
                position: this.position,
                size: this.size,
                originalSize: this.originalSize,
                originalPosition: this.originalPosition
            }
        }
    }), a.ui.plugin.add("resizable", "animate", {
        stop: function (b) {
            var c = a(this).resizable("instance"), d = c.options, e = c._proportionallyResizeElements, f = e.length && /textarea/i.test(e[0].nodeName), g = f && c._hasScroll(e[0], "left") ? 0 : c.sizeDiff.height, h = f ? 0 : c.sizeDiff.width, i = {
                width: c.size.width - h,
                height: c.size.height - g
            }, j = parseInt(c.element.css("left"), 10) + (c.position.left - c.originalPosition.left) || null, k = parseInt(c.element.css("top"), 10) + (c.position.top - c.originalPosition.top) || null;
            c.element.animate(a.extend(i, k && j ? {top: k, left: j} : {}), {
                duration: d.animateDuration,
                easing: d.animateEasing,
                step: function () {
                    var d = {
                        width: parseInt(c.element.css("width"), 10),
                        height: parseInt(c.element.css("height"), 10),
                        top: parseInt(c.element.css("top"), 10),
                        left: parseInt(c.element.css("left"), 10)
                    };
                    e && e.length && a(e[0]).css({
                        width: d.width,
                        height: d.height
                    }), c._updateCache(d), c._propagate("resize", b)
                }
            })
        }
    }), a.ui.plugin.add("resizable", "containment", {
        start: function () {
            var b, c, d, e, f, g, h, i = a(this).resizable("instance"), j = i.options, k = i.element, l = j.containment, m = l instanceof a ? l.get(0) : /parent/.test(l) ? k.parent().get(0) : l;
            m && (i.containerElement = a(m), /document/.test(l) || l === document ? (i.containerOffset = {
                left: 0,
                top: 0
            }, i.containerPosition = {left: 0, top: 0}, i.parentData = {
                element: a(document),
                left: 0,
                top: 0,
                width: a(document).width(),
                height: a(document).height() || document.body.parentNode.scrollHeight
            }) : (b = a(m), c = [], a(["Top", "Right", "Left", "Bottom"]).each(function (a, d) {
                c[a] = i._num(b.css("padding" + d))
            }), i.containerOffset = b.offset(), i.containerPosition = b.position(), i.containerSize = {
                height: b.innerHeight() - c[3],
                width: b.innerWidth() - c[1]
            }, d = i.containerOffset, e = i.containerSize.height, f = i.containerSize.width, g = i._hasScroll(m, "left") ? m.scrollWidth : f, h = i._hasScroll(m) ? m.scrollHeight : e, i.parentData = {
                element: m,
                left: d.left,
                top: d.top,
                width: g,
                height: h
            }))
        }, resize: function (b) {
            var c, d, e, f, g = a(this).resizable("instance"), h = g.options, i = g.containerOffset, j = g.position, k = g._aspectRatio || b.shiftKey, l = {
                top: 0,
                left: 0
            }, m = g.containerElement, n = !0;
            m[0] !== document && /static/.test(m.css("position")) && (l = i), j.left < (g._helper ? i.left : 0) && (g.size.width = g.size.width + (g._helper ? g.position.left - i.left : g.position.left - l.left), k && (g.size.height = g.size.width / g.aspectRatio, n = !1), g.position.left = h.helper ? i.left : 0), j.top < (g._helper ? i.top : 0) && (g.size.height = g.size.height + (g._helper ? g.position.top - i.top : g.position.top), k && (g.size.width = g.size.height * g.aspectRatio, n = !1), g.position.top = g._helper ? i.top : 0), e = g.containerElement.get(0) === g.element.parent().get(0), f = /relative|absolute/.test(g.containerElement.css("position")), e && f ? (g.offset.left = g.parentData.left + g.position.left, g.offset.top = g.parentData.top + g.position.top) : (g.offset.left = g.element.offset().left, g.offset.top = g.element.offset().top), c = Math.abs(g.sizeDiff.width + (g._helper ? g.offset.left - l.left : g.offset.left - i.left)), d = Math.abs(g.sizeDiff.height + (g._helper ? g.offset.top - l.top : g.offset.top - i.top)), c + g.size.width >= g.parentData.width && (g.size.width = g.parentData.width - c, k && (g.size.height = g.size.width / g.aspectRatio, n = !1)), d + g.size.height >= g.parentData.height && (g.size.height = g.parentData.height - d, k && (g.size.width = g.size.height * g.aspectRatio, n = !1)), n || (g.position.left = g.prevPosition.left, g.position.top = g.prevPosition.top, g.size.width = g.prevSize.width, g.size.height = g.prevSize.height)
        }, stop: function () {
            var b = a(this).resizable("instance"), c = b.options, d = b.containerOffset, e = b.containerPosition, f = b.containerElement, g = a(b.helper), h = g.offset(), i = g.outerWidth() - b.sizeDiff.width, j = g.outerHeight() - b.sizeDiff.height;
            b._helper && !c.animate && /relative/.test(f.css("position")) && a(this).css({
                left: h.left - e.left - d.left,
                width: i,
                height: j
            }), b._helper && !c.animate && /static/.test(f.css("position")) && a(this).css({
                left: h.left - e.left - d.left,
                width: i,
                height: j
            })
        }
    }), a.ui.plugin.add("resizable", "alsoResize", {
        start: function () {
            var b = a(this).resizable("instance"), c = b.options, d = function (b) {
                a(b).each(function () {
                    var b = a(this);
                    b.data("ui-resizable-alsoresize", {
                        width: parseInt(b.width(), 10),
                        height: parseInt(b.height(), 10),
                        left: parseInt(b.css("left"), 10),
                        top: parseInt(b.css("top"), 10)
                    })
                })
            };
            "object" != typeof c.alsoResize || c.alsoResize.parentNode ? d(c.alsoResize) : c.alsoResize.length ? (c.alsoResize = c.alsoResize[0], d(c.alsoResize)) : a.each(c.alsoResize, function (a) {
                d(a)
            })
        }, resize: function (b, c) {
            var d = a(this).resizable("instance"), e = d.options, f = d.originalSize, g = d.originalPosition, h = {
                height: d.size.height - f.height || 0,
                width: d.size.width - f.width || 0,
                top: d.position.top - g.top || 0,
                left: d.position.left - g.left || 0
            }, i = function (b, d) {
                a(b).each(function () {
                    var b = a(this), e = a(this).data("ui-resizable-alsoresize"), f = {}, g = d && d.length ? d : b.parents(c.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                    a.each(g, function (a, b) {
                        var c = (e[b] || 0) + (h[b] || 0);
                        c && c >= 0 && (f[b] = c || null)
                    }), b.css(f)
                })
            };
            "object" != typeof e.alsoResize || e.alsoResize.nodeType ? i(e.alsoResize) : a.each(e.alsoResize, function (a, b) {
                i(a, b)
            })
        }, stop: function () {
            a(this).removeData("resizable-alsoresize")
        }
    }), a.ui.plugin.add("resizable", "ghost", {
        start: function () {
            var b = a(this).resizable("instance"), c = b.options, d = b.size;
            b.ghost = b.originalElement.clone(), b.ghost.css({
                opacity: .25,
                display: "block",
                position: "relative",
                height: d.height,
                width: d.width,
                margin: 0,
                left: 0,
                top: 0
            }).addClass("ui-resizable-ghost").addClass("string" == typeof c.ghost ? c.ghost : ""), b.ghost.appendTo(b.helper)
        }, resize: function () {
            var b = a(this).resizable("instance");
            b.ghost && b.ghost.css({position: "relative", height: b.size.height, width: b.size.width})
        }, stop: function () {
            var b = a(this).resizable("instance");
            b.ghost && b.helper && b.helper.get(0).removeChild(b.ghost.get(0))
        }
    }), a.ui.plugin.add("resizable", "grid", {
        resize: function () {
            var b, c = a(this).resizable("instance"), d = c.options, e = c.size, f = c.originalSize, g = c.originalPosition, h = c.axis, i = "number" == typeof d.grid ? [d.grid, d.grid] : d.grid, j = i[0] || 1, k = i[1] || 1, l = Math.round((e.width - f.width) / j) * j, m = Math.round((e.height - f.height) / k) * k, n = f.width + l, o = f.height + m, p = d.maxWidth && d.maxWidth < n, q = d.maxHeight && d.maxHeight < o, r = d.minWidth && d.minWidth > n, s = d.minHeight && d.minHeight > o;
            d.grid = i, r && (n += j), s && (o += k), p && (n -= j), q && (o -= k), /^(se|s|e)$/.test(h) ? (c.size.width = n, c.size.height = o) : /^(ne)$/.test(h) ? (c.size.width = n, c.size.height = o, c.position.top = g.top - m) : /^(sw)$/.test(h) ? (c.size.width = n, c.size.height = o, c.position.left = g.left - l) : ((0 >= o - k || 0 >= n - j) && (b = c._getPaddingPlusBorderDimensions(this)), o - k > 0 ? (c.size.height = o, c.position.top = g.top - m) : (o = k - b.height, c.size.height = o, c.position.top = g.top + f.height - o), n - j > 0 ? (c.size.width = n, c.position.left = g.left - l) : (n = k - b.height, c.size.width = n, c.position.left = g.left + f.width - n))
        }
    });
    var g, h = (a.ui.resizable, a.widget("ui.selectable", a.ui.mouse, {
        version: "1.11.2",
        options: {
            appendTo: "body",
            autoRefresh: !0,
            distance: 0,
            filter: "*",
            tolerance: "touch",
            selected: null,
            selecting: null,
            start: null,
            stop: null,
            unselected: null,
            unselecting: null
        },
        _create: function () {
            var b, c = this;
            this.element.addClass("ui-selectable"), this.dragged = !1, this.refresh = function () {
                b = a(c.options.filter, c.element[0]), b.addClass("ui-selectee"), b.each(function () {
                    var b = a(this), c = b.offset();
                    a.data(this, "selectable-item", {
                        element: this,
                        $element: b,
                        left: c.left,
                        top: c.top,
                        right: c.left + b.outerWidth(),
                        bottom: c.top + b.outerHeight(),
                        startselected: !1,
                        selected: b.hasClass("ui-selected"),
                        selecting: b.hasClass("ui-selecting"),
                        unselecting: b.hasClass("ui-unselecting")
                    })
                })
            }, this.refresh(), this.selectees = b.addClass("ui-selectee"), this._mouseInit(), this.helper = a("<div class='ui-selectable-helper'></div>")
        },
        _destroy: function () {
            this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled"), this._mouseDestroy()
        },
        _mouseStart: function (b) {
            var c = this, d = this.options;
            this.opos = [b.pageX, b.pageY], this.options.disabled || (this.selectees = a(d.filter, this.element[0]), this._trigger("start", b), a(d.appendTo).append(this.helper), this.helper.css({
                left: b.pageX,
                top: b.pageY,
                width: 0,
                height: 0
            }), d.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function () {
                var d = a.data(this, "selectable-item");
                d.startselected = !0, b.metaKey || b.ctrlKey || (d.$element.removeClass("ui-selected"), d.selected = !1, d.$element.addClass("ui-unselecting"), d.unselecting = !0, c._trigger("unselecting", b, {unselecting: d.element}))
            }), a(b.target).parents().addBack().each(function () {
                var d, e = a.data(this, "selectable-item");
                return e ? (d = !b.metaKey && !b.ctrlKey || !e.$element.hasClass("ui-selected"), e.$element.removeClass(d ? "ui-unselecting" : "ui-selected").addClass(d ? "ui-selecting" : "ui-unselecting"), e.unselecting = !d, e.selecting = d, e.selected = d, d ? c._trigger("selecting", b, {selecting: e.element}) : c._trigger("unselecting", b, {unselecting: e.element}), !1) : void 0
            }))
        },
        _mouseDrag: function (b) {
            if (this.dragged = !0, !this.options.disabled) {
                var c, d = this, e = this.options, f = this.opos[0], g = this.opos[1], h = b.pageX, i = b.pageY;
                return f > h && (c = h, h = f, f = c), g > i && (c = i, i = g, g = c), this.helper.css({
                    left: f,
                    top: g,
                    width: h - f,
                    height: i - g
                }), this.selectees.each(function () {
                    var c = a.data(this, "selectable-item"), j = !1;
                    c && c.element !== d.element[0] && ("touch" === e.tolerance ? j = !(c.left > h || c.right < f || c.top > i || c.bottom < g) : "fit" === e.tolerance && (j = c.left > f && c.right < h && c.top > g && c.bottom < i), j ? (c.selected && (c.$element.removeClass("ui-selected"), c.selected = !1), c.unselecting && (c.$element.removeClass("ui-unselecting"), c.unselecting = !1), c.selecting || (c.$element.addClass("ui-selecting"), c.selecting = !0, d._trigger("selecting", b, {selecting: c.element}))) : (c.selecting && ((b.metaKey || b.ctrlKey) && c.startselected ? (c.$element.removeClass("ui-selecting"), c.selecting = !1, c.$element.addClass("ui-selected"), c.selected = !0) : (c.$element.removeClass("ui-selecting"), c.selecting = !1, c.startselected && (c.$element.addClass("ui-unselecting"), c.unselecting = !0), d._trigger("unselecting", b, {unselecting: c.element}))), c.selected && (b.metaKey || b.ctrlKey || c.startselected || (c.$element.removeClass("ui-selected"), c.selected = !1, c.$element.addClass("ui-unselecting"), c.unselecting = !0, d._trigger("unselecting", b, {unselecting: c.element})))))
                }), !1
            }
        },
        _mouseStop: function (b) {
            var c = this;
            return this.dragged = !1, a(".ui-unselecting", this.element[0]).each(function () {
                var d = a.data(this, "selectable-item");
                d.$element.removeClass("ui-unselecting"), d.unselecting = !1, d.startselected = !1, c._trigger("unselected", b, {unselected: d.element})
            }), a(".ui-selecting", this.element[0]).each(function () {
                var d = a.data(this, "selectable-item");
                d.$element.removeClass("ui-selecting").addClass("ui-selected"), d.selecting = !1, d.selected = !0, d.startselected = !0, c._trigger("selected", b, {selected: d.element})
            }), this._trigger("stop", b), this.helper.remove(), !1
        }
    }), a.widget("ui.sortable", a.ui.mouse, {
        version: "1.11.2",
        widgetEventPrefix: "sort",
        ready: !1,
        options: {
            appendTo: "parent",
            axis: !1,
            connectWith: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            dropOnEmpty: !0,
            forcePlaceholderSize: !1,
            forceHelperSize: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            items: "> *",
            opacity: !1,
            placeholder: !1,
            revert: !1,
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            scope: "default",
            tolerance: "intersect",
            zIndex: 1e3,
            activate: null,
            beforeStop: null,
            change: null,
            deactivate: null,
            out: null,
            over: null,
            receive: null,
            remove: null,
            sort: null,
            start: null,
            stop: null,
            update: null
        },
        _isOverAxis: function (a, b, c) {
            return a >= b && b + c > a
        },
        _isFloating: function (a) {
            return /left|right/.test(a.css("float")) || /inline|table-cell/.test(a.css("display"))
        },
        _create: function () {
            var a = this.options;
            this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? "x" === a.axis || this._isFloating(this.items[0].item) : !1, this.offset = this.element.offset(), this._mouseInit(), this._setHandleClassName(), this.ready = !0
        },
        _setOption: function (a, b) {
            this._super(a, b), "handle" === a && this._setHandleClassName()
        },
        _setHandleClassName: function () {
            this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"), a.each(this.items, function () {
                (this.instance.options.handle ? this.item.find(this.instance.options.handle) : this.item).addClass("ui-sortable-handle")
            })
        },
        _destroy: function () {
            this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"), this._mouseDestroy();
            for (var a = this.items.length - 1; a >= 0; a--)this.items[a].item.removeData(this.widgetName + "-item");
            return this
        },
        _mouseCapture: function (b, c) {
            var d = null, e = !1, f = this;
            return this.reverting ? !1 : this.options.disabled || "static" === this.options.type ? !1 : (this._refreshItems(b), a(b.target).parents().each(function () {
                return a.data(this, f.widgetName + "-item") === f ? (d = a(this), !1) : void 0
            }), a.data(b.target, f.widgetName + "-item") === f && (d = a(b.target)), d && (!this.options.handle || c || (a(this.options.handle, d).find("*").addBack().each(function () {
                this === b.target && (e = !0)
            }), e)) ? (this.currentItem = d, this._removeCurrentsFromItems(), !0) : !1)
        },
        _mouseStart: function (b, c, d) {
            var e, f, g = this.options;
            if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(b), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {
                    top: this.offset.top - this.margins.top,
                    left: this.offset.left - this.margins.left
                }, a.extend(this.offset, {
                    click: {left: b.pageX - this.offset.left, top: b.pageY - this.offset.top},
                    parent: this._getParentOffset(),
                    relative: this._getRelativeOffset()
                }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(b), this.originalPageX = b.pageX, this.originalPageY = b.pageY, g.cursorAt && this._adjustOffsetFromHelper(g.cursorAt), this.domPosition = {
                    prev: this.currentItem.prev()[0],
                    parent: this.currentItem.parent()[0]
                }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), g.containment && this._setContainment(), g.cursor && "auto" !== g.cursor && (f = this.document.find("body"), this.storedCursor = f.css("cursor"), f.css("cursor", g.cursor), this.storedStylesheet = a("<style>*{ cursor: " + g.cursor + " !important; }</style>").appendTo(f)), g.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", g.opacity)), g.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", g.zIndex)), this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", b, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !d)for (e = this.containers.length - 1; e >= 0; e--)this.containers[e]._trigger("activate", b, this._uiHash(this));
            return a.ui.ddmanager && (a.ui.ddmanager.current = this), a.ui.ddmanager && !g.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(b), !0
        },
        _mouseDrag: function (b) {
            var c, d, e, f, g = this.options, h = !1;
            for (this.position = this._generatePosition(b), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== document && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - b.pageY < g.scrollSensitivity ? this.scrollParent[0].scrollTop = h = this.scrollParent[0].scrollTop + g.scrollSpeed : b.pageY - this.overflowOffset.top < g.scrollSensitivity && (this.scrollParent[0].scrollTop = h = this.scrollParent[0].scrollTop - g.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - b.pageX < g.scrollSensitivity ? this.scrollParent[0].scrollLeft = h = this.scrollParent[0].scrollLeft + g.scrollSpeed : b.pageX - this.overflowOffset.left < g.scrollSensitivity && (this.scrollParent[0].scrollLeft = h = this.scrollParent[0].scrollLeft - g.scrollSpeed)) : (b.pageY - a(document).scrollTop() < g.scrollSensitivity ? h = a(document).scrollTop(a(document).scrollTop() - g.scrollSpeed) : a(window).height() - (b.pageY - a(document).scrollTop()) < g.scrollSensitivity && (h = a(document).scrollTop(a(document).scrollTop() + g.scrollSpeed)), b.pageX - a(document).scrollLeft() < g.scrollSensitivity ? h = a(document).scrollLeft(a(document).scrollLeft() - g.scrollSpeed) : a(window).width() - (b.pageX - a(document).scrollLeft()) < g.scrollSensitivity && (h = a(document).scrollLeft(a(document).scrollLeft() + g.scrollSpeed))), h !== !1 && a.ui.ddmanager && !g.dropBehaviour && a.ui.ddmanager.prepareOffsets(this, b)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), c = this.items.length - 1; c >= 0; c--)if (d = this.items[c], e = d.item[0], f = this._intersectsWithPointer(d), f && d.instance === this.currentContainer && e !== this.currentItem[0] && this.placeholder[1 === f ? "next" : "prev"]()[0] !== e && !a.contains(this.placeholder[0], e) && ("semi-dynamic" === this.options.type ? !a.contains(this.element[0], e) : !0)) {
                if (this.direction = 1 === f ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(d))break;
                this._rearrange(b, d), this._trigger("change", b, this._uiHash());
                break
            }
            return this._contactContainers(b), a.ui.ddmanager && a.ui.ddmanager.drag(this, b), this._trigger("sort", b, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
        },
        _mouseStop: function (b, c) {
            if (b) {
                if (a.ui.ddmanager && !this.options.dropBehaviour && a.ui.ddmanager.drop(this, b), this.options.revert) {
                    var d = this, e = this.placeholder.offset(), f = this.options.axis, g = {};
                    f && "x" !== f || (g.left = e.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollLeft)), f && "y" !== f || (g.top = e.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === document.body ? 0 : this.offsetParent[0].scrollTop)), this.reverting = !0, a(this.helper).animate(g, parseInt(this.options.revert, 10) || 500, function () {
                        d._clear(b)
                    })
                } else this._clear(b, c);
                return !1
            }
        },
        cancel: function () {
            if (this.dragging) {
                this._mouseUp({target: null}), "original" === this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                for (var b = this.containers.length - 1; b >= 0; b--)this.containers[b]._trigger("deactivate", null, this._uiHash(this)), this.containers[b].containerCache.over && (this.containers[b]._trigger("out", null, this._uiHash(this)), this.containers[b].containerCache.over = 0)
            }
            return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), a.extend(this, {
                helper: null,
                dragging: !1,
                reverting: !1,
                _noFinalSort: null
            }), this.domPosition.prev ? a(this.domPosition.prev).after(this.currentItem) : a(this.domPosition.parent).prepend(this.currentItem)), this
        },
        serialize: function (b) {
            var c = this._getItemsAsjQuery(b && b.connected), d = [];
            return b = b || {}, a(c).each(function () {
                var c = (a(b.item || this).attr(b.attribute || "id") || "").match(b.expression || /(.+)[\-=_](.+)/);
                c && d.push((b.key || c[1] + "[]") + "=" + (b.key && b.expression ? c[1] : c[2]))
            }), !d.length && b.key && d.push(b.key + "="), d.join("&")
        },
        toArray: function (b) {
            var c = this._getItemsAsjQuery(b && b.connected), d = [];
            return b = b || {}, c.each(function () {
                d.push(a(b.item || this).attr(b.attribute || "id") || "")
            }), d
        },
        _intersectsWith: function (a) {
            var b = this.positionAbs.left, c = b + this.helperProportions.width, d = this.positionAbs.top, e = d + this.helperProportions.height, f = a.left, g = f + a.width, h = a.top, i = h + a.height, j = this.offset.click.top, k = this.offset.click.left, l = "x" === this.options.axis || d + j > h && i > d + j, m = "y" === this.options.axis || b + k > f && g > b + k, n = l && m;
            return "pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > a[this.floating ? "width" : "height"] ? n : f < b + this.helperProportions.width / 2 && c - this.helperProportions.width / 2 < g && h < d + this.helperProportions.height / 2 && e - this.helperProportions.height / 2 < i
        },
        _intersectsWithPointer: function (a) {
            var b = "x" === this.options.axis || this._isOverAxis(this.positionAbs.top + this.offset.click.top, a.top, a.height), c = "y" === this.options.axis || this._isOverAxis(this.positionAbs.left + this.offset.click.left, a.left, a.width), d = b && c, e = this._getDragVerticalDirection(), f = this._getDragHorizontalDirection();
            return d ? this.floating ? f && "right" === f || "down" === e ? 2 : 1 : e && ("down" === e ? 2 : 1) : !1
        },
        _intersectsWithSides: function (a) {
            var b = this._isOverAxis(this.positionAbs.top + this.offset.click.top, a.top + a.height / 2, a.height), c = this._isOverAxis(this.positionAbs.left + this.offset.click.left, a.left + a.width / 2, a.width), d = this._getDragVerticalDirection(), e = this._getDragHorizontalDirection();
            return this.floating && e ? "right" === e && c || "left" === e && !c : d && ("down" === d && b || "up" === d && !b)
        },
        _getDragVerticalDirection: function () {
            var a = this.positionAbs.top - this.lastPositionAbs.top;
            return 0 !== a && (a > 0 ? "down" : "up")
        },
        _getDragHorizontalDirection: function () {
            var a = this.positionAbs.left - this.lastPositionAbs.left;
            return 0 !== a && (a > 0 ? "right" : "left")
        },
        refresh: function (a) {
            return this._refreshItems(a), this._setHandleClassName(), this.refreshPositions(), this
        },
        _connectWith: function () {
            var a = this.options;
            return a.connectWith.constructor === String ? [a.connectWith] : a.connectWith
        },
        _getItemsAsjQuery: function (b) {
            function c() {
                h.push(this)
            }

            var d, e, f, g, h = [], i = [], j = this._connectWith();
            if (j && b)for (d = j.length - 1; d >= 0; d--)for (f = a(j[d]), e = f.length - 1; e >= 0; e--)g = a.data(f[e], this.widgetFullName), g && g !== this && !g.options.disabled && i.push([a.isFunction(g.options.items) ? g.options.items.call(g.element) : a(g.options.items, g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), g]);
            for (i.push([a.isFunction(this.options.items) ? this.options.items.call(this.element, null, {
                options: this.options,
                item: this.currentItem
            }) : a(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), d = i.length - 1; d >= 0; d--)i[d][0].each(c);
            return a(h)
        },
        _removeCurrentsFromItems: function () {
            var b = this.currentItem.find(":data(" + this.widgetName + "-item)");
            this.items = a.grep(this.items, function (a) {
                for (var c = 0; c < b.length; c++)if (b[c] === a.item[0])return !1;
                return !0
            })
        },
        _refreshItems: function (b) {
            this.items = [], this.containers = [this];
            var c, d, e, f, g, h, i, j, k = this.items, l = [[a.isFunction(this.options.items) ? this.options.items.call(this.element[0], b, {item: this.currentItem}) : a(this.options.items, this.element), this]], m = this._connectWith();
            if (m && this.ready)for (c = m.length - 1; c >= 0; c--)for (e = a(m[c]), d = e.length - 1; d >= 0; d--)f = a.data(e[d], this.widgetFullName), f && f !== this && !f.options.disabled && (l.push([a.isFunction(f.options.items) ? f.options.items.call(f.element[0], b, {item: this.currentItem}) : a(f.options.items, f.element), f]), this.containers.push(f));
            for (c = l.length - 1; c >= 0; c--)for (g = l[c][1], h = l[c][0], d = 0, j = h.length; j > d; d++)i = a(h[d]), i.data(this.widgetName + "-item", g), k.push({
                item: i,
                instance: g,
                width: 0,
                height: 0,
                left: 0,
                top: 0
            })
        },
        refreshPositions: function (b) {
            this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
            var c, d, e, f;
            for (c = this.items.length - 1; c >= 0; c--)d = this.items[c], d.instance !== this.currentContainer && this.currentContainer && d.item[0] !== this.currentItem[0] || (e = this.options.toleranceElement ? a(this.options.toleranceElement, d.item) : d.item, b || (d.width = e.outerWidth(), d.height = e.outerHeight()), f = e.offset(), d.left = f.left, d.top = f.top);
            if (this.options.custom && this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this); else for (c = this.containers.length - 1; c >= 0; c--)f = this.containers[c].element.offset(), this.containers[c].containerCache.left = f.left, this.containers[c].containerCache.top = f.top, this.containers[c].containerCache.width = this.containers[c].element.outerWidth(), this.containers[c].containerCache.height = this.containers[c].element.outerHeight();
            return this
        },
        _createPlaceholder: function (b) {
            b = b || this;
            var c, d = b.options;
            d.placeholder && d.placeholder.constructor !== String || (c = d.placeholder, d.placeholder = {
                element: function () {
                    var d = b.currentItem[0].nodeName.toLowerCase(), e = a("<" + d + ">", b.document[0]).addClass(c || b.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper");
                    return "tr" === d ? b.currentItem.children().each(function () {
                        a("<td>&#160;</td>", b.document[0]).attr("colspan", a(this).attr("colspan") || 1).appendTo(e)
                    }) : "img" === d && e.attr("src", b.currentItem.attr("src")), c || e.css("visibility", "hidden"), e
                }, update: function (a, e) {
                    (!c || d.forcePlaceholderSize) && (e.height() || e.height(b.currentItem.innerHeight() - parseInt(b.currentItem.css("paddingTop") || 0, 10) - parseInt(b.currentItem.css("paddingBottom") || 0, 10)), e.width() || e.width(b.currentItem.innerWidth() - parseInt(b.currentItem.css("paddingLeft") || 0, 10) - parseInt(b.currentItem.css("paddingRight") || 0, 10)))
                }
            }), b.placeholder = a(d.placeholder.element.call(b.element, b.currentItem)), b.currentItem.after(b.placeholder), d.placeholder.update(b, b.placeholder)
        },
        _contactContainers: function (b) {
            var c, d, e, f, g, h, i, j, k, l, m = null, n = null;
            for (c = this.containers.length - 1; c >= 0; c--)if (!a.contains(this.currentItem[0], this.containers[c].element[0]))if (this._intersectsWith(this.containers[c].containerCache)) {
                if (m && a.contains(this.containers[c].element[0], m.element[0]))continue;
                m = this.containers[c], n = c
            } else this.containers[c].containerCache.over && (this.containers[c]._trigger("out", b, this._uiHash(this)), this.containers[c].containerCache.over = 0);
            if (m)if (1 === this.containers.length)this.containers[n].containerCache.over || (this.containers[n]._trigger("over", b, this._uiHash(this)), this.containers[n].containerCache.over = 1); else {
                for (e = 1e4, f = null, k = m.floating || this._isFloating(this.currentItem), g = k ? "left" : "top", h = k ? "width" : "height", l = k ? "clientX" : "clientY", d = this.items.length - 1; d >= 0; d--)a.contains(this.containers[n].element[0], this.items[d].item[0]) && this.items[d].item[0] !== this.currentItem[0] && (i = this.items[d].item.offset()[g], j = !1, b[l] - i > this.items[d][h] / 2 && (j = !0), Math.abs(b[l] - i) < e && (e = Math.abs(b[l] - i), f = this.items[d], this.direction = j ? "up" : "down"));
                if (!f && !this.options.dropOnEmpty)return;
                if (this.currentContainer === this.containers[n])return void(this.currentContainer.containerCache.over || (this.containers[n]._trigger("over", b, this._uiHash()), this.currentContainer.containerCache.over = 1));
                f ? this._rearrange(b, f, null, !0) : this._rearrange(b, null, this.containers[n].element, !0), this._trigger("change", b, this._uiHash()), this.containers[n]._trigger("change", b, this._uiHash(this)), this.currentContainer = this.containers[n], this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[n]._trigger("over", b, this._uiHash(this)), this.containers[n].containerCache.over = 1
            }
        },
        _createHelper: function (b) {
            var c = this.options, d = a.isFunction(c.helper) ? a(c.helper.apply(this.element[0], [b, this.currentItem])) : "clone" === c.helper ? this.currentItem.clone() : this.currentItem;
            return d.parents("body").length || a("parent" !== c.appendTo ? c.appendTo : this.currentItem[0].parentNode)[0].appendChild(d[0]), d[0] === this.currentItem[0] && (this._storedCSS = {
                width: this.currentItem[0].style.width,
                height: this.currentItem[0].style.height,
                position: this.currentItem.css("position"),
                top: this.currentItem.css("top"),
                left: this.currentItem.css("left")
            }), (!d[0].style.width || c.forceHelperSize) && d.width(this.currentItem.width()), (!d[0].style.height || c.forceHelperSize) && d.height(this.currentItem.height()), d
        },
        _adjustOffsetFromHelper: function (b) {
            "string" == typeof b && (b = b.split(" ")), a.isArray(b) && (b = {
                left: +b[0],
                top: +b[1] || 0
            }), "left" in b && (this.offset.click.left = b.left + this.margins.left), "right" in b && (this.offset.click.left = this.helperProportions.width - b.right + this.margins.left), "top" in b && (this.offset.click.top = b.top + this.margins.top), "bottom" in b && (this.offset.click.top = this.helperProportions.height - b.bottom + this.margins.top)
        },
        _getParentOffset: function () {
            this.offsetParent = this.helper.offsetParent();
            var b = this.offsetParent.offset();
            return "absolute" === this.cssPosition && this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) && (b.left += this.scrollParent.scrollLeft(), b.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && a.ui.ie) && (b = {
                top: 0,
                left: 0
            }), {
                top: b.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: b.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function () {
            if ("relative" === this.cssPosition) {
                var a = this.currentItem.position();
                return {
                    top: a.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                    left: a.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                }
            }
            return {top: 0, left: 0}
        },
        _cacheMargins: function () {
            this.margins = {
                left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,
                top: parseInt(this.currentItem.css("marginTop"), 10) || 0
            }
        },
        _cacheHelperProportions: function () {
            this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
        },
        _setContainment: function () {
            var b, c, d, e = this.options;
            "parent" === e.containment && (e.containment = this.helper[0].parentNode), ("document" === e.containment || "window" === e.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, a("document" === e.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (a("document" === e.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), /^(document|window|parent)$/.test(e.containment) || (b = a(e.containment)[0], c = a(e.containment).offset(), d = "hidden" !== a(b).css("overflow"), this.containment = [c.left + (parseInt(a(b).css("borderLeftWidth"), 10) || 0) + (parseInt(a(b).css("paddingLeft"), 10) || 0) - this.margins.left, c.top + (parseInt(a(b).css("borderTopWidth"), 10) || 0) + (parseInt(a(b).css("paddingTop"), 10) || 0) - this.margins.top, c.left + (d ? Math.max(b.scrollWidth, b.offsetWidth) : b.offsetWidth) - (parseInt(a(b).css("borderLeftWidth"), 10) || 0) - (parseInt(a(b).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, c.top + (d ? Math.max(b.scrollHeight, b.offsetHeight) : b.offsetHeight) - (parseInt(a(b).css("borderTopWidth"), 10) || 0) - (parseInt(a(b).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top])
        },
        _convertPositionTo: function (b, c) {
            c || (c = this.position);
            var d = "absolute" === b ? 1 : -1, e = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, f = /(html|body)/i.test(e[0].tagName);
            return {
                top: c.top + this.offset.relative.top * d + this.offset.parent.top * d - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : f ? 0 : e.scrollTop()) * d,
                left: c.left + this.offset.relative.left * d + this.offset.parent.left * d - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : f ? 0 : e.scrollLeft()) * d
            }
        },
        _generatePosition: function (b) {
            var c, d, e = this.options, f = b.pageX, g = b.pageY, h = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && a.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(h[0].tagName);
            return "relative" !== this.cssPosition || this.scrollParent[0] !== document && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (b.pageX - this.offset.click.left < this.containment[0] && (f = this.containment[0] + this.offset.click.left), b.pageY - this.offset.click.top < this.containment[1] && (g = this.containment[1] + this.offset.click.top), b.pageX - this.offset.click.left > this.containment[2] && (f = this.containment[2] + this.offset.click.left), b.pageY - this.offset.click.top > this.containment[3] && (g = this.containment[3] + this.offset.click.top)), e.grid && (c = this.originalPageY + Math.round((g - this.originalPageY) / e.grid[1]) * e.grid[1], g = this.containment ? c - this.offset.click.top >= this.containment[1] && c - this.offset.click.top <= this.containment[3] ? c : c - this.offset.click.top >= this.containment[1] ? c - e.grid[1] : c + e.grid[1] : c, d = this.originalPageX + Math.round((f - this.originalPageX) / e.grid[0]) * e.grid[0], f = this.containment ? d - this.offset.click.left >= this.containment[0] && d - this.offset.click.left <= this.containment[2] ? d : d - this.offset.click.left >= this.containment[0] ? d - e.grid[0] : d + e.grid[0] : d)), {
                top: g - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : i ? 0 : h.scrollTop()),
                left: f - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : i ? 0 : h.scrollLeft())
            }
        },
        _rearrange: function (a, b, c, d) {
            c ? c[0].appendChild(this.placeholder[0]) : b.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? b.item[0] : b.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
            var e = this.counter;
            this._delay(function () {
                e === this.counter && this.refreshPositions(!d)
            })
        },
        _clear: function (a, b) {
            function c(a, b, c) {
                return function (d) {
                    c._trigger(a, d, b._uiHash(b))
                }
            }

            this.reverting = !1;
            var d, e = [];
            if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] === this.currentItem[0]) {
                for (d in this._storedCSS)("auto" === this._storedCSS[d] || "static" === this._storedCSS[d]) && (this._storedCSS[d] = "");
                this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
            } else this.currentItem.show();
            for (this.fromOutside && !b && e.push(function (a) {
                this._trigger("receive", a, this._uiHash(this.fromOutside))
            }), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || b || e.push(function (a) {
                this._trigger("update", a, this._uiHash())
            }), this !== this.currentContainer && (b || (e.push(function (a) {
                this._trigger("remove", a, this._uiHash())
            }), e.push(function (a) {
                return function (b) {
                    a._trigger("receive", b, this._uiHash(this))
                }
            }.call(this, this.currentContainer)), e.push(function (a) {
                return function (b) {
                    a._trigger("update", b, this._uiHash(this))
                }
            }.call(this, this.currentContainer)))), d = this.containers.length - 1; d >= 0; d--)b || e.push(c("deactivate", this, this.containers[d])), this.containers[d].containerCache.over && (e.push(c("out", this, this.containers[d])), this.containers[d].containerCache.over = 0);
            if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, b || this._trigger("beforeStop", a, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.cancelHelperRemoval || (this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null), !b) {
                for (d = 0; d < e.length; d++)e[d].call(this, a);
                this._trigger("stop", a, this._uiHash())
            }
            return this.fromOutside = !1, !this.cancelHelperRemoval
        },
        _trigger: function () {
            a.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
        },
        _uiHash: function (b) {
            var c = b || this;
            return {
                helper: c.helper,
                placeholder: c.placeholder || a([]),
                position: c.position,
                originalPosition: c.originalPosition,
                offset: c.positionAbs,
                item: c.currentItem,
                sender: b ? b.element : null
            }
        }
    }), "ui-button ui-widget ui-state-default ui-corner-all"), i = "ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only", j = function () {
        var b = a(this);
        setTimeout(function () {
            b.find(":ui-button").button("refresh")
        }, 1)
    }, k = function (b) {
        var c = b.name, d = b.form, e = a([]);
        return c && (c = c.replace(/'/g, "\\'"), e = d ? a(d).find("[name='" + c + "'][type=radio]") : a("[name='" + c + "'][type=radio]", b.ownerDocument).filter(function () {
            return !this.form
        })), e
    };
    a.widget("ui.button", {
        version: "1.11.2",
        defaultElement: "<button>",
        options: {disabled: null, text: !0, label: null, icons: {primary: null, secondary: null}},
        _create: function () {
            this.element.closest("form").unbind("reset" + this.eventNamespace).bind("reset" + this.eventNamespace, j), "boolean" != typeof this.options.disabled ? this.options.disabled = !!this.element.prop("disabled") : this.element.prop("disabled", this.options.disabled), this._determineButtonType(), this.hasTitle = !!this.buttonElement.attr("title");
            var b = this, c = this.options, d = "checkbox" === this.type || "radio" === this.type, e = d ? "" : "ui-state-active";
            null === c.label && (c.label = "input" === this.type ? this.buttonElement.val() : this.buttonElement.html()), this._hoverable(this.buttonElement), this.buttonElement.addClass(h).attr("role", "button").bind("mouseenter" + this.eventNamespace, function () {
                c.disabled || this === g && a(this).addClass("ui-state-active")
            }).bind("mouseleave" + this.eventNamespace, function () {
                c.disabled || a(this).removeClass(e)
            }).bind("click" + this.eventNamespace, function (a) {
                c.disabled && (a.preventDefault(), a.stopImmediatePropagation())
            }), this._on({
                focus: function () {
                    this.buttonElement.addClass("ui-state-focus")
                }, blur: function () {
                    this.buttonElement.removeClass("ui-state-focus")
                }
            }), d && this.element.bind("change" + this.eventNamespace, function () {
                b.refresh()
            }), "checkbox" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, function () {
                return c.disabled ? !1 : void 0
            }) : "radio" === this.type ? this.buttonElement.bind("click" + this.eventNamespace, function () {
                if (c.disabled)return !1;
                a(this).addClass("ui-state-active"), b.buttonElement.attr("aria-pressed", "true");
                var d = b.element[0];
                k(d).not(d).map(function () {
                    return a(this).button("widget")[0]
                }).removeClass("ui-state-active").attr("aria-pressed", "false")
            }) : (this.buttonElement.bind("mousedown" + this.eventNamespace, function () {
                return c.disabled ? !1 : (a(this).addClass("ui-state-active"), g = this, void b.document.one("mouseup", function () {
                    g = null
                }))
            }).bind("mouseup" + this.eventNamespace, function () {
                return c.disabled ? !1 : void a(this).removeClass("ui-state-active")
            }).bind("keydown" + this.eventNamespace, function (b) {
                return c.disabled ? !1 : void((b.keyCode === a.ui.keyCode.SPACE || b.keyCode === a.ui.keyCode.ENTER) && a(this).addClass("ui-state-active"))
            }).bind("keyup" + this.eventNamespace + " blur" + this.eventNamespace, function () {
                a(this).removeClass("ui-state-active")
            }), this.buttonElement.is("a") && this.buttonElement.keyup(function (b) {
                b.keyCode === a.ui.keyCode.SPACE && a(this).click()
            })), this._setOption("disabled", c.disabled), this._resetButton()
        },
        _determineButtonType: function () {
            var a, b, c;
            this.element.is("[type=checkbox]") ? this.type = "checkbox" : this.element.is("[type=radio]") ? this.type = "radio" : this.element.is("input") ? this.type = "input" : this.type = "button", "checkbox" === this.type || "radio" === this.type ? (a = this.element.parents().last(), b = "label[for='" + this.element.attr("id") + "']", this.buttonElement = a.find(b), this.buttonElement.length || (a = a.length ? a.siblings() : this.element.siblings(), this.buttonElement = a.filter(b), this.buttonElement.length || (this.buttonElement = a.find(b))), this.element.addClass("ui-helper-hidden-accessible"), c = this.element.is(":checked"), c && this.buttonElement.addClass("ui-state-active"), this.buttonElement.prop("aria-pressed", c)) : this.buttonElement = this.element
        },
        widget: function () {
            return this.buttonElement
        },
        _destroy: function () {
            this.element.removeClass("ui-helper-hidden-accessible"), this.buttonElement.removeClass(h + " ui-state-active " + i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()), this.hasTitle || this.buttonElement.removeAttr("title")
        },
        _setOption: function (a, b) {
            return this._super(a, b), "disabled" === a ? (this.widget().toggleClass("ui-state-disabled", !!b), this.element.prop("disabled", !!b), void(b && ("checkbox" === this.type || "radio" === this.type ? this.buttonElement.removeClass("ui-state-focus") : this.buttonElement.removeClass("ui-state-focus ui-state-active")))) : void this._resetButton()
        },
        refresh: function () {
            var b = this.element.is("input, button") ? this.element.is(":disabled") : this.element.hasClass("ui-button-disabled");
            b !== this.options.disabled && this._setOption("disabled", b), "radio" === this.type ? k(this.element[0]).each(function () {
                a(this).is(":checked") ? a(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false")
            }) : "checkbox" === this.type && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"))
        },
        _resetButton: function () {
            if ("input" === this.type)return void(this.options.label && this.element.val(this.options.label));
            var b = this.buttonElement.removeClass(i), c = a("<span></span>", this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(), d = this.options.icons, e = d.primary && d.secondary, f = [];
            d.primary || d.secondary ? (this.options.text && f.push("ui-button-text-icon" + (e ? "s" : d.primary ? "-primary" : "-secondary")), d.primary && b.prepend("<span class='ui-button-icon-primary ui-icon " + d.primary + "'></span>"), d.secondary && b.append("<span class='ui-button-icon-secondary ui-icon " + d.secondary + "'></span>"), this.options.text || (f.push(e ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || b.attr("title", a.trim(c)))) : f.push("ui-button-text-only"), b.addClass(f.join(" "))
        }
    }), a.widget("ui.buttonset", {
        version: "1.11.2",
        options: {items: "button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},
        _create: function () {
            this.element.addClass("ui-buttonset")
        },
        _init: function () {
            this.refresh()
        },
        _setOption: function (a, b) {
            "disabled" === a && this.buttons.button("option", a, b), this._super(a, b)
        },
        refresh: function () {
            var b = "rtl" === this.element.css("direction"), c = this.element.find(this.options.items), d = c.filter(":ui-button");
            c.not(":ui-button").button(), d.button("refresh"), this.buttons = c.map(function () {
                return a(this).button("widget")[0]
            }).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b ? "ui-corner-right" : "ui-corner-left").end().filter(":last").addClass(b ? "ui-corner-left" : "ui-corner-right").end().end()
        },
        _destroy: function () {
            this.element.removeClass("ui-buttonset"), this.buttons.map(function () {
                return a(this).button("widget")[0]
            }).removeClass("ui-corner-left ui-corner-right").end().button("destroy")
        }
    });
    var l = (a.ui.button, a.widget("ui.dialog", {
        version: "1.11.2",
        options: {
            appendTo: "body",
            autoOpen: !0,
            buttons: [],
            closeOnEscape: !0,
            closeText: "Close",
            dialogClass: "",
            draggable: !0,
            hide: null,
            height: "auto",
            maxHeight: null,
            maxWidth: null,
            minHeight: 150,
            minWidth: 150,
            modal: !1,
            position: {
                my: "center", at: "center", of: window, collision: "fit", using: function (b) {
                    var c = a(this).css(b).offset().top;
                    0 > c && a(this).css("top", b.top - c)
                }
            },
            resizable: !0,
            show: null,
            title: null,
            width: 300,
            beforeClose: null,
            close: null,
            drag: null,
            dragStart: null,
            dragStop: null,
            focus: null,
            open: null,
            resize: null,
            resizeStart: null,
            resizeStop: null
        },
        sizeRelatedOptions: {
            buttons: !0,
            height: !0,
            maxHeight: !0,
            maxWidth: !0,
            minHeight: !0,
            minWidth: !0,
            width: !0
        },
        resizableRelatedOptions: {maxHeight: !0, maxWidth: !0, minHeight: !0, minWidth: !0},
        _create: function () {
            this.originalCss = {
                display: this.element[0].style.display,
                width: this.element[0].style.width,
                minHeight: this.element[0].style.minHeight,
                maxHeight: this.element[0].style.maxHeight,
                height: this.element[0].style.height
            }, this.originalPosition = {
                parent: this.element.parent(),
                index: this.element.parent().children().index(this.element)
            }, this.originalTitle = this.element.attr("title"), this.options.title = this.options.title || this.originalTitle, this._createWrapper(), this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog), this._createTitlebar(), this._createButtonPane(), this.options.draggable && a.fn.draggable && this._makeDraggable(), this.options.resizable && a.fn.resizable && this._makeResizable(), this._isOpen = !1, this._trackFocus()
        },
        _init: function () {
            this.options.autoOpen && this.open()
        },
        _appendTo: function () {
            var b = this.options.appendTo;
            return b && (b.jquery || b.nodeType) ? a(b) : this.document.find(b || "body").eq(0)
        },
        _destroy: function () {
            var a, b = this.originalPosition;
            this._destroyOverlay(), this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(), this.uiDialog.stop(!0, !0).remove(), this.originalTitle && this.element.attr("title", this.originalTitle), a = b.parent.children().eq(b.index), a.length && a[0] !== this.element[0] ? a.before(this.element) : b.parent.append(this.element)
        },
        widget: function () {
            return this.uiDialog
        },
        disable: a.noop,
        enable: a.noop,
        close: function (b) {
            var c, d = this;
            if (this._isOpen && this._trigger("beforeClose", b) !== !1) {
                if (this._isOpen = !1, this._focusedElement = null, this._destroyOverlay(), this._untrackInstance(), !this.opener.filter(":focusable").focus().length)try {
                    c = this.document[0].activeElement, c && "body" !== c.nodeName.toLowerCase() && a(c).blur()
                } catch (e) {
                }
                this._hide(this.uiDialog, this.options.hide, function () {
                    d._trigger("close", b)
                })
            }
        },
        isOpen: function () {
            return this._isOpen
        },
        moveToTop: function () {
            this._moveToTop()
        },
        _moveToTop: function (b, c) {
            var d = !1, e = this.uiDialog.siblings(".ui-front:visible").map(function () {
                return +a(this).css("z-index")
            }).get(), f = Math.max.apply(null, e);
            return f >= +this.uiDialog.css("z-index") && (this.uiDialog.css("z-index", f + 1), d = !0), d && !c && this._trigger("focus", b), d
        },
        open: function () {
            var b = this;
            return this._isOpen ? void(this._moveToTop() && this._focusTabbable()) : (this._isOpen = !0, this.opener = a(this.document[0].activeElement), this._size(), this._position(), this._createOverlay(), this._moveToTop(null, !0), this.overlay && this.overlay.css("z-index", this.uiDialog.css("z-index") - 1), this._show(this.uiDialog, this.options.show, function () {
                b._focusTabbable(), b._trigger("focus")
            }), this._makeFocusTarget(), void this._trigger("open"))
        },
        _focusTabbable: function () {
            var a = this._focusedElement;
            a || (a = this.element.find("[autofocus]")), a.length || (a = this.element.find(":tabbable")), a.length || (a = this.uiDialogButtonPane.find(":tabbable")), a.length || (a = this.uiDialogTitlebarClose.filter(":tabbable")), a.length || (a = this.uiDialog), a.eq(0).focus()
        },
        _keepFocus: function (b) {
            function c() {
                var b = this.document[0].activeElement, c = this.uiDialog[0] === b || a.contains(this.uiDialog[0], b);
                c || this._focusTabbable()
            }

            b.preventDefault(), c.call(this), this._delay(c)
        },
        _createWrapper: function () {
            this.uiDialog = a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front " + this.options.dialogClass).hide().attr({
                tabIndex: -1,
                role: "dialog"
            }).appendTo(this._appendTo()), this._on(this.uiDialog, {
                keydown: function (b) {
                    if (this.options.closeOnEscape && !b.isDefaultPrevented() && b.keyCode && b.keyCode === a.ui.keyCode.ESCAPE)return b.preventDefault(), void this.close(b);
                    if (b.keyCode === a.ui.keyCode.TAB && !b.isDefaultPrevented()) {
                        var c = this.uiDialog.find(":tabbable"), d = c.filter(":first"), e = c.filter(":last");
                        b.target !== e[0] && b.target !== this.uiDialog[0] || b.shiftKey ? b.target !== d[0] && b.target !== this.uiDialog[0] || !b.shiftKey || (this._delay(function () {
                            e.focus()
                        }), b.preventDefault()) : (this._delay(function () {
                            d.focus()
                        }), b.preventDefault())
                    }
                }, mousedown: function (a) {
                    this._moveToTop(a) && this._focusTabbable()
                }
            }), this.element.find("[aria-describedby]").length || this.uiDialog.attr({"aria-describedby": this.element.uniqueId().attr("id")})
        },
        _createTitlebar: function () {
            var b;
            this.uiDialogTitlebar = a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog), this._on(this.uiDialogTitlebar, {
                mousedown: function (b) {
                    a(b.target).closest(".ui-dialog-titlebar-close") || this.uiDialog.focus()
                }
            }), this.uiDialogTitlebarClose = a("<button type='button'></button>").button({
                label: this.options.closeText,
                icons: {primary: "ui-icon-closethick"},
                text: !1
            }).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar), this._on(this.uiDialogTitlebarClose, {
                click: function (a) {
                    a.preventDefault(), this.close(a)
                }
            }), b = a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar), this._title(b), this.uiDialog.attr({"aria-labelledby": b.attr("id")})
        },
        _title: function (a) {
            this.options.title || a.html("&#160;"), a.text(this.options.title)
        },
        _createButtonPane: function () {
            this.uiDialogButtonPane = a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"), this.uiButtonSet = a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane), this._createButtons()
        },
        _createButtons: function () {
            var b = this, c = this.options.buttons;
            return this.uiDialogButtonPane.remove(), this.uiButtonSet.empty(), a.isEmptyObject(c) || a.isArray(c) && !c.length ? void this.uiDialog.removeClass("ui-dialog-buttons") : (a.each(c, function (c, d) {
                var e, f;
                d = a.isFunction(d) ? {
                    click: d,
                    text: c
                } : d, d = a.extend({type: "button"}, d), e = d.click, d.click = function () {
                    e.apply(b.element[0], arguments)
                }, f = {
                    icons: d.icons,
                    text: d.showText
                }, delete d.icons, delete d.showText, a("<button></button>", d).button(f).appendTo(b.uiButtonSet)
            }), this.uiDialog.addClass("ui-dialog-buttons"), void this.uiDialogButtonPane.appendTo(this.uiDialog))
        },
        _makeDraggable: function () {
            function b(a) {
                return {position: a.position, offset: a.offset}
            }

            var c = this, d = this.options;
            this.uiDialog.draggable({
                cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",
                handle: ".ui-dialog-titlebar",
                containment: "document",
                start: function (d, e) {
                    a(this).addClass("ui-dialog-dragging"), c._blockFrames(), c._trigger("dragStart", d, b(e))
                },
                drag: function (a, d) {
                    c._trigger("drag", a, b(d))
                },
                stop: function (e, f) {
                    var g = f.offset.left - c.document.scrollLeft(), h = f.offset.top - c.document.scrollTop();
                    d.position = {
                        my: "left top",
                        at: "left" + (g >= 0 ? "+" : "") + g + " top" + (h >= 0 ? "+" : "") + h,
                        of: c.window
                    }, a(this).removeClass("ui-dialog-dragging"), c._unblockFrames(), c._trigger("dragStop", e, b(f))
                }
            })
        },
        _makeResizable: function () {
            function b(a) {
                return {
                    originalPosition: a.originalPosition,
                    originalSize: a.originalSize,
                    position: a.position,
                    size: a.size
                }
            }

            var c = this, d = this.options, e = d.resizable, f = this.uiDialog.css("position"), g = "string" == typeof e ? e : "n,e,s,w,se,sw,ne,nw";
            this.uiDialog.resizable({
                cancel: ".ui-dialog-content",
                containment: "document",
                alsoResize: this.element,
                maxWidth: d.maxWidth,
                maxHeight: d.maxHeight,
                minWidth: d.minWidth,
                minHeight: this._minHeight(),
                handles: g,
                start: function (d, e) {
                    a(this).addClass("ui-dialog-resizing"), c._blockFrames(), c._trigger("resizeStart", d, b(e))
                },
                resize: function (a, d) {
                    c._trigger("resize", a, b(d))
                },
                stop: function (e, f) {
                    var g = c.uiDialog.offset(), h = g.left - c.document.scrollLeft(), i = g.top - c.document.scrollTop();
                    d.height = c.uiDialog.height(), d.width = c.uiDialog.width(), d.position = {
                        my: "left top",
                        at: "left" + (h >= 0 ? "+" : "") + h + " top" + (i >= 0 ? "+" : "") + i,
                        of: c.window
                    }, a(this).removeClass("ui-dialog-resizing"), c._unblockFrames(), c._trigger("resizeStop", e, b(f))
                }
            }).css("position", f)
        },
        _trackFocus: function () {
            this._on(this.widget(), {
                focusin: function (b) {
                    this._makeFocusTarget(), this._focusedElement = a(b.target)
                }
            })
        },
        _makeFocusTarget: function () {
            this._untrackInstance(), this._trackingInstances().unshift(this)
        },
        _untrackInstance: function () {
            var b = this._trackingInstances(), c = a.inArray(this, b);
            -1 !== c && b.splice(c, 1)
        },
        _trackingInstances: function () {
            var a = this.document.data("ui-dialog-instances");
            return a || (a = [], this.document.data("ui-dialog-instances", a)), a
        },
        _minHeight: function () {
            var a = this.options;
            return "auto" === a.height ? a.minHeight : Math.min(a.minHeight, a.height)
        },
        _position: function () {
            var a = this.uiDialog.is(":visible");
            a || this.uiDialog.show(), this.uiDialog.position(this.options.position), a || this.uiDialog.hide()
        },
        _setOptions: function (b) {
            var c = this, d = !1, e = {};
            a.each(b, function (a, b) {
                c._setOption(a, b), a in c.sizeRelatedOptions && (d = !0), a in c.resizableRelatedOptions && (e[a] = b)
            }), d && (this._size(), this._position()), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", e)
        },
        _setOption: function (a, b) {
            var c, d, e = this.uiDialog;
            "dialogClass" === a && e.removeClass(this.options.dialogClass).addClass(b), "disabled" !== a && (this._super(a, b), "appendTo" === a && this.uiDialog.appendTo(this._appendTo()), "buttons" === a && this._createButtons(), "closeText" === a && this.uiDialogTitlebarClose.button({label: "" + b}), "draggable" === a && (c = e.is(":data(ui-draggable)"), c && !b && e.draggable("destroy"), !c && b && this._makeDraggable()), "position" === a && this._position(), "resizable" === a && (d = e.is(":data(ui-resizable)"), d && !b && e.resizable("destroy"), d && "string" == typeof b && e.resizable("option", "handles", b), d || b === !1 || this._makeResizable()), "title" === a && this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))
        },
        _size: function () {
            var a, b, c, d = this.options;
            this.element.show().css({
                width: "auto",
                minHeight: 0,
                maxHeight: "none",
                height: 0
            }), d.minWidth > d.width && (d.width = d.minWidth), a = this.uiDialog.css({
                height: "auto",
                width: d.width
            }).outerHeight(), b = Math.max(0, d.minHeight - a), c = "number" == typeof d.maxHeight ? Math.max(0, d.maxHeight - a) : "none", "auto" === d.height ? this.element.css({
                minHeight: b,
                maxHeight: c,
                height: "auto"
            }) : this.element.height(Math.max(0, d.height - a)), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight())
        },
        _blockFrames: function () {
            this.iframeBlocks = this.document.find("iframe").map(function () {
                var b = a(this);
                return a("<div>").css({
                    position: "absolute",
                    width: b.outerWidth(),
                    height: b.outerHeight()
                }).appendTo(b.parent()).offset(b.offset())[0]
            })
        },
        _unblockFrames: function () {
            this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks)
        },
        _allowInteraction: function (b) {
            return a(b.target).closest(".ui-dialog").length ? !0 : !!a(b.target).closest(".ui-datepicker").length
        },
        _createOverlay: function () {
            if (this.options.modal) {
                var b = !0;
                this._delay(function () {
                    b = !1
                }), this.document.data("ui-dialog-overlays") || this._on(this.document, {
                    focusin: function (a) {
                        b || this._allowInteraction(a) || (a.preventDefault(), this._trackingInstances()[0]._focusTabbable())
                    }
                }), this.overlay = a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()), this._on(this.overlay, {mousedown: "_keepFocus"}), this.document.data("ui-dialog-overlays", (this.document.data("ui-dialog-overlays") || 0) + 1)
            }
        },
        _destroyOverlay: function () {
            if (this.options.modal && this.overlay) {
                var a = this.document.data("ui-dialog-overlays") - 1;
                a ? this.document.data("ui-dialog-overlays", a) : this.document.unbind("focusin").removeData("ui-dialog-overlays"), this.overlay.remove(), this.overlay = null
            }
        }
    }), "ui-effects-"), m = a;
    a.effects = {effect: {}}, function (a, b) {
        function c(a, b, c) {
            var d = l[b.type] || {};
            return null == a ? c || !b.def ? null : b.def : (a = d.floor ? ~~a : parseFloat(a), isNaN(a) ? b.def : d.mod ? (a + d.mod) % d.mod : 0 > a ? 0 : d.max < a ? d.max : a)
        }

        function d(b) {
            var c = j(), d = c._rgba = [];
            return b = b.toLowerCase(), o(i, function (a, e) {
                var f, g = e.re.exec(b), h = g && e.parse(g), i = e.space || "rgba";
                return h ? (f = c[i](h), c[k[i].cache] = f[k[i].cache], d = c._rgba = f._rgba, !1) : void 0
            }), d.length ? ("0,0,0,0" === d.join() && a.extend(d, f.transparent), c) : f[b]
        }

        function e(a, b, c) {
            return c = (c + 1) % 1, 1 > 6 * c ? a + (b - a) * c * 6 : 1 > 2 * c ? b : 2 > 3 * c ? a + (b - a) * (2 / 3 - c) * 6 : a
        }

        var f, g = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor", h = /^([\-+])=\s*(\d+\.?\d*)/, i = [{
            re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
            parse: function (a) {
                return [a[1], a[2], a[3], a[4]]
            }
        }, {
            re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
            parse: function (a) {
                return [2.55 * a[1], 2.55 * a[2], 2.55 * a[3], a[4]]
            }
        }, {
            re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/, parse: function (a) {
                return [parseInt(a[1], 16), parseInt(a[2], 16), parseInt(a[3], 16)]
            }
        }, {
            re: /#([a-f0-9])([a-f0-9])([a-f0-9])/, parse: function (a) {
                return [parseInt(a[1] + a[1], 16), parseInt(a[2] + a[2], 16), parseInt(a[3] + a[3], 16)]
            }
        }, {
            re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
            space: "hsla",
            parse: function (a) {
                return [a[1], a[2] / 100, a[3] / 100, a[4]]
            }
        }], j = a.Color = function (b, c, d, e) {
            return new a.Color.fn.parse(b, c, d, e)
        }, k = {
            rgba: {
                props: {
                    red: {idx: 0, type: "byte"},
                    green: {idx: 1, type: "byte"},
                    blue: {idx: 2, type: "byte"}
                }
            },
            hsla: {
                props: {
                    hue: {idx: 0, type: "degrees"},
                    saturation: {idx: 1, type: "percent"},
                    lightness: {idx: 2, type: "percent"}
                }
            }
        }, l = {
            "byte": {floor: !0, max: 255},
            percent: {max: 1},
            degrees: {mod: 360, floor: !0}
        }, m = j.support = {}, n = a("<p>")[0], o = a.each;
        n.style.cssText = "background-color:rgba(1,1,1,.5)", m.rgba = n.style.backgroundColor.indexOf("rgba") > -1, o(k, function (a, b) {
            b.cache = "_" + a, b.props.alpha = {idx: 3, type: "percent", def: 1}
        }), j.fn = a.extend(j.prototype, {
            parse: function (e, g, h, i) {
                if (e === b)return this._rgba = [null, null, null, null], this;
                (e.jquery || e.nodeType) && (e = a(e).css(g), g = b);
                var l = this, m = a.type(e), n = this._rgba = [];
                return g !== b && (e = [e, g, h, i], m = "array"), "string" === m ? this.parse(d(e) || f._default) : "array" === m ? (o(k.rgba.props, function (a, b) {
                    n[b.idx] = c(e[b.idx], b)
                }), this) : "object" === m ? (e instanceof j ? o(k, function (a, b) {
                    e[b.cache] && (l[b.cache] = e[b.cache].slice())
                }) : o(k, function (b, d) {
                    var f = d.cache;
                    o(d.props, function (a, b) {
                        if (!l[f] && d.to) {
                            if ("alpha" === a || null == e[a])return;
                            l[f] = d.to(l._rgba)
                        }
                        l[f][b.idx] = c(e[a], b, !0)
                    }), l[f] && a.inArray(null, l[f].slice(0, 3)) < 0 && (l[f][3] = 1, d.from && (l._rgba = d.from(l[f])))
                }), this) : void 0
            }, is: function (a) {
                var b = j(a), c = !0, d = this;
                return o(k, function (a, e) {
                    var f, g = b[e.cache];
                    return g && (f = d[e.cache] || e.to && e.to(d._rgba) || [], o(e.props, function (a, b) {
                        return null != g[b.idx] ? c = g[b.idx] === f[b.idx] : void 0
                    })), c
                }), c
            }, _space: function () {
                var a = [], b = this;
                return o(k, function (c, d) {
                    b[d.cache] && a.push(c)
                }), a.pop()
            }, transition: function (a, b) {
                var d = j(a), e = d._space(), f = k[e], g = 0 === this.alpha() ? j("transparent") : this, h = g[f.cache] || f.to(g._rgba), i = h.slice();
                return d = d[f.cache], o(f.props, function (a, e) {
                    var f = e.idx, g = h[f], j = d[f], k = l[e.type] || {};
                    null !== j && (null === g ? i[f] = j : (k.mod && (j - g > k.mod / 2 ? g += k.mod : g - j > k.mod / 2 && (g -= k.mod)),
                        i[f] = c((j - g) * b + g, e)))
                }), this[e](i)
            }, blend: function (b) {
                if (1 === this._rgba[3])return this;
                var c = this._rgba.slice(), d = c.pop(), e = j(b)._rgba;
                return j(a.map(c, function (a, b) {
                    return (1 - d) * e[b] + d * a
                }))
            }, toRgbaString: function () {
                var b = "rgba(", c = a.map(this._rgba, function (a, b) {
                    return null == a ? b > 2 ? 1 : 0 : a
                });
                return 1 === c[3] && (c.pop(), b = "rgb("), b + c.join() + ")"
            }, toHslaString: function () {
                var b = "hsla(", c = a.map(this.hsla(), function (a, b) {
                    return null == a && (a = b > 2 ? 1 : 0), b && 3 > b && (a = Math.round(100 * a) + "%"), a
                });
                return 1 === c[3] && (c.pop(), b = "hsl("), b + c.join() + ")"
            }, toHexString: function (b) {
                var c = this._rgba.slice(), d = c.pop();
                return b && c.push(~~(255 * d)), "#" + a.map(c, function (a) {
                    return a = (a || 0).toString(16), 1 === a.length ? "0" + a : a
                }).join("")
            }, toString: function () {
                return 0 === this._rgba[3] ? "transparent" : this.toRgbaString()
            }
        }), j.fn.parse.prototype = j.fn, k.hsla.to = function (a) {
            if (null == a[0] || null == a[1] || null == a[2])return [null, null, null, a[3]];
            var b, c, d = a[0] / 255, e = a[1] / 255, f = a[2] / 255, g = a[3], h = Math.max(d, e, f), i = Math.min(d, e, f), j = h - i, k = h + i, l = .5 * k;
            return b = i === h ? 0 : d === h ? 60 * (e - f) / j + 360 : e === h ? 60 * (f - d) / j + 120 : 60 * (d - e) / j + 240, c = 0 === j ? 0 : .5 >= l ? j / k : j / (2 - k), [Math.round(b) % 360, c, l, null == g ? 1 : g]
        }, k.hsla.from = function (a) {
            if (null == a[0] || null == a[1] || null == a[2])return [null, null, null, a[3]];
            var b = a[0] / 360, c = a[1], d = a[2], f = a[3], g = .5 >= d ? d * (1 + c) : d + c - d * c, h = 2 * d - g;
            return [Math.round(255 * e(h, g, b + 1 / 3)), Math.round(255 * e(h, g, b)), Math.round(255 * e(h, g, b - 1 / 3)), f]
        }, o(k, function (d, e) {
            var f = e.props, g = e.cache, i = e.to, k = e.from;
            j.fn[d] = function (d) {
                if (i && !this[g] && (this[g] = i(this._rgba)), d === b)return this[g].slice();
                var e, h = a.type(d), l = "array" === h || "object" === h ? d : arguments, m = this[g].slice();
                return o(f, function (a, b) {
                    var d = l["object" === h ? a : b.idx];
                    null == d && (d = m[b.idx]), m[b.idx] = c(d, b)
                }), k ? (e = j(k(m)), e[g] = m, e) : j(m)
            }, o(f, function (b, c) {
                j.fn[b] || (j.fn[b] = function (e) {
                    var f, g = a.type(e), i = "alpha" === b ? this._hsla ? "hsla" : "rgba" : d, j = this[i](), k = j[c.idx];
                    return "undefined" === g ? k : ("function" === g && (e = e.call(this, k), g = a.type(e)), null == e && c.empty ? this : ("string" === g && (f = h.exec(e), f && (e = k + parseFloat(f[2]) * ("+" === f[1] ? 1 : -1))), j[c.idx] = e, this[i](j)))
                })
            })
        }), j.hook = function (b) {
            var c = b.split(" ");
            o(c, function (b, c) {
                a.cssHooks[c] = {
                    set: function (b, e) {
                        var f, g, h = "";
                        if ("transparent" !== e && ("string" !== a.type(e) || (f = d(e)))) {
                            if (e = j(f || e), !m.rgba && 1 !== e._rgba[3]) {
                                for (g = "backgroundColor" === c ? b.parentNode : b; ("" === h || "transparent" === h) && g && g.style;)try {
                                    h = a.css(g, "backgroundColor"), g = g.parentNode
                                } catch (i) {
                                }
                                e = e.blend(h && "transparent" !== h ? h : "_default")
                            }
                            e = e.toRgbaString()
                        }
                        try {
                            b.style[c] = e
                        } catch (i) {
                        }
                    }
                }, a.fx.step[c] = function (b) {
                    b.colorInit || (b.start = j(b.elem, c), b.end = j(b.end), b.colorInit = !0), a.cssHooks[c].set(b.elem, b.start.transition(b.end, b.pos))
                }
            })
        }, j.hook(g), a.cssHooks.borderColor = {
            expand: function (a) {
                var b = {};
                return o(["Top", "Right", "Bottom", "Left"], function (c, d) {
                    b["border" + d + "Color"] = a
                }), b
            }
        }, f = a.Color.names = {
            aqua: "#00ffff",
            black: "#000000",
            blue: "#0000ff",
            fuchsia: "#ff00ff",
            gray: "#808080",
            green: "#008000",
            lime: "#00ff00",
            maroon: "#800000",
            navy: "#000080",
            olive: "#808000",
            purple: "#800080",
            red: "#ff0000",
            silver: "#c0c0c0",
            teal: "#008080",
            white: "#ffffff",
            yellow: "#ffff00",
            transparent: [null, null, null, 0],
            _default: "#ffffff"
        }
    }(m), function () {
        function b(b) {
            var c, d, e = b.ownerDocument.defaultView ? b.ownerDocument.defaultView.getComputedStyle(b, null) : b.currentStyle, f = {};
            if (e && e.length && e[0] && e[e[0]])for (d = e.length; d--;)c = e[d], "string" == typeof e[c] && (f[a.camelCase(c)] = e[c]); else for (c in e)"string" == typeof e[c] && (f[c] = e[c]);
            return f
        }

        function c(b, c) {
            var d, f, g = {};
            for (d in c)f = c[d], b[d] !== f && (e[d] || (a.fx.step[d] || !isNaN(parseFloat(f))) && (g[d] = f));
            return g
        }

        var d = ["add", "remove", "toggle"], e = {
            border: 1,
            borderBottom: 1,
            borderColor: 1,
            borderLeft: 1,
            borderRight: 1,
            borderTop: 1,
            borderWidth: 1,
            margin: 1,
            padding: 1
        };
        a.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], function (b, c) {
            a.fx.step[c] = function (a) {
                ("none" !== a.end && !a.setAttr || 1 === a.pos && !a.setAttr) && (m.style(a.elem, c, a.end), a.setAttr = !0)
            }
        }), a.fn.addBack || (a.fn.addBack = function (a) {
            return this.add(null == a ? this.prevObject : this.prevObject.filter(a))
        }), a.effects.animateClass = function (e, f, g, h) {
            var i = a.speed(f, g, h);
            return this.queue(function () {
                var f, g = a(this), h = g.attr("class") || "", j = i.children ? g.find("*").addBack() : g;
                j = j.map(function () {
                    var c = a(this);
                    return {el: c, start: b(this)}
                }), f = function () {
                    a.each(d, function (a, b) {
                        e[b] && g[b + "Class"](e[b])
                    })
                }, f(), j = j.map(function () {
                    return this.end = b(this.el[0]), this.diff = c(this.start, this.end), this
                }), g.attr("class", h), j = j.map(function () {
                    var b = this, c = a.Deferred(), d = a.extend({}, i, {
                        queue: !1, complete: function () {
                            c.resolve(b)
                        }
                    });
                    return this.el.animate(this.diff, d), c.promise()
                }), a.when.apply(a, j.get()).done(function () {
                    f(), a.each(arguments, function () {
                        var b = this.el;
                        a.each(this.diff, function (a) {
                            b.css(a, "")
                        })
                    }), i.complete.call(g[0])
                })
            })
        }, a.fn.extend({
            addClass: function (b) {
                return function (c, d, e, f) {
                    return d ? a.effects.animateClass.call(this, {add: c}, d, e, f) : b.apply(this, arguments)
                }
            }(a.fn.addClass), removeClass: function (b) {
                return function (c, d, e, f) {
                    return arguments.length > 1 ? a.effects.animateClass.call(this, {remove: c}, d, e, f) : b.apply(this, arguments)
                }
            }(a.fn.removeClass), toggleClass: function (b) {
                return function (c, d, e, f, g) {
                    return "boolean" == typeof d || void 0 === d ? e ? a.effects.animateClass.call(this, d ? {add: c} : {remove: c}, e, f, g) : b.apply(this, arguments) : a.effects.animateClass.call(this, {toggle: c}, d, e, f)
                }
            }(a.fn.toggleClass), switchClass: function (b, c, d, e, f) {
                return a.effects.animateClass.call(this, {add: c, remove: b}, d, e, f)
            }
        })
    }(), function () {
        function b(b, c, d, e) {
            return a.isPlainObject(b) && (c = b, b = b.effect), b = {effect: b}, null == c && (c = {}), a.isFunction(c) && (e = c, d = null, c = {}), ("number" == typeof c || a.fx.speeds[c]) && (e = d, d = c, c = {}), a.isFunction(d) && (e = d, d = null), c && a.extend(b, c), d = d || c.duration, b.duration = a.fx.off ? 0 : "number" == typeof d ? d : d in a.fx.speeds ? a.fx.speeds[d] : a.fx.speeds._default, b.complete = e || c.complete, b
        }

        function c(b) {
            return !b || "number" == typeof b || a.fx.speeds[b] ? !0 : "string" != typeof b || a.effects.effect[b] ? a.isFunction(b) ? !0 : "object" != typeof b || b.effect ? !1 : !0 : !0
        }

        a.extend(a.effects, {
            version: "1.11.2", save: function (a, b) {
                for (var c = 0; c < b.length; c++)null !== b[c] && a.data(l + b[c], a[0].style[b[c]])
            }, restore: function (a, b) {
                var c, d;
                for (d = 0; d < b.length; d++)null !== b[d] && (c = a.data(l + b[d]), void 0 === c && (c = ""), a.css(b[d], c))
            }, setMode: function (a, b) {
                return "toggle" === b && (b = a.is(":hidden") ? "show" : "hide"), b
            }, getBaseline: function (a, b) {
                var c, d;
                switch (a[0]) {
                    case"top":
                        c = 0;
                        break;
                    case"middle":
                        c = .5;
                        break;
                    case"bottom":
                        c = 1;
                        break;
                    default:
                        c = a[0] / b.height
                }
                switch (a[1]) {
                    case"left":
                        d = 0;
                        break;
                    case"center":
                        d = .5;
                        break;
                    case"right":
                        d = 1;
                        break;
                    default:
                        d = a[1] / b.width
                }
                return {x: d, y: c}
            }, createWrapper: function (b) {
                if (b.parent().is(".ui-effects-wrapper"))return b.parent();
                var c = {
                    width: b.outerWidth(!0),
                    height: b.outerHeight(!0),
                    "float": b.css("float")
                }, d = a("<div></div>").addClass("ui-effects-wrapper").css({
                    fontSize: "100%",
                    background: "transparent",
                    border: "none",
                    margin: 0,
                    padding: 0
                }), e = {width: b.width(), height: b.height()}, f = document.activeElement;
                try {
                    f.id
                } catch (g) {
                    f = document.body
                }
                return b.wrap(d), (b[0] === f || a.contains(b[0], f)) && a(f).focus(), d = b.parent(), "static" === b.css("position") ? (d.css({position: "relative"}), b.css({position: "relative"})) : (a.extend(c, {
                    position: b.css("position"),
                    zIndex: b.css("z-index")
                }), a.each(["top", "left", "bottom", "right"], function (a, d) {
                    c[d] = b.css(d), isNaN(parseInt(c[d], 10)) && (c[d] = "auto")
                }), b.css({
                    position: "relative",
                    top: 0,
                    left: 0,
                    right: "auto",
                    bottom: "auto"
                })), b.css(e), d.css(c).show()
            }, removeWrapper: function (b) {
                var c = document.activeElement;
                return b.parent().is(".ui-effects-wrapper") && (b.parent().replaceWith(b), (b[0] === c || a.contains(b[0], c)) && a(c).focus()), b
            }, setTransition: function (b, c, d, e) {
                return e = e || {}, a.each(c, function (a, c) {
                    var f = b.cssUnit(c);
                    f[0] > 0 && (e[c] = f[0] * d + f[1])
                }), e
            }
        }), a.fn.extend({
            effect: function () {
                function c(b) {
                    function c() {
                        a.isFunction(f) && f.call(e[0]), a.isFunction(b) && b()
                    }

                    var e = a(this), f = d.complete, h = d.mode;
                    (e.is(":hidden") ? "hide" === h : "show" === h) ? (e[h](), c()) : g.call(e[0], d, c)
                }

                var d = b.apply(this, arguments), e = d.mode, f = d.queue, g = a.effects.effect[d.effect];
                return a.fx.off || !g ? e ? this[e](d.duration, d.complete) : this.each(function () {
                    d.complete && d.complete.call(this)
                }) : f === !1 ? this.each(c) : this.queue(f || "fx", c)
            }, show: function (a) {
                return function (d) {
                    if (c(d))return a.apply(this, arguments);
                    var e = b.apply(this, arguments);
                    return e.mode = "show", this.effect.call(this, e)
                }
            }(a.fn.show), hide: function (a) {
                return function (d) {
                    if (c(d))return a.apply(this, arguments);
                    var e = b.apply(this, arguments);
                    return e.mode = "hide", this.effect.call(this, e)
                }
            }(a.fn.hide), toggle: function (a) {
                return function (d) {
                    if (c(d) || "boolean" == typeof d)return a.apply(this, arguments);
                    var e = b.apply(this, arguments);
                    return e.mode = "toggle", this.effect.call(this, e)
                }
            }(a.fn.toggle), cssUnit: function (b) {
                var c = this.css(b), d = [];
                return a.each(["em", "px", "%", "pt"], function (a, b) {
                    c.indexOf(b) > 0 && (d = [parseFloat(c), b])
                }), d
            }
        })
    }(), function () {
        var b = {};
        a.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], function (a, c) {
            b[c] = function (b) {
                return Math.pow(b, a + 2)
            }
        }), a.extend(b, {
            Sine: function (a) {
                return 1 - Math.cos(a * Math.PI / 2)
            }, Circ: function (a) {
                return 1 - Math.sqrt(1 - a * a)
            }, Elastic: function (a) {
                return 0 === a || 1 === a ? a : -Math.pow(2, 8 * (a - 1)) * Math.sin((80 * (a - 1) - 7.5) * Math.PI / 15)
            }, Back: function (a) {
                return a * a * (3 * a - 2)
            }, Bounce: function (a) {
                for (var b, c = 4; a < ((b = Math.pow(2, --c)) - 1) / 11;);
                return 1 / Math.pow(4, 3 - c) - 7.5625 * Math.pow((3 * b - 2) / 22 - a, 2)
            }
        }), a.each(b, function (b, c) {
            a.easing["easeIn" + b] = c, a.easing["easeOut" + b] = function (a) {
                return 1 - c(1 - a)
            }, a.easing["easeInOut" + b] = function (a) {
                return .5 > a ? c(2 * a) / 2 : 1 - c(-2 * a + 2) / 2
            }
        })
    }();
    a.effects, a.effects.effect.blind = function (b, c) {
        var d, e, f, g = a(this), h = /up|down|vertical/, i = /up|left|vertical|horizontal/, j = ["position", "top", "bottom", "left", "right", "height", "width"], k = a.effects.setMode(g, b.mode || "hide"), l = b.direction || "up", m = h.test(l), n = m ? "height" : "width", o = m ? "top" : "left", p = i.test(l), q = {}, r = "show" === k;
        g.parent().is(".ui-effects-wrapper") ? a.effects.save(g.parent(), j) : a.effects.save(g, j), g.show(), d = a.effects.createWrapper(g).css({overflow: "hidden"}), e = d[n](), f = parseFloat(d.css(o)) || 0, q[n] = r ? e : 0, p || (g.css(m ? "bottom" : "right", 0).css(m ? "top" : "left", "auto").css({position: "absolute"}), q[o] = r ? f : e + f), r && (d.css(n, 0), p || d.css(o, f + e)), d.animate(q, {
            duration: b.duration,
            easing: b.easing,
            queue: !1,
            complete: function () {
                "hide" === k && g.hide(), a.effects.restore(g, j), a.effects.removeWrapper(g), c()
            }
        })
    }, a.effects.effect.bounce = function (b, c) {
        var d, e, f, g = a(this), h = ["position", "top", "bottom", "left", "right", "height", "width"], i = a.effects.setMode(g, b.mode || "effect"), j = "hide" === i, k = "show" === i, l = b.direction || "up", m = b.distance, n = b.times || 5, o = 2 * n + (k || j ? 1 : 0), p = b.duration / o, q = b.easing, r = "up" === l || "down" === l ? "top" : "left", s = "up" === l || "left" === l, t = g.queue(), u = t.length;
        for ((k || j) && h.push("opacity"), a.effects.save(g, h), g.show(), a.effects.createWrapper(g), m || (m = g["top" === r ? "outerHeight" : "outerWidth"]() / 3), k && (f = {opacity: 1}, f[r] = 0, g.css("opacity", 0).css(r, s ? 2 * -m : 2 * m).animate(f, p, q)), j && (m /= Math.pow(2, n - 1)), f = {}, f[r] = 0, d = 0; n > d; d++)e = {}, e[r] = (s ? "-=" : "+=") + m, g.animate(e, p, q).animate(f, p, q), m = j ? 2 * m : m / 2;
        j && (e = {opacity: 0}, e[r] = (s ? "-=" : "+=") + m, g.animate(e, p, q)), g.queue(function () {
            j && g.hide(), a.effects.restore(g, h), a.effects.removeWrapper(g), c()
        }), u > 1 && t.splice.apply(t, [1, 0].concat(t.splice(u, o + 1))), g.dequeue()
    }, a.effects.effect.clip = function (b, c) {
        var d, e, f, g = a(this), h = ["position", "top", "bottom", "left", "right", "height", "width"], i = a.effects.setMode(g, b.mode || "hide"), j = "show" === i, k = b.direction || "vertical", l = "vertical" === k, m = l ? "height" : "width", n = l ? "top" : "left", o = {};
        a.effects.save(g, h), g.show(), d = a.effects.createWrapper(g).css({overflow: "hidden"}), e = "IMG" === g[0].tagName ? d : g, f = e[m](), j && (e.css(m, 0), e.css(n, f / 2)), o[m] = j ? f : 0, o[n] = j ? 0 : f / 2, e.animate(o, {
            queue: !1,
            duration: b.duration,
            easing: b.easing,
            complete: function () {
                j || g.hide(), a.effects.restore(g, h), a.effects.removeWrapper(g), c()
            }
        })
    }, a.effects.effect.drop = function (b, c) {
        var d, e = a(this), f = ["position", "top", "bottom", "left", "right", "opacity", "height", "width"], g = a.effects.setMode(e, b.mode || "hide"), h = "show" === g, i = b.direction || "left", j = "up" === i || "down" === i ? "top" : "left", k = "up" === i || "left" === i ? "pos" : "neg", l = {opacity: h ? 1 : 0};
        a.effects.save(e, f), e.show(), a.effects.createWrapper(e), d = b.distance || e["top" === j ? "outerHeight" : "outerWidth"](!0) / 2, h && e.css("opacity", 0).css(j, "pos" === k ? -d : d), l[j] = (h ? "pos" === k ? "+=" : "-=" : "pos" === k ? "-=" : "+=") + d, e.animate(l, {
            queue: !1,
            duration: b.duration,
            easing: b.easing,
            complete: function () {
                "hide" === g && e.hide(), a.effects.restore(e, f), a.effects.removeWrapper(e), c()
            }
        })
    }, a.effects.effect.explode = function (b, c) {
        function d() {
            t.push(this), t.length === l * m && e()
        }

        function e() {
            n.css({visibility: "visible"}), a(t).remove(), p || n.hide(), c()
        }

        var f, g, h, i, j, k, l = b.pieces ? Math.round(Math.sqrt(b.pieces)) : 3, m = l, n = a(this), o = a.effects.setMode(n, b.mode || "hide"), p = "show" === o, q = n.show().css("visibility", "hidden").offset(), r = Math.ceil(n.outerWidth() / m), s = Math.ceil(n.outerHeight() / l), t = [];
        for (f = 0; l > f; f++)for (i = q.top + f * s, k = f - (l - 1) / 2, g = 0; m > g; g++)h = q.left + g * r, j = g - (m - 1) / 2, n.clone().appendTo("body").wrap("<div></div>").css({
            position: "absolute",
            visibility: "visible",
            left: -g * r,
            top: -f * s
        }).parent().addClass("ui-effects-explode").css({
            position: "absolute",
            overflow: "hidden",
            width: r,
            height: s,
            left: h + (p ? j * r : 0),
            top: i + (p ? k * s : 0),
            opacity: p ? 0 : 1
        }).animate({
            left: h + (p ? 0 : j * r),
            top: i + (p ? 0 : k * s),
            opacity: p ? 1 : 0
        }, b.duration || 500, b.easing, d)
    }, a.effects.effect.fade = function (b, c) {
        var d = a(this), e = a.effects.setMode(d, b.mode || "toggle");
        d.animate({opacity: e}, {queue: !1, duration: b.duration, easing: b.easing, complete: c})
    }, a.effects.effect.fold = function (b, c) {
        var d, e, f = a(this), g = ["position", "top", "bottom", "left", "right", "height", "width"], h = a.effects.setMode(f, b.mode || "hide"), i = "show" === h, j = "hide" === h, k = b.size || 15, l = /([0-9]+)%/.exec(k), m = !!b.horizFirst, n = i !== m, o = n ? ["width", "height"] : ["height", "width"], p = b.duration / 2, q = {}, r = {};
        a.effects.save(f, g), f.show(), d = a.effects.createWrapper(f).css({overflow: "hidden"}), e = n ? [d.width(), d.height()] : [d.height(), d.width()], l && (k = parseInt(l[1], 10) / 100 * e[j ? 0 : 1]), i && d.css(m ? {
            height: 0,
            width: k
        } : {
            height: k,
            width: 0
        }), q[o[0]] = i ? e[0] : k, r[o[1]] = i ? e[1] : 0, d.animate(q, p, b.easing).animate(r, p, b.easing, function () {
            j && f.hide(), a.effects.restore(f, g), a.effects.removeWrapper(f), c()
        })
    }, a.effects.effect.highlight = function (b, c) {
        var d = a(this), e = ["backgroundImage", "backgroundColor", "opacity"], f = a.effects.setMode(d, b.mode || "show"), g = {backgroundColor: d.css("backgroundColor")};
        "hide" === f && (g.opacity = 0), a.effects.save(d, e), d.show().css({
            backgroundImage: "none",
            backgroundColor: b.color || "#ffff99"
        }).animate(g, {
            queue: !1, duration: b.duration, easing: b.easing, complete: function () {
                "hide" === f && d.hide(), a.effects.restore(d, e), c()
            }
        })
    }, a.effects.effect.size = function (b, c) {
        var d, e, f, g = a(this), h = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"], i = ["position", "top", "bottom", "left", "right", "overflow", "opacity"], j = ["width", "height", "overflow"], k = ["fontSize"], l = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"], m = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"], n = a.effects.setMode(g, b.mode || "effect"), o = b.restore || "effect" !== n, p = b.scale || "both", q = b.origin || ["middle", "center"], r = g.css("position"), s = o ? h : i, t = {
            height: 0,
            width: 0,
            outerHeight: 0,
            outerWidth: 0
        };
        "show" === n && g.show(), d = {
            height: g.height(),
            width: g.width(),
            outerHeight: g.outerHeight(),
            outerWidth: g.outerWidth()
        }, "toggle" === b.mode && "show" === n ? (g.from = b.to || t, g.to = b.from || d) : (g.from = b.from || ("show" === n ? t : d), g.to = b.to || ("hide" === n ? t : d)), f = {
            from: {
                y: g.from.height / d.height,
                x: g.from.width / d.width
            }, to: {y: g.to.height / d.height, x: g.to.width / d.width}
        }, ("box" === p || "both" === p) && (f.from.y !== f.to.y && (s = s.concat(l), g.from = a.effects.setTransition(g, l, f.from.y, g.from), g.to = a.effects.setTransition(g, l, f.to.y, g.to)), f.from.x !== f.to.x && (s = s.concat(m), g.from = a.effects.setTransition(g, m, f.from.x, g.from), g.to = a.effects.setTransition(g, m, f.to.x, g.to))), ("content" === p || "both" === p) && f.from.y !== f.to.y && (s = s.concat(k).concat(j), g.from = a.effects.setTransition(g, k, f.from.y, g.from), g.to = a.effects.setTransition(g, k, f.to.y, g.to)), a.effects.save(g, s), g.show(), a.effects.createWrapper(g), g.css("overflow", "hidden").css(g.from), q && (e = a.effects.getBaseline(q, d), g.from.top = (d.outerHeight - g.outerHeight()) * e.y, g.from.left = (d.outerWidth - g.outerWidth()) * e.x, g.to.top = (d.outerHeight - g.to.outerHeight) * e.y, g.to.left = (d.outerWidth - g.to.outerWidth) * e.x), g.css(g.from), ("content" === p || "both" === p) && (l = l.concat(["marginTop", "marginBottom"]).concat(k), m = m.concat(["marginLeft", "marginRight"]), j = h.concat(l).concat(m), g.find("*[width]").each(function () {
            var c = a(this), d = {
                height: c.height(),
                width: c.width(),
                outerHeight: c.outerHeight(),
                outerWidth: c.outerWidth()
            };
            o && a.effects.save(c, j), c.from = {
                height: d.height * f.from.y,
                width: d.width * f.from.x,
                outerHeight: d.outerHeight * f.from.y,
                outerWidth: d.outerWidth * f.from.x
            }, c.to = {
                height: d.height * f.to.y,
                width: d.width * f.to.x,
                outerHeight: d.height * f.to.y,
                outerWidth: d.width * f.to.x
            }, f.from.y !== f.to.y && (c.from = a.effects.setTransition(c, l, f.from.y, c.from), c.to = a.effects.setTransition(c, l, f.to.y, c.to)), f.from.x !== f.to.x && (c.from = a.effects.setTransition(c, m, f.from.x, c.from), c.to = a.effects.setTransition(c, m, f.to.x, c.to)), c.css(c.from), c.animate(c.to, b.duration, b.easing, function () {
                o && a.effects.restore(c, j)
            })
        })), g.animate(g.to, {
            queue: !1, duration: b.duration, easing: b.easing, complete: function () {
                0 === g.to.opacity && g.css("opacity", g.from.opacity), "hide" === n && g.hide(), a.effects.restore(g, s), o || ("static" === r ? g.css({
                    position: "relative",
                    top: g.to.top,
                    left: g.to.left
                }) : a.each(["top", "left"], function (a, b) {
                    g.css(b, function (b, c) {
                        var d = parseInt(c, 10), e = a ? g.to.left : g.to.top;
                        return "auto" === c ? e + "px" : d + e + "px"
                    })
                })), a.effects.removeWrapper(g), c()
            }
        })
    }, a.effects.effect.scale = function (b, c) {
        var d = a(this), e = a.extend(!0, {}, b), f = a.effects.setMode(d, b.mode || "effect"), g = parseInt(b.percent, 10) || (0 === parseInt(b.percent, 10) ? 0 : "hide" === f ? 0 : 100), h = b.direction || "both", i = b.origin, j = {
            height: d.height(),
            width: d.width(),
            outerHeight: d.outerHeight(),
            outerWidth: d.outerWidth()
        }, k = {y: "horizontal" !== h ? g / 100 : 1, x: "vertical" !== h ? g / 100 : 1};
        e.effect = "size", e.queue = !1, e.complete = c, "effect" !== f && (e.origin = i || ["middle", "center"], e.restore = !0), e.from = b.from || ("show" === f ? {
                height: 0,
                width: 0,
                outerHeight: 0,
                outerWidth: 0
            } : j), e.to = {
            height: j.height * k.y,
            width: j.width * k.x,
            outerHeight: j.outerHeight * k.y,
            outerWidth: j.outerWidth * k.x
        }, e.fade && ("show" === f && (e.from.opacity = 0, e.to.opacity = 1), "hide" === f && (e.from.opacity = 1, e.to.opacity = 0)), d.effect(e)
    }, a.effects.effect.puff = function (b, c) {
        var d = a(this), e = a.effects.setMode(d, b.mode || "hide"), f = "hide" === e, g = parseInt(b.percent, 10) || 150, h = g / 100, i = {
            height: d.height(),
            width: d.width(),
            outerHeight: d.outerHeight(),
            outerWidth: d.outerWidth()
        };
        a.extend(b, {
            effect: "scale",
            queue: !1,
            fade: !0,
            mode: e,
            complete: c,
            percent: f ? g : 100,
            from: f ? i : {
                height: i.height * h,
                width: i.width * h,
                outerHeight: i.outerHeight * h,
                outerWidth: i.outerWidth * h
            }
        }), d.effect(b)
    }, a.effects.effect.pulsate = function (b, c) {
        var d, e = a(this), f = a.effects.setMode(e, b.mode || "show"), g = "show" === f, h = "hide" === f, i = g || "hide" === f, j = 2 * (b.times || 5) + (i ? 1 : 0), k = b.duration / j, l = 0, m = e.queue(), n = m.length;
        for ((g || !e.is(":visible")) && (e.css("opacity", 0).show(), l = 1), d = 1; j > d; d++)e.animate({opacity: l}, k, b.easing), l = 1 - l;
        e.animate({opacity: l}, k, b.easing), e.queue(function () {
            h && e.hide(), c()
        }), n > 1 && m.splice.apply(m, [1, 0].concat(m.splice(n, j + 1))), e.dequeue()
    }, a.effects.effect.shake = function (b, c) {
        var d, e = a(this), f = ["position", "top", "bottom", "left", "right", "height", "width"], g = a.effects.setMode(e, b.mode || "effect"), h = b.direction || "left", i = b.distance || 20, j = b.times || 3, k = 2 * j + 1, l = Math.round(b.duration / k), m = "up" === h || "down" === h ? "top" : "left", n = "up" === h || "left" === h, o = {}, p = {}, q = {}, r = e.queue(), s = r.length;
        for (a.effects.save(e, f), e.show(), a.effects.createWrapper(e), o[m] = (n ? "-=" : "+=") + i, p[m] = (n ? "+=" : "-=") + 2 * i, q[m] = (n ? "-=" : "+=") + 2 * i, e.animate(o, l, b.easing), d = 1; j > d; d++)e.animate(p, l, b.easing).animate(q, l, b.easing);
        e.animate(p, l, b.easing).animate(o, l / 2, b.easing).queue(function () {
            "hide" === g && e.hide(), a.effects.restore(e, f), a.effects.removeWrapper(e), c()
        }), s > 1 && r.splice.apply(r, [1, 0].concat(r.splice(s, k + 1))), e.dequeue()
    }, a.effects.effect.slide = function (b, c) {
        var d, e = a(this), f = ["position", "top", "bottom", "left", "right", "width", "height"], g = a.effects.setMode(e, b.mode || "show"), h = "show" === g, i = b.direction || "left", j = "up" === i || "down" === i ? "top" : "left", k = "up" === i || "left" === i, l = {};
        a.effects.save(e, f), e.show(), d = b.distance || e["top" === j ? "outerHeight" : "outerWidth"](!0), a.effects.createWrapper(e).css({overflow: "hidden"}), h && e.css(j, k ? isNaN(d) ? "-" + d : -d : d), l[j] = (h ? k ? "+=" : "-=" : k ? "-=" : "+=") + d, e.animate(l, {
            queue: !1,
            duration: b.duration,
            easing: b.easing,
            complete: function () {
                "hide" === g && e.hide(), a.effects.restore(e, f), a.effects.removeWrapper(e), c()
            }
        })
    }, a.effects.effect.transfer = function (b, c) {
        var d = a(this), e = a(b.to), f = "fixed" === e.css("position"), g = a("body"), h = f ? g.scrollTop() : 0, i = f ? g.scrollLeft() : 0, j = e.offset(), k = {
            top: j.top - h,
            left: j.left - i,
            height: e.innerHeight(),
            width: e.innerWidth()
        }, l = d.offset(), m = a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(b.className).css({
            top: l.top - h,
            left: l.left - i,
            height: d.innerHeight(),
            width: d.innerWidth(),
            position: f ? "fixed" : "absolute"
        }).animate(k, b.duration, b.easing, function () {
            m.remove(), c()
        })
    }
}),function (a) {
    define("bootstrap", ["jquery"], function () {
        return function () {
            if ("undefined" == typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");
            return +function (a) {
                "use strict";
                var b = a.fn.jquery.split(" ")[0].split(".");
                if (b[0] < 2 && b[1] < 9 || 1 == b[0] && 9 == b[1] && b[2] < 1 || b[0] > 2)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")
            }(jQuery), +function (a) {
                "use strict";
                function b() {
                    var a = document.createElement("bootstrap"), b = {
                        WebkitTransition: "webkitTransitionEnd",
                        MozTransition: "transitionend",
                        OTransition: "oTransitionEnd otransitionend",
                        transition: "transitionend"
                    };
                    for (var c in b)if (void 0 !== a.style[c])return {end: b[c]};
                    return !1
                }

                a.fn.emulateTransitionEnd = function (b) {
                    var c = !1, d = this;
                    a(this).one("bsTransitionEnd", function () {
                        c = !0
                    });
                    var e = function () {
                        c || a(d).trigger(a.support.transition.end)
                    };
                    return setTimeout(e, b), this
                }, a(function () {
                    a.support.transition = b(), a.support.transition && (a.event.special.bsTransitionEnd = {
                        bindType: a.support.transition.end,
                        delegateType: a.support.transition.end,
                        handle: function (b) {
                            return a(b.target).is(this) ? b.handleObj.handler.apply(this, arguments) : void 0
                        }
                    })
                })
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var c = a(this), e = c.data("bs.alert");
                        e || c.data("bs.alert", e = new d(this)), "string" == typeof b && e[b].call(c)
                    })
                }

                var c = '[data-dismiss="alert"]', d = function (b) {
                    a(b).on("click", c, this.close)
                };
                d.VERSION = "3.3.6", d.TRANSITION_DURATION = 150, d.prototype.close = function (b) {
                    function c() {
                        g.detach().trigger("closed.bs.alert").remove()
                    }

                    var e = a(this), f = e.attr("data-target");
                    f || (f = e.attr("href"), f = f && f.replace(/.*(?=#[^\s]*$)/, ""));
                    var g = a(f);
                    b && b.preventDefault(), g.length || (g = e.closest(".alert")), g.trigger(b = a.Event("close.bs.alert")), b.isDefaultPrevented() || (g.removeClass("in"), a.support.transition && g.hasClass("fade") ? g.one("bsTransitionEnd", c).emulateTransitionEnd(d.TRANSITION_DURATION) : c())
                };
                var e = a.fn.alert;
                a.fn.alert = b, a.fn.alert.Constructor = d, a.fn.alert.noConflict = function () {
                    return a.fn.alert = e, this
                }, a(document).on("click.bs.alert.data-api", c, d.prototype.close)
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.button"), f = "object" == typeof b && b;
                        e || d.data("bs.button", e = new c(this, f)), "toggle" == b ? e.toggle() : b && e.setState(b)
                    })
                }

                var c = function (b, d) {
                    this.$element = a(b), this.options = a.extend({}, c.DEFAULTS, d), this.isLoading = !1
                };
                c.VERSION = "3.3.6", c.DEFAULTS = {loadingText: "loading..."}, c.prototype.setState = function (b) {
                    var c = "disabled", d = this.$element, e = d.is("input") ? "val" : "html", f = d.data();
                    b += "Text", null == f.resetText && d.data("resetText", d[e]()), setTimeout(a.proxy(function () {
                        d[e](null == f[b] ? this.options[b] : f[b]), "loadingText" == b ? (this.isLoading = !0, d.addClass(c).attr(c, c)) : this.isLoading && (this.isLoading = !1, d.removeClass(c).removeAttr(c))
                    }, this), 0)
                }, c.prototype.toggle = function () {
                    var a = !0, b = this.$element.closest('[data-toggle="buttons"]');
                    if (b.length) {
                        var c = this.$element.find("input");
                        "radio" == c.prop("type") ? (c.prop("checked") && (a = !1), b.find(".active").removeClass("active"), this.$element.addClass("active")) : "checkbox" == c.prop("type") && (c.prop("checked") !== this.$element.hasClass("active") && (a = !1), this.$element.toggleClass("active")), c.prop("checked", this.$element.hasClass("active")), a && c.trigger("change")
                    } else this.$element.attr("aria-pressed", !this.$element.hasClass("active")), this.$element.toggleClass("active")
                };
                var d = a.fn.button;
                a.fn.button = b, a.fn.button.Constructor = c, a.fn.button.noConflict = function () {
                    return a.fn.button = d, this
                }, a(document).on("click.bs.button.data-api", '[data-toggle^="button"]', function (c) {
                    var d = a(c.target);
                    d.hasClass("btn") || (d = d.closest(".btn")), b.call(d, "toggle"), a(c.target).is('input[type="radio"]') || a(c.target).is('input[type="checkbox"]') || c.preventDefault()
                }).on("focus.bs.button.data-api blur.bs.button.data-api", '[data-toggle^="button"]', function (b) {
                    a(b.target).closest(".btn").toggleClass("focus", /^focus(in)?$/.test(b.type))
                })
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.carousel"), f = a.extend({}, c.DEFAULTS, d.data(), "object" == typeof b && b), g = "string" == typeof b ? b : f.slide;
                        e || d.data("bs.carousel", e = new c(this, f)), "number" == typeof b ? e.to(b) : g ? e[g]() : f.interval && e.pause().cycle()
                    })
                }

                var c = function (b, c) {
                    this.$element = a(b), this.$indicators = this.$element.find(".carousel-indicators"), this.options = c, this.paused = null, this.sliding = null, this.interval = null, this.$active = null, this.$items = null, this.options.keyboard && this.$element.on("keydown.bs.carousel", a.proxy(this.keydown, this)), "hover" == this.options.pause && !("ontouchstart" in document.documentElement) && this.$element.on("mouseenter.bs.carousel", a.proxy(this.pause, this)).on("mouseleave.bs.carousel", a.proxy(this.cycle, this))
                };
                c.VERSION = "3.3.6", c.TRANSITION_DURATION = 600, c.DEFAULTS = {
                    interval: 5e3,
                    pause: "hover",
                    wrap: !0,
                    keyboard: !0
                }, c.prototype.keydown = function (a) {
                    if (!/input|textarea/i.test(a.target.tagName)) {
                        switch (a.which) {
                            case 37:
                                this.prev();
                                break;
                            case 39:
                                this.next();
                                break;
                            default:
                                return
                        }
                        a.preventDefault()
                    }
                }, c.prototype.cycle = function (b) {
                    return b || (this.paused = !1), this.interval && clearInterval(this.interval), this.options.interval && !this.paused && (this.interval = setInterval(a.proxy(this.next, this), this.options.interval)), this
                }, c.prototype.getItemIndex = function (a) {
                    return this.$items = a.parent().children(".item"), this.$items.index(a || this.$active)
                }, c.prototype.getItemForDirection = function (a, b) {
                    var c = this.getItemIndex(b), d = "prev" == a && 0 === c || "next" == a && c == this.$items.length - 1;
                    if (d && !this.options.wrap)return b;
                    var e = "prev" == a ? -1 : 1, f = (c + e) % this.$items.length;
                    return this.$items.eq(f)
                }, c.prototype.to = function (a) {
                    var b = this, c = this.getItemIndex(this.$active = this.$element.find(".item.active"));
                    return a > this.$items.length - 1 || 0 > a ? void 0 : this.sliding ? this.$element.one("slid.bs.carousel", function () {
                        b.to(a)
                    }) : c == a ? this.pause().cycle() : this.slide(a > c ? "next" : "prev", this.$items.eq(a))
                }, c.prototype.pause = function (b) {
                    return b || (this.paused = !0), this.$element.find(".next, .prev").length && a.support.transition && (this.$element.trigger(a.support.transition.end), this.cycle(!0)), this.interval = clearInterval(this.interval), this
                }, c.prototype.next = function () {
                    return this.sliding ? void 0 : this.slide("next")
                }, c.prototype.prev = function () {
                    return this.sliding ? void 0 : this.slide("prev")
                }, c.prototype.slide = function (b, d) {
                    var e = this.$element.find(".item.active"), f = d || this.getItemForDirection(b, e), g = this.interval, h = "next" == b ? "left" : "right", i = this;
                    if (f.hasClass("active"))return this.sliding = !1;
                    var j = f[0], k = a.Event("slide.bs.carousel", {relatedTarget: j, direction: h});
                    if (this.$element.trigger(k), !k.isDefaultPrevented()) {
                        if (this.sliding = !0, g && this.pause(), this.$indicators.length) {
                            this.$indicators.find(".active").removeClass("active");
                            var l = a(this.$indicators.children()[this.getItemIndex(f)]);
                            l && l.addClass("active")
                        }
                        var m = a.Event("slid.bs.carousel", {relatedTarget: j, direction: h});
                        return a.support.transition && this.$element.hasClass("slide") ? (f.addClass(b), f[0].offsetWidth, e.addClass(h), f.addClass(h), e.one("bsTransitionEnd", function () {
                            f.removeClass([b, h].join(" ")).addClass("active"), e.removeClass(["active", h].join(" ")), i.sliding = !1, setTimeout(function () {
                                i.$element.trigger(m)
                            }, 0)
                        }).emulateTransitionEnd(c.TRANSITION_DURATION)) : (e.removeClass("active"), f.addClass("active"), this.sliding = !1, this.$element.trigger(m)), g && this.cycle(), this
                    }
                };
                var d = a.fn.carousel;
                a.fn.carousel = b, a.fn.carousel.Constructor = c, a.fn.carousel.noConflict = function () {
                    return a.fn.carousel = d, this
                };
                var e = function (c) {
                    var d, e = a(this), f = a(e.attr("data-target") || (d = e.attr("href")) && d.replace(/.*(?=#[^\s]+$)/, ""));
                    if (f.hasClass("carousel")) {
                        var g = a.extend({}, f.data(), e.data()), h = e.attr("data-slide-to");
                        h && (g.interval = !1), b.call(f, g), h && f.data("bs.carousel").to(h), c.preventDefault()
                    }
                };
                a(document).on("click.bs.carousel.data-api", "[data-slide]", e).on("click.bs.carousel.data-api", "[data-slide-to]", e), a(window).on("load", function () {
                    a('[data-ride="carousel"]').each(function () {
                        var c = a(this);
                        b.call(c, c.data())
                    })
                })
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    var c, d = b.attr("data-target") || (c = b.attr("href")) && c.replace(/.*(?=#[^\s]+$)/, "");
                    return a(d)
                }

                function c(b) {
                    return this.each(function () {
                        var c = a(this), e = c.data("bs.collapse"), f = a.extend({}, d.DEFAULTS, c.data(), "object" == typeof b && b);
                        !e && f.toggle && /show|hide/.test(b) && (f.toggle = !1), e || c.data("bs.collapse", e = new d(this, f)), "string" == typeof b && e[b]()
                    })
                }

                var d = function (b, c) {
                    this.$element = a(b), this.options = a.extend({}, d.DEFAULTS, c), this.$trigger = a('[data-toggle="collapse"][href="#' + b.id + '"],[data-toggle="collapse"][data-target="#' + b.id + '"]'), this.transitioning = null, this.options.parent ? this.$parent = this.getParent() : this.addAriaAndCollapsedClass(this.$element, this.$trigger), this.options.toggle && this.toggle()
                };
                d.VERSION = "3.3.6", d.TRANSITION_DURATION = 350, d.DEFAULTS = {toggle: !0}, d.prototype.dimension = function () {
                    var a = this.$element.hasClass("width");
                    return a ? "width" : "height"
                }, d.prototype.show = function () {
                    if (!this.transitioning && !this.$element.hasClass("in")) {
                        var b, e = this.$parent && this.$parent.children(".panel").children(".in, .collapsing");
                        if (!(e && e.length && (b = e.data("bs.collapse"), b && b.transitioning))) {
                            var f = a.Event("show.bs.collapse");
                            if (this.$element.trigger(f), !f.isDefaultPrevented()) {
                                e && e.length && (c.call(e, "hide"), b || e.data("bs.collapse", null));
                                var g = this.dimension();
                                this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded", !0), this.$trigger.removeClass("collapsed").attr("aria-expanded", !0), this.transitioning = 1;
                                var h = function () {
                                    this.$element.removeClass("collapsing").addClass("collapse in")[g](""), this.transitioning = 0, this.$element.trigger("shown.bs.collapse")
                                };
                                if (!a.support.transition)return h.call(this);
                                var i = a.camelCase(["scroll", g].join("-"));
                                this.$element.one("bsTransitionEnd", a.proxy(h, this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])
                            }
                        }
                    }
                }, d.prototype.hide = function () {
                    if (!this.transitioning && this.$element.hasClass("in")) {
                        var b = a.Event("hide.bs.collapse");
                        if (this.$element.trigger(b), !b.isDefaultPrevented()) {
                            var c = this.dimension();
                            this.$element[c](this.$element[c]())[0].offsetHeight, this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded", !1), this.$trigger.addClass("collapsed").attr("aria-expanded", !1), this.transitioning = 1;
                            var e = function () {
                                this.transitioning = 0, this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")
                            };
                            return a.support.transition ? void this.$element[c](0).one("bsTransitionEnd", a.proxy(e, this)).emulateTransitionEnd(d.TRANSITION_DURATION) : e.call(this)
                        }
                    }
                }, d.prototype.toggle = function () {
                    this[this.$element.hasClass("in") ? "hide" : "show"]()
                }, d.prototype.getParent = function () {
                    return a(this.options.parent).find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]').each(a.proxy(function (c, d) {
                        var e = a(d);
                        this.addAriaAndCollapsedClass(b(e), e)
                    }, this)).end()
                }, d.prototype.addAriaAndCollapsedClass = function (a, b) {
                    var c = a.hasClass("in");
                    a.attr("aria-expanded", c), b.toggleClass("collapsed", !c).attr("aria-expanded", c);
                };
                var e = a.fn.collapse;
                a.fn.collapse = c, a.fn.collapse.Constructor = d, a.fn.collapse.noConflict = function () {
                    return a.fn.collapse = e, this
                }, a(document).on("click.bs.collapse.data-api", '[data-toggle="collapse"]', function (d) {
                    var e = a(this);
                    e.attr("data-target") || d.preventDefault();
                    var f = b(e), g = f.data("bs.collapse"), h = g ? "toggle" : e.data();
                    c.call(f, h)
                })
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    var c = b.attr("data-target");
                    c || (c = b.attr("href"), c = c && /#[A-Za-z]/.test(c) && c.replace(/.*(?=#[^\s]*$)/, ""));
                    var d = c && a(c);
                    return d && d.length ? d : b.parent()
                }

                function c(c) {
                    c && 3 === c.which || (a(e).remove(), a(f).each(function () {
                        var d = a(this), e = b(d), f = {relatedTarget: this};
                        e.hasClass("open") && (c && "click" == c.type && /input|textarea/i.test(c.target.tagName) && a.contains(e[0], c.target) || (e.trigger(c = a.Event("hide.bs.dropdown", f)), c.isDefaultPrevented() || (d.attr("aria-expanded", "false"), e.removeClass("open").trigger(a.Event("hidden.bs.dropdown", f)))))
                    }))
                }

                function d(b) {
                    return this.each(function () {
                        var c = a(this), d = c.data("bs.dropdown");
                        d || c.data("bs.dropdown", d = new g(this)), "string" == typeof b && d[b].call(c)
                    })
                }

                var e = ".dropdown-backdrop", f = '[data-toggle="dropdown"]', g = function (b) {
                    a(b).on("click.bs.dropdown", this.toggle)
                };
                g.VERSION = "3.3.6", g.prototype.toggle = function (d) {
                    var e = a(this);
                    if (!e.is(".disabled, :disabled")) {
                        var f = b(e), g = f.hasClass("open");
                        if (c(), !g) {
                            "ontouchstart" in document.documentElement && !f.closest(".navbar-nav").length && a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click", c);
                            var h = {relatedTarget: this};
                            if (f.trigger(d = a.Event("show.bs.dropdown", h)), d.isDefaultPrevented())return;
                            e.trigger("focus").attr("aria-expanded", "true"), f.toggleClass("open").trigger(a.Event("shown.bs.dropdown", h))
                        }
                        return !1
                    }
                }, g.prototype.keydown = function (c) {
                    if (/(38|40|27|32)/.test(c.which) && !/input|textarea/i.test(c.target.tagName)) {
                        var d = a(this);
                        if (c.preventDefault(), c.stopPropagation(), !d.is(".disabled, :disabled")) {
                            var e = b(d), g = e.hasClass("open");
                            if (!g && 27 != c.which || g && 27 == c.which)return 27 == c.which && e.find(f).trigger("focus"), d.trigger("click");
                            var h = " li:not(.disabled):visible a", i = e.find(".dropdown-menu" + h);
                            if (i.length) {
                                var j = i.index(c.target);
                                38 == c.which && j > 0 && j--, 40 == c.which && j < i.length - 1 && j++, ~j || (j = 0), i.eq(j).trigger("focus")
                            }
                        }
                    }
                };
                var h = a.fn.dropdown;
                a.fn.dropdown = d, a.fn.dropdown.Constructor = g, a.fn.dropdown.noConflict = function () {
                    return a.fn.dropdown = h, this
                }, a(document).on("click.bs.dropdown.data-api", c).on("click.bs.dropdown.data-api", ".dropdown form", function (a) {
                    a.stopPropagation()
                }).on("click.bs.dropdown.data-api", f, g.prototype.toggle).on("keydown.bs.dropdown.data-api", f, g.prototype.keydown).on("keydown.bs.dropdown.data-api", ".dropdown-menu", g.prototype.keydown)
            }(jQuery), +function (a) {
                "use strict";
                function b(b, d) {
                    return this.each(function () {
                        var e = a(this), f = e.data("bs.modal"), g = a.extend({}, c.DEFAULTS, e.data(), "object" == typeof b && b);
                        f || e.data("bs.modal", f = new c(this, g)), "string" == typeof b ? f[b](d) : g.show && f.show(d)
                    })
                }

                var c = function (b, c) {
                    this.options = c, this.$body = a(document.body), this.$element = a(b), this.$dialog = this.$element.find(".modal-dialog"), this.$backdrop = null, this.isShown = null, this.originalBodyPad = null, this.scrollbarWidth = 0, this.ignoreBackdropClick = !1, this.options.remote && this.$element.find(".modal-content").load(this.options.remote, a.proxy(function () {
                        this.$element.trigger("loaded.bs.modal")
                    }, this))
                };
                c.VERSION = "3.3.6", c.TRANSITION_DURATION = 300, c.BACKDROP_TRANSITION_DURATION = 150, c.DEFAULTS = {
                    backdrop: !0,
                    keyboard: !0,
                    show: !0
                }, c.prototype.toggle = function (a) {
                    return this.isShown ? this.hide() : this.show(a)
                }, c.prototype.show = function (b) {
                    var d = this, e = a.Event("show.bs.modal", {relatedTarget: b});
                    this.$element.trigger(e), this.isShown || e.isDefaultPrevented() || (this.isShown = !0, this.checkScrollbar(), this.setScrollbar(), this.$body.addClass("modal-open"), this.escape(), this.resize(), this.$element.on("click.dismiss.bs.modal", '[data-dismiss="modal"]', a.proxy(this.hide, this)), this.$dialog.on("mousedown.dismiss.bs.modal", function () {
                        d.$element.one("mouseup.dismiss.bs.modal", function (b) {
                            a(b.target).is(d.$element) && (d.ignoreBackdropClick = !0)
                        })
                    }), this.backdrop(function () {
                        var e = a.support.transition && d.$element.hasClass("fade");
                        d.$element.parent().length || d.$element.appendTo(d.$body), d.$element.show().scrollTop(0), d.adjustDialog(), e && d.$element[0].offsetWidth, d.$element.addClass("in"), d.enforceFocus();
                        var f = a.Event("shown.bs.modal", {relatedTarget: b});
                        e ? d.$dialog.one("bsTransitionEnd", function () {
                            d.$element.trigger("focus").trigger(f)
                        }).emulateTransitionEnd(c.TRANSITION_DURATION) : d.$element.trigger("focus").trigger(f)
                    }))
                }, c.prototype.hide = function (b) {
                    b && b.preventDefault(), b = a.Event("hide.bs.modal"), this.$element.trigger(b), this.isShown && !b.isDefaultPrevented() && (this.isShown = !1, this.escape(), this.resize(), a(document).off("focusin.bs.modal"), this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"), this.$dialog.off("mousedown.dismiss.bs.modal"), a.support.transition && this.$element.hasClass("fade") ? this.$element.one("bsTransitionEnd", a.proxy(this.hideModal, this)).emulateTransitionEnd(c.TRANSITION_DURATION) : this.hideModal())
                }, c.prototype.enforceFocus = function () {
                    a(document).off("focusin.bs.modal").on("focusin.bs.modal", a.proxy(function (a) {
                        this.$element[0] === a.target || this.$element.has(a.target).length || this.$element.trigger("focus")
                    }, this))
                }, c.prototype.escape = function () {
                    this.isShown && this.options.keyboard ? this.$element.on("keydown.dismiss.bs.modal", a.proxy(function (a) {
                        27 == a.which && this.hide()
                    }, this)) : this.isShown || this.$element.off("keydown.dismiss.bs.modal")
                }, c.prototype.resize = function () {
                    this.isShown ? a(window).on("resize.bs.modal", a.proxy(this.handleUpdate, this)) : a(window).off("resize.bs.modal")
                }, c.prototype.hideModal = function () {
                    var a = this;
                    this.$element.hide(), this.backdrop(function () {
                        a.$body.removeClass("modal-open"), a.resetAdjustments(), a.resetScrollbar(), a.$element.trigger("hidden.bs.modal")
                    })
                }, c.prototype.removeBackdrop = function () {
                    this.$backdrop && this.$backdrop.remove(), this.$backdrop = null
                }, c.prototype.backdrop = function (b) {
                    var d = this, e = this.$element.hasClass("fade") ? "fade" : "";
                    if (this.isShown && this.options.backdrop) {
                        var f = a.support.transition && e;
                        if (this.$backdrop = a(document.createElement("div")).addClass("modal-backdrop " + e).appendTo(this.$body), this.$element.on("click.dismiss.bs.modal", a.proxy(function (a) {
                                return this.ignoreBackdropClick ? void(this.ignoreBackdropClick = !1) : void(a.target === a.currentTarget && ("static" == this.options.backdrop ? this.$element[0].focus() : this.hide()))
                            }, this)), f && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), !b)return;
                        f ? this.$backdrop.one("bsTransitionEnd", b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION) : b()
                    } else if (!this.isShown && this.$backdrop) {
                        this.$backdrop.removeClass("in");
                        var g = function () {
                            d.removeBackdrop(), b && b()
                        };
                        a.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one("bsTransitionEnd", g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION) : g()
                    } else b && b()
                }, c.prototype.handleUpdate = function () {
                    this.adjustDialog()
                }, c.prototype.adjustDialog = function () {
                    var a = this.$element[0].scrollHeight > document.documentElement.clientHeight;
                    this.$element.css({
                        paddingLeft: !this.bodyIsOverflowing && a ? this.scrollbarWidth : "",
                        paddingRight: this.bodyIsOverflowing && !a ? this.scrollbarWidth : ""
                    })
                }, c.prototype.resetAdjustments = function () {
                    this.$element.css({paddingLeft: "", paddingRight: ""})
                }, c.prototype.checkScrollbar = function () {
                    var a = window.innerWidth;
                    if (!a) {
                        var b = document.documentElement.getBoundingClientRect();
                        a = b.right - Math.abs(b.left)
                    }
                    this.bodyIsOverflowing = document.body.clientWidth < a, this.scrollbarWidth = this.measureScrollbar()
                }, c.prototype.setScrollbar = function () {
                    var a = parseInt(this.$body.css("padding-right") || 0, 10);
                    this.originalBodyPad = document.body.style.paddingRight || "", this.bodyIsOverflowing && this.$body.css("padding-right", a + this.scrollbarWidth)
                }, c.prototype.resetScrollbar = function () {
                    this.$body.css("padding-right", this.originalBodyPad)
                }, c.prototype.measureScrollbar = function () {
                    var a = document.createElement("div");
                    a.className = "modal-scrollbar-measure", this.$body.append(a);
                    var b = a.offsetWidth - a.clientWidth;
                    return this.$body[0].removeChild(a), b
                };
                var d = a.fn.modal;
                a.fn.modal = b, a.fn.modal.Constructor = c, a.fn.modal.noConflict = function () {
                    return a.fn.modal = d, this
                }, a(document).on("click.bs.modal.data-api", '[data-toggle="modal"]', function (c) {
                    var d = a(this), e = d.attr("href"), f = a(d.attr("data-target") || e && e.replace(/.*(?=#[^\s]+$)/, "")), g = f.data("bs.modal") ? "toggle" : a.extend({remote: !/#/.test(e) && e}, f.data(), d.data());
                    d.is("a") && c.preventDefault(), f.one("show.bs.modal", function (a) {
                        a.isDefaultPrevented() || f.one("hidden.bs.modal", function () {
                            d.is(":visible") && d.trigger("focus")
                        })
                    }), b.call(f, g, this)
                })
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.tooltip"), f = "object" == typeof b && b;
                        (e || !/destroy|hide/.test(b)) && (e || d.data("bs.tooltip", e = new c(this, f)), "string" == typeof b && e[b]())
                    })
                }

                var c = function (a, b) {
                    this.type = null, this.options = null, this.enabled = null, this.timeout = null, this.hoverState = null, this.$element = null, this.inState = null, this.init("tooltip", a, b)
                };
                c.VERSION = "3.3.6", c.TRANSITION_DURATION = 150, c.DEFAULTS = {
                    animation: !0,
                    placement: "top",
                    selector: !1,
                    template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
                    trigger: "hover focus",
                    title: "",
                    delay: 0,
                    html: !1,
                    container: !1,
                    viewport: {selector: "body", padding: 0}
                }, c.prototype.init = function (b, c, d) {
                    if (this.enabled = !0, this.type = b, this.$element = a(c), this.options = this.getOptions(d), this.$viewport = this.options.viewport && a(a.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : this.options.viewport.selector || this.options.viewport), this.inState = {
                            click: !1,
                            hover: !1,
                            focus: !1
                        }, this.$element[0] instanceof document.constructor && !this.options.selector)throw new Error("`selector` option must be specified when initializing " + this.type + " on the window.document object!");
                    for (var e = this.options.trigger.split(" "), f = e.length; f--;) {
                        var g = e[f];
                        if ("click" == g)this.$element.on("click." + this.type, this.options.selector, a.proxy(this.toggle, this)); else if ("manual" != g) {
                            var h = "hover" == g ? "mouseenter" : "focusin", i = "hover" == g ? "mouseleave" : "focusout";
                            this.$element.on(h + "." + this.type, this.options.selector, a.proxy(this.enter, this)), this.$element.on(i + "." + this.type, this.options.selector, a.proxy(this.leave, this))
                        }
                    }
                    this.options.selector ? this._options = a.extend({}, this.options, {
                        trigger: "manual",
                        selector: ""
                    }) : this.fixTitle()
                }, c.prototype.getDefaults = function () {
                    return c.DEFAULTS
                }, c.prototype.getOptions = function (b) {
                    return b = a.extend({}, this.getDefaults(), this.$element.data(), b), b.delay && "number" == typeof b.delay && (b.delay = {
                        show: b.delay,
                        hide: b.delay
                    }), b
                }, c.prototype.getDelegateOptions = function () {
                    var b = {}, c = this.getDefaults();
                    return this._options && a.each(this._options, function (a, d) {
                        c[a] != d && (b[a] = d)
                    }), b
                }, c.prototype.enter = function (b) {
                    var c = b instanceof this.constructor ? b : a(b.currentTarget).data("bs." + this.type);
                    return c || (c = new this.constructor(b.currentTarget, this.getDelegateOptions()), a(b.currentTarget).data("bs." + this.type, c)), b instanceof a.Event && (c.inState["focusin" == b.type ? "focus" : "hover"] = !0), c.tip().hasClass("in") || "in" == c.hoverState ? void(c.hoverState = "in") : (clearTimeout(c.timeout), c.hoverState = "in", c.options.delay && c.options.delay.show ? void(c.timeout = setTimeout(function () {
                        "in" == c.hoverState && c.show()
                    }, c.options.delay.show)) : c.show())
                }, c.prototype.isInStateTrue = function () {
                    for (var a in this.inState)if (this.inState[a])return !0;
                    return !1
                }, c.prototype.leave = function (b) {
                    var c = b instanceof this.constructor ? b : a(b.currentTarget).data("bs." + this.type);
                    return c || (c = new this.constructor(b.currentTarget, this.getDelegateOptions()), a(b.currentTarget).data("bs." + this.type, c)), b instanceof a.Event && (c.inState["focusout" == b.type ? "focus" : "hover"] = !1), c.isInStateTrue() ? void 0 : (clearTimeout(c.timeout), c.hoverState = "out", c.options.delay && c.options.delay.hide ? void(c.timeout = setTimeout(function () {
                        "out" == c.hoverState && c.hide()
                    }, c.options.delay.hide)) : c.hide())
                }, c.prototype.show = function () {
                    var b = a.Event("show.bs." + this.type);
                    if (this.hasContent() && this.enabled) {
                        this.$element.trigger(b);
                        var d = a.contains(this.$element[0].ownerDocument.documentElement, this.$element[0]);
                        if (b.isDefaultPrevented() || !d)return;
                        var e = this, f = this.tip(), g = this.getUID(this.type);
                        this.setContent(), f.attr("id", g), this.$element.attr("aria-describedby", g), this.options.animation && f.addClass("fade");
                        var h = "function" == typeof this.options.placement ? this.options.placement.call(this, f[0], this.$element[0]) : this.options.placement, i = /\s?auto?\s?/i, j = i.test(h);
                        j && (h = h.replace(i, "") || "top"), f.detach().css({
                            top: 0,
                            left: 0,
                            display: "block"
                        }).addClass(h).data("bs." + this.type, this), this.options.container ? f.appendTo(this.options.container) : f.insertAfter(this.$element), this.$element.trigger("inserted.bs." + this.type);
                        var k = this.getPosition(), l = f[0].offsetWidth, m = f[0].offsetHeight;
                        if (j) {
                            var n = h, o = this.getPosition(this.$viewport);
                            h = "bottom" == h && k.bottom + m > o.bottom ? "top" : "top" == h && k.top - m < o.top ? "bottom" : "right" == h && k.right + l > o.width ? "left" : "left" == h && k.left - l < o.left ? "right" : h, f.removeClass(n).addClass(h)
                        }
                        var p = this.getCalculatedOffset(h, k, l, m);
                        this.applyPlacement(p, h);
                        var q = function () {
                            var a = e.hoverState;
                            e.$element.trigger("shown.bs." + e.type), e.hoverState = null, "out" == a && e.leave(e)
                        };
                        a.support.transition && this.$tip.hasClass("fade") ? f.one("bsTransitionEnd", q).emulateTransitionEnd(c.TRANSITION_DURATION) : q()
                    }
                }, c.prototype.applyPlacement = function (b, c) {
                    var d = this.tip(), e = d[0].offsetWidth, f = d[0].offsetHeight, g = parseInt(d.css("margin-top"), 10), h = parseInt(d.css("margin-left"), 10);
                    isNaN(g) && (g = 0), isNaN(h) && (h = 0), b.top += g, b.left += h, a.offset.setOffset(d[0], a.extend({
                        using: function (a) {
                            d.css({top: Math.round(a.top), left: Math.round(a.left)})
                        }
                    }, b), 0), d.addClass("in");
                    var i = d[0].offsetWidth, j = d[0].offsetHeight;
                    "top" == c && j != f && (b.top = b.top + f - j);
                    var k = this.getViewportAdjustedDelta(c, b, i, j);
                    k.left ? b.left += k.left : b.top += k.top;
                    var l = /top|bottom/.test(c), m = l ? 2 * k.left - e + i : 2 * k.top - f + j, n = l ? "offsetWidth" : "offsetHeight";
                    d.offset(b), this.replaceArrow(m, d[0][n], l)
                }, c.prototype.replaceArrow = function (a, b, c) {
                    this.arrow().css(c ? "left" : "top", 50 * (1 - a / b) + "%").css(c ? "top" : "left", "")
                }, c.prototype.setContent = function () {
                    var a = this.tip(), b = this.getTitle();
                    a.find(".tooltip-inner")[this.options.html ? "html" : "text"](b), a.removeClass("fade in top bottom left right")
                }, c.prototype.hide = function (b) {
                    function d() {
                        "in" != e.hoverState && f.detach(), e.$element.removeAttr("aria-describedby").trigger("hidden.bs." + e.type), b && b()
                    }

                    var e = this, f = a(this.$tip), g = a.Event("hide.bs." + this.type);
                    return this.$element.trigger(g), g.isDefaultPrevented() ? void 0 : (f.removeClass("in"), a.support.transition && f.hasClass("fade") ? f.one("bsTransitionEnd", d).emulateTransitionEnd(c.TRANSITION_DURATION) : d(), this.hoverState = null, this)
                }, c.prototype.fixTitle = function () {
                    var a = this.$element;
                    (a.attr("title") || "string" != typeof a.attr("data-original-title")) && a.attr("data-original-title", a.attr("title") || "").attr("title", "")
                }, c.prototype.hasContent = function () {
                    return this.getTitle()
                }, c.prototype.getPosition = function (b) {
                    b = b || this.$element;
                    var c = b[0], d = "BODY" == c.tagName, e = c.getBoundingClientRect();
                    null == e.width && (e = a.extend({}, e, {width: e.right - e.left, height: e.bottom - e.top}));
                    var f = d ? {
                        top: 0,
                        left: 0
                    } : b.offset(), g = {scroll: d ? document.documentElement.scrollTop || document.body.scrollTop : b.scrollTop()}, h = d ? {
                        width: a(window).width(),
                        height: a(window).height()
                    } : null;
                    return a.extend({}, e, g, h, f)
                }, c.prototype.getCalculatedOffset = function (a, b, c, d) {
                    return "bottom" == a ? {
                        top: b.top + b.height,
                        left: b.left + b.width / 2 - c / 2
                    } : "top" == a ? {
                        top: b.top - d,
                        left: b.left + b.width / 2 - c / 2
                    } : "left" == a ? {
                        top: b.top + b.height / 2 - d / 2,
                        left: b.left - c
                    } : {top: b.top + b.height / 2 - d / 2, left: b.left + b.width}
                }, c.prototype.getViewportAdjustedDelta = function (a, b, c, d) {
                    var e = {top: 0, left: 0};
                    if (!this.$viewport)return e;
                    var f = this.options.viewport && this.options.viewport.padding || 0, g = this.getPosition(this.$viewport);
                    if (/right|left/.test(a)) {
                        var h = b.top - f - g.scroll, i = b.top + f - g.scroll + d;
                        h < g.top ? e.top = g.top - h : i > g.top + g.height && (e.top = g.top + g.height - i)
                    } else {
                        var j = b.left - f, k = b.left + f + c;
                        j < g.left ? e.left = g.left - j : k > g.right && (e.left = g.left + g.width - k)
                    }
                    return e
                }, c.prototype.getTitle = function () {
                    var a, b = this.$element, c = this.options;
                    return a = b.attr("data-original-title") || ("function" == typeof c.title ? c.title.call(b[0]) : c.title)
                }, c.prototype.getUID = function (a) {
                    do a += ~~(1e6 * Math.random()); while (document.getElementById(a));
                    return a
                }, c.prototype.tip = function () {
                    if (!this.$tip && (this.$tip = a(this.options.template), 1 != this.$tip.length))throw new Error(this.type + " `template` option must consist of exactly 1 top-level element!");
                    return this.$tip
                }, c.prototype.arrow = function () {
                    return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
                }, c.prototype.enable = function () {
                    this.enabled = !0
                }, c.prototype.disable = function () {
                    this.enabled = !1
                }, c.prototype.toggleEnabled = function () {
                    this.enabled = !this.enabled
                }, c.prototype.toggle = function (b) {
                    var c = this;
                    b && (c = a(b.currentTarget).data("bs." + this.type), c || (c = new this.constructor(b.currentTarget, this.getDelegateOptions()), a(b.currentTarget).data("bs." + this.type, c))), b ? (c.inState.click = !c.inState.click, c.isInStateTrue() ? c.enter(c) : c.leave(c)) : c.tip().hasClass("in") ? c.leave(c) : c.enter(c)
                }, c.prototype.destroy = function () {
                    var a = this;
                    clearTimeout(this.timeout), this.hide(function () {
                        a.$element.off("." + a.type).removeData("bs." + a.type), a.$tip && a.$tip.detach(), a.$tip = null, a.$arrow = null, a.$viewport = null
                    })
                };
                var d = a.fn.tooltip;
                a.fn.tooltip = b, a.fn.tooltip.Constructor = c, a.fn.tooltip.noConflict = function () {
                    return a.fn.tooltip = d, this
                }
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.popover"), f = "object" == typeof b && b;
                        (e || !/destroy|hide/.test(b)) && (e || d.data("bs.popover", e = new c(this, f)), "string" == typeof b && e[b]())
                    })
                }

                var c = function (a, b) {
                    this.init("popover", a, b)
                };
                if (!a.fn.tooltip)throw new Error("Popover requires tooltip.js");
                c.VERSION = "3.3.6", c.DEFAULTS = a.extend({}, a.fn.tooltip.Constructor.DEFAULTS, {
                    placement: "right",
                    trigger: "click",
                    content: "",
                    template: '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
                }), c.prototype = a.extend({}, a.fn.tooltip.Constructor.prototype), c.prototype.constructor = c, c.prototype.getDefaults = function () {
                    return c.DEFAULTS
                }, c.prototype.setContent = function () {
                    var a = this.tip(), b = this.getTitle(), c = this.getContent();
                    a.find(".popover-title")[this.options.html ? "html" : "text"](b), a.find(".popover-content").children().detach().end()[this.options.html ? "string" == typeof c ? "html" : "append" : "text"](c), a.removeClass("fade top bottom left right in"), a.find(".popover-title").html() || a.find(".popover-title").hide()
                }, c.prototype.hasContent = function () {
                    return this.getTitle() || this.getContent()
                }, c.prototype.getContent = function () {
                    var a = this.$element, b = this.options;
                    return a.attr("data-content") || ("function" == typeof b.content ? b.content.call(a[0]) : b.content)
                }, c.prototype.arrow = function () {
                    return this.$arrow = this.$arrow || this.tip().find(".arrow")
                };
                var d = a.fn.popover;
                a.fn.popover = b, a.fn.popover.Constructor = c, a.fn.popover.noConflict = function () {
                    return a.fn.popover = d, this
                }
            }(jQuery), +function (a) {
                "use strict";
                function b(c, d) {
                    this.$body = a(document.body), this.$scrollElement = a(a(c).is(document.body) ? window : c), this.options = a.extend({}, b.DEFAULTS, d), this.selector = (this.options.target || "") + " .nav li > a", this.offsets = [], this.targets = [], this.activeTarget = null, this.scrollHeight = 0, this.$scrollElement.on("scroll.bs.scrollspy", a.proxy(this.process, this)), this.refresh(), this.process()
                }

                function c(c) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.scrollspy"), f = "object" == typeof c && c;
                        e || d.data("bs.scrollspy", e = new b(this, f)), "string" == typeof c && e[c]()
                    })
                }

                b.VERSION = "3.3.6", b.DEFAULTS = {offset: 10}, b.prototype.getScrollHeight = function () {
                    return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
                }, b.prototype.refresh = function () {
                    var b = this, c = "offset", d = 0;
                    this.offsets = [], this.targets = [], this.scrollHeight = this.getScrollHeight(), a.isWindow(this.$scrollElement[0]) || (c = "position", d = this.$scrollElement.scrollTop()), this.$body.find(this.selector).map(function () {
                        var b = a(this), e = b.data("target") || b.attr("href"), f = /^#./.test(e) && a(e);
                        return f && f.length && f.is(":visible") && [[f[c]().top + d, e]] || null
                    }).sort(function (a, b) {
                        return a[0] - b[0]
                    }).each(function () {
                        b.offsets.push(this[0]), b.targets.push(this[1])
                    })
                }, b.prototype.process = function () {
                    var a, b = this.$scrollElement.scrollTop() + this.options.offset, c = this.getScrollHeight(), d = this.options.offset + c - this.$scrollElement.height(), e = this.offsets, f = this.targets, g = this.activeTarget;
                    if (this.scrollHeight != c && this.refresh(), b >= d)return g != (a = f[f.length - 1]) && this.activate(a);
                    if (g && b < e[0])return this.activeTarget = null, this.clear();
                    for (a = e.length; a--;)g != f[a] && b >= e[a] && (void 0 === e[a + 1] || b < e[a + 1]) && this.activate(f[a])
                }, b.prototype.activate = function (b) {
                    this.activeTarget = b, this.clear();
                    var c = this.selector + '[data-target="' + b + '"],' + this.selector + '[href="' + b + '"]', d = a(c).parents("li").addClass("active");
                    d.parent(".dropdown-menu").length && (d = d.closest("li.dropdown").addClass("active")), d.trigger("activate.bs.scrollspy")
                }, b.prototype.clear = function () {
                    a(this.selector).parentsUntil(this.options.target, ".active").removeClass("active")
                };
                var d = a.fn.scrollspy;
                a.fn.scrollspy = c, a.fn.scrollspy.Constructor = b, a.fn.scrollspy.noConflict = function () {
                    return a.fn.scrollspy = d, this
                }, a(window).on("load.bs.scrollspy.data-api", function () {
                    a('[data-spy="scroll"]').each(function () {
                        var b = a(this);
                        c.call(b, b.data())
                    })
                })
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.tab");
                        e || d.data("bs.tab", e = new c(this)), "string" == typeof b && e[b]()
                    })
                }

                var c = function (b) {
                    this.element = a(b)
                };
                c.VERSION = "3.3.6", c.TRANSITION_DURATION = 150, c.prototype.show = function () {
                    var b = this.element, c = b.closest("ul:not(.dropdown-menu)"), d = b.data("target");
                    if (d || (d = b.attr("href"), d = d && d.replace(/.*(?=#[^\s]*$)/, "")), !b.parent("li").hasClass("active")) {
                        var e = c.find(".active:last a"), f = a.Event("hide.bs.tab", {relatedTarget: b[0]}), g = a.Event("show.bs.tab", {relatedTarget: e[0]});
                        if (e.trigger(f), b.trigger(g), !g.isDefaultPrevented() && !f.isDefaultPrevented()) {
                            var h = a(d);
                            this.activate(b.closest("li"), c), this.activate(h, h.parent(), function () {
                                e.trigger({
                                    type: "hidden.bs.tab",
                                    relatedTarget: b[0]
                                }), b.trigger({type: "shown.bs.tab", relatedTarget: e[0]})
                            })
                        }
                    }
                }, c.prototype.activate = function (b, d, e) {
                    function f() {
                        g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded", !1), b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded", !0), h ? (b[0].offsetWidth, b.addClass("in")) : b.removeClass("fade"), b.parent(".dropdown-menu").length && b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded", !0), e && e()
                    }

                    var g = d.find("> .active"), h = e && a.support.transition && (g.length && g.hasClass("fade") || !!d.find("> .fade").length);
                    g.length && h ? g.one("bsTransitionEnd", f).emulateTransitionEnd(c.TRANSITION_DURATION) : f(), g.removeClass("in")
                };
                var d = a.fn.tab;
                a.fn.tab = b, a.fn.tab.Constructor = c, a.fn.tab.noConflict = function () {
                    return a.fn.tab = d, this
                };
                var e = function (c) {
                    c.preventDefault(), b.call(a(this), "show")
                };
                a(document).on("click.bs.tab.data-api", '[data-toggle="tab"]', e).on("click.bs.tab.data-api", '[data-toggle="pill"]', e)
            }(jQuery), +function (a) {
                "use strict";
                function b(b) {
                    return this.each(function () {
                        var d = a(this), e = d.data("bs.affix"), f = "object" == typeof b && b;
                        e || d.data("bs.affix", e = new c(this, f)), "string" == typeof b && e[b]()
                    })
                }

                var c = function (b, d) {
                    this.options = a.extend({}, c.DEFAULTS, d), this.$target = a(this.options.target).on("scroll.bs.affix.data-api", a.proxy(this.checkPosition, this)).on("click.bs.affix.data-api", a.proxy(this.checkPositionWithEventLoop, this)), this.$element = a(b), this.affixed = null, this.unpin = null, this.pinnedOffset = null, this.checkPosition()
                };
                c.VERSION = "3.3.6", c.RESET = "affix affix-top affix-bottom", c.DEFAULTS = {
                    offset: 0,
                    target: window
                }, c.prototype.getState = function (a, b, c, d) {
                    var e = this.$target.scrollTop(), f = this.$element.offset(), g = this.$target.height();
                    if (null != c && "top" == this.affixed)return c > e ? "top" : !1;
                    if ("bottom" == this.affixed)return null != c ? e + this.unpin <= f.top ? !1 : "bottom" : a - d >= e + g ? !1 : "bottom";
                    var h = null == this.affixed, i = h ? e : f.top, j = h ? g : b;
                    return null != c && c >= e ? "top" : null != d && i + j >= a - d ? "bottom" : !1
                }, c.prototype.getPinnedOffset = function () {
                    if (this.pinnedOffset)return this.pinnedOffset;
                    this.$element.removeClass(c.RESET).addClass("affix");
                    var a = this.$target.scrollTop(), b = this.$element.offset();
                    return this.pinnedOffset = b.top - a
                }, c.prototype.checkPositionWithEventLoop = function () {
                    setTimeout(a.proxy(this.checkPosition, this), 1)
                }, c.prototype.checkPosition = function () {
                    if (this.$element.is(":visible")) {
                        var b = this.$element.height(), d = this.options.offset, e = d.top, f = d.bottom, g = Math.max(a(document).height(), a(document.body).height());
                        "object" != typeof d && (f = e = d), "function" == typeof e && (e = d.top(this.$element)), "function" == typeof f && (f = d.bottom(this.$element));
                        var h = this.getState(g, b, e, f);
                        if (this.affixed != h) {
                            null != this.unpin && this.$element.css("top", "");
                            var i = "affix" + (h ? "-" + h : ""), j = a.Event(i + ".bs.affix");
                            if (this.$element.trigger(j), j.isDefaultPrevented())return;
                            this.affixed = h, this.unpin = "bottom" == h ? this.getPinnedOffset() : null, this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix", "affixed") + ".bs.affix")
                        }
                        "bottom" == h && this.$element.offset({top: g - b - f})
                    }
                };
                var d = a.fn.affix;
                a.fn.affix = b, a.fn.affix.Constructor = c, a.fn.affix.noConflict = function () {
                    return a.fn.affix = d, this
                }, a(window).on("load", function () {
                    a('[data-spy="affix"]').each(function () {
                        var c = a(this), d = c.data();
                        d.offset = d.offset || {}, null != d.offsetBottom && (d.offset.bottom = d.offsetBottom), null != d.offsetTop && (d.offset.top = d.offsetTop), b.call(c, d)
                    })
                })
            }(jQuery), $.fn.tooltip
        }.apply(a, arguments)
    })
}(this),define("KME/interfaces/ItemTooltip", ["jquery", "bootstrap", "i18next"], function (a) {
    KME.ItemTooltip = a.fn.extend({
        ItemTooltip: function (b) {
            var c = {
                trigger: "manual",
                html: !0,
                container: "#interfaceWrapper",
                placement: "auto",
                template: '<div class="popover">        <div class="arrow"></div>        <div class="popover-header">        <button type="button" class="close" data-dismiss="popover" aria-hidden="true">&nbsp;</button>        <h3 class="popover-title"></h3>        </div>        <div class="popover-content"></div>        </div>'
            };
            b = a.extend({}, c, b);
            var d = this;
            d.popover(b), d.on("show.bs.popover", function () {
            }), d.on("shown.bs.popover", function () {
                a("div.itemImage").not(this).popover("hide");
                var b = a(this), c = a(this).data("bs.popover").$tip, d = b.data("bs.popover").options;
                c.on("click", '[data-dismiss="popover"]', function () {
                    b.popover("hide")
                }), c.on("click", ".btn-group-sm button", function () {
                    d.buttonCallback(b, this)
                })
            }).on("hidden.bs.popover", function () {
                var b = a(this).data("bs.popover").$tip;
                b && (b.off("click", '[data-dismiss="popover"]'), b.off("click", ".btn-group-sm button")), d.removeClass("opened")
            })
        }
    })
}),define("KME/controllers/data/actions/UndressAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.controllers.network.actions.item.undress(a.id, function (c, d, e) {
            c && KME.gameState.showMessage(c), a.update(d), e && KME.gameState.updatePlayer(e, "wear"), b()
        })
    }
}),define("KME/controllers/data/actions/DressAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.controllers.network.actions.item.dress(a.id, function (c, d, e) {
            c && KME.gameState.showMessage(c), d && a.update(d), e && KME.gameState.updatePlayer(e, "wear"), b()
        })
    }
}),define("KME/controllers/interface/UIItemController", ["jquery", "i18next", "KME/phext/BodyIsometric", "KME/interfaces/ItemTooltip", "KME/controllers/data/DataController", "KME/phext/BodyIsometric", "KME/controllers/data/actions/UndressAction", "KME/controllers/data/actions/DressAction", "KME/controllers/network/NetworkController"], function (a) {
    function b(b) {
        return a(".container_" + b).data("content") ? a(".container_" + b).data("content") : a(".container_" + b).closest("div[id]").data("content")
    }

    function c(a, b) {
        return a.actions && a.actions.dress && (a.actions.dress.target === b || "bothHands" === a.actions.dress.target && "rightHand" === b)
    }

    function d(a) {
        if (a.targetId === KME.mainPlayer.id && a.sourceId === KME.mainPlayer.id)return !0;
        var c, d, e;
        return a.targetId === KME.mainPlayer.id ? c = KME.mainPlayer : d = b(a.targetId), a.sourceId === KME.mainPlayer.id ? c = KME.mainPlayer : d ? e = b(a.sourceId) : d = b(a.sourceId), c ? c.body.isNearObject(d.worldObject) : Phaser.BodyIsometric.prototype.isInRangeObject.apply(d.worldObject, [e.worldObject, 150])
    }

    function e(a, b, e) {
        return "wear" !== a.targetPocket || c(b, a.targetPos) ? a.targetId != KME.mainPlayer.id || a.sourceId != KME.mainPlayer.id ? d(a) ? null : "messages:dropTooFarAway" : "rightHand" === a.targetPocket || "rightHand" === a.sourcePocket ? (f(a, e), "messages:dropSomeError") : null : "messages:dropCantBeWearOrSlot"
    }

    function f(a, b) {
        "rightHand" === a.targetPocket ? KME.controllers.data.actions.dress(b, function () {
        }) : KME.controllers.data.actions.undress(b, function () {
        })
    }

    function g(a, b) {
        return b && a && b.type === a.type && a.type.max && b.amount != a.type.max && a.id != b.id
    }

    function h(c) {
        return d(c) ? void KME.controllers.network.actions.item.stack(c, function (d, e, f) {
            if (d)KME.gameState.showMessage(d); else {
                var g = b(c.sourceId);
                if (g && (g.update(e), g instanceof KME.PlayerContent ? KME.gameState.updatePlayer(e, "wear") : g instanceof KME.ToolContent ? a("#tool_" + c.sourceId).container("rebuild", g) : a("#container_" + c.sourceId).container("rebuild", g)), f && e != f) {
                    var h = b(c.targetId);
                    h && (h.update(f), h instanceof KME.PlayerContent ? KME.gameState.updatePlayer(f, "wear") : h instanceof KME.ToolContent ? a("#tool_" + c.targetId).container("rebuild", h) : a("#container_" + c.targetId).container("rebuild", h))
                }
            }
        }) : void KME.mainPlayer.showMessage("messages:actionTooFarAway")
    }

    function i(a) {
        if (KME.mainPlayer.id === a)return void 0;
        var c = b(a);
        return c.worldObject.roomId
    }

    function j(b, c) {
        var d = a(b);
        if (0 === d.children().length || "wear" === d.data("pocket")) {
            var f = c.draggable.data("item");
            if (!f)return;
            var j = f.type, l = {
                id: f.id,
                targetId: d.data("fromId"),
                targetPos: d.data("position"),
                targetPocket: d.data("pocket"),
                sourceId: c.draggable.data("fromId"),
                sourcePocket: c.draggable.data("pocket")
            };
            l.targetRoomId = i(l.targetId), l.sourceRoomId = i(l.sourceId);
            var m = e(l, j, f);
            if (m)return void KME.mainPlayer.showMessage(m);
            if ("wear" === l.targetPocket)return void KME.controllers.data.actions.dress(f, function () {
            });
            "undefined" != typeof io ? KME.socket.emit("itemMove", l, function (a, b, e) {
                a && KME.gameState.showMessage(a), b && (d.append(c.draggable), "inventory" != l.sourcePocket && "inventory" === l.targetPocket ? KME.controllers.ui.item.registerItemTooltip(c.draggable, f) : "inventory" === l.sourcePocket && "inventory" !== l.targetPocket && c.draggable.popover("destroy"), c.draggable.data("fromId", l.targetId), c.draggable.data("pocket", l.targetPocket), c.draggable.data("cell", d), k(l, f, b)), e && KME.gameState.updatePlayer(e)
            }) : d.append(c.draggable)
        } else {
            var n = a(d.children()[0]).data("item"), f = c.draggable.data("item");
            if (g(f, n)) {
                var o = {
                    sourceItemId: f.id,
                    targetItemId: n.id,
                    sourceId: c.draggable.data("fromId"),
                    targetId: d.data("fromId"),
                    targetPocket: d.data("pocket"),
                    sourcePocket: c.draggable.data("pocket"),
                    targetRoomId: i(d.data("fromId")),
                    sourceRoomId: i(c.draggable.data("fromId"))
                };
                h(o)
            }
        }
    }

    function k(a, c, d) {
        var e = b(a.sourceId), f = b(a.targetId);
        e == f ? a.sourcePocket == a.targetPocket ? (c.setPosition(d.position, e[a.sourcePocket]), c.update(d)) : f instanceof KME.PlayerContent ? (c.update(d), e.moveItem(c, a.sourcePocket, a.targetPocket)) : console.log("Not implemented: Moving item between+inside another container") : f instanceof KME.PlayerContent ? (c.update(d), f.moveItemFromContainerToPlayer(c, e, a.sourcePocket, a.targetPocket), "inventory" === a.targetPocket && KME.controllers.ui.updateOnItemMove(f, c)) : e instanceof KME.PlayerContent ? (c.update(d), e.moveItemFromPlayerToContainer(c, a.sourcePocket, a.targetPocket, f), "inventory" === a.sourcePocket && KME.controllers.ui.updateOnItemMove(e, !1)) : console.log("Not implemented: Direct item moving from container to container is not implemented")
    }

    function l(b, c) {
        var d = [];
        return c.actions && Object.keys(c.actions).forEach(function (b) {
            KME.templates.buttons[b] && d.push(KME.templates.buttons[b].replace("TRANSLATE", a.t("actions:" + b + ".name"))), "eat" === b && d.push(KME.templates.buttons.eatAll.replace("TRANSLATE", a.t("actions:eatAll.name")))
        }), b.amount > 0 && c.max > 0 && d.push(KME.templates.buttons.split.replace("TRANSLATE", a.t("actions:split.name"))), d
    }

    return KME.templates = {
        buttons: {
            bandage: '<button type="button" class="btn btn-wt" action="bandage"><span data-i18n>TRANSLATE</span></button>',
            summon: '<button type="button" class="btn btn-wt" action="summon"><span data-i18n>TRANSLATE</span></button>',
            eat: '<button type="button" class="btn btn-wt" action="eat"><span data-i18n>TRANSLATE</span></button>',
            eatAll: '<button type="button" class="btn btn-wt" action="eatAll"><span data-i18n>TRANSLATE</span></button>',
            free: '<button type="button" class="btn btn-wt" action="free"><span data-i18n>TRANSLATE</span></button>',
            dress: '<button type="button" class="btn btn-wt" action="dress"><span data-i18n>TRANSLATE</span></button>',
            itemRepair: '<button type="button" class="btn btn-wt" action="itemRepair"><span data-i18n>TRANSLATE</span></button>',
            undress: '<button type="button" class="btn btn-wt" action="undress"><span data-i18n>TRANSLATE</span></button>',
            split: '<button type="button" class="btn btn-wt" action="split"><span data-i18n>TRANSLATE</span></button>'
        }
    }, {
        registrerDroppable: function (b, c, d, e, f) {
            c.droppable({
                tolerance: "intersect", greedy: !0, accept: ".itemImage", drop: function (b, c) {
                    var d = a(this).parent().position().top, e = a(this).parent().position().top + a(this).parent().height(), f = a(this).position().top, g = a(this).position().top + a(this).height();
                    g >= d && e >= f && j(this, c)
                }, out: function (b, c) {
                    f && f(a(this), c)
                }, stop: function (a, b) {
                    b.draggable.attr("data-dragging", "0")
                }
            }), c.data("position", d), c.on("remove", function () {
                a(this).droppable("destroy")
            })
        }, getContentByContainerId: function (a) {
            return b(a)
        }, getDurabilityStyle: function (a) {
            var b = a.durability / a.type.durability;
            b > 1 && (b = 1);
            var c;
            c = b >= .75 ? "rgba(0, 255, 0, 0.50)" : .25 > b ? "rgba(255, 0, 0, 0.50)" : "rgba(255, 255, 0, 0.50)";
            var d = Math.ceil(83 * b) + "%";
            return "width:" + d + ";background-color:" + c
        }, prepareItemElement: function (b, c, d, e) {
            var f = b.getTitle(), g = a('<div class="itemImage"><img src="' + KME.utils.itematlas.getImageSource(b.typeName) + '" title="' + f + '" oncontextmenu="return false;"/></div>');
            "undefined" != typeof b.amount && g.append("<span>" + b.amount + "</span>"), "undefined" != typeof b.durability && g.append("<div style='" + this.getDurabilityStyle(b) + "'></div>"), g.data("item", b), d ? c && c(g) : this.registerDraggable(g, c), e && this.registerItemTooltip(g, b)
        }, registerItemTooltip: function (b, c) {
            var d = KME.types.itemTypes[c.typeName], e = a.t("objects:items." + c.typeName), f = l(c, d);
            b.ItemTooltip({
                title: e,
                html: !0,
                content: '<div class="btn-group-vertical btn-group-sm">' + f.join("") + "</div>",
                trigger: "manual",
                container: "body",
                buttonCallback: function (b, d) {
                    b.popover("hide"), KME.controllers.data.actions.perform(a(d).attr("action"), c, function () {
                    })
                }
            }), b.on("remove", function () {
                a(this).popover("destroy")
            }), b.hammer({preventDefault: !0, gesture: !0})
        }, registerDraggable: function (b, c) {
            b.draggable({
                helper: "clone",
                opacity: .6,
                zIndex: 1e4,
                scroll: !0,
                scrollSensitivity: 100,
                appendTo: "body",
                start: function (b, c) {
                    a(this).attr("data-dragging", "1"), a(this).data("ui", c)
                },
                stop: function () {
                    a(this).attr("data-dragging", "0")
                }
            }), b.disableSelection(), b.on("remove", function () {
                var c = a(this);
                c.data("ui") && c.data("ui").helper.remove(), c.hasClass("opened") && c.popover("destroy"), b.draggable("destroy")
            }), c && c(b)
        }
    }
}),define("KME/interfaces/WorldTooltip", ["jquery", "bootstrap", "i18next"], function (a) {
    KME.WorldTooltip = a.fn.extend({
        WorldTooltip: function (b) {
            var c = {
                trigger: "manual",
                html: !0,
                container: "#interfaceWrapper",
                placement: "bottom auto",
                template: '<div class="popover">        <div class="arrow"></div>        <div class="popover-header">        <button type="button" class="close" data-dismiss="popover" aria-hidden="true">&times;</button>        <h3 class="popover-title"></h3>        </div>        <div class="popover-content"></div>        </div>'
            };
            b = a.extend({}, c, b);
            var d = this;
            d.popover(b), d.on("show.bs.popover", function () {
            }), d.on("shown.bs.popover", function () {
                var b = a(this), c = a(this).data("bs.popover").$tip, d = b.data("bs.popover").options;
                c.on("click", '[data-dismiss="popover"]', function () {
                    b.popover("destroy")
                }), c.on("click", "button.btn-wt", function () {
                    b.popover("destroy"), d.buttonCallback && d.buttonCallback(b, this)
                }), c.css("left", d.position.left - c.width() / 2 + "px"), c.css("top", d.position.top - c.height() + "px"), b.on("click", function () {
                    b.popover("destroy")
                })
            }).on("hidden.bs.popover", function () {
                var b = a(this).data("bs.popover").$tip;
                b && (b.off("click", '[data-dismiss="popover"]'), b.off("click", "button.btn-wt")), d.off("click"), a(this).popover("destroy")
            })
        }
    })
}),define("KME/controllers/interface/UIWorldController", ["jquery", "i18next", "bootstrap", "KME/interfaces/WorldTooltip"], function (a) {
    var b = '<button type="button" class="btn btn-wt" action="%1"><span>%2</span></button>';
    return {
        showMenu: function (c, d) {
            for (var e, f, g, h = [], i = a("#game"), j = 0; j < d.length; ++j)e = d[j], f = a.t("interfaces:worldMenu." + e.title), g = b.replace("%1", e.actionName), g = g.replace("%2", f), h.push(g);
            i.WorldTooltip({
                title: c.name,
                content: '<div class="btn-group-vertical btn-group-sm">' + h.join("") + "</div>",
                buttonCallback: function (b, d) {
                    c.onUse(a(d).attr("action"))
                },
                position: {
                    left: c.x - c.game.camera.x + KME.world.view.data.screenX,
                    top: c.y - c.game.camera.y + KME.world.view.data.screenY
                }
            }), i.popover("show")
        }
    }
}),function (a, b, c, d) {
    "use strict";
    function e(a, b, c) {
        return setTimeout(k(a, c), b)
    }

    function f(a, b, c) {
        return Array.isArray(a) ? (g(a, c[b], c), !0) : !1
    }

    function g(a, b, c) {
        var e;
        if (a)if (a.forEach)a.forEach(b, c); else if (a.length !== d)for (e = 0; e < a.length;)b.call(c, a[e], e, a), e++; else for (e in a)a.hasOwnProperty(e) && b.call(c, a[e], e, a)
    }

    function h(a, b, c) {
        for (var e = Object.keys(b), f = 0; f < e.length;)(!c || c && a[e[f]] === d) && (a[e[f]] = b[e[f]]), f++;
        return a
    }

    function i(a, b) {
        return h(a, b, !0)
    }

    function j(a, b, c) {
        var d, e = b.prototype;
        d = a.prototype = Object.create(e), d.constructor = a, d._super = e, c && h(d, c)
    }

    function k(a, b) {
        return function () {
            return a.apply(b, arguments)
        }
    }

    function l(a, b) {
        return typeof a == ka ? a.apply(b ? b[0] || d : d, b) : a
    }

    function m(a, b) {
        return a === d ? b : a
    }

    function n(a, b, c) {
        g(r(b), function (b) {
            a.addEventListener(b, c, !1)
        })
    }

    function o(a, b, c) {
        g(r(b), function (b) {
            a.removeEventListener(b, c, !1)
        })
    }

    function p(a, b) {
        for (; a;) {
            if (a == b)return !0;
            a = a.parentNode
        }
        return !1
    }

    function q(a, b) {
        return a.indexOf(b) > -1
    }

    function r(a) {
        return a.trim().split(/\s+/g)
    }

    function s(a, b, c) {
        if (a.indexOf && !c)return a.indexOf(b);
        for (var d = 0; d < a.length;) {
            if (c && a[d][c] == b || !c && a[d] === b)return d;
            d++
        }
        return -1
    }

    function t(a) {
        return Array.prototype.slice.call(a, 0)
    }

    function u(a, b, c) {
        for (var d = [], e = [], f = 0; f < a.length;) {
            var g = b ? a[f][b] : a[f];
            s(e, g) < 0 && d.push(a[f]), e[f] = g, f++
        }
        return c && (d = b ? d.sort(function (a, c) {
            return a[b] > c[b]
        }) : d.sort()), d
    }

    function v(a, b) {
        for (var c, e, f = b[0].toUpperCase() + b.slice(1), g = 0; g < ia.length;) {
            if (c = ia[g], e = c ? c + f : b, e in a)return e;
            g++
        }
        return d
    }

    function w() {
        return oa++
    }

    function x(a) {
        var b = a.ownerDocument;
        return b.defaultView || b.parentWindow
    }

    function y(a, b) {
        var c = this;
        this.manager = a, this.callback = b, this.element = a.element, this.target = a.options.inputTarget, this.domHandler = function (b) {
            l(a.options.enable, [a]) && c.handler(b)
        }, this.init()
    }

    function z(a) {
        var b, c = a.options.inputClass;
        return new (b = c ? c : ra ? N : sa ? Q : qa ? S : M)(a, A)
    }

    function A(a, b, c) {
        var d = c.pointers.length, e = c.changedPointers.length, f = b & ya && d - e === 0, g = b & (Aa | Ba) && d - e === 0;
        c.isFirst = !!f, c.isFinal = !!g, f && (a.session = {}), c.eventType = b, B(a, c), a.emit("hammer.input", c), a.recognize(c), a.session.prevInput = c
    }

    function B(a, b) {
        var c = a.session, d = b.pointers, e = d.length;
        c.firstInput || (c.firstInput = E(b)), e > 1 && !c.firstMultiple ? c.firstMultiple = E(b) : 1 === e && (c.firstMultiple = !1);
        var f = c.firstInput, g = c.firstMultiple, h = g ? g.center : f.center, i = b.center = F(d);
        b.timeStamp = na(), b.deltaTime = b.timeStamp - f.timeStamp, b.angle = J(h, i), b.distance = I(h, i), C(c, b), b.offsetDirection = H(b.deltaX, b.deltaY), b.scale = g ? L(g.pointers, d) : 1, b.rotation = g ? K(g.pointers, d) : 0, D(c, b);
        var j = a.element;
        p(b.srcEvent.target, j) && (j = b.srcEvent.target), b.target = j
    }

    function C(a, b) {
        var c = b.center, d = a.offsetDelta || {}, e = a.prevDelta || {}, f = a.prevInput || {};
        (b.eventType === ya || f.eventType === Aa) && (e = a.prevDelta = {
            x: f.deltaX || 0,
            y: f.deltaY || 0
        }, d = a.offsetDelta = {x: c.x, y: c.y}), b.deltaX = e.x + (c.x - d.x), b.deltaY = e.y + (c.y - d.y)
    }

    function D(a, b) {
        var c, e, f, g, h = a.lastInterval || b, i = b.timeStamp - h.timeStamp;
        if (b.eventType != Ba && (i > xa || h.velocity === d)) {
            var j = h.deltaX - b.deltaX, k = h.deltaY - b.deltaY, l = G(i, j, k);
            e = l.x, f = l.y, c = ma(l.x) > ma(l.y) ? l.x : l.y, g = H(j, k), a.lastInterval = b
        } else c = h.velocity, e = h.velocityX, f = h.velocityY, g = h.direction;
        b.velocity = c, b.velocityX = e, b.velocityY = f, b.direction = g
    }

    function E(a) {
        for (var b = [], c = 0; c < a.pointers.length;)b[c] = {
            clientX: la(a.pointers[c].clientX),
            clientY: la(a.pointers[c].clientY)
        }, c++;
        return {timeStamp: na(), pointers: b, center: F(b), deltaX: a.deltaX, deltaY: a.deltaY}
    }

    function F(a) {
        var b = a.length;
        if (1 === b)return {x: la(a[0].clientX), y: la(a[0].clientY)};
        for (var c = 0, d = 0, e = 0; b > e;)c += a[e].clientX, d += a[e].clientY, e++;
        return {x: la(c / b), y: la(d / b)}
    }

    function G(a, b, c) {
        return {x: b / a || 0, y: c / a || 0}
    }

    function H(a, b) {
        return a === b ? Ca : ma(a) >= ma(b) ? a > 0 ? Da : Ea : b > 0 ? Fa : Ga
    }

    function I(a, b, c) {
        c || (c = Ka);
        var d = b[c[0]] - a[c[0]], e = b[c[1]] - a[c[1]];
        return Math.sqrt(d * d + e * e)
    }

    function J(a, b, c) {
        c || (c = Ka);
        var d = b[c[0]] - a[c[0]], e = b[c[1]] - a[c[1]];
        return 180 * Math.atan2(e, d) / Math.PI
    }

    function K(a, b) {
        return J(b[1], b[0], La) - J(a[1], a[0], La)
    }

    function L(a, b) {
        return I(b[0], b[1], La) / I(a[0], a[1], La)
    }

    function M() {
        this.evEl = Na, this.evWin = Oa, this.allow = !0, this.pressed = !1, y.apply(this, arguments)
    }

    function N() {
        this.evEl = Ra, this.evWin = Sa, y.apply(this, arguments), this.store = this.manager.session.pointerEvents = []
    }

    function O() {
        this.evTarget = Ua, this.evWin = Va, this.started = !1, y.apply(this, arguments)
    }

    function P(a, b) {
        var c = t(a.touches), d = t(a.changedTouches);
        return b & (Aa | Ba) && (c = u(c.concat(d), "identifier", !0)), [c, d]
    }

    function Q() {
        this.evTarget = Xa, this.targetIds = {}, y.apply(this, arguments)
    }

    function R(a, b) {
        var c = t(a.touches), d = this.targetIds;
        if (b & (ya | za) && 1 === c.length)return d[c[0].identifier] = !0, [c, c];
        var e, f, g = t(a.changedTouches), h = [], i = this.target;
        if (f = c.filter(function (a) {
                return p(a.target, i)
            }), b === ya)for (e = 0; e < f.length;)d[f[e].identifier] = !0, e++;
        for (e = 0; e < g.length;)d[g[e].identifier] && h.push(g[e]), b & (Aa | Ba) && delete d[g[e].identifier], e++;
        return h.length ? [u(f.concat(h), "identifier", !0), h] : void 0
    }

    function S() {
        y.apply(this, arguments);
        var a = k(this.handler, this);
        this.touch = new Q(this.manager, a), this.mouse = new M(this.manager, a)
    }

    function T(a, b) {
        this.manager = a, this.set(b)
    }

    function U(a) {
        if (q(a, bb))return bb;
        var b = q(a, cb), c = q(a, db);
        return b && c ? cb + " " + db : b || c ? b ? cb : db : q(a, ab) ? ab : _a
    }

    function V(a) {
        this.id = w(), this.manager = null, this.options = i(a || {}, this.defaults), this.options.enable = m(this.options.enable, !0), this.state = eb, this.simultaneous = {}, this.requireFail = []
    }

    function W(a) {
        return a & jb ? "cancel" : a & hb ? "end" : a & gb ? "move" : a & fb ? "start" : ""
    }

    function X(a) {
        return a == Ga ? "down" : a == Fa ? "up" : a == Da ? "left" : a == Ea ? "right" : ""
    }

    function Y(a, b) {
        var c = b.manager;
        return c ? c.get(a) : a
    }

    function Z() {
        V.apply(this, arguments)
    }

    function $() {
        Z.apply(this, arguments), this.pX = null, this.pY = null
    }

    function _() {
        Z.apply(this, arguments)
    }

    function aa() {
        V.apply(this, arguments), this._timer = null, this._input = null
    }

    function ba() {
        Z.apply(this, arguments)
    }

    function ca() {
        Z.apply(this, arguments)
    }

    function da() {
        V.apply(this, arguments), this.pTime = !1, this.pCenter = !1, this._timer = null, this._input = null, this.count = 0
    }

    function ea(a, b) {
        return b = b || {}, b.recognizers = m(b.recognizers, ea.defaults.preset), new fa(a, b)
    }

    function fa(a, b) {
        b = b || {}, this.options = i(b, ea.defaults), this.options.inputTarget = this.options.inputTarget || a, this.handlers = {}, this.session = {}, this.recognizers = [], this.element = a, this.input = z(this), this.touchAction = new T(this, this.options.touchAction), ga(this, !0), g(b.recognizers, function (a) {
            var b = this.add(new a[0](a[1]));
            a[2] && b.recognizeWith(a[2]), a[3] && b.requireFailure(a[3])
        }, this)
    }

    function ga(a, b) {
        var c = a.element;
        g(a.options.cssProps, function (a, d) {
            c.style[v(c.style, d)] = b ? a : ""
        })
    }

    function ha(a, c) {
        var d = b.createEvent("Event");
        d.initEvent(a, !0, !0), d.gesture = c, c.target.dispatchEvent(d)
    }

    var ia = ["", "webkit", "moz", "MS", "ms", "o"], ja = b.createElement("div"), ka = "function", la = Math.round, ma = Math.abs, na = Date.now, oa = 1, pa = /mobile|tablet|ip(ad|hone|od)|android/i, qa = "ontouchstart" in a, ra = v(a, "PointerEvent") !== d, sa = qa && pa.test(navigator.userAgent), ta = "touch", ua = "pen", va = "mouse", wa = "kinect", xa = 25, ya = 1, za = 2, Aa = 4, Ba = 8, Ca = 1, Da = 2, Ea = 4, Fa = 8, Ga = 16, Ha = Da | Ea, Ia = Fa | Ga, Ja = Ha | Ia, Ka = ["x", "y"], La = ["clientX", "clientY"];
    y.prototype = {
        handler: function () {
        }, init: function () {
            this.evEl && n(this.element, this.evEl, this.domHandler), this.evTarget && n(this.target, this.evTarget, this.domHandler), this.evWin && n(x(this.element), this.evWin, this.domHandler)
        }, destroy: function () {
            this.evEl && o(this.element, this.evEl, this.domHandler), this.evTarget && o(this.target, this.evTarget, this.domHandler), this.evWin && o(x(this.element), this.evWin, this.domHandler)
        }
    };
    var Ma = {mousedown: ya, mousemove: za, mouseup: Aa}, Na = "mousedown", Oa = "mousemove mouseup";
    j(M, y, {
        handler: function (a) {
            var b = Ma[a.type];
            b & ya && 0 === a.button && (this.pressed = !0), b & za && 1 !== a.which && (b = Aa), this.pressed && this.allow && (b & Aa && (this.pressed = !1), this.callback(this.manager, b, {
                pointers: [a],
                changedPointers: [a],
                pointerType: va,
                srcEvent: a
            }))
        }
    });
    var Pa = {pointerdown: ya, pointermove: za, pointerup: Aa, pointercancel: Ba, pointerout: Ba}, Qa = {
        2: ta,
        3: ua,
        4: va,
        5: wa
    }, Ra = "pointerdown", Sa = "pointermove pointerup pointercancel";
    a.MSPointerEvent && (Ra = "MSPointerDown", Sa = "MSPointerMove MSPointerUp MSPointerCancel"), j(N, y, {
        handler: function (a) {
            var b = this.store, c = !1, d = a.type.toLowerCase().replace("ms", ""), e = Pa[d], f = Qa[a.pointerType] || a.pointerType, g = f == ta, h = s(b, a.pointerId, "pointerId");
            e & ya && (0 === a.button || g) ? 0 > h && (b.push(a), h = b.length - 1) : e & (Aa | Ba) && (c = !0), 0 > h || (b[h] = a, this.callback(this.manager, e, {
                pointers: b,
                changedPointers: [a],
                pointerType: f,
                srcEvent: a
            }), c && b.splice(h, 1))
        }
    });
    var Ta = {
        touchstart: ya,
        touchmove: za,
        touchend: Aa,
        touchcancel: Ba
    }, Ua = "touchstart", Va = "touchstart touchmove touchend touchcancel";
    j(O, y, {
        handler: function (a) {
            var b = Ta[a.type];
            if (b === ya && (this.started = !0), this.started) {
                var c = P.call(this, a, b);
                b & (Aa | Ba) && c[0].length - c[1].length === 0 && (this.started = !1), this.callback(this.manager, b, {
                    pointers: c[0],
                    changedPointers: c[1],
                    pointerType: ta,
                    srcEvent: a
                })
            }
        }
    });
    var Wa = {
        touchstart: ya,
        touchmove: za,
        touchend: Aa,
        touchcancel: Ba
    }, Xa = "touchstart touchmove touchend touchcancel";
    j(Q, y, {
        handler: function (a) {
            var b = Wa[a.type], c = R.call(this, a, b);
            c && this.callback(this.manager, b, {pointers: c[0], changedPointers: c[1], pointerType: ta, srcEvent: a})
        }
    }), j(S, y, {
        handler: function (a, b, c) {
            var d = c.pointerType == ta, e = c.pointerType == va;
            if (d)this.mouse.allow = !1; else if (e && !this.mouse.allow)return;
            b & (Aa | Ba) && (this.mouse.allow = !0), this.callback(a, b, c)
        }, destroy: function () {
            this.touch.destroy(), this.mouse.destroy()
        }
    });
    var Ya = v(ja.style, "touchAction"), Za = Ya !== d, $a = "compute", _a = "auto", ab = "manipulation", bb = "none", cb = "pan-x", db = "pan-y";
    T.prototype = {
        set: function (a) {
            a == $a && (a = this.compute()), Za && (this.manager.element.style[Ya] = a), this.actions = a.toLowerCase().trim()
        }, update: function () {
            this.set(this.manager.options.touchAction)
        }, compute: function () {
            var a = [];
            return g(this.manager.recognizers, function (b) {
                l(b.options.enable, [b]) && (a = a.concat(b.getTouchAction()))
            }), U(a.join(" "))
        }, preventDefaults: function (a) {
            if (!Za) {
                var b = a.srcEvent, c = a.offsetDirection;
                if (this.manager.session.prevented)return void b.preventDefault();
                var d = this.actions, e = q(d, bb), f = q(d, db), g = q(d, cb);
                return e || f && c & Ha || g && c & Ia ? this.preventSrc(b) : void 0
            }
        }, preventSrc: function (a) {
            this.manager.session.prevented = !0, a.preventDefault()
        }
    };
    var eb = 1, fb = 2, gb = 4, hb = 8, ib = hb, jb = 16, kb = 32;
    V.prototype = {
        defaults: {}, set: function (a) {
            return h(this.options, a), this.manager && this.manager.touchAction.update(), this
        }, recognizeWith: function (a) {
            if (f(a, "recognizeWith", this))return this;
            var b = this.simultaneous;
            return a = Y(a, this), b[a.id] || (b[a.id] = a, a.recognizeWith(this)), this
        }, dropRecognizeWith: function (a) {
            return f(a, "dropRecognizeWith", this) ? this : (a = Y(a, this), delete this.simultaneous[a.id], this)
        }, requireFailure: function (a) {
            if (f(a, "requireFailure", this))return this;
            var b = this.requireFail;
            return a = Y(a, this), -1 === s(b, a) && (b.push(a), a.requireFailure(this)), this
        }, dropRequireFailure: function (a) {
            if (f(a, "dropRequireFailure", this))return this;
            a = Y(a, this);
            var b = s(this.requireFail, a);
            return b > -1 && this.requireFail.splice(b, 1), this
        }, hasRequireFailures: function () {
            return this.requireFail.length > 0
        }, canRecognizeWith: function (a) {
            return !!this.simultaneous[a.id]
        }, emit: function (a) {
            function b(b) {
                c.manager.emit(c.options.event + (b ? W(d) : ""), a)
            }

            var c = this, d = this.state;
            hb > d && b(!0), b(), d >= hb && b(!0)
        }, tryEmit: function (a) {
            return this.canEmit() ? this.emit(a) : void(this.state = kb)
        }, canEmit: function () {
            for (var a = 0; a < this.requireFail.length;) {
                if (!(this.requireFail[a].state & (kb | eb)))return !1;
                a++
            }
            return !0
        }, recognize: function (a) {
            var b = h({}, a);
            return l(this.options.enable, [this, b]) ? (this.state & (ib | jb | kb) && (this.state = eb), this.state = this.process(b), void(this.state & (fb | gb | hb | jb) && this.tryEmit(b))) : (this.reset(), void(this.state = kb))
        }, process: function (a) {
        }, getTouchAction: function () {
        }, reset: function () {
        }
    }, j(Z, V, {
        defaults: {pointers: 1}, attrTest: function (a) {
            var b = this.options.pointers;
            return 0 === b || a.pointers.length === b
        }, process: function (a) {
            var b = this.state, c = a.eventType, d = b & (fb | gb), e = this.attrTest(a);
            return d && (c & Ba || !e) ? b | jb : d || e ? c & Aa ? b | hb : b & fb ? b | gb : fb : kb
        }
    }), j($, Z, {
        defaults: {event: "pan", threshold: 10, pointers: 1, direction: Ja}, getTouchAction: function () {
            var a = this.options.direction, b = [];
            return a & Ha && b.push(db), a & Ia && b.push(cb), b
        }, directionTest: function (a) {
            var b = this.options, c = !0, d = a.distance, e = a.direction, f = a.deltaX, g = a.deltaY;
            return e & b.direction || (b.direction & Ha ? (e = 0 === f ? Ca : 0 > f ? Da : Ea, c = f != this.pX, d = Math.abs(a.deltaX)) : (e = 0 === g ? Ca : 0 > g ? Fa : Ga, c = g != this.pY, d = Math.abs(a.deltaY))), a.direction = e, c && d > b.threshold && e & b.direction
        }, attrTest: function (a) {
            return Z.prototype.attrTest.call(this, a) && (this.state & fb || !(this.state & fb) && this.directionTest(a))
        }, emit: function (a) {
            this.pX = a.deltaX, this.pY = a.deltaY;
            var b = X(a.direction);
            b && this.manager.emit(this.options.event + b, a), this._super.emit.call(this, a)
        }
    }), j(_, Z, {
        defaults: {event: "pinch", threshold: 0, pointers: 2}, getTouchAction: function () {
            return [bb]
        }, attrTest: function (a) {
            return this._super.attrTest.call(this, a) && (Math.abs(a.scale - 1) > this.options.threshold || this.state & fb)
        }, emit: function (a) {
            if (this._super.emit.call(this, a), 1 !== a.scale) {
                var b = a.scale < 1 ? "in" : "out";
                this.manager.emit(this.options.event + b, a)
            }
        }
    }), j(aa, V, {
        defaults: {event: "press", pointers: 1, time: 500, threshold: 5}, getTouchAction: function () {
            return [_a]
        }, process: function (a) {
            var b = this.options, c = a.pointers.length === b.pointers, d = a.distance < b.threshold, f = a.deltaTime > b.time;
            if (this._input = a, !d || !c || a.eventType & (Aa | Ba) && !f)this.reset(); else if (a.eventType & ya)this.reset(), this._timer = e(function () {
                this.state = ib, this.tryEmit()
            }, b.time, this); else if (a.eventType & Aa)return ib;
            return kb
        }, reset: function () {
            clearTimeout(this._timer)
        }, emit: function (a) {
            this.state === ib && (a && a.eventType & Aa ? this.manager.emit(this.options.event + "up", a) : (this._input.timeStamp = na(), this.manager.emit(this.options.event, this._input)))
        }
    }), j(ba, Z, {
        defaults: {event: "rotate", threshold: 0, pointers: 2}, getTouchAction: function () {
            return [bb]
        }, attrTest: function (a) {
            return this._super.attrTest.call(this, a) && (Math.abs(a.rotation) > this.options.threshold || this.state & fb)
        }
    }), j(ca, Z, {
        defaults: {event: "swipe", threshold: 10, velocity: .65, direction: Ha | Ia, pointers: 1},
        getTouchAction: function () {
            return $.prototype.getTouchAction.call(this)
        },
        attrTest: function (a) {
            var b, c = this.options.direction;
            return c & (Ha | Ia) ? b = a.velocity : c & Ha ? b = a.velocityX : c & Ia && (b = a.velocityY), this._super.attrTest.call(this, a) && c & a.direction && a.distance > this.options.threshold && ma(b) > this.options.velocity && a.eventType & Aa
        },
        emit: function (a) {
            var b = X(a.direction);
            b && this.manager.emit(this.options.event + b, a), this.manager.emit(this.options.event, a)
        }
    }), j(da, V, {
        defaults: {
            event: "tap",
            pointers: 1,
            taps: 1,
            interval: 300,
            time: 250,
            threshold: 2,
            posThreshold: 10
        }, getTouchAction: function () {
            return [ab]
        }, process: function (a) {
            var b = this.options, c = a.pointers.length === b.pointers, d = a.distance < b.threshold, f = a.deltaTime < b.time;
            if (this.reset(), a.eventType & ya && 0 === this.count)return this.failTimeout();
            if (d && f && c) {
                if (a.eventType != Aa)return this.failTimeout();
                var g = this.pTime ? a.timeStamp - this.pTime < b.interval : !0, h = !this.pCenter || I(this.pCenter, a.center) < b.posThreshold;
                this.pTime = a.timeStamp, this.pCenter = a.center, h && g ? this.count += 1 : this.count = 1, this._input = a;
                var i = this.count % b.taps;
                if (0 === i)return this.hasRequireFailures() ? (this._timer = e(function () {
                    this.state = ib, this.tryEmit()
                }, b.interval, this), fb) : ib
            }
            return kb
        }, failTimeout: function () {
            return this._timer = e(function () {
                this.state = kb
            }, this.options.interval, this), kb
        }, reset: function () {
            clearTimeout(this._timer)
        }, emit: function () {
            this.state == ib && (this._input.tapCount = this.count, this.manager.emit(this.options.event, this._input))
        }
    }), ea.VERSION = "2.0.4", ea.defaults = {
        domEvents: !1,
        touchAction: $a,
        enable: !0,
        inputTarget: null,
        inputClass: null,
        preset: [[ba, {enable: !1}], [_, {enable: !1}, ["rotate"]], [ca, {direction: Ha}], [$, {direction: Ha}, ["swipe"]], [da], [da, {
            event: "doubletap",
            taps: 2
        }, ["tap"]], [aa]],
        cssProps: {
            userSelect: "none",
            touchSelect: "none",
            touchCallout: "none",
            contentZooming: "none",
            userDrag: "none",
            tapHighlightColor: "rgba(0,0,0,0)"
        }
    };
    var lb = 1, mb = 2;
    fa.prototype = {
        set: function (a) {
            return h(this.options, a), a.touchAction && this.touchAction.update(), a.inputTarget && (this.input.destroy(), this.input.target = a.inputTarget, this.input.init()), this
        }, stop: function (a) {
            this.session.stopped = a ? mb : lb
        }, recognize: function (a) {
            var b = this.session;
            if (!b.stopped) {
                this.touchAction.preventDefaults(a);
                var c, d = this.recognizers, e = b.curRecognizer;
                (!e || e && e.state & ib) && (e = b.curRecognizer = null);
                for (var f = 0; f < d.length;)c = d[f], b.stopped === mb || e && c != e && !c.canRecognizeWith(e) ? c.reset() : c.recognize(a), !e && c.state & (fb | gb | hb) && (e = b.curRecognizer = c), f++
            }
        }, get: function (a) {
            if (a instanceof V)return a;
            for (var b = this.recognizers, c = 0; c < b.length; c++)if (b[c].options.event == a)return b[c];
            return null
        }, add: function (a) {
            if (f(a, "add", this))return this;
            var b = this.get(a.options.event);
            return b && this.remove(b), this.recognizers.push(a), a.manager = this, this.touchAction.update(), a
        }, remove: function (a) {
            if (f(a, "remove", this))return this;
            var b = this.recognizers;
            return a = this.get(a), b.splice(s(b, a), 1), this.touchAction.update(), this
        }, on: function (a, b) {
            var c = this.handlers;
            return g(r(a), function (a) {
                c[a] = c[a] || [], c[a].push(b)
            }), this
        }, off: function (a, b) {
            var c = this.handlers;
            return g(r(a), function (a) {
                b ? c[a].splice(s(c[a], b), 1) : delete c[a]
            }), this
        }, emit: function (a, b) {
            this.options.domEvents && ha(a, b);
            var c = this.handlers[a] && this.handlers[a].slice();
            if (c && c.length) {
                b.type = a, b.preventDefault = function () {
                    b.srcEvent.preventDefault()
                };
                for (var d = 0; d < c.length;)c[d](b), d++
            }
        }, destroy: function () {
            this.element && ga(this, !1), this.handlers = {}, this.session = {}, this.input.destroy(), this.element = null
        }
    }, h(ea, {
        INPUT_START: ya,
        INPUT_MOVE: za,
        INPUT_END: Aa,
        INPUT_CANCEL: Ba,
        STATE_POSSIBLE: eb,
        STATE_BEGAN: fb,
        STATE_CHANGED: gb,
        STATE_ENDED: hb,
        STATE_RECOGNIZED: ib,
        STATE_CANCELLED: jb,
        STATE_FAILED: kb,
        DIRECTION_NONE: Ca,
        DIRECTION_LEFT: Da,
        DIRECTION_RIGHT: Ea,
        DIRECTION_UP: Fa,
        DIRECTION_DOWN: Ga,
        DIRECTION_HORIZONTAL: Ha,
        DIRECTION_VERTICAL: Ia,
        DIRECTION_ALL: Ja,
        Manager: fa,
        Input: y,
        TouchAction: T,
        TouchInput: Q,
        MouseInput: M,
        PointerEventInput: N,
        TouchMouseInput: S,
        SingleTouchInput: O,
        Recognizer: V,
        AttrRecognizer: Z,
        Tap: da,
        Pan: $,
        Swipe: ca,
        Pinch: _,
        Rotate: ba,
        Press: aa,
        on: n,
        off: o,
        each: g,
        merge: i,
        extend: h,
        inherit: j,
        bindFn: k,
        prefixed: v
    }), typeof define == ka && define.amd ? define("hammerjs", [], function () {
        return ea
    }) : "undefined" != typeof module && module.exports ? module.exports = ea : a[c] = ea
}(window, document, "Hammer"),function (a) {
    "function" == typeof define && define.amd ? define("jquery.hammer", ["jquery", "hammerjs"], a) : "object" == typeof exports ? a(require("jquery"), require("hammerjs")) : a(jQuery, Hammer)
}(function (a, b) {
    function c(c, d) {
        var e = a(c);
        e.data("hammer") || e.data("hammer", new b(e[0], d))
    }

    a.fn.hammer = function (a) {
        return this.each(function () {
            c(this, a)
        })
    }, b.Manager.prototype.emit = function (b) {
        return function (c, d) {
            b.call(this, c, d), a(this.element).trigger({type: c, gesture: d})
        }
    }(b.Manager.prototype.emit)
}),define("KME/controllers/interface/UIActionsController", ["jquery", "i18next", "hammerjs", "jquery.hammer"], function (a) {
    var b = {
        itemButton: '<div class="button %1 action-item" action="%1" title="%1.name" data-i18n="[title]objects:items.%2"><img src="%3" oncontextmenu="return false;"/></div>',
        simpleButton: '<div class="button %1 action-simple" action="%1" title="%1.name" data-i18n="[title]actions:%1.name"><div class="action-icon"></div></div>',
        craftButton: '<div class="button %1 action-craft" action="%1" type="craft" title="%1.name" data-i18n="[title]objects:items.%1"><img src="%2" oncontextmenu="return false;"/></div>',
        buildButton: '<div class="button %1 action-build" action="%1" type="build" title="%1.name" data-i18n="[title]objects:world.%1"><img src="%2" oncontextmenu="return false;"/></div>'
    };
    return {
        prepareDraggable: function (b) {
            b.draggable({
                helper: "clone",
                opacity: .6,
                zIndex: 100,
                scroll: !0,
                scrollSensitivity: 100,
                appendTo: "body",
                delay: 300,
                start: function () {
                    a(this).attr("data-dragging", "1")
                },
                stop: function () {
                    a(this).attr("data-dragging", "0")
                }
            }), b.disableSelection()
        }, registerHandlers: function (b) {
            var c = this;
            b.hammer({preventDefault: !0, gesture: !0, domEvents: !0}), b.on("tap", function (b) {
                if (b.originalEvent) {
                    var d = a(b.originalEvent.target).closest("div.button");
                    c.proceedActionEvent(d)
                }
            }), b.on("press pressup tap", "div.button[action=stay],div.button[action=run]", function (b) {
                if (b.originalEvent) {
                    var c = a(b.originalEvent.target).closest("div.button");
                    c.length && KME.controllers.data.actions.perform(c.attr("action"), null, function () {
                    }, b.type)
                }
            })
        }, proceedActionEvent: function (a) {
            if (a.length) {
                var b = a.attr("action");
                if (a.attr("type") && "craft" == a.attr("type"))return void KME.mainPlayer.craftItem(b, 1);
                if (a.attr("type") && "build" == a.attr("type")) {
                    var c = KME.types.buildTypes.buildTypes[b];
                    return void KME.mainPlayer.build(c, !1, function () {
                    })
                }
                var d = a.data("item");
                a.hasClass("non-exists") || KME.controllers.data.actions.perform(b, d, function () {
                })
            }
        }, createItemButton: function (c, d, e, f) {
            e || (e = KME.utils.itematlas.getImageSource(c.typeName));
            var g = b.itemButton.replace(/%1/g, d);
            return g = g.replace(/%2/g, c.typeName), g = g.replace(/%3/g, e), g = a(g), f && g.append('<span data-i18n="actions:' + d + '.name"></span>'), c.id && g.attr("itemId", c.id), g.attr("itemType", c.typeName), g.attr("action", d), g.data("item", c), g.find("span").i18n(), g.i18n(), this.prepareDraggable(g), g
        }, createItemButtons: function (a, b, c) {
            var d, e = this, f = [], g = KME.types.itemTypes[a.typeName], h = KME.utils.itematlas.getImageSource(a.typeName);
            return g.actions && Object.keys(g.actions).forEach(function (g) {
                d = g, b && b[g] && (d = b[g]), "itemRepair" !== d && f.push(e.createItemButton(a, d, h, c))
            }), f
        }, createSimpleButton: function (c) {
            var d = b.simpleButton.replace(/%1/g, c.name);
            return d = a(d), d.find("span").i18n(), d.i18n(), this.prepareDraggable(d), d
        }, createCraftButton: function (c) {
            var d = KME.utils.itematlas.getImageSource(c.craftType), e = b.craftButton.replace(/%1/g, c.craftType);
            return e = e.replace(/%2/g, d), e = a(e), e.find("span").i18n(), e.i18n(), this.prepareDraggable(e), e
        }, createBuildButton: function (c) {
            var d = KME.types.buildTypes.buildTypes[c.buildType], e = b.buildButton.replace(/%1/g, c.buildType);
            return e = e.replace(/%2/g, d.imageSource), e = a(e), e.find("span").i18n(), e.i18n(), this.prepareDraggable(e), e
        }
    }
}),define("KME/controllers/interface/CursorController", ["jquery"], function (a) {
    function b() {
        return e.length ? e.pop() : "arrow.png" + (f ? '"' : "") + "), auto"
    }

    function c(a) {
        var c = d.css("cursor"), e = c.split("/");
        a ? (e[e.length - 1] = a, d.css("cursor", e.join("/") + (f ? '"' : "") + "), auto")) : (a = b(), e[e.length - 1] = a, d.css("cursor", e.join("/")))
    }

    var d = a("#game"), e = [], f = d.css("cursor").indexOf('url("') >= 0;
    return {
        setNormal: function () {
            c("arrow.png")
        }, setAttack: function () {
            c("attack.png")
        }, setTool: function () {
            c("action.png")
        }, setLoot: function () {
            c("loot.png")
        }, setRepair: function () {
            c("repair.png")
        }, setDemolish: function () {
            c("demolish.png")
        }, restore: function () {
            c("arrow.png")
        }
    }
}),function (a) {
    define("bootstrap-tour", ["bootstrap", "jquery"], function () {
        return function () {
            !function (a, b) {
                var c, d;
                return d = b.document, c = function () {
                    function c(c) {
                        var d;
                        try {
                            d = b.localStorage
                        } catch (e) {
                            d = !1
                        }
                        this._options = a.extend({
                            name: "tour",
                            steps: [],
                            container: "body",
                            autoscroll: !0,
                            keyboard: !0,
                            storage: d,
                            debug: !1,
                            backdrop: !1,
                            backdropPadding: 0,
                            redirect: !0,
                            orphan: !1,
                            duration: !1,
                            delay: !1,
                            basePath: "",
                            template: '<div class="popover" role="tooltip"> <div class="arrow"></div> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-default" data-role="prev">&laquo; Prev</button> <button class="btn btn-sm btn-default" data-role="next">Next &raquo;</button> <button class="btn btn-sm btn-default" data-role="pause-resume" data-pause-text="Pause" data-resume-text="Resume">Pause</button> </div> <button class="btn btn-sm btn-default" data-role="end">End tour</button> </div> </div>',
                            afterSetState: function (a, b) {
                            },
                            afterGetState: function (a, b) {
                            },
                            afterRemoveState: function (a) {
                            },
                            onStart: function (a) {
                            },
                            onEnd: function (a) {
                            },
                            onShow: function (a) {
                            },
                            onShown: function (a) {
                            },
                            onHide: function (a) {
                            },
                            onHidden: function (a) {
                            },
                            onNext: function (a) {
                            },
                            onPrev: function (a) {
                            },
                            onPause: function (a, b) {
                            },
                            onResume: function (a, b) {
                            }
                        }, c), this._force = !1, this._inited = !1, this.backdrop = {
                            overlay: null,
                            $element: null,
                            $background: null,
                            backgroundShown: !1,
                            overlayElementShown: !1
                        }
                    }

                    return c.prototype.addSteps = function (a) {
                        var b, c, d;
                        for (c = 0, d = a.length; d > c; c++)b = a[c], this.addStep(b);
                        return this
                    }, c.prototype.addStep = function (a) {
                        return this._options.steps.push(a), this
                    }, c.prototype.getStep = function (b) {
                        return null != this._options.steps[b] ? a.extend({
                            id: "step-" + b,
                            path: "",
                            placement: "right",
                            title: "",
                            content: "<p></p>",
                            next: b === this._options.steps.length - 1 ? -1 : b + 1,
                            prev: b - 1,
                            animation: !0,
                            container: this._options.container,
                            autoscroll: this._options.autoscroll,
                            backdrop: this._options.backdrop,
                            backdropPadding: this._options.backdropPadding,
                            redirect: this._options.redirect,
                            orphan: this._options.orphan,
                            duration: this._options.duration,
                            delay: this._options.delay,
                            template: this._options.template,
                            onShow: this._options.onShow,
                            onShown: this._options.onShown,
                            onHide: this._options.onHide,
                            onHidden: this._options.onHidden,
                            onNext: this._options.onNext,
                            onPrev: this._options.onPrev,
                            onPause: this._options.onPause,
                            onResume: this._options.onResume
                        }, this._options.steps[b]) : void 0
                    }, c.prototype.init = function (a) {
                        return this._force = a, this.ended() ? (this._debug("Tour ended, init prevented."), this) : (this.setCurrentStep(), this._initMouseNavigation(), this._initKeyboardNavigation(), this._onResize(function (a) {
                            return function () {
                                return a.showStep(a._current)
                            }
                        }(this)), null !== this._current && this.showStep(this._current), this._inited = !0, this)
                    }, c.prototype.start = function (a) {
                        var b;
                        return null == a && (a = !1), this._inited || this.init(a), null === this._current && (b = this._makePromise(null != this._options.onStart ? this._options.onStart(this) : void 0), this._callOnPromiseDone(b, this.showStep, 0)), this
                    }, c.prototype.next = function () {
                        var a;
                        return a = this.hideStep(this._current), this._callOnPromiseDone(a, this._showNextStep)
                    }, c.prototype.prev = function () {
                        var a;
                        return a = this.hideStep(this._current), this._callOnPromiseDone(a, this._showPrevStep)
                    }, c.prototype.goTo = function (a) {
                        var b;
                        return b = this.hideStep(this._current), this._callOnPromiseDone(b, this.showStep, a)
                    }, c.prototype.end = function () {
                        var c, e;
                        return c = function (c) {
                            return function (e) {
                                return a(d).off("click.tour-" + c._options.name), a(d).off("keyup.tour-" + c._options.name), a(b).off("resize.tour-" + c._options.name), c._setState("end", "yes"), c._inited = !1, c._force = !1, c._clearTimer(), null != c._options.onEnd ? c._options.onEnd(c) : void 0
                            }
                        }(this), e = this.hideStep(this._current), this._callOnPromiseDone(e, c)
                    }, c.prototype.ended = function () {
                        return !this._force && !!this._getState("end")
                    }, c.prototype.restart = function () {
                        return this._removeState("current_step"), this._removeState("end"), this.start()
                    }, c.prototype.pause = function () {
                        var a;
                        return a = this.getStep(this._current), a && a.duration ? (this._paused = !0, this._duration -= (new Date).getTime() - this._start,
                            b.clearTimeout(this._timer), this._debug("Paused/Stopped step " + (this._current + 1) + " timer (" + this._duration + " remaining)."), null != a.onPause ? a.onPause(this, this._duration) : void 0) : this
                    }, c.prototype.resume = function () {
                        var a;
                        return a = this.getStep(this._current), a && a.duration ? (this._paused = !1, this._start = (new Date).getTime(), this._duration = this._duration || a.duration, this._timer = b.setTimeout(function (a) {
                            return function () {
                                return a._isLast() ? a.next() : a.end()
                            }
                        }(this), this._duration), this._debug("Started step " + (this._current + 1) + " timer with duration " + this._duration), null != a.onResume && this._duration !== a.duration ? a.onResume(this, this._duration) : void 0) : this
                    }, c.prototype.hideStep = function (b) {
                        var c, d, e;
                        return (e = this.getStep(b)) ? (this._clearTimer(), d = this._makePromise(null != e.onHide ? e.onHide(this, b) : void 0), c = function (c) {
                            return function (d) {
                                var f;
                                return f = a(e.element), f.data("bs.popover") || f.data("popover") || (f = a("body")), f.popover("destroy").removeClass("tour-" + c._options.name + "-element tour-" + c._options.name + "-" + b + "-element"), e.reflex && f.removeClass("tour-step-element-reflex").off("" + c._reflexEvent(e.reflex) + ".tour-" + c._options.name), e.backdrop && c._hideBackdrop(), null != e.onHidden ? e.onHidden(c) : void 0
                            }
                        }(this), this._callOnPromiseDone(d, c), d) : void 0
                    }, c.prototype.showStep = function (a) {
                        var c, e, f, g;
                        return this.ended() ? (this._debug("Tour ended, showStep prevented."), this) : (g = this.getStep(a)) ? (f = a < this._current, c = this._makePromise(null != g.onShow ? g.onShow(this, a) : void 0), e = function (b) {
                            return function (c) {
                                var e, h, i;
                                if (b.setCurrentStep(a), h = function () {
                                        switch ({}.toString.call(g.path)) {
                                            case"[object Function]":
                                                return g.path();
                                            case"[object String]":
                                                return this._options.basePath + g.path;
                                            default:
                                                return g.path
                                        }
                                    }.call(b), e = [d.location.pathname, d.location.hash].join(""), b._isRedirect(h, e))return void b._redirect(g, h);
                                if (b._isOrphan(g)) {
                                    if (!g.orphan)return b._debug("Skip the orphan step " + (b._current + 1) + ".\nOrphan option is false and the element does not exist or is hidden."), void(f ? b._showPrevStep() : b._showNextStep());
                                    b._debug("Show the orphan step " + (b._current + 1) + ". Orphans option is true.")
                                }
                                return g.backdrop && b._showBackdrop(b._isOrphan(g) ? void 0 : g.element), i = function () {
                                    return b.getCurrentStep() === a ? (null != g.element && g.backdrop && b._showOverlayElement(g), b._showPopover(g, a), null != g.onShown && g.onShown(b), b._debug("Step " + (b._current + 1) + " of " + b._options.steps.length)) : void 0
                                }, g.autoscroll ? b._scrollIntoView(g.element, i) : i(), g.duration ? b.resume() : void 0
                            }
                        }(this), g.delay ? (this._debug("Wait " + g.delay + " milliseconds to show the step " + (this._current + 1)), b.setTimeout(function (a) {
                            return function () {
                                return a._callOnPromiseDone(c, e)
                            }
                        }(this), g.delay)) : this._callOnPromiseDone(c, e), c) : void 0
                    }, c.prototype.getCurrentStep = function () {
                        return this._current
                    }, c.prototype.setCurrentStep = function (a) {
                        return null != a ? (this._current = a, this._setState("current_step", a)) : (this._current = this._getState("current_step"), this._current = null === this._current ? null : parseInt(this._current, 10)), this
                    }, c.prototype._setState = function (a, b) {
                        var c, d;
                        if (this._options.storage) {
                            d = "" + this._options.name + "_" + a;
                            try {
                                this._options.storage.setItem(d, b)
                            } catch (e) {
                                c = e, c.code === DOMException.QUOTA_EXCEEDED_ERR && this.debug("LocalStorage quota exceeded. State storage failed.")
                            }
                            return this._options.afterSetState(d, b)
                        }
                        return null == this._state && (this._state = {}), this._state[a] = b
                    }, c.prototype._removeState = function (a) {
                        var b;
                        return this._options.storage ? (b = "" + this._options.name + "_" + a, this._options.storage.removeItem(b), this._options.afterRemoveState(b)) : null != this._state ? delete this._state[a] : void 0
                    }, c.prototype._getState = function (a) {
                        var b, c;
                        return this._options.storage ? (b = "" + this._options.name + "_" + a, c = this._options.storage.getItem(b)) : null != this._state && (c = this._state[a]), (void 0 === c || "null" === c) && (c = null), this._options.afterGetState(a, c), c
                    }, c.prototype._showNextStep = function () {
                        var a, b, c;
                        return c = this.getStep(this._current), b = function (a) {
                            return function (b) {
                                return a.showStep(c.next)
                            }
                        }(this), a = this._makePromise(null != c.onNext ? c.onNext(this) : void 0), this._callOnPromiseDone(a, b)
                    }, c.prototype._showPrevStep = function () {
                        var a, b, c;
                        return c = this.getStep(this._current), b = function (a) {
                            return function (b) {
                                return a.showStep(c.prev)
                            }
                        }(this), a = this._makePromise(null != c.onPrev ? c.onPrev(this) : void 0), this._callOnPromiseDone(a, b)
                    }, c.prototype._debug = function (a) {
                        return this._options.debug ? b.console.log("Bootstrap Tour '" + this._options.name + "' | " + a) : void 0
                    }, c.prototype._isRedirect = function (a, b) {
                        return null != a && "" !== a && ("[object RegExp]" === {}.toString.call(a) && !a.test(b) || "[object String]" === {}.toString.call(a) && a.replace(/\?.*$/, "").replace(/\/?$/, "") !== b.replace(/\/?$/, ""))
                    }, c.prototype._redirect = function (b, c) {
                        return a.isFunction(b.redirect) ? b.redirect.call(this, c) : b.redirect === !0 ? (this._debug("Redirect to " + c), d.location.href = c) : void 0
                    }, c.prototype._isOrphan = function (b) {
                        return null == b.element || !a(b.element).length || a(b.element).is(":hidden") && "http://www.w3.org/2000/svg" !== a(b.element)[0].namespaceURI
                    }, c.prototype._isLast = function () {
                        return this._current < this._options.steps.length - 1
                    }, c.prototype._showPopover = function (b, c) {
                        var d, e, f, g;
                        return a(".tour-" + this._options.name).remove(), g = a.extend({}, this._options), f = this._isOrphan(b), b.template = this._template(b, c), f && (b.element = "body", b.placement = "top"), d = a(b.element), d.addClass("tour-" + this._options.name + "-element tour-" + this._options.name + "-" + c + "-element"), b.options && a.extend(g, b.options), b.reflex && !f && (d.addClass("tour-step-element-reflex"), d.off("" + this._reflexEvent(b.reflex) + ".tour-" + this._options.name), d.on("" + this._reflexEvent(b.reflex) + ".tour-" + this._options.name, function (a) {
                            return function () {
                                return a._isLast() ? a.next() : a.end()
                            }
                        }(this))), d.popover({
                            trigger: "manual",
                            placement: b.placement,
                            trigger: "manual",
                            title: b.title,
                            content: b.content,
                            html: !0,
                            animation: b.animation,
                            container: b.container,
                            template: b.template
                        }), e = d.data("bs.popover") ? d.data("bs.popover").tip() : d.data("popover").tip(), e.attr("id", b.id), this._reposition(e, b), d.popover("show"), f ? this._center(e) : void 0
                    }, c.prototype._template = function (b, c) {
                        var d, e, f, g;
                        return g = a(a.isFunction(b.template) ? b.template(c, b) : b.template), d = g.find(".popover-navigation"), f = d.find('[data-role="prev"]'), e = d.find('[data-role="next"]'), this._isOrphan(b) && g.addClass("orphan"), g.addClass("tour-" + this._options.name + " tour-" + this._options.name + "-" + c), b.prev < 0 && d.find('[data-role="prev"]').addClass("disabled"), b.next < 0 && d.find('[data-role="next"]').addClass("disabled"), b.duration || d.find('[data-role="pause-resume"]').remove(), g.clone().wrap("<div>").parent().html()
                    }, c.prototype._reflexEvent = function (a) {
                        return "[object Boolean]" === {}.toString.call(a) ? "click" : a
                    }, c.prototype._reposition = function (b, c) {
                        var e, f, g, h, i, j, k;
                        if (h = b[0].offsetWidth, f = b[0].offsetHeight, k = b.offset(), i = k.left, j = k.top, e = a(d).outerHeight() - k.top - b.outerHeight(), 0 > e && (k.top = k.top + e), g = a("html").outerWidth() - k.left - b.outerWidth(), 0 > g && (k.left = k.left + g), k.top < 0 && (k.top = 0), k.left < 0 && (k.left = 0), b.offset(k), "bottom" === c.placement || "top" === c.placement) {
                            if (i !== k.left)return this._replaceArrow(b, 2 * (k.left - i), h, "left")
                        } else if (j !== k.top)return this._replaceArrow(b, 2 * (k.top - j), f, "top")
                    }, c.prototype._center = function (c) {
                        return c.css("top", a(b).outerHeight() / 2 - c.outerHeight() / 2)
                    }, c.prototype._replaceArrow = function (a, b, c, d) {
                        return a.find(".arrow").css(d, b ? 50 * (1 - b / c) + "%" : "")
                    }, c.prototype._scrollIntoView = function (c, d) {
                        var e, f, g, h, i, j;
                        return e = a(c), e.length ? (f = a(b), h = e.offset().top, j = f.height(), i = Math.max(0, h - j / 2), this._debug("Scroll into view. ScrollTop: " + i + ". Element offset: " + h + ". Window height: " + j + "."), g = 0, a("body, html").stop(!0, !0).animate({scrollTop: Math.ceil(i)}, function (a) {
                            return function () {
                                return 2 === ++g ? (d(), a._debug("Scroll into view.\nAnimation end element offset: " + e.offset().top + ".\nWindow height: " + f.height() + ".")) : void 0
                            }
                        }(this))) : d()
                    }, c.prototype._onResize = function (c, d) {
                        return a(b).on("resize.tour-" + this._options.name, function () {
                            return clearTimeout(d), d = setTimeout(c, 100)
                        })
                    }, c.prototype._initMouseNavigation = function () {
                        var b;
                        return b = this, a(d).off("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='prev']").off("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='next']").off("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='end']").off("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='pause-resume']").on("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='next']", function (a) {
                            return function (b) {
                                return b.preventDefault(), a.next()
                            }
                        }(this)).on("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='prev']", function (a) {
                            return function (b) {
                                return b.preventDefault(), a.prev()
                            }
                        }(this)).on("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='end']", function (a) {
                            return function (b) {
                                return b.preventDefault(), a.end()
                            }
                        }(this)).on("click.tour-" + this._options.name, ".popover.tour-" + this._options.name + " *[data-role='pause-resume']", function (c) {
                            var d;
                            return c.preventDefault(), d = a(this), d.text(b._paused ? d.data("pause-text") : d.data("resume-text")), b._paused ? b.resume() : b.pause()
                        })
                    }, c.prototype._initKeyboardNavigation = function () {
                        return this._options.keyboard ? a(d).on("keyup.tour-" + this._options.name, function (a) {
                            return function (b) {
                                if (b.which)switch (b.which) {
                                    case 39:
                                        return b.preventDefault(), a._isLast() ? a.next() : a.end();
                                    case 37:
                                        if (b.preventDefault(), a._current > 0)return a.prev();
                                        break;
                                    case 27:
                                        return b.preventDefault(), a.end()
                                }
                            }
                        }(this)) : void 0
                    }, c.prototype._makePromise = function (b) {
                        return b && a.isFunction(b.then) ? b : null
                    }, c.prototype._callOnPromiseDone = function (a, b, c) {
                        return a ? a.then(function (a) {
                            return function (d) {
                                return b.call(a, c)
                            }
                        }(this)) : b.call(this, c)
                    }, c.prototype._showBackdrop = function (b) {
                        return this.backdrop.backgroundShown ? void 0 : (this.backdrop = a("<div>", {"class": "tour-backdrop"}), this.backdrop.backgroundShown = !0, a("body").append(this.backdrop))
                    }, c.prototype._hideBackdrop = function () {
                        return this._hideOverlayElement(), this._hideBackground()
                    }, c.prototype._hideBackground = function () {
                        return this.backdrop ? (this.backdrop.remove(), this.backdrop.overlay = null, this.backdrop.backgroundShown = !1) : void 0
                    }, c.prototype._showOverlayElement = function (b) {
                        var c, d;
                        return c = a(b.element), c && 0 !== c.length && !this.backdrop.overlayElementShown ? (this.backdrop.overlayElementShown = !0, this.backdrop.$element = c.addClass("tour-step-backdrop"), this.backdrop.$background = a("<div>", {"class": "tour-step-background"}), d = {
                            width: c.innerWidth(),
                            height: c.innerHeight(),
                            offset: c.offset()
                        }, this.backdrop.$background.appendTo("body"), b.backdropPadding && (d = this._applyBackdropPadding(b.backdropPadding, d)), this.backdrop.$background.width(d.width).height(d.height).offset(d.offset)) : void 0
                    }, c.prototype._hideOverlayElement = function () {
                        return this.backdrop.overlayElementShown ? (this.backdrop.$element.removeClass("tour-step-backdrop"), this.backdrop.$background.remove(), this.backdrop.$element = null, this.backdrop.$background = null, this.backdrop.overlayElementShown = !1) : void 0
                    }, c.prototype._applyBackdropPadding = function (a, b) {
                        return "object" == typeof a ? (null == a.top && (a.top = 0), null == a.right && (a.right = 0), null == a.bottom && (a.bottom = 0), null == a.left && (a.left = 0), b.offset.top = b.offset.top - a.top, b.offset.left = b.offset.left - a.left, b.width = b.width + a.left + a.right, b.height = b.height + a.top + a.bottom) : (b.offset.top = b.offset.top - a, b.offset.left = b.offset.left - a, b.width = b.width + 2 * a, b.height = b.height + 2 * a), b
                    }, c.prototype._clearTimer = function () {
                        return b.clearTimeout(this._timer), this._timer = null, this._duration = null
                    }, c
                }(), b.Tour = c
            }(jQuery, window)
        }.apply(a, arguments)
    })
}(this),define("KME/controllers/interface/TutorialController", ["jquery", "bootstrap", "bootstrap-tour", "i18next"], function () {
    var a;
    return {
        init: function (b) {
            $.i18n.loadNamespace("tutorial", function () {
                a = new Tour({
                    storage: window.localStorage,
                    template: '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div><div class="popover-navigation"><div class="btn-group"><button class="btn btn-sm btn-default" data-role="prev">' + $.t("tutorial:controls.prev") + '</button> <button class="btn btn-sm btn-default" data-role="next">' + $.t("tutorial:controls.next") + '</button> </div> <button class="btn btn-sm btn-default" data-role="end">' + $.t("tutorial:controls.endTour") + "</button></div></div>",
                    steps: [{
                        element: "#topbar",
                        title: $.t("tutorial:topbarTutorial.title"),
                        content: $.t("tutorial:topbarTutorial.content"),
                        backdrop: !0,
                        container: "body",
                        placement: "bottom"
                    }, {
                        element: "#toolbar",
                        title: $.t("tutorial:toolbarTutorial.title"),
                        content: $.t("tutorial:toolbarTutorial.content"),
                        placement: "top",
                        backdrop: !0,
                        container: "body"
                    }, {
                        element: $("#craft").closest(".wtWindow"),
                        title: $.t("tutorial:craftTutorial.title"),
                        content: $.t("tutorial:craftTutorial.content"),
                        placement: "right",
                        backdrop: !0,
                        container: "body",
                        onShow: function () {
                            $("#craft").find('.wtWindow-close,input[type="button"]').css("pointerEvents", "none"), $("#craft").closest(".wtWindow").css("zIndex", "1200"), KME.interfaces.craft.craft("open")
                        },
                        onHide: function () {
                            $("#craft").find('.wtWindow-close,input[type="button"]').css("pointerEvents", "auto"), KME.interfaces.craft.craft("close")
                        }
                    }, {
                        element: $("#build").closest(".wtWindow"),
                        title: $.t("tutorial:buildTutorial.title"),
                        content: $.t("tutorial:buildTutorial.content"),
                        placement: "right",
                        backdrop: !0,
                        container: "body",
                        onShow: function () {
                            $("#build").find('.wtWindow-close,input[type="button"]').css("pointerEvents", "none"), $("#build").closest(".wtWindow").css("zIndex", "1200"), KME.interfaces.build.build("open")
                        },
                        onHide: function () {
                            $("#build").find('.wtWindow-close,input[type="button"]').css("pointerEvents", "auto"), KME.interfaces.build.build("close")
                        }
                    }]
                }), a.init(), a.start(b)
            })
        }
    }
}),define("KME/controllers/interface/DaylightController", ["jquery"], function (a) {
    function b(b) {
        e.globalCompositeOperation = "xor";
        var c = e.createRadialGradient(b.x, b.y, 0, b.x, b.y, i);
        c.addColorStop(1, "rgba(0,0,0," + (1 - h) + ")"), c.addColorStop(0, j), e.fillStyle = c, e.fillRect(0, 0, a(d).width(), a(d).height())
    }

    function c(b) {
        e.globalCompositeOperation = "xor";
        var c = b.x - KME.game.camera.x | 0, f = b.y - KME.game.camera.y | 0, g = e.createRadialGradient(c, f, 0, c, f, i);
        g.addColorStop(1, "rgba(0,0,0," + (1 - h) + ")"), g.addColorStop(0, j), e.fillStyle = g, e.fillRect(0, 0, a(d).width(), a(d).height())
    }

    var d = null, e = null, f = {}, g = .1, h = 1, i = 50, j = "rgba(0,0,0," + (1 - g) + ")";
    return {
        isPlayerHaveTorch: !1, init: function () {
            function b() {
                d.show(), d.css("opacity", .95)
            }

            d = a("#daylight-effect"), e = d.get(0).getContext("2d"), b(), this.render()
        }, render: function () {
            d && (e.clearRect(0, 0, d.width, d.height), e.globalCompositeOperation = "source-over", e.fillStyle = j, e.fillRect(0, 0, a(d).width(), a(d).height()), this.isPlayerHaveTorch && b({
                x: 150,
                y: 70
            }), Object.keys(f).length > 0 && Object.keys(f).forEach(function (a) {
                c(f[a])
            }), this.isPlayerHaveTorch || Object.keys(f).length > 0 ? e.globalCompositeOperation = "xor" : e.globalCompositeOperation = "source-over")
        }, addLightPoint: function (a, b) {
            f[a] = b, this.render()
        }, removeLightPoint: function (a) {
            delete f[a], this.render()
        }, setPlayerHaveTorch: function (a) {
            this.isPlayerHaveTorch = a, this.render()
        }, movePlayer: function () {
            Object.keys(f).length > 0 && this.render()
        }
    }
}),function (a) {
    "use strict";
    "function" == typeof define && define.amd ? define("perfect-scrollbar", ["jquery"], a) : a("object" == typeof exports ? require("jquery") : jQuery)
}(function (a) {
    "use strict";
    function b(a) {
        return "string" == typeof a ? parseInt(a, 10) : ~~a
    }

    var c = {
        wheelSpeed: 1,
        wheelPropagation: !1,
        swipePropagation: !0,
        minScrollbarLength: null,
        maxScrollbarLength: null,
        useBothWheelAxes: !1,
        useKeyboard: !0,
        suppressScrollX: !1,
        suppressScrollY: !1,
        scrollXMarginOffset: 0,
        scrollYMarginOffset: 0,
        includePadding: !1
    }, d = 0, e = function () {
        var a = d++;
        return function (b) {
            var c = ".perfect-scrollbar-" + a;
            return "undefined" == typeof b ? c : b + c
        }
    }, f = "WebkitAppearance" in document.documentElement.style;
    a.fn.perfectScrollbar = function (d, g) {
        return this.each(function () {
            function h(a, c) {
                var d = a + c, e = C - K;
                L = 0 > d ? 0 : d > e ? e : d;
                var f = b(L * (E - C) / (C - K));
                z.scrollTop(f)
            }

            function i(a, c) {
                var d = a + c, e = B - G;
                H = 0 > d ? 0 : d > e ? e : d;
                var f = b(H * (D - B) / (B - G));
                z.scrollLeft(f)
            }

            function j(a) {
                return y.minScrollbarLength && (a = Math.max(a, y.minScrollbarLength)), y.maxScrollbarLength && (a = Math.min(a, y.maxScrollbarLength)), a
            }

            function k() {
                var a = {width: I};
                N ? a.left = z.scrollLeft() + B - D : a.left = z.scrollLeft(), T ? a.bottom = S - z.scrollTop() : a.top = U + z.scrollTop(), Q.css(a);
                var b = {top: z.scrollTop(), height: M};
                $ ? N ? b.right = D - z.scrollLeft() - Z - Y.outerWidth() : b.right = Z - z.scrollLeft() : N ? b.left = z.scrollLeft() + 2 * B - D - _ - Y.outerWidth() : b.left = _ + z.scrollLeft(), X.css(b), R.css({
                    left: H,
                    width: G - V
                }), Y.css({top: L, height: K - aa})
            }

            function l() {
                z.removeClass("ps-active-x"), z.removeClass("ps-active-y"), B = y.includePadding ? z.innerWidth() : z.width(), C = y.includePadding ? z.innerHeight() : z.height(), D = z.prop("scrollWidth"), E = z.prop("scrollHeight"), !y.suppressScrollX && B + y.scrollXMarginOffset < D ? (F = !0, I = B - W, G = j(b(I * B / D)), H = b(z.scrollLeft() * (I - G) / (D - B))) : (F = !1, G = 0, H = 0, z.scrollLeft(0)), !y.suppressScrollY && C + y.scrollYMarginOffset < E ? (J = !0, M = C - ba, K = j(b(M * C / E)), L = b(z.scrollTop() * (M - K) / (E - C))) : (J = !1, K = 0, L = 0, z.scrollTop(0)), H >= I - G && (H = I - G), L >= M - K && (L = M - K), k(), F && z.addClass("ps-active-x"), J && z.addClass("ps-active-y")
            }

            function m() {
                var b, c, d = function (a) {
                    i(b, a.pageX - c), l(), a.stopPropagation(), a.preventDefault()
                }, e = function (b) {
                    z.removeClass("ps-in-scrolling"), a(P).unbind(O("mousemove"), d)
                };
                R.bind(O("mousedown"), function (f) {
                    c = f.pageX, b = R.position().left, z.addClass("ps-in-scrolling"), a(P).bind(O("mousemove"), d), a(P).one(O("mouseup"), e), f.stopPropagation(), f.preventDefault()
                }), b = c = null
            }

            function n() {
                var b, c, d = function (a) {
                    h(b, a.pageY - c), l(), a.stopPropagation(), a.preventDefault()
                }, e = function (b) {
                    z.removeClass("ps-in-scrolling"), a(P).unbind(O("mousemove"), d)
                };
                Y.bind(O("mousedown"), function (f) {
                    c = f.pageY, b = Y.position().top, z.addClass("ps-in-scrolling"), a(P).bind(O("mousemove"), d), a(P).one(O("mouseup"), e), f.stopPropagation(), f.preventDefault()
                }), b = c = null
            }

            function o(a, b) {
                var c = z.scrollTop();
                if (0 === a) {
                    if (!J)return !1;
                    if (0 === c && b > 0 || c >= E - C && 0 > b)return !y.wheelPropagation
                }
                var d = z.scrollLeft();
                if (0 === b) {
                    if (!F)return !1;
                    if (0 === d && 0 > a || d >= D - B && a > 0)return !y.wheelPropagation
                }
                return !0
            }

            function p(a, b) {
                var c = z.scrollTop(), d = z.scrollLeft(), e = Math.abs(a), f = Math.abs(b);
                if (f > e) {
                    if (0 > b && c === E - C || b > 0 && 0 === c)return !y.swipePropagation
                } else if (e > f && (0 > a && d === D - B || a > 0 && 0 === d))return !y.swipePropagation;
                return !0
            }

            function q() {
                function a(a) {
                    var b = a.originalEvent.deltaX, c = -1 * a.originalEvent.deltaY;
                    return ("undefined" == typeof b || "undefined" == typeof c) && (b = -1 * a.originalEvent.wheelDeltaX / 6, c = a.originalEvent.wheelDeltaY / 6), a.originalEvent.deltaMode && 1 === a.originalEvent.deltaMode && (b *= 10, c *= 10), b !== b && c !== c && (b = 0, c = a.originalEvent.wheelDelta), [b, c]
                }

                function b(b) {
                    if (f || !(z.find("select:focus").length > 0)) {
                        var d = a(b), e = d[0], g = d[1];
                        c = !1, y.useBothWheelAxes ? J && !F ? (g ? z.scrollTop(z.scrollTop() - g * y.wheelSpeed) : z.scrollTop(z.scrollTop() + e * y.wheelSpeed), c = !0) : F && !J && (e ? z.scrollLeft(z.scrollLeft() + e * y.wheelSpeed) : z.scrollLeft(z.scrollLeft() - g * y.wheelSpeed), c = !0) : (z.scrollTop(z.scrollTop() - g * y.wheelSpeed), z.scrollLeft(z.scrollLeft() + e * y.wheelSpeed)), l(), c = c || o(e, g), c && (b.stopPropagation(), b.preventDefault())
                    }
                }

                var c = !1;
                "undefined" != typeof window.onwheel ? z.bind(O("wheel"), b) : "undefined" != typeof window.onmousewheel && z.bind(O("mousewheel"), b)
            }

            function r() {
                var b = !1;
                z.bind(O("mouseenter"), function (a) {
                    b = !0
                }), z.bind(O("mouseleave"), function (a) {
                    b = !1
                });
                var c = !1;
                a(P).bind(O("keydown"), function (d) {
                    if ((!d.isDefaultPrevented || !d.isDefaultPrevented()) && b) {
                        for (var e = document.activeElement ? document.activeElement : P.activeElement; e.shadowRoot;)e = e.shadowRoot.activeElement;
                        if (!a(e).is(":input,[contenteditable]")) {
                            var f = 0, g = 0;
                            switch (d.which) {
                                case 37:
                                    f = -30;
                                    break;
                                case 38:
                                    g = 30;
                                    break;
                                case 39:
                                    f = 30;
                                    break;
                                case 40:
                                    g = -30;
                                    break;
                                case 33:
                                    g = 90;
                                    break;
                                case 32:
                                case 34:
                                    g = -90;
                                    break;
                                case 35:
                                    g = d.ctrlKey ? -E : -C;
                                    break;
                                case 36:
                                    g = d.ctrlKey ? z.scrollTop() : C;
                                    break;
                                default:
                                    return
                            }
                            z.scrollTop(z.scrollTop() - g), z.scrollLeft(z.scrollLeft() + f), c = o(f, g), c && d.preventDefault()
                        }
                    }
                })
            }

            function s() {
                function a(a) {
                    a.stopPropagation()
                }

                Y.bind(O("click"), a), X.bind(O("click"), function (a) {
                    var c = b(K / 2), d = a.pageY - X.offset().top - c, e = C - K, f = d / e;
                    0 > f ? f = 0 : f > 1 && (f = 1), z.scrollTop((E - C) * f)
                }), R.bind(O("click"), a), Q.bind(O("click"), function (a) {
                    var c = b(G / 2), d = a.pageX - Q.offset().left - c, e = B - G, f = d / e;
                    0 > f ? f = 0 : f > 1 && (f = 1), z.scrollLeft((D - B) * f)
                })
            }

            function t() {
                function b() {
                    var a = window.getSelection ? window.getSelection() : document.getSlection ? document.getSlection() : {rangeCount: 0};
                    return 0 === a.rangeCount ? null : a.getRangeAt(0).commonAncestorContainer
                }

                function c() {
                    e || (e = setInterval(function () {
                        return A() ? (z.scrollTop(z.scrollTop() + f.top), z.scrollLeft(z.scrollLeft() + f.left), void l()) : void clearInterval(e)
                    }, 50))
                }

                function d() {
                    e && (clearInterval(e), e = null), z.removeClass("ps-in-scrolling"), z.removeClass("ps-in-scrolling")
                }

                var e = null, f = {top: 0, left: 0}, g = !1;
                a(P).bind(O("selectionchange"), function (c) {
                    a.contains(z[0], b()) ? g = !0 : (g = !1, d())
                }), a(window).bind(O("mouseup"), function (a) {
                    g && (g = !1, d())
                }), a(window).bind(O("mousemove"), function (a) {
                    if (g) {
                        var b = {x: a.pageX, y: a.pageY}, e = z.offset(), h = {
                            left: e.left,
                            right: e.left + z.outerWidth(),
                            top: e.top,
                            bottom: e.top + z.outerHeight()
                        };
                        b.x < h.left + 3 ? (f.left = -5, z.addClass("ps-in-scrolling")) : b.x > h.right - 3 ? (f.left = 5, z.addClass("ps-in-scrolling")) : f.left = 0, b.y < h.top + 3 ? (h.top + 3 - b.y < 5 ? f.top = -5 : f.top = -20, z.addClass("ps-in-scrolling")) : b.y > h.bottom - 3 ? (b.y - h.bottom + 3 < 5 ? f.top = 5 : f.top = 20, z.addClass("ps-in-scrolling")) : f.top = 0, 0 === f.top && 0 === f.left ? d() : c()
                    }
                })
            }

            function u(b, c) {
                function d(a, b) {
                    z.scrollTop(z.scrollTop() - b), z.scrollLeft(z.scrollLeft() - a), l()
                }

                function e(a) {
                    r = !0
                }

                function f(a) {
                    r = !1
                }

                function g(a) {
                    return a.originalEvent.targetTouches ? a.originalEvent.targetTouches[0] : a.originalEvent
                }

                function h(a) {
                    var b = a.originalEvent;
                    return b.targetTouches && 1 === b.targetTouches.length ? !0 : b.pointerType && "mouse" !== b.pointerType && b.pointerType !== b.MSPOINTER_TYPE_MOUSE ? !0 : !1
                }

                function i(a) {
                    if (h(a)) {
                        s = !0;
                        var b = g(a);
                        m.pageX = b.pageX, m.pageY = b.pageY, n = (new Date).getTime(), null !== q && clearInterval(q), a.stopPropagation()
                    }
                }

                function j(a) {
                    if (!r && s && h(a)) {
                        var b = g(a), c = {
                            pageX: b.pageX,
                            pageY: b.pageY
                        }, e = c.pageX - m.pageX, f = c.pageY - m.pageY;
                        d(e, f), m = c;
                        var i = (new Date).getTime(), j = i - n;
                        j > 0 && (o.x = e / j, o.y = f / j, n = i), p(e, f) && (a.stopPropagation(), a.preventDefault())
                    }
                }

                function k(a) {
                    !r && s && (s = !1, clearInterval(q), q = setInterval(function () {
                        return A() ? Math.abs(o.x) < .01 && Math.abs(o.y) < .01 ? void clearInterval(q) : (d(30 * o.x, 30 * o.y), o.x *= .8, void(o.y *= .8)) : void clearInterval(q)
                    }, 10))
                }

                var m = {}, n = 0, o = {}, q = null, r = !1, s = !1;
                b && (a(window).bind(O("touchstart"), e), a(window).bind(O("touchend"), f), z.bind(O("touchstart"), i), z.bind(O("touchmove"), j), z.bind(O("touchend"), k)), c && (window.PointerEvent ? (a(window).bind(O("pointerdown"), e), a(window).bind(O("pointerup"), f), z.bind(O("pointerdown"), i), z.bind(O("pointermove"), j), z.bind(O("pointerup"), k)) : window.MSPointerEvent && (a(window).bind(O("MSPointerDown"), e), a(window).bind(O("MSPointerUp"), f), z.bind(O("MSPointerDown"), i), z.bind(O("MSPointerMove"), j), z.bind(O("MSPointerUp"), k)))
            }

            function v() {
                z.bind(O("scroll"), function (a) {
                    l()
                })
            }

            function w() {
                z.unbind(O()), a(window).unbind(O()), a(P).unbind(O()), z.data("perfect-scrollbar", null), z.data("perfect-scrollbar-update", null), z.data("perfect-scrollbar-destroy", null), R.remove(), Y.remove(), Q.remove(), X.remove(), z = Q = X = R = Y = F = J = B = C = D = E = G = H = S = T = U = K = L = Z = $ = _ = N = O = null
            }

            function x() {
                l(), v(), m(), n(), s(), t(), q(), (ca || da) && u(ca, da), y.useKeyboard && r(), z.data("perfect-scrollbar", z), z.data("perfect-scrollbar-update", l), z.data("perfect-scrollbar-destroy", w)
            }

            var y = a.extend(!0, {}, c), z = a(this), A = function () {
                return !!z
            };
            if ("object" == typeof d ? a.extend(!0, y, d) : g = d, "update" === g)return z.data("perfect-scrollbar-update") && z.data("perfect-scrollbar-update")(), z;
            if ("destroy" === g)return z.data("perfect-scrollbar-destroy") && z.data("perfect-scrollbar-destroy")(), z;
            if (z.data("perfect-scrollbar"))return z.data("perfect-scrollbar");
            z.addClass("ps-container");
            var B, C, D, E, F, G, H, I, J, K, L, M, N = "rtl" === z.css("direction"), O = e(), P = this.ownerDocument || document, Q = a("<div class='ps-scrollbar-x-rail'>").appendTo(z), R = a("<div class='ps-scrollbar-x'>").appendTo(Q), S = b(Q.css("bottom")), T = S === S, U = T ? null : b(Q.css("top")), V = b(Q.css("borderLeftWidth")) + b(Q.css("borderRightWidth")), W = b(Q.css("marginLeft")) + b(Q.css("marginRight")), X = a("<div class='ps-scrollbar-y-rail'>").appendTo(z), Y = a("<div class='ps-scrollbar-y'>").appendTo(X), Z = b(X.css("right")), $ = Z === Z, _ = $ ? null : b(X.css("left")), aa = b(X.css("borderTopWidth")) + b(X.css("borderBottomWidth")), ba = b(X.css("marginTop")) + b(X.css("marginBottom")), ca = "ontouchstart" in window || window.DocumentTouch && document instanceof window.DocumentTouch, da = null !== window.navigator.msMaxTouchPoints;
            return x(), z
        })
    }
}),define("KME/interfaces/AbstractWindow", ["jquery", "jqueryui", "i18next", "hammerjs", "jquery.hammer", "KME/controllers/interface/InterfaceController"], function (a) {
    a.widget("KME.abstractWindow", a.ui.dialog, {
        options: {
            dialogClass: "wtWindow",
            resizable: !1,
            draggable: !1,
            buttonHighlight: null,
            registerOpened: !1,
            content: null,
            group: null
        }, _create: function () {
            this._super(), this.element.disableSelection(), this._createTitle(), this._createContainer(), this._registerEvents(), this.options.group && KME.controllers.ui.registerWindowInGroup(this.options.group, this)
        }, _createContainer: function () {
            this.container = a('<div class="wtWindow-content"></div>'), this.element.append(this.container)
        }, _createTitle: function () {
            var b = this.options.alreadyTranslated ? "<h3>" + this.options.title + "</h3>" : '<h3 data-i18n="interfaces:' + this.options.title + '.title"></h3>';
            this.element.append('<div class="wtWindow-title"><div class="wtWindow-close"></div>' + b + "</div>"), a(this.element).find(".wtWindow-title h3").i18n()
        }, rebuild: function () {
        }, _registerEvents: function () {
            var b = this;
            a(this.element).on("click", ".wtWindow-close", function () {
                b.close()
            })
        }, toggle: function () {
            a(this.element).is(":visible") ? this.close() : this.open()
        }, open: function () {
            this._super(), this.options.buttonHighlight && a(this.options.buttonHighlight).closest(".cell").addClass("active"), this.options.registerOpened && this.options.content && KME.controllers.ui.addOpenedWindowObject(this), this.options.group && KME.controllers.ui.closeWindowsInGroupExcept(this.options.group, this)
        }, close: function () {
            this._super(), this.options.buttonHighlight && a(this.options.buttonHighlight).closest(".cell").removeClass("active"), this.options.registerOpened && this.options.content && KME.controllers.ui.removeOpenedWindowObject(this)
        }, _destroy: function () {
            this._super(), this.element.enableSelection()
        }, _setOptions: function () {
            this._superApply(arguments), this._refresh()
        }, _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/Craft", ["jquery", "jqueryui", "perfect-scrollbar", "jstree", "hammerjs", "jquery.hammer", "KME/interfaces/AbstractWindow"], function (a) {
    a.jstree.defaults.search.show_only_matches = !0, a.jstree.defaults.search.show_only_matches_children = !0, a.jstree.defaults.search.search_leaves_only = !0, a.widget("KME.craft", a.KME.abstractWindow, {
        options: {
            size: 10,
            change: null,
            random: null,
            dialogClass: "wtWindow wtLeftWindow",
            buttonHighlight: ".button.craft",
            scrollTop: 0,
            group: "leftWindows",
            showCraftAmount: !0
        },
        templates: {
            summary: '<div class="summary" id="craftSummary"><div class="image craftImage"></div><h3 class="title"></h3><div class="descTitle"></div><div class="startNeeded"></div><div class="info"></div><div class="controls"><div class="control-amount"></div><div class="control"></div></div>',
            control: '<input type="button" value="" data-i18n="[value]interfaces:craft.craft"/>',
            info: '<div class="info-wrapper"><div class="materials"></div></div>',
            infoImage: '<img height="64" width="64" border="1" />',
            staminaSrc: "interfaces/leatherBelt/craft/craft_slot_stamina.png",
            material: '<div class="material"><img height="45" width="45" border="1" /><div class="number">999</div></div>',
            requirement: "<div></div>",
            craftAmount: '<div class="amount"><input type="button" class="decrease" /><input type="number" name="amount" id="craftAmount" value="1" min="1" max="99" step="1"/><input type="button" class="increase" /></div>'
        },
        _create: function () {
            this._super(), this.element.disableSelection(), this._disableWrongDrop(), this._refresh()
        },
        _disableWrongDrop: function () {
            a(this.element).droppable({
                greedy: !0, drop: function () {
                }
            })
        },
        smallMaterialAdd: function (b, c, d) {
            var e = a(this.templates.material);
            return e.find("img").attr("src", d), e.attr("title", b), e.find(".number").html(c), e
        },
        requirementAdd: function (b) {
            var c = a(this.templates.requirement);
            return c.attr("class", "requirement " + b), c.attr("title", a.t("objects:bonuses." + b + ".title")), c
        },
        changeTreeClasses: function () {
            var b, c, d, e = KME.types.knowledgeTypes.craftList;
            for (b = 0, c = e.length; c > b; b++)d = e[b], this.canCraftError(d.typeName) ? a("#craft_" + d.typeName).addClass("unknown") : a("#craft_" + d.typeName).removeClass("unknown");
            for (e = KME.types.knowledgeTypes.premiumCraftList, b = 0, c = e.length; c > b; b++)d = e[b], this.canCraftError(d.typeName) ? a("#craft_" + d.typeName).addClass("unknown") : a("#craft_" + d.typeName).removeClass("unknown")
        },
        canCraftError: function (a) {
            return KME.mainPlayer.isAdmin() || KME.mainPlayer.content.knowledge.craft[a] ? null : KME.types.knowledgeTypes.craftChecker[a] ? "noKnowledge" : KME.types.knowledgeTypes.premiumCraftChecker[a] ? "noPremiumKnowledge" : null
        },
        _treeExist: function () {
            return a("#craft .tree").length > 0
        },
        _getCraftTitle: function (b) {
            var c = "$t(objects:items." + b.typeName + ")";
            "undefined" != typeof b.craftAmount && (c += " x " + b.craftAmount);
            var d = KME.types.itemTypes[b.typeName];
            if (d.attack && d.attack.damage) {
                var e = 5e3 / (d.attack.delayBefore + d.attack.delay) | 0;
                c += "\n$t(interfaces:item.damage): " + d.attack.damage + " $t(interfaces:item.speed): " + e
            }
            return d.damage && (c += "\n$t(interfaces:item.addDamage): " + d.damage), d.bonuses && "armor" === d.bonuses[0].bonusName && (c += "\n$t(interfaces:item.armor): " + d.bonuses[0].bonusValue, d.bonuses[1] && "slow" === d.bonuses[1].bonusName && (c += " $t(interfaces:item.slow): " + d.bonuses[1].bonusValue)), "undefined" != typeof d.durability && (c += "\n$t(interfaces:item.durability): " + d.durability), a.t(c)
        },
        _buildFilter: function (b, c) {
            for (var d = this, e = a('<select class="tree-select"><option value="none" data-i18n="interfaces:skillFilter">None</option></select>'), f = Object.keys(KME.types.skillTypes.list), g = 0, h = f.length; h > g; g++) {
                var i = f[g];
                KME.types.skillTypes.list[i][c] && e.append(a('<option value="' + i + '" data-i18n="skills:' + i + '.name"></option>'))
            }
            e.i18n(), e.change(function () {
                d._rebuildTree()
            });
            var j = a('<div class="tree--filter"><input type="text" data-i18n="[placeholder]interfaces:nameFilter" /></div>');
            j.on("keyup", "input", function (c) {
                var e = a(this).val();
                return e && e.length > 1 ? b.jstree(!0).search(e) : b.jstree(!0).clear_search(), d.container.find(".jstree-container-ul").perfectScrollbar("update"), c.stopImmediatePropagation(), !1
            });
            var k = j.find("input");
            k.focus(function () {
                KME.game.input.keyboard.enabled = !1
            }).focusout(function () {
                KME.game.input.keyboard.enabled = !0
            }), k.i18n(), this.container.prepend(j), this.container.prepend(e)
        },
        getSkillChance: function (a, b, c) {
            if (a) {
                var d, e = KME.playerSkills.skills[a].level, f = KME.types.skillTypes.xpLevels, g = c ? KME.mainPlayer.content.bonuses[c] : 1e4;
                return g ? g /= 1e4 : g = 1, d = b > e + f.failMaxDelta ? 0 : e >= b ? 1 : 1 - (1 - f.failMinChance) / f.failMaxDelta * (b - e), 1 > d && (d *= g), d > 1 && (d = 1), "undefined" != typeof d ? " (" + Math.floor(100 * d) + "%)" : ""
            }
            return ""
        },
        getSkillColor: function (a, b) {
            var c = 255, d = 127, e = KME.types.skillTypes.xpLevels, f = "black";
            if (a > b + e.failMaxDelta)f = "rgb(" + c + ", 0, 0)"; else if (a === b)f = "rgb(" + c + "," + c + ",0)"; else if (b > a + e.successMaxDelta)f = "rgb( 192, 192, 192)"; else if (a > b) {
                var g = d + Math.floor(d / e.failMaxDelta * (e.failMaxDelta - (a - b)));
                f = "rgb(" + c + "," + g + ",0)"
            } else if (b > a) {
                var h = Math.floor(c / e.successMaxDelta * (e.successMaxDelta - (b - a)));
                f = "rgb(" + h + "," + c + ",0)"
            }
            return f
        },
        skillColorUpdate: function (b) {
            var c = this;
            a(".skill-title").each(function () {
                var d = a(this).data("skill");
                if (!b || b === d) {
                    var e = KME.playerSkills.skills[d].level, f = a(this).data("level");
                    a(this).css("color", c.getSkillColor(f, e))
                }
            })
        },
        _rebuildTree: function () {
            var a = this.container.find(".tree"), b = [], c = this.container.find(".tree-select").val();
            KME.types.skillTypes.list[c] ? this._listItemAdd(b, KME.types.craftTypes.tree, 0, c) : this._treeItemAdd(b, KME.types.craftTypes.tree, 0), a.jstree(!0).settings.core.data = b,
                a.jstree(!0).refresh()
        },
        refreshIfSelect: function () {
            this.container.find(".jstree-clicked").click()
        },
        _buildTree: function () {
            var b = a('<div class="tree"></div>');
            this._buildFilter(b, "craft"), this.container.append(b);
            var c = {
                core: {data: []},
                types: {category: {icon: "hidden"}, recipe: {valid_children: [], icon: "hidden"}},
                plugins: ["types", "search"]
            }, d = c.core.data;
            this._treeItemAdd(d, KME.types.craftTypes.tree, 0), b.jstree(c);
            var e = this;
            b.bind("loaded.jstree", function () {
                console.log("loaded.jstree"), e.changeTreeClasses(), e.container.find(".jstree-container-ul").perfectScrollbar({suppressScrollX: !0})
            }), b.bind("refresh.jstree", function () {
                console.log("refresh.jstree"), e.container.find(".jstree-container-ul").perfectScrollbar({suppressScrollX: !0})
            }), b.bind("before_open.jstree", function () {
                console.log("before_open.jstree"), e.changeTreeClasses()
            }), b.bind("select_node.jstree", function (b, c) {
                if ("undefined" != typeof c.node.original.craft) {
                    e.craftItem = c.node.original.craft, console.log("select_node", e.craftItem.typeName);
                    var d = a(e.templates.info);
                    e.container.find(".title").html(a.t("objects:items." + e.craftItem.typeName)), a.i18n.exists("objects:items." + e.craftItem.typeName + "Description") ? e.container.find(".descTitle").html(a.t("objects:items." + e.craftItem.typeName + "Description")) : e.container.find(".descTitle").html("");
                    var f = a(e.templates.infoImage);
                    f.attr("src", KME.utils.itematlas.getImageSource(e.craftItem.typeName)), f.attr("title", e._getCraftTitle(e.craftItem)), e.container.find("#craftSummary .image").html(f), e.container.find("#craftSummary .image").data("craft", c.node.original.craft);
                    var g;
                    e.craftItem.skill && (g = '<span class="skill-title" data-skill="' + e.craftItem.skill + '" data-level=' + e.craftItem.level + ">" + a.t("skills:" + e.craftItem.skill + ".name") + " " + e.craftItem.level + "</span>"), e.craftItem.toolRequired && (g ? g += ", " : g = "", g += a.t("objects:bonuses." + e.craftItem.toolRequired + ".title")), e.craftItem.nearRequired && (g ? g += ", " : g = "", g += a.t("objects:bonuses." + e.craftItem.nearRequired + ".title")), e.craftItem.staminaDrain && (g ? g += ", " : g = "", g += a.t("interfaces:ofStamina") + " " + e.craftItem.staminaDrain), g || (g = ""), g = "<b>" + a.t("interfaces:startNeeded") + "</b> " + g, e.container.find(".startNeeded").html(g), e.craftItem.skill && e.skillColorUpdate(e.craftItem.skill);
                    var h = e.canCraftError(e.craftItem.typeName);
                    if (h)d.append("<h4>" + a.t("interfaces:craft." + h) + "</h4>"), e.container.find("#craftSummary .control input[type=button]").hide(), e.container.find(".control-amount .amount").hide(); else {
                        var i = [];
                        Object.keys(e.craftItem.resources).forEach(function (b) {
                            i.push(e.smallMaterialAdd(a.t("objects:items." + b), e.craftItem.resources[b].amount, KME.utils.itematlas.getImageSource(b)))
                        }), d.find(".materials").append(i);
                        var j = e.container.find("#craftSummary .control input[type=button]");
                        j.val(a.t("interfaces:craft.craft") + e.getSkillChance(e.craftItem.skill, e.craftItem.level, e.craftItem.toolRequired)), j.show(), e.container.find(".control-amount .amount").show()
                    }
                    e.container.find("#craftSummary .info").html(d), d.i18n(), d.find("[data-i18n]").i18n(), a("#craftAmount").val(1)
                } else delete e.craftItem, e.container.find("#craftSummary .control input[type=button]").hide(), e.container.find(".control-amount .amount").hide(), e.container.find("#craftSummary .info").html(""), e.container.find("#craftSummary .image").html(""), e.container.find(".title").html(""), e.container.find(".descTitle").html(""), e.container.find(".startNeeded").html("")
            }), b.on("select_node.jstree", function (a, b) {
                "category" === b.node.type && (b.node.state.opened ? b.instance.closeNode(b.node) : b.instance.openNode(b.node)), e.container.find(".jstree-container-ul").perfectScrollbar("update")
            })
        },
        _listItemAdd: function (b, c, d, e) {
            var f = this;
            Object.keys(c).forEach(function (g) {
                var h = c[g];
                if (h.hidden !== !0)if ("undefined" == typeof h.children) {
                    if (h.skill === e) {
                        var i = {};
                        "undefined" == typeof h.name ? (i.text = a.t("objects:items." + h.typeName), i.craft = h, i.id = "craft_" + h.typeName) : i.text = a.t("interfaces:craftList." + h.name), i.type = "recipe", b.push(i)
                    }
                } else f._listItemAdd(b, h.children, d + 1, e)
            })
        },
        _treeItemAdd: function (b, c, d) {
            var e = this;
            Object.keys(c).forEach(function (f) {
                var g = c[f];
                if (g.hidden !== !0) {
                    var h = {};
                    "undefined" == typeof g.name ? (h.text = a.t("objects:items." + g.typeName), h.craft = g, h.id = "craft_" + g.typeName) : h.text = a.t("interfaces:craftList." + g.name), h.type = "recipe", b.push(h), "undefined" != typeof g.children && (h.type = "category", h.state = {opened: 1 > d}, h.children = [], e._treeItemAdd(h.children, g.children, d + 1))
                }
            })
        },
        _buildBottom: function () {
            var b = this;
            this.container.append(this.templates.summary);
            var c = a(this.templates.control);
            this.container.find("#craftSummary .control").append(c), c.hide(), c.hammer({
                preventDefault: !0,
                gesture: !0
            }).on("tap", function () {
                b._craft()
            }), c.i18n();
            var d = a(this.templates.craftAmount);
            this.container.find("#craftSummary .control-amount").append(d), this.options.showCraftAmount || d.hide();
            var e = a("#craftAmount");
            a("#craftSummary .control-amount").on("click", "input[type=button]", function () {
                var b = parseInt(e.val(), 10);
                a(this).hasClass("increase") ? 99 > b && ++b : b > 1 && --b, e.val(b)
            }), e.focus(function () {
                KME.game.input.keyboard.enabled = !1
            }).focusout(function () {
                KME.game.input.keyboard.enabled = !0
            });
            var f = this.container.find("#craftSummary .craftImage");
            f.draggable({
                helper: "clone",
                opacity: .6,
                zIndex: 1e4,
                scroll: !0,
                scrollSensitivity: 100,
                appendTo: "body",
                start: function (b, c) {
                    a(this).attr("data-dragging", "1"), a(this).data("ui", c)
                },
                stop: function () {
                    a(this).attr("data-dragging", "0")
                }
            }), f.disableSelection()
        },
        _craft: function () {
            if ("undefined" != typeof this.craftItem) {
                var b = a("#craftAmount"), c = parseInt(b.val(), 10);
                1 > c && (c = 1), KME.mainPlayer.craftItem(this.craftItem.typeName, c)
            }
        },
        _refresh: function () {
            this._trigger("change")
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        },
        toggle: function () {
            a(this.element).is(":visible") ? this.close() : this.open()
        },
        open: function () {
            this._super(), a(this.element).parent().css("top", "0px"), this._treeExist() ? this.changeTreeClasses() : (this._buildTree(), this._buildBottom()), this.skillColorUpdate(), a(this.element).find(".jstree-container-ul").scrollTop(this.options.scrollTop), a("#craftAmount").val(1)
        },
        close: function () {
            this.options.scrollTop = a(this.element).find(".jstree-container-ul").scrollTop(), this._super()
        }
    })
}),define("KME/interfaces/Build", ["jquery", "jstree", "jqueryui", "perfect-scrollbar", "KME/interfaces/Craft", "hammerjs", "jquery.hammer"], function (a) {
    a.widget("KME.build", a.KME.craft, {
        options: {
            dialogClass: "wtWindow wtLeftWindow",
            buttonHighlight: ".button.build",
            showCraftAmount: !1
        },
        templates: {control: '<input type="button" data-i18n="[value]interfaces:build.build" />'},
        changeTreeClasses: function () {
            for (var b, c = KME.types.knowledgeTypes.buildList, d = 0, e = c.length; e > d; d++)b = c[d], this.canBuildError(b.typeName) ? a("#build_" + b.typeName).addClass("unknown") : a("#build_" + b.typeName).removeClass("unknown");
            for (c = KME.types.knowledgeTypes.premiumBuildList, d = 0, e = c.length; e > d; d++)b = c[d], this.canBuildError(b.typeName) ? a("#build_" + b.typeName).addClass("unknown") : a("#build_" + b.typeName).removeClass("unknown")
        },
        canBuildError: function (a) {
            return KME.mainPlayer.isAdmin() || KME.mainPlayer.content.knowledge.build[a] ? null : KME.types.knowledgeTypes.buildChecker[a] ? "noKnowledge" : KME.types.knowledgeTypes.premiumBuildChecker[a] ? "noPremiumKnowledge" : null
        },
        _treeExist: function () {
            return a("#build .tree").length > 0
        },
        _getBuildTitle: function (b) {
            var c = "$t(objects:world." + b.typeName + ")", d = KME.types.worldTypes[b.typeName];
            return d.hitPoints && (c += "\n$t(interfaces:structure.hitPoints): " + d.hitPoints, d.adsorb && (c += " $t(interfaces:structure.adsorb): " + d.adsorb)), d.container && d.container.slots && (c += "\n$t(interfaces:structure.slots): " + d.container.slots), a.t(c)
        },
        _rebuildTree: function () {
            var a = this.container.find(".tree"), b = [], c = this.container.find(".tree-select").val();
            KME.types.skillTypes.list[c] ? this._listItemAdd(b, KME.types.buildTypes.tree, 0, c) : this._treeItemAdd(b, KME.types.buildTypes.tree, 0), a.jstree(!0).settings.core.data = b, a.jstree(!0).refresh()
        },
        _buildTree: function () {
            var b = a('<div class="tree"></div>');
            this._buildFilter(b, "build"), this.container.append(b);
            var c = {
                core: {data: []},
                types: {category: {icon: "hidden"}, recipe: {valid_children: [], icon: "hidden"}},
                plugins: ["types", "search"]
            }, d = c.core.data;
            this._treeItemAdd(d, KME.types.buildTypes.tree, 0), b.jstree(c);
            var e = this;
            b.bind("loaded.jstree", function () {
                e.changeTreeClasses(), e.container.find(".jstree-container-ul").perfectScrollbar({suppressScrollX: !0})
            }), b.bind("refresh.jstree", function () {
                e.container.find(".jstree-container-ul").perfectScrollbar({suppressScrollX: !0})
            }), b.bind("before_open.jstree", function () {
                e.changeTreeClasses()
            }), b.bind("select_node.jstree", function (b, c) {
                if ("undefined" != typeof c.node.original.build) {
                    e.buildObject = c.node.original.build;
                    var d = a(e.templates.info);
                    e.container.find(".title").html(a.t("objects:world." + e.buildObject.typeName)), a.i18n.exists("objects:world." + e.buildObject.typeName + "Description") ? e.container.find(".descTitle").html(a.t("objects:world." + e.buildObject.typeName + "Description")) : e.container.find(".descTitle").html("");
                    var f = a(e.templates.infoImage);
                    f.attr("src", e.buildObject.imageSource), f.attr("title", e._getBuildTitle(e.buildObject)), e.container.find("#craftSummary .image").html(f), e.container.find("#craftSummary .image").data("build", c.node.original.build);
                    var g;
                    e.buildObject.skill && (g = '<span class="skill-title" data-skill="' + e.buildObject.skill + '" data-level=' + e.buildObject.level + ">" + a.t("skills:" + e.buildObject.skill + ".name") + " " + e.buildObject.level + "</span>"), e.buildObject.toolRequired && (g ? g += ", " : g = "", g += a.t("objects:bonuses." + e.buildObject.toolRequired + ".title")), e.buildObject.staminaDrain && (g ? g += ", " : g = "", g += a.t("interfaces:ofStamina") + " " + e.buildObject.staminaDrain), g || (g = ""), g = "<b>" + a.t("interfaces:startNeeded") + "</b> " + g, e.container.find(".startNeeded").html(g), e.buildObject.skill && e.skillColorUpdate(e.buildObject.skill);
                    var h = e.canBuildError(e.buildObject.typeName);
                    if (h)d.append("<h4>" + a.t("interfaces:build." + h) + "</h4>"), e.container.find("#craftSummary .control input[type=button]").hide(); else {
                        var i = [];
                        e.buildObject.resources && Object.keys(e.buildObject.resources).forEach(function (b) {
                            i.push(e.smallMaterialAdd(a.t("objects:items." + b), e.buildObject.resources[b].amount, KME.utils.itematlas.getImageSource(b)))
                        }), d.find(".materials").append(i);
                        var j = e.container.find("#craftSummary .control input[type=button]");
                        j.val(a.t("interfaces:build.build") + e.getSkillChance(e.buildObject.skill, e.buildObject.level, e.buildObject.toolRequired)), j.show()
                    }
                    e.container.find("#craftSummary .info").html(d), d.i18n(), d.find("[data-i18n]").i18n()
                } else delete e.buildObject, e.container.find("#craftSummary .control input[type=button]").hide(), e.container.find("#craftSummary .info").html(""), e.container.find("#craftSummary .image").html(""), e.container.find(".title").html(""), e.container.find(".descTitle").html(""), e.container.find(".startNeeded").html("")
            }), b.on("select_node.jstree", function (a, b) {
                "category" === b.node.type && (b.node.state.opened ? b.instance.closeNode(b.node) : b.instance.openNode(b.node), e.container.find(".jstree-container-ul").perfectScrollbar("update"))
            })
        },
        _listItemAdd: function (b, c, d, e) {
            var f = this;
            Object.keys(c).forEach(function (g) {
                var h = c[g];
                if ("undefined" == typeof h.hidden)if ("undefined" == typeof h.children) {
                    if (h.skill === e) {
                        var i = {};
                        "undefined" == typeof h.name ? (i.text = a.t("objects:world." + h.typeName), i.build = h, i.id = "build_" + h.typeName) : i.text = a.t("interfaces:buildList." + h.name), i.type = "recipe", b.push(i)
                    }
                } else f._listItemAdd(b, h.children, d + 1, e)
            })
        },
        _treeItemAdd: function (b, c, d) {
            var e = this;
            Object.keys(c).forEach(function (f) {
                var g = c[f];
                if ("undefined" == typeof g.hidden) {
                    var h = {};
                    "undefined" == typeof g.name ? (h.text = a.t("objects:world." + g.typeName), h.build = g, h.id = "build_" + g.typeName) : h.text = a.t("interfaces:buildList." + g.name), h.type = "recipe", b.push(h), "undefined" != typeof g.children && (h.type = "category", h.state = {opened: 1 > d}, h.children = [], e._treeItemAdd(h.children, g.children, d + 1))
                }
            })
        },
        _buildBottom: function () {
            var b = this;
            this.container.append(this.templates.summary);
            var c = a(this.templates.control);
            this.container.find("#craftSummary .control").append(c), c.hide(), c.hammer({
                preventDefault: !0,
                gesture: !0
            }).on("tap", function () {
                b._build()
            }), c.i18n();
            var d = this.container.find("#craftSummary .craftImage");
            d.draggable({
                helper: "clone",
                opacity: .6,
                zIndex: 1e4,
                scroll: !0,
                scrollSensitivity: 100,
                appendTo: "body",
                start: function (b, c) {
                    a(this).attr("data-dragging", "1"), a(this).data("ui", c)
                },
                stop: function () {
                    a(this).attr("data-dragging", "0")
                }
            }), d.disableSelection()
        },
        _build: function () {
            if ("undefined" != typeof this.buildObject) {
                var a = this;
                KME.mainPlayer.build(this.buildObject, !0, function (b) {
                    b && a.toggle()
                })
            }
        }
    })
}),define("KME/interfaces/ResizeableWindow", ["jquery", "jqueryui", "./AbstractWindow", "i18next", "hammerjs", "jquery.hammer", "perfect-scrollbar"], function (a) {
    a.widget("KME.resizeableWindow", a.KME.abstractWindow, {
        options: {dialogClass: "wtWindow wtContainer"},
        _create: function () {
            this._super(), this._container = this.container, this._createSkin(), this.__makeDraggable()
        },
        _createSkin: function () {
            a(this.element).css("min-height", "135px"), a(this.element).append('<div class="wtContainer-top"></div><div class="wtContainer-bot"></div><div class="wtContainer-second"></div>'), a(this.element).append('<div class="wtContainer-left"><div class="wtContainer-left-bot"><div class="wtContainer-left-back"></div></div></div>'), a(this.element).append('<div class="wtContainer-right"><div class="wtContainer-right-bot"><div class="wtContainer-right-back"></div></div></div>'), a(this.container).append('<div class="wtContainer-wrapper"><div class="wtContainer-content"></div></div>'), this.container = a(this.element).find(".wtContainer-content"), this.container.perfectScrollbar({
                suppressScrollX: !0,
                maxScrollbarLength: 200
            })
        },
        open: function () {
            var a = this._super();
            return this.container.scrollTop(1), a
        },
        __makeDraggable: function () {
            this.uiDialog.draggable({handle: ".wtWindow-title"})
        }
    })
}),define("KME/interfaces/Container", ["jquery", "jqueryui", "./ResizeableWindow", "KME/controllers/interface/UIItemController"], function (a) {
    a.widget("KME.container", a.KME.resizeableWindow, {
        options: {content: null, size: 20, registerOpened: !0},
        _create: function () {
            this._super(), this._buildCells(), this.rebuild(this.options.content), a(this.container).addClass("container"), this.options.size <= 5 && a(this.element).find(".wtContainer-wrapper").css("padding-bottom", 0)
        },
        open: function () {
            return this._super()
        },
        close: function () {
            this._super(), this.destroy(), a(this.container).remove(), a(this.element).remove()
        },
        _buildCells: function () {
            for (var b = a('<div class="items"></div>'), c = 0; c < this.options.size; ++c) {
                var d = a('<div class="cell"></div>');
                a(d).data("container", this.options.content), a(d).data("pocket", "container"), b.append(d), KME.controllers.ui.item.registrerDroppable(this.options.content.id, d, c, function () {
                })
            }
            this.container.append(b)
        },
        addItem: function (b, c, d, e, f) {
            var g = this;
            KME.controllers.ui.item.prepareItemElement(b, function (d) {
                c || (c = a(g.container.find(".items .cell")[b.position])), c.append(d), a(d).data("fromId", e.id), a(d).data("cell", c), a(d).data("pocket", f)
            }, d)
        },
        updateContent: function (a) {
            this.options.content.update(a), this.rebuild(this.options.content)
        },
        rebuild: function (b) {
            var c = this;
            a(this.container).hasClass("container_" + b.id) || a(this.container).addClass("container_" + b.id), a(this.container).data("content", b), a(this.container).find("div.itemImage").remove(), Object.keys(b.container.slots).forEach(function (a) {
                var d = b.container.slots[a];
                d && c.addItem(d, null, !1, b, "container")
            }), this.container.find(".cell").data("fromId", b.id)
        }
    })
}),define("KME/interfaces/Inventory", ["jquery", "jqueryui", "perfect-scrollbar", "KME/interfaces/AbstractWindow", "KME/controllers/interface/UIItemController"], function (a) {
    a.widget("KME.inventory", a.KME.abstractWindow, {
        options: {
            size: 30,
            dialogClass: "wtWindow wtInventory",
            buttonHighlight: ".button.inventory,.button.open-inventory",
            change: null,
            random: null,
            content: null,
            autocreate: {cells: !1}
        }, _create: function () {
            this._super(), a(this.element).addClass("interfaceContainer"), this._disableWrongDrop(), this._buildWear(), this.options.autocreate.cells && this._buildCells(), a(this.element).data("widget", this)
        }, _disableWrongDrop: function () {
            a(this.element).droppable({
                greedy: !0, drop: function () {
                }
            })
        }, _buildWear: function () {
            var b = a('<div id="wear"></div>');
            ["head", "leftHand", "rightHand", "body", "legs", "foots", "hands", "cloak"].forEach(function (c) {
                var d = a('<div class="cell ' + c + '"></div>');
                b.append(d), a(d).data("pocket", "wear"), KME.controllers.ui.item.registrerDroppable("wear", d, c, function () {
                })
            }), this.container.append(b)
        }, _buildCells: function () {
            for (var b = a('<div class="items"></div>'), c = 0; c < this.options.size; ++c) {
                var d = a('<div class="cell"></div>');
                a(d).data("pocket", "inventory"), b.append(d), KME.controllers.ui.item.registrerDroppable("inventory", d, c, function () {
                })
            }
            this.container.append(b), b.perfectScrollbar({suppressScrollX: !0, maxScrollbarLength: 200})
        }, addItem: function (b, c, d, e, f) {
            var g = this;
            c || (c = a(g.container.find(".items .cell")[b.position]));
            var h = c.find("div.itemImage");
            if (1 === h.length && h.data("item")) {
                var i = h.data("item");
                if (i === b) {
                    h.removeData("old"), h.find("img").attr("title", b.getTitle());
                    var j = h.find("span");
                    b.amount && b.amount != j.html() && j.html(b.amount);
                    var k = h.find("div");
                    return void(k && b.durability && k.attr("style", KME.controllers.ui.item.getDurabilityStyle(b)))
                }
                h.remove()
            }
            KME.controllers.ui.item.prepareItemElement(b, function (b) {
                a(b).data("fromId", e.id), c.append(b), a(b).data("cell", c), a(b).data("pocket", f)
            }, d, "inventory" === f)
        }, rebuild: function (b) {
            var c = this;
            this.options.content = b, a(this.container).hasClass("container_" + b.id) || a(this.container).addClass("container_" + b.id), a(this.element).data("content", b), a(this.container).find("div.itemImage").data("old", "old"), this._prepareCells(), Object.keys(b.inventory.slots).forEach(function (a) {
                var d = b.inventory.slots[a];
                d && c.addItem(d, null, !1, b, "inventory")
            }), Object.keys(b.wear.slots).forEach(function (d) {
                var e = b.wear.slots[d];
                if (e) {
                    var f = a(c.container).find("#wear .cell." + d);
                    c.addItem(e, f, !1, b, "wear")
                }
            }), a(this.container).find("div.itemImage:data(old)").remove(), a(this.container).find(".cell").data("fromId", b.id)
        }, _prepareCells: function () {
            if (0 === a(this.container).find(".items").length) {
                var b = KME.types.worldTypes[this.options.content.typeName];
                this.options.size = b.inventory.slots, this._buildCells()
            }
        }, open: function () {
            this._prepareCells(), this._super(), a(this.element).parent().css("top", "0px")
        }, close: function () {
            this._super(), a(this.container).find("div.itemImage.opened").popover("hide")
        }
    })
}),define("KME/interfaces/Tool", ["jquery", "jqueryui", "./ResizeableWindow", "KME/controllers/interface/UIItemController"], function (a) {
    a.widget("KME.tool", a.KME.resizeableWindow, {
        options: {
            dialogClass: "wtWindow wtContainer wtTool",
            content: null,
            sources: 3,
            resources: !1,
            products: 5,
            registerOpened: !0
        }, $products: null, _create: function () {
            this._super(), this._buildSources(), this.options.resources && this._buildResources(), this._buildProducts(), this.rebuild(this.options.content), a(this.container).addClass("container"), a(this.container).addClass("tool");
            var b = a(this.element).find(".wtContainer-second");
            this.options.resources ? b.addClass("full") : b.addClass("short")
        }, open: function () {
            return this._super()
        }, close: function () {
            this._super(), this.destroy(), a(this.container).remove(), a(this.element).remove()
        }, _buildProducts: function () {
            for (var b = a('<div class="products"></div>'), c = 0; c < this.options.products; ++c) {
                var d = a('<div class="cell"></div>');
                a(d).data("pocket", "products"), b.append(d), KME.controllers.ui.item.registrerDroppable(this.options.content.id, d, c, function () {
                })
            }
            this.container.append(b), this.$products = b
        }, _buildSources: function () {
            var b = a('<div class="centerWrapper"></div>'), c = a('<h2 data-i18n="interfaces:tool.sources"></h2>');
            b.append(c), c.i18n(), this.container.append(b), b = a('<div class="centerWrapper"></div>');
            for (var d = a('<div class="sources"></div>'), e = 0; e < this.options.sources; ++e) {
                var f = a('<div class="cell"></div>');
                a(f).data("pocket", "sources"), d.append(f), KME.controllers.ui.item.registrerDroppable(this.options.content.id, f, e, function () {
                })
            }
            b.append(d), this.container.append(b)
        }, _buildResources: function () {
            var b = a('<div class="centerWrapper"></div>'), c = a('<h2 data-i18n="interfaces:tool.resources"></h2>');
            b.append(c), c.i18n(), this.container.append(b), b = a('<div class="centerWrapper"></div>');
            for (var d = a('<div class="resources"></div>'), e = 0; e < this.options.resources; ++e) {
                var f = a('<div class="cell"></div>');
                a(f).data("pocket", "resources"), d.append(f), KME.controllers.ui.item.registrerDroppable(this.options.content.id, f, e, function () {
                })
            }
            b.append(d), this.container.append(b)
        }, _buildControls: function () {
            this.container.find(".centerWrapper.control").remove();
            var b = this, c = KME.utils.ActionController.getToolAction(this.options.content.worldObject);
            if (c) {
                var d = a('<div class="centerWrapper control"></div>'), e = a('<input type="button" class="tool-control" data-i18n="[value]interfaces:worldMenu.' + c.title + '"/>');
                d.append(e), e.hammer({preventDefault: !0, gesture: !0}).on("tap", function () {
                    b._performAction(c)
                }), e.i18n(), d.insertBefore(this.$products)
            }
        }, _performAction: function (a) {
            this.options.content.worldObject.onUse(a.actionName)
        }, addItem: function (b, c, d, e, f) {
            var g = this;
            KME.controllers.ui.item.prepareItemElement(b, function (d) {
                c || (c = a(g.element.find("." + f + " .cell")[b.position])), c.append(d), a(d).data("fromId", e.id), a(d).data("cell", c), a(d).data("pocket", f)
            }, d)
        }, updateContent: function (a) {
            this.options.content.update(a), this.rebuild(this.options.content)
        }, rebuild: function (b) {
            a(this.container).hasClass("container_" + b.id) || (a(this.container).addClass("container_" + b.id), a(this.container).data("content", b));
            var c = this;
            a(this.container).find("div.itemImage").remove(), Object.keys(b.sources.slots).forEach(function (a) {
                var d = b.sources.slots[a];
                d && c.addItem(d, null, !1, b, "sources")
            }), this.options.resources && Object.keys(b.resources.slots).forEach(function (a) {
                var d = b.resources.slots[a];
                d && c.addItem(d, null, !1, b, "resources")
            }), Object.keys(b.products.slots).forEach(function (a) {
                var d = b.products.slots[a];
                d && c.addItem(d, null, !1, b, "products")
            }), a(this.container).find(".cell").data("fromId", b.id), this.options.resources && this._buildControls()
        }
    })
}),define("KME/interfaces/Toolbar", ["jquery", "jqueryui", "hammerjs", "jquery.hammer", "KME/controllers/data/DataController", "KME/controllers/interface/InterfaceController"], function (a) {
    a.widget("KME.toolbar", {
        options: {size: 10, change: null, random: null, content: null, cache: {}},
        $wrapper: null,
        $keysWrapper: null,
        _keys: [],
        _create: function () {
            this.element.disableSelection(), this._disableWrongDrop(), this.$achievements = a('<div class="achievements"></div>'), this.element.append(this.$achievements), this.$wrapper = a('<div class="wrapper"></div>'), this.$achievements.append(this.$wrapper), this.$keysWrapper = a('<div class="keys"></div>'), this.$achievements.append(this.$keysWrapper), this._buildCells(), this._buildKeys(), this._registerEvents(), this._refresh()
        },
        _disableWrongDrop: function () {
            a(this.element).droppable({
                greedy: !0, drop: function () {
                }
            })
        },
        _buildCells: function () {
            for (var b = 0; b < this.options.size; ++b) {
                var c = a('<div class="cell"></div>');
                c.data("slot", b), this.$wrapper.append(c)
            }
        },
        _buildKeys: function () {
            for (var b = 0; b < this.options.size; ++b) {
                var c = a('<div class="key key_' + b + '"><span></span></div>');
                this.$keysWrapper.append(c), this._keys.push(c)
            }
        },
        rebuild: function (b) {
            this.options.content = b;
            var c, d, e, f;
            this.$wrapper.find("div.button").remove(), this.$keysWrapper.find(".in-hand").remove(), this.$wrapper.find(".in-hand").removeClass("in-hand");
            for (var g = this.$wrapper.find("div.cell"), h = 0; h < b.toolbar.actions.length; ++h)if (e = null, c = b.toolbar.actions[h]) {
                if (d = g[c.position], c.itemType || c.itemId)if (f = b.getItemById(c.itemId), f || (f = b.getFirstItemByType(c.itemType)), f) {
                    b.wear.slots.rightHand && b.wear.slots.rightHand.typeName == f.typeName && (f = b.wear.slots.rightHand), e = KME.controllers.ui.actions.createItemButton(f, c.name), b.wear.slots.rightHand && b.wear.slots.rightHand.typeName == f.typeName && (this._markItemInHand(c.position), a(d).addClass("in-hand"));
                    var i = b.count(f, !0);
                    i && e.append("<span>" + i + "</span>"), "undefined" != typeof f.durability && e.append("<div class='dur-bar' style='" + KME.controllers.ui.item.getDurabilityStyle(f) + "'></div>")
                } else e = KME.controllers.ui.actions.createItemButton({typeName: c.itemType}, c.name), e.css("opacity", "0.6"), e.addClass("non-exists"); else e = c.craftType ? KME.controllers.ui.actions.createCraftButton(c) : c.buildType ? KME.controllers.ui.actions.createBuildButton(c) : KME.controllers.ui.actions.createSimpleButton(c);
                e && (e.data("action", c), a(d).append(e))
            }
            this._prepareDroppable()
        },
        autocreate: function (a) {
            var b = this.$wrapper.find(".cell:empty");
            if (0 !== b.length) {
                var c = a.type.actions;
                if (c && (c.eat || c.bandage || c.dress && a.type.actions.dress.target && ["leftHand", "rightHand", "bothHands"].indexOf(a.type.actions.dress.target) >= 0)) {
                    var d = this.options.content.countItemsByType(a.typeName, !0);
                    if (d > 1)return;
                    for (var e, f, g = this.options.content.toolbar.actions, h = 0; h < g.length; ++h) {
                        if (e = g[h], e.itemType && a.typeName === e.itemType)return;
                        if (e.itemId && (f = this.options.content.getItemById(e.itemId), f && f.typeName === a.typeName))return
                    }
                    this._createNewActionFromItem(a, b[0])
                }
            }
        },
        fireKey: function (b) {
            var c = this.$wrapper.find("div.cell")[b];
            if (c) {
                var d = a(c).find("div.button");
                KME.controllers.ui.actions.proceedActionEvent(d)
            }
        },
        _markItemInHand: function (a) {
            this._keys[a].append('<div class="in-hand"></div>')
        },
        _registerEvents: function () {
            KME.controllers.ui.actions.registerHandlers(a(this.element)), this._prepareDroppable()
        },
        _prepareDroppable: function () {
            var b = this;
            this.$wrapper.find(".cell").droppable({
                tolerance: "pointer",
                greedy: !0,
                accept: ".itemImage, .button[action], .craftImage",
                drop: function (c, d) {
                    var e = d.draggable.closest("div[id]");
                    if ("toolbar" === e.attr("id")) {
                        if (a(c.target).is(":empty")) {
                            var f = d.draggable.data("action");
                            b._moveAction(f, this), a(d.helper).remove()
                        }
                    } else d.draggable.data("item") ? ["inventory", "wear"].indexOf(e.attr("id")) >= 0 && b._createNewActionFromItem(d.draggable.data("item"), this) : d.draggable.data("craft") ? (b._createNewActionFromCraft(d.draggable.data("craft").typeName, this), a(d.helper).remove()) : d.draggable.data("build") ? (b._createNewActionFromBuild(d.draggable.data("build").typeName, this), a(d.helper).remove()) : (b._createNewActionFromSimple(d.draggable.attr("action"), this), a(d.helper).remove())
                }
            })
        },
        _moveAction: function (b, c) {
            KME.controllers.network.actions.action.moveAction(b, a.inArray(c, this.$wrapper.find("div.cell")))
        },
        _createNewActionFromCraft: function (b, c) {
            var d = {name: "craft", position: a.inArray(c, this.$wrapper.find("div.cell")), craftType: b};
            KME.controllers.network.actions.action.storeAction(d)
        },
        _createNewActionFromBuild: function (b, c) {
            var d = {name: "build", position: a.inArray(c, this.$wrapper.find("div.cell")), buildType: b};
            KME.controllers.network.actions.action.storeAction(d)
        },
        _createNewActionFromSimple: function (b, c) {
            var d = {name: b, position: a.inArray(c, this.$wrapper.find("div.cell"))};
            KME.controllers.network.actions.action.storeAction(d)
        },
        _createNewActionFromItem: function (b, c) {
            var d = KME.types.itemTypes[b.typeName];
            if (d.actions) {
                var e = {
                    name: "toolbar",
                    itemId: b.id,
                    itemType: b.typeName,
                    position: a.inArray(c, this.$wrapper.find("div.cell"))
                };
                KME.controllers.network.actions.action.storeAction(e)
            }
        },
        _refresh: function () {
            this._trigger("change")
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/Topbar", ["jquery", "jqueryui"], function (a) {
    a.widget("KME.topbar", {
        options: {size: 8, change: null, random: null},
        _playerContent: null,
        elements: {$wrapper: null},
        _create: function () {
            this.element.disableSelection(), this._buildBars(), this._refresh()
        },
        _buildBars: function () {
            this.elements.$wrapper = a('<div class="wrapper"></div>'), a(this.element).append(this.elements.$wrapper), this.elements.$wrapper.append('<div id="healthBar" class="bar"><div class="barBorder"></div><div class="barWrapper"><div class="barContent"><div class="slider"></div></div></div></div>'), this.elements.$wrapper.append('<div id="staminaBar" class="bar"><div class="barBorder"></div><div class="barWrapper"><div class="barContent"><div class="slider"></div></div></div></div>'), this.elements.$wrapper.append('<div id="foodBar" class="bar"><div class="barBorder"></div><div class="barWrapper"><div class="barContent"><div class="slider"></div></div></div></div>'), this.elements.$wrapper.append('<div id="infoBlock"></div>'), this.elements.healthBar = {
                $content: this.elements.$wrapper.find("#healthBar .barContent"),
                $border: this.elements.$wrapper.find("#healthBar .barBorder")
            }, this.elements.staminaBar = {
                $content: this.elements.$wrapper.find("#staminaBar .barContent"),
                $border: this.elements.$wrapper.find("#staminaBar .barBorder")
            }, this.elements.foodBar = {
                $content: this.elements.$wrapper.find("#foodBar .barContent"),
                $border: this.elements.$wrapper.find("#foodBar .barBorder")
            }
        },
        showInfo: function (a) {
            this.elements.$wrapper.find("#infoBlock").html(a)
        },
        rebuild: function (a) {
            this._playerContent = a;
            var b = 100 - a.health, c = 100 - a.stamina, d = 100 - a.food;
            this.elements.healthBar.$content.width(b + "%"), this.elements.healthBar.$border.html(a.health), this.elements.staminaBar.$content.width(c + "%"), this.elements.staminaBar.$border.html(a.stamina), this.elements.foodBar.$content.width(d + "%")
        },
        _refresh: function () {
            this._trigger("change")
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/BonusesBar", ["jquery", "jqueryui", "KME/controllers/interface/DaylightController"], function (a) {
    var b = 1e4;
    a.widget("KME.bonusesBar", {
        options: {change: null, random: null, cache: {}},
        _playerContent: null,
        templates: {bonus: '<div class="cell %1 %3" data-i18n="[title]objects:bonuses.%1.description"><span>%2</span></div>'},
        _create: function () {
            this.element.disableSelection(), this._refresh()
        },
        _getValue: function (a, c) {
            var d, e = KME.types.bonusTypes[c];
            return "percent" === e.show.valueType ? (d = Math.round(100 * a[c] / b), d > 999 && (d = Math.floor(d / 1e3) + "k"), d += "%") : (d = Math.round(a[c] / b), d > 999 && (d = (d / 1e3).toFixed(1) + "k")), d
        },
        _updateOrCreateElement: function (b, c, d) {
            var e, f = this, g = f._getValue(d.bonuses, b);
            if (this.options.cache[b]) {
                e = this.options.cache[b];
                var h = e.find("span");
                h.html() != g && h.html(g)
            } else e = f.templates.bonus.replace(/%1/g, b), e = e.replace("%2", g), e = e.replace("%3", c.show.negative ? "penalty" : "bonus"), e = a(e), e.i18n(), a(f.element).append(e), this.options.cache[b] = e;
            return e
        },
        rebuild: function (a) {
            this._playerContent = a;
            var b, c = this;
            KME.controllers.ui.daylight.setPlayerHaveTorch(!1);
            var d = Object.keys(this.options.cache);
            Object.keys(a.bonuses).forEach(function (e) {
                b = KME.types.bonusTypes[e], c._updateOrCreateElement(e, b, a);
                var f = d.indexOf(e);
                f >= 0 && d.splice(f, 1), "light" === e && KME.controllers.ui.daylight.setPlayerHaveTorch(!0)
            });
            for (var e = 0; e < d.length; ++e)this.options.cache[d[e]] && (this.options.cache[d[e]].remove(), delete this.options.cache[d[e]])
        },
        _refresh: function () {
            this._trigger("change")
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/EffectsBar", ["jquery", "jqueryui", "./BonusesBar"], function (a) {
    a.widget("KME.effectsBar", a.KME.bonusesBar, {
        templates: {effect: '<div class="cell %1 %3" data-i18n="[title]objects:effects.%1.description"><span>%2</span></div>'},
        $daylightContainer: null,
        _create: function () {
            this._super(), this.$daylightContainer = a("#daylight-effect")
        },
        _effectTimerValue: function (b) {
            var c, d = Math.floor(b / 1e3), e = Math.floor(d / 60);
            if (0 === e)c = d + a.t("interfaces:effectTimer.seconds"); else {
                var f = Math.floor(e / 60);
                if (0 === f)c = e + a.t("interfaces:effectTimer.minutes"); else {
                    var g = Math.floor(f / 24);
                    if (0 === g)c = f + a.t("interfaces:effectTimer.hours"); else {
                        var h = Math.floor(g / 30);
                        if (3 > h)c = Math.round(f / 24) + a.t("interfaces:effectTimer.days"); else {
                            var i = Math.floor(g / 365);
                            c = 0 === i ? h + a.t("interfaces:effectTimer.months") : i + a.t("interfaces:effectTimer.years")
                        }
                    }
                }
            }
            return c
        },
        _updateOrCreateElement: function (b, c) {
            var d, e = c.effects[b], f = e;
            if (a.isNumeric(e) && (f = this._effectTimerValue(e)), this.options.cache[b]) {
                d = this.options.cache[b];
                var g = d.find("span");
                g.html() != f && g.html(f)
            } else d = this.templates.effect.replace(/%1/g, b), d = d.replace("%3", a.isNumeric(e) ? "penalty timer" : ""), d = d.replace("%2", f), d = a(d), d.i18n(), a(this.element).append(d), this.options.cache[b] = d;
            return d
        },
        rebuild: function (a) {
            this._playerContent = a;
            var b = this, c = Object.keys(this.options.cache);
            Object.keys(a.effects).forEach(function (d) {
                b._updateOrCreateElement(d, a);
                var e = c.indexOf(d);
                e >= 0 && c.splice(e, 1)
            }), this._setScreenEffects(a.effects);
            for (var d = 0; d < c.length; ++d)this.options.cache[c[d]] && (this.options.cache[c[d]].remove(), delete this.options.cache[c[d]])
        },
        _setScreenEffects: function (a) {
            this.$daylightContainer && (a.admin ? this.$daylightContainer.hide() : this.$daylightContainer.show())
        }
    })
}),define("KME/interfaces/MenuBar", ["jquery", "jqueryui", "i18next", "hammerjs", "jquery.hammer"], function (a) {
    a.widget("KME.menuBar", {
        options: {
            change: null,
            random: null,
            buttons: {
                showcase: {img: "", title: "GameShop", cssClass: "show-shop", key: ""},
                exit: {img: "", title: "GameExit", cssClass: "show-exit", key: "Esc"},
                chat: {img: "", title: "ShowChat", cssClass: "show-chat", key: "Ent"},
                actions: {img: "", title: "ShowActions", cssClass: "show-actions", key: "A"},
                inventory: {img: "", title: "OpenInventory", cssClass: "open-inventory", key: "I"}
            }
        },
        templates: {button: '<div class="cell"><div class="button %3" action="%1" data-i18n="[title]interfaces:menubar.%2"></div><div class="key">%4</div></div>'},
        _create: function () {
            this.element.disableSelection(), this._refresh(), this._preparePaymentToken(), this._buildTheme(), this._buildButtons(), this._registerEvents()
        },
        _preparePaymentToken: function () {
            var a = this;
            KME.controllers.network.requests.requestPaymentToken(function (b) {
                a.paymentToken = b
            })
        },
        _buildTheme: function () {
            this.element.append('<div class="leather-bottom"><div class="leather-top"><div class="leather-bg"></div></div></div>')
        },
        _buildButtons: function () {
            var b = this, c = a(this.element).find(".leather-bg");
            Object.keys(this.options.buttons).forEach(function (d) {
                var e = b.options.buttons[d], f = b.templates.button.replace(/%1/g, d);
                f = f.replace(/%2/g, e.title), f = f.replace(/%3/g, e.cssClass), f = f.replace(/%4/g, e.key), f = a(f), f.i18n(), f.find(".button[action]").hammer({
                    preventDefault: !0,
                    gesture: !0
                }), c.append(f)
            }), c.find(".show-chat").html('<span id="msgAmount">0</span>'), c.find("#msgAmount").hide()
        },
        chatAddAmount: function () {
            var b = a(this.element).find("#msgAmount"), c = parseInt(b.text(), 10);
            c++, b.text(c), b.show()
        },
        chatClearAmount: function () {
            if (KME.interfaces.chatWindow.is(":visible")) {
                var b = a(this.element).find("#msgAmount");
                b.text("0"), b.hide()
            }
        },
        _registerEvents: function () {
            var b = this;
            a(this.element).on("tap", "div.button[action]", function () {
                switch (a(this).attr("action")) {
                    case"inventory":
                        KME.interfaces.inventory.inventory("toggle");
                        break;
                    case"globalMenu":
                        a("#globalMenu").dialog({
                            modal: !0,
                            width: "600px",
                            background: "transparent",
                            buttons: {},
                            close: function () {
                            },
                            title: "Temporary title: allow close"
                        });
                        break;
                    case"actions":
                        KME.interfaces.actionsWindow.actionsWindow("toggle");
                        break;
                    case"chat":
                        KME.interfaces.chatWindow.chatWindow("toggle"), b.chatClearAmount();
                        break;
                    case"exit":
                        window.redirectToAuthorization();
                        break;
                    case"showcase":
                        var c = window.XPayStationWidget, d = {
                            access_token: b.paymentToken,
                            lightbox: {
                                spinner: "round",
                                spinnerColor: "#cccccc",
                                contentBackground: "transparent",
                                overlayOpacity: .4
                            }
                        };
                        window.WILDTERRA_PAYMENTS_SANDBOX && (d.sandbox = !0), c.init(d), c.open()
                }
            })
        },
        _refresh: function () {
            this._trigger("change")
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/ActionsBar", ["jquery", "jqueryui", "hammerjs", "jquery.hammer", "KME/controllers/data/DataController", "KME/controllers/interface/InterfaceController"], function (a) {
    a.widget("KME.actionsBar", {
        options: {
            change: null,
            random: null,
            keys: ["Q", "W", "E", "R", "T", "Y"],
            cache: {
                leftHandItem: null,
                leftHandElements: [],
                rightHandItem: null,
                rightHandElements: [],
                dismountElement: null
            }
        },
        actionsMap: {dress: "undress"},
        dismountsIcons: {
            basic: "DismountAction",
            horse: "HorseMount",
            deer: "DeerMount",
            boar: "BoarMount",
            wolf: "WolfMount",
            bear: "BearMount"
        },
        $wrapper: null,
        _create: function () {
            this.element.disableSelection(), a(this.element).hide(), this._buildTheme(), this._refresh(), this._registerEvents()
        },
        _getDismountIcon: function (a) {
            return this.dismountsIcons[a] ? this.dismountsIcons[a] : this.dismountsIcons.basic
        },
        _buildTheme: function () {
            this.element.append('<div class="leather-bottom"><div class="leather-top"><div class="leather-bg"></div></div></div>'), this.$wrapper = a(this.element).find(".leather-bg")
        },
        rebuild: function (b) {
            var c, d, e, f, g = this, h = 0;
            if (b.wear.slots.leftHand) {
                if (c = b.wear.slots.leftHand, g.options.cache.leftHandItem !== c) {
                    if (g.options.cache.leftHandItem)for (; g.options.cache.leftHandElements.length > 0;)e = g.options.cache.leftHandElements.pop(), e.remove();
                    g.options.cache.leftHandItem = null
                }
                if (g.options.cache.leftHandItem)h += g.options.cache.leftHandElements.length; else if (g.options.cache.leftHandItem = c, d = KME.controllers.ui.actions.createItemButtons(c, this.actionsMap, !0), d.reverse(), d.length > 0)for (f = 0; f < d.length; ++f)e = a('<div class="cell"></div>'), e.append(d[f]), e.append('<div class="key"></div>'), this.$wrapper.prepend(e), g.options.cache.leftHandElements.push(e), h++
            } else {
                if (g.options.cache.leftHandItem)for (; g.options.cache.leftHandElements.length > 0;)e = g.options.cache.leftHandElements.pop(), e.remove();
                g.options.cache.leftHandItem = null
            }
            if (b.wear.slots.rightHand) {
                if (c = b.wear.slots.rightHand, g.options.cache.rightHandItem !== c) {
                    if (g.options.cache.rightHandItem)for (; g.options.cache.rightHandElements.length > 0;)e = g.options.cache.rightHandElements.pop(), e.remove();
                    g.options.cache.rightHandItem = null
                }
                if (g.options.cache.rightHandItem)h += g.options.cache.rightHandElements.length; else if (g.options.cache.rightHandItem = c, d = KME.controllers.ui.actions.createItemButtons(c, this.actionsMap, !0), d.length > 0)for (f = 0; f < d.length; ++f)e = a('<div class="cell"></div>'), e.append(d[f]), e.append('<div class="key"></div>'), this.$wrapper.append(e), g.options.cache.rightHandElements.push(e), h++
            } else {
                if (g.options.cache.rightHandItem)for (; g.options.cache.rightHandElements.length > 0;)e = g.options.cache.rightHandElements.pop(), e.remove();
                g.options.cache.rightHandItem = null
            }
            b.effects.mount ? (this.options.cache.dismountElement && this.options.cache.dismountElement.remove(), e = a('<div class="cell"></div>'), e.append(KME.controllers.ui.actions.createItemButton({typeName: this._getDismountIcon(b.effects.mount)}, "dismount", null, "dismount")), e.append('<div class="key"></div>'), this.$wrapper.append(e), this.options.cache.dismountElement = e, h++) : this.options.cache.dismountElement && (this.options.cache.dismountElement.remove(), this.options.cache.dismountElement = null), this.$wrapper.find(".key").each(function () {
                a(this).html(g.options.keys[--h])
            }), this.$wrapper.find("div.button[action]").length > 0 ? a(this.element).show() : a(this.element).hide()
        },
        fireKey: function (b) {
            var c = this.$wrapper.find("div.cell"), d = c[c.length - b - 1];
            if (d) {
                var e = a(d).find("div.button");
                if (e.length) {
                    var f = e.data("item"), g = e.attr("action");
                    KME.controllers.data.actions.perform(g, f, function () {
                    })
                }
            }
        },
        _registerEvents: function () {
            var b = a(this.element).find(".leather-bg");
            KME.controllers.ui.actions.registerHandlers(b)
        },
        _refresh: function () {
            this._trigger("change")
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/ActionsWindow", ["jquery", "jqueryui", "hammerjs", "jquery.hammer", "perfect-scrollbar", "KME/controllers/data/DataController", "KME/controllers/interface/InterfaceController", "KME/interfaces/AbstractWindow"], function (a) {
    a.widget("KME.actionsWindow", a.KME.abstractWindow, {
        options: {
            size: 10,
            dialogClass: "wtWindow wtLeftWindow",
            buttonHighlight: ".button.show-actions",
            change: null,
            random: null,
            content: null,
            actions: [{name: "skills"}, {name: "stay"}, {name: "run"}, {name: "suicide"}, {name: "demolish"}, {name: "repair"}, {name: "craft"}, {name: "build"}],
            group: "leftWindows"
        }, actionsMap: {dress: "undress"}, _create: function () {
            this._super();
            var b = a('<div class="actions"></div>');
            this.container.append(b)
        }, _fillCells: function () {
            for (var b = a(this.element).find(".actions"), c = b.children().length, d = c; d < this.options.size; ++d) {
                var e = a('<div class="cell"></div>');
                b.append(e)
            }
        }, rebuild: function () {
            var b = a(this.element).find(".actions");
            b.html("");
            for (var c, d, e, f = 0; f < this.options.actions.length; ++f)c = this.options.actions[f], d = KME.controllers.ui.actions.createSimpleButton(c), e = a('<div class="cell"></div>'), e.append(d), this._fillDescription(c.name, e), b.append(e);
            b.perfectScrollbar({suppressScrollX: !0, wheelSpeed: 20, wheelPropagation: !0, minScrollbarLength: 20})
        }, _fillDescription: function (b, c) {
            var d = a('<div class="description"><h3 data-i18n="actions:%1.name"></h3><div data-i18n="actions:%1.description"></div></div>'.replace(/%1/g, b));
            d.find("[data-i18n]").i18n(), c.append(d)
        }, _fillRightHandActions: function (b, c) {
            var d, e, f;
            if (b.wear.slots.leftHand && (d = b.wear.slots.leftHand, e = KME.controllers.ui.actions.createItemButtons(d, this.actionsMap), e.length > 0))for (var g = 0; g < e.length; ++g)f = a('<div class="cell"></div>'), f.append(e[g]), this._fillDescription(e[g].attr("action"), f), c.append(f)
        }, _fillLeftHandActions: function (b, c) {
            var d, e, f;
            if (b.wear.slots.rightHand && (d = b.wear.slots.rightHand, e = KME.controllers.ui.actions.createItemButtons(d, this.actionsMap), e.length > 0))for (var g = 0; g < e.length; ++g)f = a('<div class="cell"></div>'), f.append(e[g]), this._fillDescription(e[g].attr("action"), f), c.append(f)
        }, _registerEvents: function () {
            this._super(), KME.controllers.ui.actions.registerHandlers(a(this.element)), this.container.on("remove", "div.button", function () {
                a(this).parent().html("")
            })
        }, open: function () {
            this._super();
            var b = a(this.element).find(".actions");
            b.scrollTop(1), a(this.element).parent().css("top", "0px")
        }
    })
}),define("KME/controllers/network/socket/SocketPlayerController", [], function () {
    return {
        init: function () {
        }, suicide: function () {
            KME.socket.emit("playerSuicide", !0)
        }, dismount: function () {
            KME.socket.emit("playerDismount", !0)
        }, saveAccess: function (a, b) {
            KME.socket.emit("playerSaveAccess", a, b)
        }, loadAccess: function (a) {
            KME.socket.emit("playerLoadAccess", null, a)
        }, purchasesCheck: function () {
            KME.socket.emit("purchasesCheck", null, function (a, b) {
                a ? console.error("purchasesCheck", a) : (b.achievements && KME.gameState.sendAchievement(b.achievements), b.player && KME.gameState.updatePlayer(b.player))
            })
        }, revive: function (a, b) {
            KME.socket.emit("playerRevive", a, b)
        }, chatMessage: function (a) {
            KME.socket.emit("chatMessage", a)
        }, skills: function (a) {
            KME.socket.emit("playerSkills", null, a)
        }
    }
}),define("KME/interfaces/DeathScreen", ["jquery", "jqueryui", "i18next", "KME/controllers/network/socket/SocketPlayerController"], function (a) {
    a.widget("KME.deathScreen", {
        options: {}, elements: {}, _create: function () {
            this.element.disableSelection(), this._render(), this._registerEvents()
        }, hideScreen: function () {
            this.updateIntervalId && clearInterval(this.updateIntervalId), a(this.element).hide()
        }, showScreen: function (b) {
            a(this.element).find("#mainRevive").attr("disabled", b), a(this.element).show()
        }, _render: function () {
            var b = this;
            this.elements.text = a('<h3 class="deathTitle" data-i18n="interfaces:deathScreen.title">You are dead</h3>'), this.element.append(this.elements.text), this.elements.text.i18n(), this.elements.buttonWrapper = a('<div class="buttonWrapper"></div>'), this.element.append(this.elements.buttonWrapper), this.elements.buttons = {
                revive: a('<button id="mainRevive" action="revive"><div data-i18n="interfaces:deathScreen.buttons.revive"></div><div class="text" data-i18n="interfaces:deathScreen.buttons.reviveText"></div></button>'),
                reviveRandom: a('<button action="random" class="small"><div data-i18n="interfaces:deathScreen.buttons.reviveRandom"></div><div class="text" data-i18n="interfaces:deathScreen.buttons.reviveRandomText"></div></button>')
            }, Object.keys(this.elements.buttons).forEach(function (a) {
                var c = b.elements.buttons[a];
                b.elements.buttonWrapper.append(c), c.find("div[data-i18n]").i18n()
            })
        }, _registerEvents: function () {
            var b = this;
            a(this.element).on("click", "button[action]", function () {
                var c = a(this).attr("action");
                console.log("Revive button pressed", c), KME.controllers.network.actions.player.revive(c, function (a) {
                    a || b.hideScreen()
                })
            })
        }, _destroy: function () {
            this.element.enableSelection()
        }, _setOptions: function () {
            this._superApply(arguments), this._refresh()
        }, _setOption: function (a, b) {
            this._super(a, b)
        }
    })
}),define("KME/interfaces/ChatWindow", ["jquery", "jqueryui", "KME/controllers/network/NetworkController"], function (a) {
    a.widget("KME.chatWindow", {
        options: {historySize: 20},
        elements: {$wrapper: null, $input: null, $output: null, $submit: null},
        _create: function () {
            this._super(), this._createSkin(), this._registerEvent()
        },
        _createSkin: function () {
            var b = this;
            this.elements.$wrapper = a('<div class="wrapper"></div>'), this.elements.$wrapper.append('<div class="dragHelper"></div>'), this.element.append(this.elements.$wrapper), this.elements.$output = a('<div id="chat-output" class="messageWrapper"></div>'), this.elements.$wrapper.append(this.elements.$output);
            var c = a('<div class="input-group"><input type="text" class="form-control" maxlength="140"><span class="input-group-btn"><button id="submitMessage" class="btn btn-wt-be" type="button" title="" data-i18n="[title]interfaces:chat.near"><i class="fa fa-comment"></i></button><button id="globalMessage" class="btn btn-wt-be2" type="button" title="" data-i18n="[title]interfaces:chat.global"><i class="fa fa-globe"></i></button></span></div>');
            this.elements.$wrapper.append(c), this.elements.$input = c.find("input[type=text]"), this.elements.$submit = c.find("#submitMessage"), this.elements.$global = c.find("#globalMessage"), c.find("[data-i18n]").i18n(), this.element.resizable({
                resize: function (a, d) {
                    b.elements.$output.css("height", d.size.height - 8 - c.height())
                }
            }), this.element.draggable({handle: ".dragHelper"})
        },
        _registerEvent: function () {
            var a = this;
            this.elements.$input.focus(function () {
                KME.game.input.keyboard.enabled = !1
            }).focusout(function () {
                KME.game.input.keyboard.enabled = !0
            }), this.elements.$input.keypress(function (b) {
                if (b.stopImmediatePropagation(), 13 == b.which || 10 == b.which) {
                    if (0 === a.elements.$input.val().length)return void a.close();
                    if (a.elements.$input.val().length < 1)return;
                    b.preventDefault(), b.ctrlKey ? a._sendGlobalMessage() : a._sendMessage(), a.close()
                }
            }), this.elements.$submit.click(function (b) {
                a.elements.$input.val().length < 1 || (b.preventDefault(), a._sendMessage(), a.elements.$input.focus())
            }), this.elements.$global.click(function (b) {
                a.elements.$input.val().length < 1 || (b.preventDefault(), a._sendGlobalMessage(), a.elements.$input.focus())
            })
        },
        _sendMessage: function () {
            var a = {authorId: KME.mainPlayer.id, author: KME.mainPlayer.name, text: this.elements.$input.val()};
            this.elements.$input.val(""), KME.controllers.network.actions.player.chatMessage(a)
        },
        _sendGlobalMessage: function () {
            var a = {
                authorId: KME.mainPlayer.id,
                author: KME.mainPlayer.name,
                text: "/g " + this.elements.$input.val()
            };
            this.elements.$input.val(""), KME.controllers.network.actions.player.chatMessage(a)
        },
        drawMessage: function (b) {
            a(this.element).is(":visible") || KME.mainPlayer.id === b.authorId || KME.interfaces.menuBar.menuBar("chatAddAmount");
            var c = KME.mainPlayer.id == b.authorId ? a.t("interfaces:chat.me") : b.author;
            this.elements.$output.append("<div><b>" + c + "</b>: " + b.text + "</div>"), this.elements.$output[0].scrollTop = this.elements.$output[0].scrollHeight, this.elements.$output.children().length > this.options.historySize && this.elements.$output.children()[0].remove()
        },
        open: function () {
            a(this.element).show(), this.elements.$input.focus()
        },
        close: function () {
            a(this.element).hide()
        },
        toggle: function () {
            a(this.element).is(":visible") ? this.close() : this.open()
        }
    })
}),define("KME/interfaces/Achievement", ["jquery", "bootstrap", "i18next"], function (a) {
    var b = '<div class="alert alert-warning alert-dismissible" role="alert" data-index="%2">                    <button type="button" class="close" data-dismiss="alert" aria-label="Close" data-index="%2">                        <span aria-hidden="true">&times;</span>                    </button>                    %1                </div>', c = 0;
    KME.Achievement = {
        showMessage: function (b) {
            this.show(a.t(b))
        }, show: function (b) {
            var c = a(".achievements");
            this._isPopoverExists(c) ? this._appendMessage(c, b) : this._create(c, b), c.popover("show")
        }, _appendMessage: function (a, b) {
            var c = a.data("bs.popover").options.content, d = this._formatMessage(b);
            c += d, a.data("bs.popover").options.messages.push(d), a.data("bs.popover").options.content = c;
            var e = a.data("bs.popover").$tip;
            if (e) {
                var f = e.find("div.popover-content");
                f.html(a.data("bs.popover").options.content)
            }
        }, _formatMessage: function (a) {
            return b.replace("%1", a).replace(/%2/g, c++)
        }, _isPopoverExists: function (a) {
            return a.data("bs.popover")
        }, _create: function (b, c) {
            var d = this._formatMessage(c), e = {
                container: "body",
                trigger: "manual",
                placement: "top",
                html: !0,
                content: d,
                title: a.t("interfaces:achievement.title"),
                messages: [d]
            };
            b.popover(e), b.on("hidden.bs.popover", function () {
                b.popover("destroy")
            });
            var f = !1;
            b.on("shown.bs.popover", function () {
                var c = a(this), d = c.data("bs.popover").$tip;
                f || (f = !0, d.on("click", 'button[data-dismiss="alert"]', function (e) {
                    e.stopPropagation(), e.preventDefault();
                    var f = d.find("div.popover-content");
                    if (f.children().length > 1) {
                        var g = a(this).attr("data-index"), h = b.data("bs.popover").options.messages;
                        h = h.filter(function (a) {
                            return a.indexOf('data-index="' + g + '"') < 0
                        }), b.data("bs.popover").options.messages = h, b.data("bs.popover").options.content = h.join(), f.html(b.data("bs.popover").options.content), c.popover("show")
                    } else c.popover("hide")
                }))
            })
        }
    }
}),define("KME/interfaces/ClaimWindow", ["jquery", "jqueryui", "jstree", "hammerjs", "jquery.hammer", "KME/interfaces/AbstractWindow"], function (a) {
    a.widget("KME.claimWindow", a.KME.abstractWindow, {
        options: {
            dialogClass: "wtWindow wtLeftWindow",
            buttonHighlight: "",
            group: "leftWindows",
            linesNumber: 5
        },
        templates: {
            accessList: '<div class="accessList"><p data-i18n="[html]interfaces:claim.description"></p></div>',
            accessLine: '<div class="accessLine"><input data-i18n="[title]interfaces:claim.nameTitle" class="accessName form-control" type="text"/> <span data-i18n="[title]interfaces:claim.buildTitle"><i class="fa fa-gavel"/>:<input class="accessBuild" type="checkbox"/></span> <span data-i18n="[title]interfaces:claim.doorsTitle"><i class="fa fa-key"/>:<input class="accessDoors" type="checkbox"/></span></div>',
            apply: '<input class="apply" type="button" data-i18n="[value]interfaces:claim.apply" />'
        },
        _create: function () {
            this._super(), this.element.disableSelection(), this._disableWrongDrop(), this._createSkin()
        },
        _createSkin: function () {
            this.container.append(this.templates.accessList);
            for (var b = 0, c = this.options.linesNumber; c > b; b++)this._createLine(b);
            var d = a(this.templates.apply);
            this.container.find(".accessList").append(d), this.container.i18n();
            var e = this;
            d.click(function () {
                e._saveAccess()
            })
        },
        _createLine: function (b) {
            var c = a(this.templates.accessLine);
            this.container.find(".accessList").append(c), c.find(".accessName").attr("id", "accessName" + b), c.find(".accessBuild").attr("id", "accessBuild" + b), c.find(".accessDoors").attr("id", "accessDoors" + b), c.find(".accessName").focus(function () {
                KME.game.input.keyboard.enabled = !1
            }).focusout(function () {
                KME.game.input.keyboard.enabled = !0
            })
        },
        _loadAccess: function () {
            var a = this.container.find(".accessList");
            a.hide();
            var b = this;
            KME.controllers.network.actions.player.loadAccess(function (c, d) {
                if (c)KME.gameState.showMessage(c); else {
                    var e, f = 0, g = b.options.linesNumber;
                    for (d && d.accesses && Object.keys(d.accesses).forEach(function (a) {
                        e = d.accesses[a], b.container.find("#accessName" + f).val(a), b.container.find("#accessBuild" + f).prop("checked", e.build), b.container.find("#accessDoors" + f).prop("checked", e.doors), f++
                    }); g > f;)b.container.find("#accessName" + f).val(""), b.container.find("#accessBuild" + f).prop("checked", !1), b.container.find("#accessDoors" + f).prop("checked", !1), f++;
                    a.show()
                }
            })
        },
        _saveAccess: function () {
            for (var a, b = null, c = 0, d = this.options.linesNumber; d > c; c++)a = this.container.find("#accessName" + c).val(), a && a.length > 0 && (b || (b = {}), b[a] = {
                build: this.container.find("#accessBuild" + c).is(":checked"),
                doors: this.container.find("#accessDoors" + c).is(":checked")
            });
            KME.controllers.network.actions.player.saveAccess({
                playerId: KME.mainPlayer.id,
                accesses: b
            }, function (a, b) {
                a && KME.gameState.showMessage(a), b && KME.gameState.showMessage(b)
            }), this.close()
        },
        _disableWrongDrop: function () {
            a(this.element).droppable({
                greedy: !0, drop: function () {
                }
            })
        },
        rebuild: function () {
            this.open()
        },
        _destroy: function () {
            this.element.enableSelection()
        },
        _setOptions: function () {
            this._superApply(arguments), this._refresh()
        },
        _setOption: function (a, b) {
            this._super(a, b)
        },
        toggle: function () {
            a(this.element).is(":visible") ? this.close() : this.open()
        },
        open: function () {
            this._super(), a(this.element).parent().css("top", "0px"), this._loadAccess()
        },
        close: function () {
            this._super()
        }
    })
}),define("KME/interfaces/SkillsWindow", ["jquery", "jqueryui", "hammerjs", "jquery.hammer", "perfect-scrollbar", "KME/controllers/data/DataController", "KME/controllers/interface/InterfaceController", "KME/interfaces/AbstractWindow"], function (a) {
    a.widget("KME.skillsWindow", a.KME.abstractWindow, {
        options: {
            size: 10,
            dialogClass: "wtWindow wtLeftWindow",
            buttonHighlight: ".button.show-actions",
            change: null,
            random: null,
            content: null,
            group: "leftWindows",
            limit: 1e3
        }, _create: function () {
            this._super();
            var b = a('<div class="skills"></div>');
            this.container.append(b)
        }, _fillCells: function () {
            for (var b = a(this.element).find(".skills"), c = b.children().length, d = c; d < this.options.size; ++d) {
                var e = a('<div class="cell"></div>');
                b.append(e)
            }
        }, rebuild: function () {
            var b = a(this.element).find(".skills");
            b.html("");
            for (var c, d, e = Object.keys(KME.playerSkills.skills), f = 0; f < e.length; ++f)c = KME.playerSkills.skills[e[f]], d = a('<div class="cell"></div>'), this._fillSkill(c, d), b.append(d);
            b.perfectScrollbar({suppressScrollX: !0, wheelSpeed: 20, wheelPropagation: !0, minScrollbarLength: 20})
        }, _isLevelCap: function (a, b) {
            var c = KME.types.skillTypes.list[a], d = KME.types.skillTypes.xpLevels, e = c.levelCap ? c.levelCap : d.baseLevelCap;
            return b >= e
        }, _getXpLimit: function (a) {
            var b = KME.types.skillTypes.xpLevels;
            return a ? b.baseXp + (a - 1) * b.levelAddXp + (a - 1) * a * b.levelExpXp : 0
        }, _fillSkill: function (b, c) {
            var d = a('<div class="skill %1" data-i18n="[title]skills:%1.name"><div class="skill-icon"><span>%2</span></div></div>'.replace(/%1/g, b.name).replace(/%2/g, b.level));
            d.find("[data-i18n]").i18n(), c.append(d);
            var e = a('<div class="description"><h3 data-i18n="skills:%1.name"></h3><div data-i18n="skills:%1.description"></div></div>'.replace(/%1/g, b.name));
            e.find("[data-i18n]").i18n(), c.append(e);
            var f;
            b.level ? this._isLevelCap(b.name, b.level) ? (f = a('<div class="xp" data-i18n="skills:levels.maxLevel"></div>'), f.i18n()) : f = a('<div class="xp">' + b.xp + "/" + this._getXpLimit(b.level) + "</div>") : (f = a('<div class="xp" data-i18n="skills:levels.noLevelYet"></div>'), f.i18n()), e.append(f)
        }, _registerEvents: function () {
            this._super(), this.container.on("remove", "div.button", function () {
                a(this).parent().html("")
            })
        }, open: function () {
            this._super(), this.rebuild()
        }
    })
}),define("KME/controllers/interface/InterfaceController", ["require", "jquery", "async", "modernizr", "../network/NetworkController", "jqueryui", "./UIItemController", "./UIWorldController", "./UIActionsController", "./CursorController", "./TutorialController", "./DaylightController", "KME/interfaces/Build", "KME/interfaces/Container", "KME/interfaces/Craft", "KME/interfaces/Inventory", "KME/interfaces/Tool", "KME/interfaces/Toolbar", "KME/interfaces/Topbar", "KME/interfaces/ItemTooltip", "KME/interfaces/EffectsBar", "KME/interfaces/BonusesBar", "KME/interfaces/MenuBar", "KME/interfaces/ActionsBar", "KME/interfaces/ActionsWindow", "KME/interfaces/DeathScreen", "KME/interfaces/ChatWindow", "KME/interfaces/Achievement", "KME/interfaces/ClaimWindow", "KME/interfaces/SkillsWindow"], function (a, b, c, d) {
    var e = a("./UIItemController"), f = a("./UIWorldController"), g = a("./UIActionsController"), h = a("./CursorController"), i = a("./TutorialController"), j = a("./DaylightController"), k = [], l = {};
    return {
        item: e, world: f, actions: g, cursor: h, tutorial: i, daylight: j, init: function (a) {
            this._.prepareStructure(), this._.build(a), this._.registerWorldDrop(), this._.registerGlobalItemClick(), this._.initPayStation()
        }, update: function (a) {
            var b = this;
            c.parallel([function () {
                KME.interfaces.inventory.inventory("rebuild", a)
            }, function () {
                KME.interfaces.toolbar.toolbar("rebuild", a)
            }, function () {
                KME.interfaces.topbar.topbar("rebuild", a)
            }, function () {
                b.updateBonusesAndEffects(a)
            }, function () {
                KME.interfaces.actionsBar.actionsBar("rebuild", a)
            }, function () {
                KME.interfaces.actionsWindow.actionsWindow("rebuild", a)
            }])
        }, updateBonusesAndEffects: function (a) {
            c.parallel([function () {
                KME.interfaces.bonusesBar.bonusesBar("rebuild", a)
            }, function () {
                KME.interfaces.effectsBar.effectsBar("rebuild", a)
            }, function () {
                KME.interfaces.craft.is(":visible") && KME.interfaces.craft.craft("refreshIfSelect"), KME.interfaces.build.is(":visible") && KME.interfaces.build.build("refreshIfSelect")
            }])
        }, updateTopBar: function (a) {
            c.parallel([function () {
                KME.interfaces.topbar.topbar("rebuild", a)
            }])
        }, showInfo: function (a) {
            c.parallel([function () {
                KME.interfaces.topbar.topbar("showInfo", a)
            }])
        }, updateToolbar: function (a) {
            c.parallel([function () {
                KME.interfaces.toolbar.toolbar("rebuild", a)
            }])
        }, updateOnItemDurability: function (a) {
            c.parallel([function () {
                KME.interfaces.inventory.inventory("rebuild", a)
            }, function () {
                KME.interfaces.toolbar.toolbar("rebuild", a)
            }])
        }, updateContainer: function (a, c) {
            var d = b("#" + c + "_" + a.id);
            d.is(":visible") && d.container("rebuild", a)
        }, updateOnWear: function (a) {
            console.time("InterfaceController.updateOnWear");
            var b = this;
            c.parallel([function () {
                KME.interfaces.inventory.inventory("rebuild", a)
            }, function () {
                b.updateBonusesAndEffects(a)
            }, function () {
                KME.interfaces.actionsBar.actionsBar("rebuild", a)
            }, function () {
                KME.interfaces.toolbar.toolbar("rebuild", a)
            }]), console.timeEnd("InterfaceController.updateOnWear")
        }, updateOnItemMove: function (a, b) {
            c.parallel([function (b) {
                KME.interfaces.inventory.inventory("rebuild", a), b()
            }], function () {
                b && KME.interfaces.toolbar.toolbar("autocreate", b)
            })
        }, addOpenedWindowObject: function (a) {
            k.push(a)
        }, removeOpenedWindowObject: function (a) {
            var b = k.indexOf(a);
            b >= 0 && k.splice(b, 1)
        }, closeFarAwayContainers: function (a) {
            if (k.length)for (var b, c = 0; c < k.length; ++c)b = k[c], a.isInRangeObject(b.options.content.worldObject, 150) || (b.close(), --c)
        }, closeDestroyedContainer: function (a, c) {
            var d = b("#" + c + "_" + a);
            d.is(":visible") && d.container("close")
        }, registerWindowInGroup: function (a, b) {
            l[a] || (l[a] = []), l[a].push(b)
        }, closeWindowsInGroupExcept: function (a, b) {
            for (var c, d = 0; d < l[a].length; ++d)c = l[a][d], c != b && c.close()
        }, chatMessage: function (a) {
            KME.gameState.objects[a.authorId] ? (KME.gameState.objects[a.authorId].showMessage({
                message: a.text,
                delay: 3e3
            }), KME.interfaces.chatWindow.chatWindow("drawMessage", a)) : KME.mainPlayer.id === a.authorId ? (KME.interfaces.chatWindow.chatWindow("drawMessage", a), KME.mainPlayer.showMessage({
                message: a.text,
                delay: 3e3
            })) : KME.interfaces.chatWindow.chatWindow("drawMessage", a)
        }, _: {
            prepareStructure: function () {
                if (this.unregisterGlobalItemClick(), b("#interfaceWrapper").empty(), b("#interfaceWrapper").remove(), b("#game").append('            <div id="interfaceWrapper">                <div id="topbar"></div>                <div id="bonusesBar"></div>                <div id="effectsBar"></div>                <div id="inventory"></div>                <div id="actionsWindow"></div>                <div id="skillsWindow"></div>                <div id="craft"></div>                <div id="build"></div>                <div id="claimWindow"></div>                <div id="toolbar"></div>                <div id="menuBar"></div>                <div id="actionsBar"></div>                <div id="containers"></div>                <div id="tools"></div>                <div id="deathScreen"></div>                <div id="chatWindow"></div>                <div id="globalMenu"><div class="wrapper"></div></div>            </div>'), d.pointerevents) {
                    console.log("Modernizr.pointerevents is ON");
                    var a = b("#game");
                    KME.types.gameConfig.nightEnabled && a.prepend('<canvas id="daylight-effect"></canvas>'), KME.types.gameConfig.rainEnabled && a.prepend('<div id="weather-effect"></div>')
                } else console.log("Modernizr.pointerevents is OFF");
                window.SHOW_PHASER_DEBUG && (b("#toolbar").css("bottom", "40px"), b(".pdebug-stats").append('<span class="pdebug-stats-item ping"><span>-</span> ping</span>'))
            }, build: function (a) {
                var e = KME.types.worldTypes.Player, f = {
                    appendTo: "#interfaceWrapper",
                    title: "craft",
                    position: {my: "left top", at: "left top", of: b("#interfaceWrapper")},
                    draggable: !1,
                    resizable: !1,
                    autoOpen: !1
                };
                c.parallel([function (a) {
                    KME.interfaces.topbar = b("#topbar").topbar(), a()
                }, function (a) {
                    var c = {
                        appendTo: "#interfaceWrapper",
                        title: "inventory",
                        position: {my: "right", at: "right", of: b("#interfaceWrapper")},
                        draggable: !1,
                        autoOpen: !1,
                        resizable: !1,
                        size: e.inventory.slots
                    };
                    KME.interfaces.inventory = b("#inventory").inventory(c), a()
                }, function (a) {
                    KME.interfaces.toolbar = b("#toolbar").toolbar(), a()
                }, function (a) {
                    f.title = "craft", KME.interfaces.craft = b("#craft").craft(f), a()
                }, function (a) {
                    f.title = "build", KME.interfaces.build = b("#build").build(f), a()
                }, function (a) {
                    f.title = "claim", KME.interfaces.claimWindow = b("#claimWindow").claimWindow(f), a()
                }, function (a) {
                    var c = {
                        appendTo: "#interfaceWrapper",
                        title: "actions",
                        position: {my: "left top", at: "left top", of: b("#interfaceWrapper")},
                        draggable: !1,
                        resizable: !1,
                        autoOpen: !1
                    };
                    KME.interfaces.actionsWindow = b("#actionsWindow").actionsWindow(c), a()
                }, function (a) {
                    var c = {
                        appendTo: "#interfaceWrapper",
                        title: "skills",
                        position: {my: "left top", at: "left top", of: b("#interfaceWrapper")},
                        draggable: !1,
                        resizable: !1,
                        autoOpen: !1
                    };
                    KME.interfaces.skillsWindow = b("#skillsWindow").skillsWindow(c), a()
                }, function (a) {
                    KME.interfaces.bonusesBar = b("#bonusesBar").bonusesBar(), a()
                }, function (a) {
                    KME.interfaces.effectsBar = b("#effectsBar").effectsBar(), a()
                }, function (a) {
                    KME.interfaces.menuBar = b("#menuBar").menuBar(), a()
                }, function (a) {
                    KME.interfaces.actionsBar = b("#actionsBar").actionsBar(), a()
                }, function (a) {
                    KME.interfaces.deathScreen = b("#deathScreen").deathScreen(), a()
                }, function (a) {
                    KME.interfaces.chatWindow = b("#chatWindow").chatWindow(), a()
                }], function () {
                    var b = "#tutorial" == window.location.hash;
                    (b || "yes" !== window.localStorage.tour_end) && i.init(b), d.pointerevents && KME.types.gameConfig.nightEnabled && j.init(), a()
                })
            }, registerWorldDrop: function () {
                b("#game").droppable({
                    tolerance: "fit",
                    greedy: !0,
                    accept: ".itemImage, .button[action]",
                    drop: function (a, c) {
                        var d = KME.mainPlayer;
                        if (b(c.draggable).hasClass("itemImage")) {
                            var e = c.draggable.data("item");
                            if (!e)return;
                            console.log("Dropping item to world", e, a), KME.controllers.network.actions.item.dropItem({
                                id: e.id,
                                x: d.x,
                                y: d.y
                            }, function (a, b) {
                                a ? KME.gameState.showMessage(a) : KME.gameState.updatePlayer(b)
                            })
                        } else if ("toolbar" === c.draggable.closest("div[id]").attr("id")) {
                            console.log("Dropping action to world", c, a);
                            var f = {position: b.inArray(c.draggable.parent()[0], b(c.draggable.closest(".wrapper")).find("div.cell"))};
                            KME.controllers.network.actions.action.dropAction(f)
                        }
                        b(c.helper).remove()
                    }
                })
            }, registerGlobalItemClick: function () {
                b("#game").on("tap doubletap", "div.itemImage", function (a) {
                    a.gesture.srcEvent.preventDefault();
                    var c = b(this).data("item");
                    c.onClick(b(this), "doubletap" == a.type)
                })
            }, unregisterGlobalItemClick: function () {
                b("#game").off("mouseup", "div.itemImage")
            }, initPayStation: function () {
                var a = window.XPayStationWidget;
                a.on("close", function () {
                    KME.controllers.network.requests.requestUser(function () {
                        console.log("initPayStation success callback"), KME.controllers.network.actions.player.purchasesCheck()
                    }, function () {
                        console.log("initPayStation error callback")
                    })
                })
            }
        }
    }
}),function (a) {
    define("threeSeaExt", ["three"], function () {
        return function () {
            THREE.GLNode = function (a) {
                this.uuid = THREE.Math.generateUUID(), this.allow = {}, this.requestUpdate = !1, this.type = a
            }, THREE.GLNode.prototype.verify = function (a, b, c) {
                a.isVerify = !0;
                var d = a.material;
                this.build(a.addCache(b, c), "v4"), d.clearVertexNode(), d.clearFragmentNode(), a.removeCache(), a.isVerify = !1
            }, THREE.GLNode.prototype.verifyAndBuildCode = function (a, b, c, d) {
                return this.verify(a, c, d), this.buildCode(a, b, c, d)
            }, THREE.GLNode.prototype.buildCode = function (a, b, c, d) {
                var e = a.material, f = {result: this.build(a.addCache(c, d), b)};
                return a.isShader("vertex") ? f.code = e.clearVertexNode() : f.code = e.clearFragmentNode(), a.removeCache(), f
            }, THREE.GLNode.prototype.verifyDepsNode = function (a, b, c) {
                b.deps = (b.deps || 0) + 1;
                var d = a.getFormatLength(c);
                (d > (b.outputMax || 0) || this.getType(a)) && (b.outputMax = d, b.output = c)
            }, THREE.GLNode.prototype.build = function (a, b, c) {
                var d = a.material, e = d.getDataNode(c || this.uuid);
                if (a.isShader("verify") && this.verifyDepsNode(a, e, b), this.allow[a.shader] === !1)throw new Error("Shader " + shader + " is not compatible with this node.");
                return this.requestUpdate && !e.requestUpdate && (d.requestUpdate.push(this), e.requestUpdate = !0), this.generate(a, b, c)
            }, THREE.GLNode.prototype.getType = function (a) {
                return this.type
            }, THREE.PhongNode = function () {
                THREE.GLNode.call(this), this.color = new THREE.ColorNode(15658734), this.specular = new THREE.ColorNode(1118481), this.shininess = new THREE.FloatNode(30)
            }, THREE.PhongNode.prototype = Object.create(THREE.GLNode.prototype), THREE.PhongNode.prototype.constructor = THREE.PhongNode, THREE.PhongNode.prototype.build = function (a) {
                var b, c = a.material;
                if (c.define("PHONG"), c.define("ALPHATEST", "0.0"), c.requestAttrib.light = !0, a.isShader("vertex")) {
                    var d = this.transform ? this.transform.verifyAndBuildCode(a, "v3", "transform") : void 0;
                    c.mergeUniform(THREE.UniformsUtils.merge([THREE.UniformsLib.fog, THREE.UniformsLib.lights])), c.addVertexPars(["varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", THREE.ShaderChunk.common, THREE.ShaderChunk.morphtarget_pars_vertex, THREE.ShaderChunk.skinning_pars_vertex, THREE.ShaderChunk.shadowmap_pars_vertex, THREE.ShaderChunk.logdepthbuf_pars_vertex].join("\n"));
                    var e = [THREE.ShaderChunk.beginnormal_vertex, THREE.ShaderChunk.morphnormal_vertex, THREE.ShaderChunk.skinbase_vertex, THREE.ShaderChunk.skinnormal_vertex, THREE.ShaderChunk.defaultnormal_vertex, "#ifndef FLAT_SHADED", "	vNormal = normalize( transformedNormal );", "#endif", THREE.ShaderChunk.begin_vertex];
                    d && e.push(d.code, "transformed = " + d.result + ";"), e.push(THREE.ShaderChunk.morphtarget_vertex, THREE.ShaderChunk.skinning_vertex, THREE.ShaderChunk.project_vertex, THREE.ShaderChunk.logdepthbuf_vertex, "	vViewPosition = - mvPosition.xyz;", THREE.ShaderChunk.worldpos_vertex, THREE.ShaderChunk.shadowmap_vertex), b = e.join("\n")
                } else {
                    this.color.verify(a), this.specular.verify(a), this.shininess.verify(a), this.alpha && this.alpha.verify(a), this.light && this.light.verify(a, "light"), this.ao && this.ao.verify(a), this.ambient && this.ambient.verify(a), this.shadow && this.shadow.verify(a), this.emissive && this.emissive.verify(a), this.normal && this.normal.verify(a), this.normalScale && this.normal && this.normalScale.verify(a), this.environment && this.environment.verify(a), this.environmentAlpha && this.environment && this.environmentAlpha.verify(a);
                    var f = this.color.buildCode(a, "c"), g = this.specular.buildCode(a, "c"), h = this.shininess.buildCode(a, "fv1"), i = this.alpha ? this.alpha.buildCode(a, "fv1") : void 0, j = this.light ? this.light.buildCode(a, "v3", "light") : void 0, k = this.ao ? this.ao.buildCode(a, "fv1") : void 0, l = this.ambient ? this.ambient.buildCode(a, "c") : void 0, m = this.shadow ? this.shadow.buildCode(a, "c") : void 0, n = this.emissive ? this.emissive.buildCode(a, "c") : void 0, o = this.normal ? this.normal.buildCode(a, "v3") : void 0, p = this.normalScale && this.normal ? this.normalScale.buildCode(a, "v2") : void 0, q = this.environment ? this.environment.buildCode(a, "c") : void 0, r = this.environmentAlpha && this.environment ? this.environmentAlpha.buildCode(a, "fv1") : void 0;
                    c.requestAttrib.transparent = void 0 != i, c.addFragmentPars([THREE.ShaderChunk.common, THREE.ShaderChunk.fog_pars_fragment, THREE.ShaderChunk.bsdfs, THREE.ShaderChunk.lights_pars, THREE.ShaderChunk.lights_phong_pars_fragment, THREE.ShaderChunk.shadowmap_pars_fragment, THREE.ShaderChunk.logdepthbuf_pars_fragment].join("\n"));
                    var e = [THREE.ShaderChunk.normal_fragment, "	BlinnPhongMaterial material;", f.code, "	vec3 diffuseColor = " + f.result + ";", "	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );", THREE.ShaderChunk.logdepthbuf_fragment, g.code, "	vec3 specular = " + g.result + ";", h.code, "	float shininess = max(0.0001," + h.result + ");", "	float specularStrength = 1.0;"];
                    i && e.push(i.code, "if ( " + i.result + " <= ALPHATEST ) discard;"), o && (a.include("perturbNormal2Arb"), e.push(o.code), p && e.push(p.code), e.push("normal = perturbNormal2Arb(-vViewPosition,normal," + o.result + "," + (new THREE.UVNode).build(a, "v2") + "," + (p ? p.result : "vec2( 1.0 )") + ");")), e.push("material.diffuseColor = " + (j ? "vec3( 1.0 )" : "diffuseColor") + ";"), e.push("material.specularColor = specular;", "material.specularShininess = shininess;", "material.specularStrength = specularStrength;", THREE.ShaderChunk.lights_template), j && (e.push(j.code, "reflectedLight.directDiffuse = " + j.result + ";"), e.push("reflectedLight.directDiffuse *= diffuseColor;", "reflectedLight.indirectDiffuse *= diffuseColor;")), k && e.push(k.code, "reflectedLight.indirectDiffuse *= " + k.result + ";"), l && e.push(l.code, "reflectedLight.indirectDiffuse += " + l.result + ";"), m && e.push(m.code, "reflectedLight.directDiffuse *= " + m.result + ";", "reflectedLight.directSpecular *= " + m.result + ";"), n && e.push(n.code, "reflectedLight.directDiffuse += " + n.result + ";"), e.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"), q && (e.push(q.code), r ? e.push(r.code, "outgoingLight = mix(outgoingLight," + q.result + "," + r.result + ");") : e.push("outgoingLight = " + q.result + ";")), e.push(THREE.ShaderChunk.linear_to_gamma_fragment, THREE.ShaderChunk.fog_fragment), i ? e.push("gl_FragColor = vec4( outgoingLight, " + i.result + " );") : e.push("gl_FragColor = vec4( outgoingLight, 1.0 );"), b = e.join("\n")
                }
                return b
            }, THREE.NodeMaterial = function (a, b) {
                THREE.ShaderMaterial.call(this), this.vertex = a || new THREE.RawNode(new THREE.PositionNode(THREE.PositionNode.PROJECTION)), this.fragment = b || new THREE.RawNode(new THREE.ColorNode(16711680))
            }, THREE.NodeMaterial.types = {
                t: "sampler2D",
                tc: "samplerCube",
                bv1: "bool",
                iv1: "int",
                fv1: "float",
                c: "vec3",
                v2: "vec2",
                v3: "vec3",
                v4: "vec4",
                m4: "mat4"
            }, THREE.NodeMaterial.addShortcuts = function (a, b, c) {
                function d(a, b) {
                    return {
                        get: function () {
                            return this[a][b]
                        }, set: function (c) {
                            this[a][b] = c
                        }
                    }
                }

                return function () {
                    for (var e = {}, f = 0; f < c.length; ++f) {
                        var g = c[f];
                        e[g] = d(b, g)
                    }
                    Object.defineProperties(a, e)
                }()
            }, THREE.NodeMaterial.prototype = Object.create(THREE.ShaderMaterial.prototype), THREE.NodeMaterial.prototype.constructor = THREE.NodeMaterial, THREE.NodeMaterial.prototype.updateAnimation = function (a) {
                for (var b = 0; b < this.requestUpdate.length; ++b)this.requestUpdate[b].updateAnimation(a)
            }, THREE.NodeMaterial.prototype.build = function () {
                var a, b;
                this.defines = {}, this.uniforms = {}, this.nodeData = {}, this.vertexUniform = [], this.fragmentUniform = [], this.vertexTemps = [], this.fragmentTemps = [], this.uniformList = [], this.consts = [], this.functions = [], this.requestUpdate = [], this.requestAttrib = {
                    uv: [],
                    color: []
                }, this.vertexPars = "", this.fragmentPars = "", this.vertexCode = "", this.fragmentCode = "", this.vertexNode = "", this.fragmentNode = "", this.prefixCode = ["#ifdef GL_EXT_shader_texture_lod", "#define texCube(a, b) textureCube(a, b)", "#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)", "#define tex2D(a, b) texture2D(a, b)", "#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)", "#else", "#define texCube(a, b) textureCube(a, b)", "#define texCubeBias(a, b, c) textureCube(a, b, c)", "#define tex2D(a, b) texture2D(a, b)", "#define tex2DBias(a, b, c) texture2D(a, b, c)", "#endif"].join("\n");
                var c = new THREE.BuilderNode(this);
                return a = this.vertex.build(c.setShader("vertex"), "v4"), b = this.fragment.build(c.setShader("fragment"), "v4"), this.requestAttrib.uv[0] && (this.addVertexPars("varying vec2 vUv;"), this.addFragmentPars("varying vec2 vUv;"), this.addVertexCode("vUv = uv;")), this.requestAttrib.uv[1] && (this.addVertexPars("varying vec2 vUv2; attribute vec2 uv2;"), this.addFragmentPars("varying vec2 vUv2;"), this.addVertexCode("vUv2 = uv2;")), this.requestAttrib.color[0] && (this.addVertexPars("varying vec4 vColor; attribute vec4 color;"), this.addFragmentPars("varying vec4 vColor;"), this.addVertexCode("vColor = color;")), this.requestAttrib.color[1] && (this.addVertexPars("varying vec4 vColor2; attribute vec4 color2;"), this.addFragmentPars("varying vec4 vColor2;"), this.addVertexCode("vColor2 = color2;")), this.requestAttrib.position && (this.addVertexPars("varying vec3 vPosition;"), this.addFragmentPars("varying vec3 vPosition;"), this.addVertexCode("vPosition = transformed;")), this.requestAttrib.worldPosition && (this.addVertexPars("varying vec3 vWPosition;"), this.addFragmentPars("varying vec3 vWPosition;"), this.addVertexCode("vWPosition = worldPosition.xyz;")), this.requestAttrib.normal && (this.addVertexPars("varying vec3 vObjectNormal;"), this.addFragmentPars("varying vec3 vObjectNormal;"), this.addVertexCode("vObjectNormal = normal;")), this.requestAttrib.worldNormal && (this.addVertexPars("varying vec3 vWNormal;"), this.addFragmentPars("varying vec3 vWNormal;"), this.addVertexCode("vWNormal = ( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz;")), this.lights = this.requestAttrib.light, this.transparent = this.requestAttrib.transparent, this.vertexShader = [this.prefixCode, this.vertexPars, this.getCodePars(this.vertexUniform, "uniform"), this.getIncludes(this.consts.vertex), this.getIncludes(this.functions.vertex), "void main(){", this.getCodePars(this.vertexTemps), a, this.vertexCode, "}"].join("\n"), this.fragmentShader = [this.prefixCode, this.fragmentPars, this.getCodePars(this.fragmentUniform, "uniform"), this.getIncludes(this.consts.fragment), this.getIncludes(this.functions.fragment), "void main(){", this.getCodePars(this.fragmentTemps), this.fragmentCode, b, "}"].join("\n"), this.needsUpdate = !0, this.dispose(), this
            }, THREE.NodeMaterial.prototype.define = function (a, b) {
                this.defines[a] = void 0 == b ? 1 : b
            }, THREE.NodeMaterial.prototype.isDefined = function (a) {
                return void 0 != this.defines[a]
            }, THREE.NodeMaterial.prototype.mergeUniform = function (a) {
                for (var b in a)this.uniforms[b] = a[b]
            }, THREE.NodeMaterial.prototype.createUniform = function (a, b, c, d) {
                var e = this.uniformList.length, f = {type: a, value: b, name: c ? c : "nVu" + e, needsUpdate: d};
                return this.uniformList.push(f), f
            }, THREE.NodeMaterial.prototype.getVertexTemp = function (a, b, c) {
                if (!this.vertexTemps[a]) {
                    var d = this.vertexTemps.length, e = c ? c : "nVt" + d, f = {name: e, type: b};
                    this.vertexTemps.push(f), this.vertexTemps[a] = f
                }
                return this.vertexTemps[a]
            }, THREE.NodeMaterial.prototype.getFragmentTemp = function (a, b, c) {
                if (!this.fragmentTemps[a]) {
                    var d = this.fragmentTemps.length, e = c ? c : "nVt" + d, f = {name: e, type: b};
                    this.fragmentTemps.push(f), this.fragmentTemps[a] = f
                }
                return this.fragmentTemps[a]
            }, THREE.NodeMaterial.prototype.getIncludes = function (a) {
                function b(a, b) {
                    return b.deps - a.deps
                }

                return function (a) {
                    if (!a)return "";
                    for (var c = "", a = a.sort(b), d = 0; d < a.length; d++)c += a[d].node.src + "\n";
                    return c
                }
            }(), THREE.NodeMaterial.prototype.addVertexPars = function (a) {
                this.vertexPars += a + "\n"
            }, THREE.NodeMaterial.prototype.addFragmentPars = function (a) {
                this.fragmentPars += a + "\n"
            }, THREE.NodeMaterial.prototype.addVertexCode = function (a) {
                this.vertexCode += a + "\n"
            }, THREE.NodeMaterial.prototype.addFragmentCode = function (a) {
                this.fragmentCode += a + "\n"
            }, THREE.NodeMaterial.prototype.addVertexNode = function (a) {
                this.vertexNode += a + "\n"
            }, THREE.NodeMaterial.prototype.clearVertexNode = function () {
                var a = this.fragmentNode;
                return this.fragmentNode = "", a
            }, THREE.NodeMaterial.prototype.addFragmentNode = function (a) {
                this.fragmentNode += a + "\n"
            }, THREE.NodeMaterial.prototype.clearFragmentNode = function () {
                var a = this.fragmentNode;
                return this.fragmentNode = "", a
            }, THREE.NodeMaterial.prototype.getCodePars = function (a, b) {
                b = b || "";
                for (var c = "", d = 0, e = a.length; e > d; ++d) {
                    var f = a[d].type, g = a[d].name, h = a[d].value;
                    "t" == f && h instanceof THREE.CubeTexture && (f = "tc");
                    var i = THREE.NodeMaterial.types[f];
                    if (void 0 == i)throw new Error("Node pars " + f + " not found.");
                    c += b + " " + i + " " + g + ";\n"
                }
                return c
            }, THREE.NodeMaterial.prototype.createVertexUniform = function (a, b, c, d) {
                var e = this.createUniform(a, b, c, d);
                return this.vertexUniform.push(e), this.vertexUniform[e.name] = e, this.uniforms[e.name] = e, e
            }, THREE.NodeMaterial.prototype.createFragmentUniform = function (a, b, c, d) {
                var e = this.createUniform(a, b, c, d);
                return this.fragmentUniform.push(e), this.fragmentUniform[e.name] = e, this.uniforms[e.name] = e, e
            }, THREE.NodeMaterial.prototype.getDataNode = function (a) {
                return this.nodeData[a] = this.nodeData[a] || {}
            }, THREE.NodeMaterial.prototype.include = function (a, b) {
                var c;
                if (b = "string" == typeof b ? THREE.NodeLib.get(b) : b, b instanceof THREE.FunctionNode) {
                    for (var d = 0; d < b.includes.length; d++)this.include(a, b.includes[d]);
                    c = this.functions[a] = this.functions[a] || []
                } else b instanceof THREE.ConstNode && (c = this.consts[a] = this.consts[a] || []);
                if (void 0 === c[b.name]) {
                    for (var e in b.extensions)this.extensions[e] = !0;
                    c[b.name] = {node: b, deps: 1}, c.push(c[b.name])
                } else++c[b.name].deps
            }, THREE.PhongNodeMaterial = function () {
                this.node = new THREE.PhongNode, THREE.NodeMaterial.call(this, this.node, this.node)
            }, THREE.PhongNodeMaterial.prototype = Object.create(THREE.NodeMaterial.prototype), THREE.PhongNodeMaterial.prototype.constructor = THREE.PhongNodeMaterial, THREE.NodeMaterial.addShortcuts(THREE.PhongNodeMaterial.prototype, "node", ["color", "alpha", "specular", "shininess", "normal", "normalScale", "emissive", "ambient", "light", "shadow", "ao", "environment", "environmentAlpha", "transform"]), THREE.StandardNode = function () {
                THREE.GLNode.call(this), this.color = new THREE.ColorNode(15658734), this.roughness = new THREE.FloatNode(.5), this.metalness = new THREE.FloatNode(.5)
            }, THREE.StandardNode.prototype = Object.create(THREE.GLNode.prototype), THREE.StandardNode.prototype.constructor = THREE.StandardNode, THREE.StandardNode.prototype.build = function (a) {
                var b, c = a.material;
                if (c.define("STANDARD"), c.define("ALPHATEST", "0.0"), c.requestAttrib.light = !0, a.isShader("vertex")) {
                    var d = this.transform ? this.transform.verifyAndBuildCode(a, "v3", "transform") : void 0;
                    c.mergeUniform(THREE.UniformsUtils.merge([THREE.UniformsLib.fog, THREE.UniformsLib.lights])), c.addVertexPars(["varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", THREE.ShaderChunk.common, THREE.ShaderChunk.morphtarget_pars_vertex, THREE.ShaderChunk.skinning_pars_vertex, THREE.ShaderChunk.shadowmap_pars_vertex, THREE.ShaderChunk.logdepthbuf_pars_vertex].join("\n"));
                    var e = [THREE.ShaderChunk.beginnormal_vertex, THREE.ShaderChunk.morphnormal_vertex, THREE.ShaderChunk.skinbase_vertex, THREE.ShaderChunk.skinnormal_vertex, THREE.ShaderChunk.defaultnormal_vertex, "#ifndef FLAT_SHADED", "	vNormal = normalize( transformedNormal );", "#endif", THREE.ShaderChunk.begin_vertex];
                    d && e.push(d.code, "transformed = " + d.result + ";"), e.push(THREE.ShaderChunk.morphtarget_vertex, THREE.ShaderChunk.skinning_vertex, THREE.ShaderChunk.project_vertex, THREE.ShaderChunk.logdepthbuf_vertex, "	vViewPosition = - mvPosition.xyz;", THREE.ShaderChunk.worldpos_vertex, THREE.ShaderChunk.shadowmap_vertex), b = e.join("\n")
                } else {
                    var f = {bias: new THREE.RoughnessToBlinnExponentNode};
                    this.color.verify(a), this.roughness.verify(a), this.metalness.verify(a), this.alpha && this.alpha.verify(a), this.light && this.light.verify(a, "light"), this.ao && this.ao.verify(a), this.ambient && this.ambient.verify(a), this.shadow && this.shadow.verify(a), this.emissive && this.emissive.verify(a), this.normal && this.normal.verify(a), this.normalScale && this.normal && this.normalScale.verify(a), this.environment && this.environment.verify(a, "env", f);
                    var g = this.color.buildCode(a, "c"), h = this.roughness.buildCode(a, "fv1"), i = this.metalness.buildCode(a, "fv1"), j = this.alpha ? this.alpha.buildCode(a, "fv1") : void 0, k = this.light ? this.light.buildCode(a, "v3", "light") : void 0, l = this.ao ? this.ao.buildCode(a, "fv1") : void 0, m = this.ambient ? this.ambient.buildCode(a, "c") : void 0, n = this.shadow ? this.shadow.buildCode(a, "c") : void 0, o = this.emissive ? this.emissive.buildCode(a, "c") : void 0, p = this.normal ? this.normal.buildCode(a, "v3") : void 0, q = this.normalScale && this.normal ? this.normalScale.buildCode(a, "v2") : void 0, r = this.environment ? this.environment.buildCode(a, "c", "env", f) : void 0;
                    c.requestAttrib.transparent = void 0 != j, c.addFragmentPars(["varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", THREE.ShaderChunk.common, THREE.ShaderChunk.fog_pars_fragment, THREE.ShaderChunk.bsdfs, THREE.ShaderChunk.lights_pars, THREE.ShaderChunk.lights_physical_pars_fragment, THREE.ShaderChunk.shadowmap_pars_fragment, THREE.ShaderChunk.logdepthbuf_pars_fragment].join("\n"));
                    var e = [THREE.ShaderChunk.normal_fragment, "	PhysicalMaterial material;", "	material.diffuseColor = vec3( 1.0 );", g.code, "	vec3 diffuseColor = " + g.result + ";", "	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );", THREE.ShaderChunk.logdepthbuf_fragment, h.code, "	float roughnessFactor = " + h.result + ";", i.code, "	float metalnessFactor = " + i.result + ";"];
                    j && e.push(j.code, "if ( " + j.result + " <= ALPHATEST ) discard;"), p && (a.include("perturbNormal2Arb"), e.push(p.code), q && e.push(q.code), e.push("normal = perturbNormal2Arb(-vViewPosition,normal," + p.result + "," + (new THREE.UVNode).build(a, "v2") + "," + (q ? q.result : "vec2( 1.0 )") + ");")), e.push("material.diffuseColor = " + (k ? "vec3( 1.0 )" : "diffuseColor * (1.0 - metalnessFactor)") + ";"), e.push("material.specularRoughness = clamp( roughnessFactor, 0.001, 1.0 );", "material.specularColor = mix( vec3( 0.001 ), diffuseColor, metalnessFactor );", THREE.ShaderChunk.lights_template), k && (e.push(k.code, "reflectedLight.directDiffuse = " + k.result + ";"), e.push("diffuseColor *= 1.0 - metalnessFactor;", "reflectedLight.directDiffuse *= diffuseColor;", "reflectedLight.indirectDiffuse *= diffuseColor;")), l && e.push(l.code, "reflectedLight.indirectDiffuse *= " + l.result + ";"), m && e.push(m.code, "reflectedLight.indirectDiffuse += " + m.result + ";"), n && e.push(n.code, "reflectedLight.directDiffuse *= " + n.result + ";", "reflectedLight.directSpecular *= " + n.result + ";"), o && e.push(o.code, "reflectedLight.directDiffuse += " + o.result + ";"), r && e.push(r.code, "RE_IndirectSpecular(" + r.result + ", geometry, material, reflectedLight );"), e.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"), e.push(THREE.ShaderChunk.linear_to_gamma_fragment, THREE.ShaderChunk.fog_fragment), j ? e.push("gl_FragColor = vec4( outgoingLight, " + j.result + " );") : e.push("gl_FragColor = vec4( outgoingLight, 1.0 );"), b = e.join("\n")
                }
                return b
            }, THREE.StandardNodeMaterial = function () {
                this.node = new THREE.StandardNode, THREE.NodeMaterial.call(this, this.node, this.node)
            }, THREE.StandardNodeMaterial.prototype = Object.create(THREE.NodeMaterial.prototype), THREE.StandardNodeMaterial.prototype.constructor = THREE.StandardNodeMaterial, THREE.NodeMaterial.addShortcuts(THREE.StandardNodeMaterial.prototype, "node", ["color", "alpha", "roughness", "metalness", "normal", "normalScale", "emissive", "ambient", "light", "shadow", "ao", "environment", "transform"]), THREE.TempNode = function (a, b) {
                THREE.GLNode.call(this, a), b = b || {}, this.shared = void 0 !== b.shared ? b.shared : !0, this.unique = void 0 !== b.unique ? b.unique : !1
            }, THREE.TempNode.prototype = Object.create(THREE.GLNode.prototype), THREE.TempNode.prototype.constructor = THREE.TempNode, THREE.TempNode.prototype.build = function (a, b, c, d) {
                var e = a.material;
                if (this.isShared()) {
                    var f = this.isUnique();
                    f && void 0 === this.constructor.uuid && (this.constructor.uuid = THREE.Math.generateUUID()), c = a.getUuid(c || this.getUuid(), !f);
                    var g = e.getDataNode(c);
                    if (a.isShader("verify"))return g.deps ? (this.verifyDepsNode(a, g, b), "") : THREE.GLNode.prototype.build.call(this, a, b, c);
                    if (1 == g.deps)return THREE.GLNode.prototype.build.call(this, a, b, c);
                    var h = this.getTemp(a, c), i = g.output || this.getType(a);
                    if (h)return a.format(h, i, b);
                    h = THREE.TempNode.prototype.generate.call(this, a, b, c, g.output, d);
                    var j = this.generate(a, i, c);
                    return a.isShader("vertex") ? e.addVertexNode(h + "=" + j + ";") : e.addFragmentNode(h + "=" + j + ";"), a.format(h, i, b)
                }
                return a.format(this.generate(a, this.getType(a), c), this.getType(a), b)
            }, THREE.TempNode.prototype.isShared = function () {
                return this.shared
            }, THREE.TempNode.prototype.isUnique = function () {
                return this.unique
            }, THREE.TempNode.prototype.getUuid = function () {
                var a = this.constructor.uuid || this.uuid;
                return "string" == typeof this.scope && (a = this.scope + "-" + a), a
            }, THREE.TempNode.prototype.getTemp = function (a, b) {
                b = b || this.uuid;
                var c = a.material;
                return a.isShader("vertex") && c.vertexTemps[b] ? c.vertexTemps[b].name : c.fragmentTemps[b] ? c.fragmentTemps[b].name : void 0
            }, THREE.TempNode.prototype.generate = function (a, b, c, d, e) {
                return this.isShared() || console.error("THREE.TempNode is not shared!"), c = c || this.uuid, a.isShader("vertex") ? a.material.getVertexTemp(c, d || this.getType(a), e).name : a.material.getFragmentTemp(c, d || this.getType(a), e).name
            }, THREE.CameraNode = function (a, b) {
                THREE.TempNode.call(this, "v3"), this.setScope(a || THREE.CameraNode.POSITION), this.setCamera(b)
            }, THREE.CameraNode.POSITION = "position", THREE.CameraNode.DEPTH = "depth", THREE.CameraNode.TO_VERTEX = "toVertex", THREE.CameraNode.prototype = Object.create(THREE.TempNode.prototype), THREE.CameraNode.prototype.constructor = THREE.CameraNode, THREE.CameraNode.prototype.setCamera = function (a) {
                this.camera = a, this.requestUpdate = void 0 !== a
            }, THREE.CameraNode.prototype.setScope = function (a) {
                switch (this.scope) {
                    case THREE.CameraNode.DEPTH:
                        delete this.near, delete this.far
                }
                switch (this.scope = a, a) {
                    case THREE.CameraNode.DEPTH:
                        this.near = new THREE.FloatNode(camera ? camera.near : 1), this.far = new THREE.FloatNode(camera ? camera.far : 1200)
                }
            }, THREE.CameraNode.prototype.getType = function (a) {
                switch (this.scope) {
                    case THREE.CameraNode.DEPTH:
                        return "fv1"
                }
                return this.type
            }, THREE.CameraNode.prototype.isUnique = function (a) {
                switch (this.scope) {
                    case THREE.CameraNode.DEPTH:
                    case THREE.CameraNode.TO_VERTEX:
                        return !0
                }
                return !1
            }, THREE.CameraNode.prototype.isShared = function (a) {
                switch (this.scope) {
                    case THREE.CameraNode.POSITION:
                        return !1
                }
                return !0
            }, THREE.CameraNode.prototype.generate = function (a, b) {
                var c;
                a.material;
                switch (this.scope) {
                    case THREE.CameraNode.POSITION:
                        c = "cameraPosition";
                        break;
                    case THREE.CameraNode.DEPTH:
                        a.include("depthcolor"), c = "depthcolor(" + this.near.build(a, "fv1") + "," + this.far.build(a, "fv1") + ")";
                        break;
                    case THREE.CameraNode.TO_VERTEX:
                        c = "normalize( " + new THREE.PositionNode(THREE.PositionNode.WORLD).build(a, "v3") + " - cameraPosition )"
                }
                return a.format(c, this.getType(a), b)
            }, THREE.CameraNode.prototype.updateAnimation = function (a) {
                switch (this.scope) {
                    case THREE.CameraNode.DEPTH:
                        this.near.number = camera.near, this.far.number = camera.far
                }
            }, THREE.ColorsNode = function (a) {
                THREE.TempNode.call(this, "v4", {share: !1}), this.index = a || 0
            }, THREE.ColorsNode.vertexDict = ["color", "color2"], THREE.ColorsNode.fragmentDict = ["vColor", "vColor2"], THREE.ColorsNode.prototype = Object.create(THREE.TempNode.prototype), THREE.ColorsNode.prototype.constructor = THREE.ColorsNode, THREE.ColorsNode.prototype.generate = function (a, b) {
                var c, d = a.material;
                return d.requestAttrib.color[this.index] = !0, c = a.isShader("vertex") ? THREE.ColorsNode.vertexDict[this.index] : THREE.ColorsNode.fragmentDict[this.index], a.format(c, this.getType(a), b)
            }, THREE.LightNode = function () {
                THREE.TempNode.call(this, "v3", {shared: !1})
            }, THREE.LightNode.prototype = Object.create(THREE.TempNode.prototype), THREE.LightNode.prototype.constructor = THREE.LightNode, THREE.LightNode.prototype.generate = function (a, b) {
                return a.isCache("light") ? a.format("reflectedLight.directDiffuse", this.getType(a), b) : (console.warn('THREE.LightNode is only compatible in "light" channel.'), a.format("vec3( 0.0 )", this.getType(a), b))
            }, THREE.NormalNode = function (a) {
                THREE.TempNode.call(this, "v3"), this.scope = a || THREE.NormalNode.LOCAL
            }, THREE.NormalNode.LOCAL = "local", THREE.NormalNode.WORLD = "world", THREE.NormalNode.VIEW = "view", THREE.NormalNode.prototype = Object.create(THREE.TempNode.prototype), THREE.NormalNode.prototype.constructor = THREE.NormalNode, THREE.NormalNode.prototype.isShared = function (a) {
                switch (this.scope) {
                    case THREE.NormalNode.WORLD:
                        return !0
                }
                return !1
            }, THREE.NormalNode.prototype.generate = function (a, b) {
                var c, d = a.material;
                switch (this.scope) {
                    case THREE.NormalNode.LOCAL:
                        d.requestAttrib.normal = !0, c = a.isShader("vertex") ? "normal" : "vObjectNormal";
                        break;
                    case THREE.NormalNode.WORLD:
                        d.requestAttrib.worldNormal = !0, c = a.isShader("vertex") ? "( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz" : "vWNormal";
                        break;
                    case THREE.NormalNode.VIEW:
                        c = "vNormal"
                }
                return a.format(c, this.getType(a), b)
            }, THREE.PositionNode = function (a) {
                THREE.TempNode.call(this, "v3"), this.scope = a || THREE.PositionNode.LOCAL
            }, THREE.PositionNode.LOCAL = "local", THREE.PositionNode.WORLD = "world", THREE.PositionNode.VIEW = "view", THREE.PositionNode.PROJECTION = "projection", THREE.PositionNode.prototype = Object.create(THREE.TempNode.prototype), THREE.PositionNode.prototype.constructor = THREE.PositionNode, THREE.PositionNode.prototype.getType = function (a) {
                switch (this.scope) {
                    case THREE.PositionNode.PROJECTION:
                        return "v4"
                }
                return this.type
            }, THREE.PositionNode.prototype.isShared = function (a) {
                switch (this.scope) {
                    case THREE.PositionNode.LOCAL:
                    case THREE.PositionNode.WORLD:
                        return !1
                }
                return !0
            }, THREE.PositionNode.prototype.generate = function (a, b) {
                var c, d = a.material;
                switch (this.scope) {
                    case THREE.PositionNode.LOCAL:
                        d.requestAttrib.position = !0, c = a.isShader("vertex") ? "transformed" : "vPosition";
                        break;
                    case THREE.PositionNode.WORLD:
                        d.requestAttrib.worldPosition = !0, c = (a.isShader("vertex"), "vWPosition");
                        break;
                    case THREE.PositionNode.VIEW:
                        c = a.isShader("vertex") ? "-mvPosition.xyz" : "vViewPosition";
                        break;
                    case THREE.PositionNode.PROJECTION:
                        c = a.isShader("vertex") ? "(projectionMatrix * modelViewMatrix * vec4( position, 1.0 ))" : "vec4( 0.0 )"
                }
                return a.format(c, this.getType(a), b)
            }, THREE.ReflectNode = function (a) {
                THREE.TempNode.call(this, "v3", {unique: !0}), this.scope = a || THREE.ReflectNode.CUBE
            },THREE.ReflectNode.CUBE = "cube",THREE.ReflectNode.SPHERE = "sphere",THREE.ReflectNode.VECTOR = "vector",THREE.ReflectNode.prototype = Object.create(THREE.TempNode.prototype),THREE.ReflectNode.prototype.constructor = THREE.ReflectNode,THREE.ReflectNode.prototype.getType = function (a) {
                switch (this.scope) {
                    case THREE.CameraNode.SPHERE:
                        return "v2"
                }
                return this.type
            },THREE.ReflectNode.prototype.generate = function (a, b) {
                var c;
                switch (this.scope) {
                    case THREE.ReflectNode.VECTOR:
                        a.material.addFragmentNode("vec3 reflectVec = inverseTransformDirection( reflect( -geometry.viewDir, geometry.normal ), viewMatrix );"), c = "reflectVec";
                        break;
                    case THREE.ReflectNode.CUBE:
                        var d = new THREE.ReflectNode(THREE.ReflectNode.VECTOR).build(a, "v3");
                        a.material.addFragmentNode("vec3 reflectCubeVec = vec3( -1.0 * " + d + ".x, " + d + ".yz );"), c = "reflectCubeVec";
                        break;
                    case THREE.ReflectNode.SPHERE:
                        var d = new THREE.ReflectNode(THREE.ReflectNode.VECTOR).build(a, "v3");
                        a.material.addFragmentNode("vec3 reflectSphereVec = normalize((viewMatrix * vec4(" + d + ", 0.0 )).xyz + vec3(0.0,0.0,1.0)).xy * 0.5 + 0.5;"), c = "reflectSphereVec"
                }
                return a.format(c, this.getType(this.type), b)
            },THREE.ScreenUVNode = function (a) {
                THREE.TempNode.call(this, "v2"), this.resolution = a
            },THREE.ScreenUVNode.prototype = Object.create(THREE.TempNode.prototype),THREE.ScreenUVNode.prototype.constructor = THREE.ScreenUVNode,THREE.ScreenUVNode.prototype.generate = function (a, b) {
                var c;
                a.material;
                return a.isShader("fragment") ? c = "(gl_FragCoord.xy/" + this.resolution.build(a, "v2") + ")" : (console.warn("THREE.ScreenUVNode is not compatible with " + a.shader + " shader."), c = "vec2( 0.0 )"), a.format(c, this.getType(a), b)
            },THREE.UVNode = function (a) {
                THREE.TempNode.call(this, "v2", {shared: !1}), this.index = a || 0
            },THREE.UVNode.vertexDict = ["uv", "uv2"],THREE.UVNode.fragmentDict = ["vUv", "vUv2"],THREE.UVNode.prototype = Object.create(THREE.TempNode.prototype),THREE.UVNode.prototype.constructor = THREE.UVNode,THREE.UVNode.prototype.generate = function (a, b) {
                var c, d = a.material;
                return d.requestAttrib.uv[this.index] = !0, c = a.isShader("vertex") ? THREE.UVNode.vertexDict[this.index] : THREE.UVNode.fragmentDict[this.index], a.format(c, this.getType(a), b)
            },THREE.BuilderNode = function (a) {
                this.material = a, this.caches = [], this.isVerify = !1, this.addCache()
            },THREE.BuilderNode.prototype = {
                constructor: THREE.BuilderNode, addCache: function (a, b) {
                    return this.caches.push({name: a || "", requires: b || {}}), this.updateCache()
                }, removeCache: function () {
                    return this.caches.pop(), this.updateCache()
                }, isCache: function (a) {
                    for (var b = this.caches.length; b--;)if (this.caches[b].name == a)return !0;
                    return !1
                }, updateCache: function () {
                    var a = this.caches[this.caches.length - 1];
                    return this.cache = a.name, this.requires = a.requires, this
                }, require: function (a, b) {
                    return this.requires[a] = b, this
                }, include: function (a) {
                    return this.material.include(this.shader, a), this
                }, colorToVector: function (a) {
                    return a.replace("r", "x").replace("g", "y").replace("b", "z").replace("a", "w")
                }, getFormatConstructor: function (a) {
                    return THREE.BuilderNode.constructors[a - 1]
                }, getFormatName: function (a) {
                    return a.replace(/c/g, "v3").replace(/fv1|iv1/g, "v1")
                }, isFormatMatrix: function (a) {
                    return /^m/.test(a)
                }, getFormatLength: function (a) {
                    return parseInt(this.getFormatName(a).substr(1))
                }, getFormatByLength: function (a) {
                    return 1 == a ? "fv1" : "v" + a
                }, format: function (a, b, c) {
                    var d = this.getFormatName(b + "=" + c);
                    switch (d) {
                        case"v1=v2":
                            return "vec2(" + a + ")";
                        case"v1=v3":
                            return "vec3(" + a + ")";
                        case"v1=v4":
                            return "vec4(" + a + ")";
                        case"v2=v1":
                            return a + ".x";
                        case"v2=v3":
                            return "vec3(" + a + ",0.0)";
                        case"v2=v4":
                            return "vec4(" + a + ",0.0,1.0)";
                        case"v3=v1":
                            return a + ".x";
                        case"v3=v2":
                            return a + ".xy";
                        case"v3=v4":
                            return "vec4(" + a + ",1.0)";
                        case"v4=v1":
                            return a + ".x";
                        case"v4=v2":
                            return a + ".xy";
                        case"v4=v3":
                            return a + ".xyz"
                    }
                    return a
                }, getTypeByFormat: function (a) {
                    return THREE.BuilderNode.type[a]
                }, getUuid: function (a, b) {
                    return b = void 0 !== b ? b : !0, b && this.cache && (a = this.cache + "-" + a), a
                }, getElementByIndex: function (a) {
                    return THREE.BuilderNode.elements[a]
                }, getIndexByElement: function (a) {
                    return THREE.BuilderNode.elements.indexOf(a)
                }, isShader: function (a) {
                    return this.shader == a || this.isVerify
                }, setShader: function (a) {
                    return this.shader = a, this
                }
            },THREE.BuilderNode.type = {
                "float": "fv1",
                vec2: "v2",
                vec3: "v3",
                vec4: "v4",
                mat4: "v4"
            },THREE.BuilderNode.constructors = ["", "vec2", "vec3", "vec4"],THREE.BuilderNode.elements = ["x", "y", "z", "w"],THREE.ConstNode = function (a, b) {
                THREE.TempNode.call(this), this.parse(a || THREE.ConstNode.PI, b)
            },THREE.ConstNode.PI = "PI",THREE.ConstNode.PI2 = "PI2",THREE.ConstNode.RECIPROCAL_PI = "RECIPROCAL_PI",THREE.ConstNode.RECIPROCAL_PI2 = "RECIPROCAL_PI2",THREE.ConstNode.LOG2 = "LOG2",THREE.ConstNode.EPSILON = "EPSILON",THREE.ConstNode.prototype = Object.create(THREE.TempNode.prototype),THREE.ConstNode.prototype.constructor = THREE.ConstNode,THREE.ConstNode.prototype.parse = function (a, b) {
                var c, d, e = /^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=(.*?)\;/i, f = a.match(e);
                f && f.length > 1 ? (d = f[1], c = f[2], b ? this.src = "#define " + c + " " + f[3] : this.src = "const " + d + " " + c + " = " + f[3] + ";") : (c = a, d = "fv1"), this.name = c, this.type = d
            },THREE.ConstNode.prototype.generate = function (a, b) {
                return a.format(this.name, this.getType(a), b)
            },THREE.FunctionCallNode = function (a) {
                THREE.TempNode.call(this), this.setFunction(a)
            },THREE.FunctionCallNode.prototype = Object.create(THREE.TempNode.prototype),THREE.FunctionCallNode.prototype.constructor = THREE.FunctionCallNode,THREE.FunctionCallNode.prototype.setFunction = function (a) {
                this.inputs = [], this.value = a
            },THREE.FunctionCallNode.prototype.getFunction = function () {
                return this.value
            },THREE.FunctionCallNode.prototype.getType = function (a) {
                return this.value.getType(a)
            },THREE.FunctionCallNode.prototype.generate = function (a, b) {
                var c = (a.material, this.getType(a)), d = this.value;
                a.include(d);
                for (var e = d.name + "(", f = [], g = 0; g < d.inputs.length; g++) {
                    var h = d.inputs[g], i = this.inputs[g] || this.inputs[h.name];
                    f.push(i.build(a, a.getTypeByFormat(h.type)))
                }
                return e += f.join(",") + ")", a.format(e, c, b)
            },THREE.FunctionNode = function (a, b, c) {
                THREE.GLNode.call(this), this.parse(a || "", b, c)
            },THREE.FunctionNode.prototype = Object.create(THREE.GLNode.prototype),THREE.FunctionNode.prototype.constructor = THREE.FunctionNode,THREE.FunctionNode.prototype.parseReference = function (a) {
                switch (a) {
                    case"uv":
                        return (new THREE.UVNode).name;
                    case"uv2":
                        return new THREE.UVNode(1).name;
                    case"position":
                        return (new THREE.PositionNode).name;
                    case"worldPosition":
                        return new THREE.PositionNode(THREE.PositionNode.WORLD).name;
                    case"normal":
                        return (new THREE.NormalNode).name;
                    case"normalPosition":
                        return new THREE.NormalNode(THREE.NormalNode.WORLD).name;
                    case"viewPosition":
                        return new THREE.PositionNode(THREE.NormalNode.VIEW).name;
                    case"viewNormal":
                        return new THREE.NormalNode(THREE.NormalNode.VIEW).name
                }
                return a
            },THREE.FunctionNode.prototype.getTypeNode = function (a, b) {
                return a.getTypeByFormat(b) || b
            },THREE.FunctionNode.prototype.getInputByName = function (a) {
                for (var b = this.inputs.length; b--;)if (this.inputs[b].name === a)return this.inputs[b]
            },THREE.FunctionNode.prototype.getType = function (a) {
                return this.getTypeNode(a, this.type)
            },THREE.FunctionNode.prototype.getInclude = function (a) {
                for (var b = this.includes.length; b--;)if (this.includes[b].name === a)return this.includes[b];
                return void 0
            },THREE.FunctionNode.prototype.parse = function (a, b, c) {
                var d = /^([a-z_0-9]+)\s([a-z_0-9]+)\s?\((.*?)\)/i, e = /[a-z_0-9]+/gi;
                this.includes = b || [], this.extensions = c || {};
                var f = a.match(d);
                if (this.inputs = [], f && 4 == f.length) {
                    this.type = f[1], this.name = f[2];
                    var g = f[3].match(e);
                    if (g)for (var h = 0; h < g.length;) {
                        var i, j, k = g[h++];
                        "in" == k || "out" == k || "inout" == k ? i = g[h++] : (i = k, k = ""), j = g[h++], this.inputs.push({
                            name: j,
                            type: i,
                            qualifier: k
                        })
                    }
                    for (var f, l = 0; f = e.exec(a);) {
                        var m = f[0], n = this.parseReference(m);
                        m != n && (a = a.substring(0, f.index + l) + n + a.substring(f.index + m.length + l), l += n.length - m.length), void 0 === this.getInclude(n) && THREE.NodeLib.contains(n) && this.includes.push(THREE.NodeLib.get(n))
                    }
                    this.src = a
                } else this.type = "", this.name = ""
            },THREE.InputNode = function (a, b) {
                THREE.TempNode.call(this, a, b)
            },THREE.InputNode.prototype = Object.create(THREE.TempNode.prototype),THREE.InputNode.prototype.constructor = THREE.InputNode,THREE.InputNode.prototype.generate = function (a, b, c, d, e, f) {
                var g = a.material;
                c = a.getUuid(c || this.getUuid()), d = d || this.getType(a);
                var h = g.getDataNode(c);
                return a.isShader("vertex") ? (h.vertex || (h.vertex = g.createVertexUniform(d, this.value, e, f)), a.format(h.vertex.name, d, b)) : (h.fragment || (h.fragment = g.createFragmentUniform(d, this.value, e, f)), a.format(h.fragment.name, d, b))
            },THREE.ColorNode = function (a) {
                THREE.InputNode.call(this, "c", {share: !1}), this.value = new THREE.Color(a || 0)
            },THREE.ColorNode.prototype = Object.create(THREE.InputNode.prototype),THREE.ColorNode.prototype.constructor = THREE.ColorNode,THREE.NodeMaterial.addShortcuts(THREE.ColorNode.prototype, "value", ["r", "g", "b"]),THREE.CubeTextureNode = function (a, b, c) {
                THREE.InputNode.call(this, "v4"), this.value = a, this.coord = b || new THREE.ReflectNode, this.bias = c
            },THREE.CubeTextureNode.prototype = Object.create(THREE.InputNode.prototype),THREE.CubeTextureNode.prototype.constructor = THREE.CubeTextureNode,THREE.CubeTextureNode.prototype.getTexture = function (a, b) {
                return THREE.InputNode.prototype.generate.call(this, a, b, this.value.uuid, "t")
            },THREE.CubeTextureNode.prototype.generate = function (a, b) {
                var c = this.getTexture(a, b), d = this.coord.build(a, "v3"), e = this.bias ? this.bias.build(a, "fv1") : void 0;
                void 0 == e && a.requires.bias && (e = a.requires.bias.build(a, "fv1"));
                var f;
                return f = e ? "texCubeBias(" + c + "," + d + "," + e + ")" : "texCube(" + c + "," + d + ")", a.format(f, this.type, b)
            },THREE.FloatNode = function (a) {
                THREE.InputNode.call(this, "fv1", {share: !1}), this.value = [a || 0]
            },THREE.FloatNode.prototype = Object.create(THREE.InputNode.prototype),THREE.FloatNode.prototype.constructor = THREE.FloatNode,Object.defineProperties(THREE.FloatNode.prototype, {
                number: {
                    get: function () {
                        return this.value[0]
                    }, set: function (a) {
                        this.value[0] = a
                    }
                }
            }),THREE.IntNode = function (a) {
                THREE.InputNode.call(this, "fv1", {share: !1}), this.value = [Math.floor(a || 0)]
            },THREE.IntNode.prototype = Object.create(THREE.InputNode.prototype),THREE.IntNode.prototype.constructor = THREE.IntNode,Object.defineProperties(THREE.IntNode.prototype, {
                number: {
                    get: function () {
                        return this.value[0]
                    }, set: function (a) {
                        this.value[0] = Math.floor(a)
                    }
                }
            }),THREE.Matrix4Node = function (a) {
                THREE.InputNode.call(this, "m4", {share: !1}), this.value = a || new THREE.Matrix4
            },THREE.Matrix4Node.prototype = Object.create(THREE.InputNode.prototype),THREE.Matrix4Node.prototype.constructor = THREE.Matrix4Node,THREE.MirrorNode = function (a, b, c) {
                THREE.TempNode.call(this, "v4"), this.mirror = a instanceof THREE.Mirror ? a : new THREE.Mirror(a, b, c), this.textureMatrix = new THREE.Matrix4Node(this.mirror.textureMatrix), this.worldPosition = new THREE.PositionNode(THREE.PositionNode.WORLD), this.coord = new THREE.OperatorNode(this.textureMatrix, this.worldPosition, THREE.OperatorNode.MUL), this.coordResult = new THREE.OperatorNode(null, this.coord, THREE.OperatorNode.ADD), this.texture = new THREE.TextureNode(this.mirror.texture, this.coord, null, !0)
            },THREE.MirrorNode.prototype = Object.create(THREE.TempNode.prototype),THREE.MirrorNode.prototype.constructor = THREE.MirrorNode,THREE.MirrorNode.prototype.generate = function (a, b) {
                a.material;
                if (a.isShader("fragment")) {
                    this.coordResult.a = this.offset, this.texture.coord = this.offset ? this.coordResult : this.coord;
                    var c = this.texture.build(a, this.type);
                    return a.format(c, this.type, b)
                }
                return console.warn("THREE.MirrorNode is not compatible with " + a.shader + " shader."), a.format("vec4(0.0)", this.type, b)
            },THREE.TextureNode = function (a, b, c, d) {
                THREE.InputNode.call(this, "v4"), this.value = a, this.coord = b || new THREE.UVNode, this.bias = c, this.project = void 0 !== d ? d : !1
            },THREE.TextureNode.prototype = Object.create(THREE.InputNode.prototype),THREE.TextureNode.prototype.constructor = THREE.TextureNode,THREE.TextureNode.prototype.getTexture = function (a, b) {
                return THREE.InputNode.prototype.generate.call(this, a, b, this.value.uuid, "t")
            },THREE.TextureNode.prototype.generate = function (a, b) {
                var c = this.getTexture(a, b), d = this.coord.build(a, this.project ? "v4" : "v2"), e = this.bias ? this.bias.build(a, "fv1") : void 0;
                void 0 == e && a.requires.bias && (e = a.requires.bias.build(a, "fv1"));
                var f, g;
                return f = this.project ? "texture2DProj" : e ? "tex2DBias" : "tex2D", g = e ? f + "(" + c + "," + d + "," + e + ")" : f + "(" + c + "," + d + ")", a.format(g, this.type, b)
            },THREE.ScreenNode = function (a) {
                THREE.TextureNode.call(this, void 0, a)
            },THREE.ScreenNode.prototype = Object.create(THREE.TextureNode.prototype),THREE.ScreenNode.prototype.constructor = THREE.ScreenNode,THREE.ScreenNode.prototype.isUnique = function () {
                return !0
            },THREE.ScreenNode.prototype.getTexture = function (a, b) {
                return THREE.InputNode.prototype.generate.call(this, a, b, this.getUuid(), "t", "renderTexture")
            },THREE.Vector2Node = function (a, b) {
                THREE.InputNode.call(this, "v2", {share: !1}), this.value = new THREE.Vector2(a, b)
            },THREE.Vector2Node.prototype = Object.create(THREE.InputNode.prototype),THREE.Vector2Node.prototype.constructor = THREE.Vector2Node,THREE.NodeMaterial.addShortcuts(THREE.Vector2Node.prototype, "value", ["x", "y"]),THREE.Vector3Node = function (a, b, c) {
                THREE.InputNode.call(this, "v3", {share: !1}), this.type = "v3", this.value = new THREE.Vector3(a, b, c)
            },THREE.Vector3Node.prototype = Object.create(THREE.InputNode.prototype),THREE.Vector3Node.prototype.constructor = THREE.Vector3Node,THREE.NodeMaterial.addShortcuts(THREE.Vector3Node.prototype, "value", ["x", "y", "z"]),THREE.Vector4Node = function (a, b, c, d) {
                THREE.InputNode.call(this, "v4", {share: !1}), this.value = new THREE.Vector4(a, b, c, d)
            },THREE.Vector4Node.prototype = Object.create(THREE.InputNode.prototype),THREE.Vector4Node.prototype.constructor = THREE.Vector4Node,THREE.NodeMaterial.addShortcuts(THREE.Vector4Node.prototype, "value", ["x", "y", "z", "w"]),THREE.PhongNode = function () {
                THREE.GLNode.call(this), this.color = new THREE.ColorNode(15658734), this.specular = new THREE.ColorNode(1118481), this.shininess = new THREE.FloatNode(30)
            },THREE.PhongNode.prototype = Object.create(THREE.GLNode.prototype),THREE.PhongNode.prototype.constructor = THREE.PhongNode,THREE.PhongNode.prototype.build = function (a) {
                var b, c = a.material;
                if (c.define("PHONG"), c.define("ALPHATEST", "0.0"), c.requestAttrib.light = !0, a.isShader("vertex")) {
                    var d = this.transform ? this.transform.verifyAndBuildCode(a, "v3", "transform") : void 0;
                    c.mergeUniform(THREE.UniformsUtils.merge([THREE.UniformsLib.fog, THREE.UniformsLib.ambient, THREE.UniformsLib.lights])), c.addVertexPars(["varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", THREE.ShaderChunk.common, THREE.ShaderChunk.morphtarget_pars_vertex, THREE.ShaderChunk.skinning_pars_vertex, THREE.ShaderChunk.shadowmap_pars_vertex, THREE.ShaderChunk.logdepthbuf_pars_vertex].join("\n"));
                    var e = [THREE.ShaderChunk.beginnormal_vertex, THREE.ShaderChunk.morphnormal_vertex, THREE.ShaderChunk.skinbase_vertex, THREE.ShaderChunk.skinnormal_vertex, THREE.ShaderChunk.defaultnormal_vertex, "#ifndef FLAT_SHADED", "	vNormal = normalize( transformedNormal );", "#endif", THREE.ShaderChunk.begin_vertex];
                    d && e.push(d.code, "transformed = " + d.result + ";"), e.push(THREE.ShaderChunk.morphtarget_vertex, THREE.ShaderChunk.skinning_vertex, THREE.ShaderChunk.project_vertex, THREE.ShaderChunk.logdepthbuf_vertex, "	vViewPosition = - mvPosition.xyz;", THREE.ShaderChunk.worldpos_vertex, THREE.ShaderChunk.shadowmap_vertex), b = e.join("\n")
                } else {
                    this.color.verify(a), this.specular.verify(a), this.shininess.verify(a), this.alpha && this.alpha.verify(a), this.light && this.light.verify(a, "light"), this.ao && this.ao.verify(a), this.ambient && this.ambient.verify(a), this.shadow && this.shadow.verify(a), this.emissive && this.emissive.verify(a), this.normal && this.normal.verify(a), this.normalScale && this.normal && this.normalScale.verify(a), this.environment && this.environment.verify(a), this.environmentAlpha && this.environment && this.environmentAlpha.verify(a);
                    var f = this.color.buildCode(a, "c"), g = this.specular.buildCode(a, "c"), h = this.shininess.buildCode(a, "fv1"), i = this.alpha ? this.alpha.buildCode(a, "fv1") : void 0, j = this.light ? this.light.buildCode(a, "v3", "light") : void 0, k = this.ao ? this.ao.buildCode(a, "fv1") : void 0, l = this.ambient ? this.ambient.buildCode(a, "c") : void 0, m = this.shadow ? this.shadow.buildCode(a, "c") : void 0, n = this.emissive ? this.emissive.buildCode(a, "c") : void 0, o = this.normal ? this.normal.buildCode(a, "v3") : void 0, p = this.normalScale && this.normal ? this.normalScale.buildCode(a, "v2") : void 0, q = this.environment ? this.environment.buildCode(a, "c") : void 0, r = this.environmentAlpha && this.environment ? this.environmentAlpha.buildCode(a, "fv1") : void 0;
                    c.requestAttrib.transparent = void 0 != i, c.addFragmentPars([THREE.ShaderChunk.common, THREE.ShaderChunk.fog_pars_fragment, THREE.ShaderChunk.bsdfs, THREE.ShaderChunk.ambient_pars, THREE.ShaderChunk.lights_pars, THREE.ShaderChunk.lights_phong_pars_fragment, THREE.ShaderChunk.shadowmap_pars_fragment, THREE.ShaderChunk.logdepthbuf_pars_fragment].join("\n"));
                    var e = [THREE.ShaderChunk.normal_fragment, "	BlinnPhongMaterial material;", f.code, "	vec3 diffuseColor = " + f.result + ";", "	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );", THREE.ShaderChunk.logdepthbuf_fragment, g.code, "	vec3 specular = " + g.result + ";", h.code, "	float shininess = max(0.0001," + h.result + ");", "	float specularStrength = 1.0;"];
                    i && e.push(i.code, "if ( " + i.result + " <= ALPHATEST ) discard;"), o && (a.include("perturbNormal2Arb"), e.push(o.code), p && e.push(p.code), e.push("normal = perturbNormal2Arb(-vViewPosition,normal," + o.result + "," + (new THREE.UVNode).build(a, "v2") + "," + (p ? p.result : "vec2( 1.0 )") + ");")), e.push("material.diffuseColor = " + (j ? "vec3( 1.0 )" : "diffuseColor") + ";"), e.push("material.specularColor = specular;", "material.specularShininess = shininess;", "material.specularStrength = specularStrength;", THREE.ShaderChunk.lights_template), j && (e.push(j.code, "reflectedLight.directDiffuse = " + j.result + ";"), e.push("reflectedLight.directDiffuse *= diffuseColor;", "reflectedLight.indirectDiffuse *= diffuseColor;")), k && e.push(k.code, "reflectedLight.indirectDiffuse *= " + k.result + ";"), l && e.push(l.code, "reflectedLight.indirectDiffuse += " + l.result + ";"), m && e.push(m.code, "reflectedLight.directDiffuse *= " + m.result + ";", "reflectedLight.directSpecular *= " + m.result + ";"), n && e.push(n.code, "reflectedLight.directDiffuse += " + n.result + ";"), e.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"), q && (e.push(q.code), r ? e.push(r.code, "outgoingLight = mix(outgoingLight," + q.result + "," + r.result + ");") : e.push("outgoingLight = " + q.result + ";")), e.push(THREE.ShaderChunk.linear_to_gamma_fragment, THREE.ShaderChunk.fog_fragment), i ? e.push("gl_FragColor = vec4( outgoingLight, " + i.result + " );") : e.push("gl_FragColor = vec4( outgoingLight, 1.0 );"), b = e.join("\n")
                }
                return b
            },THREE.PhongNodeMaterial = function () {
                this.node = new THREE.PhongNode, THREE.NodeMaterial.call(this, this.node, this.node)
            },THREE.PhongNodeMaterial.prototype = Object.create(THREE.NodeMaterial.prototype),THREE.PhongNodeMaterial.prototype.constructor = THREE.PhongNodeMaterial,THREE.NodeMaterial.addShortcuts(THREE.PhongNodeMaterial.prototype, "node", ["color", "alpha", "specular", "shininess", "normal", "normalScale", "emissive", "ambient", "light", "shadow", "ao", "environment", "environmentAlpha", "transform"]),THREE.StandardNode = function () {
                THREE.GLNode.call(this), this.color = new THREE.ColorNode(15658734), this.roughness = new THREE.FloatNode(.5), this.metalness = new THREE.FloatNode(.5)
            },THREE.StandardNode.prototype = Object.create(THREE.GLNode.prototype),THREE.StandardNode.prototype.constructor = THREE.StandardNode,THREE.StandardNode.prototype.build = function (a) {
                var b, c = a.material;
                if (c.define("PHYSICAL"), c.define("ALPHATEST", "0.0"), c.requestAttrib.light = !0, a.isShader("vertex")) {
                    var d = this.transform ? this.transform.verifyAndBuildCode(a, "v3", "transform") : void 0;
                    c.mergeUniform(THREE.UniformsUtils.merge([THREE.UniformsLib.fog, THREE.UniformsLib.ambient, THREE.UniformsLib.lights])), c.addVertexPars(["varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", THREE.ShaderChunk.common, THREE.ShaderChunk.morphtarget_pars_vertex, THREE.ShaderChunk.skinning_pars_vertex, THREE.ShaderChunk.shadowmap_pars_vertex, THREE.ShaderChunk.logdepthbuf_pars_vertex].join("\n"));
                    var e = [THREE.ShaderChunk.beginnormal_vertex, THREE.ShaderChunk.morphnormal_vertex, THREE.ShaderChunk.skinbase_vertex, THREE.ShaderChunk.skinnormal_vertex, THREE.ShaderChunk.defaultnormal_vertex, "#ifndef FLAT_SHADED", "	vNormal = normalize( transformedNormal );", "#endif", THREE.ShaderChunk.begin_vertex];
                    d && e.push(d.code, "transformed = " + d.result + ";"), e.push(THREE.ShaderChunk.morphtarget_vertex, THREE.ShaderChunk.skinning_vertex, THREE.ShaderChunk.project_vertex, THREE.ShaderChunk.logdepthbuf_vertex, "	vViewPosition = - mvPosition.xyz;", THREE.ShaderChunk.worldpos_vertex, THREE.ShaderChunk.shadowmap_vertex), b = e.join("\n")
                } else {
                    var f = {bias: new THREE.RoughnessToBlinnExponentNode};
                    this.color.verify(a), this.roughness.verify(a), this.metalness.verify(a), this.alpha && this.alpha.verify(a), this.light && this.light.verify(a, "light"), this.ao && this.ao.verify(a), this.ambient && this.ambient.verify(a), this.shadow && this.shadow.verify(a), this.emissive && this.emissive.verify(a), this.normal && this.normal.verify(a), this.normalScale && this.normal && this.normalScale.verify(a), this.environment && this.environment.verify(a, "env", f);
                    var g = this.color.buildCode(a, "c"), h = this.roughness.buildCode(a, "fv1"), i = this.metalness.buildCode(a, "fv1"), j = this.reflectivity ? this.reflectivity.buildCode(a, "fv1") : void 0, k = this.alpha ? this.alpha.buildCode(a, "fv1") : void 0, l = this.light ? this.light.buildCode(a, "v3", "light") : void 0, m = this.ao ? this.ao.buildCode(a, "fv1") : void 0, n = this.ambient ? this.ambient.buildCode(a, "c") : void 0, o = this.shadow ? this.shadow.buildCode(a, "c") : void 0, p = this.emissive ? this.emissive.buildCode(a, "c") : void 0, q = this.normal ? this.normal.buildCode(a, "v3") : void 0, r = this.normalScale && this.normal ? this.normalScale.buildCode(a, "v2") : void 0, s = this.environment ? this.environment.buildCode(a, "c", "env", f) : void 0;
                    c.requestAttrib.transparent = void 0 != k, c.addFragmentPars(["varying vec3 vViewPosition;", "#ifndef FLAT_SHADED", "	varying vec3 vNormal;", "#endif", THREE.ShaderChunk.common, THREE.ShaderChunk.fog_pars_fragment, THREE.ShaderChunk.bsdfs, THREE.ShaderChunk.lights_pars, THREE.ShaderChunk.lights_physical_pars_fragment, THREE.ShaderChunk.shadowmap_pars_fragment, THREE.ShaderChunk.logdepthbuf_pars_fragment].join("\n"));
                    var e = [THREE.ShaderChunk.normal_fragment, "	PhysicalMaterial material;", "	material.diffuseColor = vec3( 1.0 );", g.code, "	vec3 diffuseColor = " + g.result + ";", "	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );", THREE.ShaderChunk.logdepthbuf_fragment, h.code, "	float roughnessFactor = " + h.result + ";", i.code, "	float metalnessFactor = " + i.result + ";"];
                    k && e.push(k.code, "if ( " + k.result + " <= ALPHATEST ) discard;"), q && (a.include("perturbNormal2Arb"), e.push(q.code), r && e.push(r.code), e.push("normal = perturbNormal2Arb(-vViewPosition,normal," + q.result + "," + (new THREE.UVNode).build(a, "v2") + "," + (r ? r.result : "vec2( 1.0 )") + ");")), e.push("material.diffuseColor = " + (l ? "vec3( 1.0 )" : "diffuseColor * (1.0 - metalnessFactor)") + ";"), e.push("material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"), j ? e.push("material.specularColor = mix( vec3( 0.16 * pow2( " + j.builder(a, "fv1") + " ) ), diffuseColor, metalnessFactor );") : e.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"), e.push(THREE.ShaderChunk.lights_template), l && (e.push(l.code, "reflectedLight.directDiffuse = " + l.result + ";"), e.push("diffuseColor *= 1.0 - metalnessFactor;", "reflectedLight.directDiffuse *= diffuseColor;", "reflectedLight.indirectDiffuse *= diffuseColor;")), m && e.push(m.code, "reflectedLight.indirectDiffuse *= " + m.result + ";"), n && e.push(n.code, "reflectedLight.indirectDiffuse += " + n.result + ";"), o && e.push(o.code, "reflectedLight.directDiffuse *= " + o.result + ";", "reflectedLight.directSpecular *= " + o.result + ";"), p && e.push(p.code, "reflectedLight.directDiffuse += " + p.result + ";"), s && e.push(s.code, "RE_IndirectSpecular(" + s.result + ", geometry, material, reflectedLight );"), e.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"), e.push(THREE.ShaderChunk.linear_to_gamma_fragment, THREE.ShaderChunk.fog_fragment), k ? e.push("gl_FragColor = vec4( outgoingLight, " + k.result + " );") : e.push("gl_FragColor = vec4( outgoingLight, 1.0 );"), b = e.join("\n")
                }
                return b
            },THREE.StandardNodeMaterial = function () {
                this.node = new THREE.StandardNode, THREE.NodeMaterial.call(this, this.node, this.node)
            },THREE.StandardNodeMaterial.prototype = Object.create(THREE.NodeMaterial.prototype),THREE.StandardNodeMaterial.prototype.constructor = THREE.StandardNodeMaterial,THREE.NodeMaterial.addShortcuts(THREE.StandardNodeMaterial.prototype, "node", ["color", "alpha", "roughness", "metalness", "normal", "normalScale", "emissive", "ambient", "light", "shadow", "ao", "environment", "transform"]),THREE.Math1Node = function (a, b) {
                THREE.TempNode.call(this), this.a = a, this.method = b || THREE.Math1Node.SIN
            },THREE.Math1Node.RAD = "radians",THREE.Math1Node.DEG = "degrees",THREE.Math1Node.EXP = "exp",THREE.Math1Node.EXP2 = "exp2",THREE.Math1Node.LOG = "log",THREE.Math1Node.LOG2 = "log2",THREE.Math1Node.SQRT = "sqrt",THREE.Math1Node.INV_SQRT = "inversesqrt",THREE.Math1Node.FLOOR = "floor",THREE.Math1Node.CEIL = "ceil",THREE.Math1Node.NORMALIZE = "normalize",THREE.Math1Node.FRACT = "fract",THREE.Math1Node.SAT = "saturate",THREE.Math1Node.SIN = "sin",THREE.Math1Node.COS = "cos",THREE.Math1Node.TAN = "tan",THREE.Math1Node.ASIN = "asin",THREE.Math1Node.ACOS = "acos",THREE.Math1Node.ARCTAN = "atan",THREE.Math1Node.ABS = "abs",THREE.Math1Node.SIGN = "sign",THREE.Math1Node.LENGTH = "length",THREE.Math1Node.NEGATE = "negate",THREE.Math1Node.INVERT = "invert",THREE.Math1Node.prototype = Object.create(THREE.TempNode.prototype),THREE.Math1Node.prototype.constructor = THREE.Math1Node,THREE.Math1Node.prototype.getType = function (a) {
                switch (this.method) {
                    case THREE.Math1Node.LENGTH:
                        return "fv1"
                }
                return this.a.getType(a)
            },THREE.Math1Node.prototype.generate = function (a, b) {
                var c = (a.material, this.getType(a)), d = this.a.build(a, c);
                switch (this.method) {
                    case THREE.Math1Node.NEGATE:
                        d = "(-" + d + ")";
                        break;
                    case THREE.Math1Node.INVERT:
                        d = "(1.0-" + d + ")";
                        break;
                    default:
                        d = this.method + "(" + d + ")"
                }
                return a.format(d, c, b)
            },THREE.Math2Node = function (a, b, c) {
                THREE.TempNode.call(this), this.a = a, this.b = b, this.method = c || THREE.Math2Node.DISTANCE
            },THREE.Math2Node.MIN = "min",THREE.Math2Node.MAX = "max",THREE.Math2Node.MOD = "mod",THREE.Math2Node.STEP = "step",THREE.Math2Node.REFLECT = "reflect",THREE.Math2Node.DISTANCE = "distance",THREE.Math2Node.DOT = "dot",THREE.Math2Node.CROSS = "cross",THREE.Math2Node.POW = "pow",THREE.Math2Node.prototype = Object.create(THREE.TempNode.prototype),THREE.Math2Node.prototype.constructor = THREE.Math2Node,THREE.Math2Node.prototype.getInputType = function (a) {
                return a.getFormatLength(this.b.getType(a)) > a.getFormatLength(this.a.getType(a)) ? this.b.getType(a) : this.a.getType(a)
            },THREE.Math2Node.prototype.getType = function (a) {
                switch (this.method) {
                    case THREE.Math2Node.DISTANCE:
                    case THREE.Math2Node.DOT:
                        return "fv1";
                    case THREE.Math2Node.CROSS:
                        return "v3"
                }
                return this.getInputType(a)
            },THREE.Math2Node.prototype.generate = function (a, b) {
                var c, d, e = (a.material, this.getInputType(a)), f = a.getFormatLength(this.a.getType(a)), g = a.getFormatLength(this.b.getType(a));
                switch (this.method) {
                    case THREE.Math2Node.CROSS:
                        c = this.a.build(a, "v3"), d = this.b.build(a, "v3");
                        break;
                    case THREE.Math2Node.STEP:
                        c = this.a.build(a, 1 == f ? "fv1" : e), d = this.b.build(a, e);
                        break;
                    case THREE.Math2Node.MIN:
                    case THREE.Math2Node.MAX:
                    case THREE.Math2Node.MOD:
                        c = this.a.build(a, e), d = this.b.build(a, 1 == g ? "fv1" : e);
                        break;
                    default:
                        c = this.a.build(a, e), d = this.b.build(a, e)
                }
                return a.format(this.method + "(" + c + "," + d + ")", this.getType(a), b)
            },THREE.Math3Node = function (a, b, c, d) {
                THREE.TempNode.call(this), this.a = a, this.b = b, this.c = c, this.method = d || THREE.Math3Node.MIX
            },THREE.Math3Node.MIX = "mix",THREE.Math3Node.REFRACT = "refract",THREE.Math3Node.SMOOTHSTEP = "smoothstep",THREE.Math3Node.FACEFORWARD = "faceforward",THREE.Math3Node.prototype = Object.create(THREE.TempNode.prototype),THREE.Math3Node.prototype.constructor = THREE.Math3Node,THREE.Math3Node.prototype.getType = function (a) {
                var b = a.getFormatLength(this.a.getType(a)), c = a.getFormatLength(this.b.getType(a)), d = a.getFormatLength(this.c.getType(a));
                return b > c ? b > d ? this.a.getType(a) : this.c.getType(a) : c > d ? this.b.getType(a) : this.c.getType(a)
            },THREE.Math3Node.prototype.generate = function (a, b) {
                var c, d, e, f = (a.material, this.getType(a)), g = (a.getFormatLength(this.a.getType(a)), a.getFormatLength(this.b.getType(a)), a.getFormatLength(this.c.getType(a)));
                switch (this.method) {
                    case THREE.Math3Node.REFRACT:
                        c = this.a.build(a, f), d = this.b.build(a, f), e = this.c.build(a, "fv1");
                        break;
                    case THREE.Math3Node.MIX:
                        c = this.a.build(a, f), d = this.b.build(a, f), e = this.c.build(a, 1 == g ? "fv1" : f);
                        break;
                    default:
                        c = this.a.build(a, f), d = this.b.build(a, f), e = this.c.build(a, f)
                }
                return a.format(this.method + "(" + c + "," + d + "," + e + ")", f, b)
            },THREE.OperatorNode = function (a, b, c) {
                THREE.TempNode.call(this), this.a = a, this.b = b, this.op = c || THREE.OperatorNode.ADD
            },THREE.OperatorNode.ADD = "+",THREE.OperatorNode.SUB = "-",THREE.OperatorNode.MUL = "*",THREE.OperatorNode.DIV = "/",THREE.OperatorNode.prototype = Object.create(THREE.TempNode.prototype),THREE.OperatorNode.prototype.constructor = THREE.OperatorNode,THREE.OperatorNode.prototype.getType = function (a) {
                var b = this.a.getType(a), c = this.b.getType(a);
                return a.isFormatMatrix(b) ? "v4" : a.getFormatLength(c) > a.getFormatLength(b) ? c : b
            },THREE.OperatorNode.prototype.generate = function (a, b) {
                var c = a.material, d = (c.getDataNode(this.uuid), this.getType(a)), e = this.a.build(a, d), f = this.b.build(a, d);
                return a.format("(" + e + this.op + f + ")", d, b)
            },THREE.NodeLib = {
                nodes: {}, add: function (a) {
                    this.nodes[a.name] = a
                }, remove: function (a) {
                    delete this.nodes[a.name]
                }, get: function (a) {
                    return this.nodes[a]
                }, contains: function (a) {
                    return void 0 != this.nodes[a]
                }
            },THREE.NodeLib.add(new THREE.ConstNode("vec3 LUMA = vec3(0.2125, 0.7154, 0.0721);")),THREE.NodeLib.add(new THREE.FunctionNode(["float depthcolor( float mNear, float mFar ) {", "#ifdef USE_LOGDEPTHBUF_EXT", "float depth = gl_FragDepthEXT / gl_FragCoord.w;", "#else", "float depth = gl_FragCoord.z / gl_FragCoord.w;", "#endif", "return 1.0 - smoothstep( mNear, mFar, depth );", "}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 scale ) {", "vec3 q0 = dFdx( eye_pos );", "vec3 q1 = dFdy( eye_pos );", "vec2 st0 = dFdx( mUv.st );", "vec2 st1 = dFdy( mUv.st );", "vec3 S = normalize( q0 * st1.t - q1 * st0.t );", "vec3 T = normalize( -q0 * st1.s + q1 * st0.s );", "vec3 N = normalize( surf_norm );", "vec3 mapN = map * 2.0 - 1.0;", "mapN.xy = scale * mapN.xy;", "mat3 tsn = mat3( S, T, N );", "return normalize( tsn * mapN );", "}"].join("\n"), null, {derivatives: !0})),THREE.NodeLib.add(new THREE.FunctionNode(["float snoise(vec2 co) {", "return fract( sin( dot(co.xy, vec2(12.9898,78.233) ) ) * 43758.5453 );", "}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 hue_rgb(vec3 rgb, float adjustment) {", "const mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);", "const mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);", "vec3 yiq = RGBtoYIQ * rgb;", "float hue = atan(yiq.z, yiq.y) + adjustment;", "float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);", "return YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));", "}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 saturation_rgb(vec3 rgb, float adjustment) {", "vec3 intensity = vec3(dot(rgb, LUMA));", "return mix(intensity, rgb, adjustment);", "}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["float luminance_rgb(vec3 rgb) {", "return dot(rgb, LUMA);", "}"].join("\n"))),THREE.NodeLib.add(new THREE.FunctionNode(["vec3 vibrance_rgb(vec3 rgb, float adjustment) {", "float average = (rgb.r + rgb.g + rgb.b) / 3.0;", "float mx = max(rgb.r, max(rgb.g, rgb.b));", "float amt = (mx - average) * (-3.0 * adjustment);", "return mix(rgb.rgb, vec3(mx), amt);", "}"].join("\n"))),THREE.ShaderPass && (THREE.NodePass = function () {
                THREE.ShaderPass.call(this), this.textureID = "renderTexture", this.fragment = new THREE.RawNode(new THREE.ScreenNode), this.node = new THREE.NodeMaterial, this.node.fragment = this.fragment, this.build()
            }, THREE.NodePass.prototype = Object.create(THREE.ShaderPass.prototype), THREE.NodePass.prototype.constructor = THREE.NodePass, THREE.NodeMaterial.addShortcuts(THREE.NodePass.prototype, "fragment", ["value"]), THREE.NodePass.prototype.build = function () {
                this.node.build(), this.uniforms = this.node.uniforms, this.material = this.node
            }),THREE.RawNode = function (a) {
                THREE.GLNode.call(this, "v4"), this.value = a
            },THREE.RawNode.prototype = Object.create(THREE.GLNode.prototype),THREE.RawNode.prototype.constructor = THREE.RawNode,THREE.GLNode.prototype.generate = function (a) {
                var b = (a.material, this.value.verifyAndBuildCode(a, this.type)), c = b.code + "\n";
                return c += "vertex" == a.shader ? "gl_Position = " + b.result + ";" : "gl_FragColor = " + b.result + ";"
            },THREE.ColorAdjustmentNode = function (a, b, c) {
                THREE.TempNode.call(this, "v3"), this.rgb = a, this.adjustment = b, this.method = c || THREE.ColorAdjustmentNode.SATURATION
            },THREE.ColorAdjustmentNode.SATURATION = "saturation",THREE.ColorAdjustmentNode.HUE = "hue",THREE.ColorAdjustmentNode.VIBRANCE = "vibrance",THREE.ColorAdjustmentNode.BRIGHTNESS = "brightness",THREE.ColorAdjustmentNode.CONTRAST = "contrast",THREE.ColorAdjustmentNode.prototype = Object.create(THREE.TempNode.prototype),THREE.ColorAdjustmentNode.prototype.constructor = THREE.ColorAdjustmentNode,THREE.ColorAdjustmentNode.prototype.generate = function (a, b) {
                var c, d = this.rgb.build(a, "v3"), e = this.adjustment.build(a, "fv1");
                switch (this.method) {
                    case THREE.ColorAdjustmentNode.SATURATION:
                        c = "saturation_rgb";
                        break;
                    case THREE.ColorAdjustmentNode.HUE:
                        c = "hue_rgb";
                        break;
                    case THREE.ColorAdjustmentNode.VIBRANCE:
                        c = "vibrance_rgb";
                        break;
                    case THREE.ColorAdjustmentNode.BRIGHTNESS:
                        return a.format("(" + d + "+" + e + ")", this.getType(a), b);
                    case THREE.ColorAdjustmentNode.CONTRAST:
                        return a.format("(" + d + "*" + e + ")", this.getType(a), b)
                }
                return a.include(c), a.format(c + "(" + d + "," + e + ")", this.getType(a), b)
            },THREE.JoinNode = function (a, b, c, d) {
                THREE.TempNode.call(this, "fv1"), this.x = a, this.y = b, this.z = c, this.w = d
            },THREE.JoinNode.inputs = ["x", "y", "z", "w"],THREE.JoinNode.prototype = Object.create(THREE.TempNode.prototype),THREE.JoinNode.prototype.constructor = THREE.JoinNode,THREE.JoinNode.prototype.getNumElements = function () {
                for (var a = THREE.JoinNode.inputs, b = a.length; b--;)if (void 0 !== this[a[b]]) {
                    ++b;
                    break
                }
                return Math.max(b, 2)
            },THREE.JoinNode.prototype.getType = function (a) {
                return a.getFormatByLength(this.getNumElements())
            },THREE.JoinNode.prototype.generate = function (a, b) {
                for (var c = (a.material, this.getType(a)), d = this.getNumElements(), e = THREE.JoinNode.inputs, f = [], g = 0; d > g; g++) {
                    var h = this[e[g]];
                    f.push(h ? h.build(a, "fv1") : "0.")
                }
                var i = a.getFormatConstructor(d) + "(" + f.join(",") + ")";
                return a.format(i, c, b)
            },THREE.LuminanceNode = function (a) {
                THREE.TempNode.call(this, "fv1"), this.rgb = a
            },THREE.LuminanceNode.prototype = Object.create(THREE.TempNode.prototype),THREE.LuminanceNode.prototype.constructor = THREE.LuminanceNode,THREE.LuminanceNode.prototype.generate = function (a, b) {
                return a.include("luminance_rgb"), a.format("luminance_rgb(" + this.rgb.build(a, "v3") + ")", this.getType(a), b)
            },THREE.NoiseNode = function (a) {
                THREE.TempNode.call(this, "fv1"), this.coord = a
            },THREE.NoiseNode.prototype = Object.create(THREE.TempNode.prototype),THREE.NoiseNode.prototype.constructor = THREE.NoiseNode,THREE.NoiseNode.prototype.generate = function (a, b) {
                return a.include("snoise"), a.format("snoise(" + this.coord.build(a, "v2") + ")", this.getType(a), b)
            },THREE.NormalMapNode = function (a, b, c, d, e) {
                THREE.TempNode.call(this, "v3"), this.value = a, this.scale = c || new THREE.FloatNode(1), this.normal = d || new THREE.NormalNode(THREE.NormalNode.LOCAL), this.position = e || new THREE.PositionNode(THREE.NormalNode.VIEW)
            },THREE.NormalMapNode.prototype = Object.create(THREE.TempNode.prototype),THREE.NormalMapNode.prototype.constructor = THREE.NormalMapNode,THREE.NormalMapNode.prototype.generate = function (a, b) {
                a.material;
                return a.include("perturbNormal2Arb"), a.isShader("fragment") ? a.format("perturbNormal2Arb(-" + this.position.build(a, "v3") + "," + this.normal.build(a, "v3") + "," + this.value.build(a, "v3") + "," + this.value.coord.build(a, "v2") + "," + this.scale.build(a, "v2") + ")", this.getType(a), b) : (console.warn("THREE.NormalMapNode is not compatible with " + a.shader + " shader."), a.format("vec3( 0.0 )", this.getType(a), b))
            },THREE.ResolutionNode = function (a) {
                THREE.Vector2Node.call(this), this.requestUpdate = !0, this.renderer = a
            },THREE.ResolutionNode.prototype = Object.create(THREE.Vector2Node.prototype),THREE.ResolutionNode.prototype.constructor = THREE.ResolutionNode,THREE.ResolutionNode.prototype.updateAnimation = function (a) {
                var b = this.renderer.getSize();
                this.x = b.width, this.y = b.height
            },THREE.RoughnessToBlinnExponentNode = function () {
                THREE.TempNode.call(this, "fv1")
            },THREE.RoughnessToBlinnExponentNode.getSpecularMIPLevel = new THREE.FunctionNode(["float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {", "float maxMIPLevelScalar = float( maxMIPLevel );", "float desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );", "return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );", "}"].join("\n")),THREE.RoughnessToBlinnExponentNode.prototype = Object.create(THREE.TempNode.prototype),THREE.RoughnessToBlinnExponentNode.prototype.constructor = THREE.RoughnessToBlinnExponentNode,THREE.RoughnessToBlinnExponentNode.prototype.generate = function (a, b) {
                var c = a.material;
                return a.isShader("fragment") ? c.isDefined("PHYSICAL") ? (a.include(THREE.RoughnessToBlinnExponentNode.getSpecularMIPLevel), a.format("getSpecularMIPLevel( Material_BlinnShininessExponent( material ), 8 )", this.type, b)) : (console.warn("THREE.RoughnessToBlinnExponentNode is only compatible with PhysicalMaterial."), a.format("0.0", this.type, b)) : (console.warn("THREE.RoughnessToBlinnExponentNode is not compatible with " + a.shader + " shader."), a.format("0.0", this.type, b))
            },THREE.SwitchNode = function (a, b) {
                THREE.GLNode.call(this), this.node = a, this.components = b || "x"
            },THREE.SwitchNode.prototype = Object.create(THREE.GLNode.prototype),THREE.SwitchNode.prototype.constructor = THREE.SwitchNode,THREE.SwitchNode.prototype.getType = function (a) {
                return a.getFormatByLength(this.components.length)
            },THREE.SwitchNode.prototype.generate = function (a, b) {
                var c = this.node.getType(a), d = a.getFormatLength(c) - 1, e = this.node.build(a, c);
                if (d > 0) {
                    var f, g = 0, h = a.colorToVector(this.components), i = h.length;
                    for (f = 0; i > f; f++)g = Math.max(g, a.getIndexByElement(h.charAt(f)));
                    for (g > d && (g = d), e += ".", f = 0; i > f; f++) {
                        var j = (h.charAt(f), a.getIndexByElement(h.charAt(f)));
                        j > g && (j = g), e += a.getElementByIndex(j)
                    }
                    return a.format(e, this.getType(a), b)
                }
                return a.format(e, c, b)
            },THREE.TimerNode = function (a, b) {
                THREE.FloatNode.call(this, a), this.requestUpdate = !0, this.scale = void 0 !== b ? b : 1
            },THREE.TimerNode.prototype = Object.create(THREE.FloatNode.prototype),
            THREE.TimerNode.prototype.constructor = THREE.TimerNode,THREE.TimerNode.prototype.updateAnimation = function (a) {
                this.number += a * this.scale
            },THREE.VelocityNode = function (a, b) {
                THREE.Vector3Node.call(this), this.requestUpdate = !0, this.target = a, this.position = this.target.position.clone(), this.velocity = new THREE.Vector3, this.moment = new THREE.Vector3, this.params = b || {}
            },THREE.VelocityNode.prototype = Object.create(THREE.Vector3Node.prototype),THREE.VelocityNode.prototype.constructor = THREE.VelocityNode,THREE.VelocityNode.prototype.updateAnimation = function (a) {
                switch (this.velocity.subVectors(this.target.position, this.position), this.position.copy(this.target.position), this.params.type) {
                    case"elastic":
                        a *= this.params.fps || 60;
                        var b = Math.pow(this.params.spring, a), c = Math.pow(this.params.friction, a);
                        this.moment.x += this.velocity.x * b, this.moment.y += this.velocity.y * b, this.moment.z += this.velocity.z * b, this.moment.x *= c, this.moment.y *= c, this.moment.z *= c, this.value.copy(this.moment);
                        break;
                    default:
                        this.value.copy(this.velocity)
                }
            }
        }.apply(a, arguments)
    })
}(this),function (root) {
    define("sea3d", ["three", "threeSeaExt"], function () {
        return function () {
            var SEA3D = {VERSION: 18e3};
            SEA3D.getVersion = function () {
                var a = SEA3D.VERSION.toString(), b = a.length;
                return a.substring(0, b - 4) + "." + a.substring(b - 4, b - 3) + "." + a.substring(b - 3, b - 2) + "." + parseFloat(a.substring(b - 2, b)).toString()
            }, console.log("SEA3D " + SEA3D.getVersion()), SEA3D.Stream = function (a) {
                this.position = 0, this.buffer = a || new ArrayBuffer
            }, SEA3D.Stream.NONE = 0, SEA3D.Stream.BOOLEAN = 1, SEA3D.Stream.BYTE = 2, SEA3D.Stream.UBYTE = 3, SEA3D.Stream.SHORT = 4, SEA3D.Stream.USHORT = 5, SEA3D.Stream.INT24 = 6, SEA3D.Stream.UINT24 = 7, SEA3D.Stream.INT = 8, SEA3D.Stream.UINT = 9, SEA3D.Stream.FLOAT = 10, SEA3D.Stream.DOUBLE = 11, SEA3D.Stream.DECIMAL = 12, SEA3D.Stream.VECTOR3D = 74, SEA3D.Stream.VECTOR4D = 106, SEA3D.Stream.STRING_TINY = 128, SEA3D.Stream.STRING_SHORT = 129, SEA3D.Stream.STRING_LONG = 130, SEA3D.Stream.ASSET = 200, SEA3D.Stream.GROUP = 255, SEA3D.Stream.BLEND_MODE = ["normal", "add", "subtract", "multiply", "dividing", "mix", "alpha", "screen", "darken", "overlay", "colorburn", "linearburn", "lighten", "colordodge", "lineardodge", "softlight", "hardlight", "pinlight", "spotlight", "spotlightblend", "hardmix", "average", "difference", "exclusion", "hue", "saturation", "color", "value", "linearlight", "grainextract", "reflect", "glow", "darkercolor", "lightercolor", "phoenix", "negation"], SEA3D.Stream.INTERPOLATION_TABLE = ["normal", "linear", "sine.in", "sine.out", "sine.inout", "cubic.in", "cubic.out", "cubic.inout", "quint.in", "quint.out", "quint.inout", "circ.in", "circ.out", "circ.inout", "back.in", "back.out", "back.inout", "quad.in", "quad.out", "quad.inout", "quart.in", "quart.out", "quart.inout", "expo.in", "expo.out", "expo.inout", "elastic.in", "elastic.out", "elastic.inout", "bounce.in", "bounce.out", "bounce.inout"], SEA3D.Stream.sizeOf = function (a) {
                return 0 == a ? 0 : a >= 1 && 31 >= a ? 1 : a >= 32 && 63 >= a ? 2 : a >= 64 && 95 >= a ? 3 : a >= 96 && 125 >= a ? 4 : -1
            }, SEA3D.Stream.prototype = {
                constructor: SEA3D.Stream, set buffer(a) {
                    this.buf = a, this.length = a.byteLength, this.data = new DataView(a)
                }, get buffer() {
                    return this.buf
                }, get bytesAvailable() {
                    return this.length - this.position
                }
            }, SEA3D.Stream.prototype.getByte = function (a) {
                return this.data.getInt8(a)
            }, SEA3D.Stream.prototype.readBytes = function (a) {
                var b = this.buf.slice(this.position, this.position + a);
                return this.position += a, b
            }, SEA3D.Stream.prototype.readByte = function () {
                return this.data.getInt8(this.position++)
            }, SEA3D.Stream.prototype.readUByte = function () {
                return this.data.getUint8(this.position++)
            }, SEA3D.Stream.prototype.readBool = function () {
                return 0 != this.data.getInt8(this.position++)
            }, SEA3D.Stream.prototype.readShort = function () {
                var a = this.data.getInt16(this.position, !0);
                return this.position += 2, a
            }, SEA3D.Stream.prototype.readUShort = function () {
                var a = this.data.getUint16(this.position, !0);
                return this.position += 2, a
            }, SEA3D.Stream.prototype.readUInt24 = function () {
                var a = 16777215 & this.data.getUint32(this.position, !0);
                return this.position += 3, a
            }, SEA3D.Stream.prototype.readUInt24F = function () {
                return this.readUShort() | this.readUByte() << 16
            }, SEA3D.Stream.prototype.readInt = function () {
                var a = this.data.getInt32(this.position, !0);
                return this.position += 4, a
            }, SEA3D.Stream.prototype.readUInt = function () {
                var a = this.data.getUint32(this.position, !0);
                return this.position += 4, a
            }, SEA3D.Stream.prototype.readFloat = function () {
                var a = this.data.getFloat32(this.position, !0);
                return this.position += 4, a
            }, SEA3D.Stream.prototype.readUInteger = function () {
                var a = this.readUByte(), b = 127 & a;
                return 0 != (128 & a) && (a = this.readUByte(), b |= (127 & a) << 7, 0 != (128 & a) && (a = this.readUByte(), b |= (127 & a) << 13)), b
            }, SEA3D.Stream.prototype.readVector2 = function () {
                return {x: this.readFloat(), y: this.readFloat()}
            }, SEA3D.Stream.prototype.readVector3 = function () {
                return {x: this.readFloat(), y: this.readFloat(), z: this.readFloat()}
            }, SEA3D.Stream.prototype.readVector4 = function () {
                return {x: this.readFloat(), y: this.readFloat(), z: this.readFloat(), w: this.readFloat()}
            }, SEA3D.Stream.prototype.readMatrix = function () {
                var a = new Float32Array(16);
                return a[0] = this.readFloat(), a[1] = this.readFloat(), a[2] = this.readFloat(), a[3] = 0, a[4] = this.readFloat(), a[5] = this.readFloat(), a[6] = this.readFloat(), a[7] = 0, a[8] = this.readFloat(), a[9] = this.readFloat(), a[10] = this.readFloat(), a[11] = 0, a[12] = this.readFloat(), a[13] = this.readFloat(), a[14] = this.readFloat(), a[15] = 1, a
            }, SEA3D.Stream.prototype.readUTF = function (a) {
                return String.fromCharCode.apply(void 0, new Uint16Array(new Uint8Array(this.readBytes(a))))
            }, SEA3D.Stream.prototype.readExt = function () {
                return this.readUTF(4).replace(/\0/g, "")
            }, SEA3D.Stream.prototype.readUTF8 = function () {
                return this.readUTF(this.readUByte())
            }, SEA3D.Stream.prototype.readUTF8Short = function () {
                return this.readUTF(this.readUShort())
            }, SEA3D.Stream.prototype.readUTF8Long = function () {
                return this.readUTF(this.readUInt())
            }, SEA3D.Stream.prototype.readUByteArray = function (a) {
                var b = new Uint8Array(a);
                return SEA3D.Stream.memcpy(b.buffer, 0, this.buffer, this.position, a), this.position += a, b
            }, SEA3D.Stream.prototype.readUShortArray = function (a) {
                var b = new Uint16Array(a), c = 2 * a;
                return SEA3D.Stream.memcpy(b.buffer, 0, this.buffer, this.position, c), this.position += c, b
            }, SEA3D.Stream.prototype.readUInt24Array = function (a) {
                for (var b = new Uint32Array(a), c = 0; a > c; c++)b[c] = this.readUInt24();
                return b
            }, SEA3D.Stream.prototype.readUIntArray = function (a) {
                var b = new Uint32Array(a), c = 4 * a;
                return SEA3D.Stream.memcpy(b.buffer, 0, this.buffer, this.position, c), this.position += c, b
            }, SEA3D.Stream.prototype.readFloatArray = function (a) {
                var b = new Float32Array(a), c = 4 * a;
                return SEA3D.Stream.memcpy(b.buffer, 0, this.buffer, this.position, c), this.position += c, b
            }, SEA3D.Stream.prototype.readBlendMode = function () {
                return SEA3D.Stream.BLEND_MODE[this.readUByte()]
            }, SEA3D.Stream.prototype.readInterpolation = function () {
                return SEA3D.Stream.INTERPOLATION_TABLE[this.readUByte()]
            }, SEA3D.Stream.prototype.readTags = function (a) {
                for (var b = this.readUByte(), c = 0; b > c; ++c) {
                    var d = this.readUShort(), e = this.readUInt(), f = this.position;
                    a(d, data, e), this.position = f += e
                }
            }, SEA3D.Stream.prototype.readProperties = function (a) {
                var b = this.readUByte(), c = {}, d = {};
                c.__type = d;
                for (var e = 0; b > e; e++) {
                    var f = this.readUTF8(), g = this.readUByte();
                    c[f] = this.readToken(g, a), d[f] = g
                }
                return c
            }, SEA3D.Stream.prototype.readAnimationList = function (a) {
                for (var b = [], c = this.readUByte(), d = 0; c > d;) {
                    var e = this.readUByte(), f = {};
                    f.relative = 0 != (1 & e), 2 & e && (f.timeScale = this.readFloat()), f.tag = a.getObject(this.readUInt()), b[d++] = f
                }
                return b
            }, SEA3D.Stream.prototype.readScriptList = function (a) {
                for (var b = [], c = this.readUByte(), d = 0; c > d;) {
                    var e = this.readUByte(), f = {};
                    if (f.priority = 1 & e | 2 & e, 4 & e) {
                        var g = this.readUByte();
                        f.params = {};
                        for (var h = 0; g > h; h++) {
                            var i = this.readUTF8();
                            f.params[i] = this.readObject(a)
                        }
                    }
                    8 & e && (f.method = this.readUTF8()), f.tag = a.getObject(this.readUInt()), b[d++] = f
                }
                return b
            }, SEA3D.Stream.prototype.readObject = function (a) {
                return this.readToken(this.readUByte(), a)
            }, SEA3D.Stream.prototype.readToken = function (a, b) {
                switch (a) {
                    case SEA3D.Stream.BOOLEAN:
                        return this.readBool();
                    case SEA3D.Stream.UBYTE:
                        return this.readUByte();
                    case SEA3D.Stream.USHORT:
                        return this.readUShort();
                    case SEA3D.Stream.UINT24:
                        return this.readUInt24();
                    case SEA3D.Stream.INT:
                        return this.readInt();
                    case SEA3D.Stream.UINT:
                        return this.readUInt();
                    case SEA3D.Stream.FLOAT:
                        return this.readFloat();
                    case SEA3D.Stream.VECTOR3D:
                        return this.readVector3();
                    case SEA3D.Stream.VECTOR4D:
                        return this.readVector4();
                    case SEA3D.Stream.STRING_TINY:
                        return this.readUTF8();
                    case SEA3D.Stream.STRING_SHORT:
                        return this.readUTF8Short();
                    case SEA3D.Stream.STRING_LONG:
                        return this.readUTF8Long();
                    case SEA3D.Stream.ASSET:
                        var c = this.readUInt();
                        return c > 0 ? b.getObject(c - 1).tag : null;
                    default:
                        console.error("DataType not found!")
                }
                return null
            }, SEA3D.Stream.prototype.readVector = function (a, b, c) {
                var d = SEA3D.Stream.sizeOf(a), e = c * d, f = e + b * d;
                switch (a) {
                    case SEA3D.Stream.BOOLEAN:
                        return this.readUByteArray(f);
                    case SEA3D.Stream.UBYTE:
                        return this.readUByteArray(f);
                    case SEA3D.Stream.USHORT:
                        return this.readUShortArray(f);
                    case SEA3D.Stream.UINT24:
                        return this.readUInt24Array(f);
                    case SEA3D.Stream.UINT:
                        return this.readUIntArray(f);
                    case SEA3D.Stream.FLOAT:
                        return this.readFloatArray(f);
                    case SEA3D.Stream.VECTOR3D:
                        return this.readFloatArray(f);
                    case SEA3D.Stream.VECTOR4D:
                        return this.readFloatArray(f)
                }
            }, SEA3D.Stream.prototype.append = function (a) {
                var b = new ArrayBuffer(this.data.byteLength + a.byteLength);
                b.set(new ArrayBuffer(this.data), 0), b.set(new ArrayBuffer(a), this.data.byteLength), this.data = b
            }, SEA3D.Stream.prototype.concat = function (a, b) {
                return new SEA3D.Stream(this.buffer.slice(a, a + b))
            }, SEA3D.Stream.memcpy = function (a, b, c, d, e) {
                var f = new Uint8Array(a, b, e), g = new Uint8Array(c, d, e);
                f.set(g)
            }, SEA3D.UByteArray = function () {
                this.ubytes = [], this.length = 0
            }, SEA3D.UByteArray.prototype = {
                constructor: SEA3D.UByteArray, add: function (a) {
                    this.ubytes.push(a), this.length += a.byteLength
                }, toBuffer: function () {
                    for (var a = new Uint8Array(this.length), b = 0, c = 0; b < this.ubytes.length; b++)a.set(this.ubytes[b], c), c += this.ubytes[b].byteLength;
                    return a.buffer
                }
            }, SEA3D.Math = {DEGREES: 180 / Math.PI, RADIANS: Math.PI / 180}, SEA3D.Math.angle = function (a) {
                var b = 180, c = 0 > a;
                return a = (c ? -a : a) % 360, a > b && (a = -b + (a - b)), c ? -a : a
            }, SEA3D.Math.lerpAngle = function (a, b, c) {
                return Math.abs(a - b) > 180 && (a > b ? b += 360 : b -= 360), a += (b - a) * c, SEA3D.Math.angle(a)
            }, SEA3D.Math.lerpColor = function (a, b, c) {
                var d = a >> 24 & 255, e = a >> 16 & 255, f = a >> 8 & 255, g = 255 & a, h = b >> 24 & 255, i = b >> 16 & 255, j = b >> 8 & 255, k = 255 & b;
                return d += (h - d) * c, e += (i - e) * c, f += (j - f) * c, g += (k - g) * c, d << 24 | e << 16 | f << 8 | g
            }, SEA3D.Math.lerp = function (a, b, c) {
                return a + (b - a) * c
            }, SEA3D.Math.lerp1x = function (a, b, c) {
                a[0] += (b[0] - a[0]) * c
            }, SEA3D.Math.lerp3x = function (a, b, c) {
                a[0] += (b[0] - a[0]) * c, a[1] += (b[1] - a[1]) * c, a[2] += (b[2] - a[2]) * c
            }, SEA3D.Math.lerpAng1x = function (a, b, c) {
                a[0] = SEA3D.Math.lerpAngle(a[0], b[0], c)
            }, SEA3D.Math.lerpColor1x = function (a, b, c) {
                a[0] = SEA3D.Math.lerpColor(a[0], b[0], c)
            }, SEA3D.Math.lerpQuat4x = function (a, b, c) {
                var d, e, f, g, h, i = a[0], j = a[1], k = a[2], l = a[3], m = b[0], n = b[1], o = b[2], p = b[3];
                0 > i * m + j * n + k * o + l * p && (m = -m, n = -n, o = -o, p = -p), d = i + c * (m - i), e = j + c * (n - j), f = k + c * (o - k), g = l + c * (p - l), h = 1 / Math.sqrt(g * g + d * d + e * e + f * f), a[0] = d * h, a[1] = e * h, a[2] = f * h, a[3] = g * h
            }, SEA3D.Timer = function () {
                this.time = this.start = Date.now()
            }, SEA3D.Timer.prototype = {
                constructor: SEA3D.Timer, get now() {
                    return Date.now()
                }, get deltaTime() {
                    return Date.now() - this.time
                }, get elapsedTime() {
                    return Date.now() - this.start
                }, update: function () {
                    this.time = Date.now()
                }
            }, SEA3D.Object = function (a, b, c, d) {
                this.name = a, this.data = b, this.type = c, this.sea3d = d
            }, SEA3D.GeometryBase = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.attrib = b.readUShort(), this.isBig = 0 != (1 & this.attrib), b.readVInt = this.isBig ? b.readUInt : b.readUShort, this.numVertex = b.readVInt(), this.length = 3 * this.numVertex
            }, SEA3D.Geometry = function (a, b, c) {
                SEA3D.GeometryBase.call(this, a, b, c);
                var d, e, f;
                if (4 & this.attrib && (this.normal = b.readFloatArray(this.length)), 8 & this.attrib && (this.tangent = b.readFloatArray(this.length)), 32 & this.attrib)for (this.uv = [], this.uv.length = b.readUByte(), f = 2 * this.numVertex, d = 0; d < this.uv.length;)this.uv[d++] = b.readFloatArray(f);
                if (64 & this.attrib) {
                    this.jointPerVertex = b.readUByte();
                    var g = this.numVertex * this.jointPerVertex;
                    this.joint = b.readUShortArray(g), this.weight = b.readFloatArray(g)
                }
                if (128 & this.attrib) {
                    var h = b.readUByte();
                    for (this.numColor = ((64 & h) >> 6 | (128 & h) >> 6) + 1, this.color = [], d = 0, f = 15 & h; f > d; d++)this.color.push(b.readFloatArray(this.numVertex * this.numColor))
                }
                this.vertex = b.readFloatArray(this.length);
                var i = b.readUByte();
                if (this.groups = [], 1024 & this.attrib) {
                    for (d = 0, f = 0; i > d; d++)e = 3 * b.readVInt(), this.groups.push({start: f, count: e}), f += e;
                    this.indexes = this.isBig ? b.readUIntArray(f) : b.readUShortArray(f)
                } else {
                    var j = this.isBig ? 4 : 2, k = new SEA3D.UByteArray;
                    for (d = 0, e = 0; i > d; d++)f = 3 * b.readVInt(), this.groups.push({
                        start: e,
                        count: f
                    }), e += f, k.add(b.readUByteArray(f * j));
                    this.indexes = this.isBig ? new Uint32Array(k.toBuffer()) : new Uint16Array(k.toBuffer())
                }
            }, SEA3D.Geometry.prototype = Object.create(SEA3D.GeometryBase.prototype), SEA3D.Geometry.prototype.constructor = SEA3D.Geometry, SEA3D.Geometry.prototype.type = "geo", SEA3D.GeometryDeltaBase = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.attrib = b.readUShort(), this.numVertex = b.readUInteger(), this.length = 3 * this.numVertex, 1 & this.attrib ? (b.readNumber = b.readByte, this.numDiv = 127.5) : (b.readNumber = b.readShort, numDiv = 32767.5)
            }, SEA3D.GeometryDelta = function (a, b, c) {
                SEA3D.GeometryDeltaBase.call(this, a, b, c);
                var d, e, f, g, h, i;
                if (4 & this.attrib)for (g = b.readFloat(), this.normal = new Float32Array(this.length), d = 0; d < this.length;)this.normal[d++] = b.readNumber() / this.numDiv * g;
                if (8 & this.attrib)for (g = b.readFloat(), this.tangent = new Float32Array(this.length), d = 0; d < this.length;)this.tangent[d++] = b.readNumber() / this.numDiv * g;
                if (32 & this.attrib) {
                    this.uv = [], this.uv.length = b.readUByte();
                    var j = 2 * this.numVertex;
                    for (d = 0; d < this.uv.length;)for (g = b.readFloat(), this.uv[d++] = i = new Float32Array(j), e = 0; j > e;)i[e++] = b.readNumber() / this.numDiv * g
                }
                if (64 & this.attrib) {
                    this.jointPerVertex = b.readUByte();
                    var k = this.numVertex * this.jointPerVertex;
                    for (this.joint = new Uint16Array(k), this.weight = new Float32Array(k), d = 0; k > d;)this.joint[d++] = b.readUInteger();
                    for (d = 0; k > d;)this.weight[d++] = b.readNumber() / this.numDiv * 1
                }
                if (128 & this.attrib) {
                    var l = b.readUByte(), m = ((64 & l) >> 6 | (128 & l) >> 6) + 1, n = 4 * this.numVertex;
                    for (this.color = [], this.color.length = 15 & l, this.numColor = 4, d = 0; d < this.color.length; d++) {
                        var o = new Float32Array(n);
                        switch (m) {
                            case 1:
                                for (e = 0; n > e;)o[e++] = b.readUByte() / 255, o[e++] = 0, o[e++] = 0, o[e++] = 1;
                                break;
                            case 2:
                                for (e = 0; n > e;)o[e++] = b.readUByte() / 255, o[e++] = b.readUByte() / 255, o[e++] = 0, o[e++] = 1;
                                break;
                            case 3:
                                for (e = 0; n > e;)o[e++] = b.readUByte() / 255, o[e++] = b.readUByte() / 255, o[e++] = b.readUByte() / 255, o[e++] = 1;
                                break;
                            case 4:
                                for (e = 0; n > e;)o[e++] = b.readUByte() / 255, o[e++] = b.readUByte() / 255, o[e++] = b.readUByte() / 255, o[e++] = b.readUByte() / 255
                        }
                        this.color[d] = o
                    }
                }
                for (g = b.readFloat(), this.vertex = new Float32Array(this.length), d = 0; d < this.length;)this.vertex[d++] = b.readNumber() / this.numDiv * g;
                var p = b.readUByte();
                for (this.indexes = i = [], this.groups = [], e = 0, d = 0; p > d; d++)for (h = 3 * b.readVInt(), this.groups.push({
                    start: e,
                    count: h
                }), h += e; h > e;)i[e++] = b.readVInt();
                var p = b.readUByte();
                if (this.indexes = i = [], this.groups = [], 2 & this.attrib)for (d = 0; p > d; d++) {
                    for (h = b.readUInteger(), f = i.length, e = 0; h > e; e++) {
                        var q = b.readUInteger(), r = b.readUInteger(), s = b.readUInteger(), t = b.readUInteger();
                        i.push(q), i.push(r), i.push(s), t > 0 && (i.push(s), i.push(t + 1), i.push(q))
                    }
                    this.groups.push({start: f, count: i.length - f})
                } else for (e = 0, d = 0; p > d; d++)for (h = 3 * b.readUInteger(), this.groups.push({
                    start: e,
                    count: h
                }), h += e; h > e;)i[e++] = b.readUInteger()
            }, SEA3D.GeometryDeltaBase.prototype = Object.create(SEA3D.GeometryDeltaBase.prototype), SEA3D.GeometryDeltaBase.prototype.constructor = SEA3D.GeometryDelta, SEA3D.GeometryDelta.prototype.type = "geDL", SEA3D.Object3D = function (a, b, c) {
                if (this.name = a, this.data = b, this.sea3d = c, this.isStatic = !1, this.visible = !0, this.attrib = b.readUShort(), 1 & this.attrib && (this.parent = c.getObject(b.readUInt())), 2 & this.attrib && (this.animations = b.readAnimationList(c)), 4 & this.attrib && (this.scripts = b.readScriptList(c)), 16 & this.attrib && (this.properties = c.getObject(b.readUInt())), 32 & this.attrib) {
                    var d = b.readUByte();
                    this.isStatic = 0 != (1 & d), this.visible = 0 != (2 & d)
                }
            }, SEA3D.Object3D.prototype.readTag = function (a, b, c) {
            }, SEA3D.Entity3D = function (a, b, c) {
                if (SEA3D.Object3D.call(this, a, b, c), this.castShadows = !0, 64 & this.attrib) {
                    var d = b.readUByte();
                    this.castShadows = 0 == (1 & d)
                }
            }, SEA3D.Entity3D.prototype = Object.create(SEA3D.Object3D.prototype), SEA3D.Entity3D.prototype.constructor = SEA3D.Entity3D, SEA3D.Sound3D = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), this.autoPlay = 0 != (64 & this.attrib), 128 & this.attrib && (this.mixer = c.getObject(b.readUInt())), this.sound = c.getObject(b.readUInt()), this.volume = b.readFloat()
            }, SEA3D.Sound3D.prototype = Object.create(SEA3D.Object3D.prototype), SEA3D.Sound3D.prototype.constructor = SEA3D.Sound3D, SEA3D.SoundPoint = function (a, b, c) {
                SEA3D.Sound3D.call(this, a, b, c), this.position = b.readVector3(), this.distance = b.readFloat(), b.readTags(this.readTag.bind(this))
            }, SEA3D.SoundPoint.prototype = Object.create(SEA3D.Sound3D.prototype),SEA3D.SoundPoint.prototype.constructor = SEA3D.SoundPoint,SEA3D.SoundPoint.prototype.type = "sp",SEA3D.Container3D = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), this.transform = b.readMatrix(), b.readTags(this.readTag.bind(this))
            },SEA3D.Container3D.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.Container3D.prototype.constructor = SEA3D.Container3D,SEA3D.Container3D.prototype.type = "c3d",SEA3D.TextureURL = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.url = b.readUTF(b.length)
            },SEA3D.TextureURL.prototype.type = "urlT",SEA3D.Actions = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.count = b.readUInt(), this.actions = [];
                for (var d = 0; d < this.count; d++) {
                    var e = b.readUByte(), f = b.readUShort(), g = b.readUShort(), h = b.position, i = this.actions[d] = {kind: f};
                    switch (1 & e && (i.range = [b.readUInt(), b.readUInt()]), 2 & e && (i.time = b.readUInt()), 4 & e && (i.intrpl = b.readInterpolation(), 0 == i.intrpl.indexOf("back.") ? i.intrplParam0 = b.readFloat() : 0 == i.intrpl.indexOf("elastic.") && (i.intrplParam0 = b.readFloat(), i.intrplParam1 = b.readFloat())), f) {
                        case SEA3D.Actions.RTT_TARGET:
                            i.source = c.getObject(b.readUInt()), i.target = c.getObject(b.readUInt());
                            break;
                        case SEA3D.Actions.LOOK_AT:
                            i.source = c.getObject(b.readUInt()), i.target = c.getObject(b.readUInt());
                            break;
                        case SEA3D.Actions.PLAY_SOUND:
                            i.sound = c.getObject(b.readUInt()), i.offset = b.readUInt();
                            break;
                        case SEA3D.Actions.PLAY_ANIMATION:
                            i.object = c.getObject(b.readUInt()), i.name = b.readUTF8();
                            break;
                        case SEA3D.Actions.FOG:
                            i.color = b.readUInt24(), i.min = b.readFloat(), i.max = b.readFloat();
                            break;
                        case SEA3D.Actions.ENVIRONMENT:
                            i.texture = c.getObject(b.readUInt());
                            break;
                        case SEA3D.Actions.ENVIRONMENT_COLOR:
                            i.color = b.readUInt24F();
                            break;
                        case SEA3D.Actions.CAMERA:
                            i.camera = c.getObject(b.readUInt());
                            break;
                        case SEA3D.Actions.SCRIPTS:
                            i.scripts = b.readScriptList(c);
                            break;
                        case SEA3D.Actions.CLASS_OF:
                            i.classof = c.getObject(b.readUInt());
                            break;
                        default:
                            console.log('Action "' + f + '" not found.')
                    }
                    b.position = h + g
                }
            },SEA3D.Actions.SCENE = 0,SEA3D.Actions.ENVIRONMENT_COLOR = 1,SEA3D.Actions.ENVIRONMENT = 2,SEA3D.Actions.FOG = 3,SEA3D.Actions.PLAY_ANIMATION = 4,SEA3D.Actions.PLAY_SOUND = 5,SEA3D.Actions.ANIMATION_AUDIO_SYNC = 6,SEA3D.Actions.LOOK_AT = 7,SEA3D.Actions.RTT_TARGET = 8,SEA3D.Actions.CAMERA = 9,SEA3D.Actions.SCRIPTS = 10,SEA3D.Actions.CLASS_OF = 11,SEA3D.Actions.prototype.type = "act",SEA3D.Properties = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.tag = b.readProperties(c), this.tag.__name = a
            },SEA3D.Properties.prototype.type = "prop",SEA3D.FileInfo = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.tag = b.readProperties(c), this.tag.__name = a, c.info = this.tag
            },SEA3D.FileInfo.prototype.type = "info",SEA3D.JavaScript = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.src = b.readUTF(b.length)
            },SEA3D.JavaScript.prototype.type = "js",SEA3D.JavaScriptMethod = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c;
                var d = b.readUShort();
                this.methods = {};
                for (var e = 0; d > e; e++) {
                    var f = (b.readUByte(), b.readUTF8());
                    this.methods[f] = {src: b.readUTF8Long()}
                }
            },SEA3D.JavaScriptMethod.prototype.type = "jsm",SEA3D.GLSL = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.src = b.readUTF(b.length)
            },SEA3D.GLSL.prototype.type = "glsl",SEA3D.Dummy = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), this.transform = b.readMatrix(), this.width = b.readFloat(), this.height = b.readFloat(), this.depth = b.readFloat(), b.readTags(this.readTag.bind(this))
            },SEA3D.Dummy.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.Dummy.prototype.constructor = SEA3D.Dummy,SEA3D.Dummy.prototype.type = "dmy",SEA3D.Line = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), this.count = 3 * (64 & this.attrib ? b.readUInt() : b.readUShort()), this.closed = 0 != (128 & this.attrib), this.transform = b.readMatrix(), this.vertex = [];
                for (var d = 0; d < this.count;)this.vertex[d++] = b.readFloat();
                b.readTags(this.readTag.bind(this))
            },SEA3D.Line.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.Line.prototype.constructor = SEA3D.Line,SEA3D.Line.prototype.type = "line",SEA3D.Sprite = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), 256 & this.attrib && (this.material = c.getObject(b.readUInt())), this.position = b.readVector3(), this.width = b.readFloat(), this.height = b.readFloat(), b.readTags(this.readTag.bind(this))
            },SEA3D.Sprite.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.Sprite.prototype.constructor = SEA3D.Sprite,SEA3D.Sprite.prototype.type = "m2d",SEA3D.Mesh = function (a, b, c) {
                if (SEA3D.Entity3D.call(this, a, b, c), 256 & this.attrib) {
                    this.material = [];
                    var d = b.readUByte();
                    if (1 == d)this.material[0] = c.getObject(b.readUInt()); else for (var e = 0; d > e;) {
                        var f = b.readUInt();
                        f > 0 ? this.material[e++] = c.getObject(f - 1) : this.material[e++] = void 0
                    }
                }
                if (512 & this.attrib) {
                    this.modifiers = [];
                    for (var d = b.readUByte(), e = 0; d > e; e++)this.modifiers[e] = c.getObject(b.readUInt())
                }
                1024 & this.attrib && (this.reference = {
                    type: b.readUByte(),
                    ref: c.getObject(b.readUInt())
                }), this.transform = b.readMatrix(), this.geometry = c.getObject(b.readUInt()), b.readTags(this.readTag.bind(this))
            },SEA3D.Mesh.prototype = Object.create(SEA3D.Entity3D.prototype),SEA3D.Mesh.prototype.constructor = SEA3D.Mesh,SEA3D.Mesh.prototype.type = "m3d",SEA3D.Skeleton = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c;
                var d = b.readUShort();
                this.joint = [];
                for (var e = 0; d > e; e++)this.joint[e] = {
                    name: b.readUTF8(),
                    parentIndex: b.readUShort() - 1,
                    inverseBindMatrix: b.readMatrix()
                }
            },SEA3D.Skeleton.prototype.type = "skl",SEA3D.SkeletonLocal = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c;
                var d = b.readUShort();
                this.joint = [];
                for (var e = 0; d > e; e++)this.joint[e] = {
                    name: b.readUTF8(),
                    parentIndex: b.readUShort() - 1,
                    x: b.readFloat(),
                    y: b.readFloat(),
                    z: b.readFloat(),
                    qx: b.readFloat(),
                    qy: b.readFloat(),
                    qz: b.readFloat(),
                    qw: b.readFloat()
                }
            },SEA3D.SkeletonLocal.prototype.type = "sklq",SEA3D.AnimationBase = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c;
                var d = b.readUByte();
                if (this.sequence = [], 1 & d)for (var e = b.readUShort(), f = 0; e > f; f++)d = b.readUByte(), this.sequence[f] = {
                    name: b.readUTF8(),
                    start: b.readUInt(),
                    count: b.readUInt(),
                    repeat: 0 != (1 & d),
                    intrpl: 0 == (2 & d)
                };
                this.frameRate = b.readUByte(), this.numFrames = b.readUInt(), 0 == this.sequence.length && (this.sequence[0] = {
                    name: "root",
                    start: 0,
                    count: this.numFrames,
                    repeat: !0,
                    intrpl: !0
                })
            },SEA3D.Animation = function (a, b, c) {
                SEA3D.AnimationBase.call(this, a, b, c), this.dataList = [];
                for (var d = 0, e = b.readUByte(); e > d; d++) {
                    var f = b.readUShort(), g = b.readUByte(), h = b.readVector(g, this.numFrames, 0);
                    this.dataList.push({kind: f, type: g, blockSize: SEA3D.Stream.sizeOf(g), data: h})
                }
            },SEA3D.Animation.POSITION = 0,SEA3D.Animation.ROTATION = 1,SEA3D.Animation.SCALE = 2,SEA3D.Animation.COLOR = 3,SEA3D.Animation.MULTIPLIER = 4,SEA3D.Animation.ATTENUATION_START = 5,SEA3D.Animation.ATTENUATION_END = 6,SEA3D.Animation.FOV = 7,SEA3D.Animation.OFFSET_U = 8,SEA3D.Animation.OFFSET_V = 9,SEA3D.Animation.SCALE_U = 10,SEA3D.Animation.SCALE_V = 11,SEA3D.Animation.ANGLE = 12,SEA3D.Animation.ALPHA = 13,SEA3D.Animation.VOLUME = 14,SEA3D.Animation.DefaultLerpFuncs = [SEA3D.Math.lerp3x, SEA3D.Math.lerpQuat4x, SEA3D.Math.lerp3x, SEA3D.Math.lerpColor1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x, SEA3D.Math.lerpAng1x, SEA3D.Math.lerp1x, SEA3D.Math.lerp1x],SEA3D.Animation.prototype = Object.create(SEA3D.AnimationBase.prototype),SEA3D.Animation.prototype.constructor = SEA3D.Animation,SEA3D.Animation.prototype.type = "anm",SEA3D.SkeletonAnimation = function (a, b, c) {
                SEA3D.AnimationBase.call(this, a, b, c), this.name = a, this.data = b, this.sea3d = c, this.numJoints = b.readUShort(), this.raw = b.readFloatArray(this.numFrames * this.numJoints * 7)
            },SEA3D.SkeletonAnimation.prototype.type = "skla",SEA3D.Morph = function (a, b, c) {
                SEA3D.GeometryBase.call(this, a, b, c);
                var d = 0 != (2 & this.attrib), e = 0 != (4 & this.attrib), f = b.readUShort();
                this.node = [];
                for (var g = 0; f > g; g++) {
                    var h, i, j = b.readUTF8();
                    d && (h = b.readFloatArray(this.length)), e && (i = b.readFloatArray(this.length)), this.node[g] = {
                        vertex: h,
                        normal: i,
                        name: j
                    }
                }
            },SEA3D.Morph.prototype = Object.create(SEA3D.GeometryBase.prototype),SEA3D.Morph.prototype.constructor = SEA3D.Morph,SEA3D.Morph.prototype.type = "mph",SEA3D.VertexAnimation = function (a, b, c) {
                SEA3D.AnimationBase.call(this, a, b, c);
                var d = b.readUByte();
                this.isBig = 0 != (1 & d), b.readVInt = this.isBig ? b.readUInt : b.readUShort, this.numVertex = b.readVInt(), this.length = 3 * this.numVertex;
                var e = 0 != (2 & d), f = 0 != (4 & d);
                this.frame = [];
                var g, h, i;
                for (g = 0; g < this.numFrames; g++)e && (h = b.readFloatArray(this.length)), f && (i = b.readFloatArray(this.length)), this.frame[g] = {
                    vertex: h,
                    normal: i
                }
            },SEA3D.VertexAnimation.prototype = Object.create(SEA3D.AnimationBase.prototype),SEA3D.VertexAnimation.prototype.constructor = SEA3D.VertexAnimation,SEA3D.VertexAnimation.prototype.type = "vtxa",SEA3D.Camera = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), 64 & this.attrib && (this.dof = {
                    distance: b.readFloat(),
                    range: b.readFloat()
                }), this.transform = b.readMatrix(), this.fov = b.readFloat(), b.readTags(this.readTag.bind(this))
            },SEA3D.Camera.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.Camera.prototype.constructor = SEA3D.Camera,SEA3D.Camera.prototype.type = "cam",SEA3D.OrthographicCamera = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), this.transform = b.readMatrix(), this.height = b.readFloat(), b.readTags(this.readTag.bind(this))
            },SEA3D.OrthographicCamera.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.OrthographicCamera.prototype.constructor = SEA3D.OrthographicCamera,SEA3D.OrthographicCamera.prototype.type = "camo",SEA3D.JointObject = function (a, b, c) {
                SEA3D.Object3D.call(this, a, b, c), this.target = c.getObject(b.readUInt()), this.joint = b.readUShort(), b.readTags(this.readTag.bind(this))
            },SEA3D.JointObject.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.JointObject.prototype.constructor = SEA3D.JointObject,SEA3D.JointObject.prototype.type = "jnt",SEA3D.Light = function (a, b, c) {
                if (SEA3D.Object3D.call(this, a, b, c), this.attenStart = Number.MAX_VALUE, this.attenEnd = Number.MAX_VALUE, 64 & this.attrib) {
                    var d = b.readUByte();
                    this.shadow = {}, this.shadow.opacity = 1 & d ? b.readFloat() : 1, this.shadow.color = 2 & d ? b.readUInt24() : 0
                }
                512 & this.attrib && (this.attenStart = b.readFloat(), this.attenEnd = b.readFloat()), this.color = b.readUInt24(), this.multiplier = b.readFloat()
            },SEA3D.Light.prototype = Object.create(SEA3D.Object3D.prototype),SEA3D.Light.prototype.constructor = SEA3D.Light,SEA3D.PointLight = function (a, b, c) {
                SEA3D.Light.call(this, a, b, c), 128 & this.attrib && (this.attenuation = {
                    start: b.readFloat(),
                    end: b.readFloat()
                }), this.position = b.readVector3(), b.readTags(this.readTag.bind(this))
            },SEA3D.PointLight.prototype = Object.create(SEA3D.Light.prototype),SEA3D.PointLight.prototype.constructor = SEA3D.PointLight,SEA3D.PointLight.prototype.type = "plht",SEA3D.HemisphereLight = function (a, b, c) {
                SEA3D.Light.call(this, a, b, c), 128 & this.attrib && (this.attenuation = {
                    start: b.readFloat(),
                    end: b.readFloat()
                }), this.secondColor = b.readUInt24(), b.readTags(this.readTag.bind(this))
            },SEA3D.HemisphereLight.prototype = Object.create(SEA3D.Light.prototype),SEA3D.HemisphereLight.prototype.constructor = SEA3D.HemisphereLight,SEA3D.HemisphereLight.prototype.type = "hlht",SEA3D.AmbientLight = function (a, b, c) {
                SEA3D.Light.call(this, a, b, c), b.readTags(this.readTag.bind(this))
            },SEA3D.AmbientLight.prototype = Object.create(SEA3D.Light.prototype),SEA3D.AmbientLight.prototype.constructor = SEA3D.AmbientLight,SEA3D.AmbientLight.prototype.type = "alht",SEA3D.DirectionalLight = function (a, b, c) {
                SEA3D.Light.call(this, a, b, c), this.transform = b.readMatrix(), b.readTags(this.readTag.bind(this))
            },SEA3D.DirectionalLight.prototype = Object.create(SEA3D.Light.prototype),SEA3D.DirectionalLight.prototype.constructor = SEA3D.DirectionalLight,SEA3D.DirectionalLight.prototype.type = "dlht",SEA3D.Material = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.technique = [], this.attrib = b.readUShort(), this.alpha = 1, this.blendMode = "normal", this.alphaThreshold = .5, this.physical = !1, this.anisotropy = !1, this.bothSides = 0 != (1 & this.attrib), this.receiveLights = 0 == (2 & this.attrib), this.receiveShadows = 0 == (4 & this.attrib), this.receiveFog = 0 == (8 & this.attrib), this.smooth = 0 == (16 & this.attrib), 32 & this.attrib && (this.alpha = b.readFloat()), 64 & this.attrib && (this.blendMode = b.readBlendMode()), 128 & this.attrib && (this.animations = b.readAnimationList(c)), this.depthMask = 0 == (256 & this.attrib), this.depthTest = 0 == (512 & this.attrib);
                for (var d = b.readUByte(), e = 0; d > e; ++e) {
                    var f, g, h = b.readUShort(), i = b.readUShort(), j = b.position;
                    switch (h) {
                        case SEA3D.Material.PHONG:
                            f = {
                                ambientColor: b.readUInt24(),
                                diffuseColor: b.readUInt24(),
                                specularColor: b.readUInt24(),
                                specular: b.readFloat(),
                                gloss: b.readFloat()
                            };
                            break;
                        case SEA3D.Material.PHYSICAL:
                            this.physical = !0, f = {
                                color: b.readUInt24(),
                                roughness: b.readFloat(),
                                metalness: b.readFloat()
                            };
                            break;
                        case SEA3D.Material.ANISOTROPIC:
                            this.anisotropy = !0;
                            break;
                        case SEA3D.Material.COMPOSITE_TEXTURE:
                            f = {composite: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.DIFFUSE_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.SPECULAR_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.NORMAL_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.REFLECTION:
                        case SEA3D.Material.FRESNEL_REFLECTION:
                            f = {
                                texture: c.getObject(b.readUInt()),
                                alpha: b.readFloat()
                            }, h == SEA3D.Material.FRESNEL_REFLECTION && (f.power = b.readFloat(), f.normal = b.readFloat());
                            break;
                        case SEA3D.Material.REFRACTION:
                            f = {texture: c.getObject(b.readUInt()), alpha: b.readFloat(), ior: b.readFloat()};
                            break;
                        case SEA3D.Material.RIM:
                            f = {
                                color: b.readUInt24(),
                                strength: b.readFloat(),
                                power: b.readFloat(),
                                blendMode: b.readBlendMode()
                            };
                            break;
                        case SEA3D.Material.LIGHT_MAP:
                            f = {
                                texture: c.getObject(b.readUInt()),
                                channel: b.readUByte(),
                                blendMode: b.readBlendMode()
                            };
                            break;
                        case SEA3D.Material.DETAIL_MAP:
                            f = {
                                texture: c.getObject(b.readUInt()),
                                scale: b.readFloat(),
                                blendMode: b.readBlendMode()
                            };
                            break;
                        case SEA3D.Material.CEL:
                            f = {
                                color: b.readUInt24(),
                                levels: b.readUByte(),
                                size: b.readFloat(),
                                specularCutOff: b.readFloat(),
                                smoothness: b.readFloat()
                            };
                            break;
                        case SEA3D.Material.TRANSLUCENT:
                            f = {translucency: b.readFloat(), scattering: b.readFloat()};
                            break;
                        case SEA3D.Material.BLEND_NORMAL_MAP:
                            g = b.readUByte(), f = {
                                texture: c.getObject(b.readUInt()),
                                secondaryTexture: c.getObject(b.readUInt())
                            }, 1 & g ? (f.offsetX0 = b.readFloat(), f.offsetY0 = b.readFloat(), f.offsetX1 = b.readFloat(), f.offsetY1 = b.readFloat()) : f.offsetX0 = f.offsetY0 = f.offsetX1 = f.offsetY1 = 0, f.animate = 2 & g;
                            break;
                        case SEA3D.Material.MIRROR_REFLECTION:
                            f = {texture: c.getObject(b.readUInt()), alpha: b.readFloat()};
                            break;
                        case SEA3D.Material.AMBIENT_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.ALPHA_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.EMISSIVE:
                            f = {color: b.readUInt24()};
                            break;
                        case SEA3D.Material.EMISSIVE_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.ROUGHNESS_MAP:
                        case SEA3D.Material.METALNESS_MAP:
                            f = {texture: c.getObject(b.readUInt())};
                            break;
                        case SEA3D.Material.VERTEX_COLOR:
                            f = {blendMode: b.readBlendMode()};
                            break;
                        case SEA3D.Material.WRAP_LIGHTING:
                            f = {color: b.readUInt24(), strength: b.readFloat()};
                            break;
                        case SEA3D.Material.COLOR_REPLACE:
                            g = b.readUByte(), f = {
                                red: b.readUInt24(),
                                green: b.readUInt24(),
                                blue: b.readUInt24F()
                            }, 1 & g && (f.mask = c.getObject(b.readUInt())), 2 & g && (f.alpha = b.readFloat());
                            break;
                        case SEA3D.Material.REFLECTION_SPHERICAL:
                            f = {texture: c.getObject(b.readUInt()), alpha: b.readFloat()};
                            break;
                        default:
                            console.warn("SEA3D: MaterialTechnique not found:", h.toString(16)), b.position = j += i;
                            continue
                    }
                    f.kind = h, this.technique.push(f), b.position = j += i
                }
            },SEA3D.Material.PHONG = 0,SEA3D.Material.COMPOSITE_TEXTURE = 1,SEA3D.Material.DIFFUSE_MAP = 2,SEA3D.Material.SPECULAR_MAP = 3,
            SEA3D.Material.REFLECTION = 4,SEA3D.Material.REFRACTION = 5,SEA3D.Material.NORMAL_MAP = 6,SEA3D.Material.FRESNEL_REFLECTION = 7,SEA3D.Material.RIM = 8,SEA3D.Material.LIGHT_MAP = 9,SEA3D.Material.DETAIL_MAP = 10,SEA3D.Material.CEL = 11,SEA3D.Material.TRANSLUCENT = 12,SEA3D.Material.BLEND_NORMAL_MAP = 13,SEA3D.Material.MIRROR_REFLECTION = 14,SEA3D.Material.AMBIENT_MAP = 15,SEA3D.Material.ALPHA_MAP = 16,SEA3D.Material.EMISSIVE_MAP = 17,SEA3D.Material.VERTEX_COLOR = 18,SEA3D.Material.WRAP_LIGHTING = 19,SEA3D.Material.COLOR_REPLACE = 20,SEA3D.Material.REFLECTION_SPHERICAL = 21,SEA3D.Material.ANISOTROPIC = 22,SEA3D.Material.EMISSIVE = 23,SEA3D.Material.PHYSICAL = 24,SEA3D.Material.ROUGHNESS_MAP = 25,SEA3D.Material.METALNESS_MAP = 26,SEA3D.Material.prototype.type = "mat",SEA3D.Composite = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c;
                var d = b.readUByte();
                this.layer = [];
                for (var e = 0; d > e; e++)this.layer[e] = new SEA3D.Composite.prototype.Layer(b, c)
            },SEA3D.Composite.prototype.getLayerByName = function (a) {
                for (var b = 0; b < this.layer.length; b++)if (this.layer[b].name == a)return this.layer[b]
            },SEA3D.Composite.prototype.Layer = function (a, b) {
                var c = a.readUShort();
                1 & c ? this.texture = new SEA3D.Composite.LayerBitmap(a, b) : this.color = a.readUInt24(), 2 & c && (this.mask = new SEA3D.Composite.LayerBitmap(a, b)), 4 & c && (this.name = a.readUTF8()), this.blendMode = 8 & c ? a.readBlendMode() : "normal", this.opacity = 16 & c ? a.readFloat() : 1
            },SEA3D.Composite.LayerBitmap = function (a, b) {
                this.map = b.getObject(a.readUInt());
                var c = a.readUShort();
                this.channel = 1 & c ? a.readUByte() : 0, this.repeat = c & !1, this.offsetU = 4 & c ? a.readFloat() : 0, this.offsetV = 8 & c ? a.readFloat() : 0, this.scaleU = 16 & c ? a.readFloat() : 1, this.scaleV = 32 & c ? a.readFloat() : 1, this.rotation = 64 & c ? a.readFloat() : 0, 128 & c && (this.animation = a.readAnimationList(b))
            },SEA3D.Composite.prototype.type = "ctex",SEA3D.Sphere = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.radius = b.readFloat()
            },SEA3D.Sphere.prototype.type = "sph",SEA3D.Box = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.width = b.readFloat(), this.height = b.readFloat(), this.depth = b.readFloat()
            },SEA3D.Box.prototype.type = "box",SEA3D.Cone = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.radius = b.readFloat(), this.height = b.readFloat()
            },SEA3D.Cone.prototype.type = "cone",SEA3D.Capsule = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.radius = b.readFloat(), this.height = b.readFloat()
            },SEA3D.Capsule.prototype.type = "cap",SEA3D.Cylinder = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.radius = b.readFloat(), this.height = b.readFloat()
            },SEA3D.Cylinder.prototype.type = "cyl",SEA3D.ConvexGeometry = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.geometry = c.getObject(b.readUInt()), this.subGeometryIndex = b.readUByte()
            },SEA3D.ConvexGeometry.prototype.type = "gs",SEA3D.TriangleGeometry = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.geometry = c.getObject(b.readUInt()), this.subGeometryIndex = b.readUByte()
            },SEA3D.TriangleGeometry.prototype.type = "sgs",SEA3D.Compound = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.compounds = [];
                for (var d = b.readUByte(), e = 0; d > e; e++)this.compounds.push({
                    shape: c.getObject(b.readUInt()),
                    transform: b.readMatrix()
                })
            },SEA3D.Compound.prototype.type = "cmps",SEA3D.Physics = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.attrib = b.readUShort(), this.shape = c.getObject(b.readUInt()), 1 & this.attrib ? this.target = c.getObject(b.readUInt()) : this.transform = b.readMatrix()
            },SEA3D.Physics.prototype.readTag = function (a, b, c) {
            },SEA3D.RigidBodyBase = function (a, b, c) {
                SEA3D.Physics.call(this, a, b, c), 32 & this.attrib ? (this.linearDamping = b.readFloat(), this.angularDamping = b.readFloat()) : (this.linearDamping = 0, this.angularDamping = 0), this.mass = b.readFloat(), this.friction = b.readFloat(), this.restitution = b.readFloat()
            },SEA3D.RigidBodyBase.prototype = Object.create(SEA3D.Physics.prototype),SEA3D.RigidBodyBase.prototype.constructor = SEA3D.RigidBodyBase,SEA3D.RigidBody = function (a, b, c) {
                SEA3D.RigidBodyBase.call(this, a, b, c), b.readTags(this.readTag.bind(this))
            },SEA3D.RigidBody.prototype = Object.create(SEA3D.RigidBodyBase.prototype),SEA3D.RigidBody.prototype.constructor = SEA3D.RigidBody,SEA3D.RigidBody.prototype.type = "rb",SEA3D.CarController = function (a, b, c) {
                SEA3D.RigidBodyBase.call(this, a, b, c), this.suspensionStiffness = b.readFloat(), this.suspensionCompression = b.readFloat(), this.suspensionDamping = b.readFloat(), this.maxSuspensionTravelCm = b.readFloat(), this.frictionSlip = b.readFloat(), this.maxSuspensionForce = b.readFloat(), this.dampingCompression = b.readFloat(), this.dampingRelaxation = b.readFloat();
                var d = b.readUByte();
                this.wheel = [];
                for (var e = 0; d > e; e++)this.wheel[e] = new SEA3D.CarController.Wheel(b, c);
                b.readTags(this.readTag.bind(this))
            },SEA3D.CarController.Wheel = function (a, b) {
                this.data = a, this.sea3d = b;
                var c = a.readUShort();
                this.isFront = 0 != (1 & c), this.target = b.getObject(a.readUInt()), this.pos = a.readVector3(), this.dir = a.readVector3(), this.axle = a.readVector3(), this.radius = a.readFloat(), this.suspensionRestLength = a.readFloat()
            },SEA3D.CarController.prototype = Object.create(SEA3D.RigidBodyBase.prototype),SEA3D.CarController.prototype.constructor = SEA3D.CarController,SEA3D.CarController.prototype.type = "carc",SEA3D.Constraints = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.attrib = b.readUShort(), this.disableCollisionsBetweenBodies = this.attrib & !0, this.targetA = c.getObject(b.readUInt()), this.pointA = b.readVector3(), 2 & this.attrib && (this.targetB = c.getObject(b.readUInt()), this.pointB = b.readVector3())
            },SEA3D.P2PConstraint = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, SEA3D.Constraints.call(this, a, b, c)
            },SEA3D.P2PConstraint.prototype = Object.create(SEA3D.Constraints.prototype),SEA3D.P2PConstraint.prototype.constructor = SEA3D.P2PConstraint,SEA3D.P2PConstraint.prototype.type = "p2pc",SEA3D.HingeConstraint = function (a, b, c) {
                SEA3D.Constraints.call(this, a, b, c), this.axisA = b.readVector3(), 1 & this.attrib && (this.axisB = b.readVector3()), 4 & this.attrib && (this.limit = {
                    low: b.readFloat(),
                    high: b.readFloat(),
                    softness: b.readFloat(),
                    biasFactor: b.readFloat(),
                    relaxationFactor: b.readFloat()
                }), 8 & this.attrib && (this.angularMotor = {velocity: b.readFloat(), impulse: b.readFloat()})
            },SEA3D.HingeConstraint.prototype = Object.create(SEA3D.Constraints.prototype),SEA3D.HingeConstraint.prototype.constructor = SEA3D.HingeConstraint,SEA3D.HingeConstraint.prototype.type = "hnec",SEA3D.ConeTwistConstraint = function (a, b, c) {
                SEA3D.Constraints.call(this, a, b, c), this.axisA = b.readVector3(), 1 & this.attrib && (this.axisB = b.readVector3()), 4 & this.attrib && (this.limit = {
                    swingSpan1: b.readFloat(),
                    swingSpan2: b.readFloat(),
                    twistSpan: b.readFloat(),
                    softness: b.readFloat(),
                    biasFactor: b.readFloat(),
                    relaxationFactor: b.readFloat()
                })
            },SEA3D.ConeTwistConstraint.prototype = Object.create(SEA3D.Constraints.prototype),SEA3D.ConeTwistConstraint.prototype.constructor = SEA3D.ConeTwistConstraint,SEA3D.ConeTwistConstraint.prototype.type = "ctwc",SEA3D.PlanarRender = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.attrib = b.readUByte(), this.quality = 1 & this.attrib | 2 & this.attrib, this.transform = b.readMatrix()
            },SEA3D.PlanarRender.prototype.type = "rttp",SEA3D.CubeRender = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.attrib = b.readUByte(), this.quality = 1 & this.attrib | 2 & this.attrib, this.position = b.readVector3()
            },SEA3D.CubeRender.prototype.type = "rttc",SEA3D.CubeMap = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.transparent = !1;
                b.readExt();
                this.faces = [];
                for (var d = 0; 6 > d; d++) {
                    var e = b.readUInt();
                    this.faces[d] = b.concat(b.position, e), b.position += e
                }
            },SEA3D.CubeMap.prototype.type = "cmap",SEA3D.JPEG = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.transparent = !1
            },SEA3D.JPEG.prototype.type = "jpg",SEA3D.JPEG_XR = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.transparent = !0
            },SEA3D.JPEG_XR.prototype.type = "wdp",SEA3D.PNG = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.transparent = 6 == b.getByte(25)
            },SEA3D.PNG.prototype.type = "png",SEA3D.GIF = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c, this.transparent = b.getByte(11) > 0
            },SEA3D.GIF.prototype.type = "gif",SEA3D.OGG = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c
            },SEA3D.OGG.prototype.type = "ogg",SEA3D.MP3 = function (a, b, c) {
                this.name = a, this.data = b, this.sea3d = c
            },SEA3D.MP3.prototype.type = "mp3",SEA3D.File = function (a) {
                this.config = {
                    streaming: !0,
                    timeLimit: 60
                }, a && (void 0 !== a.streaming && (this.config.streaming = a.streaming), void 0 !== a.timeLimit && (this.config.timeLimit = a.timeLimit)), this.version = SEA3D.VERSION, this.objects = [], this.typeClass = {}, this.typeRead = {}, this.typeUnique = {}, this.position = this.dataPosition = 0, this.scope = this, this.addClass(SEA3D.FileInfo, !0), this.addClass(SEA3D.Geometry, !0), this.addClass(SEA3D.GeometryDelta, !0), this.addClass(SEA3D.Mesh), this.addClass(SEA3D.Sprite), this.addClass(SEA3D.Material), this.addClass(SEA3D.Composite), this.addClass(SEA3D.PointLight), this.addClass(SEA3D.DirectionalLight), this.addClass(SEA3D.HemisphereLight), this.addClass(SEA3D.AmbientLight), this.addClass(SEA3D.Skeleton, !0), this.addClass(SEA3D.SkeletonLocal, !0), this.addClass(SEA3D.SkeletonAnimation, !0), this.addClass(SEA3D.JointObject), this.addClass(SEA3D.Camera), this.addClass(SEA3D.OrthographicCamera), this.addClass(SEA3D.Morph, !0), this.addClass(SEA3D.VertexAnimation, !0), this.addClass(SEA3D.CubeMap, !0), this.addClass(SEA3D.Animation), this.addClass(SEA3D.Dummy), this.addClass(SEA3D.Line), this.addClass(SEA3D.SoundPoint), this.addClass(SEA3D.PlanarRender), this.addClass(SEA3D.CubeRender), this.addClass(SEA3D.Actions), this.addClass(SEA3D.Container3D), this.addClass(SEA3D.Properties), this.addClass(SEA3D.TextureURL, !0), this.addClass(SEA3D.Sphere), this.addClass(SEA3D.Box), this.addClass(SEA3D.Cone), this.addClass(SEA3D.Capsule), this.addClass(SEA3D.Cylinder), this.addClass(SEA3D.ConvexGeometry), this.addClass(SEA3D.TriangleGeometry), this.addClass(SEA3D.Compound), this.addClass(SEA3D.RigidBody), this.addClass(SEA3D.P2PConstraint), this.addClass(SEA3D.HingeConstraint), this.addClass(SEA3D.ConeTwistConstraint), this.addClass(SEA3D.CarController), this.addClass(SEA3D.JPEG, !0), this.addClass(SEA3D.JPEG_XR, !0), this.addClass(SEA3D.PNG, !0), this.addClass(SEA3D.GIF, !0), this.addClass(SEA3D.OGG, !0), this.addClass(SEA3D.MP3, !0), this.addClass(SEA3D.JavaScript, !0), this.addClass(SEA3D.JavaScriptMethod, !0), this.addClass(SEA3D.GLSL, !0)
            },SEA3D.File.CompressionLibs = {},SEA3D.File.DecompressionMethod = {},SEA3D.File.setDecompressionEngine = function (a, b, c) {
                SEA3D.File.CompressionLibs[a] = b, SEA3D.File.DecompressionMethod[a] = c
            },SEA3D.File.prototype.addClass = function (a, b) {
                this.typeClass[a.prototype.type] = a, this.typeUnique[a.prototype.type] = b === !0
            },SEA3D.File.prototype.readHead = function () {
                if (this.stream.bytesAvailable < 16)return !1;
                if ("SEA" != this.stream.readUTF(3))throw new Error("Invalid SEA3D format.");
                if (this.sign = this.stream.readUTF(3), this.version = this.stream.readUInt24(), 0 != this.stream.readUByte())throw new Error("Protection algorithm not compatible.");
                if (this.compressionID = this.stream.readUByte(), this.compressionAlgorithm = SEA3D.File.CompressionLibs[this.compressionID], this.decompressionMethod = SEA3D.File.DecompressionMethod[this.compressionID], this.compressionID > 0 && !this.decompressionMethod)throw new Error("Compression algorithm not compatible.");
                return this.length = this.stream.readUInt(), this.dataPosition = this.stream.position, this.objects.length = 0, this.state = this.readBody, this.onHead && this.onHead({
                    file: this,
                    sign: this.sign
                }), !0
            },SEA3D.File.prototype.getObject = function (a) {
                return this.objects[a]
            },SEA3D.File.prototype.readSEAObject = function () {
                if (this.stream.bytesAvailable < 4)return null;
                var a = this.stream.readUInt(), b = this.stream.position;
                if (this.stream.bytesAvailable < a)return null;
                var c = this.stream.readUByte(), d = this.stream.readExt(), e = null, f = 1 & c ? this.stream.readUTF8() : "", g = 0 != (2 & c), h = 0 != (4 & c);
                if (8 & c) {
                    var i = this.stream.readUShort(), j = this.stream.concat(this.stream.position, i);
                    this.stream.position += i, g && this.decompressionMethod && (j.buffer = this.decompressionMethod(j.buffer)), e = j.readProperties(this)
                }
                a -= this.stream.position - b, b = this.stream.position;
                var k, l = this.stream.concat(b, a);
                return this.typeClass[d] ? (g && this.decompressionMethod && (l.buffer = this.decompressionMethod(l.buffer)), k = new this.typeClass[d](f, l, this), this.config.streaming && h && this.typeRead[d] && this.typeRead[d].call(this.scope, k)) : (k = new SEA3D.Object(f, l, d, this), console.warn('SEA3D: Unknown format "' + d + '" of file "' + f + '". Add a module referring for this format.')), k.streaming = h, k.metadata = e, this.objects.push(this.objects[k.type + "/" + k.name] = k), this.dataPosition = b + a, ++this.position, k
            },SEA3D.File.prototype.isDone = function () {
                return this.position == this.length
            },SEA3D.File.prototype.readBody = function () {
                for (this.timer.update(); this.position < this.length;) {
                    if (!(this.timer.deltaTime < this.config.timeLimit))return !1;
                    this.stream.position = this.dataPosition;
                    var a = this.readSEAObject();
                    if (!a)return !1;
                    this.dispatchCompleteObject(a)
                }
                return this.state = this.readComplete, !0
            },SEA3D.File.prototype.parse = function () {
                this.timer = new SEA3D.Timer, this.position = 0, isFinite(this.config.timeLimit) ? setTimeout(this.parseObject.bind(this), 10) : this.parseObject()
            },SEA3D.File.prototype.parseObject = function () {
                for (this.timer.update(); this.position < this.length && this.timer.deltaTime < this.config.timeLimit;) {
                    var a = this.objects[this.position++], b = a.type;
                    this.typeUnique[b] || delete a.tag, a.streaming && this.typeRead[b] && void 0 == a.tag && this.typeRead[b].call(this.scope, a)
                }
                if (this.position == this.length) {
                    var c = this.timer.elapsedTime, d = c + "ms, " + this.objects.length + " objects";
                    this.onParseComplete ? this.onParseComplete({
                        file: this,
                        timeTotal: c,
                        message: d
                    }) : console.log("SEA3D Parse Complete:", d)
                } else this.onParseProgress && this.onParseProgress({
                    file: this,
                    loaded: this.position,
                    total: this.length,
                    progress: this.position / this.length
                }), setTimeout(this.parseObject.bind(this), 10)
            },SEA3D.File.prototype.readComplete = function () {
                this.stream.position = this.dataPosition, 6202321 != this.stream.readUInt24F() && console.warn("SEA3D file is corrupted."), delete this.state, this.dispatchComplete()
            },SEA3D.File.prototype.readState = function () {
                for (; this.state && this.state(););
                this.state && (setTimeout(this.readState.bind(this), 10), this.dispatchProgress())
            },SEA3D.File.prototype.read = function (a) {
                this.stream = new SEA3D.Stream(a), this.timer = new SEA3D.Timer, this.state = this.readHead, this.readState()
            },SEA3D.File.prototype.dispatchCompleteObject = function (a) {
                this.onCompleteObject && this.onCompleteObject({file: this, object: a})
            },SEA3D.File.prototype.dispatchProgress = function () {
                this.onProgress && this.onProgress({
                    file: this,
                    loaded: this.position,
                    total: this.length,
                    progress: this.position / this.length
                })
            },SEA3D.File.prototype.dispatchDownloadProgress = function (a, b) {
                this.onDownloadProgress && this.onDownloadProgress({file: this, loaded: a, total: b, progress: a / b})
            },SEA3D.File.prototype.dispatchComplete = function () {
                var a = this.timer.elapsedTime, b = a + "ms, " + this.objects.length + " objects";
                this.onComplete ? this.onComplete({file: this, timeTotal: a, message: b}) : console.log("SEA3D:", b)
            },SEA3D.File.prototype.dispatchError = function (a, b) {
                this.onError ? this.onError({file: this, id: a, message: b}) : console.error("SEA3D: #" + a, b)
            },SEA3D.File.prototype.load = function (a) {
                var b = this, c = new XMLHttpRequest;
                c.open("GET", a, !0), c.responseType = "arraybuffer", c.onprogress = function (a) {
                    a.lengthComputable && b.dispatchDownloadProgress(a.loaded, a.total)
                }, c.onreadystatechange = function () {
                    2 === c.readyState || 3 === c.readyState || 4 === c.readyState && (200 === c.status || 0 === c.status ? b.read(this.response) : this.dispatchError(1001, "Couldn't load [" + a + "] [" + c.status + "]"))
                }, c.send()
            },SEA3D.AnimationBlendMethod = {LINEAR: "linear", EASING: "easing"},SEA3D.AnimationFrame = function () {
                this.data = [0, 0, 0, 0]
            },SEA3D.AnimationFrame.prototype.toVector = function () {
                return {x: this.data[0], y: this.data[1], z: this.data[2], w: this.data[3]}
            },SEA3D.AnimationFrame.prototype.toAngles = function (a) {
                var b = this.data[0], c = this.data[1], d = this.data[2], e = this.data[3], f = 2 * (e * c - d * b);
                return -1 > f ? f = -1 : f > 1 && (f = 1), {
                    x: Math.atan2(2 * (e * b + c * d), 1 - 2 * (b * b + c * c)) * a,
                    y: Math.asin(f) * a,
                    z: Math.atan2(2 * (e * d + b * c), 1 - 2 * (c * c + d * d)) * a
                }
            },SEA3D.AnimationFrame.prototype.toEuler = function () {
                return this.toAngles(SEA3D.Math.DEGREES)
            },SEA3D.AnimationFrame.prototype.toRadians = function () {
                return this.toAngles(1)
            },SEA3D.AnimationFrame.prototype.setX = function (a) {
                this.data[0] = a
            },SEA3D.AnimationFrame.prototype.getX = function () {
                return this.data[0]
            },SEA3D.AnimationFrame.prototype.setY = function (a) {
                this.data[1] = a
            },SEA3D.AnimationFrame.prototype.getY = function () {
                return this.data[1]
            },SEA3D.AnimationFrame.prototype.setZ = function (a) {
                this.data[2] = a
            },SEA3D.AnimationFrame.prototype.getZ = function () {
                return this.data[2]
            },SEA3D.AnimationFrame.prototype.setW = function (a) {
                this.data[3] = a
            },SEA3D.AnimationFrame.prototype.getW = function () {
                return this.data[3]
            },SEA3D.AnimationData = function (a, b, c, d) {
                switch (this.kind = a, this.type = b, this.blockLength = SEA3D.Stream.sizeOf(b), this.data = c, this.offset = void 0 == d ? 0 : d, this.blockLength) {
                    case 1:
                        this.getData = this.getData1x;
                        break;
                    case 2:
                        this.getData = this.getData2x;
                        break;
                    case 3:
                        this.getData = this.getData3x;
                        break;
                    case 4:
                        this.getData = this.getData4x
                }
            },SEA3D.AnimationData.prototype.getData1x = function (a, b) {
                a = this.offset + a * this.blockLength, b[0] = this.data[a]
            },SEA3D.AnimationData.prototype.getData2x = function (a, b) {
                a = this.offset + a * this.blockLength, b[0] = this.data[a], b[1] = this.data[a + 1]
            },SEA3D.AnimationData.prototype.getData3x = function (a, b) {
                a = this.offset + a * this.blockLength, b[0] = this.data[a], b[1] = this.data[a + 1], b[2] = this.data[a + 2]
            },SEA3D.AnimationData.prototype.getData4x = function (a, b) {
                a = this.offset + a * this.blockLength, b[0] = this.data[a], b[1] = this.data[a + 1], b[2] = this.data[a + 2], b[3] = this.data[a + 3]
            },SEA3D.AnimationNode = function (a, b, c, d, e) {
                this.name = a, this.frameRate = b, this.frameMill = 1e3 / b, this.numFrames = c, this.length = c - 1, this.time = 0, this.duration = this.length * this.frameMill, this.repeat = d, this.intrpl = e, this.invalidState = !0, this.dataList = [], this.dataListId = {}, this.buffer = new SEA3D.AnimationFrame, this.percent = 0, this.prevFrame = 0, this.nextFrame = 0, this.frame = 0
            },SEA3D.AnimationNode.prototype.setTime = function (a) {
                this.frame = this.validFrame(a / this.frameMill), this.time = this.frame * this.frameRate, this.invalidState = !0
            },SEA3D.AnimationNode.prototype.getTime = function () {
                return this.time
            },SEA3D.AnimationNode.prototype.setFrame = function (a) {
                this.setTime(a * this.frameMill)
            },SEA3D.AnimationNode.prototype.getRealFrame = function () {
                return Math.floor(this.frame)
            },SEA3D.AnimationNode.prototype.getFrame = function () {
                return this.frame
            },SEA3D.AnimationNode.prototype.setPosition = function (a) {
                this.setFrame(a * (this.numFrames - 1))
            },SEA3D.AnimationNode.prototype.getPosition = function () {
                return this.frame / (this.numFrames - 1)
            },SEA3D.AnimationNode.prototype.validFrame = function (a) {
                var b = 0 > a;
                return b && (a = -a), a > this.length && (a = this.repeat ? a % this.length : this.length), b && (a = this.length - a), a
            },SEA3D.AnimationNode.prototype.addData = function (a) {
                this.dataListId[a.kind] = a, this.dataList[this.dataList.length] = a
            },SEA3D.AnimationNode.prototype.removeData = function (a) {
                delete this.dataListId[a.kind], this.dataList.splice(this.dataList.indexOf(a), 1)
            },SEA3D.AnimationNode.prototype.getDataByKind = function (a) {
                return this.dataListId[a]
            },SEA3D.AnimationNode.prototype.getFrameAt = function (a, b) {
                return this.dataListId[b].getFrameData(a, this.buffer.data), this.buffer
            },SEA3D.AnimationNode.prototype.getFrame = function (a) {
                return this.dataListId[a].getFrameData(this.getRealFrame(), this.buffer.data), this.buffer
            },SEA3D.AnimationNode.prototype.getInterpolationFrame = function (a, b) {
                return 0 == this.numFrames ? this.buffer : (this.invalidState && (this.prevFrame = this.getRealFrame(), this.nextFrame = this.validFrame(this.prevFrame + 1), this.percent = this.frame - this.prevFrame, this.invalidState = !1), a.getData(this.prevFrame, this.buffer.data), this.percent > 0 && (a.getData(this.nextFrame, SEA3D.AnimationNode.FRAME_BUFFER), b(this.buffer.data, SEA3D.AnimationNode.FRAME_BUFFER, this.percent)), this.buffer)
            },SEA3D.AnimationNode.FRAME_BUFFER = [0, 0, 0, 0],SEA3D.AnimationSet = function () {
                this.animations = [], this.dataCount = -1
            },SEA3D.AnimationSet.prototype.addAnimation = function (a) {
                -1 == this.dataCount && (this.dataCount = a.dataList.length), this.animations[a.name] = a, this.animations.push(a)
            },SEA3D.AnimationSet.prototype.getAnimationByName = function (a) {
                return this.animations[a]
            },SEA3D.AnimationState = function (a) {
                this.node = a, this.offset = 0, this.weight = 0, this.time = 0
            },SEA3D.AnimationState.prototype.setTime = function (a) {
                this.node.time = this.time = a
            },SEA3D.AnimationState.prototype.getTime = function () {
                return this.time
            },SEA3D.AnimationState.prototype.setFrame = function (a) {
                this.node.setFrame(a), this.time = this.node.time
            },SEA3D.AnimationState.prototype.getFrame = function () {
                return this.update(), this.node.getFrame()
            },SEA3D.AnimationState.prototype.setPosition = function (a) {
                this.node.setPosition(a), this.time = this.node.time
            },SEA3D.AnimationState.prototype.getPosition = function () {
                return this.update(), this.node.getPosition()
            },SEA3D.AnimationState.prototype.update = function () {
                this.node.time != this.time && this.node.setTime(this.time)
            },SEA3D.AnimationHandler = function (a) {
                this.animationSet = a, this.states = SEA3D.AnimationHandler.stateFromAnimations(a.animations), this.timeScale = 1, this.time = 0, this.numAnimation = a.animations.length, this.relative = !1, this.playing = !1, this.delta = 0, this.easeSpeed = 2, this.crossfade = 0, this.updateAllStates = !1, this.blendMethod = SEA3D.AnimationBlendMethod.LINEAR
            },SEA3D.AnimationHandler.prototype.update = function (a) {
                this.delta = a, this.time += a * this.timeScale, this.updateState(), this.updateAnimation()
            },SEA3D.AnimationHandler.prototype.updateState = function () {
                var a, b, c;
                if (this.currentState.node.setTime(this.time - this.currentState.offset), this.currentState.weight < 1 && this.crossfade > 0) {
                    var d = Math.abs(this.delta) / (1e3 * this.crossfade), e = 1;
                    for (this.blendMethod === SEA3D.AnimationBlendMethod.EASING && (d *= this.easeSpeed), a = 0, b = this.states.length; b > a; ++a)c = this.states[a], c.weight > 0 && c !== this.currentState && (this.blendMethod === SEA3D.AnimationBlendMethod.LINEAR ? c.weight -= d : this.blendMethod === SEA3D.AnimationBlendMethod.EASING && (c.weight -= c.weight * d), c.weight < 0 && (c.weight = 0), e -= c.weight, this.updateAllStates && c.node.setTime(this.time - c.offset));
                    0 > e && (e = 0), this.currentState.weight = e
                } else for (a = 0; a < this.states.length; ++a)c = this.states[a], c === this.currentState ? c.weight = 1 : (c.weight = 0, this.updateAllStates && c.node.setTime(this.time))
            },SEA3D.AnimationHandler.prototype.updateAnimation = function () {
                for (var a = this.animationSet.dataCount, b = this.animationSet.animations, c = this.currentState.node, d = 0; a > d; d++)for (var e = 0; e < b.length; e++) {
                    var f, g = b[e], h = this.states[e], i = g.dataList[d], j = SEA3D.Animation.DefaultLerpFuncs[i.kind];
                    0 == e && (f = c.getInterpolationFrame(c.dataList[d], j), c.repeat || c.frame != c.numFrames - 1 || this.onComplete && this.onComplete(this)), g != c && h.weight > 0 && j(f.data, g.getInterpolationFrame(i, j).data, h.weight), this.updateAnimationFrame && this.updateAnimationFrame(f, i.kind)
                }
            },SEA3D.AnimationHandler.prototype.getStateByName = function (a) {
                return this.states[a]
            },SEA3D.AnimationHandler.prototype.getStateNameByIndex = function (a) {
                return this.animationSet.animations[a].name
            },SEA3D.AnimationHandler.prototype.play = function (a, b, c) {
                if (this.currentState = this.getStateByName(a), !this.currentState)throw new Error('Animation "' + a + '" not found.');
                this.crossfade = b, this.currentState.offset = this.time, void 0 !== c && (this.currentState.time = c), this.playing || (SEA3D.AnimationHandler.add(this), this.playing = !0)
            },SEA3D.AnimationHandler.prototype.resume = function () {
                this.playing || (SEA3D.AnimationHandler.add(this), this.playing = !0)
            },SEA3D.AnimationHandler.prototype.pause = function () {
                this.playing && (SEA3D.AnimationHandler.remove(this), this.playing = !1)
            },SEA3D.AnimationHandler.prototype.stop = function () {
                this.time = 0, this.pause()
            },SEA3D.AnimationHandler.prototype.setRelative = function (a) {
                this.relative = a
            },SEA3D.AnimationHandler.prototype.getRelative = function () {
                return this.relative
            },SEA3D.AnimationHandler.add = function (a) {
                SEA3D.AnimationHandler.animations.push(a)
            },SEA3D.AnimationHandler.remove = function (a) {
                SEA3D.AnimationHandler.animations.splice(SEA3D.AnimationHandler.animations.indexOf(a), 1)
            },SEA3D.AnimationHandler.stateFromAnimations = function (a) {
                for (var b = [], c = 0; c < a.length; c++)b[a[c].name] = b[c] = new SEA3D.AnimationState(a[c]);
                return b
            },SEA3D.AnimationHandler.update = function (a) {
                for (var b = 0, c = SEA3D.AnimationHandler.animations.length; c > b; b++)SEA3D.AnimationHandler.animations[b].update(1e3 * a)
            },SEA3D.AnimationHandler.setTime = function (a) {
                for (var b = 0, c = SEA3D.AnimationHandler.animations.length; c > b; b++)SEA3D.AnimationHandler.animations[b].time = a
            },SEA3D.AnimationHandler.stop = function () {
                for (; SEA3D.AnimationHandler.animations.length;)SEA3D.AnimationHandler.animations[0].stop()
            },SEA3D.AnimationHandler.animations = [],THREE.SEA3D = function (a) {
                this.config = {
                    id: "",
                    scripts: !0,
                    runScripts: !0,
                    autoPlay: !1,
                    dummys: !0,
                    multiplier: 1,
                    bounding: !0,
                    audioRolloffFactor: 10,
                    lights: !0,
                    useVertexTexture: !0,
                    forceStatic: !1,
                    streaming: !0,
                    timeLimit: 10,
                    stageWidth: window ? window.innerWidth : 1024,
                    stageHeight: window ? window.innerHeight : 1024
                }, a && this.loadConfig(a)
            },THREE.SEA3D.prototype = {
                constructor: THREE.SEA3D, set container(a) {
                    this.config.container = a
                }, get container() {
                    return this.config.container
                }
            },Object.assign(THREE.SEA3D.prototype, THREE.EventDispatcher.prototype),THREE.SEA3D.BACKGROUND_COLOR = 3355443,THREE.SEA3D.HELPER_COLOR = 10140133,THREE.SEA3D.RTT_SIZE = 512,THREE.SEA3D.Domain = function (a, b, c) {
                this.id = a, this.objects = b, this.container = c, this.scripts = [], this.global = {}, this.scriptTargets = [], this.events = new THREE.EventDispatcher
            },THREE.SEA3D.Domain.prototype = {
                constructor: THREE.SEA3D.Domain, add: function (a) {
                    this.scripts.push(a)
                }, remove: function (a) {
                    this.scripts.splice(this.scripts.indexOf(a), 1)
                }, contains: function (a) {
                    return -1 != this.scripts.indexOf(a)
                }, addEvent: function (a, b) {
                    this.events.addEventListener(a, b)
                }, hasEvent: function (a, b) {
                    return this.events.hasEventListener(a, b)
                }, removeEvent: function (a, b) {
                    this.events.removeEventListener(a, b)
                }, print: function () {
                    console.log.apply(console, arguments)
                }, watch: function () {
                    console.log.apply(console, "watch:", arguments)
                }, runScripts: function () {
                    for (var a = 0; a < this.scriptTargets.length; a++)this.runJSMList(this.scriptTargets[a])
                }, runJSMList: function (a) {
                    for (var b = a.scripts, c = 0; c < b.length; c++)this.runJSM(a, b[c]);
                    return b
                }, runJSM: function (a, b) {
                    void 0 == a.local && (a.local = {});
                    var c = {
                        print: this.print,
                        watch: this.watch,
                        sea3d: this,
                        scene: this.container,
                        source: new THREE.SEA3D.ScriptDomain(this, a instanceof THREE.SEA3D.Domain)
                    };
                    Object.freeze(c.source), THREE.SEA3D.ScriptHandler.add(c.source);
                    try {
                        this.methods[b.method](c, this.getReference, this.global, a.local, a, b.params)
                    } catch (d) {
                        console.error('SEA3D JavaScript: Error running method "' + b.method + '".'), console.error(d)
                    }
                }, getReference: function (ns) {
                    return eval(ns)
                }, disposeList: function (a) {
                    if (a && a.length) {
                        a = a.concat();
                        for (var b = a.length; b--;)a[b].dispose()
                    }
                }, dispatchEvent: function (a) {
                    a.domain = this;
                    for (var b = this.scripts.concat(), c = b.length; c--;)b[c].dispatchEvent(a);
                    this.events.dispatchEvent(a)
                }, dispose: function () {
                    for (this.disposeList(this.scripts); this.container.children.length;)this.container.remove(this.container.children[0]);
                    for (var a = THREE.SEA3D.EXTENSIONS_DOMAIN.length; a--;) {
                        var b = THREE.SEA3D.EXTENSIONS_DOMAIN[a];
                        b.dispose && b.dispose.call(this)
                    }
                    this.disposeList(this.materials), this.disposeList(this.dummys), this.dispatchEvent({type: "dispose"})
                }
            },THREE.SEA3D.DomainManager = function (a) {
                this.domains = [], this.autoDisposeRootDomain = void 0 == a ? !0 : !1
            },THREE.SEA3D.DomainManager.prototype = {
                constructor: THREE.SEA3D.DomainManager,
                onDisposeDomain: function (a) {
                    this.remove(a.domain), this.autoDisposeRootDomain && 1 == this.domains.length && this.dispose()
                },
                add: function (a) {
                    this._onDisposeDomain = this._onDisposeDomain || this.onDisposeDomain.bind(this), a.on("dispose", this._onDisposeDomain), this.domains.push(a), this.textures = this.textures || a.textures, this.cubemaps = this.cubemaps || a.cubemaps, this.geometries = this.geometries || a.geometries
                },
                remove: function (a) {
                    a.removeEvent("dispose", this._onDisposeDomain), this.domains.splice(this.domains.indexOf(a), 1)
                },
                contains: function (a) {
                    return -1 != this.domains.indexOf(a)
                },
                disposeList: function (a) {
                    if (a && a.length) {
                        a = a.concat();
                        for (var b = a.length; b--;)a[b].dispose()
                    }
                },
                dispose: function () {
                    this.disposeList(this.domains), this.disposeList(this.textures), this.disposeList(this.cubemaps), this.disposeList(this.geometries)
                }
            },THREE.SEA3D.ScriptDomain = function (a, b) {
                a = a || new THREE.SEA3D.Domain, a.add(this);
                var c = new THREE.EventDispatcher;
                this.getId = function () {
                    return a.id
                }, this.isRoot = function () {
                    return b
                }, this.addEvent = function (a, b) {
                    c.addEventListener(a, b)
                }, this.hasEvent = function (a, b) {
                    return c.hasEventListener(a, b)
                }, this.removeEvent = function (a, b) {
                    c.removeEventListener(a, b)
                }, this.dispatchEvent = function (a) {
                    a.script = this, c.dispatchEvent(a)
                }, this.dispose = function () {
                    a.remove(this), b && a.dispose(), this.dispatchEvent({type: "dispose"})
                }
            },THREE.SEA3D.ScriptManager = function () {
                this.scripts = [];
                var a = function (a) {
                    this.remove(a.script)
                }.bind(this);
                this.add = function (b) {
                    b.addEvent("dispose", a), this.scripts.push(b)
                }, this.remove = function (b) {
                    b.removeEvent("dispose", a), this.scripts.splice(this.scripts.indexOf(b), 1)
                }, this.contains = function (a) {
                    return this.scripts.indexOf(a) > -1
                }, this.dispatchEvent = function (a) {
                    for (var b = this.scripts.concat(), c = b.length; c--;)b[c].dispatchEvent(a)
                }
            },THREE.SEA3D.ScriptHandler = new THREE.SEA3D.ScriptManager,THREE.SEA3D.ScriptHandler.dispatchUpdate = function (a) {
                this.dispatchEvent({type: "update", delta: a})
            },THREE.SEA3D.Animator = function (a, b) {
                this.clips = a, this.updateAnimations(b)
            },THREE.SEA3D.Animator.prototype.update = function () {
                this.currentAnimationAction.enabled || this.currentAnimationData.completed || (this.currentAnimationData.completed = !0, this.currentAnimationData.onComplete && this.currentAnimationData.onComplete(this))
            },THREE.SEA3D.Animator.prototype.updateAnimations = function (a) {
                this.playing && this.stop(), this.animationTarget && THREE.SEA3D.AnimationHandler.removeAnimator(this), this.animationTarget = a, this.relative = !1, this.playing = !1, this.timeScale = 1, this.animations = [], this.animationsData = {};
                for (var b = this instanceof THREE.SEA3D.Animator ? this.clips : this.geometry.animations, c = 0; c < b.length; c++) {
                    var d = b[c].name;
                    this.animations[d] = this.animations[c] = b[c], this.animationsData[d] = this.animationsData[c] = {}
                }
            },THREE.SEA3D.Animator.prototype.getStateByName = function (a) {
                return this.animations.indexOf(this.animations[a])
            },THREE.SEA3D.Animator.prototype.getStateNameByIndex = function (a) {
                return this.animations[a].name
            },THREE.SEA3D.Animator.prototype.pause = function () {
                this.playing && this.currentAnimation && (THREE.SEA3D.AnimationHandler.removeAnimator(this), this.playing = !1)
            },THREE.SEA3D.Animator.prototype.resume = function () {
                !this.playing && this.currentAnimation && (THREE.SEA3D.AnimationHandler.addAnimator(this), this.playing = !0)
            },THREE.SEA3D.Animator.prototype.setTimeScale = function (a) {
                this.timeScale = a, this.currentAnimationAction && this.updateTimeScale()
            },THREE.SEA3D.Animator.prototype.getTimeScale = function () {
                return this.timeScale
            },THREE.SEA3D.Animator.prototype.updateTimeScale = function () {
                this.currentAnimationAction.setEffectiveTimeScale(this.timeScale * (this.currentAnimation ? this.currentAnimation.timeScale : 1))
            },THREE.SEA3D.Animator.prototype.play = function (a, b, c, d) {
                var e = this.animations[a];
                if (e != this.currentAnimation || void 0 !== c) {
                    if (!e)throw new Error('Animation "' + a + '" not found.');
                    if (this.previousAnimation = this.currentAnimation, this.currentAnimation = e, this.previousAnimationAction = this.currentAnimationAction, this.currentAnimationAction = THREE.SEA3D.AnimationHandler.mixer.clipAction(e, this.animationTarget).setLoop(e.loop ? THREE.LoopRepeat : THREE.LoopOnce, 1 / 0).reset(), this.previousAnimationData = this.currentAnimationData, this.currentAnimationData = this.animationsData[a], this.currentAnimationData.completed = !1, void 0 !== d && this.currentAnimationAction.setEffectiveWeight(d), this.updateTimeScale(), this.currentAnimationAction.play(), this.playing || THREE.SEA3D.AnimationHandler.mixer.update(0), this.playing = !0, this.previousAnimation) {
                        var f = THREE.SEA3D.AnimationHandler.mixer.clipAction(this.currentAnimation, this.animationTarget);
                        THREE.SEA3D.AnimationHandler.mixer.clipAction(this.previousAnimation, this.animationTarget).crossFadeTo(f, b || 0, !0)
                    }
                    THREE.SEA3D.AnimationHandler.addAnimator(this)
                }
            },THREE.SEA3D.Animator.prototype.stop = function () {
                this.currentAnimation && (this.currentAnimationAction.stop(), THREE.SEA3D.AnimationHandler.removeAnimator(this), this.previousAnimation = this.currentAnimation,
                    this.previousAnimationData = this.currentAnimationData, this.previousAnimationAction = this.currentAnimationAction, delete this.currentAnimationAction, delete this.currentAnimationData, delete this.currentAnimation, this.playing = !1)
            },THREE.SEA3D.Animator.prototype.setRelative = function (a) {
                this.relative != a && (this.stop(), this.relative = a)
            },THREE.SEA3D.Animator.prototype.getRelative = function () {
                return this.relative
            },THREE.SEA3D.Object3DAnimator = function (a, b) {
                this.object3d = b, THREE.SEA3D.Animator.call(this, a, new THREE.AnimationMixer(b))
            },THREE.SEA3D.Object3DAnimator.prototype = Object.create(THREE.SEA3D.Animator.prototype),THREE.SEA3D.Object3DAnimator.prototype.constructor = THREE.SEA3D.Object3DAnimator,THREE.SEA3D.Object3DAnimator.prototype.stop = function () {
                if (this.currentAnimation && this instanceof THREE.SEA3D.Object3DAnimator) {
                    var a = this.object3d.animate;
                    a.position.set(0, 0, 0), a.quaternion.set(0, 0, 0, 1), a.scale.set(1, 1, 1)
                }
                THREE.SEA3D.Animator.prototype.stop.call(this)
            },THREE.SEA3D.Object3DAnimator.prototype.setRelative = function (a) {
                THREE.SEA3D.Animator.prototype.setRelative.call(this, a), this.object3d.setAnimator(this.relative), this.updateAnimations(this.relative ? this.object3d.animate : this.object3d)
            },THREE.SEA3D.CameraAnimator = function (a, b) {
                THREE.SEA3D.Object3DAnimator.call(this, a, b)
            },THREE.SEA3D.CameraAnimator.prototype = Object.create(THREE.SEA3D.Object3DAnimator.prototype),THREE.SEA3D.CameraAnimator.prototype.constructor = THREE.SEA3D.CameraAnimator,THREE.SEA3D.LightAnimator = function (a, b) {
                THREE.SEA3D.Object3DAnimator.call(this, a, b)
            },THREE.SEA3D.LightAnimator.prototype = Object.create(THREE.SEA3D.Object3DAnimator.prototype),THREE.SEA3D.LightAnimator.prototype.constructor = THREE.SEA3D.LightAnimator,THREE.SEA3D.Object3D = function () {
                THREE.Object3D.call(this)
            },THREE.SEA3D.Object3D.prototype = Object.create(THREE.Object3D.prototype),THREE.SEA3D.Object3D.prototype.constructor = THREE.SEA3D.Object3D,THREE.SEA3D.Object3D.prototype.updateAnimateMatrix = function (a) {
                this.matrixAutoUpdate === !0 && this.updateMatrix(), (this.matrixWorldNeedsUpdate === !0 || a === !0) && (null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.animate.updateMatrix(), this.matrixWorld.multiplyMatrices(this.matrixWorld, this.animate.matrix), this.matrixWorldNeedsUpdate = !1, a = !0);
                for (var b = 0, c = this.children.length; c > b; b++)this.children[b].updateMatrixWorld(a)
            },THREE.SEA3D.Object3D.prototype.setAnimator = function (a) {
                this.getAnimator() != a && (a ? (this.animate = new THREE.Object3D, this.updateMatrixWorld = THREE.SEA3D.Object3D.prototype.updateAnimateMatrix) : (delete this.animate, this.updateMatrixWorld = THREE.Object3D.prototype.updateMatrixWorld), this.matrixWorldNeedsUpdate = !0)
            },THREE.SEA3D.Object3D.prototype.getAnimator = function () {
                return void 0 != this.animate
            },THREE.SEA3D.Dummy = function (a, b, c) {
                this.width = void 0 != a ? a : 100, this.height = void 0 != b ? b : 100, this.depth = void 0 != c ? c : 100;
                var d = new THREE.BoxGeometry(this.width, this.height, this.depth, 1, 1, 1);
                THREE.Mesh.call(this, d, THREE.SEA3D.Dummy.MATERIAL)
            },THREE.SEA3D.Dummy.prototype = Object.create(THREE.Mesh.prototype),THREE.SEA3D.Dummy.prototype.constructor = THREE.SEA3D.Dummy,Object.assign(THREE.SEA3D.Dummy.prototype, THREE.SEA3D.Object3D.prototype),THREE.SEA3D.Dummy.MATERIAL = new THREE.MeshBasicMaterial({
                wireframe: !0,
                color: THREE.SEA3D.HELPER_COLOR
            }),THREE.SEA3D.Dummy.prototype.copy = function (a) {
                return THREE.Mesh.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.Dummy.prototype.dispose = function () {
                this.geometry.dispose()
            },THREE.SEA3D.Mesh = function (a, b) {
                THREE.Mesh.call(this, a, b)
            },THREE.SEA3D.Mesh.prototype = Object.create(THREE.Mesh.prototype),THREE.SEA3D.Mesh.prototype.constructor = THREE.SEA3D.Mesh,Object.assign(THREE.SEA3D.Mesh.prototype, THREE.SEA3D.Object3D.prototype),THREE.SEA3D.Mesh.prototype.setWeight = function (a, b) {
                this.morphTargetInfluences[this.morphTargetDictionary[a]] = b
            },THREE.SEA3D.Mesh.prototype.getWeight = function (a) {
                return this.morphTargetInfluences[this.morphTargetDictionary[a]]
            },THREE.SEA3D.Mesh.prototype.copy = function (a) {
                return THREE.Mesh.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.SkinnedMesh = function (a, b, c) {
                THREE.SkinnedMesh.call(this, a, b, c), this.updateAnimations(this)
            },THREE.SEA3D.SkinnedMesh.prototype = Object.create(THREE.SkinnedMesh.prototype),THREE.SEA3D.SkinnedMesh.prototype.constructor = THREE.SEA3D.SkinnedMesh,Object.assign(THREE.SEA3D.SkinnedMesh.prototype, THREE.SEA3D.Object3D.prototype),Object.assign(THREE.SEA3D.SkinnedMesh.prototype, THREE.SEA3D.Animator.prototype),THREE.SEA3D.SkinnedMesh.prototype.boneByName = function (a) {
                for (var b = this.skeleton.bones, c = 0, d = b.length; d > c; c++)if (a == b[c].name)return b[c]
            },THREE.SEA3D.SkinnedMesh.prototype.copy = function (a) {
                return THREE.SkinnedMesh.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.VertexAnimationMesh = function (a, b) {
                THREE.Mesh.call(this, a, b), this.type = "MorphAnimMesh", this.updateAnimations(this)
            },THREE.SEA3D.VertexAnimationMesh.prototype = Object.create(THREE.Mesh.prototype),THREE.SEA3D.VertexAnimationMesh.prototype.constructor = THREE.SEA3D.VertexAnimationMesh,Object.assign(THREE.SEA3D.VertexAnimationMesh.prototype, THREE.SEA3D.Object3D.prototype),Object.assign(THREE.SEA3D.VertexAnimationMesh.prototype, THREE.SEA3D.Animator.prototype),THREE.SEA3D.VertexAnimationMesh.prototype.copy = function (a) {
                return THREE.Mesh.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.Camera = function (a, b, c, d) {
                THREE.PerspectiveCamera.call(this, a, b, c, d)
            },THREE.SEA3D.Camera.prototype = Object.create(THREE.PerspectiveCamera.prototype),THREE.SEA3D.Camera.prototype.constructor = THREE.SEA3D.Camera,Object.assign(THREE.SEA3D.Camera.prototype, THREE.SEA3D.Object3D.prototype),THREE.SEA3D.Camera.prototype.copy = function (a) {
                return THREE.PerspectiveCamera.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.OrthographicCamera = function (a, b, c, d, e, f) {
                THREE.OrthographicCamera.call(this, a, b, c, d, e, f)
            },THREE.SEA3D.OrthographicCamera.prototype = Object.create(THREE.OrthographicCamera.prototype),THREE.SEA3D.OrthographicCamera.prototype.constructor = THREE.SEA3D.OrthographicCamera,Object.assign(THREE.SEA3D.OrthographicCamera.prototype, THREE.SEA3D.Object3D.prototype),THREE.SEA3D.OrthographicCamera.prototype.copy = function (a) {
                return THREE.OrthographicCamera.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.PointLight = function (a, b, c, d) {
                THREE.PointLight.call(this, a, b, c, d)
            },THREE.SEA3D.PointLight.prototype = Object.create(THREE.PointLight.prototype),THREE.SEA3D.PointLight.prototype.constructor = THREE.SEA3D.PointLight,Object.assign(THREE.SEA3D.PointLight.prototype, THREE.SEA3D.Object3D.prototype),THREE.SEA3D.PointLight.prototype.copy = function (a) {
                return THREE.PointLight.prototype.copy.call(this, a), this.props = a.props, this.scripts = a.scripts, this.animation && (this.animation = a.animation.clone(this)), this
            },THREE.SEA3D.AnimationHandler = {
                mixer: new THREE.AnimationMixer, animators: [], update: function (a) {
                    this.mixer.update(a);
                    for (var b = 0; b < this.animators.length;)this.animators[b++].update()
                }, addAnimator: function (a) {
                    var b = this.animators.indexOf(a);
                    -1 === b && this.animators.push(a)
                }, removeAnimator: function (a) {
                    var b = this.animators.indexOf(a);
                    -1 !== b && this.animators.splice(this.animators.indexOf(a), 1)
                }
            },THREE.SEA3D.MTXBUF = new THREE.Matrix4,THREE.SEA3D.VECBUF = new THREE.Vector3,THREE.SEA3D.QUABUF = new THREE.Quaternion,THREE.SEA3D.prototype.setShadowMap = function (a) {
                a.shadow.mapSize.width = 2048, a.shadow.mapSize.height = 1024, a.castShadow = !0, a.shadow.camera.left = -200, a.shadow.camera.right = 200, a.shadow.camera.top = 200, a.shadow.camera.bottom = -200, a.shadow.camera.near = 1, a.shadow.camera.far = 3e3, a.shadow.camera.fov = 45, a.shadow.bias = -.001
            },THREE.SEA3D.Domain.prototype.getMesh = THREE.SEA3D.prototype.getMesh = function (a) {
                return this.objects["m3d/" + a]
            },THREE.SEA3D.Domain.prototype.getDummy = THREE.SEA3D.prototype.getDummy = function (a) {
                return this.objects["dmy/" + a]
            },THREE.SEA3D.Domain.prototype.getLine = THREE.SEA3D.prototype.getLine = function (a) {
                return this.objects["line/" + a]
            },THREE.SEA3D.Domain.prototype.getSound3D = THREE.SEA3D.prototype.getSound3D = function (a) {
                return this.objects["sn3d/" + a]
            },THREE.SEA3D.Domain.prototype.getMaterial = THREE.SEA3D.prototype.getMaterial = function (a) {
                return this.objects["mat/" + a]
            },THREE.SEA3D.Domain.prototype.getLight = THREE.SEA3D.prototype.getLight = function (a) {
                return this.objects["lht/" + a]
            },THREE.SEA3D.Domain.prototype.getGLSL = THREE.SEA3D.prototype.getGLSL = function (a) {
                return this.objects["glsl/" + a]
            },THREE.SEA3D.Domain.prototype.getCamera = THREE.SEA3D.prototype.getCamera = function (a) {
                return this.objects["cam/" + a]
            },THREE.SEA3D.Domain.prototype.getTexture = THREE.SEA3D.prototype.getTexture = function (a) {
                return this.objects["tex/" + a]
            },THREE.SEA3D.Domain.prototype.getCubeMap = THREE.SEA3D.prototype.getCubeMap = function (a) {
                return this.objects["cmap/" + a]
            },THREE.SEA3D.Domain.prototype.getJointObject = THREE.SEA3D.prototype.getJointObject = function (a) {
                return this.objects["jnt/" + a]
            },THREE.SEA3D.Domain.prototype.getContainer3D = THREE.SEA3D.prototype.getContainer3D = function (a) {
                return this.objects["c3d/" + a]
            },THREE.SEA3D.Domain.prototype.getSprite = THREE.SEA3D.prototype.getSprite = function (a) {
                return this.objects["m2d/" + a]
            },THREE.SEA3D.Domain.prototype.getProperties = THREE.SEA3D.prototype.getProperties = function (a) {
                return this.objects["prop/" + a]
            },THREE.SEA3D.prototype.isPowerOfTwo = function (a) {
                return a ? (a & -a) == a : !1
            },THREE.SEA3D.prototype.nearestPowerOfTwo = function (a) {
                return Math.pow(2, Math.round(Math.log(a) / Math.LN2))
            },THREE.SEA3D.prototype.updateTransform = function (a, b) {
                var c = THREE.SEA3D.MTXBUF, d = THREE.SEA3D.VECBUF;
                b.transform ? c.elements.set(b.transform) : c.makeTranslation(b.position.x, b.position.y, b.position.z), a.position.setFromMatrixPosition(c), a.scale.setFromMatrixScale(c), c.scale(d.set(1 / a.scale.x, 1 / a.scale.y, 1 / a.scale.z)), a.rotation.setFromRotationMatrix(c), (this.config.forceStatic || b.isStatic) && (a.updateMatrix(), a.matrixAutoUpdate = !1)
            },THREE.SEA3D.prototype.toVector3 = function (a) {
                return new THREE.Vector3(a.x, a.y, a.z)
            },THREE.SEA3D.prototype.updateScene = function () {
                if (void 0 != this.materials)for (var a = 0, b = this.materials.length; b > a; ++a)this.materials[a].needsUpdate = !0
            },THREE.SEA3D.prototype.addSceneObject = function (a) {
                var b = a.tag;
                b.visible = a.visible, a.parent ? a.parent.tag.add(b) : this.config.container && this.config.container.add(b), a.properties && (b.props = a.properties.tag), a.scripts && (b.scripts = this.getJSMList(b, a.scripts), this.config.runScripts && this.domain.runJSMList(b))
            },THREE.SEA3D.prototype.createObjectURL = function (a, b) {
                return (window.URL || window.webkitURL).createObjectURL(new Blob([a], {type: b}))
            },THREE.SEA3D.prototype.bufferToTexture = function (a) {
                return this.createObjectURL(a, "image")
            },THREE.SEA3D.prototype.bufferToSound = function (a) {
                return this.createObjectURL(a, "audio")
            },THREE.SEA3D.prototype.applyDefaultAnimation = function (a, b) {
                for (var c = a.tag, d = 0, e = a.animations ? a.animations.length : 0; e > d; d++) {
                    var f = a.animations[d];
                    switch (f.tag.type) {
                        case SEA3D.Animation.prototype.type:
                            return c.animation = new b(f.tag.tag, c), c.animation.setRelative(f.relative), this.config.autoPlay && c.animation.play(0), c.animation
                    }
                }
            },THREE.SEA3D.prototype.readAnimation = function (a) {
                for (var b = [], c = 1e3 / a.frameRate / 1e3, d = 0; d < a.sequence.length; d++)for (var e = a.sequence[d], f = [], g = 0; g < a.dataList.length; g++) {
                    var h, i, j = a.dataList[g], k = j.data, l = e.start * j.blockSize, m = l + e.count * j.blockSize, n = e.intrpl ? THREE.InterpolateLinear : !1, o = null;
                    switch (j.kind) {
                        case SEA3D.Animation.POSITION:
                            o = ".position";
                            break;
                        case SEA3D.Animation.ROTATION:
                            o = ".quaternion";
                            break;
                        case SEA3D.Animation.SCALE:
                            o = ".scale";
                            break;
                        case SEA3D.Animation.COLOR:
                            o = ".color";
                            break;
                        case SEA3D.Animation.MULTIPLIER:
                            o = ".intensity";
                            break;
                        case SEA3D.Animation.FOV:
                            o = ".fov"
                    }
                    if (o) {
                        switch (j.type) {
                            case SEA3D.Stream.BYTE:
                            case SEA3D.Stream.UBYTE:
                            case SEA3D.Stream.INT:
                            case SEA3D.Stream.UINT:
                            case SEA3D.Stream.FLOAT:
                            case SEA3D.Stream.DOUBLE:
                            case SEA3D.Stream.DECIMAL:
                                for (var p = k.slice(l, m), i = new Float32Array(p.length), q = 0, h = 0; q < i.length; q++)i[q] = h, h += c;
                                f.push(new THREE.VectorKeyframeTrack(o, i, p, n));
                                break;
                            case SEA3D.Stream.VECTOR3D:
                                for (var p = k.slice(l, m), i = new Float32Array(p.length / j.blockSize), q = 0, h = 0; q < i.length; q++)i[q] = h, h += c;
                                f.push(new THREE.VectorKeyframeTrack(o, i, p, n));
                                break;
                            case SEA3D.Stream.VECTOR4D:
                                for (var p = k.slice(l, m), i = new Float32Array(p.length / j.blockSize), q = 0, h = 0; q < i.length; q++)i[q] = h, h += c;
                                f.push(new THREE.QuaternionKeyframeTrack(o, i, p, n));
                                break;
                            case SEA3D.Stream.INT24:
                            case SEA3D.Stream.UINT24:
                                for (var p = new Float32Array(3 * (m - l)), i = new Float32Array(p.length / 3), q = 0, h = 0; q < i.length; q++)p[3 * q] = (k[q] >> 16 & 255) / 255, p[3 * q + 1] = (k[q] >> 8 & 255) / 255, p[3 * q + 2] = (255 & k[q]) / 255, i[q] = h, h += c;
                                f.push(new THREE.VectorKeyframeTrack(o, i, p, n))
                        }
                        var r = new THREE.AnimationClip(e.name, -1, f);
                        r.loop = e.repeat, r.timeScale = 1, b.push(r)
                    }
                }
                this.domain.animationClips = this.animationClips = this.animationClips || [], this.animationClips.push(this.objects[a.name + ".#anm"] = a.tag = b)
            },THREE.SEA3D.prototype.readGeometryBuffer = function (a) {
                for (var b = new THREE.BufferGeometry, c = 0; c < a.groups.length; c++) {
                    var d = a.groups[c];
                    b.addGroup(d.start, d.count, c)
                }
                b.setIndex(new THREE.BufferAttribute(a.indexes, 1)), b.addAttribute("position", new THREE.BufferAttribute(a.vertex, 3)), a.uv && (b.addAttribute("uv", new THREE.BufferAttribute(a.uv[0], 2)), a.uv.length > 1 && b.addAttribute("uv2", new THREE.BufferAttribute(a.uv[1], 2))), a.normal ? b.addAttribute("normal", new THREE.BufferAttribute(a.normal, 3)) : b.computeVertexNormals(), a.tangent4 && b.addAttribute("tangent", new THREE.BufferAttribute(a.tangent4, 4)), a.color && b.addAttribute("color", new THREE.BufferAttribute(a.color[0], a.numColor)), a.joint && (b.addAttribute("skinIndex", new THREE.Float32Attribute(a.joint, a.jointPerVertex)), b.addAttribute("skinWeight", new THREE.Float32Attribute(a.weight, a.jointPerVertex))), this.config.bounding && (b.computeBoundingBox(), b.computeBoundingSphere()), b.name = a.name, this.domain.geometries = this.geometries = this.geometries || [], this.geometries.push(this.objects["geo/" + a.name] = a.tag = b)
            },THREE.SEA3D.prototype.readDummy = function (a) {
                var b = new THREE.SEA3D.Dummy(a.width, a.height, a.depth);
                b.name = a.name, this.domain.dummys = this.dummys = this.dummys || [], this.dummys.push(this.objects["dmy/" + a.name] = a.tag = b), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.Object3DAnimator)
            },THREE.SEA3D.prototype.readLine = function (a) {
                var b = new THREE.BufferGeometry;
                a.closed && a.vertex.push(a.vertex[0], a.vertex[1], a.vertex[2]), b.addAttribute("position", new THREE.BufferAttribute(new Float32Array(a.vertex), 3));
                var c = new THREE.Line(b, new THREE.LineBasicMaterial({color: THREE.SEA3D.HELPER_COLOR, linewidth: 3}));
                c.name = a.name, this.lines = this.lines || [], this.lines.push(this.objects["line/" + a.name] = a.tag = c), this.addSceneObject(a), this.updateTransform(c, a), this.applyDefaultAnimation(a, THREE.SEA3D.Object3DAnimator)
            },THREE.SEA3D.prototype.readContainer3D = function (a) {
                var b = new THREE.SEA3D.Object3D;
                this.domain.containers = this.containers = this.containers || [], this.containers.push(this.objects["c3d/" + a.name] = a.tag = b), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.Object3DAnimator)
            },THREE.SEA3D.prototype.readSprite = function (a) {
                var b;
                a.material && (a.material.tag.sprite ? b = a.material.tag.sprite : (b = a.material.tag.sprite = new THREE.SpriteMaterial, this.setBlending(b, a.blendMode), b.map = a.material.tag.map, b.map.flipY = !0, b.color.set(a.material.tag.color), b.opacity = a.material.tag.opacity, b.blending = a.material.tag.blending, b.fog = a.material.receiveFog));
                var c = new THREE.Sprite(b);
                c.name = a.name, this.domain.sprites = this.sprites = this.sprites || [], this.sprites.push(this.objects["m2d/" + a.name] = a.tag = c), this.addSceneObject(a), this.updateTransform(c, a), c.scale.set(a.width, a.height, 1)
            },THREE.SEA3D.prototype.readMesh = function (a) {
                var b, c, d, e, f, g, h, i, j = a.geometry.tag;
                for (b = 0, c = a.modifiers ? a.modifiers.length : 0; c > b; b++) {
                    var k = a.modifiers[b];
                    switch (k.type) {
                        case SEA3D.Skeleton.prototype.type:
                        case SEA3D.SkeletonLocal.prototype.type:
                            f = k, j.bones = f.tag;
                            break;
                        case SEA3D.Morph.prototype.type:
                            i = k, j.morphAttributes = i.tag.attribs, j.morphTargets = i.tag.targets
                    }
                }
                for (b = 0, c = a.animations ? a.animations.length : 0; c > b; b++) {
                    var l = a.animations[b];
                    switch (l.tag.type) {
                        case SEA3D.SkeletonAnimation.prototype.type:
                            g = l.tag, j.animations = this.getSkeletonAnimation(g, f);
                            break;
                        case SEA3D.VertexAnimation.prototype.type:
                            h = l.tag, j.morphAttributes = h.tag.attribs, j.morphTargets = h.tag.targets, j.animations = h.tag.animations
                    }
                }
                var m = void 0 != i || void 0 != h, n = i && void 0 != i.tag.attribs.normal || h && void 0 != h.tag.attribs.normal;
                if (a.material)if (a.material.length > 1) {
                    var o = [];
                    for (b = 0; b < a.material.length; b++)o[b] = a.material[b].tag, o[b].skinning = void 0 != f, o[b].morphTargets = m, o[b].morphNormals = n, o[b].vertexColors = a.geometry.color ? THREE.VertexColors : THREE.NoColors;
                    e = new THREE.MultiMaterial(o)
                } else e = a.material[0].tag, e.skinning = void 0 != f, e.morphTargets = m, e.morphNormals = n, e.vertexColors = a.geometry.color ? THREE.VertexColors : THREE.NoColors;
                f ? (d = new THREE.SEA3D.SkinnedMesh(j, e, this.config.useVertexTexture), this.config.autoPlay && g && d.play(0)) : h ? (d = new THREE.SEA3D.VertexAnimationMesh(j, e, h.frameRate), this.config.autoPlay && d.play(0)) : d = new THREE.SEA3D.Mesh(j, e), d.name = a.name, d.castShadow = a.castShadows, d.receiveShadow = a.material ? a.material[0].receiveShadows : !0, this.domain.meshes = this.meshes = this.meshes || [], this.meshes.push(this.objects["m3d/" + a.name] = a.tag = d), this.addSceneObject(a), this.updateTransform(d, a), this.applyDefaultAnimation(a, THREE.SEA3D.Object3DAnimator)
            },THREE.SEA3D.prototype.readSoundPoint = function (a) {
                this.audioListener || (this.audioListener = new THREE.AudioListener, this.config.container && this.config.container.add(this.audioListener));
                var b = new THREE.PositionalAudio(this.audioListener);
                b.load(a.sound.tag), b.autoplay = a.autoPlay, b.setLoop(a.autoPlay), b.setVolume(a.volume), b.setRefDistance(a.distance), b.setRolloffFactor(this.config.audioRolloffFactor), b.name = a.name, this.domain.sounds3d = this.sounds3d = this.sounds3d || [], this.sounds3d.push(this.objects["sn3d/" + a.name] = a.tag = b), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.Object3DAnimator)
            },THREE.SEA3D.prototype.readCubeRender = function (a) {
                var b = new THREE.CubeCamera(.1, 5e3, THREE.SEA3D.RTT_SIZE);
                b.renderTarget.cubeCamera = b, this.domain.cubeRenderers = this.cubeRenderers = this.cubeRenderers || [], this.cubeRenderers.push(this.objects["rttc/" + a.name] = a.tag = b.renderTarget), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.Object3DAnimator)
            },THREE.SEA3D.prototype.readImage = function (a) {
                var b = new Image, c = new THREE.Texture;
                c.name = a.name, c.wrapS = c.wrapT = THREE.RepeatWrapping, c.flipY = !1, c.image = b, b.onload = function () {
                    c.needsUpdate = !0
                }, b.src = this.bufferToTexture(a.data.buffer), this.domain.textures = this.textures = this.textures || [], this.textures.push(this.objects["tex/" + a.name] = a.tag = c)
            },THREE.SEA3D.prototype.readCubeMap = function (a) {
                var b = [], c = new THREE.CubeTexture, d = [];
                d[0] = a.faces[1], d[1] = a.faces[0], d[2] = a.faces[3], d[3] = a.faces[2], d[4] = a.faces[5], d[5] = a.faces[4], b.loadedCount = 0, c.name = a.name, c.image = b, c.flipY = !1;
                for (var e = 0, f = d.length; f > e; ++e) {
                    var g = new Image;
                    b[e] = g, g.onload = function () {
                        6 == ++b.loadedCount && (c.needsUpdate = !0)
                    }, g.src = this.bufferToTexture(d[e].buffer)
                }
                this.domain.cubemaps = this.cubemaps = this.cubemaps || [], this.cubemaps.push(this.objects["cmap/" + a.name] = a.tag = c)
            },THREE.SEA3D.prototype.readSound = function (a) {
                var b = this.bufferToSound(a.data.buffer);
                this.domain.sounds = this.sounds = this.sounds || [], this.sounds.push(this.objects["snd/" + a.name] = a.tag = b)
            },THREE.SEA3D.prototype.readTextureURL = function (a) {
                var b = (new THREE.TextureLoader).load(a.url);
                b.name = a.name, b.wrapS = b.wrapT = THREE.RepeatWrapping, b.flipY = !1, this.domain.textures = this.textures = this.textures || [], this.textures.push(this.objects["tex/" + a.name] = a.tag = b)
            },THREE.SEA3D.prototype.getJSMList = function (a, b) {
                for (var c = [], d = 0; d < b.length; d++) {
                    var e = b[d];
                    e.tag.type == SEA3D.JavaScriptMethod.prototype.type && c.push(e)
                }
                return this.domain.scriptTargets = this.scriptTargets = this.scriptTargets || [], this.scriptTargets.push(a), c
            },THREE.SEA3D.prototype.readJavaScriptMethod = function (sea) {
                try {
                    var src = "(function() {\nvar $METHOD = {}\n", declare = 'function($INC, $REF, global, local, $his, $PARAM) {\nvar watch = $INC["watch"],\nscene = $INC["scene"],\nsea3d = $INC["sea3d"],\nprint = $INC["print"];\n';
                    declare += 'var $SRC = $INC["source"],\naddEvent = $SRC.addEvent.bind( $SRC ),\nhasEvent = $SRC.hasEvent.bind( $SRC ),\ndispatchEvent = $SRC.dispatchEvent.bind( $SRC ),\nremoveEvent = $SRC.removeEvent.bind( $SRC ),\ndispose = $SRC.dispose.bind( $SRC );\n';
                    for (var name in sea.methods)src += '$METHOD["' + name + '"] = ' + declare + sea.methods[name].src + "}\n";
                    src += "return $METHOD; })", this.domain.methods = eval(src)()
                } catch (e) {
                    console.error('SEA3D JavaScriptMethod: Error running "' + sea.name + '".'), console.error(e)
                }
            },THREE.SEA3D.prototype.readGLSL = function (a) {
                this.domain.glsl = this.glsl = this.glsl || [], this.glsl.push(this.objects["glsl/" + a.name] = a.tag = a.src)
            },THREE.SEA3D.prototype.materialTechnique = function () {
                var a = {};
                return a.onComplete = function (a, b) {
                    (b.alpha < 1 || a.blending > THREE.NormalBlending) && (a.opacity = b.alpha, a.transparent = !0)
                }, a[SEA3D.Material.PHYSICAL] = function (a, b) {
                    a.color.setHex(b.color), a.roughness = b.roughness, a.metalness = b.metalness
                }, a[SEA3D.Material.PHONG] = function (a, b) {
                    a.color.setHex(b.diffuseColor), a.specular.setHex(b.specularColor).multiplyScalar(b.specular), a.shininess = b.gloss
                }, a[SEA3D.Material.DIFFUSE_MAP] = function (a, b, c) {
                    a.map = b.texture.tag, a.color.setHex(16777215), b.texture.transparent && (a.transparent = !0, a.alphaTest = c.alphaThreshold)
                }, a[SEA3D.Material.ROUGHNESS_MAP] = function (a, b) {
                    a.roughnessMap = b.texture.tag
                }, a[SEA3D.Material.METALNESS_MAP] = function (a, b) {
                    a.metalnessMap = b.texture.tag
                }, a[SEA3D.Material.SPECULAR_MAP] = function (a, b) {
                    a.specular && (a.specularMap = b.texture.tag, a.specular.setHex(16777215))
                }, a[SEA3D.Material.NORMAL_MAP] = function (a, b) {
                    a.normalMap = b.texture.tag
                }, a[SEA3D.Material.REFLECTION] = a[SEA3D.Material.FRESNEL_REFLECTION] = function (a, b) {
                    a.envMap = b.texture.tag, a.envMap.mapping = THREE.CubeReflectionMapping, a.combine = THREE.MixOperation, a.reflectivity = b.alpha
                }, a[SEA3D.Material.REFLECTION_SPHERICAL] = function (a, b) {
                    a.envMap = b.texture.tag, a.envMap.mapping = THREE.SphericalReflectionMapping, a.combine = THREE.MixOperation, a.reflectivity = b.alpha
                }, a[SEA3D.Material.REFRACTION_MAP] = function (a, b) {
                    a.envMap = b.texture.tag, a.envMap.mapping = THREE.CubeRefractionMapping(), a.refractionRatio = b.ior, a.reflectivity = b.alpha
                }, a[SEA3D.Material.LIGHT_MAP] = function (a, b) {
                    "multiply" == b.blendMode ? a.aoMap = b.texture.tag : a.lightMap = b.texture.tag
                }, a
            }(),THREE.SEA3D.prototype.createMaterial = function (a) {
                return a.physical ? new THREE.MeshStandardMaterial : new THREE.MeshPhongMaterial
            },THREE.SEA3D.prototype.setBlending = function (a, b) {
                if ("normal" != b)switch (b) {
                    case"add":
                        mat.blending = THREE.AdditiveBlending;
                        break;
                    case"subtract":
                        mat.blending = THREE.SubtractiveBlending;
                        break;
                    case"multiply":
                        mat.blending = THREE.MultiplyBlending;
                        break;
                    case"screen":
                        mat.blending = THREE.CustomBlending, mat.blendSrc = THREE.OneFactor, mat.blendDst = THREE.OneMinusSrcColorFactor, mat.blendEquation = THREE.AddEquation
                }
            },THREE.SEA3D.prototype.readMaterial = function (a) {
                var b = this.createMaterial(a);
                b.name = a.name, b.side = a.bothSides ? THREE.DoubleSide : THREE.FrontSide, b.shading = a.smooth ? THREE.SmoothShading : THREE.FlatShading, this.setBlending(b, a.blendMode);
                for (var c = 0; c < a.technique.length; c++) {
                    var d = a.technique[c];
                    this.materialTechnique[d.kind] && this.materialTechnique[d.kind].call(this, b, d, a)
                }
                this.materialTechnique.onComplete && this.materialTechnique.onComplete.call(this, b, a), this.domain.materials = this.materials = this.materials || [], this.materials.push(this.objects["mat/" + a.name] = a.tag = b)
            },THREE.SEA3D.prototype.readPointLight = function (a) {
                var b = new THREE.SEA3D.PointLight(a.color, a.multiplier * this.config.multiplier);
                b.name = a.name, a.attenuation && (b.distance = a.attenuation.end), a.shadow && this.setShadowMap(b), this.domain.lights = this.lights = this.lights || [], this.lights.push(this.objects["lht/" + a.name] = a.tag = b), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.LightAnimator), this.updateScene()
            },THREE.SEA3D.prototype.readHemisphereLight = function (a) {
                var b = new THREE.HemisphereLight(a.color, a.secondColor, a.multiplier * this.config.multiplier);
                b.name = a.name, this.domain.lights = this.lights = this.lights || [], this.lights.push(this.objects["lht/" + a.name] = a.tag = b), this.addSceneObject(a), this.applyDefaultAnimation(a, THREE.SEA3D.LightAnimator), this.updateScene()
            },THREE.SEA3D.prototype.readAmbientLight = function (a) {
                var b = new THREE.AmbientLight(a.color, a.multiplier * this.config.multiplier);
                b.name = a.name, this.domain.lights = this.lights = this.lights || [], this.lights.push(this.objects["lht/" + a.name] = a.tag = b), this.addSceneObject(a), this.applyDefaultAnimation(a, THREE.SEA3D.LightAnimator), this.updateScene()
            },THREE.SEA3D.prototype.readDirectionalLight = function (a) {
                var b = new THREE.DirectionalLight(a.color, a.multiplier * this.config.multiplier);
                b.name = a.name, a.shadow && this.setShadowMap(b), this.domain.lights = this.lights = this.lights || [], this.lights.push(this.objects["lht/" + a.name] = a.tag = b), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.LightAnimator), this.updateScene()
            },THREE.SEA3D.prototype.readCamera = function (a) {
                var b = new THREE.SEA3D.Camera(a.fov);
                b.name = a.name, this.domain.cameras = this.cameras = this.cameras || [], this.cameras.push(this.objects["cam/" + a.name] = a.tag = b), this.addSceneObject(a), this.updateTransform(b, a), this.applyDefaultAnimation(a, THREE.SEA3D.CameraAnimator)
            },THREE.SEA3D.prototype.readOrthographicCamera = function (a) {
                var b, c, d;
                this.config.stageWidth > this.config.stageHeight ? (b = this.config.stageWidth / this.config.stageHeight, c = a.height * b, d = a.height) : (b = this.config.stageHeight / this.config.stageWidth, c = a.height, d = a.height * b);
                var e = new THREE.SEA3D.OrthographicCamera(-c, c, d, -d);
                e.name = a.name, this.domain.cameras = this.cameras = this.cameras || [], this.cameras.push(this.objects["cam/" + a.name] = a.tag = e), this.addSceneObject(a), this.updateTransform(e, a), this.applyDefaultAnimation(a, THREE.SEA3D.CameraAnimator)
            },THREE.SEA3D.prototype.readSkeletonLocal = function (a) {
                for (var b = [], c = 0; c < a.joint.length; c++) {
                    var d = a.joint[c];
                    b[c] = {name: d.name, pos: [d.x, d.y, d.z], rotq: [d.qx, d.qy, d.qz, d.qw], parent: d.parentIndex}
                }
                a.tag = b
            },THREE.SEA3D.prototype.readJointObject = function (a) {
                var b = a.target.tag, c = b.skeleton.bones[a.joint];
                this.domain.joints = this.joints = this.joints || [], this.joints.push(this.objects["jnt/" + a.name] = a.tag = c)
            },THREE.SEA3D.prototype.readMorpher = function (a) {
                for (var b = {position: []}, c = [], d = 0; d < a.node.length; d++) {
                    var e = a.node[d];
                    b.position[d] = new THREE.Float32Attribute(new Float32Array(e.vertex), 3), e.normal && (b.normal = b.normal || [], b.normal[d] = new THREE.Float32Attribute(new Float32Array(e.normal), 3)), c[d] = {name: e.name}
                }
                a.tag = {attribs: b, targets: c}
            },THREE.SEA3D.prototype.getSkeletonAnimation = function (a, b) {
                if (a.tag)return a.tag;
                for (var c = [], d = 1e3 / a.frameRate / 1e3, e = 0; e < a.sequence.length; e++) {
                    for (var f = a.sequence[e], g = f.start, h = g + f.count, i = {
                        name: f.name,
                        fps: a.frameRate,
                        length: d * f.count,
                        hierarchy: []
                    }, j = a.numJoints, k = a.raw, l = 0; j > l; l++) {
                        for (var m = b.joint[l], n = {
                            parent: m.parentIndex,
                            keys: []
                        }, o = n.keys, p = 0, q = g; h > q; q++) {
                            var r = q * j * 7 + 7 * l;
                            o.push({
                                time: p,
                                pos: [k[r], k[r + 1], k[r + 2]],
                                rot: [k[r + 3], k[r + 4], k[r + 5], k[r + 6]],
                                scl: [1, 1, 1]
                            }), p += d
                        }
                        i.hierarchy[l] = n
                    }
                    var s = THREE.AnimationClip.parseAnimation(i, b.tag);
                    s.loop = f.repeat, s.timeScale = 1, c.push(s)
                }
                return a.tag = c
            },THREE.SEA3D.prototype.readVertexAnimation = function (a) {
                var b, c, d, e = {position: []}, f = [], g = [];
                for (b = 0, d = a.frame.length; d > b; b++) {
                    var h = a.frame[b];
                    e.position[b] = new THREE.Float32Attribute(new Float32Array(h.vertex), 3), h.normal && (e.normal = e.normal || [], e.normal[b] = new THREE.Float32Attribute(new Float32Array(h.normal), 3)), f[b] = {name: b}
                }
                for (b = 0; b < a.sequence.length; b++) {
                    var i = a.sequence[b], j = [];
                    for (c = 0; c < i.count; c++)j[c] = f[i.start + c];
                    var k = THREE.AnimationClip.CreateFromMorphTargetSequence(i.name, j, a.frameRate);
                    k.loop = i.repeat, k.timeScale = 1, g.push(k)
                }
                a.tag = {attribs: e, targets: f, animations: g}
            },THREE.SEA3D.prototype.readActions = function (a) {
                for (var b = 0; b < a.actions.length; b++) {
                    var c = a.actions[b];
                    switch (c.kind) {
                        case SEA3D.Actions.SCRIPTS:
                            this.domain.scripts = this.getJSMList(this.domain, c.scripts), this.config.runScripts && this.domain.runJSMList(obj3d)
                    }
                }
            },THREE.SEA3D.Event = {
                LOAD_PROGRESS: "sea3d_progress",
                DOWNLOAD_PROGRESS: "sea3d_download",
                COMPLETE: "sea3d_complete",
                OBJECT_COMPLETE: "sea3d_object",
                PARSE_PROGRESS: "parse_progress",
                PARSE_COMPLETE: "parse_complete",
                ERROR: "sea3d_error"
            },THREE.SEA3D.prototype.onProgress = void 0,THREE.SEA3D.prototype.onComplete = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.COMPLETE, a.file.dispatchEvent(a)
            },THREE.SEA3D.prototype.onLoadProgress = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.LOAD_PROGRESS, a.file.dispatchEvent(a), a.file.onProgress && a.file.onProgress(a)
            },THREE.SEA3D.prototype.onDownloadProgress = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.DOWNLOAD_PROGRESS, a.file.dispatchEvent(a), a.file.onProgress && a.file.onProgress(a)
            },THREE.SEA3D.prototype.onCompleteObject = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.OBJECT_COMPLETE, a.file.dispatchEvent(a)
            },THREE.SEA3D.prototype.onParseProgress = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.PARSE_PROGRESS, a.file.dispatchEvent(a)
            },THREE.SEA3D.prototype.onParseComplete = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.PARSE_COMPLETE, a.file.dispatchEvent(a)
            },THREE.SEA3D.prototype.onError = function (a) {
                a.file = this.scope, a.type = THREE.SEA3D.Event.ERROR, a.file.dispatchEvent(a)
            },THREE.SEA3D.prototype.createDomain = function () {
                return this.domain = new THREE.SEA3D.Domain(this.config.id, this.objects = {}, this.config.container)
            },THREE.SEA3D.prototype.clone = function (a, b, c) {
                if (!this.file.isDone())throw new Error("Previous parse is not completed.");
                this.config.container = a && void 0 !== a.container ? a.container : new THREE.Object3D, a && this.loadConfig(a);
                var d = this.config.timeLimit;
                return this.config.timeLimit = a && void 0 !== a.timeLimit ? a.timeLimit : 1 / 0, this.parse(b, c), this.config.timeLimit = d, this.domain
            },THREE.SEA3D.prototype.loadConfig = function (a) {
                for (var b in a)this.config[b] = a[b]
            },THREE.SEA3D.prototype.parse = function (a, b) {
                delete this.cameras, delete this.containers, delete this.lights, delete this.joints, delete this.meshes, delete this.materials, delete this.animationSets, delete this.sprites, delete this.sounds3d, delete this.cubeRenderers, delete this.sounds, delete this.glsl, delete this.dummy, delete this.domain, this.createDomain(), this.setTypeRead(), this.file.onParseComplete = function (b) {
                    this.config.manager && this.config.manager.add(this.domain), (a || this.onParseComplete).call(this.file, b)
                }.bind(this), this.file.onParseProgress = b || this.onParseProgress;
                for (var c = THREE.SEA3D.EXTENSIONS_LOADER.length; c--;) {
                    var d = THREE.SEA3D.EXTENSIONS_LOADER[c];
                    d.parse && d.parse.call(this)
                }
                return this.file.parse(), this.domain
            },THREE.SEA3D.prototype.load = function (a) {
                this.loadBytes(), this.file.load(a)
            },THREE.SEA3D.prototype.onHead = function (a) {
                if ("TJS" != a.sign)throw new Error("Sign '" + a.sign + "' not supported! Use SEA3D Studio to publish or SEA3DLegacy.js")
            },THREE.SEA3D.EXTENSIONS_LOADER = [],THREE.SEA3D.EXTENSIONS_DOMAIN = [],THREE.SEA3D.prototype.setTypeRead = function () {
                this.file.typeRead = {}, this.file.typeRead[SEA3D.Geometry.prototype.type] = this.file.typeRead[SEA3D.GeometryDelta.prototype.type] = this.readGeometryBuffer, this.file.typeRead[SEA3D.Mesh.prototype.type] = this.readMesh, this.file.typeRead[SEA3D.Sprite.prototype.type] = this.readSprite, this.file.typeRead[SEA3D.Container3D.prototype.type] = this.readContainer3D, this.file.typeRead[SEA3D.Line.prototype.type] = this.readLine, this.file.typeRead[SEA3D.Material.prototype.type] = this.readMaterial, this.file.typeRead[SEA3D.Camera.prototype.type] = this.readCamera,
                    this.file.typeRead[SEA3D.OrthographicCamera.prototype.type] = this.readOrthographicCamera, this.file.typeRead[SEA3D.SkeletonLocal.prototype.type] = this.readSkeletonLocal, this.file.typeRead[SEA3D.JointObject.prototype.type] = this.readJointObject, this.file.typeRead[SEA3D.CubeMap.prototype.type] = this.readCubeMap, this.file.typeRead[SEA3D.CubeRender.prototype.type] = this.readCubeRender, this.file.typeRead[SEA3D.Animation.prototype.type] = this.readAnimation, this.file.typeRead[SEA3D.SoundPoint.prototype.type] = this.readSoundPoint, this.file.typeRead[SEA3D.TextureURL.prototype.type] = this.readTextureURL, this.file.typeRead[SEA3D.Morph.prototype.type] = this.readMorpher, this.file.typeRead[SEA3D.VertexAnimation.prototype.type] = this.readVertexAnimation, this.file.typeRead[SEA3D.Actions.prototype.type] = this.readActions, this.config.dummys && (this.file.typeRead[SEA3D.Dummy.prototype.type] = this.readDummy), this.config.scripts && (this.file.typeRead[SEA3D.JavaScriptMethod.prototype.type] = this.readJavaScriptMethod), this.config.lights && (this.file.typeRead[SEA3D.PointLight.prototype.type] = this.readPointLight, this.file.typeRead[SEA3D.DirectionalLight.prototype.type] = this.readDirectionalLight, this.file.typeRead[SEA3D.HemisphereLight.prototype.type] = this.readHemisphereLight, this.file.typeRead[SEA3D.AmbientLight.prototype.type] = this.readAmbientLight), this.file.typeRead[SEA3D.JPEG.prototype.type] = this.file.typeRead[SEA3D.JPEG_XR.prototype.type] = this.file.typeRead[SEA3D.PNG.prototype.type] = this.file.typeRead[SEA3D.GIF.prototype.type] = this.readImage, this.file.typeRead[SEA3D.MP3.prototype.type] = this.readSound, this.file.typeRead[SEA3D.GLSL.prototype.type] = this.readGLSL;
                for (var a = THREE.SEA3D.EXTENSIONS_LOADER.length; a--;) {
                    var b = THREE.SEA3D.EXTENSIONS_LOADER[a];
                    b.setTypeRead && b.setTypeRead.call(this)
                }
            },THREE.SEA3D.prototype.loadBytes = function (a) {
                this.file = new SEA3D.File, this.file.scope = this, this.file.config = this.config, this.file.onProgress = this.onLoadProgress, this.file.onCompleteObject = this.onCompleteObject, this.file.onDownloadProgress = this.onDownloadProgress, this.file.onParseProgress = this.onParseProgress, this.file.onParseComplete = this.onParseComplete, this.file.onError = this.onError, this.file.onHead = this.onHead, this.file.onComplete = function (a) {
                    this.config.manager && this.config.manager.add(this.domain), this.onComplete.call(this.file, a)
                }.bind(this), this.createDomain(), this.setTypeRead(), this.file.read(a)
            };
            var LZMA = LZMA || {};
            LZMA.OutWindow = function () {
                this._windowSize = 0
            }, LZMA.OutWindow.prototype.create = function (a) {
                this._buffer && this._windowSize === a || (this._buffer = []), this._windowSize = a, this._pos = 0, this._streamPos = 0
            }, LZMA.OutWindow.prototype.flush = function () {
                var a = this._pos - this._streamPos;
                if (0 !== a) {
                    for (; a--;)this._stream.writeByte(this._buffer[this._streamPos++]);
                    this._pos >= this._windowSize && (this._pos = 0), this._streamPos = this._pos
                }
            }, LZMA.OutWindow.prototype.releaseStream = function () {
                this.flush(), this._stream = null
            }, LZMA.OutWindow.prototype.setStream = function (a) {
                this.releaseStream(), this._stream = a
            }, LZMA.OutWindow.prototype.init = function (a) {
                a || (this._streamPos = 0, this._pos = 0)
            }, LZMA.OutWindow.prototype.copyBlock = function (a, b) {
                var c = this._pos - a - 1;
                for (0 > c && (c += this._windowSize); b--;)c >= this._windowSize && (c = 0), this._buffer[this._pos++] = this._buffer[c++], this._pos >= this._windowSize && this.flush()
            }, LZMA.OutWindow.prototype.putByte = function (a) {
                this._buffer[this._pos++] = a, this._pos >= this._windowSize && this.flush()
            }, LZMA.OutWindow.prototype.getByte = function (a) {
                var b = this._pos - a - 1;
                return 0 > b && (b += this._windowSize), this._buffer[b]
            }, LZMA.RangeDecoder = function () {
            }, LZMA.RangeDecoder.prototype.setStream = function (a) {
                this._stream = a
            }, LZMA.RangeDecoder.prototype.releaseStream = function () {
                this._stream = null
            }, LZMA.RangeDecoder.prototype.init = function () {
                var a = 5;
                for (this._code = 0, this._range = -1; a--;)this._code = this._code << 8 | this._stream.readByte()
            }, LZMA.RangeDecoder.prototype.decodeDirectBits = function (a) {
                for (var b, c = 0, d = a; d--;)this._range >>>= 1, b = this._code - this._range >>> 31, this._code -= this._range & b - 1, c = c << 1 | 1 - b, 0 === (4278190080 & this._range) && (this._code = this._code << 8 | this._stream.readByte(), this._range <<= 8);
                return c
            }, LZMA.RangeDecoder.prototype.decodeBit = function (a, b) {
                var c = a[b], d = (this._range >>> 11) * c;
                return (2147483648 ^ this._code) < (2147483648 ^ d) ? (this._range = d, a[b] += 2048 - c >>> 5, 0 === (4278190080 & this._range) && (this._code = this._code << 8 | this._stream.readByte(), this._range <<= 8), 0) : (this._range -= d, this._code -= d, a[b] -= c >>> 5, 0 === (4278190080 & this._range) && (this._code = this._code << 8 | this._stream.readByte(), this._range <<= 8), 1)
            }, LZMA.initBitModels = function (a, b) {
                for (; b--;)a[b] = 1024
            }, LZMA.BitTreeDecoder = function (a) {
                this._models = [], this._numBitLevels = a
            }, LZMA.BitTreeDecoder.prototype.init = function () {
                LZMA.initBitModels(this._models, 1 << this._numBitLevels)
            }, LZMA.BitTreeDecoder.prototype.decode = function (a) {
                for (var b = 1, c = this._numBitLevels; c--;)b = b << 1 | a.decodeBit(this._models, b);
                return b - (1 << this._numBitLevels)
            }, LZMA.BitTreeDecoder.prototype.reverseDecode = function (a) {
                for (var b, c = 1, d = 0, e = 0; e < this._numBitLevels; ++e)b = a.decodeBit(this._models, c), c = c << 1 | b, d |= b << e;
                return d
            }, LZMA.reverseDecode2 = function (a, b, c, d) {
                for (var e, f = 1, g = 0, h = 0; d > h; ++h)e = c.decodeBit(a, b + f), f = f << 1 | e, g |= e << h;
                return g
            }, LZMA.LenDecoder = function () {
                this._choice = [], this._lowCoder = [], this._midCoder = [], this._highCoder = new LZMA.BitTreeDecoder(8), this._numPosStates = 0
            }, LZMA.LenDecoder.prototype.create = function (a) {
                for (; this._numPosStates < a; ++this._numPosStates)this._lowCoder[this._numPosStates] = new LZMA.BitTreeDecoder(3), this._midCoder[this._numPosStates] = new LZMA.BitTreeDecoder(3)
            }, LZMA.LenDecoder.prototype.init = function () {
                var a = this._numPosStates;
                for (LZMA.initBitModels(this._choice, 2); a--;)this._lowCoder[a].init(), this._midCoder[a].init();
                this._highCoder.init()
            }, LZMA.LenDecoder.prototype.decode = function (a, b) {
                return 0 === a.decodeBit(this._choice, 0) ? this._lowCoder[b].decode(a) : 0 === a.decodeBit(this._choice, 1) ? 8 + this._midCoder[b].decode(a) : 16 + this._highCoder.decode(a)
            }, LZMA.Decoder2 = function () {
                this._decoders = []
            }, LZMA.Decoder2.prototype.init = function () {
                LZMA.initBitModels(this._decoders, 768)
            }, LZMA.Decoder2.prototype.decodeNormal = function (a) {
                var b = 1;
                do b = b << 1 | a.decodeBit(this._decoders, b); while (256 > b);
                return 255 & b
            }, LZMA.Decoder2.prototype.decodeWithMatchByte = function (a, b) {
                var c, d, e = 1;
                do if (c = b >> 7 & 1, b <<= 1, d = a.decodeBit(this._decoders, (1 + c << 8) + e), e = e << 1 | d, c !== d) {
                    for (; 256 > e;)e = e << 1 | a.decodeBit(this._decoders, e);
                    break
                } while (256 > e);
                return 255 & e
            }, LZMA.LiteralDecoder = function () {
            }, LZMA.LiteralDecoder.prototype.create = function (a, b) {
                var c;
                if (!this._coders || this._numPrevBits !== b || this._numPosBits !== a)for (this._numPosBits = a, this._posMask = (1 << a) - 1, this._numPrevBits = b, this._coders = [], c = 1 << this._numPrevBits + this._numPosBits; c--;)this._coders[c] = new LZMA.Decoder2
            }, LZMA.LiteralDecoder.prototype.init = function () {
                for (var a = 1 << this._numPrevBits + this._numPosBits; a--;)this._coders[a].init()
            }, LZMA.LiteralDecoder.prototype.getDecoder = function (a, b) {
                return this._coders[((a & this._posMask) << this._numPrevBits) + ((255 & b) >>> 8 - this._numPrevBits)]
            }, LZMA.Decoder = function () {
                this._outWindow = new LZMA.OutWindow, this._rangeDecoder = new LZMA.RangeDecoder, this._isMatchDecoders = [], this._isRepDecoders = [], this._isRepG0Decoders = [], this._isRepG1Decoders = [], this._isRepG2Decoders = [], this._isRep0LongDecoders = [], this._posSlotDecoder = [], this._posDecoders = [], this._posAlignDecoder = new LZMA.BitTreeDecoder(4), this._lenDecoder = new LZMA.LenDecoder, this._repLenDecoder = new LZMA.LenDecoder, this._literalDecoder = new LZMA.LiteralDecoder, this._dictionarySize = -1, this._dictionarySizeCheck = -1, this._posSlotDecoder[0] = new LZMA.BitTreeDecoder(6), this._posSlotDecoder[1] = new LZMA.BitTreeDecoder(6), this._posSlotDecoder[2] = new LZMA.BitTreeDecoder(6), this._posSlotDecoder[3] = new LZMA.BitTreeDecoder(6)
            }, LZMA.Decoder.prototype.setDictionarySize = function (a) {
                return 0 > a ? !1 : (this._dictionarySize !== a && (this._dictionarySize = a, this._dictionarySizeCheck = Math.max(this._dictionarySize, 1), this._outWindow.create(Math.max(this._dictionarySizeCheck, 4096))), !0)
            }, LZMA.Decoder.prototype.setLcLpPb = function (a, b, c) {
                var d = 1 << c;
                return a > 8 || b > 4 || c > 4 ? !1 : (this._literalDecoder.create(b, a), this._lenDecoder.create(d), this._repLenDecoder.create(d), this._posStateMask = d - 1, !0)
            }, LZMA.Decoder.prototype.init = function () {
                var a = 4;
                for (this._outWindow.init(!1), LZMA.initBitModels(this._isMatchDecoders, 192), LZMA.initBitModels(this._isRep0LongDecoders, 192), LZMA.initBitModels(this._isRepDecoders, 12), LZMA.initBitModels(this._isRepG0Decoders, 12), LZMA.initBitModels(this._isRepG1Decoders, 12), LZMA.initBitModels(this._isRepG2Decoders, 12), LZMA.initBitModels(this._posDecoders, 114), this._literalDecoder.init(); a--;)this._posSlotDecoder[a].init();
                this._lenDecoder.init(), this._repLenDecoder.init(), this._posAlignDecoder.init(), this._rangeDecoder.init()
            }, LZMA.Decoder.prototype.decode = function (a, b, c) {
                var d, e, f, g, h, i, j = 0, k = 0, l = 0, m = 0, n = 0, o = 0, p = 0;
                for (this._rangeDecoder.setStream(a), this._outWindow.setStream(b), this.init(); 0 > c || c > o;)if (d = o & this._posStateMask, 0 === this._rangeDecoder.decodeBit(this._isMatchDecoders, (j << 4) + d))e = this._literalDecoder.getDecoder(o++, p), p = j >= 7 ? e.decodeWithMatchByte(this._rangeDecoder, this._outWindow.getByte(k)) : e.decodeNormal(this._rangeDecoder), this._outWindow.putByte(p), j = 4 > j ? 0 : j - (10 > j ? 3 : 6); else {
                    if (1 === this._rangeDecoder.decodeBit(this._isRepDecoders, j))f = 0, 0 === this._rangeDecoder.decodeBit(this._isRepG0Decoders, j) ? 0 === this._rangeDecoder.decodeBit(this._isRep0LongDecoders, (j << 4) + d) && (j = 7 > j ? 9 : 11, f = 1) : (0 === this._rangeDecoder.decodeBit(this._isRepG1Decoders, j) ? g = l : (0 === this._rangeDecoder.decodeBit(this._isRepG2Decoders, j) ? g = m : (g = n, n = m), m = l), l = k, k = g), 0 === f && (f = 2 + this._repLenDecoder.decode(this._rangeDecoder, d), j = 7 > j ? 8 : 11); else if (n = m, m = l, l = k, f = 2 + this._lenDecoder.decode(this._rangeDecoder, d), j = 7 > j ? 7 : 10, h = this._posSlotDecoder[5 >= f ? f - 2 : 3].decode(this._rangeDecoder), h >= 4) {
                        if (i = (h >> 1) - 1, k = (2 | 1 & h) << i, 14 > h)k += LZMA.reverseDecode2(this._posDecoders, k - h - 1, this._rangeDecoder, i); else if (k += this._rangeDecoder.decodeDirectBits(i - 4) << 4, k += this._posAlignDecoder.reverseDecode(this._rangeDecoder), 0 > k) {
                            if (-1 === k)break;
                            return !1
                        }
                    } else k = h;
                    if (k >= o || k >= this._dictionarySizeCheck)return !1;
                    this._outWindow.copyBlock(k, f), o += f, p = this._outWindow.getByte(0)
                }
                return this._outWindow.flush(), this._outWindow.releaseStream(), this._rangeDecoder.releaseStream(), !0
            }, LZMA.Decoder.prototype.setDecoderProperties = function (a) {
                var b, c, d, e, f;
                return a.size < 5 ? !1 : (b = a.readByte(), c = b % 9, b = ~~(b / 9), d = b % 5, e = ~~(b / 5), this.setLcLpPb(c, d, e) ? (f = a.readByte(), f |= a.readByte() << 8, f |= a.readByte() << 16, f += 16777216 * a.readByte(), this.setDictionarySize(f)) : !1)
            }, LZMA.decompress = function (a, b, c, d) {
                var e = new LZMA.Decoder;
                if (!e.setDecoderProperties(a))throw"Incorrect stream properties";
                if (!e.decode(b, c, d))throw"Error in data stream";
                return !0
            }, LZMA.decompressFile = function (a, b) {
                var c, d = new LZMA.Decoder;
                if (!d.setDecoderProperties(a))throw"Incorrect stream properties";
                if (c = a.readByte(), c |= a.readByte() << 8, c |= a.readByte() << 16, c += 16777216 * a.readByte(), a.readByte(), a.readByte(), a.readByte(), a.readByte(), !d.decode(a, b, c))throw"Error in data stream";
                return !0
            }, SEA3D.File.LZMAUncompress = function (a) {
                a = new Uint8Array(a);
                var b = {
                    data: a, position: 0, readByte: function () {
                        return this.data[this.position++]
                    }
                }, c = {
                    data: [], position: 0, writeByte: function (a) {
                        this.data[this.position++] = a
                    }
                };
                return LZMA.decompressFile(b, c), new Uint8Array(c.data).buffer
            }, SEA3D.File.setDecompressionEngine(2, "lzma", SEA3D.File.LZMAUncompress), THREE.SEA3D.prototype._onHead = THREE.SEA3D.prototype.onHead, THREE.SEA3D.prototype._updateTransform = THREE.SEA3D.prototype.updateTransform, THREE.SEA3D.prototype._readVertexAnimation = THREE.SEA3D.prototype.readVertexAnimation, THREE.SEA3D.prototype._readGeometryBuffer = THREE.SEA3D.prototype.readGeometryBuffer, THREE.SEA3D.prototype._readLine = THREE.SEA3D.prototype.readLine, THREE.SEA3D.prototype._getSkeletonAnimation = THREE.SEA3D.prototype.getSkeletonAnimation, THREE.SEA3D.prototype._applyDefaultAnimation = THREE.SEA3D.prototype.applyDefaultAnimation, THREE.SEA3D.prototype.isLegacy = function (a) {
                var b = a.sea3d;
                return "S3D" != b.sign || a._legacy ? !1 : (a._legacy = 1 == b.typeUnique[a.type], b.config.legacy)
            }, THREE.SEA3D.prototype.flipZVec3 = function (a) {
                if (a) {
                    for (var b = 2; b < a.length;)a[b] = -a[b], b += 3;
                    return a
                }
            }, THREE.SEA3D.prototype.expandJoints = function (a) {
                for (var b = 4 * a.numVertex, c = a.isBig ? new Uint32Array(b) : new Uint16Array(b), d = new Float32Array(b), e = 0, f = a.jointPerVertex, g = 0; g < a.numVertex; g++) {
                    var h = 4 * g, i = g * f;
                    c[h] = a.joint[i], f > 1 && (c[h + 1] = a.joint[i + 1]), f > 2 && (c[h + 2] = a.joint[i + 2]), f > 3 && (c[h + 3] = a.joint[i + 3]), d[h] = a.weight[i], f > 1 && (d[h + 1] = a.weight[i + 1]), f > 2 && (d[h + 2] = a.weight[i + 2]), f > 3 && (d[h + 3] = a.weight[i + 3]), e = d[h] + d[h + 1] + d[h + 2] + d[h + 3], d[h] += 1 - e
                }
                a.joint = c, a.weight = d, a.jointPerVertex = 4
            }, THREE.SEA3D.prototype.compressJoints = function (a) {
                for (var b = 4 * a.numVertex, c = a.isBig ? new Uint32Array(b) : new Uint16Array(b), d = new Float32Array(b), e = 0, f = a.jointPerVertex, g = 0; g < a.numVertex; g++) {
                    var h = 4 * g, i = g * f;
                    c[h] = a.joint[i], c[h + 1] = a.joint[i + 1], c[h + 2] = a.joint[i + 2], c[h + 3] = a.joint[i + 3], d[h] = a.weight[i], d[h + 1] = a.weight[i + 1], d[h + 2] = a.weight[i + 2], d[h + 3] = a.weight[i + 3], e = d[h] + d[h + 1] + d[h + 2] + d[h + 3], d[h] += 1 - e
                }
                a.joint = c, a.weight = d, a.jointPerVertex = 4
            }, THREE.SEA3D.prototype.flipZIndex = function (a) {
                for (var b = 1; b < a.length;) {
                    var c = a[b + 1];
                    a[b + 1] = a[b], a[b] = c, b += 3
                }
                return a
            }, THREE.SEA3D.prototype.flipMatrixBone = function (a) {
                var b = new THREE.Vector3, c = new THREE.Matrix4;
                return function (a) {
                    c.copy(a), a.setPosition(b), a.multiplyMatrices(THREE.SEA3D.MTXBUF.makeRotationZ(THREE.Math.degToRad(180)), a), a.makeRotationFromQuaternion(THREE.SEA3D.QUABUF.setFromRotationMatrix(a));
                    var d = THREE.SEA3D.VECBUF.setFromMatrixPosition(c);
                    return d.z = -d.z, a.setPosition(d), a
                }
            }(), THREE.SEA3D.prototype.flipMatrixScale = function (a, b, c, d) {
                var e = new THREE.Vector3, f = new THREE.Quaternion, g = new THREE.Vector3;
                return function (a, b, c, d) {
                    return c && a.multiplyMatrices(c, a), a.decompose(e, f, g), g.z = -g.z, b && (g.y = -g.y, g.x = -g.x), a.compose(e, f, g), c && (c = c.clone(), this.flipMatrixScale(c, d), a.multiplyMatrices(c.getInverse(c), a)), a
                }
            }(), THREE.SEA3D.prototype.updateAnimationSet = function (a) {
                var b = new THREE.Matrix4, c = new THREE.Matrix4, d = new THREE.Vector3, e = new THREE.Quaternion, f = new THREE.Vector3, g = new THREE.Vector3, h = new THREE.Quaternion, i = new THREE.Vector3;
                return function (a) {
                    var j = a.animation.animationSet, k = (a.animation.relative, j.animations);
                    if (!j.flip || k.length) {
                        for (var l = k[0].dataList, m = [], n = 0; n < l.length; n++) {
                            var o = l[n], p = l[n].data, q = o.kind, r = p.length / o.blockLength;
                            switch (q) {
                                case SEA3D.Animation.POSITION:
                                case SEA3D.Animation.ROTATION:
                                case SEA3D.Animation.SCALE:
                                    m.push({kind: q, numFrames: r, raw: p})
                            }
                        }
                        if (m.length > 0) {
                            var r = m[0].numFrames, s = void 0;
                            a.animation.relative ? (b.identity(), s = this.flipMatrixScale(c.copy(a.matrixWorld))) : (a.parent && (s = this.flipMatrixScale(c.copy(a.parent.matrixWorld))), this.flipMatrixScale(b.copy(a.matrix), !1, s)), b.decompose(d, e, f);
                            for (var t, u, v = 0; r > v; v++) {
                                for (t = 0; t < m.length; t++) {
                                    var p = m[t].raw, q = m[t].kind;
                                    switch (q) {
                                        case SEA3D.Animation.POSITION:
                                            u = 3 * v, d.set(p[u], p[u + 1], p[u + 2]);
                                            break;
                                        case SEA3D.Animation.ROTATION:
                                            u = 4 * v, e.set(p[u], p[u + 1], p[u + 2], p[u + 3]);
                                            break;
                                        case SEA3D.Animation.SCALE:
                                            u = 4 * v, f.set(p[u], p[u + 1], p[u + 2])
                                    }
                                }
                                for (b.compose(d, e, f), this.flipMatrixScale(b, !1, c), b.decompose(g, h, i), t = 0; t < m.length; t++) {
                                    var p = m[t].raw, q = m[t].kind;
                                    switch (q) {
                                        case SEA3D.Animation.POSITION:
                                            u = 3 * v, p[u] = g.x, p[u + 1] = g.y, p[u + 2] = g.z;
                                            break;
                                        case SEA3D.Animation.ROTATION:
                                            u = 4 * v, p[u] = h.x, p[u + 1] = h.y, p[u + 2] = h.z, p[u + 3] = h.w;
                                            break;
                                        case SEA3D.Animation.SCALE:
                                            u = 3 * v, p[u] = i.x, p[u + 1] = i.y, p[u + 2] = i.z
                                    }
                                }
                            }
                        }
                        j.flip = !0
                    }
                }
            }(), THREE.SEA3D.prototype.applyDefaultAnimation = function (a, b) {
                this._applyDefaultAnimation(a, b), this.isLegacy(a) && a.tag.animation && this.updateAnimationSet(a.tag)
            }, THREE.SEA3D.prototype.updateTransform = function (a, b) {
                var c = new THREE.Matrix4, d = new THREE.Matrix4;
                return function (a, b) {
                    this.isLegacy(b) ? (b.transform ? c.elements.set(b.transform) : c.makeTranslation(b.position.x, b.position.y, b.position.z), this.flipMatrixScale(c, !1, a.parent ? a.parent.matrixWorld : d, a.parent instanceof THREE.Bone), a.position.setFromMatrixPosition(c), a.scale.setFromMatrixScale(c), c.scale(THREE.SEA3D.VECBUF.set(1 / a.scale.x, 1 / a.scale.y, 1 / a.scale.z)), a.rotation.setFromRotationMatrix(c), a.updateMatrixWorld()) : this._updateTransform(a, b)
                }
            }(), THREE.SEA3D.prototype.readSkeleton = function (a) {
                var b = new THREE.Matrix4, c = new THREE.Matrix4, d = new THREE.Matrix4, e = new THREE.Vector3, f = new THREE.Quaternion;
                return function (a) {
                    for (var g = [], h = a.sea3d.config.legacy, i = 0; i < a.joint.length; i++) {
                        var j = a.joint[i];
                        b.elements = j.inverseBindMatrix, c.getInverse(b), h && this.flipMatrixBone(c), j.parentIndex > -1 && (b.elements = a.joint[j.parentIndex].inverseBindMatrix, d.getInverse(b), h && this.flipMatrixBone(d), d.getInverse(d), c.multiplyMatrices(d, c)), e.setFromMatrixPosition(c), f.setFromRotationMatrix(c), g[i] = {
                            name: j.name,
                            pos: [e.x, e.y, e.z],
                            rotq: [f.x, f.y, f.z, f.w],
                            parent: j.parentIndex
                        }
                    }
                    return a.tag = g
                }
            }(), THREE.SEA3D.prototype.getSkeletonAnimation = function (a, b) {
                return this.isLegacy(a) ? this.getSkeletonAnimationLegacy(a, b) : this._getSkeletonAnimation(a, b)
            }, THREE.SEA3D.prototype.getSkeletonAnimationLegacy = function (a, b) {
                var c = new THREE.Matrix4, d = new THREE.Matrix4, e = new THREE.Matrix4, f = new THREE.Matrix4;
                return function (a, b) {
                    if (a.tag)return a.tag;
                    for (var g = [], h = 1e3 / a.frameRate / 1e3, i = [1, 1, 1], j = 0; j < a.sequence.length; j++) {
                        for (var k = a.sequence[j], l = k.start, m = l + k.count, n = {
                            name: k.name,
                            repeat: k.repeat,
                            fps: a.frameRate,
                            JIT: 0,
                            length: h * k.count,
                            hierarchy: []
                        }, o = a.numJoints, p = a.raw, q = 0; o > q; q++) {
                            for (var r = b.joint[q], s = {
                                parent: r.parentIndex,
                                keys: []
                            }, t = s.keys, u = 0, v = l; m > v; v++) {
                                var w = v * o * 7 + 7 * q;
                                d.makeRotationFromQuaternion(THREE.SEA3D.QUABUF.set(p[w + 3], p[w + 4], p[w + 5], p[w + 6])), d.setPosition(THREE.SEA3D.VECBUF.set(p[w], p[w + 1], p[w + 2])), r.parentIndex > -1 ? (c.elements = b.joint[r.parentIndex].inverseBindMatrix, f.getInverse(c), e.multiplyMatrices(f, d), this.flipMatrixBone(e), this.flipMatrixBone(f), f.getInverse(f), d.multiplyMatrices(f, e)) : this.flipMatrixBone(d);
                                var x = THREE.SEA3D.VECBUF.setFromMatrixPosition(d), y = THREE.SEA3D.QUABUF.setFromRotationMatrix(d);
                                t.push({time: u, pos: [x.x, x.y, x.z], rot: [y.x, y.y, y.z, y.w], scl: i}), u += h
                            }
                            n.hierarchy[q] = s
                        }
                        var z = THREE.AnimationClip.parseAnimation(n, b.tag);
                        z.loop = k.repeat, z.timeScale = 1, g.push(z)
                    }
                    return a.tag = g
                }
            }(), THREE.SEA3D.prototype.readVertexAnimation = function (a) {
                if (this.isLegacy(a))for (var b = 0, c = a.frame.length; c > b; b++) {
                    var d = a.frame[b];
                    this.flipZVec3(d.vertex), this.flipZVec3(d.normal)
                }
                this._readVertexAnimation(a)
            }, THREE.SEA3D.prototype.readGeometryBuffer = function (a) {
                this.isLegacy(a) && (this.flipZVec3(a.vertex), this.flipZVec3(a.normal), this.flipZIndex(a.indexes), a.jointPerVertex > 4 ? this.compressJoints(a) : a.jointPerVertex < 4 && this.expandJoints(a)), this._readGeometryBuffer(a)
            }, THREE.SEA3D.prototype.readLines = function (a) {
                this.isLegacy(a) && this.flipZVec3(a.vertex), this._readLines(a)
            }, THREE.SEA3D.prototype.onHead = function (a) {
            }, THREE.SEA3D.EXTENSIONS_LOADER.push({
                setTypeRead: function () {
                    this.config.legacy = void 0 == this.config.legacy ? !0 : this.config.legacy, this.file.typeRead[SEA3D.Skeleton.prototype.type] = this.readSkeleton
                }
            })
        }.apply(root, arguments)
    })
}(this),define("KME/controllers/data/world/RenderManager", ["three", "async", "sea3d"], function (a, b) {
    function c(b, c, d) {
        var e;
        return c || (c = b.material), b instanceof a.SEA3D.SkinnedMesh ? (c.skinning = !0, e = new a.SEA3D.SkinnedMesh(b.geometry, c)) : b instanceof a.SEA3D.Mesh ? e = new a.SEA3D.Mesh(b.geometry, c) : (c.morphTargets = !0, e = new a.SEA3D.VertexAnimationMesh(b.geometry, c)), e.scale.set(b.scale.x * d, b.scale.y * d, b.scale.z * d), e.castShadow = window.RENDER_SHADOW, e.receiveShadow = !1, e
    }

    function d(b, c, d) {
        if (!window.RENDER_SHADOW) {
            var e = KME.utils.modelAtlas.types[c].shadowScale;
            if (e || (e = 1), b.shadow)b.shadow.scale.set(e, e, e); else {
                b.shadow = new a.Mesh(d.shadowGeometry, d.shadowMaterial), b.shadow.scale.set(e, e, e);
                var f, g;
                1 >= e ? (f = 20 * e, g = 10 * e) : (f = 20, g = 10), b.shadow.position.set(b.x + f, b.y, b.z + g), b.shadow.rotation.x = -Math.PI / 2, d.scene.add(b.shadow)
            }
        }
    }

    function e(a, b) {
        a.renderType = b, a.parts = {}, Object.keys(KME.utils.modelAtlas.types[b].parts).forEach(function (b) {
            a.parts[b] = {}
        })
    }

    function f(a, b, c, d, e) {
        a && a.skeleton && a.skeleton.bones ? a.skeleton.bones[c].add(b) : console.error("attachToBoneIndex with no skeleton bones", c, d, e)
    }

    var g = window.RENDER_CHARACTER_LIMIT, h = 8, i = 256, j = 2 * i;
    KME.world.render = {
        init: function () {
            this._initScene(), this._initSlots()
        }, _initSlots: function () {
            this.slots = [];
            for (var a, b, c, d = 0; g > d; d++)b = d % h, a = Math.floor(d / h), c = {
                x: -a * j,
                y: 0,
                z: b * i
            }, 0 === d && (c.parts = {}), this.slots.push(c)
        }, newSlot: function (a, b) {
            var c;
            if ("undefined" != typeof b)return c = this.slots[b], e(c, a), d(c, a, this), b;
            for (b = 0; g > b; b++)if (c = this.slots[b], !c.parts)return e(c, a), d(c, a, this), b;
            return null
        }, removeSlot: function (a) {
            var c = this.slots[a];
            c.shadow && (this.scene.remove(c.shadow), delete c.shadow);
            var d = this;
            b.each(Object.keys(c.parts), function (a, b) {
                d._removePart(c, a, b)
            }, function () {
                delete c.parts
            })
        }, getFrameBySlotId: function (a) {
            return {x: a % h * i, y: Math.floor(a / h) * i, width: i, height: i}
        }, _getPart: function (a, b) {
            return a.parts[b]
        }, _removePartMesh: function (c) {
            c.mesh && (this.scene.remove(c.mesh), c.mesh.stop && c.mesh.stop(), c.mesh.geometry && (c.mesh.geometry.dispose(), c.mesh.geometry = void 0), c.mesh.material && (c.mesh.material instanceof a.MeshFaceMaterial ? b.each(c.mesh.material.materials, function (a) {
                a.map && a.map.dispose(), a.lightMap && a.lightMap.dispose(), a.bumpMap && a.bumpMap.dispose(), a.normalMap && a.normalMap.dispose(), a.specularMap && a.specularMap.dispose(), a.envMap && a.envMap.dispose(), a.dispose(), a = void 0
            }) : (c.mesh.material.map && c.mesh.material.map.dispose(), c.mesh.material.lightMap && c.mesh.material.lightMap.dispose(), c.mesh.material.bumpMap && c.mesh.material.bumpMap.dispose(), c.mesh.material.normalMap && c.mesh.material.normalMap.dispose(), c.mesh.material.specularMap && c.mesh.material.specularMap.dispose(), c.mesh.material.envMap && c.mesh.material.envMap.dispose(), c.mesh.material.dispose(), c.mesh.material = void 0)), c.mesh = void 0)
        }, _removePart: function (a, c, d) {
            var e = a.parts[c], f = this;
            e ? e.animations ? b.each(e.animations, function (a, b) {
                a.stop(), b()
            }, function () {
                delete e.animations, f._removePartMesh(e), d()
            }) : (f._removePartMesh(e), d()) : d()
        }, _isPartCanRotateAndPos: function (a, b) {
            return !KME.utils.modelAtlas.types[b].parts[a].isBinds
        }, _getScale: function (a, b, c) {
            return a.isMounted ? 1 : b === KME.utils.modelAtlas.partNames.mount ? 1 : c
        }, _setPart: function (a, b, d, e) {
            function f(a, c, e) {
                if (a && a.skeleton && a.skeleton.bones) {
                    for (var f = 0, g = a.skeleton.bones.length; g > f; f++) {
                        var h = a.skeleton.bones[f];
                        if (h.name === e)return void h.add(c)
                    }
                    console.error("attachToBoneName no find bone", e, b, d)
                } else console.error("attachToBoneName with no skeleton bones", b, d)
            }

            var g = this;
            KME.utils.modelAtlas.getOrLoadModel(d, a.renderType, function (d, h, i) {
                d ? g._removePart(a, b, function () {
                    var j = c(d, h, g._getScale(a, b, i));
                    if (!a.isMounted && g._isPartCanRotateAndPos(b, a.renderType) && j.position.set(a.x, a.y + d.position.y * i, a.z), d.childMeshes)for (var k = 0, l = d.childMeshes.length; l > k; k++)f(j, d.childMeshes[k], d.childMeshes[k].parent.name);
                    g.scene.add(j);
                    var m = {
                        mesh: j,
                        always: "undefined" != typeof KME.utils.modelAtlas.types[a.renderType].alwaysParts[b]
                    };
                    a.parts[b] = m, e(m)
                }) : e()
            })
        }, addCharacterToSlot: function (a, c, e) {
            var g = this.slots[a], h = this;
            g.isMounted = !1;
            var i, j;
            b.waterfall([function (a) {
                c.mount ? h._setPart(g, KME.utils.modelAtlas.partNames.mount, c.mount, function (b) {
                    g.isMounted = !0, i = c.mount.split("-")[0], j = KME.utils.modelAtlas.types[i], d(g, i, h), b.mesh.rotation.y = c.angle, j.mountScale && j.mountScale.self && b.mesh.scale.set(j.mountScale.self, j.mountScale.self, j.mountScale.self), a(null, b)
                }) : h._removePart(g, KME.utils.modelAtlas.partNames.mount, function () {
                    d(g, g.renderType, h), a(null, null)
                })
            }, function (a, d) {
                b.eachSeries(Object.keys(KME.utils.modelAtlas.types[g.renderType].alwaysParts), function (d, e) {
                    var k, l = KME.utils.modelAtlas.types[g.renderType].parts[d];
                    k = c.wearParts && c.wearParts[d] ? c.wearParts[d] : KME.utils.modelAtlas.types[g.renderType].alwaysParts[d], k ? h._setPart(g, d, k, function (m) {
                        m ? (a ? (j.mountScale && j.mountScale.rider && m.mesh.scale.set(j.mountScale.rider, j.mountScale.rider, j.mountScale.rider), f(a.mesh, m.mesh, KME.utils.modelAtlas.getBindModelBoneIndex(k, i), d, k)) : m.mesh.rotation.y = c.angle, l.binds ? b.each(l.binds, function (a, b) {
                            var d = c.wearParts[a];
                            d ? h._setPart(g, a, d, function (c) {
                                c && f(m.mesh, c.mesh, KME.utils.modelAtlas.getBindModelBoneIndex(d, g.renderType), a, d), b()
                            }) : b()
                        }, function () {
                            e()
                        }) : e()) : e()
                    }) : h._removePart(g, d, e)
                }, function () {
                    d()
                })
            }], e)
        }, rotateSlot: function (a, c) {
            c = -c;
            var d = this.slots[a], e = this;
            b.each(Object.keys(d.parts), function (a) {
                !e._isPartCanRotateAndPos(a, d.renderType) || !d.parts[a].mesh || d.parts[a].always && d.isMounted || (d.parts[a].mesh.rotation.y = c)
            })
        }, setSlotStopHandler: function (a, b, c) {
            var d = this.slots[a];
            d && (d.stopHandler = b, d.handlerContext = c)
        }, isSlotStopped: function (a) {
            return this.slots[a].isStopped
        }, playSlot: function (a, c, d, e) {
            e = e ? e : 1, "undefined" == typeof d && (d = !0);
            var f = 0, g = this.slots[a];
            g.isStopped && (g.isStopped = !1);
            var h, i = KME.utils.modelAtlas.types[g.renderType].aniIndexes[c];
            i && (f = i.index, h = i.mounted, i.speed && !g.isMounted && (e *= i.speed));
            var j;
            b.each(Object.keys(g.parts), function (a, b) {
                var c = g.parts[a], i = g.isMounted && a !== KME.utils.modelAtlas.partNames.mount ? h : f;
                if (c.mesh && c.mesh.animations && c.mesh.animations[i]) {
                    var k = c.mesh.animations[i];
                    k.timeScale = e, d || (j = k.duration), c.mesh.setTimeScale(e), c.mesh.play(i)
                }
                b()
            }, function () {
                g.onAnimationCompleteId && clearTimeout(g.onAnimationCompleteId), j && (g.onAnimationCompleteId = setTimeout(function () {
                    g.isStopped = !0, g.stopHandler && g.stopHandler.call(g.handlerContext)
                }, 800 * j / e | 0))
            })
        }, render: function () {
            if (this.renderer) {
                var b = this.clock.getDelta();
                a.SEA3D.AnimationHandler.update(b), this.renderer.render(this.scene, this.camera)
            }
        }, _initScene: function () {
            this.renderer = new a.WebGLRenderer({
                alpha: !0,
                antialias: !0
            }), this.renderer.setClearColor(16777215, 0), this.renderer.setPixelRatio(1), this.renderer.shadowMap.enabled = !0;
            var b = i * h, c = b, d = c / 2 | 0, e = i * Math.ceil(g / h), f = 2 * e, k = f / 2 | 0;
            this.renderer.setSize(b, e), this.clock = new a.Clock, this.scene = new a.Scene, this.camera = new a.OrthographicCamera(-b / 2, b / 2, e / 2, -e / 2, 1, 1e4), this.camera.position.y = 1e3, this.camera.position.x = -1750, this.camera.lookAt(this.scene.position), this.camera.position.z = -(i - b) / 2, this.camera.position.x += j / 4 - (Math.ceil(g / h) - 1) * j / 2, this.scene.add(this.camera);
            var l = new a.HemisphereLight(13089445, 4935764, 1);
            l.position.set(0, 100, 0), this.scene.add(l);
            var m = new a.DirectionalLight(13089445, .6);
            if (this.camera.add(m), m.position.set(-198 - d, 490 + k, -92 + k), m.target.position.set(-d, k, k), m.target.updateMatrixWorld(), this.scene.add(m), window.RENDER_SHADOW) {
                m.castShadow = !0, m.shadowMapWidth = b, m.shadowMapHeight = e, m.shadowCameraLeft = -c, m.shadowCameraRight = c, m.shadowCameraTop = k, m.shadowCameraBottom = -k, m.shadowCameraNear = 0, m.shadowCameraFar = c + f;
                var n = new a.PlaneBufferGeometry(5e3, 5e3), o = ["uniform vec3 diffuse;", "uniform float opacity;", a.ShaderChunk.common, a.ShaderChunk.shadowmap_pars_fragment, "void main() {", "gl_FragColor = vec4( 0.0, 0.0, 0.0, 0.0 );", "vec3 outgoingLight = vec3(0.5);", "vec3 shadowMask = vec3( 0.5 );", a.ShaderChunk.shadowmap_fragment, "if (shadowMask.x < 0.5) {", "gl_FragColor = vec4( 0.0, 0.0, 0.0, 0.5 - shadowMask.x);", "}", "}"].join("\n"), p = new a.ShaderMaterial({
                    uniforms: a.ShaderLib.basic.uniforms,
                    vertexShader: a.ShaderLib.basic.vertexShader,
                    fragmentShader: o
                }), q = new a.Mesh(n, p);
                q.position.set(0, 0, 0), q.rotation.x = -Math.PI / 2, q.receiveShadow = !0, this.scene.add(q)
            } else {
                var r = document.createElement("canvas");
                r.width = 128, r.height = 128;
                var s = r.getContext("2d"), t = 64, u = 64, v = 16, w = 64, x = s.createRadialGradient(t, u, v, t, u, w);
                x.addColorStop(0, "rgba(0,0,0,0.7)"), x.addColorStop(1, "rgba(0,0,0,0)"), s.fillStyle = x, s.fillRect(0, 0, 128, 128);
                var y = new a.Texture(r);
                y.needsUpdate = !0, this.shadowGeometry = new a.PlaneBufferGeometry(100, 100), this.shadowMaterial = new a.MeshBasicMaterial({map: y})
            }
        }
    }
}),define("KME/data/entity/Character", ["three", "i18next", "KME/data/world/WorldObject", "KME/data/world/WorldObject", "KME/controllers/interface/InterfaceController", "KME/controllers/data/world/RenderManager"], function () {
    function a(a) {
        var b = this;
        KME.mainPlayer.checkAndStoreTarget(this, a.action) && KME.socket.emit(KME.commands.clientCommands.worldObjectUse, {
            id: this.id,
            actionName: a.actionName,
            roomId: this.KMEGame.map.getRoomIdByNormalCoords(this.normalPoint)
        }, function (c, d) {
            if (c)b.KMEGame.showMessage(c), KME.mainPlayer.removeStoredTarget(); else switch (a.action) {
                case KME.types.worldTypes.actions.Free:
                    b.KMEGame.showMessage(d);
                    break;
                case KME.types.worldTypes.actions.Ride:
                    break;
                default:
                    console.log("Not known character use! - " + a.action)
            }
        })
    }

    KME.Character = function (a, b, c) {
        return this.typeName = c.typeName, this.objectType = KME.types.worldTypes[this.typeName], this.currentStateName = c.currentState, this.health = c.health, this.id = c.id, this.isMob = !(this instanceof KME.Player), this.isMob && (this.objectTypeName = this.typeName), this.objectType.aggressive ? this.playerNotice = this.objectType.aggressive : this.playerNotice = this.objectType.fright, this.slotId = null, KME.world.WorldObject.call(this, a, b, c.x, c.y, this.getCharacterName(c), c.floorIndex), this.hitStartTime = null, this.targetActionObject = null, c.dead && (this.dead = !0, this.visible = !1), this.bodyInit(this.objectType.body), this.body.isCanStruck = !0, c.angle && this.body.setAngle(c.angle), this.checkCollide = !a.moveBlockOffDebug, this.speed = this.objectType.speed, this.objectType.runSpeed ? this.runSpeed = this.objectType.runSpeed : this.runSpeed = this.speed, this.body.setStartMoveHandler(this.move, this), this.body.setStopMoveHandler(this.stop, this), this.speedRecalculate(c.bonuses), this instanceof KME.MainPlayer ? this.initGraphic(c) : (this.storedCharacterData = c, this.graphicNextTimer = 0, this.body.setStopMoveCollideHandler(this.blockOnMove, this), this.restoreTarget(c.targetData)), this.maskAndLabelInit(KME.utils.worldatlas.getType(this.typeName)), this
    }, KME.Character.prototype = Object.create(KME.world.WorldObject.prototype), KME.Character.prototype.constructor = KME.Character, KME.Character.prototype.initGraphic = function (a) {
        this.graphicNextTimer = Date.now() + 3e3, this.graphicFlag = !0, a || (a = this.storedCharacterData), this.initLayers(KME.utils.worldatlas.getType(this.typeName), a)
    }, KME.Character.prototype.clearGraphic = function () {
        this.graphicNextTimer = Date.now() + 300, this.graphicFlag = !1, this.slotId && (KME.world.render.removeSlot(this.slotId), this.slotId = null), this.sprite && this.sprite.destroy()
    }, KME.Character.prototype.getCharacterName = function (a) {
        return a.name ? (this.baseName = a.name, a.title ? ($.i18n.exists("objects:titles." + a.title) ? $.t("objects:titles." + a.title) : a.title) + " " + a.name : a.name) : (this.baseName = this.getName(a.typeName), this.baseName)
    }, KME.Character.prototype.titleChange = function (a) {
        this.name = this.getCharacterName({name: this.baseName, title: a}), this.label && (this.label.text = this.name)
    }, KME.Character.prototype.speedRecalculate = function (a) {
        if (this.speedCoefficient = 1, a) {
            var b = a.speed;
            "undefined" == typeof b && (b = 0);
            var c = a.slow;
            "undefined" == typeof c && (c = 0), this.speedCoefficient = this.speedCoefficient + c / 1e4, this.speedCoefficient = this.speedCoefficient / (1 + b / 1e4)
        }
    }, KME.Character.prototype.getSpeed = function (a) {
        return a ? this.runSpeed / this.speedCoefficient | 0 : this.speed / this.speedCoefficient | 0
    }, KME.Character.prototype.play = function (a, b, c) {
        null !== this.slotId && KME.world.render.playSlot(this.slotId, a, b, c)
    }, KME.Character.prototype.actionClear = function (a) {
        this.soundStopLoop(), this.body.fullStop(a), this.hitStartTime = null, this.targetActionObject = null, this.noticeEndTime = 0
    }, KME.Character.prototype.runDieSequence = function (a) {
        this.actionClear(!0), this.corpseData = a.corpse, KME.world.render.setSlotStopHandler(this.slotId, this._onComplete, this), this.play(KME.graphic.entityAnimation.animationNames.death, !1), this.dead = !0
    }, KME.Character.prototype._onComplete = function () {
        this.dead && (this.isAnimationDeathComplete = !0), KME.world.render.setSlotStopHandler(this.slotId, null, null)
    }, KME.Character.prototype.initLayers = function (a, b) {
        this.renderType = b.gender ? b.gender : a.render.renderType, this.updateCake(b.wearTypes, b.effects, b.bonuses, !0), b.layout && (this.wearParts = {body: this.renderType + "-" + b.layout}), this.init3D(a, b.effects)
    }, KME.Character.prototype.init3D = function (a, b) {
        if (this instanceof KME.MainPlayer ? (this.slotId = 0, KME.world.render.newSlot(this.renderType, this.slotId)) : this.slotId = KME.world.render.newSlot(this.renderType), null === this.slotId)this.sprite = this.add(new Phaser.Sprite(this.game, 0, 0, "voidEntity")),
            this.sprite.visible = !0, this.sprite.anchor.x = .5, this.sprite.anchor.y = .8; else {
            var c = this;
            KME.world.render.addCharacterToSlot(this.slotId, {
                angle: -this.body.newAngle,
                wearParts: this.wearParts,
                mount: b ? b.mount : null
            }, function () {
                KME.world.render.rotateSlot(c.slotId, c.body.newAngle), c._animationUpdate(), c.sprite = c.add(new Phaser.Sprite(c.game, 0, 0)), c.sprite.visible = !0, c.sprite.anchor.x = a.render.aniAnchorX, c.sprite.anchor.y = a.render.aniAnchorY, c.sprite.setTexture(PIXI.Texture.fromCanvas(KME.world.render.renderer.domElement, PIXI.scaleModes.DEFAULT)), c.sprite.setFrame(KME.world.render.getFrameBySlotId(c.slotId)), c instanceof KME.MainPlayer && c.KMEGame.mainPlayerRenderComplete()
            })
        }
    }, KME.Character.prototype.animationTextureChange = function () {
        this.sprite && this.sprite.texture.baseTexture.dirty()
    }, KME.Character.prototype.updateCake = function (a, b, c, d) {
        if ("undefined" == typeof d && (d = !1), this instanceof KME.MainPlayer ? this.content && this.content.updateBonusesAndEffects(b, c) : this.storedCharacterData && (this.storedCharacterData.wearTypes = a, this.storedCharacterData.effects = b, this.storedCharacterData.bonuses = c), this instanceof KME.Player && this.playerLabelPosUpdate(b && b.mount), this.speedRecalculate(c), d || null !== this.slotId) {
            var e = b ? "undefined" != typeof b.mount : !1, f = this.mountEffect !== e, g = this.wearParts;
            this.wearParts = {};
            var h = this;
            if (a) {
                var i = !1;
                Object.keys(a).forEach(function (b) {
                    var c = a[b], d = KME.utils.itematlas.getVisualEquip(c);
                    if (d) {
                        d.hairChange && (i = d.hairChange);
                        var e = KME.utils.modelAtlas.getModelName(d.modelName, h.renderType);
                        e ? d.visualPosition ? h.wearParts[d.visualPosition] = e : h.wearParts[b] = e : console.error("Model not found", d.modelName)
                    }
                }), i ? "none" !== i && (this.wearParts[KME.utils.modelAtlas.partNames.hair] = i) : this.wearParts[KME.utils.modelAtlas.partNames.hair] = KME.utils.modelAtlas.types[this.renderType].hair
            }
            d || (g ? (Object.keys(this.wearParts).forEach(function (a) {
                g[a] && g[a] === h.wearParts[a] || (f = !0)
            }), f === !1 && Object.keys(this.wearParts).length != Object.keys(g).length && (f = !0)) : f = !0, f && (this.mountEffect = b ? "undefined" != typeof b.mount : !1, KME.world.render.addCharacterToSlot(this.slotId, {
                angle: -this.body.newAngle,
                wearParts: this.wearParts,
                mount: b ? b.mount : null
            }, function () {
                KME.world.render.rotateSlot(h.slotId, h.body.newAngle), h._animationUpdate()
            })))
        }
    }, KME.Character.prototype._animationUpdate = function () {
        this.body.moved() ? this.move() : this.play(KME.graphic.entityAnimation.animationNames.stay)
    }, KME.Character.prototype.update = function () {
        this.animationTextureChange(), this.checkHitDelayPassed(), "undefined" != typeof this.body && null !== this.slotId && KME.world.render.isSlotStopped(this.slotId) && this._animationUpdate(), KME.world.WorldObject.prototype.update.call(this)
    }, KME.Character.prototype.mobsLogic = function () {
        this.isMobWild() && (null === this.targetActionObject ? (this.playerNotice && ("undefined" == typeof this.noticeEndTime || this.noticeEndTime < Date.now()) && KME.mainPlayer && !KME.mainPlayer.dead && this.body.isInRangeObject(KME.mainPlayer, this.playerNotice.distance) && (this.noticeEndTime = Date.now() + 2e3, KME.socket && KME.socket.emit(KME.commands.clientCommands.playerNotice, {
            id: this.id,
            x: this.body.x,
            y: this.body.y,
            angle: this.body.newAngle
        })), this.isHosted() && ("undefined" == typeof this.noticeEndTime || this.noticeEndTime < Date.now()) && this.parent.visible && KME.world.map.objectGroups.isNCoordsOnScreen(this.normalPoint) && !this.body.moved() && ("undefined" == typeof this.nextMobSeeTime ? this.nextMobSeeTime = Date.now() + this.objectType.move.delay + Math.floor(Math.random() * this.objectType.move.rndDelay) : this.nextMobSeeTime < Date.now() && (this.nextMobSeeTime = void 0, KME.socket && KME.socket.emit(KME.commands.clientCommands.playerMobSee, {id: this.id})))) : this.targetActionObject.dead ? this.actionClear() : (this.checkDelayForTarget() && (this.attackOrMoveToTarget(this.targetActionObject, this.objectType.attack.range, !0), this.nextSetTargetTime = Date.now() + 500), this.pursuitEndTime < Date.now() && this.clearTarget()))
    }, KME.Character.prototype.postUpdate = function () {
        return KME.world.WorldObject.prototype.postUpdate.apply(this, arguments), this.isAnimationDeathComplete ? (this.isAnimationDeathComplete = !1, this.corpseData && this.KMEGame.createWorldObject(this.corpseData), void(this instanceof KME.MainPlayer ? this.kill() : this.KMEGame.removeGameWorldObject(this))) : (this.isMob && this.graphicFlag && !this.dead && this.mobsLogic(), void(this instanceof KME.MainPlayer || this.graphicNextTimer < Date.now() && (this.graphicFlag ? this.parent.visible && KME.world.map.objectGroups.isNCoordsOnScreen(this.normalPoint) || this.clearGraphic() : this.parent.visible && KME.world.map.objectGroups.isNCoordsOnScreen(this.normalPoint) && this.initGraphic())))
    }, KME.Character.prototype.attackIfCan = function (a, b) {
        return a && this.body.isInRangeObject(a, b) ? (console.log("attackIfCan hitToXY"), this.hitToXY(a.x, a.y), !0) : !1
    }, KME.Character.prototype.attackOrMoveToTarget = function (a, b, c) {
        this.attackIfCan(a, b) || this.setTarget(a, b, c)
    }, KME.Character.prototype.move = function () {
        this.body.isRun ? this.play(KME.graphic.entityAnimation.animationNames.run) : this.play(KME.graphic.entityAnimation.animationNames.move)
    }, KME.Character.prototype.blockOnMove = function () {
        this.targetActionObject && this.attackIfCan(this.targetActionObject, this.objectType.attack.range) || (this.stop(), this.clearTarget())
    }, KME.Character.prototype.hostedStop = function () {
        this.isPlayerHosted && KME.socket && KME.socket.emit(KME.commands.clientCommands.playerMobStop, {
            id: this.id,
            x: this.x,
            y: this.y,
            angle: this.body.newAngle
        })
    }, KME.Character.prototype.stop = function () {
        this.targetActionObject && this.attackIfCan(this.targetActionObject, this.objectType.attack.range) || this.play(KME.graphic.entityAnimation.animationNames.stay), this.isMob && this.hostedStop()
    }, KME.Character.prototype.checkDelayForTarget = function () {
        return "undefined" != typeof this.hitEndTime && this.hitEndTime >= Date.now() ? !1 : "undefined" != typeof this.hitStartTime && this.hitStartTime >= Date.now() ? !1 : "undefined" != typeof this.nextSetTargetTime && this.nextSetTargetTime >= Date.now() ? !1 : !0
    }, KME.Character.prototype.inRangeAction = function () {
        var a = this.body.targetObject;
        this.hitToXY(a.x, a.y)
    }, KME.Character.prototype.updateAngle = function () {
        null !== this.slotId && KME.world.render.rotateSlot(this.slotId, this.body.newAngle)
    }, KME.Character.prototype.calcAngleAndFace = function (a, b) {
        var c = a - this.x, d = b - this.y;
        if (0 !== c || 0 !== d) {
            var e = Math.atan2(d, c);
            this.body.setAngle(e), this.updateAngle()
        }
    }, KME.Character.prototype.hitToXY = function (a, b) {
        this.calcAngleAndFace(a, b), this.startHit()
    }, KME.Character.prototype.checkHitDelayPassed = function () {
        this.hitStartTime && this.hitStartTime < Date.now() && this.startHit()
    }, KME.Character.prototype.startHit = function () {
        var a = this.objectType.attack;
        if ("undefined" != typeof a) {
            var b = this.hitEndTime;
            "undefined" != typeof b && b > Date.now() || (a.delayBefore > 0 ? this.hitStartTime ? this.hitStartTime < Date.now() && (this.hitStartTime = 0, this.doHit(a)) : (this.hitStartTime = Date.now() + a.delayBefore, a.play ? this.playAction(a.play) : this.playAction(KME.graphic.entityAnimation.animationNames.hit)) : (a.play ? this.playAction(a.play) : this.playAction(KME.graphic.entityAnimation.animationNames.hit), this.doHit(a)))
        }
    }, KME.Character.prototype.getHitObjects = function (a) {
        var b = {
            shape: a.shape.name,
            moveBlock: !1,
            viewBlock: !1,
            doAction: !1,
            anchorX: a.shape.anchorX,
            anchorY: a.shape.anchorY
        };
        a.shape.rotate && (b.angle = this.body.newAngle);
        var c = new Phaser.BodyIsometric(this.game, this, b);
        c.setCollideExcludeObject(this);
        var d = Math.cos(this.body.newAngle), e = Math.sin(this.body.newAngle), f = this.x + d * a.startRange, g = this.y + e * (a.startRange / 2);
        if (c.oldPos.x = c.newPos.x = f, c.oldPos.y = c.newPos.y = g, this.KMEGame.hitAreaDebug) {
            var h;
            h = new KME.world.WorldEffect(this.KMEGame, this.game, null, c.x, c.y, c.shape)
        }
        var i = KME.world.map.collisionLayer.getCollideObjects(c);
        return i.length > 1 && (i = KME.world.map.collisionLayer.hitLineSightCheck(this, i, a.splash)), i
    }, KME.Character.prototype.doHit = function (a) {
        if (a.delay > 0 && (this.hitEndTime = Date.now() + a.delay), a.projectile) {
            var b;
            b = new KME.world.WorldProjectile(this.KMEGame, this.game, this, {
                senderTypeName: this.typeName,
                senderAmmoType: "noAmmo"
            })
        } else {
            for (var c = this.getHitObjects(a), d = [], e = 0; e < c.length; e++) {
                var f = c[e];
                if (f != this && (f.startHitEffect(), f === KME.mainPlayer)) {
                    KME.controllers.sound.huntEvent();
                    var g = {id: f.id, typeName: this.typeName, fromId: this.id};
                    if (f instanceof KME.Player && (g.playerName = f.baseName), d.push(g), !a.splash)break
                }
            }
            d.length > 0 && KME.socket && KME.socket.emit(KME.commands.clientCommands.harmWorldObjects, d)
        }
    }, KME.Character.prototype.startBloodEffect = function () {
        var a, b = 0;
        a = this instanceof KME.Player ? -50 : .5 * this.label.y | 0;
        var c = this;
        KME.utils.worldatlas.createEffect(KME.utils.worldatlas.effects.hitBlood, b, a, function (a) {
            c.add(a)
        })
    }, KME.Character.prototype.playAction = function (a, b, c) {
        "undefined" == typeof b && (b = !1), "injury" === a && this.startBloodEffect(), this.soundStopLoop(), this.play(a, b, c)
    }, KME.Character.prototype.soundStopLoop = function () {
        this.loopSound && this.loopSound.destroy(!0)
    }, KME.Character.prototype.soundPlayLoop = function (a, b) {
        this.loopSound = KME.controllers.sound.playLoop(a, b)
    }, KME.Character.prototype.clearTarget = function () {
        this.isPlayerHosted && KME.socket.emit(KME.commands.clientCommands.playerMobSee, {id: this.id}), this.noticeEndTime && (this.noticeEndTime = Date.now() + 2e3), this.targetActionObject && (this.targetActionObject = null)
    }, KME.Character.prototype.updateObject = function (a) {
        this instanceof KME.Player || this.currentStateName !== a.currentState && (this.currentStateName = a.currentState)
    }, KME.Character.prototype.inRangeClick = function () {
    }, KME.Character.prototype.isSafePlayer = function () {
        return !this.isMob && KME.mainPlayer.isSafe()
    }, KME.Character.prototype.isCanAction = function () {
        return this.isMob ? this.isMobWild() ? this.isCanCatch() : !0 : !1
    }, KME.Character.prototype.isMobWild = function () {
        return "undefined" == typeof this.currentStateName || "Wild" === this.currentStateName
    }, KME.Character.prototype.isCanCatch = function () {
        return !(!this.objectType.catchType || !KME.mainPlayer.content.bonuses[this.objectType.catchType.bonusType])
    }, KME.Character.prototype.tryToUse = function (a) {
        if (this.isMob) {
            if (this.isMobWild()) {
                if (this.isCanCatch()) {
                    var b = this;
                    return KME.socket.emit(KME.commands.clientCommands.worldObjectUse, {
                        id: this.id,
                        roomId: this.KMEGame.map.getRoomIdByNormalCoords(this.normalPoint),
                        actionName: KME.types.worldTypes.actions.Catch
                    }, function (a, c) {
                        a ? b.KMEGame.showMessage(a) : (KME.mainPlayer.endTimerHandler = KME.mainPlayer.finalCheckToUseCharacter, KME.mainPlayer.catchTarget = b, KME.mainPlayer.timerIndicator.start(c))
                    }), !0
                }
                return !1
            }
            return this.onUse(a), !0
        }
        return !1
    }, KME.Character.prototype.showMenu = function (a) {
        KME.controllers.ui.world.showMenu(this, a)
    }, KME.Character.prototype.onUse = function (b) {
        var c = KME.utils.ActionController.getActionList(this);
        if (c) {
            var d = c[0];
            if (c.length > 1) {
                if ("undefined" == typeof b || null === b)return this.showMenu(c), void KME.mainPlayer.removeStoredTarget();
                KME.mainPlayer.useActionName = null;
                for (var e = 0; e < c.length && (d = c[e], d.actionName !== b); e++);
            }
            if (d && (b = d.actionName), KME.mainPlayer.isMount())return void this.KMEGame.showMessage(KME.types.messageTypes.cantDoMounted);
            if (KME.world.map.collisionLayer.isLineSight(KME.mainPlayer, this)) {
                var f = this;
                d.warning ? KME.Confirmation.showMessage($.t("interfaces:confirmations." + d.warning), function () {
                    KME.mainPlayer.tryToNearUse(f, b) ? a.apply(f, [d]) : f.KMEGame.showMessage(KME.types.messageTypes.actionTooFarAway)
                }) : a.apply(this, [d])
            }
        }
    }, KME.Character.prototype.characterStop = function (a, b, c) {
        this.hitStartTime = 0, this.soundStopLoop(), this.body.fullStop(), this.play(KME.graphic.entityAnimation.animationNames.stay), this.targetActionObject && (this.targetActionObject === KME.mainPlayer && (this.noticeEndTime = Date.now() + 5e3), this.targetActionObject = null), a && (this.body.setXYAngle(a, b, c), this.updateAngle(), this.isMovedNeedCheck = !0)
    }, KME.Character.prototype.isHosted = function () {
        return this.isPlayerHosted || !this.hostedWaitTime || this.hostedWaitTime < Date.now()
    }, KME.Character.prototype.setPlayerHosted = function (a) {
        this.isPlayerHosted = a, a ? this.hostedWaitTime = null : this.hostedWaitTime = Date.now() + 2e4
    }, KME.Character.prototype.restoreTarget = function (a) {
        if (a) {
            if (a.id) {
                var b = this.KMEGame.objects[a.id];
                if (b)return void this.setTargetFromServer(b, a.range, a.isRun)
            }
            this.moveToFromServer(a.x, a.y, a.isRun)
        }
    }, KME.Character.prototype.moveToFromServer = function (a, b, c, d) {
        this.moveTo(a, b, c), this.isMob && (this.setPlayerHosted(d && d === KME.mainPlayer.id), c && this.objectType.attack && (this.noticeEndTime = Date.now() + 2e4, this.targetActionObject && (this.targetActionObject = null)))
    }, KME.Character.prototype.moveTo = function (a, b, c) {
        this.KMEGame.mobDebug && this.isMob || (this.hitStartTime = 0, this.nextMobSeeTime && (this.nextMobSeeTime = void 0), this.soundStopLoop(), this.body.setMovePointer(a, b, c, !0))
    }, KME.Character.prototype.setTargetFromServer = function (a, b, c) {
        this.isMob ? (this.nextMobSeeTime && (this.nextMobSeeTime = void 0), this.targetActionObject = a, this.setPlayerHosted(a === KME.mainPlayer), a === KME.mainPlayer && KME.controllers.sound.huntEvent(), this.objectType.attack && this.objectType.attack.pursuitDelay && (this.pursuitEndTime = Date.now() + this.objectType.attack.pursuitDelay)) : this.setTarget(a, b, c)
    }, KME.Character.prototype.setTarget = function (a, b, c) {
        this.soundStopLoop(), "undefined" == typeof b && (b = 0), this.body.setTargetObject(a, this.inRangeClick, this, b, c)
    }, KME.Character.prototype.onTileChanged = function () {
        var a = this.normalPoint;
        if (KME.world.WorldObject.prototype.onTileChanged.apply(this, arguments), this.isPlayerHosted) {
            var b = this.KMEGame.map.getRoomIdByNormalCoords(a), c = this.KMEGame.map.getRoomIdByNormalCoords(this.normalPoint);
            if (b !== c) {
                var d = {id: this.id, newRoomId: c, x: this.x, y: this.y, angle: this.body.newAngle};
                this.targetActionObject ? d.targetData = {
                    id: this.targetActionObject.id,
                    x: this.targetActionObject.x,
                    y: this.targetActionObject.y,
                    isRun: this.body.isRun
                } : this.body.pointer && (d.targetData = {
                    x: this.body.pointer.x,
                    y: this.body.pointer.y,
                    isRun: this.body.isRun
                }), KME.controllers.network.actions.playerMobRoomChange(d)
            }
        }
    }, KME.Character.prototype.onOver = function () {
        KME.world.WorldObject.prototype.onOver.call(this), this.isCanAction() ? KME.controllers.ui.cursor.setTool() : this.isSafePlayer() ? KME.controllers.ui.cursor.setNormal() : KME.controllers.ui.cursor.setAttack()
    }, KME.Character.prototype.onOut = function () {
        KME.world.WorldObject.prototype.onOut.call(this), KME.controllers.ui.cursor.setNormal()
    }, KME.Character.prototype.destroy = function () {
        this.soundStopLoop(), this.slotId && KME.world.render.removeSlot(this.slotId), this.id && this.KMEGame.objects[this.id] && delete this.KMEGame.objects[this.id], KME.world.WorldObject.prototype.destroy.call(this)
    }
}),define("KME/data/items/Item", ["jquery"], function (a) {
    KME.Item = function (a, b, c, d, e, f) {
        a && a.id ? this._parseContent(a) : (this.id = b, this.image = c, this.equippedImage = d, this.typeName = e, this.position = f, this.type = KME.types.itemTypes[this.typeName])
    }, KME.Item.prototype._parseContent = function (a) {
        this.content = a, this.id = a.id, this.image = a.image, this.equippedImage = a.equippedImage, this.typeName = a.typeName, this.position = a.position, "undefined" != typeof a.amount && (this.amount = a.amount), "undefined" != typeof a.durability && (this.durability = a.durability), "undefined" != typeof a.quality && (this.quality = a.quality), this.type = KME.types.itemTypes[this.typeName], a.name && (this.name = a.name)
    }, KME.Item.prototype.onClick = function (b, c) {
        var d = this;
        if (!b.attr("data-dragging") || 1 != b.attr("data-dragging")) {
            var e = b.closest(".interfaceContainer");
            e && "inventory" == a(e).attr("id") && (c ? (b.popover("hide"), KME.controllers.data.actions.perform("double", d, function () {
            })) : (b.popover("show"), b.addClass("opened")))
        }
    }, KME.Item.prototype.setPosition = function (a, b) {
        var c = this.position;
        this.position = a, this.content.position = a, b && (b.slots[c] = null, b.slots[a] = this)
    }, KME.Item.prototype.update = function (a) {
        this._parseContent(a)
    }, KME.Item.prototype.getWithQuality = function (a) {
        return this.quality ? Math.round(a * this.quality) : a
    }, KME.Item.prototype.getTitle = function () {
        var b = this.getName();
        if ("undefined" != typeof this.amount && (b += " x " + this.amount), this.type.attack && this.type.attack.damage) {
            var c = 5e3 / (this.type.attack.delayBefore + this.type.attack.delay) | 0;
            b += "\n$t(interfaces:item.damage): " + this.getWithQuality(this.type.attack.damage) + " $t(interfaces:item.speed): " + c
        }
        return this.type.damage && (b += "\n$t(interfaces:item.addDamage): " + this.type.damage), this.type.bonuses && "armor" === this.type.bonuses[0].bonusName && (b += "\n$t(interfaces:item.armor): " + this.getWithQuality(this.type.bonuses[0].bonusValue), this.type.bonuses[1] && "slow" === this.type.bonuses[1].bonusName && (b += " $t(interfaces:item.slow): " + this.type.bonuses[1].bonusValue)), "undefined" != typeof this.durability && (b += "\n$t(interfaces:item.durability): " + this.durability + "/" + this.type.durability), "undefined" != typeof this.quality && (b += "\n$t(interfaces:item.quality): " + Math.round(100 * this.quality) + "%"), a.t(b)
    }, KME.Item.prototype.getName = function () {
        return this.name ? a.t(this.name) : a.t("objects:items." + this.typeName)
    }
}),define("KME/data/entity/PlayerContent", ["KME/data/items/Item"], function () {
    function a(a) {
        for (var b = 0, c = 0, d = e.length; d > c; c++)b += a[e[c]];
        return b / 5 | 0
    }

    function b(a, b) {
        a.items.push(b.content);
        var c = a.slots[b.position];
        return a.slots[b.position] = b, c
    }

    function c(a, b, c) {
        return Object.keys(a.items).forEach(function (d) {
            if (a.items[d] && a.items[d].id === b.id) {
                var e = a.items[d], f = a.slots[e.position];
                $.isArray(a.items) ? a.items.splice(d, 1) : delete a.items[d], !c && f ? delete a.slots[e.position] : f && a.slots[e.position].content == e && (a.slots[e.position] = null)
            }
        }), !1
    }

    function d(a, b, c) {
        var d, e, f = Object.keys(a.wear.slots);
        for (d = 0; d < f.length; ++d)if (e = a.wear.slots[f[d]], e && e[b] === c)return e;
        for (d = 0; d < a.inventory.slots.length; ++d)if (e = a.inventory.slots[d], e && e[b] === c)return e;
        return null
    }

    var e = ["meat", "bread", "mixed", "vegetable", "fruit"];
    KME.PlayerContent = function (a, b) {
        this.worldObject = b, this.id = a.id, this.typeName = a.typeName, this.wear = {
            items: a.wear.items ? a.wear.items : [],
            slots: {leftHand: null, rightHand: null, head: null, body: null, legs: null, foots: null, hands: null}
        }, this.inventory = {items: a.inventory.items ? a.inventory.items : [], slots: []}, this.update(a)
    }, KME.PlayerContent.prototype.updateBonusesAndEffects = function (a, b) {
        this.effects = a, this.bonuses = b
    }, KME.PlayerContent.prototype.update = function (b) {
        if (this.health = b.health, this.stamina = b.food.stamina, this.food = a(b.food), this.effects = b.effects ? b.effects : {}, this.bonuses = b.bonuses ? b.bonuses : {}, this.toolbar = b.toolbar ? b.toolbar : {}, this.knowledge = b.knowledge, this.claim = b.claim, this.corpse = b.corpse, this.claim) {
            var c = KME.world.phasermap.getWorldTileCenterByNormal({nX: this.claim.nX, nY: this.claim.nY});
            this.claim.worldX = c.x, this.claim.worldY = c.y, this.worldObject.content && this.worldObject.claimDirection.render();
            //RIM
            if(rareDir) {this.worldObject.rareDirection.render(); }
            //RIM
        }
        if (this.corpse) {
            var d = KME.world.phasermap.getWorldTileCenterByNormal({nX: this.corpse.nX, nY: this.corpse.nY});
            this.corpse.worldX = d.x, this.corpse.worldY = d.y, this.worldObject.content && this.worldObject.corpseDirection.render()
        }
        var e = this;
        this.wear.items = b.wear.items ? b.wear.items : [], this._proxyItems(b.wear.items, this.wear.slots, function (a) {
            e.wear.slots[a.position] = a
        }), this.inventory.items = b.inventory.items ? b.inventory.items : [], this._proxyItems(b.inventory.items, this.inventory.slots)
    }, KME.PlayerContent.prototype.moveItem = function (a, d, e, f) {
        return c(this[d], a, f), b(this[e], a)
    }, KME.PlayerContent.prototype.moveItemFromContainerToPlayer = function (a, d, e, f) {
        if (d) {
            var g = d[e] && e ? d[e] : d;
            c(g, a)
        }
        b(this[f], a)
    }, KME.PlayerContent.prototype.moveItemFromPlayerToContainer = function (a, d, e, f) {
        if (c(this[d], a), f) {
            var g = f[e] && e ? f[e] : f;
            b(g, a)
        }
    }, KME.PlayerContent.prototype._proxyItems = function (a, b, c) {
        var d;
        Object.keys(b).forEach(function (a) {
            b[a] && (b[a].markedToDelete = !0)
        }), Object.keys(a).forEach(function (e) {
            a[e] && (b[a[e].position] && b[a[e].position].id === a[e].id ? (d = b[a[e].position], d.update(a[e]), delete d.markedToDelete) : d = new KME.Item(a[e]), b[d.position] = d, c && c(d))
        }), Object.keys(b).forEach(function (a) {
            b[a] && b[a].markedToDelete && (b[a] = null)
        })
    }, KME.PlayerContent.prototype.getItemById = function (a) {
        return d(this, "id", a)
    }, KME.PlayerContent.prototype.getFirstItemByType = function (a) {
        return d(this, "typeName", a)
    }, KME.PlayerContent.prototype.inventoryUpdateCallback = function (a) {
        this.inventoryCallback = a
    }, KME.PlayerContent.prototype.wearUpdateCallback = function (a) {
        this.wearCallback = a
    }, KME.PlayerContent.prototype.toolbarUpdateCallback = function (a) {
        this.toolbarCallback = a
    }, KME.PlayerContent.prototype.countItemsByType = function (a, b) {
        for (var c, d = 0, e = 0; e < this.inventory.items.length; ++e)c = this.inventory.items[e], c.typeName == a && ++d;
        if (b)for (e = 0; e < this.wear.items.length; ++e)c = this.wear.items[e], c.typeName == a && ++d;
        return d
    }, KME.PlayerContent.prototype.count = function (a, b) {
        var c, d = 0;
        if (a.type.max) {
            for (var e = 0; e < this.inventory.items.length; ++e)c = this.inventory.items[e], c.typeName == a.typeName && (d += c.amount);
            if (b)for (e = 0; e < this.wear.items.length; ++e)c = this.wear.items[e], c.typeName == a.typeName && (d += c.amount);
            return d
        }
        return !1
    }
}),define("KME/data/entity/Player", ["KME/data/entity/Character", "KME/data/entity/PlayerContent"], function () {
    function a(a) {
        var b = !1;
        switch (a) {
            case"heart":
                b = "0xf004";
                break;
            case"fdown":
                b = "0xf119";
                break;
            case"meh":
                b = "0xf11a";
                break;
            case"paw":
                b = "0xf1b0";
                break;
            case"apple":
                b = "0xf179";
                break;
            case"angellist":
                b = "0xf209";
                break;
            case"chat":
                b = "0xf075";
                break;
            case"gavel":
                b = "0xf0e3";
                break;
            case"wheelchair":
                b = "0xf193";
                break;
            case"fire":
                return "0xf06d";
            case"fire-extinguisher":
                return "0xf134";
            case"key":
                return "0xf084";
            case"gift":
                return "0xf06b";
            case"flash":
                return "0xf0e7";
            case"coffee":
                return "0xf0f4"
        }
        return b
    }

    var b = 120;
    KME.Player = function (a, b, c) {
        return KME.Character.call(this, a, b, c), this.messageZone = new Phaser.Group(this.game, this.interfaceElements), this.messageZone.anchor = {
            x: .5,
            y: 1
        }, this.playerLabelPosUpdate(c.effects && c.effects.mount), this.emoteStyle = {
            font: "30px FontAwesome",
            fill: "#FFFFFF",
            align: "center"
        }, this
    }, KME.Player.prototype = Object.create(KME.Character.prototype), KME.Player.prototype.constructor = KME.Player, KME.Player.prototype.getSpeed = function (a) {
        return a ? (this.speed + b) / this.speedCoefficient | 0 : this.speed / this.speedCoefficient | 0
    }, KME.Player.prototype.moveToFromServer = function (a, b, c) {
        KME.Character.prototype.moveTo.call(this, a, b, c)
    }, KME.Player.prototype.playerLabelPosUpdate = function (a) {
        a ? (this.label && (this.label.y = -135), this.messageZone && (this.messageZone.y = -155)) : (this.label && (this.label.y = -95), this.messageZone && (this.messageZone.y = -115))
    }, KME.Player.prototype._message = function (b) {
        var c, d = 3e3, e = 0;
        "string" == typeof b ? (KME.types.messageTypes[b] && (b = KME.types.messageTypes[b]), c = $.t(b)) : b.message && (c = b.message, b.delay && (e = b.delay + Math.floor(b.message.length / 140 * 5 * 1e3))), 3 === this.messageZone.children.length && this.messageZone.removeBetween(0, 0, !0), this.messageZone.forEach(function (a) {
            a.y -= 15
        });
        var f, g, h = a(c);
        h ? (f = String.fromCharCode(h), g = this.emoteStyle) : (f = c, g = this.KMEGame.messageStyle);
        var i = this.messageZone.add(new Phaser.Text(this.game, 0, 0, f, g));
        i.setShadow(0, 0, "rgb(0,0,0)", 3, !0), i.anchor = {
            x: .5,
            y: 1
        }, this.game.add.tween(i).to({alpha: 0}, d, Phaser.Easing.Linear.None, !0, e, 0, !1).onComplete.add(function () {
            i.destroy()
        }, this)
    }, KME.Player.prototype.showMessage = function (a) {
        "undefined" == typeof a && (a = "No message");
        var b;
        b = a instanceof Array ? a : [a];
        for (var c = 0, d = b.length; d > c; c++)this._message(b[c])
    }
}),define("KME/data/world/TimerIndicator", ["phaser"], function () {
    KME.world.TimerIndicator = function (a, b) {
        this.sprite = new Phaser.Sprite(a.game, 0, b, "microBar", 0), this.sprite.visible = !1, this.sprite.anchor.x = .5, this.sprite.anchor.y = 1, this.progressBar = new Phaser.Sprite(this.sprite.game, -this.sprite.width / 2, this.sprite.y, "microBar", 1), this.progressBar.anchor.x = 0, this.progressBar.anchor.y = 1, this.progressBar.crop({
            x: 0,
            y: 0,
            width: 0,
            height: this.progressBar.height
        }), a.interfaceElements.add(this.progressBar), a.interfaceElements.add(this.sprite)
    }, KME.world.TimerIndicator.prototype.setEndTimerHandler = function (a, b) {
        this.endTimerHandler = a, this.handlerContext = b
    }, KME.world.TimerIndicator.prototype.start = function (a) {
        this.startTimer = Date.now(), this.endTimer = this.startTimer + a, this.startTimer === this.endTimer && this.endTimer++, this.sprite.visible = !0, this.progressBar.visible = !0
    }, KME.world.TimerIndicator.prototype.hide = function () {
        this.sprite.visible = !1, this.progressBar.visible = !1
    }, KME.world.TimerIndicator.prototype.render = function () {
        if (this.sprite.visible) {
            var a, b = Date.now();
            if (b > this.endTimer)return this.endTimerHandler && this.endTimerHandler.call(this.handlerContext), this.sprite.visible = !1, void(this.progressBar.visible = !1);
            a = (b - this.startTimer) / (this.endTimer - this.startTimer), this.progressBar.cropRect.width = this.sprite.width * a, this.progressBar.updateCrop()
        }
    }
}),define("KME/data/world/ClaimDirection", ["phaser"], function () {
    var a = 150, b = 110, c = 180;
    KME.world.ClaimDirection = function (a) {
        this.mainPlayer = a, this.sprite = new Phaser.Sprite(a.game, 0, 0, "claimDirection", 0), this.sprite.visible = !1, this.sprite.anchor.x = .5, this.sprite.anchor.y = .5, this.directionArrow = new Phaser.Sprite(this.sprite.game, 0, 0, "claimDirection", 1), this.directionArrow.anchor.x = .5, this.directionArrow.anchor.y = .9, this.directionArrow.visible = !1, a.interfaceElements.add(this.sprite), a.interfaceElements.add(this.directionArrow)
    }, KME.world.ClaimDirection.prototype.render = function () {
        if (this.mainPlayer.content && this.mainPlayer.content.claim && KME.gameState.interfaceShow) {
            var d = this.mainPlayer.content.claim.worldX - this.mainPlayer.x, e = this.mainPlayer.content.claim.worldY - this.mainPlayer.y;
            if (Math.abs(d) > KME.game.width / 2 || Math.abs(e) > KME.game.height / 2) {
                var f = Math.atan2(e, d);
                f = 0 > f ? 2 * Math.PI + f : f;
                var g, h, i = Math.cos(f), j = Math.sin(f), k = KME.game.width + KME.game.height, l = i * k, m = j * k;
                l < a - KME.game.width / 2 && (g = l, l = a - KME.game.width / 2), l > KME.game.width / 2 - a && (g = l, l = KME.game.width / 2 - a), g && (m *= l / g), m < b - KME.game.height / 2 && (h = m, m = b - KME.game.height / 2), m > KME.game.height / 2 - c && (h = m, m = KME.game.height / 2 - c), h && (l *= m / h), this.sprite.x = this.directionArrow.x = l, this.sprite.y = this.directionArrow.y = m, this.directionArrow.angle = 180 * f / Math.PI + 90, this.sprite.visible = !0, this.directionArrow.visible = !0
            } else this.sprite.visible = !1, this.directionArrow.visible = !1
        } else this.sprite.visible = !1, this.directionArrow.visible = !1
    }
}),

//RIM
define("KME/data/world/RareDirection", ["phaser"], function () {
    var a = 250, b = 210, c = 280;
    KME.world.RareDirection = function (a) {
        this.mainPlayer = a, this.sprite = new Phaser.Sprite(a.game, 0, 0, "rareDirection", 0), this.sprite.visible = !1, this.sprite.anchor.x = .5, this.sprite.anchor.y = .5, this.directionArrow = new Phaser.Sprite(this.sprite.game, 0, 0, "rareDirection", 1), this.directionArrow.anchor.x = .5, this.directionArrow.anchor.y = .9, this.directionArrow.visible = !1, a.interfaceElements.add(this.sprite), a.interfaceElements.add(this.directionArrow)
    }, KME.world.RareDirection.prototype.render = function () {
        if (this.mainPlayer.content && rareDir && KME.gameState.interfaceShow) {
            var d = rareDir.x - this.mainPlayer.x, e = rareDir.y - this.mainPlayer.y;
            var f = Math.atan2(e, d);
            f = 0 > f ? 2 * Math.PI + f : f;
            var g, h, i = Math.cos(f), j = Math.sin(f), k = KME.game.width + KME.game.height, l = i * k, m = j * k;
            l < a - KME.game.width / 2 && (g = l, l = a - KME.game.width / 2), l > KME.game.width / 2 - a && (g = l, l = KME.game.width / 2 - a), g && (m *= l / g), m < b - KME.game.height / 2 && (h = m, m = b - KME.game.height / 2), m > KME.game.height / 2 - c && (h = m, m = KME.game.height / 2 - c), h && (l *= m / h), this.sprite.x = this.directionArrow.x = l, this.sprite.y = this.directionArrow.y = m, this.directionArrow.angle = 180 * f / Math.PI + 90, this.sprite.visible = !0, this.directionArrow.visible = !0
        } else this.sprite.visible = !1, this.directionArrow.visible = !1
    }
}),
//RIM


define("KME/data/world/CorpseDirection", ["phaser"], function () {
    var a = 150, b = 110, c = 180;
    KME.world.CorpseDirection = function (a) {
        this.mainPlayer = a, this.sprite = new Phaser.Sprite(a.game, 0, 0, "corpseDirection", 0), this.sprite.visible = !1, this.sprite.anchor.x = .5, this.sprite.anchor.y = .5, this.directionArrow = new Phaser.Sprite(this.sprite.game, 0, 0, "corpseDirection", 1), this.directionArrow.anchor.x = .5, this.directionArrow.anchor.y = .9, this.directionArrow.visible = !1, a.interfaceElements.add(this.sprite), a.interfaceElements.add(this.directionArrow)
    }, KME.world.CorpseDirection.prototype.render = function () {
        if (this.mainPlayer.content && this.mainPlayer.content.corpse && KME.gameState.interfaceShow) {
            var d = this.mainPlayer.content.corpse.worldX - this.mainPlayer.x, e = this.mainPlayer.content.corpse.worldY - this.mainPlayer.y;
            if (Math.abs(d) > KME.game.width / 2 || Math.abs(e) > KME.game.height / 2) {
                var f = Math.atan2(e, d);
                f = 0 > f ? 2 * Math.PI + f : f;
                var g, h, i = Math.cos(f), j = Math.sin(f), k = KME.game.width + KME.game.height, l = i * k, m = j * k;
                l < a - KME.game.width / 2 && (g = l, l = a - KME.game.width / 2), l > KME.game.width / 2 - a && (g = l, l = KME.game.width / 2 - a), g && (m *= l / g), m < b - KME.game.height / 2 && (h = m, m = b - KME.game.height / 2), m > KME.game.height / 2 - c && (h = m, m = KME.game.height / 2 - c), h && (l *= m / h), this.sprite.x = this.directionArrow.x = l, this.sprite.y = this.directionArrow.y = m, this.directionArrow.angle = 180 * f / Math.PI + 90, this.sprite.visible = !0, this.directionArrow.visible = !0
            } else this.sprite.visible = !1, this.directionArrow.visible = !1
        } else this.sprite.visible = !1, this.directionArrow.visible = !1
    }
}),define("KME/data/world/WorldEffect", ["./WorldObject", "phaser"], function () {
    KME.world.WorldEffect = function (a, b, c, d, e, f, g) {
        if (KME.world.WorldObject.call(this, a, b, d, e, "effect", 1), f)this.sprite = new Phaser.Sprite(b, 0, 0, f), this.sprite.anchor.x = .5, this.sprite.anchor.y = .5, this.add(this.sprite), this.tween = this.game.add.tween(this.sprite).to({alpha: 0}, 1e3, Phaser.Easing.Linear.None, !0, 0, 0, !1), this.tween.onComplete.add(this.destroy, this); else {
            c.shake && d > KME.game.camera.x && d < KME.game.camera.x + KME.game.camera.width && e > KME.game.camera.y && e < KME.game.camera.y + KME.game.camera.height && (a.shakeWorld = 20);
            var h = this;
            KME.utils.worldatlas.createOrLoadSprite(c.image, 0, c.anchorX, c.anchorY, function (a) {
                a.animations.add(c.image), a.animations.play(c.image, c.frameRate, !1), a.events.onAnimationComplete.add(function () {
                    h.destroy()
                }, this), h.sprite = h.add(a), g && (h.width = h.width * g | 0, h.height = h.height * g | 0)
            })
        }
    }, KME.world.WorldEffect.prototype = Object.create(KME.world.WorldObject.prototype), KME.world.WorldEffect.prototype.constructor = KME.world.WorldEffect
}),define("KME/data/world/WorldPlacer", ["async", "./WorldObject"], function (a) {
    KME.world.WorldPlacer = function (b, c, d, e) {
        "undefined" != typeof b.placer && b.placer.destroy(), this.KMEGame = b, b.placer = this, e ? this.callbackOnPlace = e : this.callbackOnPlace = KME.mainPlayer.nearBuildPlace, this.setLayoutAndStateIfNeeded(d), this.itemOrObject = d, this.objectType = this.getType(d.typeName), this.objectType.claimConfig ? this.sectionArray = this.getSectionArrayForClaim(d.typeName, this.objectType.claimConfig.halfSize) : this.sectionArray = this.getSectionArray(d);
        var f, g, h, i = "Place " + this.getName(d.typeName), j = this, k = 0, l = 0, m = 0, n = 0, o = KME.mainPlayer.floorIndex;
        if (this.sectionArray) {
            var p = this.sectionArray[0];
            h = j.getType(p.typeName).changeFloorIndex, "undefined" != typeof h && (o += h)
        } else"undefined" != typeof j.objectType.changeFloorIndex && (o += j.objectType.changeFloorIndex);
        var q, r, s, t;
        d.x && Math.abs(d.x - KME.mainPlayer.x) < c.width / 4 && Math.abs(d.y - KME.mainPlayer.y) < c.height / 4 ? (q = d.x, r = d.y) : (q = KME.mainPlayer.x - 200, r = KME.mainPlayer.y), KME.world.WorldObject.call(this, b, c, q, r, i, o), this.sectionArray ? a.map(this.sectionArray, function (a, b) {
            KME.utils.worldatlas.createSpriteByType(a.typeName, a.layout, KME.utils.worldatlas.getType(a.typeName).placeState, void 0, function (a) {
                b(null, a)
            })
        }, function (a, d) {
            for (s = 0, t = d.length; t > s; s++) {
                var e = j.sectionArray[s], p = d[s];
                if (0 === s)j.sprite = j.add(p), f = j.getBody(e.typeName, e.layout); else {
                    "undefined" == typeof j.setObjects && (j.setObjects = []), o = KME.mainPlayer.floorIndex, h = j.getType(e.typeName).changeFloorIndex, "undefined" != typeof h && (o += h), g = new KME.world.WorldObject(b, c, j.x + b.map.tileWidth * e.anchorX, j.y + b.map.tileHeight * e.anchorY, i, o), g.sprite = g.add(p), g.objectTypeName = e.typeName, e.typeName !== KME.types.worldTypes.markerTypeName && (l < e.anchorX * b.map.tileWidth && (l = e.anchorX * b.map.tileWidth), k < -e.anchorX * b.map.tileWidth && (k = -e.anchorX * b.map.tileWidth), n < e.anchorY * b.map.tileHeight && (n = e.anchorY * b.map.tileHeight), m < -e.anchorY * b.map.tileHeight && (m = -e.anchorY * b.map.tileHeight)), j.setObjects.push(g);
                    var q = g.getBody(e.typeName, e.layout);
                    q && q.shape && g.bodyInit({shape: q.shape, frame: q.frame, anchorX: q.anchorX, anchorY: q.anchorY})
                }
            }
            j.createButtonsAndBody(f, k, l, n, m)
        }) : KME.utils.worldatlas.createSpriteByType(d.typeName, d.layout, KME.utils.worldatlas.getType(d.typeName).placeState, void 0, function (a) {
            if (a instanceof Array) {
                j.partsArray = KME.utils.worldatlas.getPartsArray(d.typeName, d.layout, KME.utils.worldatlas.getType(d.typeName).placeState);
                var c;
                for (c = 0, t = a.length; t > c; c++) {
                    var e = a[c], g = j.partsArray[c];
                    if (0 === c)j.sprite = j.add(e); else {
                        "undefined" == typeof j.partsObjects && (j.partsObjects = []);
                        var h = new KME.world.WorldObject(j.KMEGame, j.game, j.x + g.tileAnchorX * j.KMEGame.map.tileWidth, j.y + g.tileAnchorY * j.KMEGame.map.tileHeight, "part");
                        h.sprite = e, h.add(e), h.sprite.sortPatch ? h.sortPatch = h.sprite.sortPatch : h.sortPatch = 0, h.objectTypeName = j.objectTypeName, j.partsObjects.push(h), l < g.tileAnchorX * b.map.tileWidth && (l = g.tileAnchorX * b.map.tileWidth), k < -g.tileAnchorX * b.map.tileWidth && (k = -g.tileAnchorX * b.map.tileWidth), n < g.tileAnchorY * b.map.tileHeight && (n = g.tileAnchorY * b.map.tileHeight), m < -g.tileAnchorY * b.map.tileHeight && (m = -g.tileAnchorY * b.map.tileHeight)
                    }
                    g.animation && (e.animations.add(g.animation.name), e.animations.play(g.animation.name, g.animation.frameRate, !0))
                }
            } else j.sprite = j.add(a);
            j.sprite.sortPatch ? j.sortPatch = j.sprite.sortPatch : j.sortPatch = 0, f = j.getBody(d.typeName, d.layout, d.currentState), j.createButtonsAndBody(f, k, l, n, m)
        })
    }, KME.world.WorldPlacer.prototype = Object.create(KME.world.WorldObject.prototype), KME.world.WorldPlacer.prototype.constructor = KME.world.WorldPlacer, KME.world.WorldPlacer.prototype.createButtonsAndBody = function (a, b, c, d, e) {
        var f = -this.sprite.width * this.sprite.anchor.x - b, g = this.sprite.height * (1 - this.sprite.anchor.y) + d;
        this.buttonsGroup = new Phaser.Group(this.game, this.KMEGame.interfaceGroup), this.buttonsGroup.x = this.x, this.buttonsGroup.y = this.y, this.moveButton = this.buttonsGroup.add(new Phaser.Sprite(this.game, f, g, "uiBuildIcons", 3)), this.moveButton.anchor.x = 1, this.moveButton.anchor.y = 0, this.moveButton.inputEnabled = !0, this.moveButton.events.onInputDown.add(this.startDrag, this), this.moveButton.events.onInputUp.add(this.stopDrag, this), this.isRotating(this.objectType) && (f = -this.sprite.width * this.sprite.anchor.x - b, g = -this.sprite.height * this.sprite.anchor.y - e, this.rotateButton = this.buttonsGroup.add(new Phaser.Sprite(this.game, f, g, "uiBuildIcons", 1)), this.rotateButton.anchor.x = 1, this.rotateButton.anchor.y = 1, this.rotateButton.inputEnabled = !0, this.rotateButton.events.onInputDown.add(this.rotate, this)), f = this.sprite.width * (1 - this.sprite.anchor.x) + c, g = this.sprite.height * (1 - this.sprite.anchor.y) + d, this.placeButton = this.buttonsGroup.add(new Phaser.Sprite(this.game, f, g, "uiBuildIcons", 7)), this.placeButton.anchor.x = 0, this.placeButton.anchor.y = 0, this.placeButton.inputEnabled = !0, this.placeButton.events.onInputDown.add(this.place, this), this.objectType.canAbandoned && KME.mainPlayer.noFreeBuild() && (this.zoneWarning = this.buttonsGroup.add(new Phaser.Sprite(this.game, f + 50, g, "uiBuildIcons", 9)), this.zoneWarning.anchor.x = 0, this.zoneWarning.anchor.y = 0, this.zoneWarningText = this.buttonsGroup.add(new Phaser.Text(this.game, f + 75, g, $.t("interfaces:build.zoneWarning"), this.KMEGame.labelStyle)), this.zoneWarningText.setShadow(0, 0, "rgb(0,0,0)", 3, !0), this.zoneWarningText.anchor.x = .5, this.zoneWarningText.anchor.y = -1, this.zoneWarningText.visible = !1, this.zoneWarning.inputEnabled = !0, this.zoneWarning.events.onInputOver.add(this.showZoneWarningText, this), this.zoneWarning.events.onInputOut.add(this.hideZoneWarningText, this), this.zoneWarning.visible = !1), f = this.sprite.width * (1 - this.sprite.anchor.x) + c, g = -this.sprite.height * this.sprite.anchor.y - e, this.cancelButton = this.buttonsGroup.add(new Phaser.Sprite(this.game, f, g, "uiBuildIcons", 5)), this.cancelButton.anchor.x = 0, this.cancelButton.anchor.y = 1, this.cancelButton.inputEnabled = !0, this.cancelButton.events.onInputDown.add(this.cancel, this), this.isDrag = !1, a && a.shape && this.bodyInit({
            shape: a.shape,
            frame: a.frame,
            anchorX: a.anchorX,
            anchorY: a.anchorY
        }), this.initTileAlign(this.objectType.tileAlign)
    }, KME.world.WorldPlacer.prototype.getSectionArrayForClaim = function (a, b) {
        return [{typeName: a}, {
            typeName: KME.types.worldTypes.markerTypeName,
            layout: "up",
            anchorX: 0,
            anchorY: -b,
            spriteConfigData: {markerPlace: !0}
        }, {
            typeName: KME.types.worldTypes.markerTypeName,
            layout: "down",
            anchorX: 0,
            anchorY: b,
            spriteConfigData: {markerPlace: !0}
        }, {
            typeName: KME.types.worldTypes.markerTypeName,
            layout: "right",
            anchorX: -b,
            anchorY: 0,
            spriteConfigData: {markerPlace: !0}
        }, {
            typeName: KME.types.worldTypes.markerTypeName,
            layout: "left",
            anchorX: b,
            anchorY: 0,
            spriteConfigData: {markerPlace: !0}
        }]
    }, KME.world.WorldPlacer.prototype.zoneWarningCheck = function () {
        function a(a, e) {
            var f = d - Math.abs(e - c) + 1, g = b - f / 2 + 1 | 0;
            return c % 2 === 0 && e % 2 && g--, a >= g && g + f > a
        }

        var b, c, d;
        if (this.zoneWarning) {
            var e = KME.mainPlayer.content.claim;
            if (e && this.nCoords) {
                b = e.nX, c = e.nY, d = 2 * e.halfSize;
                var f;
                if (f = this.setObjects ? this.getType(this.setObjects[0].objectTypeName) : this.objectType, f.border) {
                    var g, h, i, j;
                    f.border === KME.types.worldTypes.borderTypes.pos ? (h = j = this.nCoords.nY - 1, g = this.nCoords.nX - h % 2, i = this.nCoords.nX + this.nCoords.nY % 2) : (h = j = this.nCoords.nY + 1, g = this.nCoords.nX + this.nCoords.nY % 2, i = this.nCoords.nX - h % 2), this.zoneWarning.visible = !(a(this.nCoords.nX, this.nCoords.nY) || a(g, h) || a(i, j))
                } else this.zoneWarning.visible = !a(this.nCoords.nX, this.nCoords.nY)
            } else this.zoneWarning.visible = !0
        }
    }, KME.world.WorldPlacer.prototype.showZoneWarningText = function () {
        this.zoneWarningText.visible = !0
    }, KME.world.WorldPlacer.prototype.hideZoneWarningText = function () {
        this.zoneWarningText.visible = !1
    }, KME.world.WorldPlacer.prototype.startDrag = function () {
        this.isDrag = !0, this.startDragPoint = {
            x: this.game.input.activePointer.x,
            y: this.game.input.activePointer.y
        }, this.storePlace = {x: this.x, y: this.y}
    }, KME.world.WorldPlacer.prototype.update = function () {
        this.buttonsGroup && (this.buttonsGroup.x !== this.x && (this.buttonsGroup.x = this.x), this.buttonsGroup.y !== this.y && (this.buttonsGroup.y = this.y), this.isDrag && (this.body ? (this.body.x = this.storePlace.x + this.game.input.activePointer.x - this.startDragPoint.x, this.body.y = this.storePlace.y + this.game.input.activePointer.y - this.startDragPoint.y) : (this.x = this.storePlace.x + this.game.input.activePointer.x - this.startDragPoint.x, this.y = this.storePlace.y + this.game.input.activePointer.y - this.startDragPoint.y), this.updateAdditionalObjects())), KME.world.WorldObject.prototype.update.apply(this, arguments)
    }, KME.world.WorldPlacer.prototype.initTileAlign = function (a) {
        this.tileAlign = a, a && (this.tileAlign.offsetX = (this.tileAlign.anchorX - .5) * this.KMEGame.map.tileWidth, this.tileAlign.offsetX >= this.KMEGame.map.tileWidth / 2 && (this.tileAlign.offsetX = this.KMEGame.map.tileWidth / 2 - 1), this.tileAlign.offsetX < -this.KMEGame.map.tileWidth / 2 && (this.tileAlign.offsetX = -this.KMEGame.map.tileWidth / 2), this.tileAlign.offsetY = (this.tileAlign.anchorY - .5) * this.KMEGame.map.tileHeight, this.tileAlign.offsetY >= this.KMEGame.map.tileHeight / 2 && (this.tileAlign.offsetY = this.KMEGame.map.tileHeight / 2 - 1), this.tileAlign.offsetY < -this.KMEGame.map.tileHeight / 2 && (this.tileAlign.offsetY = -this.KMEGame.map.tileHeight / 2)), this.setTileAlign()
    }, KME.world.WorldPlacer.prototype.updateAdditionalObjects = function () {
        var a, b, c, d, e;
        if (this.body ? (d = this.body.x, e = this.body.y) : (d = this.x, e = this.y), this.setObjects)for (a = 0, b = this.setObjects.length; b > a; a++) {
            c = this.setObjects[a];
            var f = this.sectionArray[a + 1];
            c.body ? (c.body.x = d + this.KMEGame.map.tileWidth * f.anchorX, c.body.y = e + this.KMEGame.map.tileHeight * f.anchorY) : (c.x = d + this.KMEGame.map.tileWidth * f.anchorX, c.y = e + this.KMEGame.map.tileHeight * f.anchorY), c.isMovedNeedCheck = !0
        }
        if (this.partsObjects)for (a = 0, b = this.partsObjects.length; b > a; a++) {
            c = this.partsObjects[a];
            var g = this.partsArray[a + 1];
            c.x = d + g.tileAnchorX * this.KMEGame.map.tileWidth, c.y = e + g.tileAnchorY * this.KMEGame.map.tileHeight, c.isMovedNeedCheck = !0
        }
    }, KME.world.WorldPlacer.prototype.setTileAlign = function () {
        if (this.tileAlign) {
            var a, b;
            this.body ? (a = this.KMEGame.map.getNormalFromWorld(this.body.x - this.tileAlign.offsetX, this.body.y - this.tileAlign.offsetY), b = this.KMEGame.map.getWorldTileCenterByNormal(a), this.body.x = b.x + this.tileAlign.offsetX, this.body.y = b.y + this.tileAlign.offsetY) : (a = this.KMEGame.map.getNormalFromWorld(this.x - this.tileAlign.offsetX, this.y - this.tileAlign.offsetY), b = this.KMEGame.map.getWorldTileCenterByNormal(a), this.x = b.x + this.tileAlign.offsetX, this.y = b.y + this.tileAlign.offsetY), this.nCoords = a, this.updateAdditionalObjects()
        } else this.body ? this.nCoords = this.KMEGame.map.getNormalFromWorld(this.body.x, this.body.y) : this.nCoords = this.KMEGame.map.getNormalFromWorld(this.x, this.y);
        this.zoneWarningCheck(), this.body ? (this.itemOrObject.x = this.body.x, this.itemOrObject.y = this.body.y) : (this.itemOrObject.x = this.x, this.itemOrObject.y = this.y), this.isMovedNeedCheck = !0
    }, KME.world.WorldPlacer.prototype.stopDrag = function () {
        this.isDrag && (this.body ? (this.body.x = this.storePlace.x + this.game.input.activePointer.x - this.startDragPoint.x, this.body.y = this.storePlace.y + this.game.input.activePointer.y - this.startDragPoint.y) : (this.x = this.storePlace.x + this.game.input.activePointer.x - this.startDragPoint.x, this.y = this.storePlace.y + this.game.input.activePointer.y - this.startDragPoint.y), this.setTileAlign()), this.isDrag = !1
    }, KME.world.WorldPlacer.prototype.place = function () {
        this.KMEGame._placerClick = !0, KME.mainPlayer.body.isNearObject(this) ? this.callbackOnPlace.call(KME.mainPlayer) : KME.mainPlayer.body.setTargetObject(this, this.callbackOnPlace, KME.mainPlayer)
    }, KME.world.WorldPlacer.prototype.canPlaceHere = function () {
        var a, b = !1;
        if (b = "undefined" == typeof this.body ? KME.world.map.collisionLayer.busyTileForObjectPlace(this) : KME.world.map.collisionLayer.objectCollisionCheck(this, !0), !b && this.setObjects)for (var c = 0, d = this.setObjects.length; d > c && (a = this.setObjects[c], a.objectTypeName === KME.types.worldTypes.markerTypeName || ("undefined" == typeof a.body ? b = KME.world.map.collisionLayer.busyTileForObjectPlace(a) : (a.body.setCollideExcludeObject(KME.mainPlayer), b = KME.world.map.collisionLayer.objectCollisionCheck(a, !0)), !b)); c++);
        return !b
    }, KME.world.WorldPlacer.prototype.cancel = function () {
        this.KMEGame._placerClick = !0, this.destroy()
    }, KME.world.WorldPlacer.prototype.rotate = function () {
        this.KMEGame._placerClick = !0, this.objectRotate(this.itemOrObject);
        var a;
        a = new KME.world.WorldPlacer(this.KMEGame, this.game, this.itemOrObject)
    }, KME.world.WorldPlacer.prototype.destroy = function () {
        delete this.KMEGame.placer, this.buttonsGroup.destroy();
        var a, b;
        if ("undefined" != typeof this.setObjects) {
            for (a = 0, b = this.setObjects.length; b > a; a++)this.setObjects[a].destroy();
            delete this.setObjects
        }
        KME.world.WorldObject.prototype.destroy.call(this)
    }
}),define("KME/data/entity/MainPlayer", ["i18next", "KME/data/entity/Player", "KME/data/world/TimerIndicator", "KME/data/world/ClaimDirection",
    //RIM
    "KME/data/world/RareDirection",
    //RIM
    "KME/data/world/CorpseDirection", "KME/data/world/WorldEffect", "KME/data/world/WorldPlacer", "KME/utils/ItemSpriteAtlas", "KME/controllers/interface/InterfaceController"], function () {
    var a = 50, b = 150, c = {hit: 450, bowShot: 1e3}, d = {
        farms: {
            FlaxStack: 1,
            PloughedGround: 1,
            PloughedGround3x3: 1,
            GrassedGround: 1,
            GrassedGround3x3: 1
        }
    };
    KME.MainPlayer = function (a, b, c) {
        return KME.Player.call(this, a, b, c), this.timerIndicator = new KME.world.TimerIndicator(this, -105), this.claimDirection = new KME.world.ClaimDirection(this),
            //RIM
            this.rareDirection = new KME.world.RareDirection(this),
            this.rareDirection.render(),
            //RIM
            this.corpseDirection = new KME.world.CorpseDirection(this), this.timerIndicator.setEndTimerHandler(this.endTimer, this), this.endTimerHandler = null, this.playerHands = {typeName: "Hands"}, this.content = new KME.PlayerContent(c, this), this.claimDirection.render(), this.corpseDirection.render(), this.useActionName = null, this.dead = c.dead, this.viewZoneCheck = !0, KME.controllers.ui.update(this.content), this.completlyUpdateTimerId = !1, this
    }, KME.MainPlayer.prototype = Object.create(KME.Player.prototype), KME.MainPlayer.prototype.constructor = KME.MainPlayer, KME.MainPlayer.prototype.checkAndStoreTarget = function (a, b) {
        return b && b !== KME.types.worldTypes.actions.Gather ? !0 : this.storedTarget && this.storedTarget === a ? !1 : (this.storedTarget && this.removeStoredTarget(), this.storedTarget = a, !0)
    }, KME.MainPlayer.prototype.endTimer = function () {
        this.endTimerHandler && this.endTimerHandler.call(this), this.removeStoredTarget()
    }, KME.MainPlayer.prototype.isAdmin = function () {
        return "undefined" != typeof KME.mainPlayer.content.effects.admin
    }, KME.MainPlayer.prototype.noFreeBuild = function () {
        return "undefined" == typeof KME.mainPlayer.content.effects.danger
    }, KME.MainPlayer.prototype.cantRun = function () {
        return "undefined" != typeof KME.mainPlayer.content.effects.tired || "undefined" != typeof KME.mainPlayer.content.effects.exhaustion
    }, KME.MainPlayer.prototype.isMount = function () {
        return "undefined" != typeof KME.mainPlayer.content.effects.mount
    }, KME.MainPlayer.prototype.isSafe = function () {
        return "undefined" != typeof KME.mainPlayer.content.effects.safe
    }, KME.MainPlayer.prototype.removeStoredTarget = function () {
        this.storedTarget = null, this.endTimerHandler = null
    }, KME.MainPlayer.prototype.kill = function () {
        this.visible = !1, this.KMEGame.map.removeCollisionObject(this)
    }, KME.MainPlayer.prototype.revive = function (a) {
        this.body.newAngle = a.angle, this.x = this.body.x = a.x, this.y = this.body.y = a.y, this.normalPoint = this.KMEGame.map.getNormalFromWorld(this.x, this.y), KME.interfaces.deathScreen.deathScreen("hideScreen"), KME.world.map.objectGroups.getOrCreateTileGroup(this.floorIndex, this.normalPoint).add(this), this.visible = !0, this.dead = !1, this.content = new KME.PlayerContent(a, this), KME.controllers.ui.update(this.content), this.speedRecalculate(a.bonuses), this.updateCake(a.wearTypes, a.effects, a.bonuses), this.KMEGame.map.addCollisionObject(this), this.claimDirection.render(), this.corpseDirection.render(), this.interfaceElementsUpdate(), window.setTimeout(function () {
            KME.world.map.objectGroups.cameraFloorRefresh(), KME.world.view.zoneOn()
        }, 100)
    }, KME.MainPlayer.prototype.preUpdate = function () {
        this.game.cursors.left.isDown ? this.moveLeft() : this.game.cursors.right.isDown && this.moveRight(), this.game.cursors.up.isDown ? this.moveUp() : this.game.cursors.down.isDown && this.moveDown(), KME.Player.prototype.preUpdate.apply(this, arguments)
    };
    var e, f = 1;
    KME.MainPlayer.prototype.craftItem = function (a, b) {
        if (f = b, e = a, KME.socket) {
            var c = this;
            KME.socket.emit("itemCraft", a, function (a, b) {
                a ? c.showMessage(a) : (KME.controllers.sound.craftEvent(), c.timerIndicator.start(b))
            })
        }
    }, KME.MainPlayer.prototype.build = function (a, b, c) {
        if (KME.socket) {
            var d = this;
            KME.socket.emit(KME.commands.clientCommands.buildCheck, a, function (e) {
                if (e)c(!1), d.showMessage(e); else {
                    c(!0);
                    var f = new KME.world.WorldPlacer(d.KMEGame, d.game, a);
                    f.isShowContainerAfter = b
                }
            })
        }
    }, KME.MainPlayer.prototype.craftOrBuildCompleted = function (a) {
        a.message && this.KMEGame.showMessage(a.message), "craft" === a.type && (a.success && f > 1 && e ? (--f, this.craftItem(e, f)) : f = 0)
    }, KME.MainPlayer.prototype.nearBuildPlace = function () {
        var a = this.KMEGame.placer;
        if (a) {
            if (!a.canPlaceHere())return void this.showMessage(KME.types.messageTypes.buildPlaceBlocked);
            if (KME.socket) {
                var b = this;
                "undefined" != typeof a.itemOrObject.id ? KME.socket.emit(KME.commands.clientCommands.placeItemToWorld, {
                    id: a.itemOrObject.id,
                    x: a.x,
                    y: a.y
                }, function (c) {
                    c && (b.KMEGame.updatePlayer(c), a.destroy())
                }) : KME.socket.emit(KME.commands.clientCommands.buildWorldObject, a.itemOrObject, function (c, e) {
                    c ? b.showMessage(c) : (d.farms[a.itemOrObject.typeName] ? KME.controllers.sound.farmEvent() : KME.controllers.sound.buildEvent(), b.timerIndicator.start(e), a.isShowContainerAfter && KME.interfaces.build.build("toggle"), a.destroy())
                })
            }
        }
    }, KME.MainPlayer.prototype.nearMovePlace = function () {
        var a = this.KMEGame.placer;
        if (a) {
            if (!a.canPlaceHere())return void this.showMessage(KME.types.messageTypes.buildPlaceBlocked);
            if (KME.socket) {
                var b = this;
                KME.socket.emit(KME.commands.clientCommands.moveWorldObject, {
                    id: a.itemOrObject.id,
                    x: a.x,
                    y: a.y
                }, function (c) {
                    c ? b.showMessage(c) : a.destroy()
                })
            }
        }
    }, KME.MainPlayer.prototype.getRightHand = function () {
        return this.content.wear.slots.rightHand ? this.content.wear.slots.rightHand : this.playerHands
    }, KME.MainPlayer.prototype.stopMoveCollide = function () {
        KME.controllers.network.actions.playerStop(this.x, this.y, this.body.newAngle)
    }, KME.MainPlayer.prototype.stopMove = function (a) {
        (this.body.moved() || a) && (this.body.fullStop(), KME.controllers.network.actions.playerStop(this.x, this.y, this.body.newAngle))
    }, KME.MainPlayer.prototype.hitToXY = function (a, b) {
        this.calcAngleAndFace(a, b), this.startHit()
    }, KME.MainPlayer.prototype.startHit = function () {
        if (this.stopMove(!0), this.isMount())return this.showMessage(KME.types.messageTypes.cantDoMounted), void this.removeStoredTarget();
        var a = this.getRightHand();
        if (!a)return this.showMessage(KME.types.messageTypes.attackNoItemInHand), void this.removeStoredTarget();
        if ("undefined" != typeof this.hitEndTime && this.hitEndTime > Date.now())return void this.removeStoredTarget();
        var b = KME.types.itemTypes[a.typeName].attack;
        if ("undefined" == typeof b)return this.showMessage(KME.types.messageTypes.attackItemNotWeapon), void this.removeStoredTarget();
        if (this.hitStartTime)this.hitStartTime < Date.now() && (this.hitStartTime = 0, this.doHit(a, b)); else {
            this.hitStartTime = Date.now() + b.delayBefore;
            var c = b.play ? b.play : KME.graphic.entityAnimation.animationNames.hit, d = b.projectile ? void 0 : KME.types.soundNames.swing;
            this.doPlayerAction(c, this.getPlayCoefficient(c, b.delayBefore), d)
        }
    }, KME.MainPlayer.prototype.getPlayCoefficient = function (a, b) {
        var d = c[a];
        return d || (console.error("Unknown getPlayCoefficient animationName", a), d = 500), b || (console.error("getPlayCoefficient no weaponDelay", b), b = 500), d / b
    }, KME.MainPlayer.prototype.doHit = function (a, b) {
        this.removeStoredTarget();
        var c = this, d = null;
        if (b.projectile) {
            var e;
            KME.socket && KME.socket.emit(KME.commands.clientCommands.playerShoot, {
                typeName: a.typeName,
                x: this.x,
                y: this.y,
                angle: this.body.newAngle
            }, function (a, b) {
                a ? (d = a, c.showMessage(a)) : b && (e = new KME.world.WorldProjectile(c.KMEGame, c.game, c, {
                    senderTypeName: b.projectile.weaponType,
                    senderAmmoType: b.projectile.ammoType,
                    q: b.projectile.q
                }), c.content.stamina = b.player.food.stamina, c.content.update(b.player), KME.controllers.ui.updateTopBar(c.content), KME.controllers.ui.updateToolbar(c.content), c.completlyUpdateTimerId && clearTimeout(c.completlyUpdateTimerId), c.completlyUpdateTimerId = setTimeout(function () {
                    KME.controllers.ui.updateOnWear(c.content)
                }, 3e3))
            })
        } else {
            for (var f = this.getHitObjects(b), g = [], h = 0; h < f.length; h++) {
                var i = f[h];
                if (i != this) {
                    i.startHitEffect();
                    var j = {id: i.id, typeName: a.typeName, fromId: this.id};
                    if (i instanceof KME.Player && (j.playerName = i.baseName), i instanceof KME.Character ? (KME.controllers.sound.huntEvent(), j.clientX = i.x, j.clientY = i.y, j.clientAngle = i.body.newAngle) : i instanceof KME.world.WorldInteractiveObject && (j.roomId = i.roomId), g.push(j), !b.splash)break
                }
            }
            KME.socket && (0 === g.length && (g = null), KME.socket.emit(KME.commands.clientCommands.playerHit, {
                typeName: a.typeName,
                harmWorldObjects: g
            }, function (a, b) {
                if (a)d = a, c.showMessage(a); else if (b)if (b.player)c.content.update(b.player), KME.controllers.ui.update(c.content); else if (c.content.stamina = b.stamina, c.content.effects = b.effects, KME.controllers.ui.updateBonusesAndEffects(c.content), KME.controllers.ui.updateTopBar(c.content), b.updatedItem) {
                    var e = c.content.getItemById(b.updatedItem.id);
                    e && (e.update(b.updatedItem), KME.controllers.ui.updateOnItemDurability(c.content))
                }
            }))
        }
        !d && b.delay > 0 && (this.hitEndTime = Date.now() + b.delay)
    }, KME.MainPlayer.prototype.getPointForAnimalFree = function () {
        var b = Math.cos(this.body.newAngle), c = Math.sin(this.body.newAngle), d = this.x + b * a | 0, e = this.y + c * a / 2 | 0;
        return {x: d, y: e}
    }, KME.MainPlayer.prototype.doPlayerAction = function (a, b, c) {
        this.play(a, !1, b), c && KME.controllers.sound.playOnce(c, !0), KME.socket && KME.socket.emit(KME.commands.clientCommands.playerAction, {
            play: a,
            playCoefficient: b,
            sound: c
        })
    }, KME.MainPlayer.prototype.inRangeClick = function (a) {
        "undefined" == typeof a && (a = this.body.targetObject), a instanceof KME.world.WorldInteractiveObject ? a.onClickObject(this.useActionName) : this.checkAndStoreTarget(a) && (a.tryToUse(this.useActionName) ? this.removeStoredTarget() : this.hitToXY(a.x, a.y))
    }, KME.MainPlayer.prototype.tryToNearUse = function (a, b) {
        return this.body.isNearObject(a) ? !0 : (this.useActionName = b, this.setTarget(a, 0, this.KMEGame.playerRun), !1)
    }, KME.MainPlayer.prototype.finalCheckToUseCharacter = function () {
        var a = this;
        this.catchTarget && this.catchTarget instanceof KME.Character ? KME.socket.emit(KME.commands.clientCommands.worldObjectUse, {
            id: this.catchTarget.id,
            roomId: this.KMEGame.map.getRoomIdByNormalCoords(this.catchTarget.normalPoint),
            actionName: KME.types.worldTypes.actions.Catch,
            success: {x: this.catchTarget.x, y: this.catchTarget.y}
        }, function (b) {
            b && a.showMessage(b)
        }) : this.showMessage(KME.types.messageTypes.actionTooFarAway)
    }, KME.MainPlayer.prototype.getRangeToCharacter = function () {
        var a = 0, b = this.getRightHand();
        if (!b)return a;
        var c = KME.types.itemTypes[b.typeName];
        return c.range ? c.range : c.attack && c.attack.range ? c.attack.range : a
    }, KME.MainPlayer.prototype.moveUp = function () {
        this.moveTo(this.x, this.y - 50)
    }, KME.MainPlayer.prototype.moveDown = function () {
        this.moveTo(this.x, this.y + 50)
    }, KME.MainPlayer.prototype.moveLeft = function () {
        this.moveTo(this.x - 50, this.y)
    }, KME.MainPlayer.prototype.moveRight = function () {
        this.moveTo(this.x + 50, this.y)
    }, KME.MainPlayer.prototype.moveTo = function (a, b, c) {
        this.dead || (c && this.cantRun() && (c = !1), this.timerIndicator.hide(), this.removeStoredTarget(), KME.Character.prototype.moveTo.call(this, a, b, c), KME.controllers.network.actions.playerMoveTo({
            x: a,
            y: b,
            fromX: this.x,
            fromY: this.y,
            isRun: c
        }))
    }, KME.MainPlayer.prototype.setTarget = function (a, b, c) {
        this.dead || (c && this.cantRun() && (c = !1), this.timerIndicator.hide(), this.removeStoredTarget(), KME.Character.prototype.setTarget.call(this, a, b, c), KME.controllers.network.actions.playerSetTarget({
            targetId: a.id,
            x: a.x,
            y: a.y,
            fromX: this.x,
            fromY: this.y,
            range: b,
            isRun: c
        }))
    }, KME.MainPlayer.prototype.checkForCharacterClick = function (a) {
        if (!this.dead && a) {
            var b = a.sprite;
            if (b) {
                var c = b.parent;
                if (c && c instanceof KME.Character) {
                    if (!c.isMob && this.isSafe())return !1;
                    var d = 0;
                    return (!c.isMob || c.isMob && c.isMobWild()) && (d = this.getRangeToCharacter()), this.body.isInRangeObject(c, d) ? this.inRangeClick(c) : this.setTarget(c, d, this.KMEGame.playerRun), !0
                }
            }
        }
        return !1
    }, KME.MainPlayer.prototype.pointerChange = function (a) {
        this.dead || (this.KMEGame._placerClick || this.KMEGame.placer && this.KMEGame.placer.isDrag ? (this.KMEGame._placerClick = !1, this.KMEGame._clickDown = null) : (!this.KMEGame._clickDown || this.KMEGame._clickDown + b < Date.now()) && (this.KMEGame._clickDown = Date.now(), this.KMEGame.playerStay ? this.hitToXY(a.worldX, a.worldY) : a.targetObject ? this.checkForCharacterClick(a.targetObject) : this.moveTo(a.worldX, a.worldY, this.KMEGame.playerRun)))
    }, KME.MainPlayer.prototype.move = function () {
        KME.Player.prototype.move.apply(this, arguments)
    }, KME.MainPlayer.prototype.stop = function () {
        KME.Player.prototype.stop.apply(this, arguments), KME.controllers.network.actions.playerStop(this.x, this.y, this.body.newAngle)
    }, KME.MainPlayer.prototype.update = function () {
        KME.Player.prototype.update.call(this), this.timerIndicator.render()
    }, KME.MainPlayer.prototype.postUpdate = function () {
        this.body && this.body.moved() && KME.world.view.updateOnMoveOrRoomLoad(), KME.Player.prototype.postUpdate.call(this), this.timerIndicator.render()
    }, KME.MainPlayer.prototype.onTileChanged = function (a) {
        this.KMEGame.opacityZone.tileX = a.nX, this.KMEGame.opacityZone.tileY = a.nY;
        var b = KME.world.phasermap.getRoomIdByNormalCoords(a);
        this.roomId || (this.roomId = b);
        var c = {x: this.x, y: this.y, angle: this.body.newAngle, mb: this.body.moveBlock};
        b !== this.roomId && (console.log("Change roomId", this.roomId, b), this.roomId = b), KME.world.WorldObject.prototype.onTileChanged.apply(this, arguments), KME.controllers.network.actions.playerPositionUpdate(c), KME.controllers.ui.closeFarAwayContainers(this.body), this.claimDirection.render(), this.corpseDirection.render(),
            //RIM
            this.rareDirection.render()
            //RIM
    }, KME.MainPlayer.prototype.nextAnimationDebug = function () {
        if (this.isAdmin()) {
            var a = Object.keys(KME.utils.modelAtlas.types[this.renderType].aniIndexes);
            "undefined" == typeof this.aniDebugIndex ? this.aniDebugIndex = 1 : (this.aniDebugIndex++, this.aniDebugIndex >= a.length && (this.aniDebugIndex = 0)), this.play(a[this.aniDebugIndex], !0)
        }
    }, KME.MainPlayer.prototype.nextRenderTypeDebug = function () {
        if (this.isAdmin()) {
            var a = Object.keys(KME.utils.modelAtlas.types);
            "undefined" == typeof this.renderTypeDebugIndex ? this.renderTypeDebugIndex = "female" === this.renderType ? 0 : 1 : (this.renderTypeDebugIndex++, this.renderTypeDebugIndex >= a.length && (this.renderTypeDebugIndex = 0)), this.renderType = a[this.renderTypeDebugIndex], KME.world.render.removeSlot(0), KME.world.render.newSlot(this.renderType, 0), this.updateCake({}, this.content.effects, this.content.bonuses)
        }
    }, KME.MainPlayer.prototype.updatePlayerHealth = function (a) {
        this.content.health = a.health, KME.controllers.ui.updateTopBar(this.content)
    }, KME.MainPlayer.prototype.updatePlayerStamina = function (a) {
        this.content.stamina = a.stamina, this.content.food = a.food, KME.controllers.ui.updateTopBar(this.content)
    }
}),define("KME/data/entity/NetworkPlayer", ["KME/data/entity/Player"], function () {
    KME.NetworkPlayer = function (a, b, c) {
        return KME.Player.call(this, a, b, c), this
    }, KME.NetworkPlayer.prototype = Object.create(KME.Player.prototype), KME.NetworkPlayer.prototype.constructor = KME.NetworkPlayer
}),function (a) {
    define("bootstrap-confirmation", ["bootstrap", "jquery"], function () {
        return function () {
            !function (a) {
                "use strict";
                function b(a) {
                    for (var b = window, c = a.split("."), d = c.pop(), e = 0, f = c.length; f > e; e++)b = b[c[e]];
                    return function () {
                        b[d].call(this)
                    }
                }

                if (!a.fn.popover)throw new Error("Confirmation requires popover.js");
                var c = function (b, c) {
                    this.init("confirmation", b, c);
                    var d = this;
                    this.options.selector || (this.$element.attr("href") && (this.options.href = this.$element.attr("href"), this.$element.removeAttr("href"), this.$element.attr("target") && (this.options.target = this.$element.attr("target"))), this.$element.on(d.options.trigger, function (a, b) {
                        b || (a.preventDefault(), a.stopPropagation(), a.stopImmediatePropagation())
                    }), this.$element.on("confirmed.bs.confirmation", function () {
                        a(this).trigger(d.options.trigger, [!0])
                    }), this.$element.on("show.bs.confirmation", function () {
                        d.options.singleton && a(d.options._selector).not(a(this)).filter(function () {
                            return void 0 !== a(this).data("bs.confirmation")
                        }).confirmation("hide")
                    })), this.options._isDelegate || (this.eventBody = !1, this.uid = this.$element[0].id || this.getUID("group_"), this.$element.on("shown.bs.confirmation", function () {
                        d.options.popout && !d.eventBody && (a(this), d.eventBody = a("body").on("click.bs.confirmation." + d.uid, function (b) {
                            a(d.options._selector).is(b.target) || (a(d.options._selector).filter(function () {
                                return void 0 !== a(this).data("bs.confirmation")
                            }).confirmation("hide"), a("body").off("click.bs." + d.uid), d.eventBody = !1)
                        }))
                    }))
                };
                c.DEFAULTS = a.extend({}, a.fn.popover.Constructor.DEFAULTS, {
                    placement: "top",
                    title: "Are you sure?",
                    html: !0,
                    href: !1,
                    popout: !1,
                    singleton: !1,
                    target: "_self",
                    onConfirm: a.noop,
                    onCancel: a.noop,
                    btnOkClass: "btn-xs btn-primary",
                    btnOkIcon: "glyphicon glyphicon-ok",
                    btnOkLabel: "Yes",
                    btnCancelClass: "btn-xs btn-default",
                    btnCancelIcon: "glyphicon glyphicon-remove",
                    btnCancelLabel: "No",
                    template: '<div class="popover confirmation"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content text-center"><div class="btn-group"><a class="btn" data-apply="confirmation"></a><a class="btn" data-dismiss="confirmation"></a></div></div></div>'
                }), c.prototype = a.extend({}, a.fn.popover.Constructor.prototype), c.prototype.constructor = c, c.prototype.getDefaults = function () {
                    return c.DEFAULTS
                }, c.prototype.init = function (b, c, d) {
                    a.fn.popover.Constructor.prototype.init.call(this, b, c, d), this.options._isDelegate = !1, d.selector ? this.options._selector = this._options._selector = d._root_selector + " " + d.selector : d._selector ? (this.options._selector = d._selector, this.options._isDelegate = !0) : this.options._selector = d._root_selector
                }, c.prototype.setContent = function () {
                    var b = this, c = this.tip(), d = this.options;
                    c.find(".popover-title")[d.html ? "html" : "text"](this.getTitle()), c.find('[data-apply="confirmation"]').addClass(d.btnOkClass).html(d.btnOkLabel).prepend(a("<i></i>").addClass(d.btnOkIcon), " ").off("click").one("click", function () {
                        b.getOnConfirm.call(b).call(b.$element), b.$element.trigger("confirmed.bs.confirmation"), b.leave(b)
                    }), d.href && c.find('[data-apply="confirmation"]').attr({
                        href: d.href,
                        target: d.target
                    }), c.find('[data-dismiss="confirmation"]').addClass(d.btnCancelClass).html(d.btnCancelLabel).prepend(a("<i></i>").addClass(d.btnCancelIcon), " ").off("click").one("click", function () {
                        b.getOnCancel.call(b).call(b.$element), b.$element.trigger("canceled.bs.confirmation"), b.leave(b)
                    }), c.removeClass("fade top bottom left right in"), c.find(".popover-title").html() || c.find(".popover-title").hide()
                }, c.prototype.getOnConfirm = function () {
                    return this.$element.attr("data-on-confirm") ? b(this.$element.attr("data-on-confirm")) : this.options.onConfirm
                }, c.prototype.getOnCancel = function () {
                    return this.$element.attr("data-on-cancel") ? b(this.$element.attr("data-on-cancel")) : this.options.onCancel
                };
                var d = a.fn.confirmation;
                a.fn.confirmation = function (b) {
                    var d = "object" == typeof b && b || {};
                    return d._root_selector = this.selector, this.each(function () {
                        var e = a(this), f = e.data("bs.confirmation");
                        (f || "destroy" != b) && (f || e.data("bs.confirmation", f = new c(this, d)), "string" == typeof b && f[b]())
                    })
                }, a.fn.confirmation.Constructor = c, a.fn.confirmation.noConflict = function () {
                    return a.fn.confirmation = d, this
                }
            }(jQuery)
        }.apply(a, arguments)
    })
}(this),define("KME/interfaces/Confirmation", ["jquery", "bootstrap", "bootstrap-confirmation", "i18next"], function (a) {
    KME.Confirmation = {
        showMessage: function (a, b) {
            this.show({
                title: a, onConfirm: function () {
                    b()
                }
            })
        }, show: function (b) {
            b = a.extend({
                container: "body",
                trigger: "manual",
                placement: "top",
                singleton: "true",
                btnOkLabel: a.t("interfaces:confirmations.btnYes"),
                btnCancelLabel: a.t("interfaces:confirmations.btnNo"),
                btnCancelClass: "btn-wt",
                btnOkClass: "btn-wt"
            }, b), KME.interfaces.toolbar.confirmation(b), KME.interfaces.toolbar.confirmation("show"), KME.interfaces.toolbar.on("hidden.bs.confirmation", function () {
                KME.interfaces.toolbar.confirmation("destroy")
            })
        }
    }
}),define("KME/utils/ActionController", [], function () {
    KME.utils.ActionController = {
        getToolAction: function (a) {
            var b = this.getActionList(a);
            return b && b.length > 1 ? b[0] : !1
        }, getActionList: function (a) {
            var b, c = KME.types.worldTypes[a.objectTypeName].actionConfig, d = [];
            if (c) {
                var e = [];
                if (Object.keys(c).forEach(function (f) {
                        b = c[f], b.actionName || (b.actionName = f), b.onState && a.currentStateName !== b.onState || (b.action === KME.types.worldTypes.actions.Gather ? d.push(b) : e.push(b))
                    }), d.length > 0)if (1 === d.length)e.push(d[0]); else {
                    var f, g;
                    for (f = 0, g = d.length; g > f; f++)if (b = d[f], KME.mainPlayer.content.bonuses[b.gatherTool])return e.push(b), e;
                    for (f = 0, g = d.length; g > f; f++)e.push(d[f])
                }
                return e.length > 0 ? e : null
            }
            return KME.types.itemTypes[a.objectTypeName] ? [{
                action: KME.types.worldTypes.actions.PickUp,
                actionName: KME.types.worldTypes.actions.PickUp,
                title: "PickUp"
            }] : null
        }
    }
}),define("KME/data/items/ContainerContent", [], function () {
    KME.ContainerContent = function (a, b) {
        this.container = {
            items: a.container.items ? a.container.items : [],
            slots: []
        }, this.worldObject = b, this.id = a.id, a.container.items && a.container.items.length > 0 && this._proxyItems(a.container.items, this.container.slots)
    }, KME.ContainerContent.prototype._proxyItems = function (a, b, c) {
        Object.keys(b).forEach(function (a) {
            b[a] && (b[a].markedToDelete = !0)
        }), Object.keys(a).forEach(function (d) {
            if (a[d]) {
                var e = new KME.Item(a[d]);
                b[e.position] = e, c && c(e)
            }
        }), Object.keys(b).forEach(function (a) {
            b[a] && b[a].markedToDelete && (b[a] = null)
        })
    }, KME.ContainerContent.prototype.update = function (a) {
        this.container.items = a.container.items ? a.container.items : [], this._proxyItems(a.container.items, this.container.slots)
    }
}),define("KME/data/items/ToolContent", [], function () {
    KME.ToolContent = function (a, b) {
        this.container = {
            items: a.container.items ? a.container.items : [],
            slots: []
        }, this.worldObject = b, this.id = a.id, a.container.items && a.container.items.length > 0 && this._proxyItems(a.container.items, this.container.slots)
    }, KME.ToolContent.prototype._proxyItems = function (a, b, c) {
        Object.keys(b).forEach(function (a) {
            b[a] && (b[a].markedToDelete = !0)
        }), Object.keys(a).forEach(function (d) {
            if (a[d]) {
                var e = new KME.Item(a[d]);
                b[e.position] = e, c && c(e)
            }
        }), Object.keys(b).forEach(function (a) {
            b[a] && b[a].markedToDelete && (b[a] = null)
        })
    }, KME.ToolContent.prototype.update = function (a) {
        this.container.items = a.container.items ? a.container.items : [], this._proxyItems(a.container.items, this.container.slots)
    }
}),define("KME/data/world/WorldInteractiveObject", ["KME/interfaces/Confirmation", "./WorldObject", "KME/utils/ActionController", "KME/data/items/ContainerContent", "KME/data/items/ToolContent"], function () {
    function a(a) {
        var b = a.angle - 1.875 * Math.PI;
        b = 0 > b ? 2 * Math.PI + b : b;
        var d = b / (2 * Math.PI);
        return c[Math.floor(8 * d)]
    }

    function b(a) {
        var b = this;
        KME.mainPlayer.checkAndStoreTarget(this, a.action) && KME.socket.emit(KME.commands.clientCommands.worldObjectUse, {
            id: this.id,
            actionName: a.actionName,
            roomId: this.roomId
        }, function (c, d) {
            if (c)b.KMEGame.showMessage(c), KME.mainPlayer.removeStoredTarget(); else switch (a.action) {
                case KME.types.worldTypes.actions.Sleep:
                    b.KMEGame.showMessage(d);
                    break;
                case KME.types.worldTypes.actions.Upgrade:
                    d && b.game && KME.mainPlayer.timerIndicator.start(d);
                    break;
                case KME.types.worldTypes.actions.OpenContainer:
                    b.KMEGame._clickDown = null, b.showContainer(d);
                    break;
                case KME.types.worldTypes.actions.Gather:
                    b.game && KME.mainPlayer.timerIndicator.start(d);
                    break;
                case KME.types.worldTypes.actions.NextState:
                    d && b.game && KME.mainPlayer.timerIndicator.start(d);
                    break;
                case KME.types.worldTypes.actions.Shoot:
                    d && b.game && KME.mainPlayer.timerIndicator.start(d);
                    break;
                case KME.types.worldTypes.actions.Seed:
                    KME.controllers.sound.farmEvent();
                    break;
                case KME.types.worldTypes.actions.PickUp:
                    b.KMEGame.updatePlayer(d);
                    break;
                case"ClaimManage":
                    KME.interfaces.claimWindow.claimWindow("rebuild");
                    break;
                default:
                    console.log("Not known use! - " + a.action), d.id && KME.mainPlayer.id === d.id && KME.gameState.updatePlayer(d, KME.commands.serverCommands.partialUpdatePlayerTypes.wear)
            }
        })
    }

    var c = ["right", "rightdown", "down", "downleft", "left", "leftup", "up", "upright"];
    KME.world.WorldInteractiveObject = function (a, b, c) {
        var d = c.x, e = c.y;
        this.objectTypeName = c.typeName, c.id && (this.id = c.id, this.ownerId = c.ownerId), this.objectType = KME.types.worldTypes[this.objectTypeName], this.objectType.hitPoints && c.health ? this.spriteConfigUpdate(c) : c.typeName === KME.types.worldTypes.markerTypeName && c.ownerId !== a.mainPlayerID && (this.spriteConfigData = {markerEnemy: !0}), this.currentStateName = c.currentState, this.currentLayout = c.layout;
        var f = c.floorIndex;
        "undefined" == typeof f && (f = 1), "undefined" != typeof this.objectType.changeFloorIndex && (f += this.objectType.changeFloorIndex), this.subName = this.getSubName(), KME.world.WorldObject.call(this, a, b, d, e, this.getFullName(c.name, c.amount), f), this.roomId = a.map.getRoomIdByNormalCoords(this.normalPoint), this.initOrReInit(c)
    }, KME.world.WorldInteractiveObject.prototype = Object.create(KME.world.WorldObject.prototype), KME.world.WorldInteractiveObject.prototype.constructor = KME.world.WorldInteractiveObject, KME.world.WorldInteractiveObject.prototype.skillColorUpdate = function () {
        if (this.gatherType && this.subLabel) {
            var a = KME.types.skillTypes.xpLevels, b = this.gatherType.level, c = KME.playerSkills.skills[this.gatherType.skill].level;
            if (b > c + a.failMaxDelta)this.subLabel.fill = "#FF0000"; else if (b === c)this.subLabel.fill = "#FFFF00"; else if (c > b + a.successMaxDelta)this.subLabel.fill = "#c0c0c0"; else if (b > c) {
                var d = 127 + Math.floor(127 / a.failMaxDelta * (a.failMaxDelta - (b - c)));
                this.subLabel.fill = "rgb(255," + d + ",0)"
            } else if (c > b) {
                var e = Math.floor(255 / a.successMaxDelta * (a.successMaxDelta - (c - b)));
                this.subLabel.fill = "rgb(" + e + ",255,0)"
            }
            var f, g = KME.mainPlayer.content.bonuses[this.gatherType.toolName];
            g && (g /= 1e4, f = b > c + a.failMaxDelta ? 0 : c >= b ? 1 : 1 - (1 - a.failMinChance) / a.failMaxDelta * (b - c), 1 > f && (f *= g), f > 1 && (f = 1));
            var h = "undefined" != typeof f ? " (" + Math.floor(100 * f) + "%)" : "";
            this.subLabel.text = $.t("skills:" + this.gatherType.skill + ".name") + " " + this.gatherType.level + h
        }
    }, KME.world.WorldInteractiveObject.prototype.getSubName = function () {
        var a = KME.types.gatherTypes[this.objectTypeName];
        if (a) {
            var b = Object.keys(a), c = a[b[0]];
            return c && c.skill ? (this.gatherType = c, this.gatherType.toolName = b[0], $.t("skills:" + c.skill + ".name") + " " + c.level) : null
        }
        return null
    }, KME.world.WorldInteractiveObject.prototype.getFullName = function (a, b) {
        var c = b;
        "undefined" === c && (c = 1);
        var d = a;
        return d ? d = $.t(d) : (d = this.getName(this.objectTypeName), c > 1 && (d += " x " + c)), d
    }, KME.world.WorldInteractiveObject.prototype.getAngleByLayout = function () {
        return KME.world.faceAngles[this.currentLayout]
    }, KME.world.WorldInteractiveObject.prototype.initOrReInit = function (b) {
        var c, d;
        if ("undefined" != typeof this.partsObjects) {
            for (c = 0, d = this.partsObjects.length; d > c; c++)this.partsObjects[c].destroy();
            delete this.partsObjects
        }
        var e = this.getBody(this.objectTypeName, b.layout, b.currentState);
        e && this.bodyInit(e);
        var f = this;
        if (b.corpseType) {
            var g = b.corpseType + "Corpse";
            b.layout && (g = b.layout + g), KME.utils.worldatlas.createSpriteByType(g, a(b), null, null, function (a) {
                f.destroySprite(), f.sprite = f.add(a), f.maskAndLabelInit(KME.utils.worldatlas.getType(g), !0)
            })
        } else {
            var h = KME.types.worldTypes[this.objectTypeName].noOpacity;
            KME.utils.worldatlas.createSpriteByType(b.typeName, b.layout, b.currentState, this.spriteConfigData, function (a) {
                if (a instanceof Array) {
                    f.partsArray = KME.utils.worldatlas.getPartsArray(b.typeName, b.layout, b.currentState);
                    var c;
                    for (c = 0, d = a.length; d > c; c++) {
                        var g = a[c], i = f.partsArray[c];
                        if (0 === c)f.destroySprite(), f.addAt(g, 0), f.sprite = g; else {
                            "undefined" == typeof f.partsObjects && (f.partsObjects = []);
                            var j = new KME.world.WorldObject(f.KMEGame, f.game, f.x + i.tileAnchorX * f.KMEGame.map.tileWidth, f.y + i.tileAnchorY * f.KMEGame.map.tileHeight, "part");
                            j.sprite = g, j.add(g), j.sprite.sortPatch ? j.sortPatch = j.sprite.sortPatch : j.sortPatch = 0, j.objectTypeName = f.objectTypeName, h || (j.canOpacity = j.sprite.height * j.sprite.anchor.y > f.KMEGame.opacityZone.heightPixelLimit), e && e.moveBlock && (j.partMoveBlock = !0), f.partsObjects.push(j)
                        }
                        i.animation && (g.animations.add(i.animation.name), g.animations.play(i.animation.name, i.animation.frameRate, !0))
                    }
                } else f.destroySprite(), f.addAt(a, 0), f.sprite = a;
                h || (f.canOpacity = f.sprite.height * f.sprite.anchor.y > f.KMEGame.opacityZone.heightPixelLimit), f.sprite.sortPatch ? f.sortPatch = f.sprite.sortPatch : f.sortPatch = 0, f.maskAndLabelCheck(), f.interfaceShowCheck()
            })
        }
    }, KME.world.WorldInteractiveObject.prototype.maskAndLabelCheck = function () {
        var a = "undefined" == typeof this.objectType.simpleObject;
        !a && (this.KMEGame.demolishMode || this.KMEGame.repairMode) && this.isBuilt() && (a = this.floorIndex <= KME.world.map.objectGroups.floorIndexLimit), this.maskSprite && this.maskSprite.destroy(), this.label && this.label.destroy(), a && this.maskAndLabelInit(KME.utils.worldatlas.getType(this.objectTypeName))
    }, KME.world.WorldInteractiveObject.prototype.checkForNearEffect = function () {
        KME.mainPlayer && !KME.mainPlayer.dead && Math.abs(KME.mainPlayer.x - this.x) < 200 && Math.abs(KME.mainPlayer.y - this.y) && KME.socket.emit(KME.commands.clientCommands.playerNearUpdate, null)
    }, KME.world.WorldInteractiveObject.prototype.checkForNearBonus = function () {
        (this.objectType.bonuses || this.objectType.productionEffect || this.objectType.productionBonuses) && KME.mainPlayer && !KME.mainPlayer.dead && Math.abs(KME.mainPlayer.x - this.x) < 200 && Math.abs(KME.mainPlayer.y - this.y) && KME.socket.emit(KME.commands.clientCommands.playerNearUpdate, null)
    }, KME.world.WorldInteractiveObject.prototype.updateObject = function (a) {
        if (this.objectTypeName !== a.typeName) {
            this.objectTypeName = a.typeName, this.objectType = KME.types.worldTypes[this.objectTypeName], this.subName = this.getSubName(), this.currentStateName = a.currentState, this.currentLayout = a.layout;
            var b = a.floorIndex;
            "undefined" == typeof b && (b = 1), "undefined" != typeof this.objectType.changeFloorIndex && (b += this.objectType.changeFloorIndex), b !== this.floorIndex && (KME.world.map.objectGroups.getOrCreateTileGroup(b, this.normalPoint).add(this), this.floorIndex = b), this.initOrReInit(a)
        }
        KME.world.states.manager.checkForChange(this, a), (this.objectType.productionEffect || this.objectType.productionBonuses) && this.checkForNearEffect(), this.name = this.getFullName(a.name, a.amount), this.label && (this.label.text = this.name)
    }, KME.world.WorldInteractiveObject.prototype.onClick = function () {
        KME.world.WorldObject.prototype.onClick.apply(this, arguments), this.onClickObject()
    }, KME.world.WorldInteractiveObject.prototype.onClickObject = function (a) {
        this.KMEGame.playerStay || (this.KMEGame.repairMode ? this.repair() : this.KMEGame.demolishMode ? this.demolish() : this.onUse(a))
    }, KME.world.WorldInteractiveObject.prototype.repair = function () {
        this.id && (KME.types.buildTypes.buildTypes[this.objectTypeName] ? KME.mainPlayer.tryToNearUse(this, void 0) && KME.socket && KME.socket.emit(KME.commands.clientCommands.repairWorldObject, this.id, function (a, b) {
            a ? KME.mainPlayer.showMessage(a) : KME.mainPlayer.timerIndicator.start(b)
        }) : KME.mainPlayer.showMessage(KME.types.messageTypes.repairNoStructure))
    }, KME.world.WorldInteractiveObject.prototype.demolish = function () {
        var a = this;
        this.id && (KME.types.buildTypes.buildTypes[this.objectTypeName] ? KME.mainPlayer.tryToNearUse(this, void 0) && KME.Confirmation.showMessage($.t("interfaces:confirmations.demolish") + " " + $.t("objects:world." + this.objectTypeName) + "?", function () {
            KME.socket.emit(KME.commands.clientCommands.demolishWorldObject, a.id, function (a) {
                a ? KME.mainPlayer.showMessage(a) : KME.mainPlayer.showMessage(KME.types.messageTypes.demolishSuccess)
            })
        }) : KME.mainPlayer.showMessage(KME.types.messageTypes.demolishNoStructure))
    }, KME.world.WorldInteractiveObject.prototype.showMenu = function (a) {
        KME.controllers.ui.world.showMenu(this, a)
    }, KME.world.WorldInteractiveObject.prototype.onUse = function (a) {
        if (KME.socket && "undefined" != typeof this.id)if (this.objectType.ownerUseCheck && KME.mainPlayer.id !== this.ownerId)this.KMEGame.showMessage(KME.types.messageTypes.useNotOwner); else {
            var c = KME.utils.ActionController.getActionList(this);
            if (c) {
                var d = c[0];
                if (c.length > 1) {
                    if ("undefined" == typeof a)return void this.showMenu(c);
                    for (var e = 0; e < c.length && (d = c[e], d.actionName !== a); e++);
                }
                if (d && (a = d.actionName), d.action === KME.types.worldTypes.actions.ClaimMove) {
                    var f;
                    f = new KME.world.WorldPlacer(this.KMEGame, this.game, {
                        id: this.id,
                        typeName: this.objectTypeName,
                        currentState: this.currentState,
                        layout: this.currentLayout
                    }, KME.mainPlayer.nearMovePlace)
                } else if (KME.mainPlayer.tryToNearUse(this, a)) {
                    if (KME.mainPlayer.isMount())return void this.KMEGame.showMessage(KME.types.messageTypes.cantDoMounted);
                    if (KME.world.map.collisionLayer.isLineSight(KME.mainPlayer, this)) {
                        var g = this;
                        d.warning ? KME.Confirmation.showMessage($.t("interfaces:confirmations." + d.warning), function () {
                            KME.mainPlayer.tryToNearUse(g, a) ? b.apply(g, [d]) : g.KMEGame.showMessage(KME.types.messageTypes.actionTooFarAway)
                        }) : b.apply(this, [d])
                    }
                }
            }
        }
    }, KME.world.WorldInteractiveObject.prototype.showContainer = function (a) {
        var b, c = KME.types.worldTypes[this.objectTypeName].tool ? "tool" : "container";
        if ($("#" + c + "_" + a.id).length > 0)b = $("#" + c + "_" + a.id), "container" === c ? b.container("open") : b.tool("open"); else switch (b = $('<div id="' + c + "_" + a.id + '"></div>'), c) {
            case"container":
                var d = new KME.ContainerContent(a, this);
                b.container({
                    content: d,
                    appendTo: "#" + c + "s",
                    title: a.name ? a.name : this.name,
                    alreadyTranslated: a.name ? !1 : !0,
                    size: KME.types.worldTypes[this.objectTypeName].container.slots
                });
                break;
            case"tool":
                var e = new KME.ToolContent(a, this);
                b.container({
                    content: e,
                    appendTo: "#" + c + "s",
                    title: a.name ? a.name : this.name,
                    alreadyTranslated: a.name ? !1 : !0,
                    size: KME.types.worldTypes[this.objectTypeName].container.slots
                })
        }
        KME.interfaces.inventory.inventory("open")
    }, KME.world.WorldInteractiveObject.prototype.onOver = function () {
        this.waitOnOverCounter || (this.skillColorUpdate(), KME.world.WorldObject.prototype.onOver.call(this), this.KMEGame.repairMode ? KME.controllers.ui.cursor.setRepair() : this.KMEGame.demolishMode ? KME.controllers.ui.cursor.setDemolish() : KME.types.itemTypes[this.objectTypeName] ? KME.controllers.ui.cursor.setLoot() : KME.utils.ActionController.getActionList(this) && KME.controllers.ui.cursor.setTool())
    }, KME.world.WorldInteractiveObject.prototype.onOut = function () {
        KME.world.WorldObject.prototype.onOut.call(this), KME.controllers.ui.cursor.setNormal()
    }, KME.world.WorldInteractiveObject.prototype.preUpdate = function () {
        if (this.KMEGame.map.newRoomAdded && this.partsObjects) {
            var a = this;
            if (a.exists && a.partsObjects)for (var b = 0, c = a.partsObjects.length; c > b; b++)if (!a.partsObjects[b].exists) {
                a.initOrReInit({typeName: a.objectTypeName, currentState: a.currentStateName, layout: a.currentLayout});
                break
            }
        }
        KME.world.WorldObject.prototype.preUpdate.apply(this, arguments)
    }, KME.world.WorldInteractiveObject.prototype.destroy = function () {
        this.id && this.KMEGame.objects[this.id] && delete this.KMEGame.objects[this.id], KME.world.WorldObject.prototype.destroy.apply(this, arguments);
        var a = KME.types.worldTypes[this.objectTypeName];
        if (a.tool || a.container) {
            var b = a.tool ? "tool" : "container";
            KME.controllers.ui.closeDestroyedContainer(this.id, b)
        }
    }
}),define("KME/data/world/WorldProjectile", ["KME/data/world/WorldObject"], function () {
    KME.world.WorldProjectile = function (a, b, c, d) {
        var e = d.senderTypeName, f = d.senderAmmoType, g = d.shootStructure;
        this.q = d.q, this.senderTypeName = e, this.senderAmmoType = f, this.senderId = c.id;
        var h, i, j, k, l, m;
        g ? (this.weaponAttack = KME.types.worldTypes[e].attack, i = g.body.x, j = g.body.y, k = g.getAngleByLayout()) : (c instanceof KME.Player ? this.weaponAttack = KME.types.itemTypes[e].attack : this.weaponAttack = KME.types.worldTypes[e].attack, k = c.body.newAngle, i = c.body.x, j = c.body.y), h = this.weaponAttack.projectile;
        var n = h.atlas ? h.atlas : e + "Rrojectile";
        if (l = Math.cos(k), m = Math.sin(k), i += l * this.weaponAttack.startRange, j += m * (this.weaponAttack.startRange / 2), KME.world.WorldObject.call(this, a, b, i, j, n, c.floorIndex), h.atlas) {
            var o = KME.utils.worldatlas.getType(h.atlas).rotate, p = this;
            "undefined" != typeof o && o === !0 ? KME.utils.worldatlas.createWorldAngleSprite(h.atlas, void 0, k, function (a) {
                p.sprite = p.add(a)
            }) : KME.utils.worldatlas.createSpriteByType(h.atlas, void 0, void 0, void 0, function (a) {
                p.sprite = p.add(a)
            })
        }
        var q = {shape: h.shape, moveBlock: h.aniBlock ? !0 : !1, viewBlock: !1, doAction: !0};
        h.rotate && (q.angle = k), this.body = new Phaser.BodyIsometric(this.game, this, q), g ? this.body.setCollideExcludeObject(g) : this.body.setCollideExcludeObject(c), this.speed = h.speed, this.checkCollide = !0, g ? this.body.setMovePointer(i + l * this.weaponAttack.range, j + m * this.weaponAttack.range) : this.body.setMovePointer(i + l * (this.weaponAttack.range + 100), j + m * (this.weaponAttack.range + 100)), this.body.setStopMoveHandler(this.destroy, this)
    }, KME.world.WorldProjectile.prototype = Object.create(KME.world.WorldObject.prototype), KME.world.WorldProjectile.prototype.constructor = KME.world.WorldProjectile, KME.world.WorldProjectile.prototype.mustSendHarm = function () {
        return this.senderId === KME.mainPlayer.id
    }, KME.world.WorldProjectile.prototype.canBeHitExplosion = function (a) {
        return !(a instanceof KME.world.WorldProjectile)
    }, KME.world.WorldProjectile.prototype.canBeDirectHit = function (a) {
        return !(a instanceof KME.world.WorldProjectile)
    }, KME.world.WorldProjectile.prototype.doAction = function (a) {
        KME.world.WorldObject.prototype.doAction.apply(this, arguments);
        var b, c = [];
        if (this.weaponAttack.explosion) {
            var d, e = KME.utils.worldatlas.effects[this.weaponAttack.explosion.worldEffect];
            if (d = new KME.world.WorldEffect(this.KMEGame, this.game, e, this.x, this.y), e.sound && KME.controllers.sound.playOnce(e.sound, !0), this.weaponAttack.explosion.shape) {
                for (var f = this.getHitByExplosion(this.weaponAttack.explosion), g = 0; g < f.length; g++) {
                    var h = f[g];
                    this.canBeHitExplosion(h) && (h.startHitEffect(), this.mustSendHarm() && (b = {
                        id: h.id,
                        typeName: this.senderTypeName,
                        ammoType: this.senderAmmoType,
                        fromId: KME.mainPlayer.id
                    }, h instanceof KME.Player && (b.playerName = h.baseName), h instanceof KME.Character ? (KME.controllers.sound.huntEvent(), b.clientX = h.x, b.clientY = h.y, b.clientAngle = h.body.newAngle) : h instanceof KME.world.WorldInteractiveObject && (b.roomId = h.roomId), c.push(b)))
                }
                c.length > 0 && (KME.socket.emit(KME.commands.clientCommands.harmWorldObjects, c), console.log("harmWorldObjects " + c))
            }
        } else a && (a.startHitEffect(), this.mustSendHarm() && (b = {
            id: a.id,
            typeName: this.senderTypeName,
            ammoType: this.senderAmmoType,
            q: this.q,
            fromId: KME.mainPlayer.id
        }, a instanceof KME.Player && (b.playerName = a.baseName), a instanceof KME.Character ? (KME.controllers.sound.huntEvent(), b.clientX = a.x, b.clientY = a.y, b.clientAngle = a.body.newAngle) : a instanceof KME.world.WorldInteractiveObject && (b.roomId = a.roomId), c.push(b), KME.socket.emit(KME.commands.clientCommands.harmWorldObjects, c), console.log("harmWorldObjects " + c)))
    }
}),define("KME/controllers/data/world/ViewZone", ["async", "jquery"], function (a, b) {
    var c = {width: 1e3, height: 600}, d = {now: 100, step: 10, max: 130, min: 60};
    KME.world.view = {
        data: {
            playerRenderComplete: !1,
            screenX: 0,
            screenWidth: 0,
            screenY: 0,
            screenHeight: 0,
            leftX: 0,
            upY: 0,
            rightX: 0,
            downY: 0
        }, blackBack: function (a) {
            if (a) {
                var c = b("#game");
                c.css("background-color", "black"), c.append('<div id="view-zone"></div>'), this.zone = document.getElementById("view-zone")
            } else b("#game").css("background-color", ""), b("#view-zone").remove(), delete this.zone
        }, init: function (a) {
            this.KMEGame = a, window.nwin && (this.nwGuiWindow = window.nwin), this.jBody = b("body"), this.KMEGame.game.scale.scaleMode = Phaser.ScaleManager.USER_SCALE, this.KMEGame.game.scale.setResizeCallback(this.gameResize, this), this.blackBack(!0), this.zoneOff(), this.gameResize()
        }, zoomPlus: function () {
            this.nwGuiWindow && d.now < d.max && (d.now += d.step, this.nwGuiWindow.zoomLevel = Math.log(d.now / 100) / Math.log(1.2))
        }, zoomMinus: function () {
            this.nwGuiWindow && d.now > d.min && (d.now -= d.step, this.nwGuiWindow.zoomLevel = Math.log(d.now / 100) / Math.log(1.2))
        }, gameResize: function () {
            var a = this.jBody.width(), b = this.jBody.height(), d = 2 * c.width, e = 2 * c.height, f = a / 2 - c.width | 0;
            0 > f && (d += f, f = 0), d > a && (d = a);
            var g = b / 2 - c.height | 0;
            0 > g && (e += g, g = 0), e > b && (e = b), this.KMEGame.game.canvas.style.left = f + "px", this.KMEGame.game.canvas.style.top = g + "px", this.KMEGame.game.scale.updateDimensions(d, e, !0), KME.world.map.resize(d, e), this.setZoneGameBounds(f, g, d, e)
        }, setZoneGameBounds: function (a, b, c, d) {
            this.data.screenX = a, this.data.screenWidth = c, this.data.screenY = b, this.data.screenHeight = d, console.log("setZoneGameBounds", a, b, c, d, this.data.leftX, this.data.upY, this.data.rightX, this.data.downY), this.zone.style.left = a + "px", this.zone.style.top = b + "px", this.zone.style.width = c + "px", this.zone.style.height = d + "px", this.updateOnMoveOrRoomLoad()
        }, setZoneBorders: function (a, b, c, d) {
            a ? this.zone.style["border-left-width"] = a + "px" : this.zone.style["border-left-width"] = 0, b ? this.zone.style["border-right-width"] = b + "px" : this.zone.style["border-right-width"] = 0, c ? this.zone.style["border-top-width"] = c + "px" : this.zone.style["border-top-width"] = 0, d ? this.zone.style["border-bottom-width"] = d + "px" : this.zone.style["border-bottom-width"] = 0
        }, updateOnMoveOrRoomLoad: function () {
            var a, b, c, d, e, f, g, h;
            this.data.playerRenderComplete ? (e = KME.mainPlayer.x - this.data.screenWidth / 2 | 0, e < this.data.leftX && (a = this.data.leftX - e | 0), f = KME.mainPlayer.x + this.data.screenWidth / 2 | 0, f > this.data.rightX && (b = f - this.data.rightX | 0), g = KME.mainPlayer.y - this.data.screenHeight / 2 | 0, g < this.data.upY && (c = this.data.upY - g | 0), h = KME.mainPlayer.y + this.data.screenHeight / 2 | 0, h > this.data.downY && (d = h - this.data.downY | 0)) : (a = b = this.KMEGame.game.width / 2 - 20 | 0, c = d = this.KMEGame.game.height / 2 - 20 | 0), this.setZoneBorders(a, b, c, d)
        }, getRoomsBorders: function () {
            function a(a) {
                (!b || a.worldCoords.leftX < b) && (b = a.worldCoords.leftX), (!c || a.worldCoords.rightX > c) && (c = a.worldCoords.rightX), (!d || a.worldCoords.upY < d) && (d = a.worldCoords.upY), (!e || a.worldCoords.downY > e) && (e = a.worldCoords.downY)
            }

            var b, c, d, e;
            if (this.data.playerRenderComplete) {
                var f, g, h, i, j, k = this.KMEGame.map.getRoomIdByNormalCoords(KME.mainPlayer.normalPoint), l = this.KMEGame.map.rooms[k];
                if (l && l.created) {
                    for (a(l), g = h = l.roomY, k = l.roomX + (l.roomY - 1) * this.KMEGame.map.roomsAmountWidth, f = this.KMEGame.map.rooms[k], f && f.created && (a(f), g = l.roomY - 1), k = l.roomX + (l.roomY + 1) * this.KMEGame.map.roomsAmountWidth, f = this.KMEGame.map.rooms[k], f && f.created && (a(f), h = l.roomY + 1), j = 0, i = g; h >= i; i++)k = l.roomX - 1 + i * this.KMEGame.map.roomsAmountWidth, f = this.KMEGame.map.rooms[k], f && f.created && j++;
                    for (h - g === j - 1 && a(f), j = 0, i = g; h >= i; i++)k = l.roomX + 1 + i * this.KMEGame.map.roomsAmountWidth, f = this.KMEGame.map.rooms[k], f && f.created && j++;
                    h - g === j - 1 && a(f), this.data.leftX = b + this.KMEGame.map.tileHalfWidth, this.data.rightX = c, this.data.upY = d + this.KMEGame.map.tileHalfHeight, this.data.downY = e, this.updateOnMoveOrRoomLoad()
                } else this.zoneOff()
            }
        }, getRoomsBordersOld: function () {
            if (this.data.playerRenderComplete) {
                var b, c, d, e, f = this;
                a.each(Object.keys(KME.world.phasermap.rooms), function (a, f) {
                    var g = KME.world.phasermap.rooms[a];
                    g.created && ((!b || g.worldCoords.leftX < b) && (b = g.worldCoords.leftX), (!c || g.worldCoords.rightX > c) && (c = g.worldCoords.rightX), (!d || g.worldCoords.upY < d) && (d = g.worldCoords.upY), (!e || g.worldCoords.downY > e) && (e = g.worldCoords.downY)), f()
                }, function () {
                    f.data.leftX = b + f.KMEGame.map.tileHalfWidth, f.data.rightX = c, f.data.upY = d + f.KMEGame.map.tileHalfHeight, f.data.downY = e, f.updateOnMoveOrRoomLoad()
                })
            }
        }, isCollide: function (a) {
            if (this.data.playerRenderComplete) {
                var b = a.x + a.anchor.x * -a.width, c = a.y + a.anchor.y * -a.height;
                return b < this.data.leftX ? !0 : c < this.data.upY ? !0 : b + a.width > this.data.rightX ? !0 : c + a.height > this.data.downY
            }
            return !0
        }, zoneOn: function () {
            this.data.playerRenderComplete = !0, this.getRoomsBorders()
        }, zoneOff: function () {
            this.data.playerRenderComplete = !1, this.updateOnMoveOrRoomLoad()
        }
    }
}),define("KME/data/ObjectGroups", ["phaser"], function () {
    KME.world.ObjectGroups = function () {
        Phaser.Group.call(this, arguments), this.opacityZone = KME.gameState.opacityZone, this.phaserMap = KME.world.phasermap, this.topMinus = 2 * this.phaserMap.tileHalfHeight, this.bottomPlus = 9 * this.phaserMap.tileHalfHeight, this.leftMinus = 3 * this.phaserMap.tileWidth, this.rightPlus = 3 * this.phaserMap.tileWidth, this.floorIndexLimit = 7, this.floorGroupsArray = []
    }, KME.world.ObjectGroups.prototype = Object.create(Phaser.Group.prototype), KME.world.ObjectGroups.prototype.constructor = KME.world.ObjectGroups, KME.world.ObjectGroups.prototype.getOrCreateTileGroup = function (a, b) {
        for (var c; a >= this.floorGroupsArray.length;)c = new Phaser.Group(this.game, this), c.yGroups = {}, c.visible = this.isFloorOnScreen(a), this.floorGroupsArray.push(c);
        c = this.floorGroupsArray[a];
        var d = c.yGroups[b.nY];
        d || (d = new Phaser.Group(this.game, c), d.nY = b.nY, d.visible = this.isLineOnScreen(b.nY), d.xGroups = {}, c.sort("nY", Phaser.Group.SORT_ASCENDING), c.yGroups[b.nY] = d);
        var e = d.xGroups[b.nX];
        return e || (e = new Phaser.Group(this.game, d), d.sort("nX", Phaser.Group.SORT_ASCENDING), e.visible = this.isTileOnScreen(b.nX), d.xGroups[b.nX] = e), e
    }, KME.world.ObjectGroups.prototype.bushesRemove = function (a) {
        for (var b, c, d, e = a.nX, f = a.nY, g = 0, h = this.floorGroupsArray.length; h > g; g++)b = this.floorGroupsArray[g], c = b.yGroups[f], c && (d = c.xGroups[e], d && d.forEach(function (a) {
            (a.tileIndex || KME.world.map.staticTypeNames[a.objectTypeName]) && a.destroy()
        }, this))
    }, KME.world.ObjectGroups.prototype.isFloorOnScreen = function (a) {
        return a <= this.floorIndexLimit
    }, KME.world.ObjectGroups.prototype.isNCoordsOnScreen = function (a) {
        return a.nY * this.phaserMap.tileHalfHeight > KME.game.camera.y - this.topMinus && a.nY * this.phaserMap.tileHalfHeight < KME.game.camera.y + KME.game.camera.height + this.bottomPlus && a.nX * this.phaserMap.tileWidth > KME.game.camera.x - this.leftMinus && a.nX * this.phaserMap.tileWidth < KME.game.camera.x + KME.game.camera.width + this.rightPlus
    }, KME.world.ObjectGroups.prototype.isLineOnScreen = function (a) {
        return a * this.phaserMap.tileHalfHeight > KME.game.camera.y - this.topMinus && a * this.phaserMap.tileHalfHeight < KME.game.camera.y + KME.game.camera.height + this.bottomPlus
    }, KME.world.ObjectGroups.prototype.isTileOnScreen = function (a) {
        return a * this.phaserMap.tileWidth > KME.game.camera.x - this.leftMinus && a * this.phaserMap.tileWidth < KME.game.camera.x + KME.game.camera.width + this.rightPlus
    }, KME.world.ObjectGroups.prototype.isNXMustBeRemoved = function (a) {
        return a < this.phaserMap.currentRoomsNXLeft || a > this.phaserMap.currentRoomsNXLeft + this.phaserMap.roomsFullWidth
    }, KME.world.ObjectGroups.prototype.isNYMustBeRemoved = function (a) {
        return a < this.phaserMap.currentRoomsNYUp || a > this.phaserMap.currentRoomsNYUp + this.phaserMap.roomsFullHeight
    }, KME.world.ObjectGroups.prototype.cameraTileRefreshByXGroups = function (a) {
        var b = this;
        Object.keys(a).forEach(function (c) {
            if (b.isNXMustBeRemoved(c))a[c].destroy(), delete a[c]; else {
                var d = b.isTileOnScreen(c);
                a[c].visible = d, d && b.opacityProcess(a[c])
            }
        })
    }, KME.world.ObjectGroups.prototype.cameraTileRefresh = function () {
        for (var a = this, b = 0, c = this.floorGroupsArray.length; c > b; b++) {
            var d = this.floorGroupsArray[b];
            d.visible && Object.keys(d.yGroups).forEach(function (b) {
                d.yGroups[b].visible && a.cameraTileRefreshByXGroups(d.yGroups[b].xGroups)
            })
        }
    }, KME.world.ObjectGroups.prototype.cameraLineRefresh = function (a) {
        for (var b = this, c = 0, d = this.floorGroupsArray.length; d > c; c++) {
            var e = this.floorGroupsArray[c];
            e.visible && Object.keys(e.yGroups).forEach(function (c) {
                if (b.isNYMustBeRemoved(c))e.yGroups[c].destroy(), delete e.yGroups[c]; else {
                    var d = b.isLineOnScreen(c);
                    e.yGroups[c].visible = d, a && d && b.cameraTileRefreshByXGroups(e.yGroups[c].xGroups)
                }
            })
        }
    }, KME.world.ObjectGroups.prototype.cameraLineRefreshByYGroups = function (a, b) {
        var c = this;
        Object.keys(a).forEach(function (d) {
            if (c.isNYMustBeRemoved(d))a[d].destroy(), delete a[d]; else {
                var e = c.isLineOnScreen(d);
                a[d].visible = e, b && e && c.cameraTileRefreshByXGroups(a[d].xGroups)
            }
        })
    }, KME.world.ObjectGroups.prototype.cameraFloorRefresh = function () {
        for (var a = this, b = 0, c = this.floorGroupsArray.length; c > b; b++) {
            var d = a.isFloorOnScreen(b);
            this.floorGroupsArray[b].visible = d, d && this.cameraLineRefreshByYGroups(this.floorGroupsArray[b].yGroups, !0)
        }
    }, KME.world.ObjectGroups.prototype.cameraFullRefresh = function () {
        this.cameraFloorRefresh()
    }, KME.world.ObjectGroups.prototype.changeTile = function (a, b) {
        var c, d = this.floorGroupsArray[a.floorIndex], e = d.yGroups[a.normalPoint.nY];
        e && (c = e.xGroups[a.normalPoint.nX], c && c.removeChild(a)), c = this.getOrCreateTileGroup(a.floorIndex, b), c.add(a), c.customSort(this.sortWithPatchHandler, this), a === KME.mainPlayer && (a.normalPoint.nY === b.nY ? this.cameraTileRefresh() : this.cameraLineRefresh(!0))
    }, KME.world.ObjectGroups.prototype.needSort = function (a, b) {
        var c, d = this.floorGroupsArray[a.floorIndex], e = d.yGroups[b.nY];
        e && (c = e.xGroups[b.nX], c && (c.customSort(this.sortWithPatchHandler, this), a === KME.mainPlayer && c.children.length > 1 && this.opacityProcess(c)))
    }, KME.world.ObjectGroups.prototype.opacityProcess = function (a) {
        a.iterate("canOpacity", !0, Phaser.Group.RETURN_NONE, function (a) {
            this.opacityZone.fullOpacityOn ? a.alpha = this.opacityZone.level : a.normalPoint.nX === this.opacityZone.tileX && a.normalPoint.nY === this.opacityZone.tileY ? a.y < KME.mainPlayer.y ? a.alpha = 1 : a.alpha = this.opacityZone.level : a.normalPoint.nX >= this.opacityZone.tileX && a.normalPoint.nX <= this.opacityZone.tileX + this.opacityZone.tileDistance && a.normalPoint.nY >= this.opacityZone.tileY && a.normalPoint.nY <= this.opacityZone.tileY + this.opacityZone.tileDistance ? a.alpha = this.opacityZone.level : a.alpha = 1
        }, this)
    }, KME.world.ObjectGroups.prototype.sortWithPatchHandler = function (a, b) {
        var c = a.y, d = b.y;
        return a.sortPatch && (c += a.sortPatch), b.sortPatch && (d += b.sortPatch), d > c ? -1 : 1
    }
}),define("KME/controllers/data/world/MapManager", ["async", "phaser", "KME/phext/phext", "KME/data/ObjectGroups"], function (a) {
    var b = 16;
    KME.world.map = {
        staticTypeNames: {fieldGrassTile: 1}, _init: function (a) {
            this.KMEGame = a, this.phaserMap = a.map = KME.world.phasermap
        }, resize: function (a, b) {
            this.phaserMap.setBounds(), this.backgroundLayer && this.backgroundLayer.resize(a, b)
        }, initOnline: function (a, b) {
            this._init(a), KME.playerSkills = b.skills;
            var c = b.player, d = b.clusterData, e = b.achievements, f = this;
            a.mainPlayerID = c.id, f.phaserMap.roomsUpdate(d, function () {
                f.initLayers(), f.initNewWorldObjects(function () {
                    a.createPlayer(c, e)
                })
            })
        }, initNewWorldObjects: function (c, d) {
            if (this.phaserMap.newRoomsArray.length) {
                var e = this, f = 0;
                a.eachSeries(this.phaserMap.newRoomsArray, function (c, g) {
                    c ? a.each(c.cakes, function (g, h) {
                        c.cleared ? h(1) : (e.KMEGame.addGameWorldObject(g), f++, d && f > b ? (f = 0, a.setImmediate(h)) : h())
                    }, function () {
                        c.cleared || (c.created = !0), g()
                    }) : g()
                }, function () {
                    KME.world.view.getRoomsBorders(), e.phaserMap.newRoomsArray = [], c && c()
                })
            } else c && c()
        }, initLayers: function () {
            this.phaserMap.newRoomAdded = !1;
            var a = this.phaserMap.getLayerIndex("background");
            this.backgroundLayer = this.KMEGame.game.world.add(new Phaser.TilemapBackgroundLayer(this.KMEGame.game, this.phaserMap, a, this.KMEGame.game.width, this.KMEGame.game.height)), this.backgroundLayer.init(this.KMEGame.gridDebug, this.KMEGame.tileMaskDebug), this.backgroundLayer.prepare(), a = this.phaserMap.getLayerIndex("collision"), this.collisionLayer = new Phaser.TilemapCollisionLayer(this.KMEGame.game, this.phaserMap, a, this.KMEGame.game.width, this.KMEGame.game.height), this.collisionLayer.init(this.KMEGame.collisionDebug), this.objectGroups = this.KMEGame.game.world.add(new KME.world.ObjectGroups), this.objectGroups.name = "objects", this.interfaceGroup = new Phaser.Group(this.KMEGame.game), this.interfaceGroup.name = "interface"
        }, setGridDebug: function (a) {
            this.backgroundLayer.gridDebug = a, this.updateBackground()
        }, setTileMaskDebug: function (a) {
            this.backgroundLayer.tileMaskDebug = a, this.updateBackground()
        }, updateWorldTiles: function (b) {
            var c = this;
            a.each(b, function (a, b) {
                c.phaserMap.updateTile(a), c.objectGroups.bushesRemove(a), b()
            }, function () {
                c.updateBackground()
            })
        }, updateBackground: function () {
            this.backgroundLayer.prepare(), this.backgroundLayer.layer.dirty = !0
        }
    }
}),define("KME/controllers/data/world/RenderManagerDebug", ["three", "async", "sea3d"], function (a, b) {
    function c(b, c) {
        var d = new a.SkinnedMesh(b.geometry, b.material, !1);
        return d.scale.set(b.scale.x, b.scale.y, b.scale.z), d.castShadow = !0, c && d.position.set(0, b.position.y, 0), d
    }

    var d = 40, e = 8, f = 256, g = 2 * f, h = !0;
    KME.world.three = {
        init: function () {
            this.renderer = new a.WebGLRenderer({
                alpha: !0,
                antialias: !0
            }), this.renderer.setClearColor(16777215, 0), this.renderer.setPixelRatio(1), this.renderer.shadowMap.enabled = !0;
            var b = f * e, c = b, i = c / 2 | 0, j = f * Math.ceil(d / e), k = 2 * j, l = k / 2 | 0;
            this.renderer.setSize(b, j), this.clock = new a.Clock, this.scene = new a.Scene, this.scene.add(new a.HemisphereLight(16777215, 16777215, .3));
            var m = new a.DirectionalLight(16777215, 1);
            m.color.setHSL(.1, 1, .95), m.position.set(-198 - i, 490 + l, -92 + l), m.target.position.set(-i, l, l), m.target.updateMatrixWorld(), m.castShadow = !0, this.scene.add(m), m.shadowMapWidth = b, m.shadowMapHeight = j, m.shadowCameraLeft = -c, m.shadowCameraRight = c, m.shadowCameraTop = l, m.shadowCameraBottom = -l, m.shadowCameraNear = 0, m.shadowCameraFar = k;
            var n = new a.PlaneBufferGeometry(16e3, 16e3), o = ["uniform vec3 diffuse;", "uniform float opacity;", a.ShaderChunk.common, a.ShaderChunk.color_pars_fragment, a.ShaderChunk.map_pars_fragment, a.ShaderChunk.lightmap_pars_fragment, a.ShaderChunk.envmap_pars_fragment, a.ShaderChunk.fog_pars_fragment, a.ShaderChunk.shadowmap_pars_fragment, a.ShaderChunk.specularmap_pars_fragment, "void main() {", "gl_FragColor = vec4( 0.0, 0.0, 0.0, 0.0 );", "vec3 outgoingLight = vec3(0.5);", "vec3 shadowMask = vec3( 0.5 );", a.ShaderChunk.map_fragment, a.ShaderChunk.alphatest_fragment, a.ShaderChunk.specularmap_fragment, a.ShaderChunk.lightmap_fragment, a.ShaderChunk.color_fragment, a.ShaderChunk.envmap_fragment, a.ShaderChunk.shadowmap_fragment, a.ShaderChunk.linear_to_gamma_fragment, a.ShaderChunk.fog_fragment, "if (shadowMask.x < 0.5) {", "gl_FragColor = vec4( 0.0, 0.0, 0.0, 0.5 - shadowMask.x);", "}", "}"].join("\n"), p = new a.ShaderMaterial({
                uniforms: a.ShaderLib.basic.uniforms,
                vertexShader: a.ShaderLib.basic.vertexShader,
                fragmentShader: o
            }), q = new a.Mesh(n, p);
            q.position.set(0, 0, 0), q.rotation.x = -Math.PI / 2, q.receiveShadow = !0, this.scene.add(q), this.camera = new a.OrthographicCamera(-b / 2, b / 2, j / 2, -j / 2, 1, 1e4), this.camera.position.y = 1e3, this.camera.position.x = -1750, this.camera.lookAt(this.scene.position), this.camera.position.z = -(f - b) / 2, this.camera.position.x += g / 4 - (Math.ceil(d / e) - 1) * g / 2, this.placeCounter = 0, this.debugSpriteCounter = 0, this.mixers = [], this.objects = [], h && this.initDebug()
        }, initDebug: function () {
            var e = document.createElement("div");
            e.style.position = "absolute", document.body.appendChild(e), e.appendChild(this.renderer.domElement), this.helpMaterials = [new a.MeshBasicMaterial({
                color: 16711935,
                wireframe: !0
            }), new a.MeshBasicMaterial({color: 16776960, wireframe: !0})];
            var f = this;
            KME.utils.modelAtlas.getOrLoadModel("femaleBody", function (a) {
                KME.utils.modelAtlas.getOrLoadModel("femaleHidePants", function (e) {
                    b.times(d, function (b) {
                        var d = c(a, !0), g = c(e, !0), h = .68;
                        d.scale.set(h, h, h), g.scale.set(h, h, h), d.position.set(d.position.x, d.position.y * h, d.position.z), g.position.set(g.position.x, g.position.y * h, g.position.z), 1 === b && KME.utils.modelAtlas.getOrLoadModel("stoneAxe", function (a) {
                            var b = c(a);
                            d.skeleton.bones[23].add(b)
                        }), f.placeMesh([d, g]), f.scene.add(d), f.scene.add(g)
                    })
                })
            })
        }, placeMesh: function (c) {
            var d = this.placeCounter % e, h = Math.floor(this.placeCounter / e), i = new a.Mesh(new a.CubeGeometry(2 * f, 0, f), this.helpMaterials[this.placeCounter % 2]);
            i.position.set(-h * g + f / 2, 0, d * f), this.scene.add(i);
            var j = this;
            c instanceof Array ? b.each(c, function (a, b) {
                a.position.set(-h * g, a.position.y, d * f), j.objects.push(a), b()
            }) : (c.position.set(-h * g, c.position.y, d * f), this.objects.push(c)), this.placeCounter++
        }, getSpriteFrame: function () {
            return this.debugSpriteCounter++, this.debugSpriteCounter >= d && (this.debugSpriteCounter = 0), {
                x: this.debugSpriteCounter % e * f,
                y: Math.floor(this.debugSpriteCounter / e) * f,
                width: f,
                height: f
            }
        }, addModel: function (b) {
            var c = this;
            this.loader.load(b, function (b, d) {
                var e = new a.SkinnedMesh(b, new a.MeshFaceMaterial(d));
                e.scale.set(1, 1, 1), c.placeMesh(e), c.scene.add(e);
                for (var f = 0; f < d.length; f++) {
                    var g = d[f];
                    g.skinning = !0, g.morphTargets = !0
                }
            })
        }, render: function () {
            if (this.renderer) {
                var c = this.clock.getDelta();
                b.each(this.objects, function (a, b) {
                    a.rotateY(.05), b()
                }), a.AnimationHandler.update(c), this.renderer.render(this.scene, this.camera)
            }
        }
    }
}),define("KME/controllers/graphic/EntityAnimationManager", ["phaser"], function () {
    var a = "stay";
    KME.graphic.entityAnimation = {
        animationNames: {
            stay: "stay",
            move: "move",
            hit: "hit",
            death: "death",
            injury: "injury",
            bowShot: "bowShot",
            craft: "craft",
            run: "run"
        }, maxAniLength: 0, init: function (a) {
            this.game = a, this.aniConfigs = {
                stay: {frameRate: 8, length: 4, playBack: !0},
                move: {frameRate: 12, length: 8},
                run: {frameRate: 12, length: 8},
                hit: {frameRate: 12, length: 4},
                craft: {frameRate: 8, length: 4},
                death: {frameRate: 8, length: 8},
                injury: {frameRate: 12, length: 4},
                bowShot: {frameRate: 8, frames: [0, 1, 2, 3, 0], length: 4, aniUsedName: "aBow"}
            }, this.aniDatas = {}, this.animationsToAdd = {};
            var b = this;
            Object.keys(this.aniConfigs).forEach(function (a) {
                b._framesInit(b.aniConfigs[a], a)
            })
        }, _framesInit: function (a, b) {
            var c, d, e;
            if (this.maxAniLength < a.length && (this.maxAniLength = a.length), e = a.aniUsedName, "undefined" == typeof e && (e = "a" + a.length, a.playBack && (e += "b")), "undefined" == typeof this.animationsToAdd[e]) {
                this.animationsToAdd[e] = {};
                var f = a.frames;
                if ("undefined" == typeof f) {
                    for (f = [], c = 0; c < a.length; c++)f.push(c);
                    if (a.playBack)for (c = a.length - 2; c > 0; c--)f.push(c)
                }
                this.animationsToAdd[e].frames = f
            }
            for (var g = 0, h = KME.world.directions.length; h > g; g++)d = g * a.length, this.aniDatas[b + KME.world.directions[g]] = {
                aniName: b,
                aniUsedName: e,
                frameRate: a.frameRate
            }
        }, createEntityAnimation: function (b) {
            var c = this;
            Object.keys(this.animationsToAdd).forEach(function (a) {
                b.sprite.animations.add(a, c.animationsToAdd[a].frames, 12, !0)
            }), this.play(b, a, !0)
        }, play: function (a, b, c, d) {
            "undefined" == typeof d && (d = 1);
            var e = a.body.getFace(), f = b + e, g = this.aniDatas[f], h = g.aniUsedName;
            a.currentAnimationName !== f && (a.sprite.animations.stop(null, !0), a.frameBodyPrefix = b + a.aniType.sheetsName + e, a.aniType.hairName && (a.frameHairPrefix = b + a.aniType.hairName + e), a.frameAnimationName = b, a.frameDirectionName = e, a.frameNumber = 0, a.frameLoaded = 0, a.frameLength = this.aniConfigs[b].length, a.isNeededFrameChange = !0, a.currentAnimationName = f, a.animationTextureChange()), a.sprite.animations.play(h, Math.ceil(g.frameRate * d), c)
        }
    }
}),define("KME/states/Game", ["async", "three", "require", "phaser", "phaser.debug", "KME/phext/phext", "KME/controllers/Controllers", "KME/utils/ItemSpriteAtlas", "KME/utils/WorldSpriteAtlas", "KME/data/entity/MainPlayer", "KME/data/entity/NetworkPlayer", "KME/data/world/WorldInteractiveObject", "KME/data/world/WorldProjectile", "KME/controllers/data/world/ViewZone", "KME/controllers/data/world/MapManager", "KME/controllers/data/world/RenderManagerDebug", "KME/controllers/graphic/EntityAnimationManager"], function (a) {
    var b = 200;
    KME.Game = function (a) {
        this.game = a, this.shakeWorld = 0, this.font = null, this.cursors = null, this.map = null, this.layers = {}, this.keys = {}, this.objects = {}, this.maskDebug = !1, this.mobDebug = !1, this.coordinateDebug = !1, this.collisionDebug = !1, this.hitAreaDebug = !1, this.gridDebug = !1, this.tileMaskDebug = !1, this.anchorDebug = !1, this.moveBlockOffDebug = !1, this.opacityZone = {
            fullOpacityOn: !1,
            level: .3,
            tileDistance: 2,
            heightPixelLimit: 70,
            tileX: 0,
            tileY: 0
        }, this.labelStyle = {
            font: "14px Arial",
            fill: "#FFFFFF",
            stroke: "black",
            strokeThickness: 1,
            align: "center"
        }, this.aggroLabelStyle = {
            font: "bold 14px Arial",
            fill: "#E82C0C",
            align: "center"
        }, this.messageStyle = {
            font: "14px Arial",
            fill: "#FFFFFF",
            stroke: "black",
            strokeThickness: 1,
            align: "center"
        }, this.playerStay = !1, this.playerRun = !1, this.interfaceShow = !0, this.demolishMode = !1, this.repairMode = !1
    }, KME.Game.prototype = {
        create: function () {
            if (this.game.renderer.renderSession.roundPixels = !0, KME.controllers.game.init(), KME.graphic.entityAnimation.init(this.game), KME.world.render.init(), KME.graphic.voidCharImage = this.game.cache.getImage("voidEntity"), this.game.time.timeCap = 100, this.myPhysicCap = .1, this.myPhysicElapsed = .017, this.sendGameStart(), window.SHOW_PHASER_DEBUG) {
                var a = requirejs("phaser.debug");
                this.game.add.plugin(a)
            }
            this.game.onFocus.add(this._focusRestore, this)
        }, _focusRestore: function () {
            this.playerStay = !1, this.playerRun = !1
        }, shutdown: function () {
            KME.mainPlayer = null
        }, nextAnimationDebug: function () {
            KME.mainPlayer.nextAnimationDebug()
        }, nextRenderTypeDebug: function () {
            KME.mainPlayer.nextRenderTypeDebug()
        }, coordinateDebugOnOff: function () {
            this.coordinateDebug = !this.coordinateDebug, this.coordinateDebug || KME.controllers.ui.showInfo("")
        }, collisionDebugOnOff: function () {
            this.collisionDebug = !this.collisionDebug;
            var a, b = this;
            KME.mainPlayer.bodyShowCheck(), Object.keys(this.objects).forEach(function (c) {
                a = b.objects[c], a.bodyShowCheck()
            })
        }, anchorDebugOnOff: function () {
            this.anchorDebug = !this.anchorDebug;
            var a, b = this;
            KME.mainPlayer.anchorShowCheck(), Object.keys(this.objects).forEach(function (c) {
                a = b.objects[c], a.anchorShowCheck()
            })
        }, fullOpacityOnOff: function () {
            this.opacityZone.fullOpacityOn = !this.opacityZone.fullOpacityOn, KME.world.map.objectGroups.cameraFloorRefresh()
        }, interfaceOnOff: function () {
            this.interfaceShow = !this.interfaceShow, KME.mainPlayer.claimDirection.render(),
                //RIM
                KME.mainPlayer.rareDirection.render(),
                //RIM
                KME.mainPlayer.corpseDirection.render();
            var a, b = this;
            KME.mainPlayer.interfaceShowCheck(), Object.keys(this.objects).forEach(function (c) {
                a = b.objects[c], a.interfaceShowCheck()
            })
        }, playerChangeTitle: function () {
            var a = this;
            KME.socket.emit(KME.commands.clientCommands.playerChangeTitle, null, function (b, c) {
                b ? a.showMessage(b) : a.showMessage(c)
            })
        }, roofsOnOff: function () {
            KME.world.map.objectGroups.floorIndexLimit > 1 ? (KME.world.map.objectGroups.floorIndexLimit = 1, KME.world.map.objectGroups.cameraFloorRefresh()) : (KME.world.map.objectGroups.floorIndexLimit = 7, KME.world.map.objectGroups.cameraFloorRefresh())
        }, sendGameStart: function () {
            var a;
            a = window.playerName ? window.playerName : this.game.net.getQueryString("user"), console.log("Enter in game as:", a);
            var b = this;
            KME.controllers.game.gameStart({
                id: sessionId,
                name: a ? a : sessionId,
                userId: window.userId
            }, function (a) {
                b.createGameFromServer(a)
            })
        }, createGameFromServer: function (a) {
            KME.world.map.initOnline(this, a), window.MUSIC_ON ? KME.controllers.sound.playTheme() : KME.controllers.sound.musicMute(), a.player.dead && (KME.interfaces.deathScreen.deathScreen("showScreen", !a.player.reviveNCoords), KME.controllers.sound.playOnce(KME.types.soundNames.deathScreen))
        }, playerClusterUpdate: function (b) {
            this.map.roomsUpdate(b, function () {
                KME.world.map.backgroundLayer.prepare(a.setImmediate(function () {
                    KME.world.map.initNewWorldObjects(null, !0)
                }))
            })
        }, reviveCharacter: function (a) {
            a.rooms ? this.map.roomsUpdate(a, function () {
                KME.world.map.backgroundLayer.prepare(function () {
                    KME.world.map.initNewWorldObjects(function () {
                        KME.mainPlayer.revive(a.player)
                    })
                })
            }) : KME.mainPlayer.revive(a.player)
        }, characterSetTarget: function (a) {
            var b = this.objects[a.id];
            if (b) {
                this.checkRemoveOverId(b);
                var c;
                c = KME.mainPlayer.id === a.targetId ? KME.mainPlayer : this.objects[a.targetId], c ? b.setTargetFromServer(c, a.range, a.isRun) : b.moveTo(a.x, a.x, a.isRun)
            }
        }, characterMoveTo: function (a) {
            var b = a.id, c = this.objects[b];
            c && (this.checkRemoveOverId(c), a.fromX && (Math.abs(a.fromX - c.x) > 128 || Math.abs(a.fromY - c.y) > 128) && c.body.setXY(a.fromX, a.fromY), c.moveToFromServer(a.x, a.y, a.isRun, a.hostId))
        }, characterStop: function (a) {
            var b = a.id, c = this.objects[b];
            c && c.characterStop(a.x, a.y, a.angle)
        }, characterTitleChange: function (a) {
            var b;
            b = KME.mainPlayer.id === a.id ? KME.mainPlayer : this.objects[a.id], b && b.titleChange(a.title)
        }, characterUpdateCake: function (a) {
            var b = a.id;
            if (KME.mainPlayer.id === b)KME.mainPlayer.updateCake(a.wearTypes, a.effects, a.bonuses), KME.controllers.ui.updateBonusesAndEffects(KME.mainPlayer.content), KME.interfaces.actionsBar.actionsBar("rebuild", KME.mainPlayer.content); else {
                var c = this.objects[b];
                c && c.updateCake(a.wearTypes, a.effects, a.bonuses)
            }
        }, worldSound: function (a) {
            KME.controllers.sound.playOnce(a.name, !1)
        }, actionCharacter: function (a) {
            var b, c = a.id;
            if (b = KME.mainPlayer.id === c ? KME.mainPlayer : this.objects[c]) {
                if (a.play) {
                    var d = a.loop;
                    "undefined" == typeof d && (d = !1), b.playAction(a.play, d, a.playCoefficient)
                }
                a.sound && (c !== KME.mainPlayer.id ? (a.sound === KME.types.soundNames.femaleInjury && (a.sound = KME.types.soundNames.femaleEnemyInjury), a.sound === KME.types.soundNames.maleInjury && (a.sound = KME.types.soundNames.maleEnemyInjury), KME.controllers.sound.playOnce(a.sound, !1)) : a.loop ? b.soundPlayLoop(a.sound, !0) : KME.controllers.sound.playOnce(a.sound, !0))
            }
        }, storeOverId: function (a) {
            this.overId = a
        }, checkRemoveOverId: function (a) {
            a && a.id && this.overId === a.id && a.onOut()
        }, deathCharacter: function (a) {
            var b, c = a.id;
            KME.mainPlayer.id === c ? (KME.controllers.ui.cursor.setNormal(), b = KME.mainPlayer, KME.mainPlayer.content.health = 0, KME.mainPlayer.content.stamina = 0, KME.interfaces.topbar.topbar("rebuild", KME.mainPlayer.content), KME.interfaces.deathScreen.deathScreen("showScreen", a.noBed), KME.controllers.sound.playOnce(KME.types.soundNames.deathScreen)) : (b = this.objects[c], this.checkRemoveOverId(b)), b && (KME.controllers.sound.characterDead(b, KME.mainPlayer.id === c), b.runDieSequence(a))
        }, updatePlayerWithNewItems: function (a, b) {
            if (a.id === KME.mainPlayer.id && (KME.mainPlayer.content ? KME.mainPlayer.content.update(a) : KME.mainPlayer.content = new KME.PlayerContent(a, KME.mainPlayer), KME.controllers.ui.update(KME.mainPlayer.content), window.AUTO_ADD_ON_TOOLBAR))for (var c = 0, d = b.length; d > c; c++)KME.interfaces.toolbar.toolbar("autocreate", KME.mainPlayer.content.getItemById(b[c].id))
        }, updatePlayer: function (a, b) {
            var c;
            if (a.id === KME.mainPlayer.id)switch (c = KME.mainPlayer, KME.mainPlayer.content ? KME.mainPlayer.content.update(a) : KME.mainPlayer.content = new KME.PlayerContent(a, KME.mainPlayer), b) {
                case KME.commands.serverCommands.partialUpdatePlayerTypes.toolbar:
                    KME.controllers.ui.updateToolbar(KME.mainPlayer.content);
                    break;
                case KME.commands.serverCommands.partialUpdatePlayerTypes.topbar:
                    KME.controllers.ui.updateTopBar(KME.mainPlayer.content);
                    break;
                case KME.commands.serverCommands.partialUpdatePlayerTypes.bonuses:
                    KME.controllers.ui.updateBonusesAndEffects(KME.mainPlayer.content);
                    break;
                case KME.commands.serverCommands.partialUpdatePlayerTypes.wear:
                    KME.controllers.ui.updateOnWear(KME.mainPlayer.content);
                    break;
                default:
                    KME.controllers.ui.update(KME.mainPlayer.content)
            } else c = this.objects[a.id];
            c && c.speedRecalculate(a.bonuses)
        }, playerSkillGain: function (a) {
            "undefined" != typeof a.newXp && (KME.playerSkills.skills[a.skillName].xp = a.newXp), a.newLevel && (KME.playerSkills.skills[a.skillName].level = a.newLevel, KME.interfaces.craft.craft("skillColorUpdate", a.skillName), this.showMessage("$t(skills:" + a.skillName + ".name). $t(skills:levels.newLevel)" + a.newLevel), KME.controllers.sound.playOnce("levelUp", !0), KME.interfaces.craft.is(":visible") && KME.interfaces.craft.craft("refreshIfSelect"), KME.interfaces.build.is(":visible") && KME.interfaces.build.build("refreshIfSelect")), KME.interfaces.skillsWindow.is(":visible") && KME.interfaces.skillsWindow.skillsWindow("rebuild")
        }, update: function () {
            this.myPhysicElapsed = this.game.time.elapsed / 1e3, this.myPhysicElapsed > this.myPhysicCap && (this.myPhysicElapsed = this.myPhysicCap);
            var a, b;
            if (KME.world.render.render(), KME.mainPlayer && (this.shakeWorld > 0 ? (this.shakeWorld--, this.shakeWorld % 2 !== 0 && (a = this.game.rnd.integerInRange(-20, 20), b = this.game.rnd.integerInRange(-20, 20), this.game.camera.x += a, this.game.camera.y += b)) : this.game.camera.setPosition(KME.mainPlayer.body.x - this.game.camera.width / 2, KME.mainPlayer.body.y - this.game.camera.height / 2), this._clickDown && KME.mainPlayer.pointerChange(this.game.input.activePointer), this.point = this.map.getNormalFromWorld(KME.mainPlayer.x, KME.mainPlayer.y), this.cameraSave && (Math.abs(this.cameraSave.x - KME.game.camera.x) > 20 || Math.abs(this.cameraSave.y - KME.game.camera.y) > 20) && console.log("cameraSave", KME.game.camera.x, KME.game.camera.y, this.cameraSave), this.cameraSave = {
                    x: KME.game.camera.x,
                    y: KME.game.camera.y
                }, this.opacityZone.tileX = this.point.x, this.opacityZone.tileY = this.point.y, this.coordinateDebug)) {
                var c = this.map.getRoomIdByNormalCoords(this.point), d = this.map.getWorkerIndex(c);
                KME.controllers.ui.showInfo("wX:" + KME.mainPlayer.x + " wY:" + KME.mainPlayer.y + "<br/>nX:" + this.point.nX + " nY:" + this.point.nY + " rId:" + c + " nId:" + d)
            }
        }, quitGame: function () {
            this.state.start("MainMenu")
        }, createPlayer: function (a, b) {
            var c = this;
            KME.world.view.init(this), KME.controllers.ui.init(function () {
                KME.controllers.input.init(c), KME.mainPlayer = new KME.MainPlayer(c, c.game, a), b && c.sendAchievement(b), window.setTimeout(function () {
                    KME.world.map.objectGroups.cameraFullRefresh()
                }, 200)
            })
        }, mainPlayerRenderComplete: function () {
            KME.world.view.zoneOn()
        }, characterExitCluster: function (a, b) {
            var c = this.objects[a];
            c && !KME.world.phasermap.hasRoom(b) && this.removeGameWorldObject(c)
        }, characterEnterCluster: function (a, b) {
            if (this.mainPlayerID !== a.id && !this.objects[a.id] && KME.world.phasermap.hasRoom(b)) {
                var c = KME.world.phasermap.getWorldTileCenterByNormal(a.nCoords);
                a.x = c.x, a.y = c.y, this.addGameWorldObject(a)
            }
        }, collapseEffect: function (a, c) {
            var d, e, f, g, h;
            a.body ? (d = a.body.width, e = a.body.height, f = a.body.anchor.x, g = a.body.anchor.y) : (d = a.sprite.width, e = 0, f = a.sprite.anchor.x, g = a.sprite.anchor.y), b > d && (h = d / b);
            var i, j = (.5 - f) * d | 0, k = (.5 - g) * e | 0;
            i = new KME.world.WorldEffect(this, this.game, KME.utils.worldatlas.effects.collapse, a.x + j, a.y + k, null, h), KME.controllers.sound.playOnce(KME.types.soundNames.buildingDestroy, KME.mainPlayer.id === a.ownerId), c()
        }, removeWorldObject: function (a) {

            //RIM
            if(a.id == rareDir.id) {
                rareDir = false;
            }
            //RIM

            var b = this.objects[a.id];
            b && (this.checkRemoveOverId(b), delete this.objects[a.id], a.collapse ? (b.checkForNearBonus(), this.collapseEffect(b, function () {
                b.destroy()
            })) : b.destroy())
        }, removeGameWorldObject: function (a) {

            //RIM
            if(a.id == rareDir.id) {
                rareDir = false;
            }
            //RIM
            
            this.mainPlayerID !== a.id && (a.id && this.objects[a.id] && (this.checkRemoveOverId(a), delete this.objects[a.id]), a.destroy())
        }, addGameWorldObject: function (a) {

            //RIM
            if(a.typeName == 'FindChest') {
                rareDir = {x: a.x, y: a.y, id: a.id};
                //KME.Achievement.showMessage("Rare Find!");
                KME.mainPlayer.showMessage(" !")
            }
            //RIM

            var b = null;
            if (a.tileIndex)return b = new KME.world.WorldObject(this, this.game, a.x, a.y, ""), b.createTileIndexObject(a), b;
            if (a.id && this.objects[a.id]) {
                if (b = this.objects[a.id], b.body) {
                    var c = this.map.getCollisionObjectsByNormalTileXY(b.normalPoint.nX, b.normalPoint.nY);
                    (!c || c.indexOf(b) < 0) && this.map.addCollisionObject(b)
                }
                return this.objects[a.id]
            }
            if (this.mainPlayerID !== a.id)if (a.senderId) {
                var d, e = null;
                d = this.mainPlayerID === a.senderId ? KME.mainPlayer : this.objects[a.senderId], d && (a.shootStructureId ? e = this.objects[a.shootStructureId] : (d.body.setXYAngle(a.senderX, a.senderY, a.senderAngle), d.isMovedNeedCheck = !0), b = new KME.world.WorldProjectile(this, this.game, d, {
                    senderTypeName: a.weaponType,
                    senderAmmoType: a.ammoType,
                    shootStructure: e
                }))
            } else KME.types.worldTypes[a.typeName] ? (b = KME.types.worldTypes[a.typeName].mob ? new KME.Character(this, this.game, a) : a.gender ? new KME.Player(this, this.game, a) : new KME.world.WorldInteractiveObject(this, this.game, a), a.id && (this.objects[a.id] = b)) : console.error("No type", a.typeName);
            return b
        }, createWorldObject: function (a) {
            var b = this.addGameWorldObject(a);
            return b && !0
        }, runPressed: function () {
            this.playerRun = !0
        }, runReleased: function () {
            this.playerRun = !1
        }, stayPressed: function () {
            this.playerStay = !0, KME.mainPlayer.stopMove()
        }, stayReleased: function () {
            this.playerStay = !1
        }, showMessage: function (a) {
            KME.mainPlayer ? KME.mainPlayer.showMessage(a) : console.log(a)
        }, sendAchievement: function (a) {
            var b;
            b = a instanceof Array ? a : [a];
            for (var c = 0, d = b.length; d > c; c++)KME.Achievement.showMessage(b[c].message)
        }, clearAllModes: function (a) {
            var b = !1;
            this.demolishMode && (b = !0, KME.controllers.data.actions.demolish(null, null, "release"), this.demolishMode = !1, console.log("clearAllModes", Date.now())), this.repairMode && (b = !0, KME.controllers.data.actions.repair(null, null, "release"), this.repairMode = !1), b && a && this.maskAndLabelRefresh()
        }, setDemolishMode: function () {
            this.clearAllModes(), this.demolishMode = !0, console.log("setDemolishMode", Date.now()), this.maskAndLabelRefresh()
        }, setRepairMode: function () {
            this.clearAllModes(), this.repairMode = !0, this.maskAndLabelRefresh()
        }, maskAndLabelRefresh: function () {
            var a, b = this;
            Object.keys(this.objects).forEach(function (c) {
                a = b.objects[c], a instanceof KME.world.WorldInteractiveObject && a.maskAndLabelCheck()
            })
        }
    }
}),define("KME/controllers/data/entity/PlayerController", ["KME/states/Game"], function () {
    var a;
    return {
        init: function () {
            a = KME.game.state.states.Game
        }, _: {}
    }
}),define("KME/controllers/data/world/WorldObjectsController", ["KME/states/Game"], function () {
    var a;
    return {
        init: function () {
            a = KME.game.state.states.Game
        }, updateContent: function (a) {
            var b = KME.types.worldTypes[a.typeName], c = b.tool ? "tool" : "container";
            if ($("#" + c + "_" + a.id).is(":visible")) {
                var d = KME.controllers.ui.item.getContentByContainerId(a.id);
                d.update(a), (b.tool || b.container) && KME.controllers.ui.updateContainer(d, b.tool ? "tool" : "container")
            }
        }, updateWorldObject: function (b) {
            var c;
            c = KME.mainPlayer && KME.mainPlayer.id === b.id ? KME.mainPlayer : a.objects[b.id], c && c.updateObject(b)
        }, _: {}
    }
}),define("KME/controllers/data/actions/BandageAction", ["jquery", "KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.controllers.network.actions.item.bandageItem(a.id, function (a, c) {
            a ? KME.gameState.showMessage(a) : c && KME.gameState.updatePlayer(c), b()
        })
    }
}),define("KME/controllers/data/actions/EatAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.mainPlayer.body.moved() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoOnMoving) : KME.mainPlayer.isMount() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoMounted) : KME.controllers.network.actions.item.eatItem({id: a.id}, function (a, c) {
            a ? KME.gameState.showMessage(a) : c && KME.mainPlayer.timerIndicator.start(c), b()
        })
    }
}),define("KME/controllers/data/actions/EatAllAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.mainPlayer.body.moved() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoOnMoving) : KME.mainPlayer.isMount() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoMounted) : KME.controllers.network.actions.item.eatItem({
            id: a.id,
            all: !0
        }, function (a, c) {
            a ? KME.gameState.showMessage(a) : c && KME.mainPlayer.timerIndicator.start(c), b()
        })
    }
}),define("KME/controllers/data/actions/SummonAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.mainPlayer.body.moved() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoOnMoving) : KME.mainPlayer.isMount() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoMounted) : KME.controllers.network.actions.item.summonItem(a.id, function (a, c) {
            a ? KME.gameState.showMessage(a) : c && KME.mainPlayer.timerIndicator.start(c), b()
        })
    }
}),define("KME/controllers/data/actions/FreeAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.controllers.network.actions.item.freeItem({
            id: a.id,
            point: KME.mainPlayer.getPointForAnimalFree()
        }, function (a, c) {
            a ? KME.gameState.showMessage(a) : c && KME.gameState.updatePlayer(c), b()
        })
    }
}),define("KME/controllers/data/actions/SplitAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.controllers.network.actions.item.split(a.id, function (c, d, e) {
            c && KME.gameState.showMessage(c), d && a.update(d), e && KME.gameState.updatePlayer(e), b()
        })
    }
}),define("KME/controllers/data/actions/ItemRepairAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.mainPlayer.body.moved() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoOnMoving) : KME.mainPlayer.isMount() ? KME.gameState.showMessage(KME.types.messageTypes.cantDoMounted) : KME.controllers.network.actions.item.repairItem({id: a.id}, function (a, c) {
            a ? KME.gameState.showMessage(a) : c && KME.mainPlayer.timerIndicator.start(c), b()
        })
    }
}),define("KME/controllers/data/actions/StayAction", ["jquery"], function (a) {
    return a(window).focus(function () {
        try {
            KME.gameState.stayReleased();
            var b = a("div.button.stay").closest(".cell");
            b.removeClass("active")
        } catch (c) {
        }
    }).blur(function () {
        try {
            KME.gameState.stayReleased();
            var b = a("div.button.stay").closest(".cell");
            b.removeClass("active")
        } catch (c) {
        }
    }), function (b, c, d) {
        var e = a("div.button.stay").closest(".cell");
        "press" == d ? (KME.gameState.stayPressed(), KME.controllers.ui.cursor.setAttack(), e.addClass("active")) : ("pressup" == d || "tap" == d && e.hasClass("active")) && (KME.gameState.stayReleased(), KME.controllers.ui.cursor.setNormal(), e.removeClass("active")), c && c()
    }
}),define("KME/controllers/data/actions/RunAction", ["jquery"], function (a) {
    return a(window).focus(function () {
        try {
            var b = a("div.button.run").closest(".cell");
            b.removeClass("active")
        } catch (c) {
        }
    }).blur(function () {
        try {
            var b = a("div.button.run").closest(".cell");
            b.removeClass("active")
        } catch (c) {
        }
    }), function (b, c, d) {
        var e = a("div.button.run").closest(".cell");
        "press" == d ? (KME.gameState.runPressed(), e.addClass("active")) : ("pressup" == d || "tap" == d && e.hasClass("active")) && (KME.gameState.runReleased(), e.removeClass("active")), c && c()
    }
}),define("KME/controllers/data/actions/CraftAction", [], function () {
    return function (a, b) {
        KME.interfaces.craft.craft("toggle"), b && b()
    }
}),define("KME/controllers/data/actions/BuildAction", ["jquery"], function () {
    return function (a, b) {
        KME.interfaces.build.build("toggle"), b && b(), KME.gameState.clearAllModes(!0)
    }
}),define("KME/controllers/data/actions/SuicideAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.mainPlayer.stopMove(), KME.controllers.network.actions.player.suicide(), b()
    }
}),define("KME/controllers/data/actions/DismountAction", ["KME/controllers/network/NetworkController"], function () {
    return function (a, b) {
        KME.mainPlayer.stopMove(), KME.controllers.network.actions.player.dismount(), b()
    }
}),define("KME/controllers/data/actions/RepairAction", ["jquery", "KME/controllers/data/actions/DemolishAction"], function (a) {
    return function (b, c, d) {
        var e = a("div.button.repair").closest(".cell");
        "release" !== d ? e.hasClass("active") ? KME.gameState.clearAllModes(!0) : (KME.gameState.setRepairMode(), e.toggleClass("active")) : e.removeClass("active"), c && c()
    }
}),define("KME/controllers/data/actions/DemolishAction", ["jquery", "KME/controllers/data/actions/RepairAction"], function (a) {
    return function (b, c, d) {
        var e = a("div.button.demolish").closest(".cell");
        "release" !== d ? e.hasClass("active") ? KME.gameState.clearAllModes(!0) : (KME.gameState.setDemolishMode(), e.toggleClass("active")) : e.removeClass("active"), c && c()
    }
}),define("KME/controllers/data/actions/SkillsAction", ["jquery"], function () {
    return function (a, b) {
        KME.interfaces.skillsWindow.skillsWindow("toggle"), b && b(), KME.gameState.clearAllModes(!0)
    }
}),define("KME/controllers/data/actions/ActionsController", ["require", "jquery", "./BandageAction", "./EatAction", "./EatAllAction", "./SummonAction", "./FreeAction", "./SplitAction", "./DressAction", "./ItemRepairAction", "./UndressAction", "./StayAction", "./RunAction", "./CraftAction", "./BuildAction", "./SuicideAction", "./DismountAction", "./DemolishAction", "./RepairAction", "./SkillsAction"], function (a) {
    function b(a) {
        return ["head", "leftHand", "rightHand", "body", "legs", "foots", "hands"].indexOf(a) >= 0
    }

    function c(a) {
        var c = a.type.actions;
        if (c) {
            var d = Object.keys(c);
            if (1 === d.length)return d[0];
            if (!b(a.position)) {
                if (c.summon)return "summon";
                if (c.eat)return "eat";
                if (c.bandage)return "bandage";
                if (c.dress)return "dress";
                if (c.free)return "free"
            }
        }
        return !1
    }

    function d(a) {
        var c = a.type.actions, d = Object.keys(c);
        if (1 === d.length)return d[0];
        if (b(a.position)) {
            if (c.eat)return "eat";
            if (c.bandage)return "bandage"
        } else {
            if (c.dress)return "dress";
            if (c.eat)return "eat";
            if (c.bandage)return "bandage";
            if (c.free)return "free"
        }
        return !1
    }

    return {
        bandage: a("./BandageAction"),
        eat: a("./EatAction"),
        eatAll: a("./EatAllAction"),
        summon: a("./SummonAction"),
        free: a("./FreeAction"),
        split: a("./SplitAction"),
        dress: a("./DressAction"),
        itemRepair: a("./ItemRepairAction"),
        undress: a("./UndressAction"),
        stay: a("./StayAction"),
        run: a("./RunAction"),
        craft: a("./CraftAction"),
        build: a("./BuildAction"),
        suicide: a("./SuicideAction"),
        dismount: a("./DismountAction"),
        demolish: a("./DemolishAction"),
        repair: a("./RepairAction"),
        skills: a("./SkillsAction"),
        perform: function (a, b, e, f) {
            b && ("double" === a ? a = c(b) : "toolbar" === a && (a = d(b))), a && ("function" == typeof this[a] ? this[a](b, e, f) : console.log("Action [" + a + "] not implemented yet!", b, e, f))
        }
    }
}),define("KME/controllers/data/commands/admin/TeleportCommand", ["KME/controllers/network/NetworkController"], function () {
    return function (a) {
        console.log("%c Teleporting from", "background: #222; color: #bada55", {
            x: KME.mainPlayer.x,
            y: KME.mainPlayer.y
        }), KME.controllers.network.actions.commands.admin.teleport(a, function (a) {
            a ? console.warn("Teleport command", a) : console.log("%c Teleport command success", "background: #222; color: #bada55", {
                x: KME.mainPlayer.x,
                y: KME.mainPlayer.y
            })
        })
    }
}),define("KME/controllers/data/commands/admin/AdminCommands", ["require", "./TeleportCommand"], function (a) {
    return {teleport: a("./TeleportCommand")}
}),define("KME/controllers/data/commands/CommandsController", ["require", "./admin/AdminCommands"], function (a) {
    return KME.com = {admin: a("./admin/AdminCommands")}, KME.com
}),define("KME/controllers/data/DataController", ["require", "./entity/PlayerController", "./world/WorldObjectsController", "./actions/ActionsController", "./commands/CommandsController"], function (a) {
    return {
        player: a("./entity/PlayerController"),
        worldObject: a("./world/WorldObjectsController"),
        actions: a("./actions/ActionsController"),
        commands: a("./commands/CommandsController"),
        init: function () {
            this.player.init(), this.worldObject.init()
        }
    }
}),define("KME/controllers/network/socket/Listeners", ["KME/controllers/data/DataController", "KME/states/Game", "KME/controllers/interface/InterfaceController"], function () {
    var a, b;
    return {
        init: function () {
            a = KME.game.state.states.Game, b = KME.game.state.states.Connector;
            var c = null, d = null;
            window.WILDTERRA_HOST && (c = "http://" + window.WILDTERRA_HOST + ":" + window.WILDTERRA_PORT + "/", d = {
                host: window.WILDTERRA_HOST,
                port: window.WILDTERRA_PORT,
                transports: window.CONNECT_TRANSPORTS
            }), console.log("Connecting to server with details:", d), KME.socket = io.connect(c, d), KME.socket.on("connect", this._.connect), KME.socket.on("disconnect", this._.disconnect), KME.socket.on(KME.commands.serverCommands.sendMessage, this._.sendMessage), KME.socket.on(KME.commands.serverCommands.sendAchievement, this._.sendAchievement), KME.socket.on(KME.commands.serverCommands.playerClusterUpdate, this._.playerClusterUpdate), KME.socket.on(KME.commands.serverCommands.newWorldObjects, this._.newWorldObjects), KME.socket.on(KME.commands.serverCommands.updateWorldObject, this._.updateWorldObject), KME.socket.on(KME.commands.serverCommands.updateWorldTiles, this._.updateWorldTiles), KME.socket.on(KME.commands.serverCommands.removeWorldObject, this._.removeWorldObject), KME.socket.on(KME.commands.serverCommands.characterExitCluster, this._.characterExitCluster), KME.socket.on(KME.commands.serverCommands.characterEnterCluster, this._.characterEnterCluster), KME.socket.on(KME.commands.serverCommands.characterSetTarget, this._.characterSetTarget), KME.socket.on(KME.commands.serverCommands.characterMoveTo, this._.characterMoveTo), KME.socket.on(KME.commands.serverCommands.characterStop, this._.characterStop), KME.socket.on(KME.commands.serverCommands.characterTitleChange, this._.characterTitleChange), KME.socket.on(KME.commands.serverCommands.characterUpdateCake, this._.characterUpdateCake), KME.socket.on(KME.commands.serverCommands.worldSound, this._.worldSound), KME.socket.on(KME.commands.serverCommands.actionCharacter, this._.actionCharacter), KME.socket.on(KME.commands.serverCommands.deathCharacter, this._.deathCharacter), KME.socket.on(KME.commands.serverCommands.reviveCharacter, this._.reviveCharacter), KME.socket.on(KME.commands.serverCommands.updatePlayer, this._.updatePlayer), KME.socket.on(KME.commands.serverCommands.updateContent, this._.updateContent), KME.socket.on(KME.commands.serverCommands.updatePlayerWithNewItems, this._.updatePlayerWithNewItems), KME.socket.on(KME.commands.serverCommands.partialUpdatePlayer, this._.partialUpdatePlayer), KME.socket.on("chatMessage", this._.chatMessage), KME.socket.on("updatePlayerHealth", this._.updatePlayerHealth), KME.socket.on("updatePlayerStamina", this._.updatePlayerStamina), KME.socket.on("playerSkillGain", this._.playerSkillGain), KME.socket.on("craftOrBuildCompleted", this._.craftOrBuildCompleted), KME.socket.on("playerForceDisconnect", this._.playerForceDisconnect)
        }, _: {
            connect: function () {
                KME.mainPlayer ? (console.log("Socket connect error, connection closed."), this.disconnect()) : (console.log("Socket connected"), b.state.start("Preloader"))
            }, disconnect: function () {
                console.log("Socket disconnected"), KME.world.view.blackBack(!1), KME.sendError("interfaces:serverErrors.socketDisconnect", "initGame"), KME.socket.disconnect()
            }, sendMessage: function (b) {
                a.showMessage(b)
            }, sendAchievement: function (b) {
                a.sendAchievement(b)
            }, playerClusterUpdate: function (b) {
                a.playerClusterUpdate(b)
            }, newWorldObjects: function (b) {
                b && (b.broadcastId && KME.mainPlayer.id === b.broadcastId || Object.keys(b).forEach(function (c) {
                    if ("broadcastId" !== c) {
                        var d = b[c];
                        a.createWorldObject(d) || console.error("Trying to add wrong object. Key:" + c + " Obj:" + d)
                    }
                }))
            }, updateContent: function (a) {
                KME.controllers.data.worldObject.updateContent(a)
            }, updateWorldObject: function (a) {
                KME.controllers.data.worldObject.updateWorldObject(a)
            }, updateWorldTiles: function (a) {
                KME.world.map.updateWorldTiles(a)
            }, reviveCharacter: function (b) {
                b.broadcastId && KME.mainPlayer.id === b.broadcastId || a.reviveCharacter(b)
            }, removeWorldObject: function (b) {
                a.removeWorldObject(b)
            }, characterExitCluster: function (b) {
                a.characterExitCluster(b.id, b.enterCluster)
            }, characterEnterCluster: function (b) {
                a.characterEnterCluster(b.character, b.enterCluster)
            }, characterSetTarget: function (b) {
                b.broadcastId && KME.mainPlayer.id === b.broadcastId || a.characterSetTarget(b)
            }, characterMoveTo: function (b) {
                b.broadcastId && KME.mainPlayer.id === b.broadcastId || a.characterMoveTo(b)
            }, characterStop: function (b) {
                b.broadcastId && KME.mainPlayer.id === b.broadcastId || a.characterStop(b)
            }, characterTitleChange: function (b) {
                a.characterTitleChange(b)
            }, characterUpdateCake: function (b) {
                a.characterUpdateCake(b)
            }, actionCharacter: function (b) {
                b.broadcastId && KME.mainPlayer.id === b.broadcastId || a.actionCharacter(b)
            }, worldSound: function (b) {
                a.worldSound(b)
            }, deathCharacter: function (b) {
                a.deathCharacter(b)
            }, updatePlayer: function (b) {
                a.updatePlayer(b)
            }, updatePlayerWithNewItems: function (b) {
                a.updatePlayerWithNewItems(b.player, b.items)
            }, partialUpdatePlayer: function (b) {
                a.updatePlayer(b.player, b.target)
            }, chatMessage: function (a) {
                KME.controllers.ui.chatMessage(a)
            }, updatePlayerHealth: function (a) {
                KME.mainPlayer.updatePlayerHealth(a)
            }, updatePlayerStamina: function (a) {
                KME.mainPlayer.updatePlayerStamina(a)
            }, playerSkillGain: function (b) {
                a.playerSkillGain(b)
            }, craftOrBuildCompleted: function (a) {
                KME.mainPlayer.craftOrBuildCompleted(a)
            }, playerForceDisconnect: function (a) {
                KME.socket.emit("playerForceDisconnect", a)
            }
        }
    }
}),define("KME/controllers/network/socket/SocketItemController", [], function () {
    return {
        init: function () {
        }, dropItem: function (a, b) {
            KME.socket.emit("itemDrop", a, b)
        }, split: function (a, b) {
            KME.socket.emit("itemSplit", a, b)
        }, stack: function (a, b) {
            KME.socket.emit("itemStack", a, b)
        }, bandageItem: function (a, b) {
            KME.socket.emit("itemBandage", a, b)
        }, freeItem: function (a, b) {
            KME.socket.emit("itemFree", a, b)
        }, eatItem: function (a, b) {
            KME.socket.emit("itemEat", a, b)
        }, repairItem: function (a, b) {
            KME.socket.emit("itemRepair", a, b)
        }, summonItem: function (a, b) {
            KME.socket.emit("itemSummon", a, b)
        }, dress: function (a, b) {
            KME.socket.emit("itemDress", a, b)
        }, undress: function (a, b) {
            KME.socket.emit("itemUndress", a, b)
        }
    }
}),define("KME/controllers/network/socket/SocketActionsController", ["KME/controllers/interface/InterfaceController"], function () {
    return {
        init: function () {
        }, storeAction: function (a) {
            KME.socket.emit(KME.commands.clientCommands.actionStore, {action: a}, function (a, b) {
                a && console.warn("Error on storing action", a), KME.gameState.updatePlayer(b, "toolbar")
            })
        }, dropAction: function (a) {
            KME.socket.emit(KME.commands.clientCommands.actionDrop, {action: a}, function (a, b) {
                a && console.warn("Error on dropping action", a), KME.gameState.updatePlayer(b, "toolbar")
            })
        }, moveAction: function (a, b) {
            KME.socket.emit(KME.commands.clientCommands.actionMove, {action: a, position: b}, function (a, b) {
                a && console.warn("Error on moving action", a), KME.gameState.updatePlayer(b, "toolbar")
            })
        }
    }
}),define("KME/controllers/network/socket/SocketCommandsController", [], function () {
    return {
        init: function () {
        }, admin: {
            teleport: function (a, b) {
                KME.socket.emit("commandTeleport", a, function (a) {
                    b(a)
                })
            }
        }
    }
}),define("KME/controllers/network/socket/SocketController", ["require", "./SocketItemController", "./SocketPlayerController", "./SocketActionsController", "./SocketCommandsController"], function (a) {
    return {
        item: a("./SocketItemController"),
        player: a("./SocketPlayerController"),
        action: a("./SocketActionsController"),
        commands: a("./SocketCommandsController"),
        init: function () {
        },
        gameStart: function (a, b) {
            KME.socket.emit(KME.commands.clientCommands.gameStart, a, b)
        },
        playerSetTarget: function (a) {
            KME.socket.emit(KME.commands.clientCommands.playerSetTarget, a)
        },
        playerMoveTo: function (a) {
            KME.socket.emit(KME.commands.clientCommands.playerMoveTo, a)
        },
        playerPositionUpdate: function (a) {
            var b = performance.now();
            KME.socket.emit(KME.commands.clientCommands.playerPositionUpdate, a, function () {
                var a = performance.now();
                $(".pdebug-stats .pdebug-stats-item.ping span").text(Math.round(100 * (a - b) / 100))
            })
        },
        playerMobRoomChange: function (a) {
            KME.socket.emit(KME.commands.clientCommands.playerMobRoomChange, a)
        },
        playerStop: function (a, b, c) {
            KME.socket.emit(KME.commands.clientCommands.playerStop, {
                x: a, y: b, angle: c
            })
        }
    }
}),define("KME/data/world/WorldTypes", [], function () {
    KME.types.worldTypes = {
        actions: {
            PickUp: "PickUp",
            Gather: "Gather",
            OpenContainer: "OpenContainer",
            NextState: "NextState"
        },
        PlayerCorpse: {actionConfig: {OpenContainer: {action: "OpenContainer", title: "Open"}}, slots: 60},
        AnimalCorpse: {actionConfig: {Gather: {action: "Gather", title: "Butcher", toolRequired: "knife"}}},
        Corpse: {
            actionConfig: {
                OpenContainer: {action: "OpenContainer", title: "Open"},
                Gather: {action: "Gather", title: "Butcher"}
            }, slots: 25
        },
        Female: {
            health: 100,
            stamina: 100,
            body: {shape: "circle32", moveBlock: !0, viewBlock: !0},
            character: !0,
            speed: 5,
            inventory: {slots: 44},
            toolbar: {},
            wear: {slots: 6}
        },
        Hare: {
            name: "Hare",
            health: 20,
            body: {shape: "circle32", moveBlock: !0, viewBlock: !0},
            character: !0,
            speed: 4,
            respawnDelay: 1e3,
            move: {distance: 300, delay: 3e3, rndDelay: 3e3},
            runAway: {distance: 500, delay: 5e3},
            resources: {Skin: {amount: 1, amountAdd: 1}, Meat: {amount: 1, amountAdd: 1}},
            bonusTool: "knife",
            gatherTime: 4e3
        },
        Deer: {
            name: "Deer",
            health: 40,
            body: {shape: "circle48", moveBlock: !0, viewBlock: !0},
            character: !0,
            speed: 6,
            respawnDelay: 1e4,
            move: {distance: 600, delay: 2e3, rndDelay: 2e3},
            runAway: {distance: 1e3, delay: 1e4},
            resources: {Skin: {amount: 3, amountAdd: 3}, Meat: {amount: 3, amountAdd: 3}},
            bonusTool: "knife",
            gatherTime: 4e3
        },
        WildBoar: {
            name: "Wild Boar",
            health: 60,
            body: {shape: "circle48", moveBlock: !0, viewBlock: !0},
            character: !0,
            speed: 4,
            respawnDelay: 1e4,
            attack: {
                damage: 10,
                range: 0,
                startRange: 32,
                delayBefore: 0,
                delay: 1e3,
                splash: !1,
                pursuitDelay: 5e3,
                pursuitDistance: 1e3,
                shape: {name: "circle64", rotate: !1, anchorX: .5, anchorY: .5}
            },
            move: {distance: 300, delay: 3e3, rndDelay: 3e3},
            resources: {Skin: {amount: 5, amountAdd: 3}, Meat: {amount: 5, amountAdd: 3}},
            bonusTool: "knife",
            gatherTime: 4e3
        },
        Wolf: {
            name: "Wolf",
            health: 50,
            body: {shape: "circle48", moveBlock: !0, viewBlock: !0},
            character: !0,
            speed: 5,
            respawnDelay: 1e4,
            aggressive: {distance: 300},
            attack: {
                damage: 10,
                range: 0,
                startRange: 32,
                delayBefore: 0,
                delay: 1e3,
                splash: !1,
                pursuitDelay: 1e4,
                pursuitDistance: 1e3,
                shape: {name: "circle64", rotate: !1, anchorX: .5, anchorY: .5}
            },
            move: {distance: 300, delay: 5e3, rndDelay: 5e3},
            resources: {Skin: {amount: 7, amountAdd: 5}, Meat: {amount: 7, amountAdd: 5}},
            bonusTool: "knife",
            gatherTime: 4e3
        },
        Flour: {name: "Flour"},
        Wood: {name: "Wood"},
        IronOre: {name: "IronOre"},
        Stone: {name: "Stone"},
        Meat: {name: "Meat"},
        Skin: {name: "Skin"},
        Hide: {name: "Hide"},
        IronIngot: {name: "Iron Ingot"},
        WoodenBucketWater: {name: "Water"},
        StoneKnife: {name: "Stone knife"},
        StoneAxe: {name: "Stone axe"},
        Bow: {name: "Bow"},
        HideSling: {name: "Primitive sling"},
        IronSword: {name: "Iron sword"},
        IronShield: {name: "Iron shield"},
        IronAxe: {name: "Iron axe"},
        IronKnife: {name: "Iron knife"},
        IronPickaxe: {name: "Iron pickaxe"},
        WoodenShovel: {name: "Woonden shovel"},
        IronSaw: {name: "Iron saw"},
        IronShovel: {name: "Iron shovel"},
        StoneHammer: {name: "Stone hammer"},
        IronHammer: {name: "Smith's hammer"},
        LightSaber: {name: "Lightsaber"},
        ClothCap: {name: "Cloth Cap"},
        ClothVest: {name: "Cloth Vest"},
        ClothTrousers: {name: "Cloth Trousers"},
        ClothSandals: {name: "Cloth Sandals"},
        SkinCap: {name: "Skin Cap"},
        SkinVest: {name: "Skin Vest"},
        SkinLoincloth: {name: "Skin Loincloth"},
        SkinBoots: {name: "Skin Boots"},
        LeatherHelmet: {name: "Leather Helmet"},
        LeatherJacket: {name: "Leather Jacket"},
        LeatherPants: {name: "Leather Pants"},
        LeatherBoots: {name: "Leather Boots"},
        IronHelmet: {name: "Iron Helmet"},
        IronCuirass: {name: "Iron Cuirass"},
        IronLeggings: {name: "Iron Leggings"},
        IronGreaves: {name: "Iron Greaves"},
        Torch: {name: "Torch"},
        WoodenSpear: {name: "Wooden spear"},
        Bandage: {name: "Bandage"},
        StoneTippedArrow: {name: "Stone-tipped arrow"},
        WomanCutHead: {name: "Head of a woman"},
        ManCutHead: {name: "Head of a man"},
        RoastMeat: {name: "Roast meat"},
        GrainWheat: {name: "Grain wheat"},
        Carrot: {name: "Carrot"},
        Bannock: {name: "Bannock"},
        Tree: {
            name: "Tree",
            body: {shape: "circle16", moveBlock: !0, viewBlock: !0},
            actionConfig: {Gather: {action: "Gather", title: "Gather", toolRequired: "hatchet"}},
            resources: {Wood: {amount: 30, amountAdd: 10}},
            bonusTool: "hatchet",
            gatherTime: 5e3
        },
        WoodPile: {
            name: "Pile of wood",
            body: {shape: "circle32", moveBlock: !0},
            actionConfig: {Gather: {action: "Gather", title: "Gather"}},
            resources: {Wood: {amount: 5, amountAdd: 3}},
            bonusTool: "hatchet",
            gatherTime: 4e3
        },
        Rock: {
            name: "Rock",
            body: {shape: "circle40", moveBlock: !0, viewBlock: !0},
            actionConfig: {Gather: {action: "Gather", title: "Gather", toolRequired: "pickaxe"}},
            resources: {Stone: {amount: 30, amountAdd: 10}},
            bonusTool: "pickaxe",
            gatherTime: 5e3
        },
        StonePile: {
            name: "Pile of stones",
            body: {shape: "circle32", moveBlock: !0},
            actionConfig: {Gather: {action: "Gather", title: "Gather"}},
            resources: {Stone: {amount: 5, amountAdd: 3}},
            bonusTool: "pickaxe",
            gatherTime: 4e3
        },
        WoodenFoundationSection: {
            name: "Wooden foundation section",
            tileAlign: {anchorX: .5, anchorY: .5},
            section: [{typeName: "WoodenFoundation"}, {
                typeName: "WoodenFoundation",
                anchorX: -1,
                anchorY: 0
            }, {typeName: "WoodenFoundation", anchorX: 0, anchorY: -1}, {
                typeName: "WoodenFoundation",
                anchorX: 1,
                anchorY: 0
            }, {typeName: "WoodenFoundation", anchorX: 0, anchorY: 1}, {
                typeName: "WoodenFoundation",
                anchorX: -.5,
                anchorY: -.5
            }, {typeName: "WoodenFoundation", anchorX: -.5, anchorY: .5}, {
                typeName: "WoodenFoundation",
                anchorX: .5,
                anchorY: -.5
            }, {typeName: "WoodenFoundation", anchorX: .5, anchorY: .5}]
        },
        WoodenCeilingSection: {
            name: "Wooden ceiling section",
            tileAlign: {anchorX: .5, anchorY: .5},
            section: [{typeName: "WoodenCeiling"}, {
                typeName: "WoodenCeiling",
                anchorX: -1,
                anchorY: 0
            }, {typeName: "WoodenCeiling", anchorX: 0, anchorY: -1}, {
                typeName: "WoodenCeiling",
                anchorX: 1,
                anchorY: 0
            }, {typeName: "WoodenCeiling", anchorX: 0, anchorY: 1}, {
                typeName: "WoodenCeiling",
                anchorX: -.5,
                anchorY: -.5
            }, {typeName: "WoodenCeiling", anchorX: -.5, anchorY: .5}, {
                typeName: "WoodenCeiling",
                anchorX: .5,
                anchorY: -.5
            }, {typeName: "WoodenCeiling", anchorX: .5, anchorY: .5}]
        },
        WoodenRoofSection: {
            name: "Wooden roof section",
            tileAlign: {anchorX: .5, anchorY: .5},
            section: [{typeName: "WoodenRoof", layout: "leftCenterUp"}, {
                typeName: "WoodenRoof",
                layout: "leftNearUp",
                anchorX: -1,
                anchorY: 0
            }, {typeName: "WoodenRoof", layout: "leftDistantUp", anchorX: 0, anchorY: -1}, {
                typeName: "WoodenRoof",
                layout: "leftDistant",
                anchorX: 1,
                anchorY: 0
            }, {typeName: "WoodenRoof", layout: "leftNear", anchorX: 0, anchorY: 1}, {
                typeName: "WoodenRoof",
                layout: "leftCenterUp",
                anchorX: -.5,
                anchorY: -.5
            }, {typeName: "WoodenRoof", layout: "leftNearUp", anchorX: -.5, anchorY: .5}, {
                typeName: "WoodenRoof",
                layout: "leftDistantUp",
                anchorX: .5,
                anchorY: -.5
            }, {typeName: "WoodenRoof", layout: "leftCenter", anchorX: .5, anchorY: .5}]
        },
        WoodenCabinComplex: {
            name: "Wooden cabin",
            tileAlign: {anchorX: .5, anchorY: 1},
            section: [{typeName: "WoodenWall", layout: "left"}, {
                typeName: "WoodenWall",
                layout: "left",
                anchorX: .5,
                anchorY: .5
            }, {typeName: "WoodenWall", layout: "right", anchorX: -1, anchorY: 0}, {
                typeName: "WoodenWall",
                layout: "right",
                anchorX: -1.5,
                anchorY: .5
            }, {typeName: "WoodenFoundation", anchorX: -1, anchorY: .5}, {
                typeName: "WoodenFoundation",
                anchorX: -.5,
                anchorY: 0
            }, {typeName: "WoodenFoundation", anchorX: -.5, anchorY: 1}, {
                typeName: "WoodenFoundation",
                anchorX: 0,
                anchorY: .5
            }, {typeName: "WoodenWindow", layout: "right", anchorX: -.5, anchorY: 1.5}, {
                typeName: "WoodenWall",
                layout: "right",
                anchorX: 0,
                anchorY: 1
            }, {typeName: "WoodenDoorway", layout: "left", anchorX: -1, anchorY: 1}, {
                typeName: "WoodenWall",
                layout: "left",
                anchorX: -.5,
                anchorY: 1.5
            }, {typeName: "WoodenRoof", layout: "leftNearUp", anchorX: -1, anchorY: .5}, {
                typeName: "WoodenRoof",
                layout: "leftDistantUp",
                anchorX: -.5,
                anchorY: 0
            }, {typeName: "WoodenRoof", layout: "leftNear", anchorX: -.5, anchorY: 1}, {
                typeName: "WoodenRoof",
                layout: "leftDistant",
                anchorX: 0,
                anchorY: .5
            }]
        },
        WoodenWall: {
            name: "Wooden wall",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            layouts: {
                left: {body: {frame: 1, anchorX: 1, anchorY: 1}},
                right: {body: {frame: 0, anchorX: 0, anchorY: 1}}
            }
        },
        WoodenDoorway: {
            name: "Wooden doorway",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            layouts: {
                left: {body: {frame: 3, anchorX: 1, anchorY: 1}},
                right: {body: {frame: 2, anchorX: 0, anchorY: 1}}
            }
        },
        WoodenWindow: {
            name: "Wooden window",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !1},
            layouts: {
                left: {body: {frame: 1, anchorX: 1, anchorY: 1}},
                right: {body: {frame: 0, anchorX: 0, anchorY: 1}}
            }
        },
        WoodenDoor: {
            name: "Wooden door",
            tileAlign: {anchorX: .5, anchorY: 0},
            noOpacity: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            defaults: {state: "ClosedDoor", layout: "left"},
            actionConfig: {NextState: {action: "NextState", title: "OpenClose", ownerCheck: !0}},
            stateConfig: {ClosedDoor: {nextState: "OpenDoor"}, OpenDoor: {nextState: "ClosedDoor"}},
            layouts: {
                left: {
                    states: {
                        ClosedDoor: {body: {frame: 5, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 4, anchorX: .6, anchorY: .1}}
                    }
                },
                right: {
                    states: {
                        ClosedDoor: {body: {frame: 4, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 5, anchorX: .4, anchorY: .1}}
                    }
                }
            }
        },
        WoodenIronedDoor: {
            name: "Wooden ironed door",
            tileAlign: {anchorX: .5, anchorY: 0},
            noOpacity: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            defaults: {state: "ClosedDoor", layout: "left"},
            actionConfig: {NextState: {action: "NextState", title: "OpenClose", ownerCheck: !0}},
            stateConfig: {ClosedDoor: {nextState: "OpenDoor"}, OpenDoor: {nextState: "ClosedDoor"}},
            layouts: {
                left: {
                    states: {
                        ClosedDoor: {body: {frame: 5, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 4, anchorX: .6, anchorY: .1}}
                    }
                },
                right: {
                    states: {
                        ClosedDoor: {body: {frame: 4, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 5, anchorX: .4, anchorY: .1}}
                    }
                }
            }
        },
        IronDoor: {
            name: "Iron door",
            tileAlign: {anchorX: .5, anchorY: 0},
            noOpacity: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            defaults: {state: "ClosedDoor", layout: "left"},
            actionConfig: {NextState: {action: "NextState", title: "OpenClose", ownerCheck: !0}},
            stateConfig: {ClosedDoor: {nextState: "OpenDoor"}, OpenDoor: {nextState: "ClosedDoor"}},
            layouts: {
                left: {
                    states: {
                        ClosedDoor: {body: {frame: 5, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 4, anchorX: .6, anchorY: .1}}
                    }
                },
                right: {
                    states: {
                        ClosedDoor: {body: {frame: 4, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 5, anchorX: .4, anchorY: .1}}
                    }
                }
            }
        },
        WoodenWallSection: {
            name: "Wooden wall section",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "WoodenWall", layout: "left"}, {
                        typeName: "WoodenWall",
                        layout: "left",
                        anchorX: -.5,
                        anchorY: -.5
                    }, {typeName: "WoodenWall", layout: "left", anchorX: .5, anchorY: .5}]
                },
                right: {
                    section: [{typeName: "WoodenWall", layout: "right"}, {
                        typeName: "WoodenWall",
                        layout: "right",
                        anchorX: -.5,
                        anchorY: .5
                    }, {typeName: "WoodenWall", layout: "right", anchorX: .5, anchorY: -.5}]
                }
            }
        },
        WoodenDoorwaySection: {
            name: "Wooden doorway section",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "WoodenDoorway", layout: "left"}, {
                        typeName: "WoodenWall",
                        layout: "left",
                        anchorX: -.5,
                        anchorY: -.5
                    }, {typeName: "WoodenWall", layout: "left", anchorX: .5, anchorY: .5}]
                },
                right: {
                    section: [{typeName: "WoodenDoorway", layout: "right"}, {
                        typeName: "WoodenWall",
                        layout: "right",
                        anchorX: -.5,
                        anchorY: .5
                    }, {typeName: "WoodenWall", layout: "right", anchorX: .5, anchorY: -.5}]
                }
            }
        },
        WoodenWindowSection: {
            name: "Wooden window section",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "WoodenWindow", layout: "left"}, {
                        typeName: "WoodenWall",
                        layout: "left",
                        anchorX: -.5,
                        anchorY: -.5
                    }, {typeName: "WoodenWall", layout: "left", anchorX: .5, anchorY: .5}]
                },
                right: {
                    section: [{typeName: "WoodenWindow", layout: "right"}, {
                        typeName: "WoodenWall",
                        layout: "right",
                        anchorX: -.5,
                        anchorY: .5
                    }, {typeName: "WoodenWall", layout: "right", anchorX: .5, anchorY: -.5}]
                }
            }
        },
        WoodenFoundation: {
            name: "Wooden Foundation",
            tileAlign: {anchorX: .5, anchorY: .5},
            simpleObject: !0,
            ground: !0
        },
        WoodenCeiling: {name: "Wooden Ceiling", tileAlign: {anchorX: .5, anchorY: .5}, simpleObject: !0},
        WoodenRoof: {
            name: "Wooden Roof",
            tileAlign: {anchorX: .5, anchorY: .5},
            simpleObject: !0,
            defaults: {layout: "leftNear"},
            layouts: {
                leftNear: {},
                leftNearUp: {},
                leftCenter: {},
                leftCenterUp: {},
                leftCenterSeparate: {},
                leftDistant: {},
                leftDistantUp: {},
                leftDistantSeparate: {}
            }
        },
        PavedGround: {name: "Paved Ground", tileAlign: {anchorX: .5, anchorY: .5}, simpleObject: !0, ground: !0},
        PloughedGround: {name: "Ploughed Ground", tileAlign: {anchorX: .5, anchorY: 0}},
        WoodenFence: {
            name: "Wooden fence",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 1, anchorX: 1, anchorY: 1}},
                right: {body: {frame: 0, anchorX: 0, anchorY: 1}}
            }
        },
        WoodenFenceSection: {
            name: "Wooden fence section",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "WoodenFence", layout: "left"}, {
                        typeName: "WoodenFence",
                        layout: "left",
                        anchorX: -.5,
                        anchorY: -.5
                    }, {typeName: "WoodenFence", layout: "left", anchorX: .5, anchorY: .5}]
                },
                right: {
                    section: [{typeName: "WoodenFence", layout: "right"}, {
                        typeName: "WoodenFence",
                        layout: "right",
                        anchorX: -.5,
                        anchorY: .5
                    }, {typeName: "WoodenFence", layout: "right", anchorX: .5, anchorY: -.5}]
                }
            }
        },
        FenceGate: {
            name: "Fence gate",
            tileAlign: {anchorX: .5, anchorY: 0},
            noOpacity: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !1},
            defaults: {state: "ClosedDoor", layout: "leftUp"},
            actionConfig: {NextState: {action: "NextState", title: "OpenClose", ownerCheck: !0}},
            stateConfig: {ClosedDoor: {nextState: "OpenDoor"}, OpenDoor: {nextState: "ClosedDoor"}},
            layouts: {
                leftUp: {
                    states: {
                        ClosedDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}}
                    }
                },
                leftDown: {
                    states: {
                        ClosedDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 0, anchorX: 0, anchorY: -1}}
                    }
                },
                rightUp: {
                    states: {
                        ClosedDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}}
                    }
                },
                rightDown: {
                    states: {
                        ClosedDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 1, anchorX: 1, anchorY: -1}}
                    }
                }
            }
        },
        FenceGateSection: {
            name: "Fence gate section",
            tileAlign: {anchorX: .5, anchorY: 0},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "FenceGate", layout: "leftUp"}, {
                        typeName: "FenceGate",
                        layout: "leftDown",
                        anchorX: .5,
                        anchorY: .5
                    }]
                },
                right: {
                    section: [{typeName: "FenceGate", layout: "rightUp"}, {
                        typeName: "FenceGate",
                        layout: "rightDown",
                        anchorX: -.5,
                        anchorY: .5
                    }]
                }
            }
        },
        Palisade: {
            name: "Palisade",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 1, anchorX: 1, anchorY: 1}},
                right: {body: {frame: 0, anchorX: 0, anchorY: 1}}
            }
        },
        PalisadeSection: {
            name: "Palisade section",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "Palisade", layout: "left"}, {
                        typeName: "Palisade",
                        layout: "left",
                        anchorX: -.5,
                        anchorY: -.5
                    }, {typeName: "Palisade", layout: "left", anchorX: .5, anchorY: .5}]
                },
                right: {
                    section: [{typeName: "Palisade", layout: "right"}, {
                        typeName: "Palisade",
                        layout: "right",
                        anchorX: -.5,
                        anchorY: .5
                    }, {typeName: "Palisade", layout: "right", anchorX: .5, anchorY: -.5}]
                }
            }
        },
        PalisadeGate: {
            name: "Palisade gate",
            tileAlign: {anchorX: .5, anchorY: 0},
            noOpacity: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            defaults: {state: "ClosedDoor", layout: "leftUp"},
            actionConfig: {NextState: {action: "NextState", title: "OpenClose", ownerCheck: !0}},
            stateConfig: {ClosedDoor: {nextState: "OpenDoor"}, OpenDoor: {nextState: "ClosedDoor"}},
            layouts: {
                leftUp: {
                    states: {
                        ClosedDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}}
                    }
                },
                leftDown: {
                    states: {
                        ClosedDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 0, anchorX: 0, anchorY: -1}}
                    }
                },
                rightUp: {
                    states: {
                        ClosedDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}}
                    }
                },
                rightDown: {
                    states: {
                        ClosedDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 1, anchorX: 1, anchorY: -1}}
                    }
                }
            }
        },
        PalisadeGateSection: {
            name: "Palisade gate section",
            tileAlign: {anchorX: .5, anchorY: 0},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "PalisadeGate", layout: "leftUp"}, {
                        typeName: "PalisadeGate",
                        layout: "leftDown",
                        anchorX: .5,
                        anchorY: .5
                    }]
                },
                right: {
                    section: [{typeName: "PalisadeGate", layout: "rightUp"}, {
                        typeName: "PalisadeGate",
                        layout: "rightDown",
                        anchorX: -.5,
                        anchorY: .5
                    }]
                }
            }
        },
        IronedGate: {
            name: "Iron gate",
            tileAlign: {anchorX: .5, anchorY: 0},
            noOpacity: !1,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !0},
            defaults: {state: "ClosedDoor", layout: "leftUp"},
            actionConfig: {NextState: {action: "NextState", title: "OpenClose", ownerCheck: !0}},
            stateConfig: {ClosedDoor: {nextState: "OpenDoor"}, OpenDoor: {nextState: "ClosedDoor"}},
            layouts: {
                leftUp: {
                    states: {
                        ClosedDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}}
                    }
                },
                leftDown: {
                    states: {
                        ClosedDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}},
                        OpenDoor: {body: {frame: 0, anchorX: 0, anchorY: -1}}
                    }
                },
                rightUp: {
                    states: {
                        ClosedDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 1, anchorX: 0, anchorY: 0}}
                    }
                },
                rightDown: {
                    states: {
                        ClosedDoor: {body: {frame: 0, anchorX: 1, anchorY: 0}},
                        OpenDoor: {body: {frame: 1, anchorX: 1, anchorY: -1}}
                    }
                }
            }
        },
        IronedGateSection: {
            name: "Iron gate section",
            tileAlign: {anchorX: .5, anchorY: 0},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "IronedGate", layout: "leftUp"}, {
                        typeName: "IronedGate",
                        layout: "leftDown",
                        anchorX: .5,
                        anchorY: .5
                    }]
                },
                right: {
                    section: [{typeName: "IronedGate", layout: "rightUp"}, {
                        typeName: "IronedGate",
                        layout: "rightDown",
                        anchorX: -.5,
                        anchorY: .5
                    }]
                }
            }
        },
        Campfire: {
            name: "Campfire",
            body: {shape: "circle48", moveBlock: !0},
            tool: {interval: 15e3, resources: {Wood: {amount: 1}}},
            sources: {slots: 3},
            resources: {slots: 3},
            products: {slots: 6},
            defaults: {state: "Normal"},
            actionConfig: {
                Fire: {action: "NextState", title: "Fire", onState: "Normal"},
                Extinguish: {action: "NextState", title: "Extinguish", onState: "Production"},
                OpenContainer: {action: "OpenContainer", title: "Open"}
            },
            stateConfig: {Normal: {nextState: "Production"}, Production: {nextState: "Normal", animation: "SmallFire"}}
        },
        SmallWoodenBox: {
            name: "Small Wooden Box",
            body: {shape: "circle32", moveBlock: !0},
            slots: 4,
            actionConfig: {OpenContainer: {action: "OpenContainer", title: "Open"}}
        },
        Well: {name: "Well", body: {shape: "circle32", moveBlock: !0}},
        Bed: {
            name: "Bed",
            tileAlign: {anchorX: .5, anchorY: 0},
            body: {shape: "tileOneAndHalf", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 0, anchorX: .4, anchorY: 0}},
                right: {body: {frame: 1, anchorX: .6, anchorY: 0}}
            }
        },
        Cupboard: {
            name: "Cupboard",
            tileAlign: {anchorX: .5, anchorY: .5},
            body: {shape: "structureShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 12, anchorX: .35, anchorY: -.15}},
                right: {body: {frame: 13, anchorX: .35, anchorY: .1}}
            },
            slots: 10,
            actionConfig: {OpenContainer: {action: "OpenContainer", title: "Open"}}
        },
        DryingFrame: {
            name: "Drying Frame",
            tileAlign: {anchorX: .5, anchorY: 0},
            body: {shape: "tileOneAndHalfThin", moveBlock: !0, viewBlock: !1},
            tool: {interval: 15e3, resources: !1},
            sources: {slots: 3},
            products: {slots: 6},
            resources: !1,
            defaults: {layout: "left", state: "Normal"},
            actionConfig: {
                NextState: {action: "NextState", title: "NextState"},
                OpenContainer: {action: "OpenContainer", title: "Open"}
            },
            stateConfig: {
                Normal: {nextState: "Production"},
                Production: {nextState: "Complete"},
                Complete: {nextState: "Normal"}
            },
            layouts: {
                left: {
                    body: {frame: 0, anchorX: .09, anchorY: 0},
                    states: {Normal: {}, Production: {}, Complete: {}}
                },
                right: {body: {frame: 1, anchorX: .91, anchorY: 0}, states: {Normal: {}, Production: {}, Complete: {}}}
            }
        },
        Oven: {
            name: "Oven",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            actionConfig: {
                Fire: {action: "NextState", title: "Fire", onState: "Normal"},
                Extinguish: {action: "NextState", title: "Extinguish", onState: "Production"},
                OpenContainer: {action: "OpenContainer", title: "Open"}
            },
            stateConfig: {Normal: {nextState: "Production"}, Production: {nextState: "Normal"}},
            layouts: {
                leftUp: {
                    states: {
                        Normal: {frame: 0, anchorX: .1, anchorY: .95},
                        Production: {frame: 0, anchorX: .1, anchorY: .95}
                    }
                },
                leftDown: {
                    states: {
                        Normal: {frame: 0, anchorX: .1, anchorY: .95},
                        Production: {frame: 0, anchorX: .1, anchorY: .95}
                    }
                },
                rightUp: {
                    states: {
                        Normal: {frame: 0, anchorX: .1, anchorY: .95},
                        Production: {frame: 0, anchorX: .1, anchorY: .95}
                    }
                },
                rightDown: {
                    states: {
                        Normal: {frame: 0, anchorX: .1, anchorY: .95},
                        Production: {frame: 0, anchorX: .1, anchorY: .95}
                    }
                }
            }
        },
        OvenComplex: {
            name: "Oven Full",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "Oven", layout: "leftUp"}, {
                        typeName: "Oven",
                        layout: "leftDown",
                        anchorX: .5,
                        anchorY: .5
                    }]
                },
                right: {
                    section: [{typeName: "Oven", layout: "rightUp"}, {
                        typeName: "Oven",
                        layout: "rightDown",
                        anchorX: .5,
                        anchorY: -.5
                    }]
                }
            }
        },
        Smelter: {
            name: "Smelter",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            actionConfig: {
                Fire: {action: "NextState", title: "Fire", onState: "Normal"},
                Extinguish: {action: "NextState", title: "Extinguish", onState: "Production"},
                OpenContainer: {action: "OpenContainer", title: "Open"}
            },
            stateConfig: {Normal: {nextState: "Production"}, Production: {nextState: "Normal"}},
            layouts: {
                left1: {
                    states: {
                        Normal: {frame: 12, anchorX: 1, anchorY: 1},
                        Production: {frame: 4, anchorX: 1, anchorY: 1}
                    }
                },
                left2: {
                    states: {
                        Normal: {frame: 13, anchorX: 1, anchorY: 1},
                        Production: {frame: 5, anchorX: 1, anchorY: 1}
                    }
                },
                left3: {
                    states: {
                        Normal: {frame: 14, anchorX: 1, anchorY: 1},
                        Production: {frame: 6, anchorX: 1, anchorY: 1}
                    }
                },
                left4: {
                    states: {
                        Normal: {frame: 15, anchorX: 1, anchorY: 1},
                        Production: {frame: 7, anchorX: 1, anchorY: 1}
                    }
                },
                right1: {
                    states: {
                        Normal: {frame: 16, anchorX: 1, anchorY: 1},
                        Production: {frame: 8, anchorX: 1, anchorY: 1}
                    }
                },
                right2: {
                    states: {
                        Normal: {frame: 17, anchorX: 1, anchorY: 1},
                        Production: {frame: 9, anchorX: 1, anchorY: 1}
                    }
                },
                right3: {
                    states: {
                        Normal: {frame: 18, anchorX: 1, anchorY: 1},
                        Production: {frame: 10, anchorX: 1, anchorY: 1}
                    }
                },
                right4: {
                    states: {
                        Normal: {frame: 19, anchorX: 1, anchorY: 1},
                        Production: {frame: 11, anchorX: 1, anchorY: 1}
                    }
                }
            }
        },
        SmelterComplex: {
            name: "Smelter Full",
            tileAlign: {anchorX: .5, anchorY: 1},
            defaults: {layout: "left"},
            layouts: {
                left: {
                    section: [{typeName: "Smelter", layout: "left1"}, {
                        typeName: "Smelter",
                        layout: "left2",
                        anchorX: .5,
                        anchorY: .5
                    }, {typeName: "Smelter", layout: "left3", anchorX: 0, anchorY: 0}, {
                        typeName: "Smelter",
                        layout: "left4",
                        anchorX: .5,
                        anchorY: .5
                    }]
                },
                right: {
                    section: [{typeName: "Smelter", layout: "right1"}, {
                        typeName: "Smelter",
                        layout: "right2",
                        anchorX: .5,
                        anchorY: -.5
                    }, {typeName: "Smelter", layout: "right3", anchorX: 0, anchorY: 0}, {
                        typeName: "Smelter",
                        layout: "right4",
                        anchorX: .5,
                        anchorY: -.5
                    }]
                }
            }
        },
        LargeChest: {
            name: "Large Chest",
            tileAlign: {anchorX: .5, anchorY: .5},
            body: {shape: "structureShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 2, anchorX: .4, anchorY: .2}},
                right: {body: {frame: 3, anchorX: .4, anchorY: .4}}
            }
        },
        WoodenTable: {
            name: "Wooden Table",
            tileAlign: {anchorX: .5, anchorY: .5},
            body: {shape: "structureShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 10, anchorX: .4, anchorY: .2}},
                right: {body: {frame: 11, anchorX: .4, anchorY: .4}}
            }
        },
        WorkBench: {
            name: "Workbench",
            tileAlign: {anchorX: .5, anchorY: .5},
            body: {shape: "structureShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 2, anchorX: .4, anchorY: .2}},
                right: {body: {frame: 3, anchorX: .4, anchorY: .4}}
            }
        },
        WoodenChair: {
            name: "Wooden Chair",
            tileAlign: {anchorX: .5, anchorY: 1},
            simpleObject: !0,
            body: {shape: "wallsDoorsShapes", moveBlock: !0, viewBlock: !1},
            defaults: {layout: "left"},
            layouts: {
                left: {body: {frame: 0, anchorX: .9, anchorY: .95}},
                right: {body: {frame: 1, anchorX: .1, anchorY: .95}}
            }
        },
        StoneAnvil: {name: "Stone Anvil", body: {shape: "circle32", moveBlock: !0}},
        IronAnvil: {name: "Iron Anvil", body: {shape: "circle32", moveBlock: !0}},
        WoodenFenceGateExample: {
            defaults: {
                state: "Close",
                position: "Left",
                properties: {
                    name: "Wooden gate",
                    noOpacity: !0,
                    tileAlign: {anchorX: .5, anchorY: 1},
                    body: {shape: "wallsDoorsShapes", frame: 1, moveBlock: !0, viewBlock: !0, anchorX: .9, anchorY: .95}
                }
            },
            stateConfig: {Close: {title: "Close"}, Open: {title: "Open"}, stateChangeBehavior: "cycle"},
            positionConfig: {
                Left: {
                    Open: {body: {frame: 0, anchorX: 1.55, anchorY: .95}},
                    Close: {body: {frame: 1, anchorX: .9, anchorY: .95}}
                },
                Right: {
                    Open: {body: {frame: 1, anchorX: .1, anchorY: .83}},
                    Close: {body: {frame: 0, anchorX: .1, anchorY: .95}}
                }
            }
        }
    }
}),define("KME/data/world/BuildTypes", [], function () {
    KME.types.buildTypes = {
        tree: [{
            name: "Survival",
            children: [{
                typeName: "Campfire",
                resources: {Wood: {amount: 3}, Stone: {amount: 3}},
                buildTime: 5e3
            }, {typeName: "WoodenCabinComplex"}, {
                typeName: "WoodenDoor",
                resources: {Wood: {amount: 10}},
                buildTime: 4e3
            }, {typeName: "SmallWoodenBox", resources: {Wood: {amount: 5}}, buildTime: 5e3}]
        }, {
            name: "Ground works",
            children: [{
                typeName: "PavedGround",
                resources: {Stone: {amount: 2}},
                buildTime: 5e3
            }, {typeName: "PloughedGround", resources: {}, buildTime: 5e3}]
        }, {
            name: "Structures",
            children: [{typeName: "LargeChest", resources: {Wood: {amount: 1}}}, {
                typeName: "WorkBench",
                resources: {Wood: {amount: 1}}
            }, {typeName: "StoneAnvil", resources: {Wood: {amount: 1}}}, {
                typeName: "IronAnvil",
                resources: {Wood: {amount: 1}}
            }, {typeName: "WoodenChair", resources: {Wood: {amount: 1}}}, {
                typeName: "WoodenTable",
                resources: {Wood: {amount: 1}}
            }, {typeName: "Smelter", resources: {Wood: {amount: 1}}}, {
                typeName: "Oven",
                resources: {Wood: {amount: 1}}
            }, {typeName: "DryingFrame", resources: {Wood: {amount: 1}}}, {
                typeName: "Well",
                resources: {Wood: {amount: 1}}
            }, {typeName: "Bed", resources: {Wood: {amount: 1}}}, {
                typeName: "Cupboard",
                resources: {Wood: {amount: 1}}
            }]
        }, {
            name: "Houses",
            children: [{
                name: "Wooden",
                children: [{typeName: "WoodenFoundationSection"}, {typeName: "WoodenWallSection"}, {typeName: "WoodenDoorwaySection"}, {typeName: "WoodenWindowSection"}, {typeName: "WoodenCeilingSection"}, {typeName: "WoodenRoofSection"}, {
                    typeName: "WoodenIronedDoor",
                    resources: {Wood: {amount: 1}}
                }, {typeName: "IronDoor", resources: {Wood: {amount: 1}}}, {
                    name: "Small parts",
                    children: [{
                        typeName: "WoodenWall",
                        resources: {Wood: {amount: 10}},
                        buildTime: 2e3
                    }, {
                        typeName: "WoodenDoorway",
                        resources: {Wood: {amount: 6}},
                        buildTime: 2e3
                    }, {typeName: "WoodenWindow", resources: {Wood: {amount: 8}}, buildTime: 2e3}, {
                        typeName: "WoodenRoof",
                        resources: {Wood: {amount: 7}},
                        buildTime: 2e3
                    }, {
                        typeName: "WoodenFoundation",
                        resources: {Wood: {amount: 5}},
                        buildTime: 2e3
                    }, {typeName: "WoodenCeiling", resources: {Wood: {amount: 5}}, buildTime: 2e3}]
                }]
            }]
        }, {
            name: "Fences",
            children: [{
                name: "Wooden",
                children: [{typeName: "WoodenFence", resources: {Wood: {amount: 1}}}, {typeName: "WoodenFenceSection"}]
            }, {
                name: "Palisade",
                children: [{typeName: "Palisade", resources: {Wood: {amount: 1}}}, {typeName: "PalisadeSection"}]
            }, {
                name: "Gates",
                children: [{
                    typeName: "FenceGate",
                    resources: {Wood: {amount: 1}}
                }, {typeName: "FenceGateSection"}, {
                    typeName: "PalisadeGate",
                    resources: {Wood: {amount: 1}}
                }, {typeName: "PalisadeGateSection"}, {
                    typeName: "IronedGate",
                    resources: {Wood: {amount: 1}}
                }, {typeName: "IronedGateSection"}]
            }]
        }]
    }
}),define("KME/data/items/ItemTypes", [], function () {
    KME.types.itemTypes = {
        tools: {hatchet: "hatchet", knife: "knife", pickaxe: "pickaxe"},
        Hands: {
            name: "Hands",
            noDrop: !0,
            noInventory: !0,
            attack: {
                damage: 5,
                range: 0,
                startRange: 16,
                delayBefore: 200,
                delay: 700,
                splash: !1,
                shape: {name: "circle32", rotate: !1, anchorX: .5, anchorY: .5}
            },
            gatherBaseAmount: 1,
            gatherAddAmount: 1
        },
        StoneAxe: {
            name: "Stone Axe",
            attack: {
                damage: 10,
                range: 0,
                startRange: 16,
                delayBefore: 200,
                delay: 700,
                splash: !1,
                shape: {name: "arc64", rotate: !0, anchorX: .5, anchorY: .5}
            },
            gatherBaseAmount: 3,
            gatherAddAmount: 2,
            bonus: {bonusName: "hatchet", bonusValue: .5}
        },
        Bow: {
            name: "Bow",
            attack: {
                damage: 20,
                range: 500,
                startRange: 8,
                delayBefore: 300,
                delay: 1200,
                splash: !1,
                play: "bowShoot",
                projectile: {atlas: "ArrowProjectile", speed: 10, shape: "bar8", rotate: !0, anchorX: .5, anchorY: .5},
                ammo: {typeName: "StoneTippedArrow"}
            }
        },
        StoneKnife: {
            name: "Stone knife",
            attack: {
                damage: 7,
                range: 0,
                startRange: 16,
                delayBefore: 200,
                delay: 500,
                splash: !1,
                shape: {name: "circle32", rotate: !1, anchorX: .5, anchorY: .5}
            },
            gatherBaseAmount: 2,
            gatherAddAmount: 2,
            bonus: {bonusName: "knife", bonusValue: .5}
        },
        HideSling: {
            name: "Primitive sling",
            attack: {
                damage: 10,
                range: 400,
                startRange: 8,
                delayBefore: 200,
                delay: 1e3,
                splash: !1,
                play: "bowShoot",
                projectile: {
                    atlas: "StoneProjectile",
                    speed: 8,
                    shape: "circle8",
                    rotate: !1,
                    anchorX: .5,
                    anchorY: .5
                },
                ammo: {typeName: "Stone"}
            }
        },
        IronSword: {
            name: "Iron sword",
            attack: {
                damage: 25,
                range: 0,
                startRange: 16,
                delayBefore: 200,
                delay: 1500,
                splash: !0,
                shape: {name: "arc64", rotate: !0, anchorX: .5, anchorY: .5}
            }
        },
        IronShield: {name: "Iron shield"},
        IronAxe: {
            name: "Iron axe",
            attack: {
                damage: 20,
                range: 0,
                startRange: 16,
                delayBefore: 200,
                delay: 1500,
                splash: !1,
                shape: {name: "arc64", rotate: !0, anchorX: .5, anchorY: .5}
            },
            bonus: {bonusName: "hatchet", bonusValue: 1}
        },
        IronKnife: {
            name: "Iron knife",
            attack: {
                damage: 15,
                range: 0,
                startRange: 16,
                delayBefore: 200,
                delay: 1e3,
                splash: !1,
                shape: {name: "circle32", rotate: !1, anchorX: .5, anchorY: .5}
            },
            bonus: {bonusName: "knife", bonusValue: 1}
        },
        IronPickaxe: {
            name: "Iron pickaxe",
            attack: {
                damage: 30,
                range: 0,
                startRange: 16,
                delayBefore: 500,
                delay: 2e3,
                splash: !1,
                shape: {name: "circle32", rotate: !1, anchorX: .5, anchorY: .5}
            },
            bonus: {bonusName: "pickaxe", bonusValue: 1}
        },
        LightSaber: {
            name: "Lightsaber",
            attack: {
                damage: 300,
                range: 0,
                startRange: 16,
                delayBefore: 100,
                delay: 200,
                splash: !0,
                shape: {name: "arc64", rotate: !0, anchorX: .5, anchorY: .5}
            }
        },
        WoodenShovel: {name: "Woonden shovel", bonus: {bonusName: "shovel", bonusValue: .5}},
        IronSaw: {name: "Iron saw", bonus: {bonusName: "saw", bonusValue: 1}},
        IronShovel: {name: "Iron shovel", bonus: {bonusName: "shovel", bonusValue: 1}},
        StoneHammer: {name: "Stone hammer", bonus: {bonusName: "hammer", bonusValue: .5}},
        IronHammer: {name: "Smith's hammer", bonus: {bonusName: "hammer", bonusValue: 1}},
        Flour: {name: "Flour", max: 50},
        Wood: {name: "Wood", max: 50},
        IronOre: {name: "Iron Ore", max: 50},
        Stone: {
            name: "Stone",
            max: 50,
            attack: {
                damage: 3,
                range: 300,
                startRange: 8,
                delayBefore: 200,
                delay: 500,
                splash: !1,
                projectile: {
                    atlas: "StoneProjectile",
                    speed: 7,
                    shape: "circle8",
                    rotate: !1,
                    anchorX: .5,
                    anchorY: .5
                },
                ammo: {typeName: "Stone"}
            }
        },
        Meat: {name: "Raw meat", max: 50},
        RawHide: {name: "Raw hide", max: 50},
        Hide: {name: "Hide", max: 50},
        IronIngot: {name: "Iron ingot", max: 50},
        Dough: {name: "Dough", max: 50},
        WoodenBucketWater: {name: "Water", max: 50},
        ClothCap: {name: "Cloth cap"},
        ClothVest: {name: "Cloth vest"},
        ClothTrousers: {name: "Cloth trousers"},
        ClothSandals: {name: "Cloth sandals"},
        RawHideCap: {name: "Raw hide cap", bonus: {bonusName: "armor", bonusValue: 5}},
        RawHideVest: {name: "Raw hide vest", bonus: {bonusName: "armor", bonusValue: 5}},
        RawHideLoincloth: {name: "Raw hide loincloth", bonus: {bonusName: "armor", bonusValue: 5}},
        RawHideBoots: {name: "Raw hide boots", bonus: {bonusName: "armor", bonusValue: 5}},
        HideHelmet: {name: "Hide helmet"},
        HideJacket: {name: "Hide jacket"},
        HidePants: {name: "Hide rants"},
        HideBoots: {name: "Hide boots"},
        IronHelmet: {name: "Iron helmet"},
        IronCuirass: {name: "Iron cuirass"},
        IronLeggings: {name: "Iron leggings"},
        IronGreaves: {name: "Iron greaves"},
        Torch: {name: "Torch"},
        WomanCutHead: {name: "Head of a woman"},
        ManCutHead: {name: "Head of a man"},
        RoastMeat: {name: "Roast meat", max: 50},
        GrainWheat: {name: "Grain wheat"},
        Carrot: {name: "Carrot"},
        Bannock: {name: "Bannock"},
        WoodenSpear: {
            name: "Wooden spear",
            max: 50,
            attack: {
                damage: 10,
                range: 200,
                startRange: 0,
                delayBefore: 200,
                delay: 1500,
                splash: !1,
                projectile: {atlas: "SpearProjectile", speed: 5, shape: "bar32", rotate: !0, anchorX: .5, anchorY: .5},
                ammo: {typeName: "WoodenSpear"}
            }
        },
        Bandage: {name: "Bandage", max: 50},
        StoneTippedArrow: {name: "Stone-tipped arrow", max: 50}
    }
}),define("KME/data/items/CraftTypes", [], function () {
    KME.types.craftTypes = {
        tree: [{
            name: "Survival",
            children: [{typeName: "StoneAxe", resources: {Stone: {amount: 1}, Wood: {amount: 1}}}, {
                typeName: "WoodenSpear",
                resources: {Wood: {amount: 2}}
            }, {typeName: "Bow", resources: {Wood: {amount: 5}, RawHide: {amount: 3}}}, {
                typeName: "StoneTippedArrow",
                resources: {Stone: {amount: 1}, Wood: {amount: 1}}
            }]
        }]
    }
}),define("KME/controllers/network/offline/Listeners", ["KME/data/world/WorldTypes", "KME/data/world/BuildTypes", "KME/data/items/ItemTypes", "KME/data/items/CraftTypes", "KME/states/Game"], function () {
    var a, b, c = {
        connect: function () {
            console.log("Offline connected"), b.state.start("Preloader")
        }, startPlayer: function (b) {
            console.log("startPlayer offline", b), a.createGameOffline(b)
        }, characterMoveTo: function (b) {
            a.characterMoveTo(b)
        }
    };
    return {
        init: function () {
            a = KME.game.state.states.Game, b = KME.game.state.states.Connector, c.connect()
        }, _: c
    }
}),define("KME/controllers/network/offline/OfflineController", ["require", "./Listeners"], function (a) {
    var b;
    return {
        init: function () {
            b = a("./Listeners")
        }, gameStart: function () {
            var a = {
                id: 1,
                typeName: "Player",
                name: "Tester",
                health: 60,
                stamina: 100,
                effects: {globalTimeBonus: 1, saw: 2},
                bonuses: {shovel: 3, armor: 4, pickaxe: 5},
                wear: {
                    items: [{typeName: "Hands", position: "rightHand", id: 111}, {
                        typeName: "ClothCap",
                        position: "head",
                        id: 112
                    }, {typeName: "ClothVest", position: "body", id: 113}, {
                        typeName: "ClothTrousers",
                        position: "legs",
                        id: 114
                    }, {typeName: "ClothSandals", position: "foots", id: 115}]
                },
                inventory: {
                    items: [{typeName: "StoneAxe", position: 1, id: 116}, {
                        typeName: "Bow",
                        position: 2,
                        id: 117
                    }, {typeName: "Torch", position: 3, id: 118}, {
                        typeName: "Bandage",
                        position: 4,
                        id: 119,
                        amount: 5
                    }, {typeName: "Wood", position: 5, id: 120, amount: 5}, {
                        typeName: "Stone",
                        position: 6,
                        id: 121,
                        amount: 5
                    }, {typeName: "Meat", position: 7, id: 122, amount: 5}, {
                        typeName: "StoneTippedArrow",
                        position: 10,
                        id: 125,
                        amount: 5
                    }]
                },
                toolbar: {items: [], ref: {rightHand: 3}}
            };
            b._.startPlayer(a)
        }, playerMoveTo: function (a, c, d, e) {
            b._.characterMoveTo({x: a, y: c, fromX: d, fromY: e, id: 1})
        }, playerPositionUpdate: function () {
        },
        playerStop: function () {
        }
    }
}),define("KME/controllers/network/online/RequestsController", ["jquery"], function (a) {
    function b(a) {
        return window.WILDTERRA_HOST && (a = "http://" + window.WILDTERRA_HOST + ":" + window.WILDTERRA_PORT + a + "?a=b"), a
    }

    function c(b, c, d) {
        a.ajax({
            headers: {Authorization: "Bearer " + window.TOKEN}, beforeSend: function (a) {
                a.setRequestHeader("Authorization", "Bearer " + window.TOKEN)
            }, url: b, xhrFields: {withCredentials: !0}, dataType: "json"
        }).done(function (a) {
            c(a)
        }).fail(function (a) {
            d && d(a)
        })
    }

    return {
        init: function () {
        }, requestTypes: function (a) {
            var d = b(KME.commands.requestCommands.requestTypes);
            c(d, a)
        }, requestTileSets: function (a) {
            var d = b(KME.commands.requestCommands.requestTilesets);
            c(d, a)
        }, checkPlayerName: function (a, d, e) {
            var f = b(KME.commands.requestCommands.checkPlayerName) + "&name=" + a + "&gender=" + d + "&domain=" + window.location.hostname;
            c(f, e)
        }, requestMapSettings: function (a) {
            var d = b(KME.commands.requestCommands.requestMapSettings);
            c(d, a)
        }, requestUser: function (a, d) {
            var e = b("/api/v1/user/status");
            c(e, a, d)
        }, requestPaymentToken: function (b, c) {
            var d = window.WILDTERRA_PAYMENTS_API + "xsolla/getToken/ingame?a=b";
            a.ajax({
                type: "POST",
                headers: {Authorization: "Bearer " + window.TOKEN},
                beforeSend: function (a) {
                    a.setRequestHeader("Authorization", "Bearer " + window.TOKEN)
                },
                url: d,
                xhrFields: {withCredentials: !0},
                dataType: "json",
                data: {
                    currency: window.XSOLLA_CURRENCY,
                    language: window.XSOLLA_LANGUAGE,
                    email: window.USER.local.email,
                    ui: {theme: "dark", components: {virtual_items: {selected_group: "schemes"}}},
                    custom_parameters: {visitor: window.USER.local.id, dark: !0}
                }
            }).done(function (a) {
                a.token ? b(a.token) : console.error("Error on token request")
            }).fail(function (a) {
                c && c(a)
            })
        }
    }
}),define("KME/controllers/network/NetworkController", ["require", "./socket/Listeners", "./socket/SocketController", "./offline/Listeners", "./offline/OfflineController", "./online/RequestsController", "../data/DataController"], function (a) {
    return KME.commands = {
        serverCommands: {
            sendMessage: "sendMessage",
            sendAchievement: "sendAchievement",
            playerClusterUpdate: "playerClusterUpdate",
            characterExitCluster: "characterExitCluster",
            characterEnterCluster: "characterEnterCluster",
            characterSetTarget: "characterSetTarget",
            characterMoveTo: "characterMoveTo",
            characterStop: "characterStop",
            characterUpdateCake: "characterUpdateCake",
            characterTitleChange: "characterTitleChange",
            actionCharacter: "actionCharacter",
            worldSound: "worldSound",
            deathCharacter: "deathCharacter",
            reviveCharacter: "reviveCharacter",
            newWorldObjects: "newWorldObjects",
            removeWorldObject: "removeWorldObject",
            updateWorldObject: "updateWorldObject",
            updateContent: "updateContent",
            updateWorldTiles: "updateWorldTiles",
            partialUpdatePlayer: "partialUpdatePlayer",
            partialUpdatePlayerTypes: {wear: "wear", toolbar: "toolbar", bonuses: "bonuses", topbar: "topbar"},
            updatePlayerWithNewItems: "updatePlayerWithNewItems",
            updatePlayer: "updatePlayer"
        },
        clientCommands: {
            gameStart: "gameStart",
            harmWorldObjects: "harmWorldObjects",
            worldObjectUse: "worldObjectUse",
            demolishWorldObject: "demolishWorldObject",
            repairWorldObject: "repairWorldObject",
            craftItem: "craftItem",
            buildCheck: "buildCheck",
            buildWorldObject: "buildWorldObject",
            moveWorldObject: "moveWorldObject",
            upgradeWorldObject: "upgradeWorldObject",
            placeItemToWorld: "placeItemToWorld",
            playerNearUpdate: "playerNearUpdate",
            playerMobSee: "playerMobSee",
            playerMobRoomChange: "playerMobRoomChange",
            playerMobStop: "playerMobStop",
            playerNotice: "playerNotice",
            playerAction: "playerAction",
            playerShoot: "playerShoot",
            playerHit: "playerHit",
            playerStop: "playerStop",
            playerPositionUpdate: "playerPositionUpdate",
            playerSetTarget: "playerSetTarget",
            playerMoveTo: "playerMoveTo",
            playerMove: "playerMove",
            playerRevive: "playerRevive",
            playerSuicide: "playerSuicide",
            playerChangeTitle: "playerChangeTitle",
            playerSaveAccess: "playerSaveAccess",
            playerLoadAccess: "playerLoadAccess",
            dropItem: "dropItem",
            moveItemToHand: "moveItemToHand",
            bandageItem: "bandageItem",
            eatItem: "eatItem",
            summonItem: "summonItem",
            freeItem: "freeItem",
            splitItem: "splitItem",
            dressItem: "dressItem",
            undressItem: "undressItem",
            actionStore: "actionStore",
            actionDrop: "actionDrop",
            actionMove: "actionMove"
        },
        requestCommands: {
            checkPlayerName: "/api/v1/player/create",
            requestTilesets: "/api/v1/map/tilesets",
            requestMapSettings: "/api/v1/map/settings",
            requestTypes: "/api/v1/types"
        }
    }, {
        requests: a("./online/RequestsController"), requestInit: function () {
            this.requests.init()
        }, init: function () {
            this.listeners = a("undefined" == typeof io ? "./offline/Listeners" : "./socket/Listeners"), this.actions = a("undefined" == typeof io ? "./offline/OfflineController" : "./socket/SocketController"), this.listeners.init(), this.actions.init(), KME.controllers.data.init()
        }
    }
}),define("KME/states/Login", ["jquery", "modernizr", "KME/controllers/network/NetworkController"], function (a, b) {
    function c() {
        var a = document.getElementById("LoginBackground").style;
        a.background = "url(0.7/graphics/ui/loginBack" + Math.floor(4 * Math.random()) + ".jpg) no-repeat top center", a["-webkit-background-size"] = "cover", a["-moz-background-size"] = "cover", a["-o-background-size"] = "cover", a["background-size"] = "cover"
    }

    function d(b) {
        KME.controllers.network.requests.checkPlayerName(k.val(), a('input[name="GenderInput"]:checked').val(), function (c) {
            c.error ? j.text(a.t(c.error)) : (i.modal("hide"), window.playerName = k.val(), window.userId = c.userId, b.state.start("Boot"))
        })
    }

    function e(a, b, c) {
        g(a) ? f(a, b, c) : c("hashProblem")
    }

    function f(a, b, c) {
        KME.controllers.network.requests.requestUser(function (a) {
            a.err ? (delete window.userId, delete window.USER, c(a.err)) : a.user.canPlay ? (console.log("User status is:", a), window.userId = a.user._id, window.USER = a.user, b(a)) : (delete window.userId, delete window.USER, c("canPlay error"))
        }, function (a) {
            401 == a.status || 403 == a.status ? c(a.status) : "error" === a.statusText ? c("error") : b({})
        })
    }

    function g(a) {
        return a.server && a.port && a.access_token
    }

    function h() {
        for (var a, b = {}, c = /\+/g, d = /([^&;=]+)=?([^&;]*)/g, e = function (a) {
            return decodeURIComponent(a.replace(c, " "))
        }, f = window.location.hash.substring(1); a = d.exec(f);)b[e(a[1])] = e(a[2]);
        return b
    }

    a("#goldCount").hide();
    var i = a("#NameDialog"), j = a("#NameError"), k = a("#NicknameInput");
    KME.Login = function (a) {
        this.game = a
    }, KME.Login.prototype = {
        preload: function () {
            c()
        }, create: function () {
            a("title").text("Wild Terra Online: alpha version [0." + window.KME_VERSION + "]"), a.i18n.loadNamespaces(["messages", "interfaces"], function () {
                a("[data-i18n]").i18n()
            }), b.webgl ? this._initialize() : KME.sendError("interfaces:clientErrors.noWebGLSupport")
        }, _initialize: function () {
            var b = this, c = h();
            window.WILDTERRA_HOST = c.server, window.WILDTERRA_PORT = c.port, window.TOKEN = c.access_token, e(c, function (c) {
                a("#goldCount").html(), c.playerName ? (window.playerName = c.playerName, b.state.start("Boot")) : c.user ? i.length > 0 && (i.modal("show"), i.submit(function (a) {
                    a.preventDefault(), d(b)
                }), a("#NicknameFormPlay").click(function (a) {
                    a.preventDefault(), d(b)
                })) : KME.sendError("interfaces:serverErrors.serverLoading")
            }, function (a) {
                "hashProblem" === a ? window.redirectToAuthorization() : KME.sendError("$t(interfaces:serverErrors.connectError) " + a, 401 === a ? "toServers" : void 0)
            })
        }
    }
}),define("KME/states/Error", ["jquery", "i18next", "KME/controllers/network/NetworkController"], function (a) {
    var b = a("#ErrorDialog"), c = a("#ErrorText");
    KME.Error = function (a) {
        this.game = a
    }, KME.Error.prototype = {
        preload: function () {
        }, _toServerList: function () {
            window.redirectToAuthorization()
        }, _refresh: function () {
            "initGame" === window.errorMode ? window.location.reload() : "toServers" === window.errorMode ? this._toServerList() : this.state.start("Login")
        }, create: function () {
            a("[data-i18n]").i18n();
            var d = this;
            c.text(a.t(window.errorText)), b.modal("show"), b.submit(function (a) {
                a.preventDefault(), d._refresh()
            }), a("#ErrorSubmit").click(function (a) {
                a.preventDefault(), d._refresh()
            }), a("#ErrorCancel").click(function (a) {
                a.preventDefault(), d._toServerList()
            })
        }, shutdown: function () {
            b.modal("hide")
        }
    }
}),define("KME/states/Boot", ["jquery", "KME/controllers/network/NetworkController"], function (a) {
    KME.Boot = function (a) {
        this.game = a
    }, KME.Boot.prototype = {
        preload: function () {
            this.load.image("preloaderBar", "interfaces/preload/bar.png"), this.load.image("preloaderBackLogo", "interfaces/preload/backLogo.png")
        }, create: function () {
            this.game.gravity = 0, this.input.maxPointers = 1, this._setGameScale(), KME.controllers.network.requestInit(), this.state.start("Connector"), a("title").text("Wild Terra Online: alpha version [0." + window.KME_VERSION + "] - " + window.playerName)
        }, _setGameScale: function () {
            this.scale.scaleMode = Phaser.ScaleManager.RESIZE
        }
    }
}),define("KME/utils/AssetController", ["async"], function () {
    KME.AssetController = function (a) {
        this.game = a;
        var b = window.IS_PRODUCTION ? ".webp" : ".png", c = window.GRAPHICS_FULL_PRELOAD, d = window.WINTER_SEASON ? "winter/" : "";
        return this._static = {
            fogTexture: {file: "0.8/graphics/world/surfaces/fog.jpg"},
            soilDeepWaterTexture: {file: "0.8/graphics/world/surfaces/soilDeepWater.jpg"},
            soilWaterTexture: {file: "0.8/graphics/world/surfaces/soilWater.jpg"},
            soilTexture: {file: "0.8/graphics/world/surfaces/soil.jpg"},
            grassTexture: {file: "0.8/graphics/world/surfaces/grass.jpg"},
            snowSoilTexture: {file: "0.8/graphics/world/surfaces/snowSoil.jpg"},
            snowGrassTexture: {file: "0.8/graphics/world/surfaces/snowGrass.jpg"},
            frozenWaterTexture: {file: "0.8/graphics/world/surfaces/frozenWater.jpg"},
            pavedTexture: {file: "0.8/graphics/world/surfaces/paved.jpg"},
            tileMaskDefault: {
                file: window.WINTER_SEASON ? "map/masks/smooth3" + b : "map/masks/default" + b,
                frame: {width: 128, height: 64}
            },
            tileMaskSmooth: {file: "map/masks/smooth3" + b, frame: {width: 128, height: 64}},
            tileMaskInGrass: {file: "map/masks/ingrass" + b, frame: {width: 128, height: 64}},
            tileMaskDebug: {file: "map/masks/debug4" + b, frame: {width: 128, height: 64}},
            collision: {file: "map/img/tiled_collision" + b, frame: {width: 128, height: 64}},
            box8: {file: "0.7/graphics/shapes/box8" + b},
            box16: {file: "0.7/graphics/shapes/box16" + b},
            box24: {file: "0.7/graphics/shapes/box24" + b},
            box32: {file: "0.7/graphics/shapes/box32" + b},
            circle8: {file: "0.7/graphics/shapes/circle8" + b},
            circle16: {file: "0.7/graphics/shapes/circle16" + b},
            circle24: {file: "0.7/graphics/shapes/circle24" + b},
            circle32: {file: "0.7/graphics/shapes/circle32" + b},
            circle40: {file: "0.7/graphics/shapes/circle40" + b},
            circle48: {file: "0.7/graphics/shapes/circle48" + b},
            circle56: {file: "0.7/graphics/shapes/circle56" + b},
            circle64: {file: "0.7/graphics/shapes/circle64" + b},
            circle72: {file: "0.7/graphics/shapes/circle72" + b},
            circle96: {file: "0.7/graphics/shapes/circle96" + b},
            circle150: {file: "0.7/graphics/shapes/circle150" + b},
            circle200: {file: "0.7/graphics/shapes/circle200" + b},
            circle256: {file: "0.7/graphics/shapes/circle256" + b},
            arc32: {file: "0.7/graphics/shapes/arc32" + b},
            arc64: {file: "0.7/graphics/shapes/arc64" + b},
            bar8: {file: "0.7/graphics/shapes/bar8" + b},
            bar16: {file: "0.7/graphics/shapes/bar16" + b},
            bar24: {file: "0.7/graphics/shapes/bar24" + b},
            bar32: {file: "0.7/graphics/shapes/bar32" + b},
            bar50: {file: "0.7/graphics/shapes/bar50" + b},
            bar90: {file: "0.7/graphics/shapes/bar90" + b},
            bar150: {file: "0.7/graphics/shapes/bar150" + b},
            tileHalf: {file: "0.7/graphics/shapes/tiles0_5" + b, frame: {width: 96, height: 48}},
            tileHalfAndHalf: {file: "0.7/graphics/shapes/tiles0_1_5" + b, frame: {width: 128, height: 64}},
            tileOne: {file: "0.7/graphics/shapes/tiles1_1" + b, frame: {width: 128, height: 64}},
            tileOneIn: {file: "0.7/graphics/shapes/tiles1_1_sm" + b, frame: {width: 128, height: 64}},
            tileOneAndHalf: {file: "0.7/graphics/shapes/tiles1_5" + b, frame: {width: 160, height: 80}},
            tileOneAndHalfThin: {file: "0.7/graphics/shapes/tiles1_5_thin" + b, frame: {width: 106, height: 53}},
            tileOneAndHalfHalf: {file: "0.7/graphics/shapes/tiles5_5" + b, frame: {width: 128, height: 64}},
            tileOneAndTwoHalf: {file: "0.7/graphics/shapes/tiles1_5_5" + b, frame: {width: 192, height: 96}},
            tileTowAndHalf: {file: "0.7/graphics/shapes/tiles2_5" + b, frame: {width: 224, height: 112}},
            tileTowByHalf: {file: "0.7/graphics/shapes/tiles2_1_5" + b, frame: {width: 160, height: 80}},
            tileTowByOne: {file: "0.7/graphics/shapes/tiles2_1" + b, frame: {width: 192, height: 96}},
            tileTowByTow: {file: "0.7/graphics/shapes/tiles2_2" + b, frame: {width: 256, height: 128}},
            tileTowByTowIn: {file: "0.7/graphics/shapes/tiles2_2_sm" + b, frame: {width: 256, height: 128}},
            tileThreeByTowIn: {file: "0.7/graphics/shapes/tiles3_2_sm" + b, frame: {width: 320, height: 160}},
            tile075: {file: "0.7/graphics/shapes/tiles075" + b, frame: {width: 112, height: 54}},
            tile08by15: {file: "0.7/graphics/shapes/tiles08_15" + b, frame: {width: 146, height: 73}},
            tileBl: {file: "0.7/graphics/shapes/tileBl" + b, frame: {width: 384, height: 192}},
            tileBB: {file: "0.7/graphics/shapes/tileBB" + b, frame: {width: 192, height: 96}},
            ovalBl: {file: "0.7/graphics/shapes/ovalBl" + b, frame: {width: 90, height: 40}},
            wallsDoorsShapes: {file: "0.7/graphics/shapes/wallsDoors" + b, frame: {width: 64, height: 32}},
            gates2: {file: "0.7/graphics/shapes/gates2" + b, frame: {width: 128, height: 64}},
            itemIcons: {file: "0.8/graphics/items/icons" + b, frame: {width: 64, height: 64}},
            itemIcons200: {file: "0.8/graphics/items/icons2" + b, frame: {width: 64, height: 64}},
            buildIcons: {file: "0.8/graphics/build/buildIcons" + b, frame: {width: 64, height: 64}},
            claimDirection: {file: "0.7/graphics/ui/homeDir" + b, frame: {width: 50, height: 50}},
            //RIM
            rareDirection: {file: "0.7/graphics/ui/rareDir" + b, frame: {width: 50, height: 50}},
            //RIM
            corpseDirection: {file: "0.7/graphics/ui/corpseDir" + b, frame: {width: 50, height: 50}},
            droppedItems: {file: "0.8/graphics/world/droppeditems/items" + b, frame: {width: 100, height: 50}},
            droppedItems200: {file: "0.8/graphics/world/droppeditems/items2" + b, frame: {width: 100, height: 50}},
            uiBuildIcons: {file: "0.7/graphics/ui/place_buttons" + b, frame: {width: 61, height: 61}},
            microBar: {file: "0.7/graphics/ui/microBar" + b, frame: {width: 50, height: 7}},
            projectileArrow: {file: "0.8/graphics/world/projectile/arrow" + b, frame: {width: 59, height: 3}},
            projectileStone: {file: "0.8/graphics/world/projectile/stone" + b, frame: {width: 9, height: 10}},
            projectileSnowball: {file: "0.8/graphics/world/projectile/snowball" + b, frame: {width: 12, height: 12}},
            projectileSpear: {file: "0.8/graphics/world/projectile/spear" + b, frame: {width: 110, height: 6}},
            projectileBronzeSpear: {
                file: "0.8/graphics/world/projectile/bronze_spear" + b,
                frame: {width: 99, height: 7}
            },
            projectileBigStone: {file: "0.8/graphics/world/projectile/bigStone" + b, frame: {width: 58, height: 83}},
            voidEntity: {file: "0.8/graphics/world/entity/void" + b, frame: {width: 256, height: 256}}
        }, this._dynamic = {
            tallObjects: {file: "map/img/tallObjects" + b, frame: {width: 150, height: 230}},
            bushesGrass: {file: "map/img/bushesGrass" + b, frame: {width: 128, height: 100}},
            bushesSoil: {file: "map/img/bushesSoil" + b, frame: {width: 128, height: 100}},
            mountains: {file: "map/img/mountains" + b, frame: {width: 512, height: 512}},
            worldObjects: {file: "map/img/worldObjects" + b, frame: {width: 100, height: 100}},
            treeApple: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_apple" + b,
                frame: {width: 213, height: 244}
            },
            treeAspen: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_aspen" + b,
                frame: {width: 180, height: 309}
            },
            treeBirch: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_birch" + b,
                frame: {width: 222, height: 306}
            },
            treeFir: {file: "0.8/graphics/world/terrain/trees/" + d + "tree_fir" + b, frame: {width: 190, height: 304}},
            treeWhiteFir: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_whitefir" + b,
                frame: {width: 230, height: 316}
            },
            treeLinden: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_linden" + b,
                frame: {width: 372, height: 340}
            },
            treeMaple: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_maple" + b,
                frame: {width: 277, height: 337}
            },
            treeOak: {file: "0.8/graphics/world/terrain/trees/" + d + "tree_oak" + b, frame: {width: 292, height: 325}},
            treePine: {
                file: "0.8/graphics/world/terrain/trees/" + d + "tree_pine" + b,
                frame: {width: 289, height: 329}
            },
            claimMarkers: {file: "0.7/graphics/ui/homeMarkers" + b, frame: {width: 80, height: 150}},
            seedBed: {file: "0.7/graphics/world/artificial/seedBed" + b, frame: {width: 147, height: 77}},
            terraForm: {file: "0.7/graphics/ui/terraForm" + b, frame: {width: 128, height: 64}},
            cropVine: {file: "0.8/graphics/world/terrain/cropVine" + b, frame: {width: 140, height: 140}},
            cropPumpkin: {file: "0.8/graphics/world/terrain/cropPumpkin" + b, frame: {width: 120, height: 90}},
            crops: {file: "0.8/graphics/world/terrain/crops" + b, frame: {width: 100, height: 100}},
            cropTreeOne: {file: "0.8/graphics/world/terrain/cropTreeOne" + b, frame: {width: 74, height: 142}},
            cropTreeTwo: {file: "0.8/graphics/world/terrain/cropTreeTwo" + b, frame: {width: 140, height: 240}},
            fields: {file: "0.7/graphics/world/terrain/fields" + b, frame: {width: 100, height: 100}},
            mushrooms: {file: "0.8/graphics/world/terrain/mushrooms" + b, frame: {width: 50, height: 40}},
            flaxStack: {file: "0.8/graphics/world/artificial/flaxStack" + b, frame: {width: 93, height: 93}},
            wildWeeds: {file: "0.8/graphics/world/terrain/wildWeeds" + b, frame: {width: 70, height: 70}},
            clayPit: {file: "0.8/graphics/world/terrain/clayPit" + b, frame: {width: 150, height: 72}},
            smallResources: {file: "0.8/graphics/world/terrain/smallResources" + b, frame: {width: 70, height: 50}},
            resRock: {file: "0.8/graphics/world/terrain/rock" + b, frame: {width: 116, height: 154}},
            cliffs: {file: "0.8/graphics/world/terrain/cliffs" + b, frame: {width: 200, height: 300}},
            rareFinds: {file: "0.8/graphics/world/artificial/rareFinds" + b, frame: {width: 190, height: 160}},
            staticWaggon: {file: "0.8/graphics/world/terrain/staticWaggon" + b, frame: {width: 181, height: 144}},
            strangeSkull: {file: "0.8/graphics/world/droppeditems/strangeSkull" + b, frame: {width: 106, height: 94}},
            victoryFlag: {file: "0.8/graphics/world/droppeditems/victoryFlag" + b, frame: {width: 85, height: 178}},
            scarecrow: {file: "0.8/graphics/world/artificial/scarecrow" + b, frame: {width: 120, height: 140}},
            downDrawbridge: {
                file: "0.8/graphics/world/artificial/downDrawbridge" + b,
                frame: {width: 328, height: 184}
            },
            slicedDrawbridge: {
                file: "0.8/graphics/world/artificial/slicedDrawbridge" + b,
                frame: {width: 128, height: 285}
            },
            copperDeposit: {file: "0.8/graphics/world/terrain/copperDeposit" + b, frame: {width: 130, height: 120}},
            tinDeposit: {file: "0.8/graphics/world/terrain/tinDeposit" + b, frame: {width: 130, height: 120}},
            coalDeposit: {file: "0.8/graphics/world/terrain/coalDeposit" + b, frame: {width: 130, height: 120}},
            clayMeltingPot: {file: "0.8/graphics/world/artificial/clayMeltingPot" + b, frame: {width: 110, height: 80}},
            smallDryingFrame: {
                file: "0.8/graphics/world/artificial/smallDryingFrame" + b,
                frame: {width: 90, height: 90}
            },
            logMillFansLeft: {
                file: "0.8/graphics/world/artificial/log-windmill/millFansLeft" + b,
                frame: {width: 313, height: 402}
            },
            logMillFansRight: {
                file: "0.8/graphics/world/artificial/log-windmill/millFansRight" + b,
                frame: {width: 313, height: 402}
            },
            logMill: {
                file: "0.8/graphics/world/artificial/log-windmill/millTower" + b,
                frame: {width: 250, height: 324}
            },
            executionersBlock: {
                file: "0.8/graphics/world/artificial/executionersBlock" + b,
                frame: {width: 100, height: 74}
            },
            gibbet: {file: "0.8/graphics/world/artificial/gibbet" + b, frame: {width: 160, height: 243}},
            pillory: {file: "0.8/graphics/world/artificial/pillory" + b, frame: {width: 70, height: 84}},
            scaffold: {file: "0.8/graphics/world/artificial/scaffold" + b, frame: {width: 128, height: 164}},
            potterWheel: {file: "0.8/graphics/world/artificial/potterWheel" + b, frame: {width: 60, height: 80}},
            madder: {file: "0.8/graphics/world/terrain/madder" + b, frame: {width: 35, height: 60}},
            snowdrift: {file: "0.8/graphics/world/terrain/snowdrift" + b, frame: {width: 100, height: 60}},
            christmasGift: {
                file: "0.8/graphics/world/artificial/ny2016/christmasGift" + b,
                frame: {width: 50, height: 50}
            },
            christmasSocks: {
                file: "0.8/graphics/world/artificial/ny2016/christmasSocks" + b,
                frame: {width: 30, height: 45}
            },
            christmasTreeBig: {
                file: "0.8/graphics/world/artificial/ny2016/christmasTreeBig" + b,
                frame: {width: 200, height: 308}
            },
            christmasTreeSmall: {
                file: "0.8/graphics/world/artificial/ny2016/christmasTreeSmall" + b,
                frame: {width: 130, height: 194}
            },
            snowman: {file: "0.8/graphics/world/artificial/ny2016/snowman" + b, frame: {width: 75, height: 120}},
            wreathMistletoe: {
                file: "0.8/graphics/world/artificial/ny2016/wreathMistletoe" + b,
                frame: {width: 60, height: 70}
            },
            nobleTable: {file: "0.8/graphics/world/artificial/nobleTable" + b, frame: {width: 164, height: 164}},
            nobleBench: {file: "0.8/graphics/world/artificial/nobleBench" + b, frame: {width: 100, height: 80}},
            knightStatue: {file: "0.8/graphics/world/artificial/knightStatue" + b, frame: {width: 160, height: 200}},
            gobelins: {file: "0.8/graphics/world/artificial/gobelins" + b, frame: {width: 79, height: 125}},
            skullPiles: {file: "0.8/graphics/world/artificial/skullPiles" + b, frame: {width: 70, height: 44}},
            skullStick: {file: "0.8/graphics/world/artificial/skullStick" + b, frame: {width: 50, height: 72}},
            basicWell: {file: "0.8/graphics/world/artificial/well" + b, frame: {width: 120, height: 135}},
            pumpkinScarecrow: {
                file: "0.8/graphics/world/artificial/pumpkinScarecrow" + b,
                frame: {width: 165, height: 160}
            },
            boughBed: {file: "0.8/graphics/world/artificial/boughBed" + b, frame: {width: 160, height: 100}},
            kipBench: {file: "0.8/graphics/world/artificial/kipBench" + b, frame: {width: 130, height: 80}},
            woodenBox: {file: "0.8/graphics/world/artificial/woodenBox" + b, frame: {width: 75, height: 64}},
            ironChest: {file: "0.8/graphics/world/artificial/ironChest" + b, frame: {width: 108, height: 80}},
            cupboard: {file: "0.8/graphics/world/artificial/cupboard" + b, frame: {width: 120, height: 144}},
            steelChest: {file: "0.8/graphics/world/artificial/steelChest" + b, frame: {width: 130, height: 113}},
            woodenShed: {file: "0.8/graphics/world/artificial/woodenShed" + b, frame: {width: 150, height: 140}},
            logShed: {file: "0.8/graphics/world/artificial/logShed" + b, frame: {width: 128, height: 266}},
            stoneShed: {file: "0.8/graphics/world/artificial/stoneShed" + b, frame: {width: 128, height: 360}},
            dryingFrame: {file: "0.8/graphics/world/artificial/dryingFrame" + b, frame: {width: 120, height: 140}},
            clayTanning: {file: "0.8/graphics/world/artificial/clayTanning" + b, frame: {width: 80, height: 60}},
            woodTanning: {file: "0.8/graphics/world/artificial/woodTanning" + b, frame: {width: 100, height: 65}},
            clayBoiler: {file: "0.8/graphics/world/artificial/clayBoiler" + b, frame: {width: 80, height: 89}},
            allDoors: {file: "0.8/graphics/world/artificial/doors" + b, frame: {width: 80, height: 160}},
            palisadeGates: {file: "0.8/graphics/world/artificial/palisade/gates" + b, frame: {width: 150, height: 230}},
            palisadeWalls: {file: "0.8/graphics/world/artificial/palisade/walls" + b, frame: {width: 150, height: 230}},
            branchFenceGates: {
                file: "0.8/graphics/world/artificial/branch-fence/gates" + b,
                frame: {width: 110, height: 140}
            },
            branchFenceWalls: {
                file: "0.8/graphics/world/artificial/branch-fence/walls" + b,
                frame: {width: 110, height: 140}
            },
            domMicro: {file: "0.8/graphics/world/artificial/dominium/dom_01" + b, frame: {width: 62, height: 76}},
            domSmall: {file: "0.8/graphics/world/artificial/dominium/dom_02" + b, frame: {width: 74, height: 93}},
            domMedium: {file: "0.8/graphics/world/artificial/dominium/dom_03" + b, frame: {width: 90, height: 115}},
            domLarge: {file: "0.8/graphics/world/artificial/dominium/dom_04" + b, frame: {width: 93, height: 234}},
            domNoble: {file: "0.8/graphics/world/artificial/dominium/dom_05" + b, frame: {width: 131, height: 307}},
            cityFence: {file: "0.8/graphics/world/artificial/cityFence" + b, frame: {width: 100, height: 100}},
            fencesAndGates: {file: "0.8/graphics/world/artificial/gates" + b, frame: {width: 150, height: 230}},
            steelGates: {file: "0.8/graphics/world/artificial/steelGates" + b, frame: {width: 150, height: 230}},
            ironGrate: {file: "0.8/graphics/world/artificial/grates/ironGrate" + b, frame: {width: 128, height: 256}},
            logWalls: {file: "0.8/graphics/world/artificial/log-house/walls" + b, frame: {width: 120, height: 190}},
            logRoofs: {file: "0.8/graphics/world/artificial/log-house/roof" + b, frame: {width: 180, height: 270}},
            logFloors: {file: "0.8/graphics/world/artificial/log-house/floor" + b, frame: {width: 147, height: 77}},
            logCeiling: {file: "0.8/graphics/world/artificial/log-house/flatRoof" + b, frame: {width: 147, height: 77}},
            branchWalls: {file: "0.8/graphics/world/artificial/branch-hut/walls" + b, frame: {width: 105, height: 190}},
            branchRoofs: {file: "0.8/graphics/world/artificial/branch-hut/roof" + b, frame: {width: 180, height: 120}},
            branchDoors: {file: "0.8/graphics/world/artificial/branch-hut/doors" + b, frame: {width: 80, height: 150}},
            htWalls: {file: "0.8/graphics/world/artificial/half-timb/walls" + b, frame: {width: 120, height: 200}},
            htRoofs: {file: "0.8/graphics/world/artificial/half-timb/roof" + b, frame: {width: 180, height: 270}},
            htFloors: {file: "0.8/graphics/world/artificial/half-timb/floor" + b, frame: {width: 147, height: 77}},
            htFlatRoofs: {
                file: "0.8/graphics/world/artificial/half-timb/flatRoof" + b,
                frame: {width: 150, height: 85}
            },
            htMillFans: {file: "0.7/graphics/world/artificial/houses/millfans" + b, frame: {width: 400, height: 430}},
            stoneFences: {
                file: "0.8/graphics/world/artificial/stone-blocks/walls" + b,
                frame: {width: 120, height: 190}
            },
            stoneBlocks: {
                file: "0.8/graphics/world/artificial/stone-blocks/blocks" + b,
                frame: {width: 180, height: 270}
            },
            stoneArches: {
                file: "0.8/graphics/world/artificial/stone-blocks/arches" + b,
                frame: {width: 360, height: 270}
            },
            stoneMerlons: {
                file: "0.8/graphics/world/artificial/stone-blocks/merlon" + b,
                frame: {width: 150, height: 109}
            },
            stoneTower: {
                file: "0.8/graphics/world/artificial/stone-blocks/tower" + b,
                frame: {width: 128, height: 470}
            },
            slicedStoneBarbakan: {
                file: "0.8/graphics/world/artificial/stone-blocks/slicedBarbakan" + b,
                frame: {width: 160, height: 550}
            },
            brickBlocks: {
                file: "0.8/graphics/world/artificial/brick-blocks/blocks" + b,
                frame: {width: 180, height: 270}
            },
            brickMerlons: {
                file: "0.8/graphics/world/artificial/brick-blocks/merlon" + b,
                frame: {width: 150, height: 109}
            },
            brickTower: {
                file: "0.8/graphics/world/artificial/brick-blocks/tower" + b,
                frame: {width: 200, height: 329}
            },
            slicedBarbakan: {
                file: "0.8/graphics/world/artificial/brick-blocks/slicedBarbakan" + b,
                frame: {width: 150, height: 530}
            },
            batteringRam: {
                file: "0.8/graphics/world/artificial/siege/batteringRam" + b,
                frame: {width: 140, height: 200}
            },
            ballista: {file: "0.8/graphics/world/artificial/siege/ballista" + b, frame: {width: 250, height: 180}},
            spinningWheel: {file: "0.8/graphics/world/artificial/spinningWheel" + b, frame: {width: 70, height: 100}},
            flaxBreak: {file: "0.8/graphics/world/artificial/flaxBreak" + b, frame: {width: 85, height: 104}},
            loom: {file: "0.8/graphics/world/artificial/loom" + b, frame: {width: 175, height: 156}},
            anvils: {file: "0.8/graphics/world/artificial/anvils" + b, frame: {width: 70, height: 70}},
            brickOven: {file: "0.8/graphics/world/artificial/brickOven" + b, frame: {width: 150, height: 154}},
            oven: {file: "0.8/graphics/world/artificial/oven" + b, frame: {width: 150, height: 190}},
            brickKiln: {file: "0.8/graphics/world/artificial/brickKiln" + b, frame: {width: 200, height: 154}},
            roastFurnace: {file: "0.8/graphics/world/artificial/roastFurnace" + b, frame: {width: 190, height: 132}},
            smallFurnace: {file: "0.8/graphics/world/artificial/smallFurnace" + b, frame: {width: 150, height: 128}},
            bigFurnace: {file: "0.8/graphics/world/artificial/bigFurnace" + b, frame: {width: 210, height: 275}},
            brickSmelter: {file: "0.8/graphics/world/artificial/brickSmelter" + b, frame: {width: 200, height: 238}},
            crucibleShop: {file: "0.8/graphics/world/artificial/crucibleShop" + b, frame: {width: 128, height: 390}},
            statuesStructures: {file: "0.7/graphics/world/artificial/statues" + b, frame: {width: 150, height: 150}},
            townFountain: {file: "0.8/graphics/world/artificial/townFountain" + b, frame: {width: 200, height: 200}},
            halloweenTree: {file: "0.8/graphics/world/artificial/halloweenTree" + b, frame: {width: 360, height: 300}},
            millstone: {file: "0.8/graphics/world/artificial/millstone" + b, frame: {width: 61, height: 45}},
            campfire: {file: "0.8/graphics/world/artificial/campfire" + b, frame: {width: 100, height: 60}},
            smallAviary: {file: "0.8/graphics/world/artificial/smallAviary" + b, frame: {width: 100, height: 100}},
            henHouse: {file: "0.8/graphics/world/artificial/henHouse" + b, frame: {width: 128, height: 200}},
            smallStructures: {
                file: "0.7/graphics/world/artificial/smallStructures" + b,
                frame: {width: 70, height: 70}
            },
            slicedMediumStructures: {
                file: "0.7/graphics/world/artificial/slicedMediumStructures" + b,
                frame: {width: 128, height: 128}
            },
            slicedTallStructures: {
                file: "0.7/graphics/world/artificial/slicedTallStructures" + b,
                frame: {width: 128, height: 384}
            },
            foxCorpse: {file: "0.8/graphics/world/corpses/fox" + b, frame: {width: 100, height: 56}},
            ferretCorpse: {file: "0.8/graphics/world/corpses/ferret" + b, frame: {width: 69, height: 40}},
            bearCorpse: {file: "0.8/graphics/world/corpses/bear" + b, frame: {width: 197, height: 116}},
            boarCorpse: {file: "0.8/graphics/world/corpses/boar" + b, frame: {width: 120, height: 80}},
            deerCorpse: {file: "0.8/graphics/world/corpses/deer" + b, frame: {width: 150, height: 109}},
            hareCorpse: {file: "0.8/graphics/world/corpses/hare" + b, frame: {width: 75, height: 44}},
            henCorpse: {file: "0.8/graphics/world/corpses/hen" + b, frame: {width: 60, height: 38}},
            ravenCorpse: {file: "0.8/graphics/world/corpses/raven" + b, frame: {width: 51, height: 31}},
            wolfCorpse: {file: "0.8/graphics/world/corpses/wolf" + b, frame: {width: 110, height: 69}},
            maleCorpse: {file: "0.8/graphics/world/corpses/male" + b, frame: {width: 150, height: 92}},
            femaleCorpse: {file: "0.8/graphics/world/corpses/female" + b, frame: {width: 150, height: 84}},
            bayHorseCorpse: {file: "0.8/graphics/world/corpses/bayHorseCorpse" + b, frame: {width: 216, height: 116}},
            blackHorseCorpse: {
                file: "0.8/graphics/world/corpses/blackHorseCorpse" + b,
                frame: {width: 216, height: 116}
            },
            dunHorseCorpse: {file: "0.8/graphics/world/corpses/dunHorseCorpse" + b, frame: {width: 216, height: 116}},
            greyHorseCorpse: {file: "0.8/graphics/world/corpses/greyHorseCorpse" + b, frame: {width: 216, height: 116}},
            kaurHorseCorpse: {file: "0.8/graphics/world/corpses/kaurHorseCorpse" + b, frame: {width: 216, height: 116}},
            pintobayHorseCorpse: {
                file: "0.8/graphics/world/corpses/pintobayHorseCorpse" + b,
                frame: {width: 216, height: 116}
            },
            spottedHorseCorpse: {
                file: "0.8/graphics/world/corpses/spottedHorseCorpse" + b,
                frame: {width: 216, height: 116}
            },
            whiteHorseCorpse: {
                file: "0.8/graphics/world/corpses/whiteHorseCorpse" + b,
                frame: {width: 216, height: 116}
            },
            zebraHorseCorpse: {
                file: "0.8/graphics/world/corpses/zebraHorseCorpse" + b,
                frame: {width: 216, height: 116}
            },
            hitBlood: {file: "0.7/graphics/world/effects/hitBlood" + b, frame: {width: 32, height: 32}},
            hitStructure: {file: "0.7/graphics/world/effects/hitStructure" + b, frame: {width: 48, height: 64}},
            balExpl: {file: "0.7/graphics/world/effects/balExpl" + b, frame: {width: 500, height: 400}},
            snowballHit: {file: "0.7/graphics/world/effects/snowballHit" + b, frame: {width: 100, height: 80}},
            collapse: {file: "0.7/graphics/world/effects/collapse" + b, frame: {width: 467, height: 448}},
            fireSmall: {file: "0.7/graphics/world/artificial/fire" + b, frame: {width: 60, height: 100}},
            smokeSmall: {file: "0.7/graphics/world/artificial/smoke" + b, frame: {width: 60, height: 100}}
        }, this._createSprite = function (a, b, c) {
            var d = new Phaser.Sprite(this.game, 0, 0, a, 0);
            return d.anchor.x = b, d.anchor.y = c, d
        }, this.createOrLoadCorpseSprite = function (a, b, c, d) {
            var e = this.game.cache._cache.image[a];
            if (e)d(this._createSprite(a, b, c)); else {
                var f = this;
                this.loadAniFrameImage(a, this._corpseImages[a], function () {
                    d(f._createSprite(a, b, c))
                })
            }
        }, this.loadAniFrameImage = function (a, b, c) {
            if (this.game.cache._cache.image[a])c && c(); else {
                var d = this, e = {};
                e.key = a, e.url = b, e.data = new Image, e.data.name = e.key, e.data.onload = function () {
                    d.game.cache._cache.image[e.key] || d.game.cache.addImage(e.key, e.url, e.data), c && c()
                }, e.data.onerror = function () {
                    console.error("loadAniFrameImage error:", a, b)
                }, e.data.src = e.url
            }
        }, this.getDynamicFrame = function (a) {
            var b = this._dynamic[a];
            return b && b.frame ? b.frame : (console.error("Not in dynamic names:", a), null)
        }, this.loadDynamicImage = function (a, b) {
            var c = this._dynamic[a];
            if (c) {
                var d = this, e = {};
                e.key = a, e.url = c.file, e.data = new Image, e.data.name = e.key, e.data.onload = function () {
                    if (!d.game.cache._cache.image[e.key]) {
                        var a = c.frame;
                        a ? d.game.cache.addSpriteSheet(e.key, e.url, e.data, a.width, a.height, -1, 0, 0) : d.game.cache.addImage(e.key, e.url, e.data)
                    }
                    b()
                }, e.data.onerror = function () {
                    console.error("Load image error:", c.file)
                }, e.data.src = e.url
            } else console.error("Not in dynamic names:", a)
        }, this._loadInit = function () {
            var b = this;
            Object.keys(this._static).forEach(function (c) {
                var d = b._static[c], e = d.frame;
                e ? a.load.spritesheet(c, d.file, e.width, e.height) : a.load.image(c, d.file)
            }), console.log("Static graphic load init."), c && (Object.keys(this._dynamic).forEach(function (c) {
                var d = b._dynamic[c], e = d.frame;
                e ? a.load.spritesheet(c, d.file, e.width, e.height) : a.load.image(c, d.file)
            }), console.log("Dynamic graphic load init.")), c && console.log("Full load animations init.")
        }, this._loadInit(), this
    }
}),define("KME/utils/SoundAtlas", [], function () {
    KME.SoundAtlas = function (a) {
        this.game = a, this.soundNames = {
            hitToObject: "hitToObject",
            noDamage: "noDamage",
            femaleInjury: "femaleInjury",
            femaleEnemyInjury: "femaleEnemyInjury",
            femaleDead: "femaleDead",
            maleInjury: "maleInjury",
            maleEnemyInjury: "maleEnemyInjury",
            maleDead: "maleDead",
            deathScreen: "deathScreen",
            levelUp: "levelUp",
            bearCaught: "animals/bearCaught",
            horseCaught: "animals/horseCaught",
            wolfNotice: "animals/wolfNotice",
            wolfDead: "animals/wolfDead",
            wolfInjury: "animals/wolfInjury",
            bearNotice: "animals/bearNotice",
            bearDead: "animals/bearDead",
            bearInjury: "animals/bearInjury",
            boarDead: "animals/boarDead",
            boarInjury: "animals/boarInjury",
            deerDead: "animals/deerDead",
            deerInjury: "animals/deerInjury",
            hareDead: "animals/hareDead",
            hareInjury: "animals/hareInjury",
            henNotice: "animals/henNotice",
            henDead: "animals/henDead",
            henInjury: "animals/henInjury",
            ferretNotice: "animals/ferretNotice",
            ferretDead: "animals/ferretDead",
            ferretInjury: "animals/ferretInjury",
            foxNotice: "animals/foxNotice",
            foxDead: "animals/foxDead",
            foxInjury: "animals/foxInjury",
            ravenNotice: "animals/ravenNotice",
            ravenDead: "animals/ravenDead",
            ravenInjury: "animals/ravenInjury",
            horseNotice: "animals/horseNotice",
            horseDead: "animals/horseDead",
            horseInjury: "animals/horseInjury",
            swing: "swing",
            bowShoot: "bowShoot",
            doorOpen: "doorOpen",
            doorClose: "doorClose",
            gardenDoorOpen: "gardenDoorOpen",
            gardenDoorClose: "gardenDoorClose",
            ironGrateOpen: "ironGrateOpen",
            ironGrateClose: "ironGrateClose",
            drawbridgeOpen: "drawbridgeOpen",
            drawbridgeClose: "drawbridgeClose",
            ballistaLoad: "ballistaLoad",
            ballistaShoot: "ballistaShoot",
            ballistaHit: "ballistaHit",
            ramShoot: "ramShoot",
            ramHit: "ramHit",
            buildingDestroy: "buildingDestroy",
            buildComplete: "buildComplete",
            extinguish: "extinguish",
            fireCamp: "fireCamp",
            fireStove: "fireStove",
            millStart: "millStart",
            pickHitRock: "pickHitRock",
            shovel: "shovel",
            hatchetChopWood: "hatchetChopWood"
        }, this.musicNames = {
            titleTheme: {file: "0.7/music/titleTheme.ogg"},
            mainTheme: {file: "0.7/music/mainTheme.ogg"},
            huntTheme: {file: "0.7/music/huntTheme.ogg"},
            farmTheme: {file: "0.7/music/farmTheme.ogg"},
            craftTheme: {file: "0.7/music/craftTheme.ogg"},
            buildTheme: {file: "0.7/music/buildTheme.ogg"}
        }, this.musicLoader = new Phaser.Loader(a), this.musicUnload = function () {
            var a = this;
            Object.keys(this.musicNames).forEach(function (b) {
                var c = a.musicNames[b];
                c.loaded && (a.game.cache.removeSound(b), c.loaded = !1)
            })
        }, this.loadMusic = function (a, b) {
            var c = this.musicNames[a];
            c ? this.musicLoader.isLoading || (this.musicLoader.audio(a, c.file, !0), this.musicLoader.onLoadComplete.addOnce(function () {
                b && b()
            }, this), this.musicLoader.start()) : console.error("Not in musicNames names:", a)
        };
        var b = this;
        return Object.keys(this.soundNames).forEach(function (c) {
            var d = "0.8/sounds/" + b.soundNames[c] + ".ogg";
            a.load.audio(c, d, !0)
        }), this
    }
}),define("KME/utils/ModelAtlas", ["three", "async", "sea3d"], function (a, b) {
    KME.ModelAtlas = function () {
        this._cache = {}, this._materials = {}, this._files = {
            stone_axe: {file: "models/axes/stone_axe.sea"},
            copper_axe: {file: "models/axes/copper_axe.sea"},
            bronze_axe: {file: "models/axes/bronze_axe.sea"},
            iron_axe: {file: "models/axes/iron_axe.sea"},
            steel_axe: {file: "models/axes/steel_axe.sea"},
            wooden_shield: {file: "models/shields/wooden_shield.sea"},
            bronze_circle_shield: {file: "models/shields/bronze_circle_shield.sea"},
            bronze_great_shield: {file: "models/shields/bronze_great_shield.sea"},
            iron_shield: {file: "models/shields/iron_shield.sea"},
            steel_shield: {file: "models/shields/steel_shield.sea"},
            noble_shield: {file: "models/shields/noble_shield.sea"},
            copper_sword: {file: "models/swords/copper_sword.sea"},
            bronze_sword: {file: "models/swords/bronze_sword.sea"},
            iron_sword: {file: "models/swords/iron_sword.sea"},
            steel_sword: {file: "models/swords/steel_sword.sea"},
            noble_sword: {file: "models/swords/noble_sword.sea"},
            admin_sword: {file: "models/swords/admin_sword.sea"},
            stone_hammer: {file: "models/hammers/stone_hammer.sea"},
            bronze_hammer: {file: "models/hammers/bronze_hammer.sea"},
            iron_hammer: {file: "models/hammers/iron_hammer.sea"},
            steel_hammer: {file: "models/hammers/steel_hammer.sea"},
            stone_pick: {file: "models/picks/stone_pick.sea"},
            bronze_pick: {file: "models/picks/bronze_pick.sea"},
            iron_pick: {file: "models/picks/iron_pick.sea"},
            steel_pick: {file: "models/picks/steel_pick.sea"},
            stone_knife: {file: "models/knifes/stone_knife.sea"},
            copper_knife: {file: "models/knifes/copper_knife.sea"},
            bronze_knife: {file: "models/knifes/bronze_knife.sea"},
            iron_knife: {file: "models/knifes/iron_knife.sea"},
            steel_knife: {file: "models/knifes/steel_knife.sea"},
            copper_saw: {file: "models/saws/copper_saw.sea"},
            iron_saw: {file: "models/saws/iron_saw.sea"},
            steel_saw: {file: "models/saws/steel_saw.sea"},
            copper_scissors: {file: "models/scissors/copper_scissors.sea"},
            iron_scissors: {file: "models/scissors/iron_scissors.sea"},
            steel_scissors: {file: "models/scissors/steel_scissors.sea"},
            copper_sickle: {file: "models/sickles/copper_sickle.sea"},
            iron_sickle: {file: "models/sickles/iron_sickle.sea"},
            steel_sickle: {file: "models/sickles/steel_sickle.sea"},
            linen_lariat: {file: "models/lariats/linen_lariat.sea"},
            iron_lariat: {file: "models/lariats/iron_lariat.sea"},
            steel_lariat: {file: "models/lariats/steel_lariat.sea"},
            wooden_shovel: {file: "models/shovels/wooden_shovel.sea"},
            iron_shovel: {file: "models/shovels/iron_shovel.sea"},
            sling: {file: "models/sling/sling.sea"},
            hunter_sling: {file: "models/sling/hunter_sling.sea"},
            wooden_spear: {file: "models/spear/wooden_spear.sea"},
            bronze_spear: {file: "models/spear/bronze_spear.sea"},
            torch: {file: "models/torch/torch.sea"},
            bow: {file: "models/bows/bow.sea"},
            hunter_bow: {file: "models/bows/hunter_bow.sea"},
            compound_bow: {file: "models/bows/compound_bow.sea"},
            short_bow: {file: "models/bows/short_bow.sea"},
            admin_bow: {file: "models/bows/admin_bow.sea"},
            bucket: {file: "models/bucket/bucket.sea"},
            bucket_water: {file: "models/bucket/bucket_water.sea"},
            copper_bucket: {file: "models/bucket/copper_bucket.sea"},
            copper_bucket_water: {file: "models/bucket/copper_bucket_water.sea"},
            farmerHat: {file: "models/hats/farmer_hat.sea", baseScale: 1},
            witchHat: {file: "models/hats/witch_hat.sea", baseScale: 1},
            hareHat: {file: "models/hats/hare_hat.sea", baseScale: .6},
            deerHat: {file: "models/hats/deer_hat.sea", baseScale: .6},
            boarHat: {file: "models/hats/boar_hat.sea", baseScale: .6},
            wolfHat: {file: "models/hats/wolf_hat.sea", baseScale: .6},
            bearHat: {file: "models/hats/bear_hat.sea", baseScale: .6},
            plagueMask: {file: "models/hats/plague_doctor_mask.sea", baseScale: .6},
            darkBurgonet: {file: "models/helmets/burgonet.sea", baseScale: .6},
            darkBarbute: {file: "models/helmets/black_barbute.sea", baseScale: .6},
            lightBarbute: {file: "models/helmets/light_barbute.sea", baseScale: .6},
            darkGreatHelm: {file: "models/helmets/black_great_helm.sea", baseScale: .6},
            lightGreatHelm: {file: "models/helmets/light_great_helm.sea", baseScale: .6},
            spanishHorseHelmet: {file: "models/helmets/spanish_horse_helmet.sea", baseScale: .6},
            grandSpanishHorseHelmet: {file: "models/helmets/grand_spanish_horse_helmet.sea", baseScale: .6},
            hornedHelmet: {file: "models/helmets/horned_kubelhelm.sea", baseScale: .6},
            forestDefenderHelmet: {file: "models/helmets/forest_defender_helm.sea", baseScale: .6},
            vikingHelmet: {file: "models/helmets/viking_helmet.sea", baseScale: .6},
            steelAngelBarbute: {file: "models/helmets/steel_angel_barbute.sea", baseScale: .6},
            cloaks: {file: "models/cloaks/cloaks.sea", baseScale: .6, storeMaterials: !0},
            bear: {file: "models/animal/bear.sea", baseScale: 1.3, storeMaterials: !0},
            wolf: {file: "models/animal/wolf.sea", baseScale: 1.1},
            boar: {file: "models/animal/boar.sea", baseScale: 1},
            deer: {file: "models/animal/deer.sea", baseScale: 1},
            hare: {file: "models/animal/hare.sea", baseScale: 1},
            hen: {file: "models/animal/hen.sea", baseScale: 1},
            raven: {file: "models/animal/raven.sea", baseScale: .5},
            ferret: {file: "models/animal/ferret.sea", baseScale: .4},
            fox: {file: "models/animal/fox.sea", baseScale: .75},
            horse: {file: "models/animal/horse.sea", baseScale: .5, storeMaterials: !0},
            femaleBare: {file: "models/female/femaleBare.sea", baseScale: .6},
            femaleHair: {file: "models/female/femaleHair.sea", baseScale: 1},
            femaleRawHide: {file: "models/female/rawHide.sea", baseScale: .6},
            femaleHide: {file: "models/female/hide.sea", baseScale: .6},
            femaleLeather: {file: "models/female/leather.sea", baseScale: .6},
            femaleCopperBody: {file: "models/female/copperBody.sea", baseScale: .6, hasChildren: !0},
            femaleBronzeBody: {file: "models/female/bronzeBody.sea", baseScale: .6, hasChildren: !0},
            femaleBronzeArmor: {file: "models/female/bronzeArmor.sea", baseScale: .6},
            femaleIronBody: {file: "models/female/ironBody.sea", baseScale: .6, hasChildren: !0},
            femaleIronArmor: {file: "models/female/ironArmor.sea", baseScale: .6},
            femaleSteelBody: {file: "models/female/steelBody.sea", baseScale: .6, hasChildren: !0},
            femaleSteelArmor: {file: "models/female/steelArmor.sea", baseScale: .6},
            femaleNobleBody: {file: "models/female/nobleBody.sea", baseScale: .6, hasChildren: !0},
            femaleNobleArmor: {file: "models/female/nobleArmor.sea", baseScale: .6},
            maleBare: {file: "models/male/maleBare.sea", baseScale: .6},
            maleHair: {file: "models/male/maleHair.sea", baseScale: 1},
            maleCopperBody: {file: "models/male/copperBody.sea", baseScale: .6, hasChildren: !0},
            maleBronzeBody: {file: "models/male/bronzeBody.sea", baseScale: .6, hasChildren: !0},
            maleBronzeArmor: {file: "models/male/bronzeArmor.sea", baseScale: .6},
            maleIronBody: {file: "models/male/ironBody.sea", baseScale: .6, hasChildren: !0},
            maleIronArmor: {file: "models/male/ironArmor.sea", baseScale: .6},
            maleSteelBody: {file: "models/male/steelBody.sea", baseScale: .6, hasChildren: !0},
            maleSteelArmor: {file: "models/male/steelArmor.sea", baseScale: .6},
            maleHide: {file: "models/male/hide.sea", baseScale: .6},
            maleLeather: {file: "models/male/leather.sea", baseScale: .6},
            maleRawHide: {file: "models/male/rawHide.sea", baseScale: .6},
            maleNobleBody: {file: "models/male/nobleBody.sea", baseScale: .6, hasChildren: !0},
            maleNobleArmor: {file: "models/male/nobleArmor.sea", baseScale: .6}
        }, this.partNames = {
            mount: "mount",
            rightHand: "rightHand",
            leftHand: "leftHand",
            body: "body",
            head: "head",
            hat: "hat",
            hair: "hair",
            legs: "legs",
            foots: "foots",
            hands: "hands",
            cloak: "cloak"
        }, this.boneNames = {
            mount: "mount",
            rightHand: "rightHand",
            leftHand: "leftHand",
            leftTwist: "leftTwist",
            spine: "spine",
            head: "head"
        }, this._humanParts = {}, this._humanParts[this.partNames.mount] = {}, this._humanParts[this.partNames.head] = {binds: [this.partNames.hair, this.partNames.hat]}, this._humanParts[this.partNames.body] = {}, this._humanParts[this.partNames.legs] = {}, this._humanParts[this.partNames.foots] = {}, this._humanParts[this.partNames.hands] = {binds: [this.partNames.rightHand, this.partNames.leftHand]}, this._humanParts[this.partNames.hat] = {isBinds: !0}, this._humanParts[this.partNames.hair] = {isBinds: !0}, this._humanParts[this.partNames.cloak] = {}, this._humanParts[this.partNames.rightHand] = {isBinds: !0}, this._humanParts[this.partNames.leftHand] = {isBinds: !0}, this._humanCorrectAnimationIndexes = {
            stay: {
                index: 0,
                mounted: 8
            },
            move: {index: 1, mounted: 9, speed: 1.2},
            run: {index: 2, mounted: 10},
            injury: {index: 3},
            death: {index: 4},
            hit: {index: 5},
            bowShot: {index: 6, speed: 1.1},
            craft: {index: 7}
        }, this._animalParts = {}, this._animalParts[this.partNames.body] = {}, this._animalAniIndexes = {
            stay: {index: 0},
            move: {index: 1},
            run: {index: 2},
            injury: {index: 3},
            death: {index: 4},
            hit: {index: 5}
        }, this.types = {
            male: {
                aniIndexes: this._humanCorrectAnimationIndexes,
                parts: this._humanParts,
                hair: "hair",
                shadowScale: .75,
                bones: {rightHand: 24, leftHand: 28, leftTwist: 26, head: 12, spine: 4},
                alwaysParts: {
                    body: "maleBareBody",
                    head: "maleBareHead",
                    legs: "maleBareLegs",
                    foots: "maleBareFoots",
                    hands: "maleBareHands",
                    cloak: null
                }
            },
            female: {
                aniIndexes: this._humanCorrectAnimationIndexes,
                parts: this._humanParts,
                hair: "hair",
                shadowScale: .75,
                bones: {rightHand: 24, leftHand: 28, leftTwist: 26, head: 12, spine: 4},
                alwaysParts: {
                    body: "femaleBareBody",
                    head: "femaleBareHead",
                    legs: "femaleBareLegs",
                    foots: "femaleBareFoots",
                    hands: "femaleBareHands",
                    cloak: null
                }
            },
            horse: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                mountScale: {self: .6, rider: 1},
                bones: {mount: 7},
                alwaysParts: {body: "horse"}
            },
            hen: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .4,
                alwaysParts: {body: "hen"}
            },
            raven: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .3,
                alwaysParts: {body: "raven"}
            },
            fox: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .7,
                alwaysParts: {body: "fox"}
            },
            ferret: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .5,
                alwaysParts: {body: "ferret"}
            },
            hare: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .6,
                alwaysParts: {body: "hare"}
            },
            deer: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .9,
                mountScale: {self: 1.1, rider: .6},
                bones: {mount: 22},
                alwaysParts: {body: "deer"}
            },
            boar: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .9,
                mountScale: {self: 1.1, rider: .55},
                bones: {mount: 25},
                alwaysParts: {body: "boar"}
            },
            wolf: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: .9,
                mountScale: {self: 1.4, rider: .43},
                bones: {mount: 32},
                alwaysParts: {body: "wolf"}
            },
            bear: {
                aniIndexes: this._animalAniIndexes,
                parts: this._animalParts,
                shadowScale: 1.2,
                mountScale: {self: 1.3, rider: .49},
                bones: {mount: 26},
                alwaysParts: {body: "bear"}
            }
        }, this._typeModels = {
            farmerHat: {male: "maleFarmerHat", female: "femaleFarmerHat"},
            witchHat: {male: "maleWitchHat", female: "femaleWitchHat"},
            hareHat: {male: "maleHareHat", female: "femaleHareHat"},
            deerHat: {male: "maleDeerHat", female: "femaleDeerHat"},
            boarHat: {male: "maleBoarHat", female: "femaleBoarHat"},
            wolfHat: {male: "maleWolfHat", female: "femaleWolfHat"},
            bearHat: {male: "maleBearHat", female: "femaleBearHat"},
            plagueMask: {male: "malePlagueMask", female: "femalePlagueMask"},
            darkBurgonet: {male: "maleDarkBurgonet", female: "femaleDarkBurgonet"},
            darkBarbute: {male: "maleDarkBarbute", female: "femaleDarkBarbute"},
            lightBarbute: {male: "maleLightBarbute", female: "femaleLightBarbute"},
            darkGreatHelm: {male: "maleDarkGreatHelm", female: "femaleDarkGreatHelm"},
            lightGreatHelm: {male: "maleLightGreatHelm", female: "femaleLightGreatHelm"},
            spanishHorseHelmet: {male: "maleSpanishHorseHelmet", female: "femaleSpanishHorseHelmet"},
            grandSpanishHorseHelmet: {male: "maleGrandSpanishHorseHelmet", female: "femaleGrandSpanishHorseHelmet"},
            hornedHelmet: {male: "maleHornedHelmet", female: "femaleHornedHelmet"},
            forestDefenderHelmet: {male: "maleForestDefenderHelmet", female: "femaleForestDefenderHelmet"},
            vikingHelmet: {male: "maleVikingHelmet", female: "femaleVikingHelmet"},
            steelAngelBarbute: {male: "maleSteelAngelBarbute", female: "femaleSteelAngelBarbute"},
            hair: {male: "maleHair", female: "femaleHair"},
            hatHair: {male: "maleHatHair", female: "femaleHatHair"},
            nobleBody: {male: "maleNobleBody", female: "femaleNobleBody"},
            nobleHands: {male: "maleNobleHands", female: "femaleNobleHands"},
            nobleLegs: {male: "maleNobleLegs", female: "femaleNobleLegs"},
            nobleFoots: {male: "maleNobleFoots", female: "femaleNobleFoots"},
            steelBody: {male: "maleSteelBody", female: "femaleSteelBody"},
            steelHead: {male: "maleSteelHead", female: "femaleSteelHead"},
            steelHands: {male: "maleSteelHands", female: "femaleSteelHands"},
            steelLegs: {male: "maleSteelLegs", female: "femaleSteelLegs"},
            steelFoots: {male: "maleSteelFoots", female: "femaleSteelFoots"},
            copperBody: {male: "maleCopperBody", female: "femaleCopperBody"},
            bronzeBody: {male: "maleBronzeBody", female: "femaleBronzeBody"},
            bronzeHead: {male: "maleBronzeHead", female: "femaleBronzeHead"},
            bronzeHands: {male: "maleBronzeHands", female: "femaleBronzeHands"},
            bronzeLegs: {male: "maleBronzeLegs", female: "femaleBronzeLegs"},
            bronzeFoots: {male: "maleBronzeFoots", female: "femaleBronzeFoots"},
            ironBody: {male: "maleIronBody", female: "femaleIronBody"},
            ironHead: {male: "maleIronHead", female: "femaleIronHead"},
            ironHands: {male: "maleIronHands", female: "femaleIronHands"},
            ironLegs: {male: "maleIronLegs", female: "femaleIronLegs"},
            ironFoots: {male: "maleIronFoots", female: "femaleIronFoots"},
            leatherBody: {male: "maleLeatherBody", female: "femaleLeatherBody"},
            leatherHead: {male: "maleLeatherHead", female: "femaleLeatherHead"},
            leatherHands: {male: "maleLeatherHands", female: "femaleLeatherHands"},
            leatherLegs: {male: "maleLeatherLegs", female: "femaleLeatherLegs"},
            leatherFoots: {male: "maleLeatherFoots", female: "femaleLeatherFoots"},
            hideBody: {male: "maleHideBody", female: "femaleHideBody"},
            hideHead: {male: "maleHideHead", female: "femaleHideHead"},
            hideHands: {male: "maleHideHands", female: "femaleHideHands"},
            hideLegs: {male: "maleHideLegs", female: "femaleHideLegs"},
            hideFoots: {male: "maleHideFoots", female: "femaleHideFoots"},
            rawHideBody: {male: "maleRawHideBody", female: "femaleRawHideBody"},
            rawHideHead: {male: "maleRawHideHead", female: "femaleRawHideHead"},
            rawHideHands: {male: "maleRawHideHands", female: "femaleRawHideHands"},
            rawHideLegs: {male: "maleRawHideLegs", female: "femaleRawHideLegs"},
            rawHideFoots: {male: "maleRawHideFoots", female: "femaleRawHideFoots"}
        }, this._models = {
            stoneAxe: {fileIndex: "stone_axe", meshName: "stone_axe", bindTo: {bone: this.boneNames.rightHand}},
            copperAxe: {fileIndex: "copper_axe", meshName: "copper_axe", bindTo: {bone: this.boneNames.rightHand}},
            bronzeAxe: {fileIndex: "bronze_axe", meshName: "bronze_axe", bindTo: {bone: this.boneNames.rightHand}},
            ironAxe: {fileIndex: "iron_axe", meshName: "iron_axe", bindTo: {bone: this.boneNames.rightHand}},
            steelAxe: {fileIndex: "steel_axe", meshName: "steel_axe", bindTo: {bone: this.boneNames.rightHand}},
            copperSword: {
                fileIndex: "copper_sword",
                meshName: "copper_sword",
                bindTo: {bone: this.boneNames.rightHand}
            },
            bronzeSword: {
                fileIndex: "bronze_sword",
                meshName: "bronze_sword",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironSword: {fileIndex: "iron_sword", meshName: "iron_sword", bindTo: {bone: this.boneNames.rightHand}},
            steelSword: {fileIndex: "steel_sword", meshName: "steel_sword", bindTo: {bone: this.boneNames.rightHand}},
            nobleSword: {fileIndex: "noble_sword", meshName: "noble_sword", bindTo: {bone: this.boneNames.rightHand}},
            adminSword: {fileIndex: "admin_sword", meshName: "admin_sword", bindTo: {bone: this.boneNames.rightHand}},
            stoneHammer: {
                fileIndex: "stone_hammer",
                meshName: "stone_hammer",
                bindTo: {bone: this.boneNames.rightHand}
            },
            bronzeHammer: {
                fileIndex: "bronze_hammer",
                meshName: "bronze_hammer",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironHammer: {fileIndex: "iron_hammer", meshName: "iron_hammer", bindTo: {bone: this.boneNames.rightHand}},
            steelHammer: {
                fileIndex: "steel_hammer",
                meshName: "steel_hammer",
                bindTo: {bone: this.boneNames.rightHand}
            },
            stonePick: {fileIndex: "stone_pick", meshName: "stone_pick", bindTo: {bone: this.boneNames.rightHand}},
            bronzePick: {fileIndex: "bronze_pick", meshName: "bronze_pick", bindTo: {bone: this.boneNames.rightHand}},
            ironPick: {fileIndex: "iron_pick", meshName: "iron_pick", bindTo: {bone: this.boneNames.rightHand}},
            steelPick: {fileIndex: "steel_pick", meshName: "steel_pick", bindTo: {bone: this.boneNames.rightHand}},
            stoneKnife: {fileIndex: "stone_knife", meshName: "stone_knife", bindTo: {bone: this.boneNames.rightHand}},
            copperKnife: {
                fileIndex: "copper_knife",
                meshName: "copper_knife",
                bindTo: {bone: this.boneNames.rightHand}
            },
            bronzeKnife: {
                fileIndex: "bronze_knife",
                meshName: "bronze_knife",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironKnife: {fileIndex: "iron_knife", meshName: "iron_knife", bindTo: {bone: this.boneNames.rightHand}},
            steelKnife: {fileIndex: "steel_knife", meshName: "steel_knife", bindTo: {bone: this.boneNames.rightHand}},
            copperSaw: {fileIndex: "copper_saw", meshName: "copper_saw", bindTo: {bone: this.boneNames.rightHand}},
            ironSaw: {fileIndex: "iron_saw", meshName: "iron_saw", bindTo: {bone: this.boneNames.rightHand}},
            steelSaw: {fileIndex: "steel_saw", meshName: "steel_saw", bindTo: {bone: this.boneNames.rightHand}},
            copperScissors: {
                fileIndex: "copper_scissors",
                meshName: "copper_scissors",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironScissors: {
                fileIndex: "iron_scissors",
                meshName: "iron_scissors",
                bindTo: {bone: this.boneNames.rightHand}
            },
            steelScissors: {
                fileIndex: "steel_scissors",
                meshName: "steel_scissors",
                bindTo: {bone: this.boneNames.rightHand}
            },
            copperSickle: {
                fileIndex: "copper_sickle",
                meshName: "copper_sickle",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironSickle: {fileIndex: "iron_sickle", meshName: "iron_sickle", bindTo: {bone: this.boneNames.rightHand}},
            steelSickle: {
                fileIndex: "steel_sickle",
                meshName: "steel_sickle",
                bindTo: {bone: this.boneNames.rightHand}
            },
            linenLariat: {
                fileIndex: "linen_lariat",
                meshName: "linen_lariat",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironLariat: {fileIndex: "iron_lariat", meshName: "iron_lariat", bindTo: {bone: this.boneNames.rightHand}},
            steelLariat: {
                fileIndex: "steel_lariat",
                meshName: "steel_lariat",
                bindTo: {bone: this.boneNames.rightHand}
            },
            woodenShovel: {
                fileIndex: "wooden_shovel",
                meshName: "wooden_shovel",
                bindTo: {bone: this.boneNames.rightHand}
            },
            ironShovel: {fileIndex: "iron_shovel", meshName: "iron_shovel", bindTo: {bone: this.boneNames.rightHand}},
            simpleSling: {fileIndex: "sling", meshName: "sling", bindTo: {bone: this.boneNames.rightHand}},
            hunterSling: {
                fileIndex: "hunter_sling",
                meshName: "hunter_sling",
                bindTo: {bone: this.boneNames.rightHand}
            },
            woodenSpear: {
                fileIndex: "wooden_spear",
                meshName: "wooden_spear",
                bindTo: {bone: this.boneNames.rightHand}
            },
            bronzeSpear: {
                fileIndex: "bronze_spear",
                meshName: "bronze_spear",
                bindTo: {bone: this.boneNames.rightHand}
            },
            woodenShield: {
                fileIndex: "wooden_shield",
                meshName: "wooden_shield",
                bindTo: {bone: this.boneNames.leftTwist}
            },
            bronzeRoundShield: {
                fileIndex: "bronze_circle_shield",
                meshName: "bronze_circle_shield",
                bindTo: {bone: this.boneNames.leftTwist}
            },
            bronzeLargeShield: {
                fileIndex: "bronze_great_shield",
                meshName: "bronze_great_shield",
                bindTo: {bone: this.boneNames.leftTwist}
            },
            ironShield: {fileIndex: "iron_shield", meshName: "iron_shield", bindTo: {bone: this.boneNames.leftTwist}},
            steelShield: {
                fileIndex: "steel_shield",
                meshName: "steel_shield",
                bindTo: {bone: this.boneNames.leftTwist}
            },
            nobleShield: {
                fileIndex: "noble_shield",
                meshName: "noble_shield",
                bindTo: {bone: this.boneNames.leftTwist}
            },
            woodenBow: {fileIndex: "bow", meshName: "bow", bindTo: {bone: this.boneNames.leftHand}},
            hunterBow: {fileIndex: "hunter_bow", meshName: "hunter_bow", bindTo: {bone: this.boneNames.leftHand}},
            compositeBow: {
                fileIndex: "compound_bow",
                meshName: "compound_bow",
                bindTo: {bone: this.boneNames.leftHand}
            },
            shortBow: {fileIndex: "short_bow", meshName: "short_bow", bindTo: {bone: this.boneNames.leftHand}},
            adminBow: {fileIndex: "admin_bow", meshName: "admin_bow", bindTo: {bone: this.boneNames.leftHand}},
            copperBucket: {
                fileIndex: "copper_bucket",
                meshName: "copper_bucket",
                bindTo: {bone: this.boneNames.leftHand}
            },
            copperBucketWater: {
                fileIndex: "copper_bucket_water",
                meshName: "copper_bucket_water",
                bindTo: {bone: this.boneNames.leftHand}
            },
            ironBucket: {fileIndex: "bucket", meshName: "bucket", bindTo: {bone: this.boneNames.leftHand}},
            waterBucket: {fileIndex: "bucket_water", meshName: "bucket_water", bindTo: {bone: this.boneNames.leftHand}},
            torch: {fileIndex: "torch", meshName: "torch", bindTo: {bone: this.boneNames.leftHand}},
            linenCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "linen",
                bindTo: {bone: this.boneNames.mount}
            },
            witchCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "witch",
                bindTo: {bone: this.boneNames.mount}
            },
            bearCloak: {fileIndex: "cloaks", meshName: "cloak", material: "bear", bindTo: {bone: this.boneNames.mount}},
            nobleCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "noble",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenWhiteCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_white",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenGreyCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_grey",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenRedCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_red",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenYellowCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_yellow",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenGreenCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_green",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenBlueCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_blue",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenVioletCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_violet",
                bindTo: {bone: this.boneNames.mount}
            },
            woolenBrownCloak: {
                fileIndex: "cloaks",
                meshName: "cloak",
                material: "woolen_brown",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleBareBody: {fileIndex: "femaleBare", meshName: "bare_body", bindTo: {bone: this.boneNames.mount}},
            femaleBareHead: {fileIndex: "femaleBare", meshName: "bare_head", bindTo: {bone: this.boneNames.mount}},
            femaleBareHands: {fileIndex: "femaleBare", meshName: "bare_hands", bindTo: {bone: this.boneNames.mount}},
            femaleBareLegs: {fileIndex: "femaleBare", meshName: "bare_legs", bindTo: {bone: this.boneNames.mount}},
            femaleBareFoots: {fileIndex: "femaleBare", meshName: "bare_foots", bindTo: {bone: this.boneNames.mount}},
            femaleHair: {
                fileIndex: "femaleHair",
                meshName: "hair",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            femaleHatHair: {
                fileIndex: "femaleHair",
                meshName: "hat_hair",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            femaleRawHideBody: {
                fileIndex: "femaleRawHide",
                meshName: "raw_hide_body",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleRawHideHead: {
                fileIndex: "femaleRawHide",
                meshName: "raw_hide_head",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleRawHideHands: {
                fileIndex: "femaleRawHide",
                meshName: "raw_hide_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleRawHideLegs: {
                fileIndex: "femaleRawHide",
                meshName: "raw_hide_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleRawHideFoots: {
                fileIndex: "femaleRawHide",
                meshName: "raw_hide_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleHideBody: {fileIndex: "femaleHide", meshName: "hide_body", bindTo: {bone: this.boneNames.mount}},
            femaleHideHead: {fileIndex: "femaleHide", meshName: "hide_head", bindTo: {bone: this.boneNames.mount}},
            femaleHideHands: {fileIndex: "femaleHide", meshName: "hide_hands", bindTo: {bone: this.boneNames.mount}},
            femaleHideLegs: {fileIndex: "femaleHide", meshName: "hide_legs", bindTo: {bone: this.boneNames.mount}},
            femaleHideFoots: {fileIndex: "femaleHide", meshName: "hide_foots", bindTo: {bone: this.boneNames.mount}},
            femaleLeatherBody: {
                fileIndex: "femaleLeather",
                meshName: "leather_body",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleLeatherHead: {
                fileIndex: "femaleLeather",
                meshName: "leather_head",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleLeatherHands: {
                fileIndex: "femaleLeather",
                meshName: "leather_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleLeatherLegs: {
                fileIndex: "femaleLeather",
                meshName: "leather_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleLeatherFoots: {
                fileIndex: "femaleLeather",
                meshName: "leather_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleCopperBody: {
                fileIndex: "femaleCopperBody",
                meshName: "copper_body",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleBronzeBody: {
                fileIndex: "femaleBronzeBody",
                meshName: "bronze_body",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleBronzeHead: {
                fileIndex: "femaleBronzeArmor",
                meshName: "bronze_head",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleBronzeHands: {
                fileIndex: "femaleBronzeArmor",
                meshName: "bronze_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleBronzeLegs: {
                fileIndex: "femaleBronzeArmor",
                meshName: "bronze_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleBronzeFoots: {
                fileIndex: "femaleBronzeArmor",
                meshName: "bronze_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleIronBody: {fileIndex: "femaleIronBody", meshName: "iron_body", bindTo: {bone: this.boneNames.mount}},
            femaleIronHead: {fileIndex: "femaleIronArmor", meshName: "iron_head", bindTo: {bone: this.boneNames.mount}},
            femaleIronHands: {
                fileIndex: "femaleIronArmor",
                meshName: "iron_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleIronLegs: {fileIndex: "femaleIronArmor", meshName: "iron_legs", bindTo: {bone: this.boneNames.mount}},
            femaleIronFoots: {
                fileIndex: "femaleIronArmor",
                meshName: "iron_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSteelBody: {
                fileIndex: "femaleSteelBody",
                meshName: "steel_body",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSteelHead: {
                fileIndex: "femaleSteelArmor",
                meshName: "steel_head",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSteelHands: {
                fileIndex: "femaleSteelArmor",
                meshName: "steel_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSteelLegs: {
                fileIndex: "femaleSteelArmor",
                meshName: "steel_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSteelFoots: {
                fileIndex: "femaleSteelArmor",
                meshName: "steel_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleNobleBody: {
                fileIndex: "femaleNobleBody",
                meshName: "noble_body",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleNobleHands: {
                fileIndex: "femaleNobleArmor",
                meshName: "noble_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleNobleLegs: {
                fileIndex: "femaleNobleArmor",
                meshName: "noble_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleNobleFoots: {
                fileIndex: "femaleNobleArmor",
                meshName: "noble_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            maleFarmerHat: {
                fileIndex: "farmerHat",
                meshName: "m_farmer_hat",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            femaleFarmerHat: {
                fileIndex: "farmerHat",
                meshName: "w_farmer_hat",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            maleWitchHat: {
                fileIndex: "witchHat",
                meshName: "m_witch_hat",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            femaleWitchHat: {
                fileIndex: "witchHat",
                meshName: "w_witch_hat",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            maleHareHat: {fileIndex: "hareHat", meshName: "m_hare_hat", bindTo: {bone: this.boneNames.mount}},
            femaleHareHat: {fileIndex: "hareHat", meshName: "w_hare_hat", bindTo: {bone: this.boneNames.mount}},
            maleDeerHat: {fileIndex: "deerHat", meshName: "m_deer_hat", bindTo: {bone: this.boneNames.mount}},
            femaleDeerHat: {fileIndex: "deerHat", meshName: "w_deer_hat", bindTo: {bone: this.boneNames.mount}},
            maleBoarHat: {fileIndex: "boarHat", meshName: "m_boar_hat", bindTo: {bone: this.boneNames.mount}},
            femaleBoarHat: {fileIndex: "boarHat", meshName: "w_boar_hat", bindTo: {bone: this.boneNames.mount}},
            maleWolfHat: {fileIndex: "wolfHat", meshName: "m_wolf_hat", bindTo: {bone: this.boneNames.mount}},
            femaleWolfHat: {fileIndex: "wolfHat", meshName: "w_wolf_hat", bindTo: {bone: this.boneNames.mount}},
            maleBearHat: {fileIndex: "bearHat", meshName: "m_bear_hat", bindTo: {bone: this.boneNames.mount}},
            femaleBearHat: {fileIndex: "bearHat", meshName: "w_bear_hat", bindTo: {bone: this.boneNames.mount}},
            malePlagueMask: {
                fileIndex: "plagueMask",
                meshName: "m_plague_doctor_mask",
                bindTo: {bone: this.boneNames.mount}
            },
            femalePlagueMask: {
                fileIndex: "plagueMask",
                meshName: "w_plague_doctor_mask",
                bindTo: {bone: this.boneNames.mount}
            },
            maleDarkBurgonet: {fileIndex: "darkBurgonet", meshName: "m_burgonet", bindTo: {bone: this.boneNames.mount}},
            femaleDarkBurgonet: {
                fileIndex: "darkBurgonet",
                meshName: "w_burgonet",
                bindTo: {bone: this.boneNames.mount}
            },
            maleDarkBarbute: {
                fileIndex: "darkBarbute",
                meshName: "m_black_barbute",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleDarkBarbute: {
                fileIndex: "darkBarbute",
                meshName: "w_black_barbute",
                bindTo: {bone: this.boneNames.mount}
            },
            maleLightBarbute: {
                fileIndex: "lightBarbute",
                meshName: "m_light_barbute",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleLightBarbute: {
                fileIndex: "lightBarbute",
                meshName: "w_light_barbute",
                bindTo: {bone: this.boneNames.mount}
            },
            maleDarkGreatHelm: {
                fileIndex: "darkGreatHelm",
                meshName: "m_black_great_helm",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleDarkGreatHelm: {
                fileIndex: "darkGreatHelm",
                meshName: "w_black_great_helm",
                bindTo: {bone: this.boneNames.mount}
            },
            maleLightGreatHelm: {
                fileIndex: "lightGreatHelm",
                meshName: "m_light_great_helm",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleLightGreatHelm: {
                fileIndex: "lightGreatHelm",
                meshName: "w_light_great_helm",
                bindTo: {bone: this.boneNames.mount}
            },
            maleSpanishHorseHelmet: {
                fileIndex: "spanishHorseHelmet",
                meshName: "m_spanish_horse_helmet",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSpanishHorseHelmet: {
                fileIndex: "spanishHorseHelmet",
                meshName: "w_spanish_horse_helmet",
                bindTo: {bone: this.boneNames.mount}
            },
            maleGrandSpanishHorseHelmet: {
                fileIndex: "grandSpanishHorseHelmet",
                meshName: "m_grand_spanish_horse_helmet",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleGrandSpanishHorseHelmet: {
                fileIndex: "grandSpanishHorseHelmet",
                meshName: "w_grand_spanish_horse_helmet",
                bindTo: {bone: this.boneNames.mount}
            },
            maleHornedHelmet: {
                fileIndex: "hornedHelmet",
                meshName: "m_horned_kubelhelm",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleHornedHelmet: {
                fileIndex: "hornedHelmet",
                meshName: "w_horned_kubelhelm",
                bindTo: {bone: this.boneNames.mount}
            },
            maleForestDefenderHelmet: {
                fileIndex: "forestDefenderHelmet",
                meshName: "m_forest_defender_helm",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleForestDefenderHelmet: {
                fileIndex: "forestDefenderHelmet",
                meshName: "w_forest_defender_helm",
                bindTo: {bone: this.boneNames.mount}
            },
            maleVikingHelmet: {
                fileIndex: "vikingHelmet",
                meshName: "m_viking_helmet",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleVikingHelmet: {
                fileIndex: "vikingHelmet",
                meshName: "w_viking_helmet",
                bindTo: {bone: this.boneNames.mount}
            },
            maleSteelAngelBarbute: {
                fileIndex: "steelAngelBarbute",
                meshName: "m_steel_angel_barbute",
                bindTo: {bone: this.boneNames.mount}
            },
            femaleSteelAngelBarbute: {
                fileIndex: "steelAngelBarbute",
                meshName: "w_steel_angel_barbute",
                bindTo: {bone: this.boneNames.mount}
            },
            maleBareBody: {fileIndex: "maleBare", meshName: "bare_body", bindTo: {bone: this.boneNames.mount}},
            maleBareHead: {fileIndex: "maleBare", meshName: "bare_head", bindTo: {bone: this.boneNames.mount}},
            maleBareHands: {fileIndex: "maleBare", meshName: "bare_hands", bindTo: {bone: this.boneNames.mount}},
            maleBareLegs: {fileIndex: "maleBare", meshName: "bare_legs", bindTo: {bone: this.boneNames.mount}},
            maleBareFoots: {fileIndex: "maleBare", meshName: "bare_foots", bindTo: {bone: this.boneNames.mount}},
            maleHair: {fileIndex: "maleHair", meshName: "hair", bindTo: {wearSlot: "head", bone: this.boneNames.head}},
            maleHatHair: {
                fileIndex: "maleHair",
                meshName: "hat_hair",
                bindTo: {wearSlot: "head", bone: this.boneNames.head}
            },
            maleRawHideBody: {
                fileIndex: "maleRawHide",
                meshName: "raw_hide_body",
                bindTo: {bone: this.boneNames.mount}
            },
            maleRawHideHead: {
                fileIndex: "maleRawHide",
                meshName: "raw_hide_head",
                bindTo: {bone: this.boneNames.mount}
            },
            maleRawHideHands: {
                fileIndex: "maleRawHide", meshName: "raw_hide_hands", bindTo: {bone: this.boneNames.mount}
            },
            maleRawHideLegs: {
                fileIndex: "maleRawHide",
                meshName: "raw_hide_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            maleRawHideFoots: {
                fileIndex: "maleRawHide",
                meshName: "raw_hide_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            maleHideBody: {fileIndex: "maleHide", meshName: "hide_body", bindTo: {bone: this.boneNames.mount}},
            maleHideHead: {fileIndex: "maleHide", meshName: "hide_head", bindTo: {bone: this.boneNames.mount}},
            maleHideHands: {fileIndex: "maleHide", meshName: "hide_hands", bindTo: {bone: this.boneNames.mount}},
            maleHideLegs: {fileIndex: "maleHide", meshName: "hide_legs", bindTo: {bone: this.boneNames.mount}},
            maleHideFoots: {fileIndex: "maleHide", meshName: "hide_foots", bindTo: {bone: this.boneNames.mount}},
            maleLeatherBody: {fileIndex: "maleLeather", meshName: "leather_body", bindTo: {bone: this.boneNames.mount}},
            maleLeatherHead: {fileIndex: "maleLeather", meshName: "leather_head", bindTo: {bone: this.boneNames.mount}},
            maleLeatherHands: {
                fileIndex: "maleLeather",
                meshName: "leather_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            maleLeatherLegs: {fileIndex: "maleLeather", meshName: "leather_legs", bindTo: {bone: this.boneNames.mount}},
            maleLeatherFoots: {
                fileIndex: "maleLeather",
                meshName: "leather_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            maleCopperBody: {
                fileIndex: "maleCopperBody",
                meshName: "copper_body",
                bindTo: {bone: this.boneNames.mount}
            },
            maleBronzeBody: {
                fileIndex: "maleBronzeBody",
                meshName: "bronze_body",
                bindTo: {bone: this.boneNames.mount}
            },
            maleBronzeHead: {
                fileIndex: "maleBronzeArmor",
                meshName: "bronze_head",
                bindTo: {bone: this.boneNames.mount}
            },
            maleBronzeHands: {
                fileIndex: "maleBronzeArmor",
                meshName: "bronze_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            maleBronzeLegs: {
                fileIndex: "maleBronzeArmor",
                meshName: "bronze_legs",
                bindTo: {bone: this.boneNames.mount}
            },
            maleBronzeFoots: {
                fileIndex: "maleBronzeArmor",
                meshName: "bronze_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            maleIronBody: {fileIndex: "maleIronBody", meshName: "iron_body", bindTo: {bone: this.boneNames.mount}},
            maleIronHead: {fileIndex: "maleIronArmor", meshName: "iron_head", bindTo: {bone: this.boneNames.mount}},
            maleIronHands: {fileIndex: "maleIronArmor", meshName: "iron_hands", bindTo: {bone: this.boneNames.mount}},
            maleIronLegs: {fileIndex: "maleIronArmor", meshName: "iron_legs", bindTo: {bone: this.boneNames.mount}},
            maleIronFoots: {fileIndex: "maleIronArmor", meshName: "iron_foots", bindTo: {bone: this.boneNames.mount}},
            maleSteelBody: {fileIndex: "maleSteelBody", meshName: "steel_body", bindTo: {bone: this.boneNames.mount}},
            maleSteelHead: {fileIndex: "maleSteelArmor", meshName: "steel_head", bindTo: {bone: this.boneNames.mount}},
            maleSteelHands: {
                fileIndex: "maleSteelArmor",
                meshName: "steel_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            maleSteelLegs: {fileIndex: "maleSteelArmor", meshName: "steel_legs", bindTo: {bone: this.boneNames.mount}},
            maleSteelFoots: {
                fileIndex: "maleSteelArmor",
                meshName: "steel_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            maleNobleBody: {fileIndex: "maleNobleBody", meshName: "noble_body", bindTo: {bone: this.boneNames.mount}},
            maleNobleHands: {
                fileIndex: "maleNobleArmor",
                meshName: "noble_hands",
                bindTo: {bone: this.boneNames.mount}
            },
            maleNobleLegs: {fileIndex: "maleNobleArmor", meshName: "noble_legs", bindTo: {bone: this.boneNames.mount}},
            maleNobleFoots: {
                fileIndex: "maleNobleArmor",
                meshName: "noble_foots",
                bindTo: {bone: this.boneNames.mount}
            },
            "horse-bay": {fileIndex: "horse", meshName: "Horse", material: "bay"},
            "horse-white": {fileIndex: "horse", meshName: "Horse", material: "white"},
            "horse-black": {fileIndex: "horse", meshName: "Horse", material: "black"},
            "horse-grey": {fileIndex: "horse", meshName: "Horse", material: "grey"},
            "horse-spotted": {fileIndex: "horse", meshName: "Horse", material: "spotted"},
            "horse-kaur": {fileIndex: "horse", meshName: "Horse", material: "kaur"},
            "horse-pintobay": {fileIndex: "horse", meshName: "Horse", material: "pintobay"},
            "horse-dun": {fileIndex: "horse", meshName: "Horse", material: "dun"},
            "horse-zebra": {fileIndex: "horse", meshName: "Horse", material: "zebra"},
            hen: {fileIndex: "hen", meshName: "Hen"},
            raven: {fileIndex: "raven", meshName: "Raven"},
            ferret: {fileIndex: "ferret", meshName: "Ferret"},
            fox: {fileIndex: "fox", meshName: "Fox"},
            hare: {fileIndex: "hare", meshName: "Hare"},
            deer: {fileIndex: "deer", meshName: "Deer"},
            boar: {fileIndex: "boar", meshName: "Boar"},
            wolf: {fileIndex: "wolf", meshName: "Wolf"},
            "bear-brown": {fileIndex: "bear", meshName: "Bear", material: "brown"},
            "bear-white": {fileIndex: "bear", meshName: "Bear", material: "white"},
            "bear-black": {fileIndex: "bear", meshName: "Bear", material: "black"},
            "bear-panda": {fileIndex: "bear", meshName: "Bear", material: "panda"}
        }, this.animationNames = {
            stay: {index: 0},
            move: {index: 1},
            run: {index: 2},
            craft: {index: 3},
            hit: {index: 4},
            bowShot: {index: 5},
            injury: {index: 6},
            death: {index: 7}
        }, this._fileMaterials = {};
        var c = this;
        return Object.keys(c._models).forEach(function (a) {
            var b = c._models[a], d = c._files[b.fileIndex];
            d.objects || (d.objects = {}), d.objects[b.meshName] = a, b.baseScale = d.baseScale ? d.baseScale : 1, b.material && (c._fileMaterials[b.fileIndex] || (c._fileMaterials[b.fileIndex] = []), c._fileMaterials[b.fileIndex].push({
                modelName: a,
                material: b.material
            }))
        }), this.getBindModelBoneIndex = function (a, b) {
            return this._typeModels[a] && (a = this._typeModels[a][b]), this.types[b].bones[this._models[a].bindTo.bone]
        }, this.getModelName = function (a, b) {
            return this._typeModels[a] && (a = this._typeModels[a][b]), this._models[a] ? a : null
        }, this.isModelExist = function (a, b) {
            return this._typeModels[a] && (a = this._typeModels[a][b]), "undefined" != typeof this._models[a]
        }, this.getOrLoadModel = function (d, e, f) {
            function g(b) {
                for (var c = 0, d = b.length; d > c; c++) {
                    var e = b[c];
                    e instanceof a.Bone ? g(e.children) : e instanceof a.SEA3D.Mesh && i.push(e)
                }
            }

            var h;
            h = this._typeModels[d] ? this._typeModels[d][e] : d;
            var i;
            if (this._cache[h])f(this._cache[h], this._materials[h], this._models[h].baseScale); else {
                var j = this._models[h];
                if (j) {
                    var k = this._files[j.fileIndex], l = new a.SEA3D({});
                    l.onComplete = function () {
                        k.objects ? b.each(Object.keys(k.objects), function (a, b) {
                            var d = l.getMesh(a);
                            if (d)if (d.children && !k.hasChildren ? delete d.children : (d.childMeshes = i = [], g(d.children)), c._fileMaterials[j.fileIndex]) {
                                var e = c._fileMaterials[j.fileIndex];
                                delete c._fileMaterials[j.fileIndex];
                                for (var f = 0, m = e.length; m > f; f++) {
                                    var n = e[f], o = l.getMaterial(n.material);
                                    o ? (c._materials[n.modelName] = o, c._cache[n.modelName] = d) : console.error("No material", n.material, "in file:", k.file, a, h)
                                }
                            } else c._cache[k.objects[a]] = d; else console.error("No mesh in file:", k.file, a, h);
                            b()
                        }, function () {
                            f(c._cache[h], c._materials[h], c._models[h].baseScale)
                        }) : console.error("No meshes for file:", k.file, h)
                    }, l.onError = function (a) {
                        console.error("Model load error:", d, h, k.file, a), f()
                    }, l.load(k.file)
                } else console.error("Wrong model key:", d, h), f()
            }
        }, this
    }
}),define("KME/states/Preloader", ["phaser", "jquery", "i18next", "KME/utils/AssetController", "KME/utils/SoundAtlas", "KME/utils/ModelAtlas", "KME/utils/ItemSpriteAtlas", "KME/utils/WorldSpriteAtlas"], function () {
    KME.Preloader = function (a) {
        this.game = a, this.background = null, this.preloadBar = null, this.ready = !1
    }, KME.Preloader.prototype = {
        preload: function () {
            this.preloaderBackLogo = this.add.sprite(this.game.width / 2, this.game.height / 2, "preloaderBackLogo"), this.preloadBar = this.add.sprite(this.game.width / 2, this.game.height / 2, "preloaderBar"), this.preloaderBackLogo.x -= this.preloaderBackLogo.width / 2, this.preloaderBackLogo.y -= this.preloaderBackLogo.height / 2, this.preloadBar.x -= this.preloadBar.width / 2, this.preloadBar.y -= this.preloadBar.height / 2;
            var a;
            a = this.add.text(this.game.width / 2 + 10, this.preloaderBackLogo.y + 280, $.t("interfaces:load.version"), {
                font: "14px TrajanPro3-Bold",
                fill: "#FFD700",
                align: "center"
            }), a.anchor.x = .5, a.anchor.y = 0, a.setShadow(2, 2, "rgba(0,0,0,0.7)", 2), a = this.add.text(this.game.width / 2 + 10, this.preloaderBackLogo.y + 325, $.t("interfaces:load.warning"), {
                font: "18px TrajanPro3-Bold",
                fill: "#FF7C00",
                align: "center"
            }), a.anchor.x = .5, a.anchor.y = 0, a.setShadow(2, 2, "rgba(0,0,0,0.7)", 2), a = this.add.text(this.game.width / 2 + 10, this.preloaderBackLogo.y + 355, $.t("interfaces:load.description"), {
                font: "14px TrajanPro3-Bold",
                fill: "#FFD700",
                align: "center"
            }), a.anchor.x = .5, a.anchor.y = 0, a.setShadow(2, 2, "rgba(0,0,0,0.7)", 2), this.load.setPreloadSprite(this.preloadBar), KME.utils.assets = new KME.AssetController(this.game), KME.utils.soundAtlas = new KME.SoundAtlas(this.game), KME.utils.modelAtlas = new KME.ModelAtlas, console.log("Loading started...")
        }, create: function () {
            if (KME.utils.itematlas = new KME.ItemSpriteAtlas(this.game), KME.utils.worldatlas = new KME.WorldSpriteAtlas(this.game), KME.utils.modelAtlas = new KME.ModelAtlas, "undefined" == typeof io)KME.sendError("interfaces:serverErrors.socketInitError"); else {
                var a = this;
                KME.controllers.network.requests.requestTypes(function (b) {
                    KME.types = b, KME.world.phasermap = new Phaser.TilemapIsometric(a.game), KME.controllers.network.requests.requestMapSettings(function (b) {
                        KME.world.phasermap.setWorldSettings(b, function () {
                            KME.utils.worldatlas.createBuildImageSources(KME.types.buildTypes), $.i18n.loadNamespaces(["interfaces", "actions", "objects", "messages", "skills"], function () {
                                a.state.start("Game")
                            })
                        })
                    })
                })
            }
        }, update: function () {
        }
    }
}),define("KME/controllers/game/GameController", ["jquery", "../network/NetworkController"], function (a, b) {
    return {
        init: function () {
        }, gameStart: function (a, c) {
            b.actions.gameStart(a, function (a, b) {
                c(b)
            })
        }, _: {}
    }
}),define("KME/controllers/input/MouseController", [], function () {
    return {
        init: function (a) {
            a._clickDown = null, this._.register(a)
        }, _: {
            register: function (a) {
                a.game.input.onDown.add(function (b) {
                    KME.mainPlayer && KME.mainPlayer.pointerChange(b), a._clickDown = Date.now()
                }, a), a.game.input.onUp.add(function () {
                    a._clickDown = null
                }, a)
            }
        }
    }
}),define("KME/controllers/input/KeyboardController", ["async", "KME/controllers/data/actions/ActionsController", "KME/interfaces/Toolbar", "KME/interfaces/ActionsBar"], function (a) {
    function b(a, b) {
        a.keys.inventory = a.game.input.keyboard.addKey(Phaser.Keyboard.I), a.keys.interfaces = a.game.input.keyboard.addKey(Phaser.Keyboard.T), a.keys.craft = a.game.input.keyboard.addKey(Phaser.Keyboard.C), a.keys.build = a.game.input.keyboard.addKey(Phaser.Keyboard.B), a.keys.actions = a.game.input.keyboard.addKey(Phaser.Keyboard.A), a.keys.skills = a.game.input.keyboard.addKey(Phaser.Keyboard.K), a.keys.fullOpacityOn = a.game.input.keyboard.addKey(Phaser.Keyboard.G), a.keys.fullOpacityOn.onDown.add(function () {
            a.fullOpacityOnOff()
        }, a), a.keys.roofsOnOff = a.game.input.keyboard.addKey(Phaser.Keyboard.H), a.keys.roofsOnOff.onDown.add(function () {
            a.roofsOnOff()
        }, a), a.keys.playerChangeTitle = a.game.input.keyboard.addKey(Phaser.Keyboard.R), a.keys.playerChangeTitle.onDown.add(function () {
            a.playerChangeTitle()
        }, a), window.nwin && (a.keys.zoomPlus = a.game.input.keyboard.addKey(Phaser.Keyboard.NUMPAD_ADD), a.keys.zoomPlus.onDown.add(function () {
            KME.world.view.zoomPlus()
        }, KME.world.view), a.keys.zoomMinus = a.game.input.keyboard.addKey(Phaser.Keyboard.NUMPAD_SUBTRACT), a.keys.zoomMinus.onDown.add(function () {
            KME.world.view.zoomMinus()
        }, KME.world.view)), a.keys.inventory.onDown.add(function () {
            KME.interfaces.inventory.inventory("toggle")
        }, a), a.keys.interfaces.onDown.add(function () {
            a.interfaceOnOff(), $("#interfaceWrapper").toggle(), $("#CornerBar").toggle(), $("#launcher").toggle(), $(".pdebug").toggle()
        }, a), a.keys.craft.onDown.add(function () {
            KME.controllers.data.actions.craft(null, null, "tap")
        }, a), a.keys.build.onDown.add(function () {
            KME.controllers.data.actions.build(null, null, "tap")
        }, a), a.keys.skills.onDown.add(function () {
            KME.interfaces.skillsWindow.skillsWindow("toggle")
        }, a), a.keys.actions.onDown.add(function () {
            KME.interfaces.actionsWindow.actionsWindow("toggle")
        }, a), $(document).on("keypress", function (a) {
            13 === a.charCode && KME.interfaces.chatWindow.chatWindow("open")
        }), b(null, a)
    }

    function c(a, b) {
        a.keys.stay = a.game.input.keyboard.addKey(Phaser.Keyboard.SHIFT), a.keys.stay.onDown.add(function () {
            KME.controllers.data.actions.stay(null, null, "press")
        }, a), a.keys.stay.onUp.add(function () {
            KME.controllers.data.actions.stay(null, null, "pressup")
        }, a), a.keys.run = a.game.input.keyboard.addKey(Phaser.Keyboard.ALT), a.keys.run.onDown.add(function () {
            KME.controllers.data.actions.run(null, null, "press")
        }, a), a.keys.run.onUp.add(function () {
            KME.controllers.data.actions.run(null, null, "pressup")
        }, a), b(null, a)
    }

    function d(a, b) {
        a.keys.nextAnimationDebug = a.game.input.keyboard.addKey(Phaser.Keyboard.Z), a.keys.nextAnimationDebug.onDown.add(function () {
            a.nextAnimationDebug()
        }, a), a.keys.nextRenderTypeDebug = a.game.input.keyboard.addKey(Phaser.Keyboard.X), a.keys.nextRenderTypeDebug.onDown.add(function () {
            a.nextRenderTypeDebug()
        }, a), a.keys.coordinateDebugOnOff = a.game.input.keyboard.addKey(Phaser.Keyboard.P), a.keys.coordinateDebugOnOff.onDown.add(function () {
            a.coordinateDebugOnOff()
        }, a), a.keys.collisionDebug = a.game.input.keyboard.addKey(221), a.keys.collisionDebug.onDown.add(function () {
            a.collisionDebugOnOff()
        }, a), a.keys.anchorDebug = a.game.input.keyboard.addKey(222), a.keys.anchorDebug.onDown.add(function () {
            a.anchorDebugOnOff()
        }, a), a.keys.gridDebug = a.game.input.keyboard.addKey(191), a.keys.gridDebug.onDown.add(function () {
            a.gridDebug = !a.gridDebug, KME.world.map.setGridDebug(a.gridDebug)
        }, a), a.keys.maskDebug = a.game.input.keyboard.addKey(219), a.keys.maskDebug.onDown.add(function () {
            a.maskDebug = !a.maskDebug, a.maskAndLabelRefresh()
        }, a), a.keys.hitAreaDebug = a.game.input.keyboard.addKey(186), a.keys.hitAreaDebug.onDown.add(function () {
            a.hitAreaDebug = !a.hitAreaDebug
        }, a), b(null, a)
    }

    function e(a, b) {
        var c = KME.interfaces.toolbar;
        a.keys.key1 = a.game.input.keyboard.addKey(Phaser.Keyboard.ONE), a.keys.key1.onDown.add(function () {
            c.toolbar("fireKey", 0)
        }, a), a.keys.key2 = a.game.input.keyboard.addKey(Phaser.Keyboard.TWO), a.keys.key2.onDown.add(function () {
            c.toolbar("fireKey", 1)
        }, a), a.keys.key3 = a.game.input.keyboard.addKey(Phaser.Keyboard.THREE), a.keys.key3.onDown.add(function () {
            c.toolbar("fireKey", 2)
        }, a), a.keys.key4 = a.game.input.keyboard.addKey(Phaser.Keyboard.FOUR), a.keys.key4.onDown.add(function () {
            c.toolbar("fireKey", 3)
        }, a), a.keys.key5 = a.game.input.keyboard.addKey(Phaser.Keyboard.FIVE), a.keys.key5.onDown.add(function () {
            c.toolbar("fireKey", 4)
        }, a), a.keys.key6 = a.game.input.keyboard.addKey(Phaser.Keyboard.SIX), a.keys.key6.onDown.add(function () {
            c.toolbar("fireKey", 5)
        }, a), a.keys.key7 = a.game.input.keyboard.addKey(Phaser.Keyboard.SEVEN), a.keys.key7.onDown.add(function () {
            c.toolbar("fireKey", 6)
        }, a), a.keys.key8 = a.game.input.keyboard.addKey(Phaser.Keyboard.EIGHT), a.keys.key8.onDown.add(function () {
            c.toolbar("fireKey", 7)
        }, a), a.keys.key9 = a.game.input.keyboard.addKey(Phaser.Keyboard.NINE), a.keys.key9.onDown.add(function () {
            c.toolbar("fireKey", 8)
        }, a), a.keys.key0 = a.game.input.keyboard.addKey(Phaser.Keyboard.ZERO), a.keys.key0.onDown.add(function () {
            c.toolbar("fireKey", 9)
        }, a), b(null, a)
    }

    function f(a, b) {
        var c = KME.interfaces.actionsBar;
        a.keys.keyQ = a.game.input.keyboard.addKey(Phaser.Keyboard.Q), a.keys.keyQ.onDown.add(function () {
            c.actionsBar("fireKey", 0)
        }, a), a.keys.keyW = a.game.input.keyboard.addKey(Phaser.Keyboard.W), a.keys.keyW.onDown.add(function () {
            c.actionsBar("fireKey", 1)
        }, a), a.keys.keyE = a.game.input.keyboard.addKey(Phaser.Keyboard.E), a.keys.keyE.onDown.add(function () {
            c.actionsBar("fireKey", 2)
        }, a), a.keys.keyR = a.game.input.keyboard.addKey(Phaser.Keyboard.R), a.keys.keyR.onDown.add(function () {
            c.actionsBar("fireKey", 3)
        }, a), a.keys.keyT = a.game.input.keyboard.addKey(Phaser.Keyboard.T), a.keys.keyT.onDown.add(function () {
            c.actionsBar("fireKey", 4)
        }, a), a.keys.keyY = a.game.input.keyboard.addKey(Phaser.Keyboard.Y), a.keys.keyY.onDown.add(function () {
            c.actionsBar("fireKey", 5)
        }, a), a.keys.keyU = a.game.input.keyboard.addKey(Phaser.Keyboard.U), a.keys.keyU.onDown.add(function () {
            c.actionsBar("fireKey", 6)
        }, a), b(null, a)
    }

    return {
        init: function (a) {
            this._.registerKeys(a)
        }, _: {
            registerKeys: function (g) {
                a.waterfall([function (a) {
                    a(null, g)
                }, b, c, d, e, f])
            }
        }
    }
}),define("KME/controllers/input/InputController", ["require", "./MouseController", "./KeyboardController"], function (a) {
    return {
        mouse: a("./MouseController"), keyboard: a("./KeyboardController"), init: function (a) {
            a.game.cursors = a.game.input.keyboard.createCursorKeys(), this.keyboard.init(a), this.mouse.init(a)
        }
    }
}),define("KME/controllers/sound/SoundController", ["jquery"], function (a) {
    var b = {
        mainTheme: "mainTheme",
        huntTheme: "huntTheme",
        buildTheme: "buildTheme",
        craftTheme: "craftTheme",
        farmTheme: "farmTheme"
    }, c = {
        typesDead: {
            femalePlayer: "femaleDead",
            malePlayer: "maleDead",
            Wolf: "wolfDead",
            Bear: "bearDead",
            Hen: "henDead",
            WildBoar: "boarDead",
            Deer: "deerDead",
            Hare: "hareDead",
            Horse: "horseDead",
            Fox: "foxDead",
            Ferret: "ferretDead",
            Raven: "ravenDead"
        }
    }, d = 2e3, e = 1e4;
    return {
        loaded: {},
        currentMusicTheme: {sound: null, name: null},
        volumes: {master: 1, music: .7, sound: 1},
        mutes: {music: !1, sound: !1},
        init: function () {
            KME.game.sound.volume = this.volumes.master;
            var b = this;
            a("#soundControl").click(function () {
                var c = a(this);
                c.hasClass("soundIconOn") ? b.musicMute() : c.hasClass("soundIconMid") ? b.soundMute() : b.masterUnMute()
            })
        },
        masterUnMute: function () {
            a("#soundControl").switchClass("soundIconOff", "soundIconOn"), this.mutes.sound = KME.game.sound.mute = !1, this.mutes.music = !1, this.fadeOrLoad = !1, this.playTheme()
        },
        musicMute: function () {
            a("#soundControl").switchClass("soundIconOn", "soundIconMid"), this.mutes.music = !0, this.currentMusicTheme.sound && (this.unloadMusic(this.currentMusicTheme.sound), this.currentMusicTheme.sound = null, this.currentMusicTheme.name = null), KME.utils.soundAtlas.musicLoader.isLoading && KME.utils.soundAtlas.musicLoader.reset(!0, !0)
        },
        soundMute: function () {
            a("#soundControl").switchClass("soundIconMid", "soundIconOff"), this.mutes.sound = KME.game.sound.mute = !0
        },
        characterDead: function (a, b) {
            this.playOnce(c.typesDead[a.gender ? a.gender + "Player" : a.typeName], b)
        },
        playOnce: function (a, b) {
            KME.utils.soundAtlas.soundNames[a] ? KME.game.sound.play(a, b ? 1 : .7, !1) : console.error("Sound key not found:", a)
        },
        playLoop: function (a, b) {
            return KME.utils.soundAtlas.soundNames[a] ? KME.game.sound.play(a, b ? 1 : .7, !0) : (console.error("Sound key not found:", a), null)
        },
        _startNew: function (a) {
            var b = this;
            KME.utils.soundAtlas.loadMusic(a, function () {
                b.currentMusicTheme.sound = KME.game.sound.play(a, b.volumes.music, !0), b.currentMusicTheme.name = a, b.fadeOrLoad = !1, b._startOrProlongThemeTimer()
            })
        },
        _startOrProlongThemeTimer: function () {
            var a = this;
            this.currentMusicTheme.name !== b.mainTheme && (this.returnMainTimer && clearTimeout(this.returnMainTimer), a.returnMainTimer = setTimeout(function () {
                a.playTheme()
            }, e))
        },
        playTheme: function (a) {
            if (!this.mutes.music) {
                var c = this;
                this.fadeOrLoad || ("undefined" == typeof a && (a = b.mainTheme), this.currentMusicTheme.name !== a && (this.fadeOrLoad = !0, this.currentMusicTheme.sound ? this.fadeOutAndStopOrUnload(this.currentMusicTheme.sound, d, !0, function () {
                    c._startNew(a)
                }) : c._startNew(a))), this._startOrProlongThemeTimer()
            }
        },
        huntEvent: function () {
            this.playTheme(b.huntTheme)
        },
        buildEvent: function () {
            this.playTheme(b.buildTheme)
        },
        craftEvent: function () {
            this.playTheme(b.craftTheme)
        },
        farmEvent: function () {
            this.playTheme(b.farmTheme)
        },
        fadeOutAndStopOrUnload: function (a, b, c, d) {
            a.fadeOut(b);
            var e = this;
            c ? a.onFadeComplete.add(function () {
                a && (e.unloadMusic(a), d && d())
            }, this) : a.onFadeComplete.add(function () {
                a.stop()
            }, this)
        },
        unloadMusic: function (a) {
            var b = a.key;
            a.stop(), a.destroy(), KME.game.cache.removeSound(b)
        }
    }
}),define("KME/states/Connector", ["KME/controllers/controllers"], function () {
    KME.Connector = function (a) {
        this.game = a, this.socket = null
    }, KME.Connector.prototype = {
        create: function () {
            KME.controllers.sound.init(), KME.controllers.network.init()
        }
    }
}),define("KME/states/MainMenu", [], function () {
    KME.MainMenu = function (a) {
        this.game = a, this.music = null, this.playButton = null
    }, KME.MainMenu.prototype = {
        create: function () {
            this.input.onDown.addOnce(this.startGame, this)
        }, update: function () {
        }, startGame: function () {
            this.state.start("Game")
        }
    }
}),define("KME/data/world/state/StateManager", [], function () {
    KME.world.states.manager = {
        checkForChange: function (a, b) {
            var c;
            a.spriteConfigUpdate(b) && (c = !0), a.currentStateName !== b.currentState && (c = !0), c && this.change(a, b)
        }, change: function (a, b) {
            b.currentState && (a.currentStateName = b.currentState), a.initOrReInit(b)
        }
    }
}),window.KME = {
    utils: {},
    interfaces: {},
    graphic: {},
    world: {
        directions: ["left", "leftup", "up", "upright", "right", "rightdown", "down", "downleft"],
        faceDirections: ["right", "rightdown", "down", "downleft", "left", "leftup", "up", "upright"],
        faceAngles: {
            rightdown: .4636,
            downleft: Math.PI - .4636,
            leftup: Math.PI + .4636,
            upright: 2 * Math.PI - .4636
        },
        states: {cache: {}}
    },
    inventory: {},
    templates: {},
    types: {}
},define("KME/KME", ["require", "jquery", "json!../../package.json", "i18next", "jstree", "phaser", "heap", "KME/phext/phext", "KME/controllers/Controllers", "KME/states/Login", "KME/states/Error", "KME/states/Boot", "KME/states/Preloader", "KME/states/Connector", "KME/states/Game", "KME/states/MainMenu", "KME/data/world/state/StateManager"], function (a, b, c) {
    function d() {
        return window.location.href.indexOf("russian.html") >= 0 ? "ru" : "en"
    }

    function e(a) {
        for (var b = window.location.search.substring(1), c = b.split("&"), d = 0; d < c.length; d++) {
            var e = c[d].split("=");
            if (e[0] == a)return e[1]
        }
    }

    function f() {
        for (var a = [], b = "0123456789abcdef", c = 0; 36 > c; c++)a[c] = b.substr(Math.floor(16 * Math.random()), 1);
        a[14] = "4", a[19] = b.substr(3 & a[19] | 8, 1), a[8] = a[13] = a[18] = a[23] = "-";
        var d = a.join("");
        return d
    }

    function g(a, b, c) {
        if (c) {
            var d = new Date;
            d.setTime(d.getTime() + 24 * c * 60 * 60 * 1e3);
            var e = "; expires=" + d.toGMTString()
        } else var e = "";
        document.cookie = a + "=" + b + e + "; path=/"
    }

    function h(a) {
        for (var b = a + "=", c = document.cookie.split(";"), d = 0; d < c.length; d++) {
            for (var e = c[d]; " " == e.charAt(0);)e = e.substring(1, e.length);
            if (0 === e.indexOf(b))return e.substring(b.length, e.length)
        }
        return null
    }

    window.redirectToAuthorization = function () {
        var a = window.WILDTERRA_AUTHORIZATION + "&client_uri=" + window.location.origin + window.location.pathname + "&client_version=" + window.KME_VERSION + (window.STEAM_AUTHORIZATION ? "&steam=true" : "");
        window.SteamAPI ? window.SteamAPI.getAuthSessionTicket(function (b) {
            window.location = a + "&ticket=" + b.ticket + "&locale=" + window.FORCED_LOCALE
        }, function () {
            window.location = a
        }) : window.location = a
    }, KME.initGame = function () {
        KME.game && KME.game.destroy(), KME.game = new Phaser.Game({
            width: KME.gameElement.width(),
            height: KME.gameElement.height(),
            renderer: KME.renderer,
            parent: "game",
            disableVisibilityChange: !0,
            forceLandscape: !0,
            transparent: !0,
            antialias: !0
        }), KME.game.state.add("Login", KME.Login), KME.game.state.add("Boot", KME.Boot), KME.game.state.add("Error", KME.Error), KME.game.state.add("Connector", KME.Connector), KME.game.state.add("Preloader", KME.Preloader), KME.game.state.add("MainMenu", KME.MainMenu), KME.gameState = KME.game.state.add("Game", KME.Game), KME.sendError = function (a, b) {
            window.errorText = a, window.errorMode = b, KME.game.state.start("Error")
        }, KME.game.state.start("Login")
    }, window.KME_VERSION = c.version, screen.lockOrientation && screen.lockOrientation("landscape"), b(function () {
        var a = d(), c = window.FORCED_LOCALE ? window.FORCED_LOCALE : e("setLng"), f = window.RENDER_MODE ? window.RENDER_MODE : e("render_mode");
        window.XSOLLA_CURRENCY = e("xsolla_currency"), window.XSOLLA_LANGUAGE = e("xsolla_language");
        var g = {
            resGetPath: "locales/__lng__/__ns__.json",
            lng: c ? c : a,
            namespaces: ["general", "interfaces", "actions", "tutorial", "objects", "messages", "skills"],
            ns: "general",
            useDataAttrOptions: !0,
            fallbackLng: !1,
            load: "current",
            debug: !0,
            sendMissing: !1,
            sendMissingTo: "current",
            resPostPath: "/api/v1/locales/add/__lng__/__ns__"
        };
        b.i18n.init(g), KME.gameElement = b("#game");
        var h = /chrom(e|ium)/.test(navigator.userAgent.toLowerCase());
        f && ["auto", "canvas", "webgl"].indexOf(f.toLowerCase()) >= 0 ? KME.renderer = ["auto", "canvas", "webgl"].indexOf(f.toLowerCase()) : h ? KME.renderer = Phaser.AUTO : KME.renderer = Phaser.CANVAS, KME.initGame()
    }), window.sessionId = h("sessionId"), window.sessionId || (window.sessionId = f(), g("sessionId", window.sessionId, 100))
});
//# sourceMappingURL=kme.min.map